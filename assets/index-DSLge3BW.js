const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.es-PUVmI-lO.js","assets/vendor-react-BjA4vbPC.js","assets/vendor-ui-BNe0Xlio.js","assets/vendor-icons-CG0w0Htq.js","assets/vendor-charts-vDjgFBvH.js"])))=>i.map(i=>d[i]);
import{a as S8,c as N8,r as Z,d as Wt,b as I0,u as jA,N as sk,O as E8,L as F8,e as MS,H as T8,f as L8,h as lc}from"./vendor-react-BjA4vbPC.js";import{t as j8,c as U8}from"./vendor-ui-BNe0Xlio.js";import{X as vl,C as HS,H as PS,I as iu,a as R1,T as t0,b as ow,R as nk,W as D8,A as r0,L as ik,D as wl,c as I8,P as Q0,F as xf,M as qS,d as Yl,e as KS,G as wp,S as _p,f as H0,g as Zo,h as bf,i as Q8,j as O8,k as R8,E as M8,l as Vu,m as Cn,n as zS,o as y2,p as H8,q as P8,U as VS,r as nx,s as q8,t as Yx,u as ii,v as lk,w as nf,x as GS,B as K8,y as z8,z as k2,J as ok,K as eA,N as V8,O as B2,Q as G8,V as Zc,Y as C2,Z as If,_ as yp,$ as CA,a0 as Jx,a1 as WS,a2 as Jh,a3 as W8,a4 as Ak,a5 as M1,a6 as Km,a7 as $8,a8 as Jg,a9 as oc,aa as X8,ab as Aw,ac as cw,ad as Y8,ae as J8,af as wn,ag as ff,ah as zm,ai as lf,aj as H1,ak as ck,al as Bh,am as uk,an as ix,ao as dk,ap as lx,aq as Z8,ar as eL,as as $S,at as fk,au as hk,av as tL,aw as rL,ax as aL,ay as sL,az as nL,aA as uw,aB as iL,aC as lL,aD as oL,aE as AL,aF as cL}from"./vendor-icons-CG0w0Htq.js";import{r as uL,R as XS,B as YS,C as pc,X as gc,Y as mc,T as Jl,L as Zl,a as ox,b as xc,c as JS,d as Ax,A as ZS,e as e3,P as t3,f as r3,g as a3,h as s3,i as n3,j as i3,k as l3,l as o3,m as A3,S as c3,n as u3}from"./vendor-charts-vDjgFBvH.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(s){if(s.ep)return;s.ep=!0;const n=r(s);fetch(s.href,n)}})();var P1={exports:{}},Ch={};var pk;function dL(){if(pk)return Ch;pk=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(a,s,n){var o=null;if(n!==void 0&&(o=""+n),s.key!==void 0&&(o=""+s.key),"key"in s){n={};for(var c in s)c!=="key"&&(n[c]=s[c])}else n=s;return s=n.ref,{$$typeof:e,type:a,key:o,ref:s!==void 0?s:null,props:n}}return Ch.Fragment=t,Ch.jsx=r,Ch.jsxs=r,Ch}var gk;function fL(){return gk||(gk=1,P1.exports=dL()),P1.exports}var l=fL(),q1={exports:{}},Sh={},K1={exports:{}},z1={};var mk;function hL(){return mk||(mk=1,(function(e){function t(ee,le){var pe=ee.length;ee.push(le);e:for(;0<pe;){var te=pe-1>>>1,Le=ee[te];if(0<s(Le,le))ee[te]=le,ee[pe]=Le,pe=te;else break e}}function r(ee){return ee.length===0?null:ee[0]}function a(ee){if(ee.length===0)return null;var le=ee[0],pe=ee.pop();if(pe!==le){ee[0]=pe;e:for(var te=0,Le=ee.length,je=Le>>>1;te<je;){var F=2*(te+1)-1,K=ee[F],I=F+1,q=ee[I];if(0>s(K,pe))I<Le&&0>s(q,K)?(ee[te]=q,ee[I]=pe,te=I):(ee[te]=K,ee[F]=pe,te=F);else if(I<Le&&0>s(q,pe))ee[te]=q,ee[I]=pe,te=I;else break e}}return le}function s(ee,le){var pe=ee.sortIndex-le.sortIndex;return pe!==0?pe:ee.id-le.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var n=performance;e.unstable_now=function(){return n.now()}}else{var o=Date,c=o.now();e.unstable_now=function(){return o.now()-c}}var u=[],f=[],h=1,g=null,x=3,m=!1,w=!1,v=!1,B=!1,k=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function L(ee){for(var le=r(f);le!==null;){if(le.callback===null)a(f);else if(le.startTime<=ee)a(f),le.sortIndex=le.expirationTime,t(u,le);else break;le=r(f)}}function P(ee){if(v=!1,L(ee),!w)if(r(u)!==null)w=!0,R||(R=!0,D());else{var le=r(f);le!==null&&H(P,le.startTime-ee)}}var R=!1,Q=-1,V=5,U=-1;function M(){return B?!0:!(e.unstable_now()-U<V)}function T(){if(B=!1,R){var ee=e.unstable_now();U=ee;var le=!0;try{e:{w=!1,v&&(v=!1,E(Q),Q=-1),m=!0;var pe=x;try{t:{for(L(ee),g=r(u);g!==null&&!(g.expirationTime>ee&&M());){var te=g.callback;if(typeof te=="function"){g.callback=null,x=g.priorityLevel;var Le=te(g.expirationTime<=ee);if(ee=e.unstable_now(),typeof Le=="function"){g.callback=Le,L(ee),le=!0;break t}g===r(u)&&a(u),L(ee)}else a(u);g=r(u)}if(g!==null)le=!0;else{var je=r(f);je!==null&&H(P,je.startTime-ee),le=!1}}break e}finally{g=null,x=pe,m=!1}le=void 0}}finally{le?D():R=!1}}}var D;if(typeof S=="function")D=function(){S(T)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,ne=G.port2;G.port1.onmessage=T,D=function(){ne.postMessage(null)}}else D=function(){k(T,0)};function H(ee,le){Q=k(function(){ee(e.unstable_now())},le)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ee){ee.callback=null},e.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<ee?Math.floor(1e3/ee):5},e.unstable_getCurrentPriorityLevel=function(){return x},e.unstable_next=function(ee){switch(x){case 1:case 2:case 3:var le=3;break;default:le=x}var pe=x;x=le;try{return ee()}finally{x=pe}},e.unstable_requestPaint=function(){B=!0},e.unstable_runWithPriority=function(ee,le){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var pe=x;x=ee;try{return le()}finally{x=pe}},e.unstable_scheduleCallback=function(ee,le,pe){var te=e.unstable_now();switch(typeof pe=="object"&&pe!==null?(pe=pe.delay,pe=typeof pe=="number"&&0<pe?te+pe:te):pe=te,ee){case 1:var Le=-1;break;case 2:Le=250;break;case 5:Le=1073741823;break;case 4:Le=1e4;break;default:Le=5e3}return Le=pe+Le,ee={id:h++,callback:le,priorityLevel:ee,startTime:pe,expirationTime:Le,sortIndex:-1},pe>te?(ee.sortIndex=pe,t(f,ee),r(u)===null&&ee===r(f)&&(v?(E(Q),Q=-1):v=!0,H(P,pe-te))):(ee.sortIndex=Le,t(u,ee),w||m||(w=!0,R||(R=!0,D()))),ee},e.unstable_shouldYield=M,e.unstable_wrapCallback=function(ee){var le=x;return function(){var pe=x;x=le;try{return ee.apply(this,arguments)}finally{x=pe}}}})(z1)),z1}var xk;function pL(){return xk||(xk=1,K1.exports=hL()),K1.exports}var bk;function gL(){if(bk)return Sh;bk=1;var e=pL(),t=S8(),r=N8();function a(i){var A="https://react.dev/errors/"+i;if(1<arguments.length){A+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)A+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+i+"; visit "+A+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function n(i){var A=i,d=i;if(i.alternate)for(;A.return;)A=A.return;else{i=A;do A=i,(A.flags&4098)!==0&&(d=A.return),i=A.return;while(i)}return A.tag===3?d:null}function o(i){if(i.tag===13){var A=i.memoizedState;if(A===null&&(i=i.alternate,i!==null&&(A=i.memoizedState)),A!==null)return A.dehydrated}return null}function c(i){if(i.tag===31){var A=i.memoizedState;if(A===null&&(i=i.alternate,i!==null&&(A=i.memoizedState)),A!==null)return A.dehydrated}return null}function u(i){if(n(i)!==i)throw Error(a(188))}function f(i){var A=i.alternate;if(!A){if(A=n(i),A===null)throw Error(a(188));return A!==i?null:i}for(var d=i,p=A;;){var _=d.return;if(_===null)break;var C=_.alternate;if(C===null){if(p=_.return,p!==null){d=p;continue}break}if(_.child===C.child){for(C=_.child;C;){if(C===d)return u(_),i;if(C===p)return u(_),A;C=C.sibling}throw Error(a(188))}if(d.return!==p.return)d=_,p=C;else{for(var W=!1,ge=_.child;ge;){if(ge===d){W=!0,d=_,p=C;break}if(ge===p){W=!0,p=_,d=C;break}ge=ge.sibling}if(!W){for(ge=C.child;ge;){if(ge===d){W=!0,d=C,p=_;break}if(ge===p){W=!0,p=C,d=_;break}ge=ge.sibling}if(!W)throw Error(a(189))}}if(d.alternate!==p)throw Error(a(190))}if(d.tag!==3)throw Error(a(188));return d.stateNode.current===d?i:A}function h(i){var A=i.tag;if(A===5||A===26||A===27||A===6)return i;for(i=i.child;i!==null;){if(A=h(i),A!==null)return A;i=i.sibling}return null}var g=Object.assign,x=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),B=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),E=Symbol.for("react.consumer"),S=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),Q=Symbol.for("react.memo"),V=Symbol.for("react.lazy"),U=Symbol.for("react.activity"),M=Symbol.for("react.memo_cache_sentinel"),T=Symbol.iterator;function D(i){return i===null||typeof i!="object"?null:(i=T&&i[T]||i["@@iterator"],typeof i=="function"?i:null)}var G=Symbol.for("react.client.reference");function ne(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===G?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case v:return"Fragment";case k:return"Profiler";case B:return"StrictMode";case P:return"Suspense";case R:return"SuspenseList";case U:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case w:return"Portal";case S:return i.displayName||"Context";case E:return(i._context.displayName||"Context")+".Consumer";case L:var A=i.render;return i=i.displayName,i||(i=A.displayName||A.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Q:return A=i.displayName||null,A!==null?A:ne(i.type)||"Memo";case V:A=i._payload,i=i._init;try{return ne(i(A))}catch{}}return null}var H=Array.isArray,ee=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,le=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,pe={pending:!1,data:null,method:null,action:null},te=[],Le=-1;function je(i){return{current:i}}function F(i){0>Le||(i.current=te[Le],te[Le]=null,Le--)}function K(i,A){Le++,te[Le]=i.current,i.current=A}var I=je(null),q=je(null),J=je(null),Y=je(null);function de(i,A){switch(K(J,A),K(q,i),K(I,null),A.nodeType){case 9:case 11:i=(i=A.documentElement)&&(i=i.namespaceURI)?S5(i):0;break;default:if(i=A.tagName,A=A.namespaceURI)A=S5(A),i=N5(A,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}F(I),K(I,i)}function ue(){F(I),F(q),F(J)}function we(i){i.memoizedState!==null&&K(Y,i);var A=I.current,d=N5(A,i.type);A!==d&&(K(q,i),K(I,d))}function Ie(i){q.current===i&&(F(I),F(q)),Y.current===i&&(F(Y),wh._currentValue=pe)}var Ae,oe;function He(i){if(Ae===void 0)try{throw Error()}catch(d){var A=d.stack.trim().match(/\n( *(at )?)/);Ae=A&&A[1]||"",oe=-1<d.stack.indexOf(`
    at`)?" (<anonymous>)":-1<d.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ae+i+oe}var se=!1;function qe(i,A){if(!i||se)return"";se=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(A){var xt=function(){throw Error()};if(Object.defineProperty(xt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(xt,[])}catch(rt){var et=rt}Reflect.construct(i,[],xt)}else{try{xt.call()}catch(rt){et=rt}i.call(xt.prototype)}}else{try{throw Error()}catch(rt){et=rt}(xt=i())&&typeof xt.catch=="function"&&xt.catch(function(){})}}catch(rt){if(rt&&et&&typeof rt.stack=="string")return[rt.stack,et.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var _=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");_&&_.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var C=p.DetermineComponentFrameRoot(),W=C[0],ge=C[1];if(W&&ge){var De=W.split(`
`),Ze=ge.split(`
`);for(_=p=0;p<De.length&&!De[p].includes("DetermineComponentFrameRoot");)p++;for(;_<Ze.length&&!Ze[_].includes("DetermineComponentFrameRoot");)_++;if(p===De.length||_===Ze.length)for(p=De.length-1,_=Ze.length-1;1<=p&&0<=_&&De[p]!==Ze[_];)_--;for(;1<=p&&0<=_;p--,_--)if(De[p]!==Ze[_]){if(p!==1||_!==1)do if(p--,_--,0>_||De[p]!==Ze[_]){var ut=`
`+De[p].replace(" at new "," at ");return i.displayName&&ut.includes("<anonymous>")&&(ut=ut.replace("<anonymous>",i.displayName)),ut}while(1<=p&&0<=_);break}}}finally{se=!1,Error.prepareStackTrace=d}return(d=i?i.displayName||i.name:"")?He(d):""}function Ye(i,A){switch(i.tag){case 26:case 27:case 5:return He(i.type);case 16:return He("Lazy");case 13:return i.child!==A&&A!==null?He("Suspense Fallback"):He("Suspense");case 19:return He("SuspenseList");case 0:case 15:return qe(i.type,!1);case 11:return qe(i.type.render,!1);case 1:return qe(i.type,!0);case 31:return He("Activity");default:return""}}function at(i){try{var A="",d=null;do A+=Ye(i,d),d=i,i=i.return;while(i);return A}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}var Ge=Object.prototype.hasOwnProperty,pt=e.unstable_scheduleCallback,nt=e.unstable_cancelCallback,Dt=e.unstable_shouldYield,It=e.unstable_requestPaint,Ot=e.unstable_now,sr=e.unstable_getCurrentPriorityLevel,er=e.unstable_ImmediatePriority,cr=e.unstable_UserBlockingPriority,Vt=e.unstable_NormalPriority,mt=e.unstable_LowPriority,Nt=e.unstable_IdlePriority,gt=e.log,dr=e.unstable_setDisableYieldValue,Ht=null,Rt=null;function $t(i){if(typeof gt=="function"&&dr(i),Rt&&typeof Rt.setStrictMode=="function")try{Rt.setStrictMode(Ht,i)}catch{}}var vr=Math.clz32?Math.clz32:tr,vt=Math.log,kr=Math.LN2;function tr(i){return i>>>=0,i===0?32:31-(vt(i)/kr|0)|0}var rr=256,Xt=262144,Kt=4194304;function Ft(i){var A=i&42;if(A!==0)return A;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Zt(i,A,d){var p=i.pendingLanes;if(p===0)return 0;var _=0,C=i.suspendedLanes,W=i.pingedLanes;i=i.warmLanes;var ge=p&134217727;return ge!==0?(p=ge&~C,p!==0?_=Ft(p):(W&=ge,W!==0?_=Ft(W):d||(d=ge&~i,d!==0&&(_=Ft(d))))):(ge=p&~C,ge!==0?_=Ft(ge):W!==0?_=Ft(W):d||(d=p&~i,d!==0&&(_=Ft(d)))),_===0?0:A!==0&&A!==_&&(A&C)===0&&(C=_&-_,d=A&-A,C>=d||C===32&&(d&4194048)!==0)?A:_}function wr(i,A){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&A)===0}function Re(i,A){switch(i){case 1:case 2:case 4:case 8:case 64:return A+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return A+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Et(){var i=Kt;return Kt<<=1,(Kt&62914560)===0&&(Kt=4194304),i}function Tt(i){for(var A=[],d=0;31>d;d++)A.push(i);return A}function Bt(i,A){i.pendingLanes|=A,A!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function Yt(i,A,d,p,_,C){var W=i.pendingLanes;i.pendingLanes=d,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=d,i.entangledLanes&=d,i.errorRecoveryDisabledLanes&=d,i.shellSuspendCounter=0;var ge=i.entanglements,De=i.expirationTimes,Ze=i.hiddenUpdates;for(d=W&~d;0<d;){var ut=31-vr(d),xt=1<<ut;ge[ut]=0,De[ut]=-1;var et=Ze[ut];if(et!==null)for(Ze[ut]=null,ut=0;ut<et.length;ut++){var rt=et[ut];rt!==null&&(rt.lane&=-536870913)}d&=~xt}p!==0&&Mr(i,p,0),C!==0&&_===0&&i.tag!==0&&(i.suspendedLanes|=C&~(W&~A))}function Mr(i,A,d){i.pendingLanes|=A,i.suspendedLanes&=~A;var p=31-vr(A);i.entangledLanes|=A,i.entanglements[p]=i.entanglements[p]|1073741824|d&261930}function Jr(i,A){var d=i.entangledLanes|=A;for(i=i.entanglements;d;){var p=31-vr(d),_=1<<p;_&A|i[p]&A&&(i[p]|=A),d&=~_}}function jr(i,A){var d=A&-A;return d=(d&42)!==0?1:fr(d),(d&(i.suspendedLanes|A))!==0?0:d}function fr(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Cr(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function re(){var i=le.p;return i!==0?i:(i=window.event,i===void 0?32:Y5(i.type))}function ke(i,A){var d=le.p;try{return le.p=i,A()}finally{le.p=d}}var me=Math.random().toString(36).slice(2),be="__reactFiber$"+me,ye="__reactProps$"+me,O="__reactContainer$"+me,ce="__reactEvents$"+me,Fe="__reactListeners$"+me,Ne="__reactHandles$"+me,Te="__reactResources$"+me,Ue="__reactMarker$"+me;function tt(i){delete i[be],delete i[ye],delete i[ce],delete i[Fe],delete i[Ne]}function _t(i){var A=i[be];if(A)return A;for(var d=i.parentNode;d;){if(A=d[O]||d[be]){if(d=A.alternate,A.child!==null||d!==null&&d.child!==null)for(i=D5(i);i!==null;){if(d=i[be])return d;i=D5(i)}return A}i=d,d=i.parentNode}return null}function Ct(i){if(i=i[be]||i[O]){var A=i.tag;if(A===5||A===6||A===13||A===31||A===26||A===27||A===3)return i}return null}function yt(i){var A=i.tag;if(A===5||A===26||A===27||A===6)return i.stateNode;throw Error(a(33))}function Ut(i){var A=i[Te];return A||(A=i[Te]={hoistableStyles:new Map,hoistableScripts:new Map}),A}function zt(i){i[Ue]=!0}var Gr=new Set,Qr={};function oa(i,A){fs(i,A),fs(i+"Capture",A)}function fs(i,A){for(Qr[i]=A,i=0;i<A.length;i++)Gr.add(A[i])}var Tn=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Vn={},ve={};function it(i){return Ge.call(ve,i)?!0:Ge.call(Vn,i)?!1:Tn.test(i)?ve[i]=!0:(Vn[i]=!0,!1)}function St(i,A,d){if(it(A))if(d===null)i.removeAttribute(A);else{switch(typeof d){case"undefined":case"function":case"symbol":i.removeAttribute(A);return;case"boolean":var p=A.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){i.removeAttribute(A);return}}i.setAttribute(A,""+d)}}function st(i,A,d){if(d===null)i.removeAttribute(A);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(A);return}i.setAttribute(A,""+d)}}function Hr(i,A,d,p){if(p===null)i.removeAttribute(d);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(d);return}i.setAttributeNS(A,d,""+p)}}function yr(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function wa(i){var A=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(A==="checkbox"||A==="radio")}function Na(i,A,d){var p=Object.getOwnPropertyDescriptor(i.constructor.prototype,A);if(!i.hasOwnProperty(A)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var _=p.get,C=p.set;return Object.defineProperty(i,A,{configurable:!0,get:function(){return _.call(this)},set:function(W){d=""+W,C.call(this,W)}}),Object.defineProperty(i,A,{enumerable:p.enumerable}),{getValue:function(){return d},setValue:function(W){d=""+W},stopTracking:function(){i._valueTracker=null,delete i[A]}}}}function Gn(i){if(!i._valueTracker){var A=wa(i)?"checked":"value";i._valueTracker=Na(i,A,""+i[A])}}function Lr(i){if(!i)return!1;var A=i._valueTracker;if(!A)return!0;var d=A.getValue(),p="";return i&&(p=wa(i)?i.checked?"true":"false":i.value),i=p,i!==d?(A.setValue(i),!0):!1}function Ia(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var hs=/[\n"\\]/g;function ls(i){return i.replace(hs,function(A){return"\\"+A.charCodeAt(0).toString(16)+" "})}function no(i,A,d,p,_,C,W,ge){i.name="",W!=null&&typeof W!="function"&&typeof W!="symbol"&&typeof W!="boolean"?i.type=W:i.removeAttribute("type"),A!=null?W==="number"?(A===0&&i.value===""||i.value!=A)&&(i.value=""+yr(A)):i.value!==""+yr(A)&&(i.value=""+yr(A)):W!=="submit"&&W!=="reset"||i.removeAttribute("value"),A!=null?io(i,W,yr(A)):d!=null?io(i,W,yr(d)):p!=null&&i.removeAttribute("value"),_==null&&C!=null&&(i.defaultChecked=!!C),_!=null&&(i.checked=_&&typeof _!="function"&&typeof _!="symbol"),ge!=null&&typeof ge!="function"&&typeof ge!="symbol"&&typeof ge!="boolean"?i.name=""+yr(ge):i.removeAttribute("name")}function Ln(i,A,d,p,_,C,W,ge){if(C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(i.type=C),A!=null||d!=null){if(!(C!=="submit"&&C!=="reset"||A!=null)){Gn(i);return}d=d!=null?""+yr(d):"",A=A!=null?""+yr(A):d,ge||A===i.value||(i.value=A),i.defaultValue=A}p=p??_,p=typeof p!="function"&&typeof p!="symbol"&&!!p,i.checked=ge?i.checked:!!p,i.defaultChecked=!!p,W!=null&&typeof W!="function"&&typeof W!="symbol"&&typeof W!="boolean"&&(i.name=W),Gn(i)}function io(i,A,d){A==="number"&&Ia(i.ownerDocument)===i||i.defaultValue===""+d||(i.defaultValue=""+d)}function Ls(i,A,d,p){if(i=i.options,A){A={};for(var _=0;_<d.length;_++)A["$"+d[_]]=!0;for(d=0;d<i.length;d++)_=A.hasOwnProperty("$"+i[d].value),i[d].selected!==_&&(i[d].selected=_),_&&p&&(i[d].defaultSelected=!0)}else{for(d=""+yr(d),A=null,_=0;_<i.length;_++){if(i[_].value===d){i[_].selected=!0,p&&(i[_].defaultSelected=!0);return}A!==null||i[_].disabled||(A=i[_])}A!==null&&(A.selected=!0)}}function Bl(i,A,d){if(A!=null&&(A=""+yr(A),A!==i.value&&(i.value=A),d==null)){i.defaultValue!==A&&(i.defaultValue=A);return}i.defaultValue=d!=null?""+yr(d):""}function iA(i,A,d,p){if(A==null){if(p!=null){if(d!=null)throw Error(a(92));if(H(p)){if(1<p.length)throw Error(a(93));p=p[0]}d=p}d==null&&(d=""),A=d}d=yr(A),i.defaultValue=d,p=i.textContent,p===d&&p!==""&&p!==null&&(i.value=p),Gn(i)}function Si(i,A){if(A){var d=i.firstChild;if(d&&d===i.lastChild&&d.nodeType===3){d.nodeValue=A;return}}i.textContent=A}var Wn=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Tc(i,A,d){var p=A.indexOf("--")===0;d==null||typeof d=="boolean"||d===""?p?i.setProperty(A,""):A==="float"?i.cssFloat="":i[A]="":p?i.setProperty(A,d):typeof d!="number"||d===0||Wn.has(A)?A==="float"?i.cssFloat=d:i[A]=(""+d).trim():i[A]=d+"px"}function Lc(i,A,d){if(A!=null&&typeof A!="object")throw Error(a(62));if(i=i.style,d!=null){for(var p in d)!d.hasOwnProperty(p)||A!=null&&A.hasOwnProperty(p)||(p.indexOf("--")===0?i.setProperty(p,""):p==="float"?i.cssFloat="":i[p]="");for(var _ in A)p=A[_],A.hasOwnProperty(_)&&d[_]!==p&&Tc(i,_,p)}else for(var C in A)A.hasOwnProperty(C)&&Tc(i,C,A[C])}function lA(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var OA=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ri=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function fn(i){return Ri.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function cl(){}var Ys=null;function No(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var di=null,Sr=null;function RA(i){var A=Ct(i);if(A&&(i=A.stateNode)){var d=i[ye]||null;e:switch(i=A.stateNode,A.type){case"input":if(no(i,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name),A=d.name,d.type==="radio"&&A!=null){for(d=i;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll('input[name="'+ls(""+A)+'"][type="radio"]'),A=0;A<d.length;A++){var p=d[A];if(p!==i&&p.form===i.form){var _=p[ye]||null;if(!_)throw Error(a(90));no(p,_.value,_.defaultValue,_.defaultValue,_.checked,_.defaultChecked,_.type,_.name)}}for(A=0;A<d.length;A++)p=d[A],p.form===i.form&&Lr(p)}break e;case"textarea":Bl(i,d.value,d.defaultValue);break e;case"select":A=d.value,A!=null&&Ls(i,!!d.multiple,A,!1)}}}var MA=!1;function HA(i,A,d){if(MA)return i(A,d);MA=!0;try{var p=i(A);return p}finally{if(MA=!1,(di!==null||Sr!==null)&&(Fg(),di&&(A=di,i=Sr,Sr=di=null,RA(A),i)))for(A=0;A<i.length;A++)RA(i[A])}}function $n(i,A){var d=i.stateNode;if(d===null)return null;var p=d[ye]||null;if(p===null)return null;d=p[A];e:switch(A){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(i=i.type,p=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!p;break e;default:i=!1}if(i)return null;if(d&&typeof d!="function")throw Error(a(231,A,typeof d));return d}var hn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),PA=!1;if(hn)try{var oA={};Object.defineProperty(oA,"passive",{get:function(){PA=!0}}),window.addEventListener("test",oA,oA),window.removeEventListener("test",oA,oA)}catch{PA=!1}var fi=null,AA=null,Cl=null;function Xn(){if(Cl)return Cl;var i,A=AA,d=A.length,p,_="value"in fi?fi.value:fi.textContent,C=_.length;for(i=0;i<d&&A[i]===_[i];i++);var W=d-i;for(p=1;p<=W&&A[d-p]===_[C-p];p++);return Cl=_.slice(i,1<p?1-p:void 0)}function bs(i){var A=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&A===13&&(i=13)):i=A,i===10&&(i=13),32<=i||i===13?i:0}function Ps(){return!0}function Sl(){return!1}function Ka(i){function A(d,p,_,C,W){this._reactName=d,this._targetInst=_,this.type=p,this.nativeEvent=C,this.target=W,this.currentTarget=null;for(var ge in i)i.hasOwnProperty(ge)&&(d=i[ge],this[ge]=d?d(C):C[ge]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?Ps:Sl,this.isPropagationStopped=Sl,this}return g(A.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=Ps)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=Ps)},persist:function(){},isPersistent:Ps}),A}var qs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Mi=Ka(qs),lo=g({},qs,{view:0,detail:0}),ma=Ka(lo),Ni,Nl,js,Eo=g({},lo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ur,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==js&&(js&&i.type==="mousemove"?(Ni=i.screenX-js.screenX,Nl=i.screenY-js.screenY):Nl=Ni=0,js=i),Ni)},movementY:function(i){return"movementY"in i?i.movementY:Nl}}),Fo=Ka(Eo),vs=g({},Eo,{dataTransfer:0}),Hi=Ka(vs),qA=g({},lo,{relatedTarget:0}),pn=Ka(qA),du=g({},qs,{animationName:0,elapsedTime:0,pseudoElement:0}),N=Ka(du),ae=g({},qs,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Se=Ka(ae),Qe=g({},qs,{data:0}),ze=Ka(Qe),ct={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wt={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Gt={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pr(i){var A=this.nativeEvent;return A.getModifierState?A.getModifierState(i):(i=Gt[i])?!!A[i]:!1}function Ur(){return pr}var Wr=g({},lo,{key:function(i){if(i.key){var A=ct[i.key]||i.key;if(A!=="Unidentified")return A}return i.type==="keypress"?(i=bs(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?wt[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ur,charCode:function(i){return i.type==="keypress"?bs(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?bs(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),da=Ka(Wr),Za=g({},Eo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ps=Ka(Za),Pa=g({},lo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ur}),Ks=Ka(Pa),Us=g({},qs,{propertyName:0,elapsedTime:0,pseudoElement:0}),Js=Ka(Us),El=g({},Eo,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),ul=Ka(El),Fl=g({},qs,{newState:0,oldState:0}),ws=Ka(Fl),To=[9,13,27,32],dl=hn&&"CompositionEvent"in window,Pi=null;hn&&"documentMode"in document&&(Pi=document.documentMode);var cA=hn&&"TextEvent"in window&&!Pi,oo=hn&&(!dl||Pi&&8<Pi&&11>=Pi),_s=" ",Lo=!1;function Ao(i,A){switch(i){case"keyup":return To.indexOf(A.keyCode)!==-1;case"keydown":return A.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function KA(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var fl=!1;function Yn(i,A){switch(i){case"compositionend":return KA(A);case"keypress":return A.which!==32?null:(Lo=!0,_s);case"textInput":return i=A.data,i===_s&&Lo?null:i;default:return null}}function Tl(i,A){if(fl)return i==="compositionend"||!dl&&Ao(i,A)?(i=Xn(),Cl=AA=fi=null,fl=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(A.ctrlKey||A.altKey||A.metaKey)||A.ctrlKey&&A.altKey){if(A.char&&1<A.char.length)return A.char;if(A.which)return String.fromCharCode(A.which)}return null;case"compositionend":return oo&&A.locale!=="ko"?null:A.data;default:return null}}var jc={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function uA(i){var A=i&&i.nodeName&&i.nodeName.toLowerCase();return A==="input"?!!jc[i.type]:A==="textarea"}function hi(i,A,d,p){di?Sr?Sr.push(p):Sr=[p]:di=p,A=Qg(A,"onChange"),0<A.length&&(d=new Mi("onChange","change",null,d,p),i.push({event:d,listeners:A}))}var hl=null,Ll=null;function jo(i){w5(i,0)}function qi(i){var A=yt(i);if(Lr(A))return i}function Uo(i,A){if(i==="change")return A}var Jn=!1;if(hn){var jn;if(hn){var Ki="oninput"in document;if(!Ki){var Un=document.createElement("div");Un.setAttribute("oninput","return;"),Ki=typeof Un.oninput=="function"}jn=Ki}else jn=!1;Jn=jn&&(!document.documentMode||9<document.documentMode)}function co(){hl&&(hl.detachEvent("onpropertychange",zA),Ll=hl=null)}function zA(i){if(i.propertyName==="value"&&qi(Ll)){var A=[];hi(A,Ll,i,No(i)),HA(jo,A)}}function dA(i,A,d){i==="focusin"?(co(),hl=A,Ll=d,hl.attachEvent("onpropertychange",zA)):i==="focusout"&&co()}function ys(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return qi(Ll)}function fu(i,A){if(i==="click")return qi(A)}function jl(i,A){if(i==="input"||i==="change")return qi(A)}function Ul(i,A){return i===A&&(i!==0||1/i===1/A)||i!==i&&A!==A}var zs=typeof Object.is=="function"?Object.is:Ul;function Dl(i,A){if(zs(i,A))return!0;if(typeof i!="object"||i===null||typeof A!="object"||A===null)return!1;var d=Object.keys(i),p=Object.keys(A);if(d.length!==p.length)return!1;for(p=0;p<d.length;p++){var _=d[p];if(!Ge.call(A,_)||!zs(i[_],A[_]))return!1}return!0}function VA(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function GA(i,A){var d=VA(i);i=0;for(var p;d;){if(d.nodeType===3){if(p=i+d.textContent.length,i<=A&&p>=A)return{node:d,offset:A-i};i=p}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=VA(d)}}function zi(i,A){return i&&A?i===A?!0:i&&i.nodeType===3?!1:A&&A.nodeType===3?zi(i,A.parentNode):"contains"in i?i.contains(A):i.compareDocumentPosition?!!(i.compareDocumentPosition(A)&16):!1:!1}function Ds(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var A=Ia(i.document);A instanceof i.HTMLIFrameElement;){try{var d=typeof A.contentWindow.location.href=="string"}catch{d=!1}if(d)i=A.contentWindow;else break;A=Ia(i.document)}return A}function Vi(i){var A=i&&i.nodeName&&i.nodeName.toLowerCase();return A&&(A==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||A==="textarea"||i.contentEditable==="true")}var fA=hn&&"documentMode"in document&&11>=document.documentMode,Zn=null,pi=null,Dn=null,Gi=!1;function X(i,A,d){var p=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Gi||Zn==null||Zn!==Ia(p)||(p=Zn,"selectionStart"in p&&Vi(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Dn&&Dl(Dn,p)||(Dn=p,p=Qg(pi,"onSelect"),0<p.length&&(A=new Mi("onSelect","select",null,A,d),i.push({event:A,listeners:p}),A.target=Zn)))}function Ee(i,A){var d={};return d[i.toLowerCase()]=A.toLowerCase(),d["Webkit"+i]="webkit"+A,d["Moz"+i]="moz"+A,d}var Ke={animationend:Ee("Animation","AnimationEnd"),animationiteration:Ee("Animation","AnimationIteration"),animationstart:Ee("Animation","AnimationStart"),transitionrun:Ee("Transition","TransitionRun"),transitionstart:Ee("Transition","TransitionStart"),transitioncancel:Ee("Transition","TransitionCancel"),transitionend:Ee("Transition","TransitionEnd")},ft={},nr={};hn&&(nr=document.createElement("div").style,"AnimationEvent"in window||(delete Ke.animationend.animation,delete Ke.animationiteration.animation,delete Ke.animationstart.animation),"TransitionEvent"in window||delete Ke.transitionend.transition);function ir(i){if(ft[i])return ft[i];if(!Ke[i])return i;var A=Ke[i],d;for(d in A)if(A.hasOwnProperty(d)&&d in nr)return ft[i]=A[d];return i}var Br=ir("animationend"),Or=ir("animationiteration"),Pr=ir("animationstart"),Aa=ir("transitionrun"),In=ir("transitionstart"),Zr=ir("transitioncancel"),qr=ir("transitionend"),fa=new Map,gs="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");gs.push("scrollEnd");function es(i,A){fa.set(i,A),oa(A,[i])}var Zs=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var A=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(A))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},La=[],_a=0,Wi=0;function Il(){for(var i=_a,A=Wi=_a=0;A<i;){var d=La[A];La[A++]=null;var p=La[A];La[A++]=null;var _=La[A];La[A++]=null;var C=La[A];if(La[A++]=null,p!==null&&_!==null){var W=p.pending;W===null?_.next=_:(_.next=W.next,W.next=_),p.pending=_}C!==0&&hA(d,_,C)}}function uo(i,A,d,p){La[_a++]=i,La[_a++]=A,La[_a++]=d,La[_a++]=p,Wi|=p,i.lanes|=p,i=i.alternate,i!==null&&(i.lanes|=p)}function hu(i,A,d,p){return uo(i,A,d,p),Qn(i)}function Ei(i,A){return uo(i,null,null,A),Qn(i)}function hA(i,A,d){i.lanes|=d;var p=i.alternate;p!==null&&(p.lanes|=d);for(var _=!1,C=i.return;C!==null;)C.childLanes|=d,p=C.alternate,p!==null&&(p.childLanes|=d),C.tag===22&&(i=C.stateNode,i===null||i._visibility&1||(_=!0)),i=C,C=C.return;return i.tag===3?(C=i.stateNode,_&&A!==null&&(_=31-vr(d),i=C.hiddenUpdates,p=i[_],p===null?i[_]=[A]:p.push(A),A.lane=d|536870912),C):null}function Qn(i){if(50<hh)throw hh=0,A1=null,Error(a(185));for(var A=i.return;A!==null;)i=A,A=i.return;return i.tag===3?i.stateNode:null}var gn={};function Do(i,A,d,p){this.tag=i,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=A,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xr(i,A,d,p){return new Do(i,A,d,p)}function pl(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Ql(i,A){var d=i.alternate;return d===null?(d=xr(i.tag,A,i.key,i.mode),d.elementType=i.elementType,d.type=i.type,d.stateNode=i.stateNode,d.alternate=i,i.alternate=d):(d.pendingProps=A,d.type=i.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=i.flags&65011712,d.childLanes=i.childLanes,d.lanes=i.lanes,d.child=i.child,d.memoizedProps=i.memoizedProps,d.memoizedState=i.memoizedState,d.updateQueue=i.updateQueue,A=i.dependencies,d.dependencies=A===null?null:{lanes:A.lanes,firstContext:A.firstContext},d.sibling=i.sibling,d.index=i.index,d.ref=i.ref,d.refCleanup=i.refCleanup,d}function b0(i,A){i.flags&=65011714;var d=i.alternate;return d===null?(i.childLanes=0,i.lanes=A,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=d.childLanes,i.lanes=d.lanes,i.child=d.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=d.memoizedProps,i.memoizedState=d.memoizedState,i.updateQueue=d.updateQueue,i.type=d.type,A=d.dependencies,i.dependencies=A===null?null:{lanes:A.lanes,firstContext:A.firstContext}),i}function pu(i,A,d,p,_,C){var W=0;if(p=i,typeof i=="function")pl(i)&&(W=1);else if(typeof i=="string")W=p8(i,d,I.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case U:return i=xr(31,d,A,_),i.elementType=U,i.lanes=C,i;case v:return WA(d.children,_,C,A);case B:W=8,_|=24;break;case k:return i=xr(12,d,A,_|2),i.elementType=k,i.lanes=C,i;case P:return i=xr(13,d,A,_),i.elementType=P,i.lanes=C,i;case R:return i=xr(19,d,A,_),i.elementType=R,i.lanes=C,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case S:W=10;break e;case E:W=9;break e;case L:W=11;break e;case Q:W=14;break e;case V:W=16,p=null;break e}W=29,d=Error(a(130,i===null?"null":typeof i,"")),p=null}return A=xr(W,d,A,_),A.elementType=i,A.type=p,A.lanes=C,A}function WA(i,A,d,p){return i=xr(7,i,p,A),i.lanes=d,i}function v0(i,A,d){return i=xr(6,i,null,A),i.lanes=d,i}function dd(i){var A=xr(18,null,null,0);return A.stateNode=i,A}function gu(i,A,d){return A=xr(4,i.children!==null?i.children:[],i.key,A),A.lanes=d,A.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},A}var fd=new WeakMap;function Ol(i,A){if(typeof i=="object"&&i!==null){var d=fd.get(i);return d!==void 0?d:(A={value:i,source:A,stack:at(A)},fd.set(i,A),A)}return{value:i,source:A,stack:at(A)}}var mu=[],Uc=0,hd=null,w0=0,Rl=[],Ml=0,$A=null,Hl=1,Pl="";function gl(i,A){mu[Uc++]=w0,mu[Uc++]=hd,hd=i,w0=A}function Ag(i,A,d){Rl[Ml++]=Hl,Rl[Ml++]=Pl,Rl[Ml++]=$A,$A=i;var p=Hl;i=Pl;var _=32-vr(p)-1;p&=~(1<<_),d+=1;var C=32-vr(A)+_;if(30<C){var W=_-_%5;C=(p&(1<<W)-1).toString(32),p>>=W,_-=W,Hl=1<<32-vr(A)+_|d<<_|p,Pl=C+i}else Hl=1<<C|d<<_|p,Pl=i}function Gf(i){i.return!==null&&(gl(i,1),Ag(i,1,0))}function pd(i){for(;i===hd;)hd=mu[--Uc],mu[Uc]=null,w0=mu[--Uc],mu[Uc]=null;for(;i===$A;)$A=Rl[--Ml],Rl[Ml]=null,Pl=Rl[--Ml],Rl[Ml]=null,Hl=Rl[--Ml],Rl[Ml]=null}function cg(i,A){Rl[Ml++]=Hl,Rl[Ml++]=Pl,Rl[Ml++]=$A,Hl=A.id,Pl=A.overflow,$A=i}var ei=null,os=null,ha=!1,Fi=null,Is=!1,fo=Error(a(519));function XA(i){var A=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw xu(Ol(A,i)),fo}function Wf(i){var A=i.stateNode,d=i.type,p=i.memoizedProps;switch(A[be]=i,A[ye]=p,d){case"dialog":ga("cancel",A),ga("close",A);break;case"iframe":case"object":case"embed":ga("load",A);break;case"video":case"audio":for(d=0;d<gh.length;d++)ga(gh[d],A);break;case"source":ga("error",A);break;case"img":case"image":case"link":ga("error",A),ga("load",A);break;case"details":ga("toggle",A);break;case"input":ga("invalid",A),Ln(A,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0);break;case"select":ga("invalid",A);break;case"textarea":ga("invalid",A),iA(A,p.value,p.defaultValue,p.children)}d=p.children,typeof d!="string"&&typeof d!="number"&&typeof d!="bigint"||A.textContent===""+d||p.suppressHydrationWarning===!0||B5(A.textContent,d)?(p.popover!=null&&(ga("beforetoggle",A),ga("toggle",A)),p.onScroll!=null&&ga("scroll",A),p.onScrollEnd!=null&&ga("scrollend",A),p.onClick!=null&&(A.onclick=cl),A=!0):A=!1,A||XA(i,!0)}function pA(i){for(ei=i.return;ei;)switch(ei.tag){case 5:case 31:case 13:Is=!1;return;case 27:case 3:Is=!0;return;default:ei=ei.return}}function ti(i){if(i!==ei)return!1;if(!ha)return pA(i),ha=!0,!1;var A=i.tag,d;if((d=A!==3&&A!==27)&&((d=A===5)&&(d=i.type,d=!(d!=="form"&&d!=="button")||k1(i.type,i.memoizedProps)),d=!d),d&&os&&XA(i),pA(i),A===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(317));os=U5(i)}else if(A===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(317));os=U5(i)}else A===27?(A=os,Lu(i.type)?(i=E1,E1=null,os=i):os=A):os=ei?Ro(i.stateNode.nextSibling):null;return!0}function Dc(){os=ei=null,ha=!1}function $f(){var i=Fi;return i!==null&&(Wl===null?Wl=i:Wl.push.apply(Wl,i),Fi=null),i}function xu(i){Fi===null?Fi=[i]:Fi.push(i)}var gd=je(null),YA=null,Io=null;function JA(i,A,d){K(gd,A._currentValue),A._currentValue=d}function ql(i){i._currentValue=gd.current,F(gd)}function bu(i,A,d){for(;i!==null;){var p=i.alternate;if((i.childLanes&A)!==A?(i.childLanes|=A,p!==null&&(p.childLanes|=A)):p!==null&&(p.childLanes&A)!==A&&(p.childLanes|=A),i===d)break;i=i.return}}function Ic(i,A,d,p){var _=i.child;for(_!==null&&(_.return=i);_!==null;){var C=_.dependencies;if(C!==null){var W=_.child;C=C.firstContext;e:for(;C!==null;){var ge=C;C=_;for(var De=0;De<A.length;De++)if(ge.context===A[De]){C.lanes|=d,ge=C.alternate,ge!==null&&(ge.lanes|=d),bu(C.return,d,i),p||(W=null);break e}C=ge.next}}else if(_.tag===18){if(W=_.return,W===null)throw Error(a(341));W.lanes|=d,C=W.alternate,C!==null&&(C.lanes|=d),bu(W,d,i),W=null}else W=_.child;if(W!==null)W.return=_;else for(W=_;W!==null;){if(W===i){W=null;break}if(_=W.sibling,_!==null){_.return=W.return,W=_;break}W=W.return}_=W}}function ZA(i,A,d,p){i=null;for(var _=A,C=!1;_!==null;){if(!C){if((_.flags&524288)!==0)C=!0;else if((_.flags&262144)!==0)break}if(_.tag===10){var W=_.alternate;if(W===null)throw Error(a(387));if(W=W.memoizedProps,W!==null){var ge=_.type;zs(_.pendingProps.value,W.value)||(i!==null?i.push(ge):i=[ge])}}else if(_===Y.current){if(W=_.alternate,W===null)throw Error(a(387));W.memoizedState.memoizedState!==_.memoizedState.memoizedState&&(i!==null?i.push(wh):i=[wh])}_=_.return}i!==null&&Ic(A,i,d,p),A.flags|=262144}function md(i){for(i=i.firstContext;i!==null;){if(!zs(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function ec(i){YA=i,Io=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function ri(i){return ug(YA,i)}function xd(i,A){return YA===null&&ec(i),ug(i,A)}function ug(i,A){var d=A._currentValue;if(A={context:A,memoizedValue:d,next:null},Io===null){if(i===null)throw Error(a(308));Io=A,i.dependencies={lanes:0,firstContext:A},i.flags|=524288}else Io=Io.next=A;return d}var Nb=typeof AbortController<"u"?AbortController:function(){var i=[],A=this.signal={aborted:!1,addEventListener:function(d,p){i.push(p)}};this.abort=function(){A.aborted=!0,i.forEach(function(d){return d()})}},Eb=e.unstable_scheduleCallback,Fb=e.unstable_NormalPriority,Vs={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function vu(){return{controller:new Nb,data:new Map,refCount:0}}function _0(i){i.refCount--,i.refCount===0&&Eb(Fb,function(){i.controller.abort()})}var y0=null,bd=0,b=0,y=null;function j(i,A){if(y0===null){var d=y0=[];bd=0,b=p1(),y={status:"pending",value:void 0,then:function(p){d.push(p)}}}return bd++,A.then(z,z),A}function z(){if(--bd===0&&y0!==null){y!==null&&(y.status="fulfilled");var i=y0;y0=null,b=0,y=null;for(var A=0;A<i.length;A++)(0,i[A])()}}function ie(i,A){var d=[],p={status:"pending",value:null,reason:null,then:function(_){d.push(_)}};return i.then(function(){p.status="fulfilled",p.value=A;for(var _=0;_<d.length;_++)(0,d[_])(A)},function(_){for(p.status="rejected",p.reason=_,_=0;_<d.length;_++)(0,d[_])(void 0)}),p}var fe=ee.S;ee.S=function(i,A){$y=Ot(),typeof A=="object"&&A!==null&&typeof A.then=="function"&&j(i,A),fe!==null&&fe(i,A)};var he=je(null);function xe(){var i=he.current;return i!==null?i:cs.pooledCache}function _e(i,A){A===null?K(he,he.current):K(he,A.pool)}function Ce(){var i=xe();return i===null?null:{parent:Vs._currentValue,pool:i}}var Oe=Error(a(460)),Xe=Error(a(474)),Be=Error(a(542)),Pe={then:function(){}};function We(i){return i=i.status,i==="fulfilled"||i==="rejected"}function ot(i,A,d){switch(d=i[d],d===void 0?i.push(A):d!==A&&(A.then(cl,cl),A=d),A.status){case"fulfilled":return A.value;case"rejected":throw i=A.reason,Lt(i),i;default:if(typeof A.status=="string")A.then(cl,cl);else{if(i=cs,i!==null&&100<i.shellSuspendCounter)throw Error(a(482));i=A,i.status="pending",i.then(function(p){if(A.status==="pending"){var _=A;_.status="fulfilled",_.value=p}},function(p){if(A.status==="pending"){var _=A;_.status="rejected",_.reason=p}})}switch(A.status){case"fulfilled":return A.value;case"rejected":throw i=A.reason,Lt(i),i}throw lt=A,Oe}}function $e(i){try{var A=i._init;return A(i._payload)}catch(d){throw d!==null&&typeof d=="object"&&typeof d.then=="function"?(lt=d,Oe):d}}var lt=null;function dt(){if(lt===null)throw Error(a(459));var i=lt;return lt=null,i}function Lt(i){if(i===Oe||i===Be)throw Error(a(483))}var bt=null,gr=0;function lr(i){var A=gr;return gr+=1,bt===null&&(bt=[]),ot(bt,i,A)}function $r(i,A){A=A.props.ref,i.ref=A!==void 0?A:null}function ur(i,A){throw A.$$typeof===x?Error(a(525)):(i=Object.prototype.toString.call(A),Error(a(31,i==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":i)))}function ca(i){function A(Ve,Me){if(i){var Je=Ve.deletions;Je===null?(Ve.deletions=[Me],Ve.flags|=16):Je.push(Me)}}function d(Ve,Me){if(!i)return null;for(;Me!==null;)A(Ve,Me),Me=Me.sibling;return null}function p(Ve){for(var Me=new Map;Ve!==null;)Ve.key!==null?Me.set(Ve.key,Ve):Me.set(Ve.index,Ve),Ve=Ve.sibling;return Me}function _(Ve,Me){return Ve=Ql(Ve,Me),Ve.index=0,Ve.sibling=null,Ve}function C(Ve,Me,Je){return Ve.index=Je,i?(Je=Ve.alternate,Je!==null?(Je=Je.index,Je<Me?(Ve.flags|=67108866,Me):Je):(Ve.flags|=67108866,Me)):(Ve.flags|=1048576,Me)}function W(Ve){return i&&Ve.alternate===null&&(Ve.flags|=67108866),Ve}function ge(Ve,Me,Je,ht){return Me===null||Me.tag!==6?(Me=v0(Je,Ve.mode,ht),Me.return=Ve,Me):(Me=_(Me,Je),Me.return=Ve,Me)}function De(Ve,Me,Je,ht){var Fr=Je.type;return Fr===v?ut(Ve,Me,Je.props.children,ht,Je.key):Me!==null&&(Me.elementType===Fr||typeof Fr=="object"&&Fr!==null&&Fr.$$typeof===V&&$e(Fr)===Me.type)?(Me=_(Me,Je.props),$r(Me,Je),Me.return=Ve,Me):(Me=pu(Je.type,Je.key,Je.props,null,Ve.mode,ht),$r(Me,Je),Me.return=Ve,Me)}function Ze(Ve,Me,Je,ht){return Me===null||Me.tag!==4||Me.stateNode.containerInfo!==Je.containerInfo||Me.stateNode.implementation!==Je.implementation?(Me=gu(Je,Ve.mode,ht),Me.return=Ve,Me):(Me=_(Me,Je.children||[]),Me.return=Ve,Me)}function ut(Ve,Me,Je,ht,Fr){return Me===null||Me.tag!==7?(Me=WA(Je,Ve.mode,ht,Fr),Me.return=Ve,Me):(Me=_(Me,Je),Me.return=Ve,Me)}function xt(Ve,Me,Je){if(typeof Me=="string"&&Me!==""||typeof Me=="number"||typeof Me=="bigint")return Me=v0(""+Me,Ve.mode,Je),Me.return=Ve,Me;if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case m:return Je=pu(Me.type,Me.key,Me.props,null,Ve.mode,Je),$r(Je,Me),Je.return=Ve,Je;case w:return Me=gu(Me,Ve.mode,Je),Me.return=Ve,Me;case V:return Me=$e(Me),xt(Ve,Me,Je)}if(H(Me)||D(Me))return Me=WA(Me,Ve.mode,Je,null),Me.return=Ve,Me;if(typeof Me.then=="function")return xt(Ve,lr(Me),Je);if(Me.$$typeof===S)return xt(Ve,xd(Ve,Me),Je);ur(Ve,Me)}return null}function et(Ve,Me,Je,ht){var Fr=Me!==null?Me.key:null;if(typeof Je=="string"&&Je!==""||typeof Je=="number"||typeof Je=="bigint")return Fr!==null?null:ge(Ve,Me,""+Je,ht);if(typeof Je=="object"&&Je!==null){switch(Je.$$typeof){case m:return Je.key===Fr?De(Ve,Me,Je,ht):null;case w:return Je.key===Fr?Ze(Ve,Me,Je,ht):null;case V:return Je=$e(Je),et(Ve,Me,Je,ht)}if(H(Je)||D(Je))return Fr!==null?null:ut(Ve,Me,Je,ht,null);if(typeof Je.then=="function")return et(Ve,Me,lr(Je),ht);if(Je.$$typeof===S)return et(Ve,Me,xd(Ve,Je),ht);ur(Ve,Je)}return null}function rt(Ve,Me,Je,ht,Fr){if(typeof ht=="string"&&ht!==""||typeof ht=="number"||typeof ht=="bigint")return Ve=Ve.get(Je)||null,ge(Me,Ve,""+ht,Fr);if(typeof ht=="object"&&ht!==null){switch(ht.$$typeof){case m:return Ve=Ve.get(ht.key===null?Je:ht.key)||null,De(Me,Ve,ht,Fr);case w:return Ve=Ve.get(ht.key===null?Je:ht.key)||null,Ze(Me,Ve,ht,Fr);case V:return ht=$e(ht),rt(Ve,Me,Je,ht,Fr)}if(H(ht)||D(ht))return Ve=Ve.get(Je)||null,ut(Me,Ve,ht,Fr,null);if(typeof ht.then=="function")return rt(Ve,Me,Je,lr(ht),Fr);if(ht.$$typeof===S)return rt(Ve,Me,Je,xd(Me,ht),Fr);ur(Me,ht)}return null}function hr(Ve,Me,Je,ht){for(var Fr=null,ja=null,br=Me,sa=Me=0,ba=null;br!==null&&sa<Je.length;sa++){br.index>sa?(ba=br,br=null):ba=br.sibling;var Ua=et(Ve,br,Je[sa],ht);if(Ua===null){br===null&&(br=ba);break}i&&br&&Ua.alternate===null&&A(Ve,br),Me=C(Ua,Me,sa),ja===null?Fr=Ua:ja.sibling=Ua,ja=Ua,br=ba}if(sa===Je.length)return d(Ve,br),ha&&gl(Ve,sa),Fr;if(br===null){for(;sa<Je.length;sa++)br=xt(Ve,Je[sa],ht),br!==null&&(Me=C(br,Me,sa),ja===null?Fr=br:ja.sibling=br,ja=br);return ha&&gl(Ve,sa),Fr}for(br=p(br);sa<Je.length;sa++)ba=rt(br,Ve,sa,Je[sa],ht),ba!==null&&(i&&ba.alternate!==null&&br.delete(ba.key===null?sa:ba.key),Me=C(ba,Me,sa),ja===null?Fr=ba:ja.sibling=ba,ja=ba);return i&&br.forEach(function(Qu){return A(Ve,Qu)}),ha&&gl(Ve,sa),Fr}function Ir(Ve,Me,Je,ht){if(Je==null)throw Error(a(151));for(var Fr=null,ja=null,br=Me,sa=Me=0,ba=null,Ua=Je.next();br!==null&&!Ua.done;sa++,Ua=Je.next()){br.index>sa?(ba=br,br=null):ba=br.sibling;var Qu=et(Ve,br,Ua.value,ht);if(Qu===null){br===null&&(br=ba);break}i&&br&&Qu.alternate===null&&A(Ve,br),Me=C(Qu,Me,sa),ja===null?Fr=Qu:ja.sibling=Qu,ja=Qu,br=ba}if(Ua.done)return d(Ve,br),ha&&gl(Ve,sa),Fr;if(br===null){for(;!Ua.done;sa++,Ua=Je.next())Ua=xt(Ve,Ua.value,ht),Ua!==null&&(Me=C(Ua,Me,sa),ja===null?Fr=Ua:ja.sibling=Ua,ja=Ua);return ha&&gl(Ve,sa),Fr}for(br=p(br);!Ua.done;sa++,Ua=Je.next())Ua=rt(br,Ve,sa,Ua.value,ht),Ua!==null&&(i&&Ua.alternate!==null&&br.delete(Ua.key===null?sa:Ua.key),Me=C(Ua,Me,sa),ja===null?Fr=Ua:ja.sibling=Ua,ja=Ua);return i&&br.forEach(function(C8){return A(Ve,C8)}),ha&&gl(Ve,sa),Fr}function ss(Ve,Me,Je,ht){if(typeof Je=="object"&&Je!==null&&Je.type===v&&Je.key===null&&(Je=Je.props.children),typeof Je=="object"&&Je!==null){switch(Je.$$typeof){case m:e:{for(var Fr=Je.key;Me!==null;){if(Me.key===Fr){if(Fr=Je.type,Fr===v){if(Me.tag===7){d(Ve,Me.sibling),ht=_(Me,Je.props.children),ht.return=Ve,Ve=ht;break e}}else if(Me.elementType===Fr||typeof Fr=="object"&&Fr!==null&&Fr.$$typeof===V&&$e(Fr)===Me.type){d(Ve,Me.sibling),ht=_(Me,Je.props),$r(ht,Je),ht.return=Ve,Ve=ht;break e}d(Ve,Me);break}else A(Ve,Me);Me=Me.sibling}Je.type===v?(ht=WA(Je.props.children,Ve.mode,ht,Je.key),ht.return=Ve,Ve=ht):(ht=pu(Je.type,Je.key,Je.props,null,Ve.mode,ht),$r(ht,Je),ht.return=Ve,Ve=ht)}return W(Ve);case w:e:{for(Fr=Je.key;Me!==null;){if(Me.key===Fr)if(Me.tag===4&&Me.stateNode.containerInfo===Je.containerInfo&&Me.stateNode.implementation===Je.implementation){d(Ve,Me.sibling),ht=_(Me,Je.children||[]),ht.return=Ve,Ve=ht;break e}else{d(Ve,Me);break}else A(Ve,Me);Me=Me.sibling}ht=gu(Je,Ve.mode,ht),ht.return=Ve,Ve=ht}return W(Ve);case V:return Je=$e(Je),ss(Ve,Me,Je,ht)}if(H(Je))return hr(Ve,Me,Je,ht);if(D(Je)){if(Fr=D(Je),typeof Fr!="function")throw Error(a(150));return Je=Fr.call(Je),Ir(Ve,Me,Je,ht)}if(typeof Je.then=="function")return ss(Ve,Me,lr(Je),ht);if(Je.$$typeof===S)return ss(Ve,Me,xd(Ve,Je),ht);ur(Ve,Je)}return typeof Je=="string"&&Je!==""||typeof Je=="number"||typeof Je=="bigint"?(Je=""+Je,Me!==null&&Me.tag===6?(d(Ve,Me.sibling),ht=_(Me,Je),ht.return=Ve,Ve=ht):(d(Ve,Me),ht=v0(Je,Ve.mode,ht),ht.return=Ve,Ve=ht),W(Ve)):d(Ve,Me)}return function(Ve,Me,Je,ht){try{gr=0;var Fr=ss(Ve,Me,Je,ht);return bt=null,Fr}catch(br){if(br===Oe||br===Be)throw br;var ja=xr(29,br,null,Ve.mode);return ja.lanes=ht,ja.return=Ve,ja}}}var As=ca(!0),ea=ca(!1),or=!1;function qt(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ks(i,A){i=i.updateQueue,A.updateQueue===i&&(A.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Dr(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function ra(i,A,d){var p=i.updateQueue;if(p===null)return null;if(p=p.shared,(Ra&2)!==0){var _=p.pending;return _===null?A.next=A:(A.next=_.next,_.next=A),p.pending=A,A=Qn(i),hA(i,null,d),A}return uo(i,p,A,d),Qn(i)}function Qa(i,A,d){if(A=A.updateQueue,A!==null&&(A=A.shared,(d&4194048)!==0)){var p=A.lanes;p&=i.pendingLanes,d|=p,A.lanes=d,Jr(i,d)}}function mn(i,A){var d=i.updateQueue,p=i.alternate;if(p!==null&&(p=p.updateQueue,d===p)){var _=null,C=null;if(d=d.firstBaseUpdate,d!==null){do{var W={lane:d.lane,tag:d.tag,payload:d.payload,callback:null,next:null};C===null?_=C=W:C=C.next=W,d=d.next}while(d!==null);C===null?_=C=A:C=C.next=A}else _=C=A;d={baseState:p.baseState,firstBaseUpdate:_,lastBaseUpdate:C,shared:p.shared,callbacks:p.callbacks},i.updateQueue=d;return}i=d.lastBaseUpdate,i===null?d.firstBaseUpdate=A:i.next=A,d.lastBaseUpdate=A}var ai=!1;function ts(){if(ai){var i=y;if(i!==null)throw i}}function en(i,A,d,p){ai=!1;var _=i.updateQueue;or=!1;var C=_.firstBaseUpdate,W=_.lastBaseUpdate,ge=_.shared.pending;if(ge!==null){_.shared.pending=null;var De=ge,Ze=De.next;De.next=null,W===null?C=Ze:W.next=Ze,W=De;var ut=i.alternate;ut!==null&&(ut=ut.updateQueue,ge=ut.lastBaseUpdate,ge!==W&&(ge===null?ut.firstBaseUpdate=Ze:ge.next=Ze,ut.lastBaseUpdate=De))}if(C!==null){var xt=_.baseState;W=0,ut=Ze=De=null,ge=C;do{var et=ge.lane&-536870913,rt=et!==ge.lane;if(rt?(xa&et)===et:(p&et)===et){et!==0&&et===b&&(ai=!0),ut!==null&&(ut=ut.next={lane:0,tag:ge.tag,payload:ge.payload,callback:null,next:null});e:{var hr=i,Ir=ge;et=A;var ss=d;switch(Ir.tag){case 1:if(hr=Ir.payload,typeof hr=="function"){xt=hr.call(ss,xt,et);break e}xt=hr;break e;case 3:hr.flags=hr.flags&-65537|128;case 0:if(hr=Ir.payload,et=typeof hr=="function"?hr.call(ss,xt,et):hr,et==null)break e;xt=g({},xt,et);break e;case 2:or=!0}}et=ge.callback,et!==null&&(i.flags|=64,rt&&(i.flags|=8192),rt=_.callbacks,rt===null?_.callbacks=[et]:rt.push(et))}else rt={lane:et,tag:ge.tag,payload:ge.payload,callback:ge.callback,next:null},ut===null?(Ze=ut=rt,De=xt):ut=ut.next=rt,W|=et;if(ge=ge.next,ge===null){if(ge=_.shared.pending,ge===null)break;rt=ge,ge=rt.next,rt.next=null,_.lastBaseUpdate=rt,_.shared.pending=null}}while(!0);ut===null&&(De=xt),_.baseState=De,_.firstBaseUpdate=Ze,_.lastBaseUpdate=ut,C===null&&(_.shared.lanes=0),Su|=W,i.lanes=W,i.memoizedState=xt}}function gi(i,A){if(typeof i!="function")throw Error(a(191,i));i.call(A)}function tn(i,A){var d=i.callbacks;if(d!==null)for(i.callbacks=null,i=0;i<d.length;i++)gi(d[i],A)}var ia=je(null),Ba=je(0);function Bs(i,A){i=Vc,K(Ba,i),K(ia,A),Vc=i|A.baseLanes}function Ea(){K(Ba,Vc),K(ia,ia.current)}function xn(){Vc=Ba.current,F(ia),F(Ba)}var Cs=je(null),Ca=null;function Gs(i){var A=i.alternate;K(ya,ya.current&1),K(Cs,i),Ca===null&&(A===null||ia.current!==null||A.memoizedState!==null)&&(Ca=i)}function Oa(i){K(ya,ya.current),K(Cs,i),Ca===null&&(Ca=i)}function rn(i){i.tag===22?(K(ya,ya.current),K(Cs,i),Ca===null&&(Ca=i)):an()}function an(){K(ya,ya.current),K(Cs,Cs.current)}function za(i){F(Cs),Ca===i&&(Ca=null),F(ya)}var ya=je(0);function mi(i){for(var A=i;A!==null;){if(A.tag===13){var d=A.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||S1(d)||N1(d)))return A}else if(A.tag===19&&(A.memoizedProps.revealOrder==="forwards"||A.memoizedProps.revealOrder==="backwards"||A.memoizedProps.revealOrder==="unstable_legacy-backwards"||A.memoizedProps.revealOrder==="together")){if((A.flags&128)!==0)return A}else if(A.child!==null){A.child.return=A,A=A.child;continue}if(A===i)break;for(;A.sibling===null;){if(A.return===null||A.return===i)return null;A=A.return}A.sibling.return=A.return,A=A.sibling}return null}var Qs=0,Nr=null,Er=null,Sa=null,$i=!1,Kl=!1,Ti=!1,sn=0,tc=0,rc=null,vd=0;function rs(){throw Error(a(321))}function Xf(i,A){if(A===null)return!1;for(var d=0;d<A.length&&d<i.length;d++)if(!zs(i[d],A[d]))return!1;return!0}function Yf(i,A,d,p,_,C){return Qs=C,Nr=A,A.memoizedState=null,A.updateQueue=null,A.lanes=0,ee.H=i===null||i.memoizedState===null?iy:Ob,Ti=!1,C=d(p,_),Ti=!1,Kl&&(C=gA(A,d,p,_)),wd(i),C}function wd(i){ee.H=nh;var A=Er!==null&&Er.next!==null;if(Qs=0,Sa=Er=Nr=null,$i=!1,tc=0,rc=null,A)throw Error(a(300));i===null||Rn||(i=i.dependencies,i!==null&&md(i)&&(Rn=!0))}function gA(i,A,d,p){Nr=i;var _=0;do{if(Kl&&(rc=null),tc=0,Kl=!1,25<=_)throw Error(a(301));if(_+=1,Sa=Er=null,i.updateQueue!=null){var C=i.updateQueue;C.lastEffect=null,C.events=null,C.stores=null,C.memoCache!=null&&(C.memoCache.index=0)}ee.H=ly,C=A(d,p)}while(Kl);return C}function Tb(){var i=ee.H,A=i.useState()[0];return A=typeof A.then=="function"?ac(A):A,i=i.useState()[0],(Er!==null?Er.memoizedState:null)!==i&&(Nr.flags|=1024),A}function Jf(){var i=sn!==0;return sn=0,i}function Zf(i,A,d){A.updateQueue=i.updateQueue,A.flags&=-2053,i.lanes&=~d}function _d(i){if($i){for(i=i.memoizedState;i!==null;){var A=i.queue;A!==null&&(A.pending=null),i=i.next}$i=!1}Qs=0,Sa=Er=Nr=null,Kl=!1,tc=sn=0,rc=null}function On(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Sa===null?Nr.memoizedState=Sa=i:Sa=Sa.next=i,Sa}function Os(){if(Er===null){var i=Nr.alternate;i=i!==null?i.memoizedState:null}else i=Er.next;var A=Sa===null?Nr.memoizedState:Sa.next;if(A!==null)Sa=A,Er=i;else{if(i===null)throw Nr.alternate===null?Error(a(467)):Error(a(310));Er=i,i={memoizedState:Er.memoizedState,baseState:Er.baseState,baseQueue:Er.baseQueue,queue:Er.queue,next:null},Sa===null?Nr.memoizedState=Sa=i:Sa=Sa.next=i}return Sa}function k0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ac(i){var A=tc;return tc+=1,rc===null&&(rc=[]),i=ot(rc,i,A),A=Nr,(Sa===null?A.memoizedState:Sa.next)===null&&(A=A.alternate,ee.H=A===null||A.memoizedState===null?iy:Ob),i}function wu(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return ac(i);if(i.$$typeof===S)return ri(i)}throw Error(a(438,String(i)))}function Qc(i){var A=null,d=Nr.updateQueue;if(d!==null&&(A=d.memoCache),A==null){var p=Nr.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(A={data:p.data.map(function(_){return _.slice()}),index:0})))}if(A==null&&(A={data:[],index:0}),d===null&&(d=k0(),Nr.updateQueue=d),d.memoCache=A,d=A.data[A.index],d===void 0)for(d=A.data[A.index]=Array(i),p=0;p<i;p++)d[p]=M;return A.index++,d}function Qo(i,A){return typeof A=="function"?A(i):A}function yd(i){var A=Os();return _u(A,Er,i)}function _u(i,A,d){var p=i.queue;if(p===null)throw Error(a(311));p.lastRenderedReducer=d;var _=i.baseQueue,C=p.pending;if(C!==null){if(_!==null){var W=_.next;_.next=C.next,C.next=W}A.baseQueue=_=C,p.pending=null}if(C=i.baseState,_===null)i.memoizedState=C;else{A=_.next;var ge=W=null,De=null,Ze=A,ut=!1;do{var xt=Ze.lane&-536870913;if(xt!==Ze.lane?(xa&xt)===xt:(Qs&xt)===xt){var et=Ze.revertLane;if(et===0)De!==null&&(De=De.next={lane:0,revertLane:0,gesture:null,action:Ze.action,hasEagerState:Ze.hasEagerState,eagerState:Ze.eagerState,next:null}),xt===b&&(ut=!0);else if((Qs&et)===et){Ze=Ze.next,et===b&&(ut=!0);continue}else xt={lane:0,revertLane:Ze.revertLane,gesture:null,action:Ze.action,hasEagerState:Ze.hasEagerState,eagerState:Ze.eagerState,next:null},De===null?(ge=De=xt,W=C):De=De.next=xt,Nr.lanes|=et,Su|=et;xt=Ze.action,Ti&&d(C,xt),C=Ze.hasEagerState?Ze.eagerState:d(C,xt)}else et={lane:xt,revertLane:Ze.revertLane,gesture:Ze.gesture,action:Ze.action,hasEagerState:Ze.hasEagerState,eagerState:Ze.eagerState,next:null},De===null?(ge=De=et,W=C):De=De.next=et,Nr.lanes|=xt,Su|=xt;Ze=Ze.next}while(Ze!==null&&Ze!==A);if(De===null?W=C:De.next=ge,!zs(C,i.memoizedState)&&(Rn=!0,ut&&(d=y,d!==null)))throw d;i.memoizedState=C,i.baseState=W,i.baseQueue=De,p.lastRenderedState=C}return _===null&&(p.lanes=0),[i.memoizedState,p.dispatch]}function kd(i){var A=Os(),d=A.queue;if(d===null)throw Error(a(311));d.lastRenderedReducer=i;var p=d.dispatch,_=d.pending,C=A.memoizedState;if(_!==null){d.pending=null;var W=_=_.next;do C=i(C,W.action),W=W.next;while(W!==_);zs(C,A.memoizedState)||(Rn=!0),A.memoizedState=C,A.baseQueue===null&&(A.baseState=C),d.lastRenderedState=C}return[C,p]}function Bd(i,A,d){var p=Nr,_=Os(),C=ha;if(C){if(d===void 0)throw Error(a(407));d=d()}else d=A();var W=!zs((Er||_).memoizedState,d);if(W&&(_.memoizedState=d,Rn=!0),_=_.queue,Lb(th.bind(null,p,_,i),[i]),_.getSnapshot!==A||W||Sa!==null&&Sa.memoizedState.tag&1){if(p.flags|=2048,Rc(9,{destroy:void 0},eh.bind(null,p,_,d,A),null),cs===null)throw Error(a(349));C||(Qs&127)!==0||mA(p,A,d)}return d}function mA(i,A,d){i.flags|=16384,i={getSnapshot:A,value:d},A=Nr.updateQueue,A===null?(A=k0(),Nr.updateQueue=A,A.stores=[i]):(d=A.stores,d===null?A.stores=[i]:d.push(i))}function eh(i,A,d,p){A.value=d,A.getSnapshot=p,dg(A)&&rh(i)}function th(i,A,d){return d(function(){dg(A)&&rh(i)})}function dg(i){var A=i.getSnapshot;i=i.value;try{var d=A();return!zs(i,d)}catch{return!0}}function rh(i){var A=Ei(i,2);A!==null&&$l(A,i,2)}function sc(i){var A=On();if(typeof i=="function"){var d=i;if(i=d(),Ti){$t(!0);try{d()}finally{$t(!1)}}}return A.memoizedState=A.baseState=i,A.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qo,lastRenderedState:i},A}function fg(i,A,d,p){return i.baseState=d,_u(i,Er,typeof p=="function"?p:Qo)}function hg(i,A,d,p,_){if(xg(i))throw Error(a(485));if(i=A.action,i!==null){var C={payload:_,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(W){C.listeners.push(W)}};ee.T!==null?d(!0):C.isTransition=!1,p(C),d=A.pending,d===null?(C.next=A.pending=C,pg(A,C)):(C.next=d.next,A.pending=d.next=C)}}function pg(i,A){var d=A.action,p=A.payload,_=i.state;if(A.isTransition){var C=ee.T,W={};ee.T=W;try{var ge=d(_,p),De=ee.S;De!==null&&De(W,ge),ah(i,A,ge)}catch(Ze){Oc(i,A,Ze)}finally{C!==null&&W.types!==null&&(C.types=W.types),ee.T=C}}else try{C=d(_,p),ah(i,A,C)}catch(Ze){Oc(i,A,Ze)}}function ah(i,A,d){d!==null&&typeof d=="object"&&typeof d.then=="function"?d.then(function(p){gg(i,A,p)},function(p){return Oc(i,A,p)}):gg(i,A,d)}function gg(i,A,d){A.status="fulfilled",A.value=d,Cd(A),i.state=d,A=i.pending,A!==null&&(d=A.next,d===A?i.pending=null:(d=d.next,A.next=d,pg(i,d)))}function Oc(i,A,d){var p=i.pending;if(i.pending=null,p!==null){p=p.next;do A.status="rejected",A.reason=d,Cd(A),A=A.next;while(A!==p)}i.action=null}function Cd(i){i=i.listeners;for(var A=0;A<i.length;A++)(0,i[A])()}function B0(i,A){return A}function Oo(i,A){if(ha){var d=cs.formState;if(d!==null){e:{var p=Nr;if(ha){if(os){t:{for(var _=os,C=Is;_.nodeType!==8;){if(!C){_=null;break t}if(_=Ro(_.nextSibling),_===null){_=null;break t}}C=_.data,_=C==="F!"||C==="F"?_:null}if(_){os=Ro(_.nextSibling),p=_.data==="F!";break e}}XA(p)}p=!1}p&&(A=d[0])}}return d=On(),d.memoizedState=d.baseState=A,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:B0,lastRenderedState:A},d.queue=p,d=ay.bind(null,Nr,p),p.dispatch=d,p=sc(!1),C=Qb.bind(null,Nr,!1,p.queue),p=On(),_={state:A,dispatch:null,action:i,pending:null},p.queue=_,d=hg.bind(null,Nr,_,C,d),_.dispatch=d,p.memoizedState=i,[A,d,!1]}function xA(i){var A=Os();return bA(A,Er,i)}function bA(i,A,d){if(A=_u(i,A,B0)[0],i=yd(Qo)[0],typeof A=="object"&&A!==null&&typeof A.then=="function")try{var p=ac(A)}catch(W){throw W===Oe?Be:W}else p=A;A=Os();var _=A.queue,C=_.dispatch;return d!==A.memoizedState&&(Nr.flags|=2048,Rc(9,{destroy:void 0},Sd.bind(null,_,d),null)),[p,C,i]}function Sd(i,A){i.action=A}function Nd(i){var A=Os(),d=Er;if(d!==null)return bA(A,d,i);Os(),A=A.memoizedState,d=Os();var p=d.queue.dispatch;return d.memoizedState=i,[A,p,!1]}function Rc(i,A,d,p){return i={tag:i,create:d,deps:p,inst:A,next:null},A=Nr.updateQueue,A===null&&(A=k0(),Nr.updateQueue=A),d=A.lastEffect,d===null?A.lastEffect=i.next=i:(p=d.next,d.next=i,i.next=p,A.lastEffect=i),i}function mg(){return Os().memoizedState}function yu(i,A,d,p){var _=On();Nr.flags|=i,_.memoizedState=Rc(1|A,{destroy:void 0},d,p===void 0?null:p)}function ku(i,A,d,p){var _=Os();p=p===void 0?null:p;var C=_.memoizedState.inst;Er!==null&&p!==null&&Xf(p,Er.memoizedState.deps)?_.memoizedState=Rc(A,C,d,p):(Nr.flags|=i,_.memoizedState=Rc(1|A,C,d,p))}function q_(i,A){yu(8390656,8,i,A)}function Lb(i,A){ku(2048,8,i,A)}function v6(i){Nr.flags|=4;var A=Nr.updateQueue;if(A===null)A=k0(),Nr.updateQueue=A,A.events=[i];else{var d=A.events;d===null?A.events=[i]:d.push(i)}}function K_(i){var A=Os().memoizedState;return v6({ref:A,nextImpl:i}),function(){if((Ra&2)!==0)throw Error(a(440));return A.impl.apply(void 0,arguments)}}function z_(i,A){return ku(4,2,i,A)}function V_(i,A){return ku(4,4,i,A)}function G_(i,A){if(typeof A=="function"){i=i();var d=A(i);return function(){typeof d=="function"?d():A(null)}}if(A!=null)return i=i(),A.current=i,function(){A.current=null}}function W_(i,A,d){d=d!=null?d.concat([i]):null,ku(4,4,G_.bind(null,A,i),d)}function jb(){}function $_(i,A){var d=Os();A=A===void 0?null:A;var p=d.memoizedState;return A!==null&&Xf(A,p[1])?p[0]:(d.memoizedState=[i,A],i)}function X_(i,A){var d=Os();A=A===void 0?null:A;var p=d.memoizedState;if(A!==null&&Xf(A,p[1]))return p[0];if(p=i(),Ti){$t(!0);try{i()}finally{$t(!1)}}return d.memoizedState=[p,A],p}function Ub(i,A,d){return d===void 0||(Qs&1073741824)!==0&&(xa&261930)===0?i.memoizedState=A:(i.memoizedState=d,i=Yy(),Nr.lanes|=i,Su|=i,d)}function Y_(i,A,d,p){return zs(d,A)?d:ia.current!==null?(i=Ub(i,d,p),zs(i,A)||(Rn=!0),i):(Qs&42)===0||(Qs&1073741824)!==0&&(xa&261930)===0?(Rn=!0,i.memoizedState=d):(i=Yy(),Nr.lanes|=i,Su|=i,A)}function J_(i,A,d,p,_){var C=le.p;le.p=C!==0&&8>C?C:8;var W=ee.T,ge={};ee.T=ge,Qb(i,!1,A,d);try{var De=_(),Ze=ee.S;if(Ze!==null&&Ze(ge,De),De!==null&&typeof De=="object"&&typeof De.then=="function"){var ut=ie(De,p);sh(i,A,ut,go(i))}else sh(i,A,p,go(i))}catch(xt){sh(i,A,{then:function(){},status:"rejected",reason:xt},go())}finally{le.p=C,W!==null&&ge.types!==null&&(W.types=ge.types),ee.T=W}}function w6(){}function Db(i,A,d,p){if(i.tag!==5)throw Error(a(476));var _=Z_(i).queue;J_(i,_,A,pe,d===null?w6:function(){return ey(i),d(p)})}function Z_(i){var A=i.memoizedState;if(A!==null)return A;A={memoizedState:pe,baseState:pe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qo,lastRenderedState:pe},next:null};var d={};return A.next={memoizedState:d,baseState:d,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qo,lastRenderedState:d},next:null},i.memoizedState=A,i=i.alternate,i!==null&&(i.memoizedState=A),A}function ey(i){var A=Z_(i);A.next===null&&(A=i.alternate.memoizedState),sh(i,A.next.queue,{},go())}function Ib(){return ri(wh)}function ty(){return Os().memoizedState}function ry(){return Os().memoizedState}function _6(i){for(var A=i.return;A!==null;){switch(A.tag){case 24:case 3:var d=go();i=Dr(d);var p=ra(A,i,d);p!==null&&($l(p,A,d),Qa(p,A,d)),A={cache:vu()},i.payload=A;return}A=A.return}}function y6(i,A,d){var p=go();d={lane:p,revertLane:0,gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},xg(i)?sy(A,d):(d=hu(i,A,d,p),d!==null&&($l(d,i,p),ny(d,A,p)))}function ay(i,A,d){var p=go();sh(i,A,d,p)}function sh(i,A,d,p){var _={lane:p,revertLane:0,gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null};if(xg(i))sy(A,_);else{var C=i.alternate;if(i.lanes===0&&(C===null||C.lanes===0)&&(C=A.lastRenderedReducer,C!==null))try{var W=A.lastRenderedState,ge=C(W,d);if(_.hasEagerState=!0,_.eagerState=ge,zs(ge,W))return uo(i,A,_,0),cs===null&&Il(),!1}catch{}if(d=hu(i,A,_,p),d!==null)return $l(d,i,p),ny(d,A,p),!0}return!1}function Qb(i,A,d,p){if(p={lane:2,revertLane:p1(),gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},xg(i)){if(A)throw Error(a(479))}else A=hu(i,d,p,2),A!==null&&$l(A,i,2)}function xg(i){var A=i.alternate;return i===Nr||A!==null&&A===Nr}function sy(i,A){Kl=$i=!0;var d=i.pending;d===null?A.next=A:(A.next=d.next,d.next=A),i.pending=A}function ny(i,A,d){if((d&4194048)!==0){var p=A.lanes;p&=i.pendingLanes,d|=p,A.lanes=d,Jr(i,d)}}var nh={readContext:ri,use:wu,useCallback:rs,useContext:rs,useEffect:rs,useImperativeHandle:rs,useLayoutEffect:rs,useInsertionEffect:rs,useMemo:rs,useReducer:rs,useRef:rs,useState:rs,useDebugValue:rs,useDeferredValue:rs,useTransition:rs,useSyncExternalStore:rs,useId:rs,useHostTransitionStatus:rs,useFormState:rs,useActionState:rs,useOptimistic:rs,useMemoCache:rs,useCacheRefresh:rs};nh.useEffectEvent=rs;var iy={readContext:ri,use:wu,useCallback:function(i,A){return On().memoizedState=[i,A===void 0?null:A],i},useContext:ri,useEffect:q_,useImperativeHandle:function(i,A,d){d=d!=null?d.concat([i]):null,yu(4194308,4,G_.bind(null,A,i),d)},useLayoutEffect:function(i,A){return yu(4194308,4,i,A)},useInsertionEffect:function(i,A){yu(4,2,i,A)},useMemo:function(i,A){var d=On();A=A===void 0?null:A;var p=i();if(Ti){$t(!0);try{i()}finally{$t(!1)}}return d.memoizedState=[p,A],p},useReducer:function(i,A,d){var p=On();if(d!==void 0){var _=d(A);if(Ti){$t(!0);try{d(A)}finally{$t(!1)}}}else _=A;return p.memoizedState=p.baseState=_,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:_},p.queue=i,i=i.dispatch=y6.bind(null,Nr,i),[p.memoizedState,i]},useRef:function(i){var A=On();return i={current:i},A.memoizedState=i},useState:function(i){i=sc(i);var A=i.queue,d=ay.bind(null,Nr,A);return A.dispatch=d,[i.memoizedState,d]},useDebugValue:jb,useDeferredValue:function(i,A){var d=On();return Ub(d,i,A)},useTransition:function(){var i=sc(!1);return i=J_.bind(null,Nr,i.queue,!0,!1),On().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,A,d){var p=Nr,_=On();if(ha){if(d===void 0)throw Error(a(407));d=d()}else{if(d=A(),cs===null)throw Error(a(349));(xa&127)!==0||mA(p,A,d)}_.memoizedState=d;var C={value:d,getSnapshot:A};return _.queue=C,q_(th.bind(null,p,C,i),[i]),p.flags|=2048,Rc(9,{destroy:void 0},eh.bind(null,p,C,d,A),null),d},useId:function(){var i=On(),A=cs.identifierPrefix;if(ha){var d=Pl,p=Hl;d=(p&~(1<<32-vr(p)-1)).toString(32)+d,A="_"+A+"R_"+d,d=sn++,0<d&&(A+="H"+d.toString(32)),A+="_"}else d=vd++,A="_"+A+"r_"+d.toString(32)+"_";return i.memoizedState=A},useHostTransitionStatus:Ib,useFormState:Oo,useActionState:Oo,useOptimistic:function(i){var A=On();A.memoizedState=A.baseState=i;var d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return A.queue=d,A=Qb.bind(null,Nr,!0,d),d.dispatch=A,[i,A]},useMemoCache:Qc,useCacheRefresh:function(){return On().memoizedState=_6.bind(null,Nr)},useEffectEvent:function(i){var A=On(),d={impl:i};return A.memoizedState=d,function(){if((Ra&2)!==0)throw Error(a(440));return d.impl.apply(void 0,arguments)}}},Ob={readContext:ri,use:wu,useCallback:$_,useContext:ri,useEffect:Lb,useImperativeHandle:W_,useInsertionEffect:z_,useLayoutEffect:V_,useMemo:X_,useReducer:yd,useRef:mg,useState:function(){return yd(Qo)},useDebugValue:jb,useDeferredValue:function(i,A){var d=Os();return Y_(d,Er.memoizedState,i,A)},useTransition:function(){var i=yd(Qo)[0],A=Os().memoizedState;return[typeof i=="boolean"?i:ac(i),A]},useSyncExternalStore:Bd,useId:ty,useHostTransitionStatus:Ib,useFormState:xA,useActionState:xA,useOptimistic:function(i,A){var d=Os();return fg(d,Er,i,A)},useMemoCache:Qc,useCacheRefresh:ry};Ob.useEffectEvent=K_;var ly={readContext:ri,use:wu,useCallback:$_,useContext:ri,useEffect:Lb,useImperativeHandle:W_,useInsertionEffect:z_,useLayoutEffect:V_,useMemo:X_,useReducer:kd,useRef:mg,useState:function(){return kd(Qo)},useDebugValue:jb,useDeferredValue:function(i,A){var d=Os();return Er===null?Ub(d,i,A):Y_(d,Er.memoizedState,i,A)},useTransition:function(){var i=kd(Qo)[0],A=Os().memoizedState;return[typeof i=="boolean"?i:ac(i),A]},useSyncExternalStore:Bd,useId:ty,useHostTransitionStatus:Ib,useFormState:Nd,useActionState:Nd,useOptimistic:function(i,A){var d=Os();return Er!==null?fg(d,Er,i,A):(d.baseState=i,[i,d.queue.dispatch])},useMemoCache:Qc,useCacheRefresh:ry};ly.useEffectEvent=K_;function Rb(i,A,d,p){A=i.memoizedState,d=d(p,A),d=d==null?A:g({},A,d),i.memoizedState=d,i.lanes===0&&(i.updateQueue.baseState=d)}var Mb={enqueueSetState:function(i,A,d){i=i._reactInternals;var p=go(),_=Dr(p);_.payload=A,d!=null&&(_.callback=d),A=ra(i,_,p),A!==null&&($l(A,i,p),Qa(A,i,p))},enqueueReplaceState:function(i,A,d){i=i._reactInternals;var p=go(),_=Dr(p);_.tag=1,_.payload=A,d!=null&&(_.callback=d),A=ra(i,_,p),A!==null&&($l(A,i,p),Qa(A,i,p))},enqueueForceUpdate:function(i,A){i=i._reactInternals;var d=go(),p=Dr(d);p.tag=2,A!=null&&(p.callback=A),A=ra(i,p,d),A!==null&&($l(A,i,d),Qa(A,i,d))}};function oy(i,A,d,p,_,C,W){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(p,C,W):A.prototype&&A.prototype.isPureReactComponent?!Dl(d,p)||!Dl(_,C):!0}function Ay(i,A,d,p){i=A.state,typeof A.componentWillReceiveProps=="function"&&A.componentWillReceiveProps(d,p),typeof A.UNSAFE_componentWillReceiveProps=="function"&&A.UNSAFE_componentWillReceiveProps(d,p),A.state!==i&&Mb.enqueueReplaceState(A,A.state,null)}function C0(i,A){var d=A;if("ref"in A){d={};for(var p in A)p!=="ref"&&(d[p]=A[p])}if(i=i.defaultProps){d===A&&(d=g({},d));for(var _ in i)d[_]===void 0&&(d[_]=i[_])}return d}function cy(i){Zs(i)}function uy(i){console.error(i)}function dy(i){Zs(i)}function bg(i,A){try{var d=i.onUncaughtError;d(A.value,{componentStack:A.stack})}catch(p){setTimeout(function(){throw p})}}function fy(i,A,d){try{var p=i.onCaughtError;p(d.value,{componentStack:d.stack,errorBoundary:A.tag===1?A.stateNode:null})}catch(_){setTimeout(function(){throw _})}}function Hb(i,A,d){return d=Dr(d),d.tag=3,d.payload={element:null},d.callback=function(){bg(i,A)},d}function hy(i){return i=Dr(i),i.tag=3,i}function py(i,A,d,p){var _=d.type.getDerivedStateFromError;if(typeof _=="function"){var C=p.value;i.payload=function(){return _(C)},i.callback=function(){fy(A,d,p)}}var W=d.stateNode;W!==null&&typeof W.componentDidCatch=="function"&&(i.callback=function(){fy(A,d,p),typeof _!="function"&&(Nu===null?Nu=new Set([this]):Nu.add(this));var ge=p.stack;this.componentDidCatch(p.value,{componentStack:ge!==null?ge:""})})}function k6(i,A,d,p,_){if(d.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(A=d.alternate,A!==null&&ZA(A,d,_,!0),d=Cs.current,d!==null){switch(d.tag){case 31:case 13:return Ca===null?Tg():d.alternate===null&&nn===0&&(nn=3),d.flags&=-257,d.flags|=65536,d.lanes=_,p===Pe?d.flags|=16384:(A=d.updateQueue,A===null?d.updateQueue=new Set([p]):A.add(p),d1(i,p,_)),!1;case 22:return d.flags|=65536,p===Pe?d.flags|=16384:(A=d.updateQueue,A===null?(A={transitions:null,markerInstances:null,retryQueue:new Set([p])},d.updateQueue=A):(d=A.retryQueue,d===null?A.retryQueue=new Set([p]):d.add(p)),d1(i,p,_)),!1}throw Error(a(435,d.tag))}return d1(i,p,_),Tg(),!1}if(ha)return A=Cs.current,A!==null?((A.flags&65536)===0&&(A.flags|=256),A.flags|=65536,A.lanes=_,p!==fo&&(i=Error(a(422),{cause:p}),xu(Ol(i,d)))):(p!==fo&&(A=Error(a(423),{cause:p}),xu(Ol(A,d))),i=i.current.alternate,i.flags|=65536,_&=-_,i.lanes|=_,p=Ol(p,d),_=Hb(i.stateNode,p,_),mn(i,_),nn!==4&&(nn=2)),!1;var C=Error(a(520),{cause:p});if(C=Ol(C,d),fh===null?fh=[C]:fh.push(C),nn!==4&&(nn=2),A===null)return!0;p=Ol(p,d),d=A;do{switch(d.tag){case 3:return d.flags|=65536,i=_&-_,d.lanes|=i,i=Hb(d.stateNode,p,i),mn(d,i),!1;case 1:if(A=d.type,C=d.stateNode,(d.flags&128)===0&&(typeof A.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(Nu===null||!Nu.has(C))))return d.flags|=65536,_&=-_,d.lanes|=_,_=hy(_),py(_,i,d,p),mn(d,_),!1}d=d.return}while(d!==null);return!1}var Pb=Error(a(461)),Rn=!1;function Li(i,A,d,p){A.child=i===null?ea(A,null,d,p):As(A,i.child,d,p)}function gy(i,A,d,p,_){d=d.render;var C=A.ref;if("ref"in p){var W={};for(var ge in p)ge!=="ref"&&(W[ge]=p[ge])}else W=p;return ec(A),p=Yf(i,A,d,W,C,_),ge=Jf(),i!==null&&!Rn?(Zf(i,A,_),Mc(i,A,_)):(ha&&ge&&Gf(A),A.flags|=1,Li(i,A,p,_),A.child)}function my(i,A,d,p,_){if(i===null){var C=d.type;return typeof C=="function"&&!pl(C)&&C.defaultProps===void 0&&d.compare===null?(A.tag=15,A.type=C,xy(i,A,C,p,_)):(i=pu(d.type,null,p,A,A.mode,_),i.ref=A.ref,i.return=A,A.child=i)}if(C=i.child,!Xb(i,_)){var W=C.memoizedProps;if(d=d.compare,d=d!==null?d:Dl,d(W,p)&&i.ref===A.ref)return Mc(i,A,_)}return A.flags|=1,i=Ql(C,p),i.ref=A.ref,i.return=A,A.child=i}function xy(i,A,d,p,_){if(i!==null){var C=i.memoizedProps;if(Dl(C,p)&&i.ref===A.ref)if(Rn=!1,A.pendingProps=p=C,Xb(i,_))(i.flags&131072)!==0&&(Rn=!0);else return A.lanes=i.lanes,Mc(i,A,_)}return qb(i,A,d,p,_)}function by(i,A,d,p){var _=p.children,C=i!==null?i.memoizedState:null;if(i===null&&A.stateNode===null&&(A.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),p.mode==="hidden"){if((A.flags&128)!==0){if(C=C!==null?C.baseLanes|d:d,i!==null){for(p=A.child=i.child,_=0;p!==null;)_=_|p.lanes|p.childLanes,p=p.sibling;p=_&~C}else p=0,A.child=null;return vy(i,A,C,d,p)}if((d&536870912)!==0)A.memoizedState={baseLanes:0,cachePool:null},i!==null&&_e(A,C!==null?C.cachePool:null),C!==null?Bs(A,C):Ea(),rn(A);else return p=A.lanes=536870912,vy(i,A,C!==null?C.baseLanes|d:d,d,p)}else C!==null?(_e(A,C.cachePool),Bs(A,C),an(),A.memoizedState=null):(i!==null&&_e(A,null),Ea(),an());return Li(i,A,_,d),A.child}function ih(i,A){return i!==null&&i.tag===22||A.stateNode!==null||(A.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),A.sibling}function vy(i,A,d,p,_){var C=xe();return C=C===null?null:{parent:Vs._currentValue,pool:C},A.memoizedState={baseLanes:d,cachePool:C},i!==null&&_e(A,null),Ea(),rn(A),i!==null&&ZA(i,A,p,!0),A.childLanes=_,null}function vg(i,A){return A=_g({mode:A.mode,children:A.children},i.mode),A.ref=i.ref,i.child=A,A.return=i,A}function wy(i,A,d){return As(A,i.child,null,d),i=vg(A,A.pendingProps),i.flags|=2,za(A),A.memoizedState=null,i}function B6(i,A,d){var p=A.pendingProps,_=(A.flags&128)!==0;if(A.flags&=-129,i===null){if(ha){if(p.mode==="hidden")return i=vg(A,p),A.lanes=536870912,ih(null,i);if(Oa(A),(i=os)?(i=j5(i,Is),i=i!==null&&i.data==="&"?i:null,i!==null&&(A.memoizedState={dehydrated:i,treeContext:$A!==null?{id:Hl,overflow:Pl}:null,retryLane:536870912,hydrationErrors:null},d=dd(i),d.return=A,A.child=d,ei=A,os=null)):i=null,i===null)throw XA(A);return A.lanes=536870912,null}return vg(A,p)}var C=i.memoizedState;if(C!==null){var W=C.dehydrated;if(Oa(A),_)if(A.flags&256)A.flags&=-257,A=wy(i,A,d);else if(A.memoizedState!==null)A.child=i.child,A.flags|=128,A=null;else throw Error(a(558));else if(Rn||ZA(i,A,d,!1),_=(d&i.childLanes)!==0,Rn||_){if(p=cs,p!==null&&(W=jr(p,d),W!==0&&W!==C.retryLane))throw C.retryLane=W,Ei(i,W),$l(p,i,W),Pb;Tg(),A=wy(i,A,d)}else i=C.treeContext,os=Ro(W.nextSibling),ei=A,ha=!0,Fi=null,Is=!1,i!==null&&cg(A,i),A=vg(A,p),A.flags|=4096;return A}return i=Ql(i.child,{mode:p.mode,children:p.children}),i.ref=A.ref,A.child=i,i.return=A,i}function wg(i,A){var d=A.ref;if(d===null)i!==null&&i.ref!==null&&(A.flags|=4194816);else{if(typeof d!="function"&&typeof d!="object")throw Error(a(284));(i===null||i.ref!==d)&&(A.flags|=4194816)}}function qb(i,A,d,p,_){return ec(A),d=Yf(i,A,d,p,void 0,_),p=Jf(),i!==null&&!Rn?(Zf(i,A,_),Mc(i,A,_)):(ha&&p&&Gf(A),A.flags|=1,Li(i,A,d,_),A.child)}function _y(i,A,d,p,_,C){return ec(A),A.updateQueue=null,d=gA(A,p,d,_),wd(i),p=Jf(),i!==null&&!Rn?(Zf(i,A,C),Mc(i,A,C)):(ha&&p&&Gf(A),A.flags|=1,Li(i,A,d,C),A.child)}function yy(i,A,d,p,_){if(ec(A),A.stateNode===null){var C=gn,W=d.contextType;typeof W=="object"&&W!==null&&(C=ri(W)),C=new d(p,C),A.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,C.updater=Mb,A.stateNode=C,C._reactInternals=A,C=A.stateNode,C.props=p,C.state=A.memoizedState,C.refs={},qt(A),W=d.contextType,C.context=typeof W=="object"&&W!==null?ri(W):gn,C.state=A.memoizedState,W=d.getDerivedStateFromProps,typeof W=="function"&&(Rb(A,d,W,p),C.state=A.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof C.getSnapshotBeforeUpdate=="function"||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(W=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),W!==C.state&&Mb.enqueueReplaceState(C,C.state,null),en(A,p,C,_),ts(),C.state=A.memoizedState),typeof C.componentDidMount=="function"&&(A.flags|=4194308),p=!0}else if(i===null){C=A.stateNode;var ge=A.memoizedProps,De=C0(d,ge);C.props=De;var Ze=C.context,ut=d.contextType;W=gn,typeof ut=="object"&&ut!==null&&(W=ri(ut));var xt=d.getDerivedStateFromProps;ut=typeof xt=="function"||typeof C.getSnapshotBeforeUpdate=="function",ge=A.pendingProps!==ge,ut||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(ge||Ze!==W)&&Ay(A,C,p,W),or=!1;var et=A.memoizedState;C.state=et,en(A,p,C,_),ts(),Ze=A.memoizedState,ge||et!==Ze||or?(typeof xt=="function"&&(Rb(A,d,xt,p),Ze=A.memoizedState),(De=or||oy(A,d,De,p,et,Ze,W))?(ut||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount()),typeof C.componentDidMount=="function"&&(A.flags|=4194308)):(typeof C.componentDidMount=="function"&&(A.flags|=4194308),A.memoizedProps=p,A.memoizedState=Ze),C.props=p,C.state=Ze,C.context=W,p=De):(typeof C.componentDidMount=="function"&&(A.flags|=4194308),p=!1)}else{C=A.stateNode,ks(i,A),W=A.memoizedProps,ut=C0(d,W),C.props=ut,xt=A.pendingProps,et=C.context,Ze=d.contextType,De=gn,typeof Ze=="object"&&Ze!==null&&(De=ri(Ze)),ge=d.getDerivedStateFromProps,(Ze=typeof ge=="function"||typeof C.getSnapshotBeforeUpdate=="function")||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(W!==xt||et!==De)&&Ay(A,C,p,De),or=!1,et=A.memoizedState,C.state=et,en(A,p,C,_),ts();var rt=A.memoizedState;W!==xt||et!==rt||or||i!==null&&i.dependencies!==null&&md(i.dependencies)?(typeof ge=="function"&&(Rb(A,d,ge,p),rt=A.memoizedState),(ut=or||oy(A,d,ut,p,et,rt,De)||i!==null&&i.dependencies!==null&&md(i.dependencies))?(Ze||typeof C.UNSAFE_componentWillUpdate!="function"&&typeof C.componentWillUpdate!="function"||(typeof C.componentWillUpdate=="function"&&C.componentWillUpdate(p,rt,De),typeof C.UNSAFE_componentWillUpdate=="function"&&C.UNSAFE_componentWillUpdate(p,rt,De)),typeof C.componentDidUpdate=="function"&&(A.flags|=4),typeof C.getSnapshotBeforeUpdate=="function"&&(A.flags|=1024)):(typeof C.componentDidUpdate!="function"||W===i.memoizedProps&&et===i.memoizedState||(A.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||W===i.memoizedProps&&et===i.memoizedState||(A.flags|=1024),A.memoizedProps=p,A.memoizedState=rt),C.props=p,C.state=rt,C.context=De,p=ut):(typeof C.componentDidUpdate!="function"||W===i.memoizedProps&&et===i.memoizedState||(A.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||W===i.memoizedProps&&et===i.memoizedState||(A.flags|=1024),p=!1)}return C=p,wg(i,A),p=(A.flags&128)!==0,C||p?(C=A.stateNode,d=p&&typeof d.getDerivedStateFromError!="function"?null:C.render(),A.flags|=1,i!==null&&p?(A.child=As(A,i.child,null,_),A.child=As(A,null,d,_)):Li(i,A,d,_),A.memoizedState=C.state,i=A.child):i=Mc(i,A,_),i}function ky(i,A,d,p){return Dc(),A.flags|=256,Li(i,A,d,p),A.child}var Kb={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function zb(i){return{baseLanes:i,cachePool:Ce()}}function Vb(i,A,d){return i=i!==null?i.childLanes&~d:0,A&&(i|=po),i}function By(i,A,d){var p=A.pendingProps,_=!1,C=(A.flags&128)!==0,W;if((W=C)||(W=i!==null&&i.memoizedState===null?!1:(ya.current&2)!==0),W&&(_=!0,A.flags&=-129),W=(A.flags&32)!==0,A.flags&=-33,i===null){if(ha){if(_?Gs(A):an(),(i=os)?(i=j5(i,Is),i=i!==null&&i.data!=="&"?i:null,i!==null&&(A.memoizedState={dehydrated:i,treeContext:$A!==null?{id:Hl,overflow:Pl}:null,retryLane:536870912,hydrationErrors:null},d=dd(i),d.return=A,A.child=d,ei=A,os=null)):i=null,i===null)throw XA(A);return N1(i)?A.lanes=32:A.lanes=536870912,null}var ge=p.children;return p=p.fallback,_?(an(),_=A.mode,ge=_g({mode:"hidden",children:ge},_),p=WA(p,_,d,null),ge.return=A,p.return=A,ge.sibling=p,A.child=ge,p=A.child,p.memoizedState=zb(d),p.childLanes=Vb(i,W,d),A.memoizedState=Kb,ih(null,p)):(Gs(A),Gb(A,ge))}var De=i.memoizedState;if(De!==null&&(ge=De.dehydrated,ge!==null)){if(C)A.flags&256?(Gs(A),A.flags&=-257,A=Wb(i,A,d)):A.memoizedState!==null?(an(),A.child=i.child,A.flags|=128,A=null):(an(),ge=p.fallback,_=A.mode,p=_g({mode:"visible",children:p.children},_),ge=WA(ge,_,d,null),ge.flags|=2,p.return=A,ge.return=A,p.sibling=ge,A.child=p,As(A,i.child,null,d),p=A.child,p.memoizedState=zb(d),p.childLanes=Vb(i,W,d),A.memoizedState=Kb,A=ih(null,p));else if(Gs(A),N1(ge)){if(W=ge.nextSibling&&ge.nextSibling.dataset,W)var Ze=W.dgst;W=Ze,p=Error(a(419)),p.stack="",p.digest=W,xu({value:p,source:null,stack:null}),A=Wb(i,A,d)}else if(Rn||ZA(i,A,d,!1),W=(d&i.childLanes)!==0,Rn||W){if(W=cs,W!==null&&(p=jr(W,d),p!==0&&p!==De.retryLane))throw De.retryLane=p,Ei(i,p),$l(W,i,p),Pb;S1(ge)||Tg(),A=Wb(i,A,d)}else S1(ge)?(A.flags|=192,A.child=i.child,A=null):(i=De.treeContext,os=Ro(ge.nextSibling),ei=A,ha=!0,Fi=null,Is=!1,i!==null&&cg(A,i),A=Gb(A,p.children),A.flags|=4096);return A}return _?(an(),ge=p.fallback,_=A.mode,De=i.child,Ze=De.sibling,p=Ql(De,{mode:"hidden",children:p.children}),p.subtreeFlags=De.subtreeFlags&65011712,Ze!==null?ge=Ql(Ze,ge):(ge=WA(ge,_,d,null),ge.flags|=2),ge.return=A,p.return=A,p.sibling=ge,A.child=p,ih(null,p),p=A.child,ge=i.child.memoizedState,ge===null?ge=zb(d):(_=ge.cachePool,_!==null?(De=Vs._currentValue,_=_.parent!==De?{parent:De,pool:De}:_):_=Ce(),ge={baseLanes:ge.baseLanes|d,cachePool:_}),p.memoizedState=ge,p.childLanes=Vb(i,W,d),A.memoizedState=Kb,ih(i.child,p)):(Gs(A),d=i.child,i=d.sibling,d=Ql(d,{mode:"visible",children:p.children}),d.return=A,d.sibling=null,i!==null&&(W=A.deletions,W===null?(A.deletions=[i],A.flags|=16):W.push(i)),A.child=d,A.memoizedState=null,d)}function Gb(i,A){return A=_g({mode:"visible",children:A},i.mode),A.return=i,i.child=A}function _g(i,A){return i=xr(22,i,null,A),i.lanes=0,i}function Wb(i,A,d){return As(A,i.child,null,d),i=Gb(A,A.pendingProps.children),i.flags|=2,A.memoizedState=null,i}function Cy(i,A,d){i.lanes|=A;var p=i.alternate;p!==null&&(p.lanes|=A),bu(i.return,A,d)}function $b(i,A,d,p,_,C){var W=i.memoizedState;W===null?i.memoizedState={isBackwards:A,rendering:null,renderingStartTime:0,last:p,tail:d,tailMode:_,treeForkCount:C}:(W.isBackwards=A,W.rendering=null,W.renderingStartTime=0,W.last=p,W.tail=d,W.tailMode=_,W.treeForkCount=C)}function Sy(i,A,d){var p=A.pendingProps,_=p.revealOrder,C=p.tail;p=p.children;var W=ya.current,ge=(W&2)!==0;if(ge?(W=W&1|2,A.flags|=128):W&=1,K(ya,W),Li(i,A,p,d),p=ha?w0:0,!ge&&i!==null&&(i.flags&128)!==0)e:for(i=A.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Cy(i,d,A);else if(i.tag===19)Cy(i,d,A);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===A)break e;for(;i.sibling===null;){if(i.return===null||i.return===A)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(_){case"forwards":for(d=A.child,_=null;d!==null;)i=d.alternate,i!==null&&mi(i)===null&&(_=d),d=d.sibling;d=_,d===null?(_=A.child,A.child=null):(_=d.sibling,d.sibling=null),$b(A,!1,_,d,C,p);break;case"backwards":case"unstable_legacy-backwards":for(d=null,_=A.child,A.child=null;_!==null;){if(i=_.alternate,i!==null&&mi(i)===null){A.child=_;break}i=_.sibling,_.sibling=d,d=_,_=i}$b(A,!0,d,null,C,p);break;case"together":$b(A,!1,null,null,void 0,p);break;default:A.memoizedState=null}return A.child}function Mc(i,A,d){if(i!==null&&(A.dependencies=i.dependencies),Su|=A.lanes,(d&A.childLanes)===0)if(i!==null){if(ZA(i,A,d,!1),(d&A.childLanes)===0)return null}else return null;if(i!==null&&A.child!==i.child)throw Error(a(153));if(A.child!==null){for(i=A.child,d=Ql(i,i.pendingProps),A.child=d,d.return=A;i.sibling!==null;)i=i.sibling,d=d.sibling=Ql(i,i.pendingProps),d.return=A;d.sibling=null}return A.child}function Xb(i,A){return(i.lanes&A)!==0?!0:(i=i.dependencies,!!(i!==null&&md(i)))}function C6(i,A,d){switch(A.tag){case 3:de(A,A.stateNode.containerInfo),JA(A,Vs,i.memoizedState.cache),Dc();break;case 27:case 5:we(A);break;case 4:de(A,A.stateNode.containerInfo);break;case 10:JA(A,A.type,A.memoizedProps.value);break;case 31:if(A.memoizedState!==null)return A.flags|=128,Oa(A),null;break;case 13:var p=A.memoizedState;if(p!==null)return p.dehydrated!==null?(Gs(A),A.flags|=128,null):(d&A.child.childLanes)!==0?By(i,A,d):(Gs(A),i=Mc(i,A,d),i!==null?i.sibling:null);Gs(A);break;case 19:var _=(i.flags&128)!==0;if(p=(d&A.childLanes)!==0,p||(ZA(i,A,d,!1),p=(d&A.childLanes)!==0),_){if(p)return Sy(i,A,d);A.flags|=128}if(_=A.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),K(ya,ya.current),p)break;return null;case 22:return A.lanes=0,by(i,A,d,A.pendingProps);case 24:JA(A,Vs,i.memoizedState.cache)}return Mc(i,A,d)}function Ny(i,A,d){if(i!==null)if(i.memoizedProps!==A.pendingProps)Rn=!0;else{if(!Xb(i,d)&&(A.flags&128)===0)return Rn=!1,C6(i,A,d);Rn=(i.flags&131072)!==0}else Rn=!1,ha&&(A.flags&1048576)!==0&&Ag(A,w0,A.index);switch(A.lanes=0,A.tag){case 16:e:{var p=A.pendingProps;if(i=$e(A.elementType),A.type=i,typeof i=="function")pl(i)?(p=C0(i,p),A.tag=1,A=yy(null,A,i,p,d)):(A.tag=0,A=qb(null,A,i,p,d));else{if(i!=null){var _=i.$$typeof;if(_===L){A.tag=11,A=gy(null,A,i,p,d);break e}else if(_===Q){A.tag=14,A=my(null,A,i,p,d);break e}}throw A=ne(i)||i,Error(a(306,A,""))}}return A;case 0:return qb(i,A,A.type,A.pendingProps,d);case 1:return p=A.type,_=C0(p,A.pendingProps),yy(i,A,p,_,d);case 3:e:{if(de(A,A.stateNode.containerInfo),i===null)throw Error(a(387));p=A.pendingProps;var C=A.memoizedState;_=C.element,ks(i,A),en(A,p,null,d);var W=A.memoizedState;if(p=W.cache,JA(A,Vs,p),p!==C.cache&&Ic(A,[Vs],d,!0),ts(),p=W.element,C.isDehydrated)if(C={element:p,isDehydrated:!1,cache:W.cache},A.updateQueue.baseState=C,A.memoizedState=C,A.flags&256){A=ky(i,A,p,d);break e}else if(p!==_){_=Ol(Error(a(424)),A),xu(_),A=ky(i,A,p,d);break e}else for(i=A.stateNode.containerInfo,i.nodeType===9?i=i.body:i=i.nodeName==="HTML"?i.ownerDocument.body:i,os=Ro(i.firstChild),ei=A,ha=!0,Fi=null,Is=!0,d=ea(A,null,p,d),A.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(Dc(),p===_){A=Mc(i,A,d);break e}Li(i,A,p,d)}A=A.child}return A;case 26:return wg(i,A),i===null?(d=R5(A.type,null,A.pendingProps,null))?A.memoizedState=d:ha||(d=A.type,i=A.pendingProps,p=Og(J.current).createElement(d),p[be]=A,p[ye]=i,ji(p,d,i),zt(p),A.stateNode=p):A.memoizedState=R5(A.type,i.memoizedProps,A.pendingProps,i.memoizedState),null;case 27:return we(A),i===null&&ha&&(p=A.stateNode=I5(A.type,A.pendingProps,J.current),ei=A,Is=!0,_=os,Lu(A.type)?(E1=_,os=Ro(p.firstChild)):os=_),Li(i,A,A.pendingProps.children,d),wg(i,A),i===null&&(A.flags|=4194304),A.child;case 5:return i===null&&ha&&((_=p=os)&&(p=r8(p,A.type,A.pendingProps,Is),p!==null?(A.stateNode=p,ei=A,os=Ro(p.firstChild),Is=!1,_=!0):_=!1),_||XA(A)),we(A),_=A.type,C=A.pendingProps,W=i!==null?i.memoizedProps:null,p=C.children,k1(_,C)?p=null:W!==null&&k1(_,W)&&(A.flags|=32),A.memoizedState!==null&&(_=Yf(i,A,Tb,null,null,d),wh._currentValue=_),wg(i,A),Li(i,A,p,d),A.child;case 6:return i===null&&ha&&((i=d=os)&&(d=a8(d,A.pendingProps,Is),d!==null?(A.stateNode=d,ei=A,os=null,i=!0):i=!1),i||XA(A)),null;case 13:return By(i,A,d);case 4:return de(A,A.stateNode.containerInfo),p=A.pendingProps,i===null?A.child=As(A,null,p,d):Li(i,A,p,d),A.child;case 11:return gy(i,A,A.type,A.pendingProps,d);case 7:return Li(i,A,A.pendingProps,d),A.child;case 8:return Li(i,A,A.pendingProps.children,d),A.child;case 12:return Li(i,A,A.pendingProps.children,d),A.child;case 10:return p=A.pendingProps,JA(A,A.type,p.value),Li(i,A,p.children,d),A.child;case 9:return _=A.type._context,p=A.pendingProps.children,ec(A),_=ri(_),p=p(_),A.flags|=1,Li(i,A,p,d),A.child;case 14:return my(i,A,A.type,A.pendingProps,d);case 15:return xy(i,A,A.type,A.pendingProps,d);case 19:return Sy(i,A,d);case 31:return B6(i,A,d);case 22:return by(i,A,d,A.pendingProps);case 24:return ec(A),p=ri(Vs),i===null?(_=xe(),_===null&&(_=cs,C=vu(),_.pooledCache=C,C.refCount++,C!==null&&(_.pooledCacheLanes|=d),_=C),A.memoizedState={parent:p,cache:_},qt(A),JA(A,Vs,_)):((i.lanes&d)!==0&&(ks(i,A),en(A,null,null,d),ts()),_=i.memoizedState,C=A.memoizedState,_.parent!==p?(_={parent:p,cache:p},A.memoizedState=_,A.lanes===0&&(A.memoizedState=A.updateQueue.baseState=_),JA(A,Vs,p)):(p=C.cache,JA(A,Vs,p),p!==_.cache&&Ic(A,[Vs],d,!0))),Li(i,A,A.pendingProps.children,d),A.child;case 29:throw A.pendingProps}throw Error(a(156,A.tag))}function Hc(i){i.flags|=4}function Yb(i,A,d,p,_){if((A=(i.mode&32)!==0)&&(A=!1),A){if(i.flags|=16777216,(_&335544128)===_)if(i.stateNode.complete)i.flags|=8192;else if(t5())i.flags|=8192;else throw lt=Pe,Xe}else i.flags&=-16777217}function Ey(i,A){if(A.type!=="stylesheet"||(A.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!K5(A))if(t5())i.flags|=8192;else throw lt=Pe,Xe}function yg(i,A){A!==null&&(i.flags|=4),i.flags&16384&&(A=i.tag!==22?Et():536870912,i.lanes|=A,Ld|=A)}function lh(i,A){if(!ha)switch(i.tailMode){case"hidden":A=i.tail;for(var d=null;A!==null;)A.alternate!==null&&(d=A),A=A.sibling;d===null?i.tail=null:d.sibling=null;break;case"collapsed":d=i.tail;for(var p=null;d!==null;)d.alternate!==null&&(p=d),d=d.sibling;p===null?A||i.tail===null?i.tail=null:i.tail.sibling=null:p.sibling=null}}function Ss(i){var A=i.alternate!==null&&i.alternate.child===i.child,d=0,p=0;if(A)for(var _=i.child;_!==null;)d|=_.lanes|_.childLanes,p|=_.subtreeFlags&65011712,p|=_.flags&65011712,_.return=i,_=_.sibling;else for(_=i.child;_!==null;)d|=_.lanes|_.childLanes,p|=_.subtreeFlags,p|=_.flags,_.return=i,_=_.sibling;return i.subtreeFlags|=p,i.childLanes=d,A}function S6(i,A,d){var p=A.pendingProps;switch(pd(A),A.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ss(A),null;case 1:return Ss(A),null;case 3:return d=A.stateNode,p=null,i!==null&&(p=i.memoizedState.cache),A.memoizedState.cache!==p&&(A.flags|=2048),ql(Vs),ue(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(i===null||i.child===null)&&(ti(A)?Hc(A):i===null||i.memoizedState.isDehydrated&&(A.flags&256)===0||(A.flags|=1024,$f())),Ss(A),null;case 26:var _=A.type,C=A.memoizedState;return i===null?(Hc(A),C!==null?(Ss(A),Ey(A,C)):(Ss(A),Yb(A,_,null,p,d))):C?C!==i.memoizedState?(Hc(A),Ss(A),Ey(A,C)):(Ss(A),A.flags&=-16777217):(i=i.memoizedProps,i!==p&&Hc(A),Ss(A),Yb(A,_,i,p,d)),null;case 27:if(Ie(A),d=J.current,_=A.type,i!==null&&A.stateNode!=null)i.memoizedProps!==p&&Hc(A);else{if(!p){if(A.stateNode===null)throw Error(a(166));return Ss(A),null}i=I.current,ti(A)?Wf(A):(i=I5(_,p,d),A.stateNode=i,Hc(A))}return Ss(A),null;case 5:if(Ie(A),_=A.type,i!==null&&A.stateNode!=null)i.memoizedProps!==p&&Hc(A);else{if(!p){if(A.stateNode===null)throw Error(a(166));return Ss(A),null}if(C=I.current,ti(A))Wf(A);else{var W=Og(J.current);switch(C){case 1:C=W.createElementNS("http://www.w3.org/2000/svg",_);break;case 2:C=W.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;default:switch(_){case"svg":C=W.createElementNS("http://www.w3.org/2000/svg",_);break;case"math":C=W.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;case"script":C=W.createElement("div"),C.innerHTML="<script><\/script>",C=C.removeChild(C.firstChild);break;case"select":C=typeof p.is=="string"?W.createElement("select",{is:p.is}):W.createElement("select"),p.multiple?C.multiple=!0:p.size&&(C.size=p.size);break;default:C=typeof p.is=="string"?W.createElement(_,{is:p.is}):W.createElement(_)}}C[be]=A,C[ye]=p;e:for(W=A.child;W!==null;){if(W.tag===5||W.tag===6)C.appendChild(W.stateNode);else if(W.tag!==4&&W.tag!==27&&W.child!==null){W.child.return=W,W=W.child;continue}if(W===A)break e;for(;W.sibling===null;){if(W.return===null||W.return===A)break e;W=W.return}W.sibling.return=W.return,W=W.sibling}A.stateNode=C;e:switch(ji(C,_,p),_){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&Hc(A)}}return Ss(A),Yb(A,A.type,i===null?null:i.memoizedProps,A.pendingProps,d),null;case 6:if(i&&A.stateNode!=null)i.memoizedProps!==p&&Hc(A);else{if(typeof p!="string"&&A.stateNode===null)throw Error(a(166));if(i=J.current,ti(A)){if(i=A.stateNode,d=A.memoizedProps,p=null,_=ei,_!==null)switch(_.tag){case 27:case 5:p=_.memoizedProps}i[be]=A,i=!!(i.nodeValue===d||p!==null&&p.suppressHydrationWarning===!0||B5(i.nodeValue,d)),i||XA(A,!0)}else i=Og(i).createTextNode(p),i[be]=A,A.stateNode=i}return Ss(A),null;case 31:if(d=A.memoizedState,i===null||i.memoizedState!==null){if(p=ti(A),d!==null){if(i===null){if(!p)throw Error(a(318));if(i=A.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(557));i[be]=A}else Dc(),(A.flags&128)===0&&(A.memoizedState=null),A.flags|=4;Ss(A),i=!1}else d=$f(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=d),i=!0;if(!i)return A.flags&256?(za(A),A):(za(A),null);if((A.flags&128)!==0)throw Error(a(558))}return Ss(A),null;case 13:if(p=A.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(_=ti(A),p!==null&&p.dehydrated!==null){if(i===null){if(!_)throw Error(a(318));if(_=A.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(a(317));_[be]=A}else Dc(),(A.flags&128)===0&&(A.memoizedState=null),A.flags|=4;Ss(A),_=!1}else _=$f(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=_),_=!0;if(!_)return A.flags&256?(za(A),A):(za(A),null)}return za(A),(A.flags&128)!==0?(A.lanes=d,A):(d=p!==null,i=i!==null&&i.memoizedState!==null,d&&(p=A.child,_=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(_=p.alternate.memoizedState.cachePool.pool),C=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(C=p.memoizedState.cachePool.pool),C!==_&&(p.flags|=2048)),d!==i&&d&&(A.child.flags|=8192),yg(A,A.updateQueue),Ss(A),null);case 4:return ue(),i===null&&b1(A.stateNode.containerInfo),Ss(A),null;case 10:return ql(A.type),Ss(A),null;case 19:if(F(ya),p=A.memoizedState,p===null)return Ss(A),null;if(_=(A.flags&128)!==0,C=p.rendering,C===null)if(_)lh(p,!1);else{if(nn!==0||i!==null&&(i.flags&128)!==0)for(i=A.child;i!==null;){if(C=mi(i),C!==null){for(A.flags|=128,lh(p,!1),i=C.updateQueue,A.updateQueue=i,yg(A,i),A.subtreeFlags=0,i=d,d=A.child;d!==null;)b0(d,i),d=d.sibling;return K(ya,ya.current&1|2),ha&&gl(A,p.treeForkCount),A.child}i=i.sibling}p.tail!==null&&Ot()>Ng&&(A.flags|=128,_=!0,lh(p,!1),A.lanes=4194304)}else{if(!_)if(i=mi(C),i!==null){if(A.flags|=128,_=!0,i=i.updateQueue,A.updateQueue=i,yg(A,i),lh(p,!0),p.tail===null&&p.tailMode==="hidden"&&!C.alternate&&!ha)return Ss(A),null}else 2*Ot()-p.renderingStartTime>Ng&&d!==536870912&&(A.flags|=128,_=!0,lh(p,!1),A.lanes=4194304);p.isBackwards?(C.sibling=A.child,A.child=C):(i=p.last,i!==null?i.sibling=C:A.child=C,p.last=C)}return p.tail!==null?(i=p.tail,p.rendering=i,p.tail=i.sibling,p.renderingStartTime=Ot(),i.sibling=null,d=ya.current,K(ya,_?d&1|2:d&1),ha&&gl(A,p.treeForkCount),i):(Ss(A),null);case 22:case 23:return za(A),xn(),p=A.memoizedState!==null,i!==null?i.memoizedState!==null!==p&&(A.flags|=8192):p&&(A.flags|=8192),p?(d&536870912)!==0&&(A.flags&128)===0&&(Ss(A),A.subtreeFlags&6&&(A.flags|=8192)):Ss(A),d=A.updateQueue,d!==null&&yg(A,d.retryQueue),d=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(d=i.memoizedState.cachePool.pool),p=null,A.memoizedState!==null&&A.memoizedState.cachePool!==null&&(p=A.memoizedState.cachePool.pool),p!==d&&(A.flags|=2048),i!==null&&F(he),null;case 24:return d=null,i!==null&&(d=i.memoizedState.cache),A.memoizedState.cache!==d&&(A.flags|=2048),ql(Vs),Ss(A),null;case 25:return null;case 30:return null}throw Error(a(156,A.tag))}function N6(i,A){switch(pd(A),A.tag){case 1:return i=A.flags,i&65536?(A.flags=i&-65537|128,A):null;case 3:return ql(Vs),ue(),i=A.flags,(i&65536)!==0&&(i&128)===0?(A.flags=i&-65537|128,A):null;case 26:case 27:case 5:return Ie(A),null;case 31:if(A.memoizedState!==null){if(za(A),A.alternate===null)throw Error(a(340));Dc()}return i=A.flags,i&65536?(A.flags=i&-65537|128,A):null;case 13:if(za(A),i=A.memoizedState,i!==null&&i.dehydrated!==null){if(A.alternate===null)throw Error(a(340));Dc()}return i=A.flags,i&65536?(A.flags=i&-65537|128,A):null;case 19:return F(ya),null;case 4:return ue(),null;case 10:return ql(A.type),null;case 22:case 23:return za(A),xn(),i!==null&&F(he),i=A.flags,i&65536?(A.flags=i&-65537|128,A):null;case 24:return ql(Vs),null;case 25:return null;default:return null}}function Fy(i,A){switch(pd(A),A.tag){case 3:ql(Vs),ue();break;case 26:case 27:case 5:Ie(A);break;case 4:ue();break;case 31:A.memoizedState!==null&&za(A);break;case 13:za(A);break;case 19:F(ya);break;case 10:ql(A.type);break;case 22:case 23:za(A),xn(),i!==null&&F(he);break;case 24:ql(Vs)}}function oh(i,A){try{var d=A.updateQueue,p=d!==null?d.lastEffect:null;if(p!==null){var _=p.next;d=_;do{if((d.tag&i)===i){p=void 0;var C=d.create,W=d.inst;p=C(),W.destroy=p}d=d.next}while(d!==_)}}catch(ge){Ga(A,A.return,ge)}}function Bu(i,A,d){try{var p=A.updateQueue,_=p!==null?p.lastEffect:null;if(_!==null){var C=_.next;p=C;do{if((p.tag&i)===i){var W=p.inst,ge=W.destroy;if(ge!==void 0){W.destroy=void 0,_=A;var De=d,Ze=ge;try{Ze()}catch(ut){Ga(_,De,ut)}}}p=p.next}while(p!==C)}}catch(ut){Ga(A,A.return,ut)}}function Ty(i){var A=i.updateQueue;if(A!==null){var d=i.stateNode;try{tn(A,d)}catch(p){Ga(i,i.return,p)}}}function Ly(i,A,d){d.props=C0(i.type,i.memoizedProps),d.state=i.memoizedState;try{d.componentWillUnmount()}catch(p){Ga(i,A,p)}}function Ah(i,A){try{var d=i.ref;if(d!==null){switch(i.tag){case 26:case 27:case 5:var p=i.stateNode;break;case 30:p=i.stateNode;break;default:p=i.stateNode}typeof d=="function"?i.refCleanup=d(p):d.current=p}}catch(_){Ga(i,A,_)}}function nc(i,A){var d=i.ref,p=i.refCleanup;if(d!==null)if(typeof p=="function")try{p()}catch(_){Ga(i,A,_)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof d=="function")try{d(null)}catch(_){Ga(i,A,_)}else d.current=null}function jy(i){var A=i.type,d=i.memoizedProps,p=i.stateNode;try{e:switch(A){case"button":case"input":case"select":case"textarea":d.autoFocus&&p.focus();break e;case"img":d.src?p.src=d.src:d.srcSet&&(p.srcset=d.srcSet)}}catch(_){Ga(i,i.return,_)}}function Jb(i,A,d){try{var p=i.stateNode;X6(p,i.type,d,A),p[ye]=A}catch(_){Ga(i,i.return,_)}}function Uy(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Lu(i.type)||i.tag===4}function Zb(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Uy(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Lu(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function e1(i,A,d){var p=i.tag;if(p===5||p===6)i=i.stateNode,A?(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d).insertBefore(i,A):(A=d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,A.appendChild(i),d=d._reactRootContainer,d!=null||A.onclick!==null||(A.onclick=cl));else if(p!==4&&(p===27&&Lu(i.type)&&(d=i.stateNode,A=null),i=i.child,i!==null))for(e1(i,A,d),i=i.sibling;i!==null;)e1(i,A,d),i=i.sibling}function kg(i,A,d){var p=i.tag;if(p===5||p===6)i=i.stateNode,A?d.insertBefore(i,A):d.appendChild(i);else if(p!==4&&(p===27&&Lu(i.type)&&(d=i.stateNode),i=i.child,i!==null))for(kg(i,A,d),i=i.sibling;i!==null;)kg(i,A,d),i=i.sibling}function Dy(i){var A=i.stateNode,d=i.memoizedProps;try{for(var p=i.type,_=A.attributes;_.length;)A.removeAttributeNode(_[0]);ji(A,p,d),A[be]=i,A[ye]=d}catch(C){Ga(i,i.return,C)}}var Pc=!1,Mn=!1,t1=!1,Iy=typeof WeakSet=="function"?WeakSet:Set,xi=null;function E6(i,A){if(i=i.containerInfo,_1=zg,i=Ds(i),Vi(i)){if("selectionStart"in i)var d={start:i.selectionStart,end:i.selectionEnd};else e:{d=(d=i.ownerDocument)&&d.defaultView||window;var p=d.getSelection&&d.getSelection();if(p&&p.rangeCount!==0){d=p.anchorNode;var _=p.anchorOffset,C=p.focusNode;p=p.focusOffset;try{d.nodeType,C.nodeType}catch{d=null;break e}var W=0,ge=-1,De=-1,Ze=0,ut=0,xt=i,et=null;t:for(;;){for(var rt;xt!==d||_!==0&&xt.nodeType!==3||(ge=W+_),xt!==C||p!==0&&xt.nodeType!==3||(De=W+p),xt.nodeType===3&&(W+=xt.nodeValue.length),(rt=xt.firstChild)!==null;)et=xt,xt=rt;for(;;){if(xt===i)break t;if(et===d&&++Ze===_&&(ge=W),et===C&&++ut===p&&(De=W),(rt=xt.nextSibling)!==null)break;xt=et,et=xt.parentNode}xt=rt}d=ge===-1||De===-1?null:{start:ge,end:De}}else d=null}d=d||{start:0,end:0}}else d=null;for(y1={focusedElem:i,selectionRange:d},zg=!1,xi=A;xi!==null;)if(A=xi,i=A.child,(A.subtreeFlags&1028)!==0&&i!==null)i.return=A,xi=i;else for(;xi!==null;){switch(A=xi,C=A.alternate,i=A.flags,A.tag){case 0:if((i&4)!==0&&(i=A.updateQueue,i=i!==null?i.events:null,i!==null))for(d=0;d<i.length;d++)_=i[d],_.ref.impl=_.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&C!==null){i=void 0,d=A,_=C.memoizedProps,C=C.memoizedState,p=d.stateNode;try{var hr=C0(d.type,_);i=p.getSnapshotBeforeUpdate(hr,C),p.__reactInternalSnapshotBeforeUpdate=i}catch(Ir){Ga(d,d.return,Ir)}}break;case 3:if((i&1024)!==0){if(i=A.stateNode.containerInfo,d=i.nodeType,d===9)C1(i);else if(d===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":C1(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(a(163))}if(i=A.sibling,i!==null){i.return=A.return,xi=i;break}xi=A.return}}function Qy(i,A,d){var p=d.flags;switch(d.tag){case 0:case 11:case 15:Kc(i,d),p&4&&oh(5,d);break;case 1:if(Kc(i,d),p&4)if(i=d.stateNode,A===null)try{i.componentDidMount()}catch(W){Ga(d,d.return,W)}else{var _=C0(d.type,A.memoizedProps);A=A.memoizedState;try{i.componentDidUpdate(_,A,i.__reactInternalSnapshotBeforeUpdate)}catch(W){Ga(d,d.return,W)}}p&64&&Ty(d),p&512&&Ah(d,d.return);break;case 3:if(Kc(i,d),p&64&&(i=d.updateQueue,i!==null)){if(A=null,d.child!==null)switch(d.child.tag){case 27:case 5:A=d.child.stateNode;break;case 1:A=d.child.stateNode}try{tn(i,A)}catch(W){Ga(d,d.return,W)}}break;case 27:A===null&&p&4&&Dy(d);case 26:case 5:Kc(i,d),A===null&&p&4&&jy(d),p&512&&Ah(d,d.return);break;case 12:Kc(i,d);break;case 31:Kc(i,d),p&4&&My(i,d);break;case 13:Kc(i,d),p&4&&Hy(i,d),p&64&&(i=d.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(d=O6.bind(null,d),s8(i,d))));break;case 22:if(p=d.memoizedState!==null||Pc,!p){A=A!==null&&A.memoizedState!==null||Mn,_=Pc;var C=Mn;Pc=p,(Mn=A)&&!C?zc(i,d,(d.subtreeFlags&8772)!==0):Kc(i,d),Pc=_,Mn=C}break;case 30:break;default:Kc(i,d)}}function Oy(i){var A=i.alternate;A!==null&&(i.alternate=null,Oy(A)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(A=i.stateNode,A!==null&&tt(A)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Rs=null,zl=!1;function qc(i,A,d){for(d=d.child;d!==null;)Ry(i,A,d),d=d.sibling}function Ry(i,A,d){if(Rt&&typeof Rt.onCommitFiberUnmount=="function")try{Rt.onCommitFiberUnmount(Ht,d)}catch{}switch(d.tag){case 26:Mn||nc(d,A),qc(i,A,d),d.memoizedState?d.memoizedState.count--:d.stateNode&&(d=d.stateNode,d.parentNode.removeChild(d));break;case 27:Mn||nc(d,A);var p=Rs,_=zl;Lu(d.type)&&(Rs=d.stateNode,zl=!1),qc(i,A,d),xh(d.stateNode),Rs=p,zl=_;break;case 5:Mn||nc(d,A);case 6:if(p=Rs,_=zl,Rs=null,qc(i,A,d),Rs=p,zl=_,Rs!==null)if(zl)try{(Rs.nodeType===9?Rs.body:Rs.nodeName==="HTML"?Rs.ownerDocument.body:Rs).removeChild(d.stateNode)}catch(C){Ga(d,A,C)}else try{Rs.removeChild(d.stateNode)}catch(C){Ga(d,A,C)}break;case 18:Rs!==null&&(zl?(i=Rs,T5(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,d.stateNode),Md(i)):T5(Rs,d.stateNode));break;case 4:p=Rs,_=zl,Rs=d.stateNode.containerInfo,zl=!0,qc(i,A,d),Rs=p,zl=_;break;case 0:case 11:case 14:case 15:Bu(2,d,A),Mn||Bu(4,d,A),qc(i,A,d);break;case 1:Mn||(nc(d,A),p=d.stateNode,typeof p.componentWillUnmount=="function"&&Ly(d,A,p)),qc(i,A,d);break;case 21:qc(i,A,d);break;case 22:Mn=(p=Mn)||d.memoizedState!==null,qc(i,A,d),Mn=p;break;default:qc(i,A,d)}}function My(i,A){if(A.memoizedState===null&&(i=A.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{Md(i)}catch(d){Ga(A,A.return,d)}}}function Hy(i,A){if(A.memoizedState===null&&(i=A.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Md(i)}catch(d){Ga(A,A.return,d)}}function F6(i){switch(i.tag){case 31:case 13:case 19:var A=i.stateNode;return A===null&&(A=i.stateNode=new Iy),A;case 22:return i=i.stateNode,A=i._retryCache,A===null&&(A=i._retryCache=new Iy),A;default:throw Error(a(435,i.tag))}}function Bg(i,A){var d=F6(i);A.forEach(function(p){if(!d.has(p)){d.add(p);var _=R6.bind(null,i,p);p.then(_,_)}})}function Vl(i,A){var d=A.deletions;if(d!==null)for(var p=0;p<d.length;p++){var _=d[p],C=i,W=A,ge=W;e:for(;ge!==null;){switch(ge.tag){case 27:if(Lu(ge.type)){Rs=ge.stateNode,zl=!1;break e}break;case 5:Rs=ge.stateNode,zl=!1;break e;case 3:case 4:Rs=ge.stateNode.containerInfo,zl=!0;break e}ge=ge.return}if(Rs===null)throw Error(a(160));Ry(C,W,_),Rs=null,zl=!1,C=_.alternate,C!==null&&(C.return=null),_.return=null}if(A.subtreeFlags&13886)for(A=A.child;A!==null;)Py(A,i),A=A.sibling}var vA=null;function Py(i,A){var d=i.alternate,p=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Vl(A,i),Gl(i),p&4&&(Bu(3,i,i.return),oh(3,i),Bu(5,i,i.return));break;case 1:Vl(A,i),Gl(i),p&512&&(Mn||d===null||nc(d,d.return)),p&64&&Pc&&(i=i.updateQueue,i!==null&&(p=i.callbacks,p!==null&&(d=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=d===null?p:d.concat(p))));break;case 26:var _=vA;if(Vl(A,i),Gl(i),p&512&&(Mn||d===null||nc(d,d.return)),p&4){var C=d!==null?d.memoizedState:null;if(p=i.memoizedState,d===null)if(p===null)if(i.stateNode===null){e:{p=i.type,d=i.memoizedProps,_=_.ownerDocument||_;t:switch(p){case"title":C=_.getElementsByTagName("title")[0],(!C||C[Ue]||C[be]||C.namespaceURI==="http://www.w3.org/2000/svg"||C.hasAttribute("itemprop"))&&(C=_.createElement(p),_.head.insertBefore(C,_.querySelector("head > title"))),ji(C,p,d),C[be]=i,zt(C),p=C;break e;case"link":var W=P5("link","href",_).get(p+(d.href||""));if(W){for(var ge=0;ge<W.length;ge++)if(C=W[ge],C.getAttribute("href")===(d.href==null||d.href===""?null:d.href)&&C.getAttribute("rel")===(d.rel==null?null:d.rel)&&C.getAttribute("title")===(d.title==null?null:d.title)&&C.getAttribute("crossorigin")===(d.crossOrigin==null?null:d.crossOrigin)){W.splice(ge,1);break t}}C=_.createElement(p),ji(C,p,d),_.head.appendChild(C);break;case"meta":if(W=P5("meta","content",_).get(p+(d.content||""))){for(ge=0;ge<W.length;ge++)if(C=W[ge],C.getAttribute("content")===(d.content==null?null:""+d.content)&&C.getAttribute("name")===(d.name==null?null:d.name)&&C.getAttribute("property")===(d.property==null?null:d.property)&&C.getAttribute("http-equiv")===(d.httpEquiv==null?null:d.httpEquiv)&&C.getAttribute("charset")===(d.charSet==null?null:d.charSet)){W.splice(ge,1);break t}}C=_.createElement(p),ji(C,p,d),_.head.appendChild(C);break;default:throw Error(a(468,p))}C[be]=i,zt(C),p=C}i.stateNode=p}else q5(_,i.type,i.stateNode);else i.stateNode=H5(_,p,i.memoizedProps);else C!==p?(C===null?d.stateNode!==null&&(d=d.stateNode,d.parentNode.removeChild(d)):C.count--,p===null?q5(_,i.type,i.stateNode):H5(_,p,i.memoizedProps)):p===null&&i.stateNode!==null&&Jb(i,i.memoizedProps,d.memoizedProps)}break;case 27:Vl(A,i),Gl(i),p&512&&(Mn||d===null||nc(d,d.return)),d!==null&&p&4&&Jb(i,i.memoizedProps,d.memoizedProps);break;case 5:if(Vl(A,i),Gl(i),p&512&&(Mn||d===null||nc(d,d.return)),i.flags&32){_=i.stateNode;try{Si(_,"")}catch(hr){Ga(i,i.return,hr)}}p&4&&i.stateNode!=null&&(_=i.memoizedProps,Jb(i,_,d!==null?d.memoizedProps:_)),p&1024&&(t1=!0);break;case 6:if(Vl(A,i),Gl(i),p&4){if(i.stateNode===null)throw Error(a(162));p=i.memoizedProps,d=i.stateNode;try{d.nodeValue=p}catch(hr){Ga(i,i.return,hr)}}break;case 3:if(Hg=null,_=vA,vA=Rg(A.containerInfo),Vl(A,i),vA=_,Gl(i),p&4&&d!==null&&d.memoizedState.isDehydrated)try{Md(A.containerInfo)}catch(hr){Ga(i,i.return,hr)}t1&&(t1=!1,qy(i));break;case 4:p=vA,vA=Rg(i.stateNode.containerInfo),Vl(A,i),Gl(i),vA=p;break;case 12:Vl(A,i),Gl(i);break;case 31:Vl(A,i),Gl(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,Bg(i,p)));break;case 13:Vl(A,i),Gl(i),i.child.flags&8192&&i.memoizedState!==null!=(d!==null&&d.memoizedState!==null)&&(Sg=Ot()),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,Bg(i,p)));break;case 22:_=i.memoizedState!==null;var De=d!==null&&d.memoizedState!==null,Ze=Pc,ut=Mn;if(Pc=Ze||_,Mn=ut||De,Vl(A,i),Mn=ut,Pc=Ze,Gl(i),p&8192)e:for(A=i.stateNode,A._visibility=_?A._visibility&-2:A._visibility|1,_&&(d===null||De||Pc||Mn||S0(i)),d=null,A=i;;){if(A.tag===5||A.tag===26){if(d===null){De=d=A;try{if(C=De.stateNode,_)W=C.style,typeof W.setProperty=="function"?W.setProperty("display","none","important"):W.display="none";else{ge=De.stateNode;var xt=De.memoizedProps.style,et=xt!=null&&xt.hasOwnProperty("display")?xt.display:null;ge.style.display=et==null||typeof et=="boolean"?"":(""+et).trim()}}catch(hr){Ga(De,De.return,hr)}}}else if(A.tag===6){if(d===null){De=A;try{De.stateNode.nodeValue=_?"":De.memoizedProps}catch(hr){Ga(De,De.return,hr)}}}else if(A.tag===18){if(d===null){De=A;try{var rt=De.stateNode;_?L5(rt,!0):L5(De.stateNode,!1)}catch(hr){Ga(De,De.return,hr)}}}else if((A.tag!==22&&A.tag!==23||A.memoizedState===null||A===i)&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===i)break e;for(;A.sibling===null;){if(A.return===null||A.return===i)break e;d===A&&(d=null),A=A.return}d===A&&(d=null),A.sibling.return=A.return,A=A.sibling}p&4&&(p=i.updateQueue,p!==null&&(d=p.retryQueue,d!==null&&(p.retryQueue=null,Bg(i,d))));break;case 19:Vl(A,i),Gl(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,Bg(i,p)));break;case 30:break;case 21:break;default:Vl(A,i),Gl(i)}}function Gl(i){var A=i.flags;if(A&2){try{for(var d,p=i.return;p!==null;){if(Uy(p)){d=p;break}p=p.return}if(d==null)throw Error(a(160));switch(d.tag){case 27:var _=d.stateNode,C=Zb(i);kg(i,C,_);break;case 5:var W=d.stateNode;d.flags&32&&(Si(W,""),d.flags&=-33);var ge=Zb(i);kg(i,ge,W);break;case 3:case 4:var De=d.stateNode.containerInfo,Ze=Zb(i);e1(i,Ze,De);break;default:throw Error(a(161))}}catch(ut){Ga(i,i.return,ut)}i.flags&=-3}A&4096&&(i.flags&=-4097)}function qy(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var A=i;qy(A),A.tag===5&&A.flags&1024&&A.stateNode.reset(),i=i.sibling}}function Kc(i,A){if(A.subtreeFlags&8772)for(A=A.child;A!==null;)Qy(i,A.alternate,A),A=A.sibling}function S0(i){for(i=i.child;i!==null;){var A=i;switch(A.tag){case 0:case 11:case 14:case 15:Bu(4,A,A.return),S0(A);break;case 1:nc(A,A.return);var d=A.stateNode;typeof d.componentWillUnmount=="function"&&Ly(A,A.return,d),S0(A);break;case 27:xh(A.stateNode);case 26:case 5:nc(A,A.return),S0(A);break;case 22:A.memoizedState===null&&S0(A);break;case 30:S0(A);break;default:S0(A)}i=i.sibling}}function zc(i,A,d){for(d=d&&(A.subtreeFlags&8772)!==0,A=A.child;A!==null;){var p=A.alternate,_=i,C=A,W=C.flags;switch(C.tag){case 0:case 11:case 15:zc(_,C,d),oh(4,C);break;case 1:if(zc(_,C,d),p=C,_=p.stateNode,typeof _.componentDidMount=="function")try{_.componentDidMount()}catch(Ze){Ga(p,p.return,Ze)}if(p=C,_=p.updateQueue,_!==null){var ge=p.stateNode;try{var De=_.shared.hiddenCallbacks;if(De!==null)for(_.shared.hiddenCallbacks=null,_=0;_<De.length;_++)gi(De[_],ge)}catch(Ze){Ga(p,p.return,Ze)}}d&&W&64&&Ty(C),Ah(C,C.return);break;case 27:Dy(C);case 26:case 5:zc(_,C,d),d&&p===null&&W&4&&jy(C),Ah(C,C.return);break;case 12:zc(_,C,d);break;case 31:zc(_,C,d),d&&W&4&&My(_,C);break;case 13:zc(_,C,d),d&&W&4&&Hy(_,C);break;case 22:C.memoizedState===null&&zc(_,C,d),Ah(C,C.return);break;case 30:break;default:zc(_,C,d)}A=A.sibling}}function r1(i,A){var d=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(d=i.memoizedState.cachePool.pool),i=null,A.memoizedState!==null&&A.memoizedState.cachePool!==null&&(i=A.memoizedState.cachePool.pool),i!==d&&(i!=null&&i.refCount++,d!=null&&_0(d))}function a1(i,A){i=null,A.alternate!==null&&(i=A.alternate.memoizedState.cache),A=A.memoizedState.cache,A!==i&&(A.refCount++,i!=null&&_0(i))}function wA(i,A,d,p){if(A.subtreeFlags&10256)for(A=A.child;A!==null;)Ky(i,A,d,p),A=A.sibling}function Ky(i,A,d,p){var _=A.flags;switch(A.tag){case 0:case 11:case 15:wA(i,A,d,p),_&2048&&oh(9,A);break;case 1:wA(i,A,d,p);break;case 3:wA(i,A,d,p),_&2048&&(i=null,A.alternate!==null&&(i=A.alternate.memoizedState.cache),A=A.memoizedState.cache,A!==i&&(A.refCount++,i!=null&&_0(i)));break;case 12:if(_&2048){wA(i,A,d,p),i=A.stateNode;try{var C=A.memoizedProps,W=C.id,ge=C.onPostCommit;typeof ge=="function"&&ge(W,A.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(De){Ga(A,A.return,De)}}else wA(i,A,d,p);break;case 31:wA(i,A,d,p);break;case 13:wA(i,A,d,p);break;case 23:break;case 22:C=A.stateNode,W=A.alternate,A.memoizedState!==null?C._visibility&2?wA(i,A,d,p):ch(i,A):C._visibility&2?wA(i,A,d,p):(C._visibility|=2,Ed(i,A,d,p,(A.subtreeFlags&10256)!==0||!1)),_&2048&&r1(W,A);break;case 24:wA(i,A,d,p),_&2048&&a1(A.alternate,A);break;default:wA(i,A,d,p)}}function Ed(i,A,d,p,_){for(_=_&&((A.subtreeFlags&10256)!==0||!1),A=A.child;A!==null;){var C=i,W=A,ge=d,De=p,Ze=W.flags;switch(W.tag){case 0:case 11:case 15:Ed(C,W,ge,De,_),oh(8,W);break;case 23:break;case 22:var ut=W.stateNode;W.memoizedState!==null?ut._visibility&2?Ed(C,W,ge,De,_):ch(C,W):(ut._visibility|=2,Ed(C,W,ge,De,_)),_&&Ze&2048&&r1(W.alternate,W);break;case 24:Ed(C,W,ge,De,_),_&&Ze&2048&&a1(W.alternate,W);break;default:Ed(C,W,ge,De,_)}A=A.sibling}}function ch(i,A){if(A.subtreeFlags&10256)for(A=A.child;A!==null;){var d=i,p=A,_=p.flags;switch(p.tag){case 22:ch(d,p),_&2048&&r1(p.alternate,p);break;case 24:ch(d,p),_&2048&&a1(p.alternate,p);break;default:ch(d,p)}A=A.sibling}}var uh=8192;function Fd(i,A,d){if(i.subtreeFlags&uh)for(i=i.child;i!==null;)zy(i,A,d),i=i.sibling}function zy(i,A,d){switch(i.tag){case 26:Fd(i,A,d),i.flags&uh&&i.memoizedState!==null&&g8(d,vA,i.memoizedState,i.memoizedProps);break;case 5:Fd(i,A,d);break;case 3:case 4:var p=vA;vA=Rg(i.stateNode.containerInfo),Fd(i,A,d),vA=p;break;case 22:i.memoizedState===null&&(p=i.alternate,p!==null&&p.memoizedState!==null?(p=uh,uh=16777216,Fd(i,A,d),uh=p):Fd(i,A,d));break;default:Fd(i,A,d)}}function Vy(i){var A=i.alternate;if(A!==null&&(i=A.child,i!==null)){A.child=null;do A=i.sibling,i.sibling=null,i=A;while(i!==null)}}function dh(i){var A=i.deletions;if((i.flags&16)!==0){if(A!==null)for(var d=0;d<A.length;d++){var p=A[d];xi=p,Wy(p,i)}Vy(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Gy(i),i=i.sibling}function Gy(i){switch(i.tag){case 0:case 11:case 15:dh(i),i.flags&2048&&Bu(9,i,i.return);break;case 3:dh(i);break;case 12:dh(i);break;case 22:var A=i.stateNode;i.memoizedState!==null&&A._visibility&2&&(i.return===null||i.return.tag!==13)?(A._visibility&=-3,Cg(i)):dh(i);break;default:dh(i)}}function Cg(i){var A=i.deletions;if((i.flags&16)!==0){if(A!==null)for(var d=0;d<A.length;d++){var p=A[d];xi=p,Wy(p,i)}Vy(i)}for(i=i.child;i!==null;){switch(A=i,A.tag){case 0:case 11:case 15:Bu(8,A,A.return),Cg(A);break;case 22:d=A.stateNode,d._visibility&2&&(d._visibility&=-3,Cg(A));break;default:Cg(A)}i=i.sibling}}function Wy(i,A){for(;xi!==null;){var d=xi;switch(d.tag){case 0:case 11:case 15:Bu(8,d,A);break;case 23:case 22:if(d.memoizedState!==null&&d.memoizedState.cachePool!==null){var p=d.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:_0(d.memoizedState.cache)}if(p=d.child,p!==null)p.return=d,xi=p;else e:for(d=i;xi!==null;){p=xi;var _=p.sibling,C=p.return;if(Oy(p),p===d){xi=null;break e}if(_!==null){_.return=C,xi=_;break e}xi=C}}}var T6={getCacheForType:function(i){var A=ri(Vs),d=A.data.get(i);return d===void 0&&(d=i(),A.data.set(i,d)),d},cacheSignal:function(){return ri(Vs).controller.signal}},L6=typeof WeakMap=="function"?WeakMap:Map,Ra=0,cs=null,pa=null,xa=0,Va=0,ho=null,Cu=!1,Td=!1,s1=!1,Vc=0,nn=0,Su=0,N0=0,n1=0,po=0,Ld=0,fh=null,Wl=null,i1=!1,Sg=0,$y=0,Ng=1/0,Eg=null,Nu=null,si=0,Eu=null,jd=null,Gc=0,l1=0,o1=null,Xy=null,hh=0,A1=null;function go(){return(Ra&2)!==0&&xa!==0?xa&-xa:ee.T!==null?p1():re()}function Yy(){if(po===0)if((xa&536870912)===0||ha){var i=Xt;Xt<<=1,(Xt&3932160)===0&&(Xt=262144),po=i}else po=536870912;return i=Cs.current,i!==null&&(i.flags|=32),po}function $l(i,A,d){(i===cs&&(Va===2||Va===9)||i.cancelPendingCommit!==null)&&(Ud(i,0),Fu(i,xa,po,!1)),Bt(i,d),((Ra&2)===0||i!==cs)&&(i===cs&&((Ra&2)===0&&(N0|=d),nn===4&&Fu(i,xa,po,!1)),ic(i))}function Jy(i,A,d){if((Ra&6)!==0)throw Error(a(327));var p=!d&&(A&127)===0&&(A&i.expiredLanes)===0||wr(i,A),_=p?D6(i,A):u1(i,A,!0),C=p;do{if(_===0){Td&&!p&&Fu(i,A,0,!1);break}else{if(d=i.current.alternate,C&&!j6(d)){_=u1(i,A,!1),C=!1;continue}if(_===2){if(C=A,i.errorRecoveryDisabledLanes&C)var W=0;else W=i.pendingLanes&-536870913,W=W!==0?W:W&536870912?536870912:0;if(W!==0){A=W;e:{var ge=i;_=fh;var De=ge.current.memoizedState.isDehydrated;if(De&&(Ud(ge,W).flags|=256),W=u1(ge,W,!1),W!==2){if(s1&&!De){ge.errorRecoveryDisabledLanes|=C,N0|=C,_=4;break e}C=Wl,Wl=_,C!==null&&(Wl===null?Wl=C:Wl.push.apply(Wl,C))}_=W}if(C=!1,_!==2)continue}}if(_===1){Ud(i,0),Fu(i,A,0,!0);break}e:{switch(p=i,C=_,C){case 0:case 1:throw Error(a(345));case 4:if((A&4194048)!==A)break;case 6:Fu(p,A,po,!Cu);break e;case 2:Wl=null;break;case 3:case 5:break;default:throw Error(a(329))}if((A&62914560)===A&&(_=Sg+300-Ot(),10<_)){if(Fu(p,A,po,!Cu),Zt(p,0,!0)!==0)break e;Gc=A,p.timeoutHandle=E5(Zy.bind(null,p,d,Wl,Eg,i1,A,po,N0,Ld,Cu,C,"Throttled",-0,0),_);break e}Zy(p,d,Wl,Eg,i1,A,po,N0,Ld,Cu,C,null,-0,0)}}break}while(!0);ic(i)}function Zy(i,A,d,p,_,C,W,ge,De,Ze,ut,xt,et,rt){if(i.timeoutHandle=-1,xt=A.subtreeFlags,xt&8192||(xt&16785408)===16785408){xt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:cl},zy(A,C,xt);var hr=(C&62914560)===C?Sg-Ot():(C&4194048)===C?$y-Ot():0;if(hr=m8(xt,hr),hr!==null){Gc=C,i.cancelPendingCommit=hr(l5.bind(null,i,A,C,d,p,_,W,ge,De,ut,xt,null,et,rt)),Fu(i,C,W,!Ze);return}}l5(i,A,C,d,p,_,W,ge,De)}function j6(i){for(var A=i;;){var d=A.tag;if((d===0||d===11||d===15)&&A.flags&16384&&(d=A.updateQueue,d!==null&&(d=d.stores,d!==null)))for(var p=0;p<d.length;p++){var _=d[p],C=_.getSnapshot;_=_.value;try{if(!zs(C(),_))return!1}catch{return!1}}if(d=A.child,A.subtreeFlags&16384&&d!==null)d.return=A,A=d;else{if(A===i)break;for(;A.sibling===null;){if(A.return===null||A.return===i)return!0;A=A.return}A.sibling.return=A.return,A=A.sibling}}return!0}function Fu(i,A,d,p){A&=~n1,A&=~N0,i.suspendedLanes|=A,i.pingedLanes&=~A,p&&(i.warmLanes|=A),p=i.expirationTimes;for(var _=A;0<_;){var C=31-vr(_),W=1<<C;p[C]=-1,_&=~W}d!==0&&Mr(i,d,A)}function Fg(){return(Ra&6)===0?(ph(0),!1):!0}function c1(){if(pa!==null){if(Va===0)var i=pa.return;else i=pa,Io=YA=null,_d(i),bt=null,gr=0,i=pa;for(;i!==null;)Fy(i.alternate,i),i=i.return;pa=null}}function Ud(i,A){var d=i.timeoutHandle;d!==-1&&(i.timeoutHandle=-1,Z6(d)),d=i.cancelPendingCommit,d!==null&&(i.cancelPendingCommit=null,d()),Gc=0,c1(),cs=i,pa=d=Ql(i.current,null),xa=A,Va=0,ho=null,Cu=!1,Td=wr(i,A),s1=!1,Ld=po=n1=N0=Su=nn=0,Wl=fh=null,i1=!1,(A&8)!==0&&(A|=A&32);var p=i.entangledLanes;if(p!==0)for(i=i.entanglements,p&=A;0<p;){var _=31-vr(p),C=1<<_;A|=i[_],p&=~C}return Vc=A,Il(),d}function e5(i,A){Nr=null,ee.H=nh,A===Oe||A===Be?(A=dt(),Va=3):A===Xe?(A=dt(),Va=4):Va=A===Pb?8:A!==null&&typeof A=="object"&&typeof A.then=="function"?6:1,ho=A,pa===null&&(nn=1,bg(i,Ol(A,i.current)))}function t5(){var i=Cs.current;return i===null?!0:(xa&4194048)===xa?Ca===null:(xa&62914560)===xa||(xa&536870912)!==0?i===Ca:!1}function r5(){var i=ee.H;return ee.H=nh,i===null?nh:i}function a5(){var i=ee.A;return ee.A=T6,i}function Tg(){nn=4,Cu||(xa&4194048)!==xa&&Cs.current!==null||(Td=!0),(Su&134217727)===0&&(N0&134217727)===0||cs===null||Fu(cs,xa,po,!1)}function u1(i,A,d){var p=Ra;Ra|=2;var _=r5(),C=a5();(cs!==i||xa!==A)&&(Eg=null,Ud(i,A)),A=!1;var W=nn;e:do try{if(Va!==0&&pa!==null){var ge=pa,De=ho;switch(Va){case 8:c1(),W=6;break e;case 3:case 2:case 9:case 6:Cs.current===null&&(A=!0);var Ze=Va;if(Va=0,ho=null,Dd(i,ge,De,Ze),d&&Td){W=0;break e}break;default:Ze=Va,Va=0,ho=null,Dd(i,ge,De,Ze)}}U6(),W=nn;break}catch(ut){e5(i,ut)}while(!0);return A&&i.shellSuspendCounter++,Io=YA=null,Ra=p,ee.H=_,ee.A=C,pa===null&&(cs=null,xa=0,Il()),W}function U6(){for(;pa!==null;)s5(pa)}function D6(i,A){var d=Ra;Ra|=2;var p=r5(),_=a5();cs!==i||xa!==A?(Eg=null,Ng=Ot()+500,Ud(i,A)):Td=wr(i,A);e:do try{if(Va!==0&&pa!==null){A=pa;var C=ho;t:switch(Va){case 1:Va=0,ho=null,Dd(i,A,C,1);break;case 2:case 9:if(We(C)){Va=0,ho=null,n5(A);break}A=function(){Va!==2&&Va!==9||cs!==i||(Va=7),ic(i)},C.then(A,A);break e;case 3:Va=7;break e;case 4:Va=5;break e;case 7:We(C)?(Va=0,ho=null,n5(A)):(Va=0,ho=null,Dd(i,A,C,7));break;case 5:var W=null;switch(pa.tag){case 26:W=pa.memoizedState;case 5:case 27:var ge=pa;if(W?K5(W):ge.stateNode.complete){Va=0,ho=null;var De=ge.sibling;if(De!==null)pa=De;else{var Ze=ge.return;Ze!==null?(pa=Ze,Lg(Ze)):pa=null}break t}}Va=0,ho=null,Dd(i,A,C,5);break;case 6:Va=0,ho=null,Dd(i,A,C,6);break;case 8:c1(),nn=6;break e;default:throw Error(a(462))}}I6();break}catch(ut){e5(i,ut)}while(!0);return Io=YA=null,ee.H=p,ee.A=_,Ra=d,pa!==null?0:(cs=null,xa=0,Il(),nn)}function I6(){for(;pa!==null&&!Dt();)s5(pa)}function s5(i){var A=Ny(i.alternate,i,Vc);i.memoizedProps=i.pendingProps,A===null?Lg(i):pa=A}function n5(i){var A=i,d=A.alternate;switch(A.tag){case 15:case 0:A=_y(d,A,A.pendingProps,A.type,void 0,xa);break;case 11:A=_y(d,A,A.pendingProps,A.type.render,A.ref,xa);break;case 5:_d(A);default:Fy(d,A),A=pa=b0(A,Vc),A=Ny(d,A,Vc)}i.memoizedProps=i.pendingProps,A===null?Lg(i):pa=A}function Dd(i,A,d,p){Io=YA=null,_d(A),bt=null,gr=0;var _=A.return;try{if(k6(i,_,A,d,xa)){nn=1,bg(i,Ol(d,i.current)),pa=null;return}}catch(C){if(_!==null)throw pa=_,C;nn=1,bg(i,Ol(d,i.current)),pa=null;return}A.flags&32768?(ha||p===1?i=!0:Td||(xa&536870912)!==0?i=!1:(Cu=i=!0,(p===2||p===9||p===3||p===6)&&(p=Cs.current,p!==null&&p.tag===13&&(p.flags|=16384))),i5(A,i)):Lg(A)}function Lg(i){var A=i;do{if((A.flags&32768)!==0){i5(A,Cu);return}i=A.return;var d=S6(A.alternate,A,Vc);if(d!==null){pa=d;return}if(A=A.sibling,A!==null){pa=A;return}pa=A=i}while(A!==null);nn===0&&(nn=5)}function i5(i,A){do{var d=N6(i.alternate,i);if(d!==null){d.flags&=32767,pa=d;return}if(d=i.return,d!==null&&(d.flags|=32768,d.subtreeFlags=0,d.deletions=null),!A&&(i=i.sibling,i!==null)){pa=i;return}pa=i=d}while(i!==null);nn=6,pa=null}function l5(i,A,d,p,_,C,W,ge,De){i.cancelPendingCommit=null;do jg();while(si!==0);if((Ra&6)!==0)throw Error(a(327));if(A!==null){if(A===i.current)throw Error(a(177));if(C=A.lanes|A.childLanes,C|=Wi,Yt(i,d,C,W,ge,De),i===cs&&(pa=cs=null,xa=0),jd=A,Eu=i,Gc=d,l1=C,o1=_,Xy=p,(A.subtreeFlags&10256)!==0||(A.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,M6(Vt,function(){return d5(),null})):(i.callbackNode=null,i.callbackPriority=0),p=(A.flags&13878)!==0,(A.subtreeFlags&13878)!==0||p){p=ee.T,ee.T=null,_=le.p,le.p=2,W=Ra,Ra|=4;try{E6(i,A,d)}finally{Ra=W,le.p=_,ee.T=p}}si=1,o5(),A5(),c5()}}function o5(){if(si===1){si=0;var i=Eu,A=jd,d=(A.flags&13878)!==0;if((A.subtreeFlags&13878)!==0||d){d=ee.T,ee.T=null;var p=le.p;le.p=2;var _=Ra;Ra|=4;try{Py(A,i);var C=y1,W=Ds(i.containerInfo),ge=C.focusedElem,De=C.selectionRange;if(W!==ge&&ge&&ge.ownerDocument&&zi(ge.ownerDocument.documentElement,ge)){if(De!==null&&Vi(ge)){var Ze=De.start,ut=De.end;if(ut===void 0&&(ut=Ze),"selectionStart"in ge)ge.selectionStart=Ze,ge.selectionEnd=Math.min(ut,ge.value.length);else{var xt=ge.ownerDocument||document,et=xt&&xt.defaultView||window;if(et.getSelection){var rt=et.getSelection(),hr=ge.textContent.length,Ir=Math.min(De.start,hr),ss=De.end===void 0?Ir:Math.min(De.end,hr);!rt.extend&&Ir>ss&&(W=ss,ss=Ir,Ir=W);var Ve=GA(ge,Ir),Me=GA(ge,ss);if(Ve&&Me&&(rt.rangeCount!==1||rt.anchorNode!==Ve.node||rt.anchorOffset!==Ve.offset||rt.focusNode!==Me.node||rt.focusOffset!==Me.offset)){var Je=xt.createRange();Je.setStart(Ve.node,Ve.offset),rt.removeAllRanges(),Ir>ss?(rt.addRange(Je),rt.extend(Me.node,Me.offset)):(Je.setEnd(Me.node,Me.offset),rt.addRange(Je))}}}}for(xt=[],rt=ge;rt=rt.parentNode;)rt.nodeType===1&&xt.push({element:rt,left:rt.scrollLeft,top:rt.scrollTop});for(typeof ge.focus=="function"&&ge.focus(),ge=0;ge<xt.length;ge++){var ht=xt[ge];ht.element.scrollLeft=ht.left,ht.element.scrollTop=ht.top}}zg=!!_1,y1=_1=null}finally{Ra=_,le.p=p,ee.T=d}}i.current=A,si=2}}function A5(){if(si===2){si=0;var i=Eu,A=jd,d=(A.flags&8772)!==0;if((A.subtreeFlags&8772)!==0||d){d=ee.T,ee.T=null;var p=le.p;le.p=2;var _=Ra;Ra|=4;try{Qy(i,A.alternate,A)}finally{Ra=_,le.p=p,ee.T=d}}si=3}}function c5(){if(si===4||si===3){si=0,It();var i=Eu,A=jd,d=Gc,p=Xy;(A.subtreeFlags&10256)!==0||(A.flags&10256)!==0?si=5:(si=0,jd=Eu=null,u5(i,i.pendingLanes));var _=i.pendingLanes;if(_===0&&(Nu=null),Cr(d),A=A.stateNode,Rt&&typeof Rt.onCommitFiberRoot=="function")try{Rt.onCommitFiberRoot(Ht,A,void 0,(A.current.flags&128)===128)}catch{}if(p!==null){A=ee.T,_=le.p,le.p=2,ee.T=null;try{for(var C=i.onRecoverableError,W=0;W<p.length;W++){var ge=p[W];C(ge.value,{componentStack:ge.stack})}}finally{ee.T=A,le.p=_}}(Gc&3)!==0&&jg(),ic(i),_=i.pendingLanes,(d&261930)!==0&&(_&42)!==0?i===A1?hh++:(hh=0,A1=i):hh=0,ph(0)}}function u5(i,A){(i.pooledCacheLanes&=A)===0&&(A=i.pooledCache,A!=null&&(i.pooledCache=null,_0(A)))}function jg(){return o5(),A5(),c5(),d5()}function d5(){if(si!==5)return!1;var i=Eu,A=l1;l1=0;var d=Cr(Gc),p=ee.T,_=le.p;try{le.p=32>d?32:d,ee.T=null,d=o1,o1=null;var C=Eu,W=Gc;if(si=0,jd=Eu=null,Gc=0,(Ra&6)!==0)throw Error(a(331));var ge=Ra;if(Ra|=4,Gy(C.current),Ky(C,C.current,W,d),Ra=ge,ph(0,!1),Rt&&typeof Rt.onPostCommitFiberRoot=="function")try{Rt.onPostCommitFiberRoot(Ht,C)}catch{}return!0}finally{le.p=_,ee.T=p,u5(i,A)}}function f5(i,A,d){A=Ol(d,A),A=Hb(i.stateNode,A,2),i=ra(i,A,2),i!==null&&(Bt(i,2),ic(i))}function Ga(i,A,d){if(i.tag===3)f5(i,i,d);else for(;A!==null;){if(A.tag===3){f5(A,i,d);break}else if(A.tag===1){var p=A.stateNode;if(typeof A.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Nu===null||!Nu.has(p))){i=Ol(d,i),d=hy(2),p=ra(A,d,2),p!==null&&(py(d,p,A,i),Bt(p,2),ic(p));break}}A=A.return}}function d1(i,A,d){var p=i.pingCache;if(p===null){p=i.pingCache=new L6;var _=new Set;p.set(A,_)}else _=p.get(A),_===void 0&&(_=new Set,p.set(A,_));_.has(d)||(s1=!0,_.add(d),i=Q6.bind(null,i,A,d),A.then(i,i))}function Q6(i,A,d){var p=i.pingCache;p!==null&&p.delete(A),i.pingedLanes|=i.suspendedLanes&d,i.warmLanes&=~d,cs===i&&(xa&d)===d&&(nn===4||nn===3&&(xa&62914560)===xa&&300>Ot()-Sg?(Ra&2)===0&&Ud(i,0):n1|=d,Ld===xa&&(Ld=0)),ic(i)}function h5(i,A){A===0&&(A=Et()),i=Ei(i,A),i!==null&&(Bt(i,A),ic(i))}function O6(i){var A=i.memoizedState,d=0;A!==null&&(d=A.retryLane),h5(i,d)}function R6(i,A){var d=0;switch(i.tag){case 31:case 13:var p=i.stateNode,_=i.memoizedState;_!==null&&(d=_.retryLane);break;case 19:p=i.stateNode;break;case 22:p=i.stateNode._retryCache;break;default:throw Error(a(314))}p!==null&&p.delete(A),h5(i,d)}function M6(i,A){return pt(i,A)}var Ug=null,Id=null,f1=!1,Dg=!1,h1=!1,Tu=0;function ic(i){i!==Id&&i.next===null&&(Id===null?Ug=Id=i:Id=Id.next=i),Dg=!0,f1||(f1=!0,P6())}function ph(i,A){if(!h1&&Dg){h1=!0;do for(var d=!1,p=Ug;p!==null;){if(i!==0){var _=p.pendingLanes;if(_===0)var C=0;else{var W=p.suspendedLanes,ge=p.pingedLanes;C=(1<<31-vr(42|i)+1)-1,C&=_&~(W&~ge),C=C&201326741?C&201326741|1:C?C|2:0}C!==0&&(d=!0,x5(p,C))}else C=xa,C=Zt(p,p===cs?C:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(C&3)===0||wr(p,C)||(d=!0,x5(p,C));p=p.next}while(d);h1=!1}}function H6(){p5()}function p5(){Dg=f1=!1;var i=0;Tu!==0&&J6()&&(i=Tu);for(var A=Ot(),d=null,p=Ug;p!==null;){var _=p.next,C=g5(p,A);C===0?(p.next=null,d===null?Ug=_:d.next=_,_===null&&(Id=d)):(d=p,(i!==0||(C&3)!==0)&&(Dg=!0)),p=_}si!==0&&si!==5||ph(i),Tu!==0&&(Tu=0)}function g5(i,A){for(var d=i.suspendedLanes,p=i.pingedLanes,_=i.expirationTimes,C=i.pendingLanes&-62914561;0<C;){var W=31-vr(C),ge=1<<W,De=_[W];De===-1?((ge&d)===0||(ge&p)!==0)&&(_[W]=Re(ge,A)):De<=A&&(i.expiredLanes|=ge),C&=~ge}if(A=cs,d=xa,d=Zt(i,i===A?d:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p=i.callbackNode,d===0||i===A&&(Va===2||Va===9)||i.cancelPendingCommit!==null)return p!==null&&p!==null&&nt(p),i.callbackNode=null,i.callbackPriority=0;if((d&3)===0||wr(i,d)){if(A=d&-d,A===i.callbackPriority)return A;switch(p!==null&&nt(p),Cr(d)){case 2:case 8:d=cr;break;case 32:d=Vt;break;case 268435456:d=Nt;break;default:d=Vt}return p=m5.bind(null,i),d=pt(d,p),i.callbackPriority=A,i.callbackNode=d,A}return p!==null&&p!==null&&nt(p),i.callbackPriority=2,i.callbackNode=null,2}function m5(i,A){if(si!==0&&si!==5)return i.callbackNode=null,i.callbackPriority=0,null;var d=i.callbackNode;if(jg()&&i.callbackNode!==d)return null;var p=xa;return p=Zt(i,i===cs?p:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p===0?null:(Jy(i,p,A),g5(i,Ot()),i.callbackNode!=null&&i.callbackNode===d?m5.bind(null,i):null)}function x5(i,A){if(jg())return null;Jy(i,A,!0)}function P6(){e8(function(){(Ra&6)!==0?pt(er,H6):p5()})}function p1(){if(Tu===0){var i=b;i===0&&(i=rr,rr<<=1,(rr&261888)===0&&(rr=256)),Tu=i}return Tu}function b5(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:fn(""+i)}function v5(i,A){var d=A.ownerDocument.createElement("input");return d.name=A.name,d.value=A.value,i.id&&d.setAttribute("form",i.id),A.parentNode.insertBefore(d,A),i=new FormData(i),d.parentNode.removeChild(d),i}function q6(i,A,d,p,_){if(A==="submit"&&d&&d.stateNode===_){var C=b5((_[ye]||null).action),W=p.submitter;W&&(A=(A=W[ye]||null)?b5(A.formAction):W.getAttribute("formAction"),A!==null&&(C=A,W=null));var ge=new Mi("action","action",null,p,_);i.push({event:ge,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(Tu!==0){var De=W?v5(_,W):new FormData(_);Db(d,{pending:!0,data:De,method:_.method,action:C},null,De)}}else typeof C=="function"&&(ge.preventDefault(),De=W?v5(_,W):new FormData(_),Db(d,{pending:!0,data:De,method:_.method,action:C},C,De))},currentTarget:_}]})}}for(var g1=0;g1<gs.length;g1++){var m1=gs[g1],K6=m1.toLowerCase(),z6=m1[0].toUpperCase()+m1.slice(1);es(K6,"on"+z6)}es(Br,"onAnimationEnd"),es(Or,"onAnimationIteration"),es(Pr,"onAnimationStart"),es("dblclick","onDoubleClick"),es("focusin","onFocus"),es("focusout","onBlur"),es(Aa,"onTransitionRun"),es(In,"onTransitionStart"),es(Zr,"onTransitionCancel"),es(qr,"onTransitionEnd"),fs("onMouseEnter",["mouseout","mouseover"]),fs("onMouseLeave",["mouseout","mouseover"]),fs("onPointerEnter",["pointerout","pointerover"]),fs("onPointerLeave",["pointerout","pointerover"]),oa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),oa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),oa("onBeforeInput",["compositionend","keypress","textInput","paste"]),oa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),oa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),oa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var gh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),V6=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(gh));function w5(i,A){A=(A&4)!==0;for(var d=0;d<i.length;d++){var p=i[d],_=p.event;p=p.listeners;e:{var C=void 0;if(A)for(var W=p.length-1;0<=W;W--){var ge=p[W],De=ge.instance,Ze=ge.currentTarget;if(ge=ge.listener,De!==C&&_.isPropagationStopped())break e;C=ge,_.currentTarget=Ze;try{C(_)}catch(ut){Zs(ut)}_.currentTarget=null,C=De}else for(W=0;W<p.length;W++){if(ge=p[W],De=ge.instance,Ze=ge.currentTarget,ge=ge.listener,De!==C&&_.isPropagationStopped())break e;C=ge,_.currentTarget=Ze;try{C(_)}catch(ut){Zs(ut)}_.currentTarget=null,C=De}}}}function ga(i,A){var d=A[ce];d===void 0&&(d=A[ce]=new Set);var p=i+"__bubble";d.has(p)||(_5(A,i,2,!1),d.add(p))}function x1(i,A,d){var p=0;A&&(p|=4),_5(d,i,p,A)}var Ig="_reactListening"+Math.random().toString(36).slice(2);function b1(i){if(!i[Ig]){i[Ig]=!0,Gr.forEach(function(d){d!=="selectionchange"&&(V6.has(d)||x1(d,!1,i),x1(d,!0,i))});var A=i.nodeType===9?i:i.ownerDocument;A===null||A[Ig]||(A[Ig]=!0,x1("selectionchange",!1,A))}}function _5(i,A,d,p){switch(Y5(A)){case 2:var _=v8;break;case 8:_=w8;break;default:_=U1}d=_.bind(null,A,d,i),_=void 0,!PA||A!=="touchstart"&&A!=="touchmove"&&A!=="wheel"||(_=!0),p?_!==void 0?i.addEventListener(A,d,{capture:!0,passive:_}):i.addEventListener(A,d,!0):_!==void 0?i.addEventListener(A,d,{passive:_}):i.addEventListener(A,d,!1)}function v1(i,A,d,p,_){var C=p;if((A&1)===0&&(A&2)===0&&p!==null)e:for(;;){if(p===null)return;var W=p.tag;if(W===3||W===4){var ge=p.stateNode.containerInfo;if(ge===_)break;if(W===4)for(W=p.return;W!==null;){var De=W.tag;if((De===3||De===4)&&W.stateNode.containerInfo===_)return;W=W.return}for(;ge!==null;){if(W=_t(ge),W===null)return;if(De=W.tag,De===5||De===6||De===26||De===27){p=C=W;continue e}ge=ge.parentNode}}p=p.return}HA(function(){var Ze=C,ut=No(d),xt=[];e:{var et=fa.get(i);if(et!==void 0){var rt=Mi,hr=i;switch(i){case"keypress":if(bs(d)===0)break e;case"keydown":case"keyup":rt=da;break;case"focusin":hr="focus",rt=pn;break;case"focusout":hr="blur",rt=pn;break;case"beforeblur":case"afterblur":rt=pn;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":rt=Fo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":rt=Hi;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":rt=Ks;break;case Br:case Or:case Pr:rt=N;break;case qr:rt=Js;break;case"scroll":case"scrollend":rt=ma;break;case"wheel":rt=ul;break;case"copy":case"cut":case"paste":rt=Se;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":rt=ps;break;case"toggle":case"beforetoggle":rt=ws}var Ir=(A&4)!==0,ss=!Ir&&(i==="scroll"||i==="scrollend"),Ve=Ir?et!==null?et+"Capture":null:et;Ir=[];for(var Me=Ze,Je;Me!==null;){var ht=Me;if(Je=ht.stateNode,ht=ht.tag,ht!==5&&ht!==26&&ht!==27||Je===null||Ve===null||(ht=$n(Me,Ve),ht!=null&&Ir.push(mh(Me,ht,Je))),ss)break;Me=Me.return}0<Ir.length&&(et=new rt(et,hr,null,d,ut),xt.push({event:et,listeners:Ir}))}}if((A&7)===0){e:{if(et=i==="mouseover"||i==="pointerover",rt=i==="mouseout"||i==="pointerout",et&&d!==Ys&&(hr=d.relatedTarget||d.fromElement)&&(_t(hr)||hr[O]))break e;if((rt||et)&&(et=ut.window===ut?ut:(et=ut.ownerDocument)?et.defaultView||et.parentWindow:window,rt?(hr=d.relatedTarget||d.toElement,rt=Ze,hr=hr?_t(hr):null,hr!==null&&(ss=n(hr),Ir=hr.tag,hr!==ss||Ir!==5&&Ir!==27&&Ir!==6)&&(hr=null)):(rt=null,hr=Ze),rt!==hr)){if(Ir=Fo,ht="onMouseLeave",Ve="onMouseEnter",Me="mouse",(i==="pointerout"||i==="pointerover")&&(Ir=ps,ht="onPointerLeave",Ve="onPointerEnter",Me="pointer"),ss=rt==null?et:yt(rt),Je=hr==null?et:yt(hr),et=new Ir(ht,Me+"leave",rt,d,ut),et.target=ss,et.relatedTarget=Je,ht=null,_t(ut)===Ze&&(Ir=new Ir(Ve,Me+"enter",hr,d,ut),Ir.target=Je,Ir.relatedTarget=ss,ht=Ir),ss=ht,rt&&hr)t:{for(Ir=G6,Ve=rt,Me=hr,Je=0,ht=Ve;ht;ht=Ir(ht))Je++;ht=0;for(var Fr=Me;Fr;Fr=Ir(Fr))ht++;for(;0<Je-ht;)Ve=Ir(Ve),Je--;for(;0<ht-Je;)Me=Ir(Me),ht--;for(;Je--;){if(Ve===Me||Me!==null&&Ve===Me.alternate){Ir=Ve;break t}Ve=Ir(Ve),Me=Ir(Me)}Ir=null}else Ir=null;rt!==null&&y5(xt,et,rt,Ir,!1),hr!==null&&ss!==null&&y5(xt,ss,hr,Ir,!0)}}e:{if(et=Ze?yt(Ze):window,rt=et.nodeName&&et.nodeName.toLowerCase(),rt==="select"||rt==="input"&&et.type==="file")var ja=Uo;else if(uA(et))if(Jn)ja=jl;else{ja=ys;var br=dA}else rt=et.nodeName,!rt||rt.toLowerCase()!=="input"||et.type!=="checkbox"&&et.type!=="radio"?Ze&&lA(Ze.elementType)&&(ja=Uo):ja=fu;if(ja&&(ja=ja(i,Ze))){hi(xt,ja,d,ut);break e}br&&br(i,et,Ze),i==="focusout"&&Ze&&et.type==="number"&&Ze.memoizedProps.value!=null&&io(et,"number",et.value)}switch(br=Ze?yt(Ze):window,i){case"focusin":(uA(br)||br.contentEditable==="true")&&(Zn=br,pi=Ze,Dn=null);break;case"focusout":Dn=pi=Zn=null;break;case"mousedown":Gi=!0;break;case"contextmenu":case"mouseup":case"dragend":Gi=!1,X(xt,d,ut);break;case"selectionchange":if(fA)break;case"keydown":case"keyup":X(xt,d,ut)}var sa;if(dl)e:{switch(i){case"compositionstart":var ba="onCompositionStart";break e;case"compositionend":ba="onCompositionEnd";break e;case"compositionupdate":ba="onCompositionUpdate";break e}ba=void 0}else fl?Ao(i,d)&&(ba="onCompositionEnd"):i==="keydown"&&d.keyCode===229&&(ba="onCompositionStart");ba&&(oo&&d.locale!=="ko"&&(fl||ba!=="onCompositionStart"?ba==="onCompositionEnd"&&fl&&(sa=Xn()):(fi=ut,AA="value"in fi?fi.value:fi.textContent,fl=!0)),br=Qg(Ze,ba),0<br.length&&(ba=new ze(ba,i,null,d,ut),xt.push({event:ba,listeners:br}),sa?ba.data=sa:(sa=KA(d),sa!==null&&(ba.data=sa)))),(sa=cA?Yn(i,d):Tl(i,d))&&(ba=Qg(Ze,"onBeforeInput"),0<ba.length&&(br=new ze("onBeforeInput","beforeinput",null,d,ut),xt.push({event:br,listeners:ba}),br.data=sa)),q6(xt,i,Ze,d,ut)}w5(xt,A)})}function mh(i,A,d){return{instance:i,listener:A,currentTarget:d}}function Qg(i,A){for(var d=A+"Capture",p=[];i!==null;){var _=i,C=_.stateNode;if(_=_.tag,_!==5&&_!==26&&_!==27||C===null||(_=$n(i,d),_!=null&&p.unshift(mh(i,_,C)),_=$n(i,A),_!=null&&p.push(mh(i,_,C))),i.tag===3)return p;i=i.return}return[]}function G6(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function y5(i,A,d,p,_){for(var C=A._reactName,W=[];d!==null&&d!==p;){var ge=d,De=ge.alternate,Ze=ge.stateNode;if(ge=ge.tag,De!==null&&De===p)break;ge!==5&&ge!==26&&ge!==27||Ze===null||(De=Ze,_?(Ze=$n(d,C),Ze!=null&&W.unshift(mh(d,Ze,De))):_||(Ze=$n(d,C),Ze!=null&&W.push(mh(d,Ze,De)))),d=d.return}W.length!==0&&i.push({event:A,listeners:W})}var W6=/\r\n?/g,$6=/\u0000|\uFFFD/g;function k5(i){return(typeof i=="string"?i:""+i).replace(W6,`
`).replace($6,"")}function B5(i,A){return A=k5(A),k5(i)===A}function as(i,A,d,p,_,C){switch(d){case"children":typeof p=="string"?A==="body"||A==="textarea"&&p===""||Si(i,p):(typeof p=="number"||typeof p=="bigint")&&A!=="body"&&Si(i,""+p);break;case"className":st(i,"class",p);break;case"tabIndex":st(i,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":st(i,d,p);break;case"style":Lc(i,p,C);break;case"data":if(A!=="object"){st(i,"data",p);break}case"src":case"href":if(p===""&&(A!=="a"||d!=="href")){i.removeAttribute(d);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(d);break}p=fn(""+p),i.setAttribute(d,p);break;case"action":case"formAction":if(typeof p=="function"){i.setAttribute(d,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof C=="function"&&(d==="formAction"?(A!=="input"&&as(i,A,"name",_.name,_,null),as(i,A,"formEncType",_.formEncType,_,null),as(i,A,"formMethod",_.formMethod,_,null),as(i,A,"formTarget",_.formTarget,_,null)):(as(i,A,"encType",_.encType,_,null),as(i,A,"method",_.method,_,null),as(i,A,"target",_.target,_,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(d);break}p=fn(""+p),i.setAttribute(d,p);break;case"onClick":p!=null&&(i.onclick=cl);break;case"onScroll":p!=null&&ga("scroll",i);break;case"onScrollEnd":p!=null&&ga("scrollend",i);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(a(61));if(d=p.__html,d!=null){if(_.children!=null)throw Error(a(60));i.innerHTML=d}}break;case"multiple":i.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":i.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){i.removeAttribute("xlink:href");break}d=fn(""+p),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",d);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(d,""+p):i.removeAttribute(d);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(d,""):i.removeAttribute(d);break;case"capture":case"download":p===!0?i.setAttribute(d,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(d,p):i.removeAttribute(d);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?i.setAttribute(d,p):i.removeAttribute(d);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?i.removeAttribute(d):i.setAttribute(d,p);break;case"popover":ga("beforetoggle",i),ga("toggle",i),St(i,"popover",p);break;case"xlinkActuate":Hr(i,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":Hr(i,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":Hr(i,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":Hr(i,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":Hr(i,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":Hr(i,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":Hr(i,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":Hr(i,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":Hr(i,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":St(i,"is",p);break;case"innerText":case"textContent":break;default:(!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(d=OA.get(d)||d,St(i,d,p))}}function w1(i,A,d,p,_,C){switch(d){case"style":Lc(i,p,C);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(a(61));if(d=p.__html,d!=null){if(_.children!=null)throw Error(a(60));i.innerHTML=d}}break;case"children":typeof p=="string"?Si(i,p):(typeof p=="number"||typeof p=="bigint")&&Si(i,""+p);break;case"onScroll":p!=null&&ga("scroll",i);break;case"onScrollEnd":p!=null&&ga("scrollend",i);break;case"onClick":p!=null&&(i.onclick=cl);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Qr.hasOwnProperty(d))e:{if(d[0]==="o"&&d[1]==="n"&&(_=d.endsWith("Capture"),A=d.slice(2,_?d.length-7:void 0),C=i[ye]||null,C=C!=null?C[d]:null,typeof C=="function"&&i.removeEventListener(A,C,_),typeof p=="function")){typeof C!="function"&&C!==null&&(d in i?i[d]=null:i.hasAttribute(d)&&i.removeAttribute(d)),i.addEventListener(A,p,_);break e}d in i?i[d]=p:p===!0?i.setAttribute(d,""):St(i,d,p)}}}function ji(i,A,d){switch(A){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ga("error",i),ga("load",i);var p=!1,_=!1,C;for(C in d)if(d.hasOwnProperty(C)){var W=d[C];if(W!=null)switch(C){case"src":p=!0;break;case"srcSet":_=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,A));default:as(i,A,C,W,d,null)}}_&&as(i,A,"srcSet",d.srcSet,d,null),p&&as(i,A,"src",d.src,d,null);return;case"input":ga("invalid",i);var ge=C=W=_=null,De=null,Ze=null;for(p in d)if(d.hasOwnProperty(p)){var ut=d[p];if(ut!=null)switch(p){case"name":_=ut;break;case"type":W=ut;break;case"checked":De=ut;break;case"defaultChecked":Ze=ut;break;case"value":C=ut;break;case"defaultValue":ge=ut;break;case"children":case"dangerouslySetInnerHTML":if(ut!=null)throw Error(a(137,A));break;default:as(i,A,p,ut,d,null)}}Ln(i,C,ge,De,Ze,W,_,!1);return;case"select":ga("invalid",i),p=W=C=null;for(_ in d)if(d.hasOwnProperty(_)&&(ge=d[_],ge!=null))switch(_){case"value":C=ge;break;case"defaultValue":W=ge;break;case"multiple":p=ge;default:as(i,A,_,ge,d,null)}A=C,d=W,i.multiple=!!p,A!=null?Ls(i,!!p,A,!1):d!=null&&Ls(i,!!p,d,!0);return;case"textarea":ga("invalid",i),C=_=p=null;for(W in d)if(d.hasOwnProperty(W)&&(ge=d[W],ge!=null))switch(W){case"value":p=ge;break;case"defaultValue":_=ge;break;case"children":C=ge;break;case"dangerouslySetInnerHTML":if(ge!=null)throw Error(a(91));break;default:as(i,A,W,ge,d,null)}iA(i,p,_,C);return;case"option":for(De in d)d.hasOwnProperty(De)&&(p=d[De],p!=null)&&(De==="selected"?i.selected=p&&typeof p!="function"&&typeof p!="symbol":as(i,A,De,p,d,null));return;case"dialog":ga("beforetoggle",i),ga("toggle",i),ga("cancel",i),ga("close",i);break;case"iframe":case"object":ga("load",i);break;case"video":case"audio":for(p=0;p<gh.length;p++)ga(gh[p],i);break;case"image":ga("error",i),ga("load",i);break;case"details":ga("toggle",i);break;case"embed":case"source":case"link":ga("error",i),ga("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ze in d)if(d.hasOwnProperty(Ze)&&(p=d[Ze],p!=null))switch(Ze){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,A));default:as(i,A,Ze,p,d,null)}return;default:if(lA(A)){for(ut in d)d.hasOwnProperty(ut)&&(p=d[ut],p!==void 0&&w1(i,A,ut,p,d,void 0));return}}for(ge in d)d.hasOwnProperty(ge)&&(p=d[ge],p!=null&&as(i,A,ge,p,d,null))}function X6(i,A,d,p){switch(A){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var _=null,C=null,W=null,ge=null,De=null,Ze=null,ut=null;for(rt in d){var xt=d[rt];if(d.hasOwnProperty(rt)&&xt!=null)switch(rt){case"checked":break;case"value":break;case"defaultValue":De=xt;default:p.hasOwnProperty(rt)||as(i,A,rt,null,p,xt)}}for(var et in p){var rt=p[et];if(xt=d[et],p.hasOwnProperty(et)&&(rt!=null||xt!=null))switch(et){case"type":C=rt;break;case"name":_=rt;break;case"checked":Ze=rt;break;case"defaultChecked":ut=rt;break;case"value":W=rt;break;case"defaultValue":ge=rt;break;case"children":case"dangerouslySetInnerHTML":if(rt!=null)throw Error(a(137,A));break;default:rt!==xt&&as(i,A,et,rt,p,xt)}}no(i,W,ge,De,Ze,ut,C,_);return;case"select":rt=W=ge=et=null;for(C in d)if(De=d[C],d.hasOwnProperty(C)&&De!=null)switch(C){case"value":break;case"multiple":rt=De;default:p.hasOwnProperty(C)||as(i,A,C,null,p,De)}for(_ in p)if(C=p[_],De=d[_],p.hasOwnProperty(_)&&(C!=null||De!=null))switch(_){case"value":et=C;break;case"defaultValue":ge=C;break;case"multiple":W=C;default:C!==De&&as(i,A,_,C,p,De)}A=ge,d=W,p=rt,et!=null?Ls(i,!!d,et,!1):!!p!=!!d&&(A!=null?Ls(i,!!d,A,!0):Ls(i,!!d,d?[]:"",!1));return;case"textarea":rt=et=null;for(ge in d)if(_=d[ge],d.hasOwnProperty(ge)&&_!=null&&!p.hasOwnProperty(ge))switch(ge){case"value":break;case"children":break;default:as(i,A,ge,null,p,_)}for(W in p)if(_=p[W],C=d[W],p.hasOwnProperty(W)&&(_!=null||C!=null))switch(W){case"value":et=_;break;case"defaultValue":rt=_;break;case"children":break;case"dangerouslySetInnerHTML":if(_!=null)throw Error(a(91));break;default:_!==C&&as(i,A,W,_,p,C)}Bl(i,et,rt);return;case"option":for(var hr in d)et=d[hr],d.hasOwnProperty(hr)&&et!=null&&!p.hasOwnProperty(hr)&&(hr==="selected"?i.selected=!1:as(i,A,hr,null,p,et));for(De in p)et=p[De],rt=d[De],p.hasOwnProperty(De)&&et!==rt&&(et!=null||rt!=null)&&(De==="selected"?i.selected=et&&typeof et!="function"&&typeof et!="symbol":as(i,A,De,et,p,rt));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ir in d)et=d[Ir],d.hasOwnProperty(Ir)&&et!=null&&!p.hasOwnProperty(Ir)&&as(i,A,Ir,null,p,et);for(Ze in p)if(et=p[Ze],rt=d[Ze],p.hasOwnProperty(Ze)&&et!==rt&&(et!=null||rt!=null))switch(Ze){case"children":case"dangerouslySetInnerHTML":if(et!=null)throw Error(a(137,A));break;default:as(i,A,Ze,et,p,rt)}return;default:if(lA(A)){for(var ss in d)et=d[ss],d.hasOwnProperty(ss)&&et!==void 0&&!p.hasOwnProperty(ss)&&w1(i,A,ss,void 0,p,et);for(ut in p)et=p[ut],rt=d[ut],!p.hasOwnProperty(ut)||et===rt||et===void 0&&rt===void 0||w1(i,A,ut,et,p,rt);return}}for(var Ve in d)et=d[Ve],d.hasOwnProperty(Ve)&&et!=null&&!p.hasOwnProperty(Ve)&&as(i,A,Ve,null,p,et);for(xt in p)et=p[xt],rt=d[xt],!p.hasOwnProperty(xt)||et===rt||et==null&&rt==null||as(i,A,xt,et,p,rt)}function C5(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Y6(){if(typeof performance.getEntriesByType=="function"){for(var i=0,A=0,d=performance.getEntriesByType("resource"),p=0;p<d.length;p++){var _=d[p],C=_.transferSize,W=_.initiatorType,ge=_.duration;if(C&&ge&&C5(W)){for(W=0,ge=_.responseEnd,p+=1;p<d.length;p++){var De=d[p],Ze=De.startTime;if(Ze>ge)break;var ut=De.transferSize,xt=De.initiatorType;ut&&C5(xt)&&(De=De.responseEnd,W+=ut*(De<ge?1:(ge-Ze)/(De-Ze)))}if(--p,A+=8*(C+W)/(_.duration/1e3),i++,10<i)break}}if(0<i)return A/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var _1=null,y1=null;function Og(i){return i.nodeType===9?i:i.ownerDocument}function S5(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function N5(i,A){if(i===0)switch(A){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&A==="foreignObject"?0:i}function k1(i,A){return i==="textarea"||i==="noscript"||typeof A.children=="string"||typeof A.children=="number"||typeof A.children=="bigint"||typeof A.dangerouslySetInnerHTML=="object"&&A.dangerouslySetInnerHTML!==null&&A.dangerouslySetInnerHTML.__html!=null}var B1=null;function J6(){var i=window.event;return i&&i.type==="popstate"?i===B1?!1:(B1=i,!0):(B1=null,!1)}var E5=typeof setTimeout=="function"?setTimeout:void 0,Z6=typeof clearTimeout=="function"?clearTimeout:void 0,F5=typeof Promise=="function"?Promise:void 0,e8=typeof queueMicrotask=="function"?queueMicrotask:typeof F5<"u"?function(i){return F5.resolve(null).then(i).catch(t8)}:E5;function t8(i){setTimeout(function(){throw i})}function Lu(i){return i==="head"}function T5(i,A){var d=A,p=0;do{var _=d.nextSibling;if(i.removeChild(d),_&&_.nodeType===8)if(d=_.data,d==="/$"||d==="/&"){if(p===0){i.removeChild(_),Md(A);return}p--}else if(d==="$"||d==="$?"||d==="$~"||d==="$!"||d==="&")p++;else if(d==="html")xh(i.ownerDocument.documentElement);else if(d==="head"){d=i.ownerDocument.head,xh(d);for(var C=d.firstChild;C;){var W=C.nextSibling,ge=C.nodeName;C[Ue]||ge==="SCRIPT"||ge==="STYLE"||ge==="LINK"&&C.rel.toLowerCase()==="stylesheet"||d.removeChild(C),C=W}}else d==="body"&&xh(i.ownerDocument.body);d=_}while(d);Md(A)}function L5(i,A){var d=i;i=0;do{var p=d.nextSibling;if(d.nodeType===1?A?(d._stashedDisplay=d.style.display,d.style.display="none"):(d.style.display=d._stashedDisplay||"",d.getAttribute("style")===""&&d.removeAttribute("style")):d.nodeType===3&&(A?(d._stashedText=d.nodeValue,d.nodeValue=""):d.nodeValue=d._stashedText||""),p&&p.nodeType===8)if(d=p.data,d==="/$"){if(i===0)break;i--}else d!=="$"&&d!=="$?"&&d!=="$~"&&d!=="$!"||i++;d=p}while(d)}function C1(i){var A=i.firstChild;for(A&&A.nodeType===10&&(A=A.nextSibling);A;){var d=A;switch(A=A.nextSibling,d.nodeName){case"HTML":case"HEAD":case"BODY":C1(d),tt(d);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(d.rel.toLowerCase()==="stylesheet")continue}i.removeChild(d)}}function r8(i,A,d,p){for(;i.nodeType===1;){var _=d;if(i.nodeName.toLowerCase()!==A.toLowerCase()){if(!p&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(p){if(!i[Ue])switch(A){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(C=i.getAttribute("rel"),C==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(C!==_.rel||i.getAttribute("href")!==(_.href==null||_.href===""?null:_.href)||i.getAttribute("crossorigin")!==(_.crossOrigin==null?null:_.crossOrigin)||i.getAttribute("title")!==(_.title==null?null:_.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(C=i.getAttribute("src"),(C!==(_.src==null?null:_.src)||i.getAttribute("type")!==(_.type==null?null:_.type)||i.getAttribute("crossorigin")!==(_.crossOrigin==null?null:_.crossOrigin))&&C&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(A==="input"&&i.type==="hidden"){var C=_.name==null?null:""+_.name;if(_.type==="hidden"&&i.getAttribute("name")===C)return i}else return i;if(i=Ro(i.nextSibling),i===null)break}return null}function a8(i,A,d){if(A==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!d||(i=Ro(i.nextSibling),i===null))return null;return i}function j5(i,A){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!A||(i=Ro(i.nextSibling),i===null))return null;return i}function S1(i){return i.data==="$?"||i.data==="$~"}function N1(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function s8(i,A){var d=i.ownerDocument;if(i.data==="$~")i._reactRetry=A;else if(i.data!=="$?"||d.readyState!=="loading")A();else{var p=function(){A(),d.removeEventListener("DOMContentLoaded",p)};d.addEventListener("DOMContentLoaded",p),i._reactRetry=p}}function Ro(i){for(;i!=null;i=i.nextSibling){var A=i.nodeType;if(A===1||A===3)break;if(A===8){if(A=i.data,A==="$"||A==="$!"||A==="$?"||A==="$~"||A==="&"||A==="F!"||A==="F")break;if(A==="/$"||A==="/&")return null}}return i}var E1=null;function U5(i){i=i.nextSibling;for(var A=0;i;){if(i.nodeType===8){var d=i.data;if(d==="/$"||d==="/&"){if(A===0)return Ro(i.nextSibling);A--}else d!=="$"&&d!=="$!"&&d!=="$?"&&d!=="$~"&&d!=="&"||A++}i=i.nextSibling}return null}function D5(i){i=i.previousSibling;for(var A=0;i;){if(i.nodeType===8){var d=i.data;if(d==="$"||d==="$!"||d==="$?"||d==="$~"||d==="&"){if(A===0)return i;A--}else d!=="/$"&&d!=="/&"||A++}i=i.previousSibling}return null}function I5(i,A,d){switch(A=Og(d),i){case"html":if(i=A.documentElement,!i)throw Error(a(452));return i;case"head":if(i=A.head,!i)throw Error(a(453));return i;case"body":if(i=A.body,!i)throw Error(a(454));return i;default:throw Error(a(451))}}function xh(i){for(var A=i.attributes;A.length;)i.removeAttributeNode(A[0]);tt(i)}var Mo=new Map,Q5=new Set;function Rg(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Wc=le.d;le.d={f:n8,r:i8,D:l8,C:o8,L:A8,m:c8,X:d8,S:u8,M:f8};function n8(){var i=Wc.f(),A=Fg();return i||A}function i8(i){var A=Ct(i);A!==null&&A.tag===5&&A.type==="form"?ey(A):Wc.r(i)}var Qd=typeof document>"u"?null:document;function O5(i,A,d){var p=Qd;if(p&&typeof A=="string"&&A){var _=ls(A);_='link[rel="'+i+'"][href="'+_+'"]',typeof d=="string"&&(_+='[crossorigin="'+d+'"]'),Q5.has(_)||(Q5.add(_),i={rel:i,crossOrigin:d,href:A},p.querySelector(_)===null&&(A=p.createElement("link"),ji(A,"link",i),zt(A),p.head.appendChild(A)))}}function l8(i){Wc.D(i),O5("dns-prefetch",i,null)}function o8(i,A){Wc.C(i,A),O5("preconnect",i,A)}function A8(i,A,d){Wc.L(i,A,d);var p=Qd;if(p&&i&&A){var _='link[rel="preload"][as="'+ls(A)+'"]';A==="image"&&d&&d.imageSrcSet?(_+='[imagesrcset="'+ls(d.imageSrcSet)+'"]',typeof d.imageSizes=="string"&&(_+='[imagesizes="'+ls(d.imageSizes)+'"]')):_+='[href="'+ls(i)+'"]';var C=_;switch(A){case"style":C=Od(i);break;case"script":C=Rd(i)}Mo.has(C)||(i=g({rel:"preload",href:A==="image"&&d&&d.imageSrcSet?void 0:i,as:A},d),Mo.set(C,i),p.querySelector(_)!==null||A==="style"&&p.querySelector(bh(C))||A==="script"&&p.querySelector(vh(C))||(A=p.createElement("link"),ji(A,"link",i),zt(A),p.head.appendChild(A)))}}function c8(i,A){Wc.m(i,A);var d=Qd;if(d&&i){var p=A&&typeof A.as=="string"?A.as:"script",_='link[rel="modulepreload"][as="'+ls(p)+'"][href="'+ls(i)+'"]',C=_;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":C=Rd(i)}if(!Mo.has(C)&&(i=g({rel:"modulepreload",href:i},A),Mo.set(C,i),d.querySelector(_)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(d.querySelector(vh(C)))return}p=d.createElement("link"),ji(p,"link",i),zt(p),d.head.appendChild(p)}}}function u8(i,A,d){Wc.S(i,A,d);var p=Qd;if(p&&i){var _=Ut(p).hoistableStyles,C=Od(i);A=A||"default";var W=_.get(C);if(!W){var ge={loading:0,preload:null};if(W=p.querySelector(bh(C)))ge.loading=5;else{i=g({rel:"stylesheet",href:i,"data-precedence":A},d),(d=Mo.get(C))&&F1(i,d);var De=W=p.createElement("link");zt(De),ji(De,"link",i),De._p=new Promise(function(Ze,ut){De.onload=Ze,De.onerror=ut}),De.addEventListener("load",function(){ge.loading|=1}),De.addEventListener("error",function(){ge.loading|=2}),ge.loading|=4,Mg(W,A,p)}W={type:"stylesheet",instance:W,count:1,state:ge},_.set(C,W)}}}function d8(i,A){Wc.X(i,A);var d=Qd;if(d&&i){var p=Ut(d).hoistableScripts,_=Rd(i),C=p.get(_);C||(C=d.querySelector(vh(_)),C||(i=g({src:i,async:!0},A),(A=Mo.get(_))&&T1(i,A),C=d.createElement("script"),zt(C),ji(C,"link",i),d.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},p.set(_,C))}}function f8(i,A){Wc.M(i,A);var d=Qd;if(d&&i){var p=Ut(d).hoistableScripts,_=Rd(i),C=p.get(_);C||(C=d.querySelector(vh(_)),C||(i=g({src:i,async:!0,type:"module"},A),(A=Mo.get(_))&&T1(i,A),C=d.createElement("script"),zt(C),ji(C,"link",i),d.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},p.set(_,C))}}function R5(i,A,d,p){var _=(_=J.current)?Rg(_):null;if(!_)throw Error(a(446));switch(i){case"meta":case"title":return null;case"style":return typeof d.precedence=="string"&&typeof d.href=="string"?(A=Od(d.href),d=Ut(_).hoistableStyles,p=d.get(A),p||(p={type:"style",instance:null,count:0,state:null},d.set(A,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(d.rel==="stylesheet"&&typeof d.href=="string"&&typeof d.precedence=="string"){i=Od(d.href);var C=Ut(_).hoistableStyles,W=C.get(i);if(W||(_=_.ownerDocument||_,W={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},C.set(i,W),(C=_.querySelector(bh(i)))&&!C._p&&(W.instance=C,W.state.loading=5),Mo.has(i)||(d={rel:"preload",as:"style",href:d.href,crossOrigin:d.crossOrigin,integrity:d.integrity,media:d.media,hrefLang:d.hrefLang,referrerPolicy:d.referrerPolicy},Mo.set(i,d),C||h8(_,i,d,W.state))),A&&p===null)throw Error(a(528,""));return W}if(A&&p!==null)throw Error(a(529,""));return null;case"script":return A=d.async,d=d.src,typeof d=="string"&&A&&typeof A!="function"&&typeof A!="symbol"?(A=Rd(d),d=Ut(_).hoistableScripts,p=d.get(A),p||(p={type:"script",instance:null,count:0,state:null},d.set(A,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,i))}}function Od(i){return'href="'+ls(i)+'"'}function bh(i){return'link[rel="stylesheet"]['+i+"]"}function M5(i){return g({},i,{"data-precedence":i.precedence,precedence:null})}function h8(i,A,d,p){i.querySelector('link[rel="preload"][as="style"]['+A+"]")?p.loading=1:(A=i.createElement("link"),p.preload=A,A.addEventListener("load",function(){return p.loading|=1}),A.addEventListener("error",function(){return p.loading|=2}),ji(A,"link",d),zt(A),i.head.appendChild(A))}function Rd(i){return'[src="'+ls(i)+'"]'}function vh(i){return"script[async]"+i}function H5(i,A,d){if(A.count++,A.instance===null)switch(A.type){case"style":var p=i.querySelector('style[data-href~="'+ls(d.href)+'"]');if(p)return A.instance=p,zt(p),p;var _=g({},d,{"data-href":d.href,"data-precedence":d.precedence,href:null,precedence:null});return p=(i.ownerDocument||i).createElement("style"),zt(p),ji(p,"style",_),Mg(p,d.precedence,i),A.instance=p;case"stylesheet":_=Od(d.href);var C=i.querySelector(bh(_));if(C)return A.state.loading|=4,A.instance=C,zt(C),C;p=M5(d),(_=Mo.get(_))&&F1(p,_),C=(i.ownerDocument||i).createElement("link"),zt(C);var W=C;return W._p=new Promise(function(ge,De){W.onload=ge,W.onerror=De}),ji(C,"link",p),A.state.loading|=4,Mg(C,d.precedence,i),A.instance=C;case"script":return C=Rd(d.src),(_=i.querySelector(vh(C)))?(A.instance=_,zt(_),_):(p=d,(_=Mo.get(C))&&(p=g({},d),T1(p,_)),i=i.ownerDocument||i,_=i.createElement("script"),zt(_),ji(_,"link",p),i.head.appendChild(_),A.instance=_);case"void":return null;default:throw Error(a(443,A.type))}else A.type==="stylesheet"&&(A.state.loading&4)===0&&(p=A.instance,A.state.loading|=4,Mg(p,d.precedence,i));return A.instance}function Mg(i,A,d){for(var p=d.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),_=p.length?p[p.length-1]:null,C=_,W=0;W<p.length;W++){var ge=p[W];if(ge.dataset.precedence===A)C=ge;else if(C!==_)break}C?C.parentNode.insertBefore(i,C.nextSibling):(A=d.nodeType===9?d.head:d,A.insertBefore(i,A.firstChild))}function F1(i,A){i.crossOrigin==null&&(i.crossOrigin=A.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=A.referrerPolicy),i.title==null&&(i.title=A.title)}function T1(i,A){i.crossOrigin==null&&(i.crossOrigin=A.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=A.referrerPolicy),i.integrity==null&&(i.integrity=A.integrity)}var Hg=null;function P5(i,A,d){if(Hg===null){var p=new Map,_=Hg=new Map;_.set(d,p)}else _=Hg,p=_.get(d),p||(p=new Map,_.set(d,p));if(p.has(i))return p;for(p.set(i,null),d=d.getElementsByTagName(i),_=0;_<d.length;_++){var C=d[_];if(!(C[Ue]||C[be]||i==="link"&&C.getAttribute("rel")==="stylesheet")&&C.namespaceURI!=="http://www.w3.org/2000/svg"){var W=C.getAttribute(A)||"";W=i+W;var ge=p.get(W);ge?ge.push(C):p.set(W,[C])}}return p}function q5(i,A,d){i=i.ownerDocument||i,i.head.insertBefore(d,A==="title"?i.querySelector("head > title"):null)}function p8(i,A,d){if(d===1||A.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof A.precedence!="string"||typeof A.href!="string"||A.href==="")break;return!0;case"link":if(typeof A.rel!="string"||typeof A.href!="string"||A.href===""||A.onLoad||A.onError)break;return A.rel==="stylesheet"?(i=A.disabled,typeof A.precedence=="string"&&i==null):!0;case"script":if(A.async&&typeof A.async!="function"&&typeof A.async!="symbol"&&!A.onLoad&&!A.onError&&A.src&&typeof A.src=="string")return!0}return!1}function K5(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function g8(i,A,d,p){if(d.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(d.state.loading&4)===0){if(d.instance===null){var _=Od(p.href),C=A.querySelector(bh(_));if(C){A=C._p,A!==null&&typeof A=="object"&&typeof A.then=="function"&&(i.count++,i=Pg.bind(i),A.then(i,i)),d.state.loading|=4,d.instance=C,zt(C);return}C=A.ownerDocument||A,p=M5(p),(_=Mo.get(_))&&F1(p,_),C=C.createElement("link"),zt(C);var W=C;W._p=new Promise(function(ge,De){W.onload=ge,W.onerror=De}),ji(C,"link",p),d.instance=C}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(d,A),(A=d.state.preload)&&(d.state.loading&3)===0&&(i.count++,d=Pg.bind(i),A.addEventListener("load",d),A.addEventListener("error",d))}}var L1=0;function m8(i,A){return i.stylesheets&&i.count===0&&Kg(i,i.stylesheets),0<i.count||0<i.imgCount?function(d){var p=setTimeout(function(){if(i.stylesheets&&Kg(i,i.stylesheets),i.unsuspend){var C=i.unsuspend;i.unsuspend=null,C()}},6e4+A);0<i.imgBytes&&L1===0&&(L1=62500*Y6());var _=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&Kg(i,i.stylesheets),i.unsuspend)){var C=i.unsuspend;i.unsuspend=null,C()}},(i.imgBytes>L1?50:800)+A);return i.unsuspend=d,function(){i.unsuspend=null,clearTimeout(p),clearTimeout(_)}}:null}function Pg(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Kg(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var qg=null;function Kg(i,A){i.stylesheets=null,i.unsuspend!==null&&(i.count++,qg=new Map,A.forEach(x8,i),qg=null,Pg.call(i))}function x8(i,A){if(!(A.state.loading&4)){var d=qg.get(i);if(d)var p=d.get(null);else{d=new Map,qg.set(i,d);for(var _=i.querySelectorAll("link[data-precedence],style[data-precedence]"),C=0;C<_.length;C++){var W=_[C];(W.nodeName==="LINK"||W.getAttribute("media")!=="not all")&&(d.set(W.dataset.precedence,W),p=W)}p&&d.set(null,p)}_=A.instance,W=_.getAttribute("data-precedence"),C=d.get(W)||p,C===p&&d.set(null,_),d.set(W,_),this.count++,p=Pg.bind(this),_.addEventListener("load",p),_.addEventListener("error",p),C?C.parentNode.insertBefore(_,C.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(_,i.firstChild)),A.state.loading|=4}}var wh={$$typeof:S,Provider:null,Consumer:null,_currentValue:pe,_currentValue2:pe,_threadCount:0};function b8(i,A,d,p,_,C,W,ge,De){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Tt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Tt(0),this.hiddenUpdates=Tt(null),this.identifierPrefix=p,this.onUncaughtError=_,this.onCaughtError=C,this.onRecoverableError=W,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=De,this.incompleteTransitions=new Map}function z5(i,A,d,p,_,C,W,ge,De,Ze,ut,xt){return i=new b8(i,A,d,W,De,Ze,ut,xt,ge),A=1,C===!0&&(A|=24),C=xr(3,null,null,A),i.current=C,C.stateNode=i,A=vu(),A.refCount++,i.pooledCache=A,A.refCount++,C.memoizedState={element:p,isDehydrated:d,cache:A},qt(C),i}function V5(i){return i?(i=gn,i):gn}function G5(i,A,d,p,_,C){_=V5(_),p.context===null?p.context=_:p.pendingContext=_,p=Dr(A),p.payload={element:d},C=C===void 0?null:C,C!==null&&(p.callback=C),d=ra(i,p,A),d!==null&&($l(d,i,A),Qa(d,i,A))}function W5(i,A){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var d=i.retryLane;i.retryLane=d!==0&&d<A?d:A}}function j1(i,A){W5(i,A),(i=i.alternate)&&W5(i,A)}function $5(i){if(i.tag===13||i.tag===31){var A=Ei(i,67108864);A!==null&&$l(A,i,67108864),j1(i,67108864)}}function X5(i){if(i.tag===13||i.tag===31){var A=go();A=fr(A);var d=Ei(i,A);d!==null&&$l(d,i,A),j1(i,A)}}var zg=!0;function v8(i,A,d,p){var _=ee.T;ee.T=null;var C=le.p;try{le.p=2,U1(i,A,d,p)}finally{le.p=C,ee.T=_}}function w8(i,A,d,p){var _=ee.T;ee.T=null;var C=le.p;try{le.p=8,U1(i,A,d,p)}finally{le.p=C,ee.T=_}}function U1(i,A,d,p){if(zg){var _=D1(p);if(_===null)v1(i,A,p,Vg,d),J5(i,p);else if(y8(_,i,A,d,p))p.stopPropagation();else if(J5(i,p),A&4&&-1<_8.indexOf(i)){for(;_!==null;){var C=Ct(_);if(C!==null)switch(C.tag){case 3:if(C=C.stateNode,C.current.memoizedState.isDehydrated){var W=Ft(C.pendingLanes);if(W!==0){var ge=C;for(ge.pendingLanes|=2,ge.entangledLanes|=2;W;){var De=1<<31-vr(W);ge.entanglements[1]|=De,W&=~De}ic(C),(Ra&6)===0&&(Ng=Ot()+500,ph(0))}}break;case 31:case 13:ge=Ei(C,2),ge!==null&&$l(ge,C,2),Fg(),j1(C,2)}if(C=D1(p),C===null&&v1(i,A,p,Vg,d),C===_)break;_=C}_!==null&&p.stopPropagation()}else v1(i,A,p,null,d)}}function D1(i){return i=No(i),I1(i)}var Vg=null;function I1(i){if(Vg=null,i=_t(i),i!==null){var A=n(i);if(A===null)i=null;else{var d=A.tag;if(d===13){if(i=o(A),i!==null)return i;i=null}else if(d===31){if(i=c(A),i!==null)return i;i=null}else if(d===3){if(A.stateNode.current.memoizedState.isDehydrated)return A.tag===3?A.stateNode.containerInfo:null;i=null}else A!==i&&(i=null)}}return Vg=i,null}function Y5(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(sr()){case er:return 2;case cr:return 8;case Vt:case mt:return 32;case Nt:return 268435456;default:return 32}default:return 32}}var Q1=!1,ju=null,Uu=null,Du=null,_h=new Map,yh=new Map,Iu=[],_8="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function J5(i,A){switch(i){case"focusin":case"focusout":ju=null;break;case"dragenter":case"dragleave":Uu=null;break;case"mouseover":case"mouseout":Du=null;break;case"pointerover":case"pointerout":_h.delete(A.pointerId);break;case"gotpointercapture":case"lostpointercapture":yh.delete(A.pointerId)}}function kh(i,A,d,p,_,C){return i===null||i.nativeEvent!==C?(i={blockedOn:A,domEventName:d,eventSystemFlags:p,nativeEvent:C,targetContainers:[_]},A!==null&&(A=Ct(A),A!==null&&$5(A)),i):(i.eventSystemFlags|=p,A=i.targetContainers,_!==null&&A.indexOf(_)===-1&&A.push(_),i)}function y8(i,A,d,p,_){switch(A){case"focusin":return ju=kh(ju,i,A,d,p,_),!0;case"dragenter":return Uu=kh(Uu,i,A,d,p,_),!0;case"mouseover":return Du=kh(Du,i,A,d,p,_),!0;case"pointerover":var C=_.pointerId;return _h.set(C,kh(_h.get(C)||null,i,A,d,p,_)),!0;case"gotpointercapture":return C=_.pointerId,yh.set(C,kh(yh.get(C)||null,i,A,d,p,_)),!0}return!1}function Z5(i){var A=_t(i.target);if(A!==null){var d=n(A);if(d!==null){if(A=d.tag,A===13){if(A=o(d),A!==null){i.blockedOn=A,ke(i.priority,function(){X5(d)});return}}else if(A===31){if(A=c(d),A!==null){i.blockedOn=A,ke(i.priority,function(){X5(d)});return}}else if(A===3&&d.stateNode.current.memoizedState.isDehydrated){i.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Gg(i){if(i.blockedOn!==null)return!1;for(var A=i.targetContainers;0<A.length;){var d=D1(i.nativeEvent);if(d===null){d=i.nativeEvent;var p=new d.constructor(d.type,d);Ys=p,d.target.dispatchEvent(p),Ys=null}else return A=Ct(d),A!==null&&$5(A),i.blockedOn=d,!1;A.shift()}return!0}function ek(i,A,d){Gg(i)&&d.delete(A)}function k8(){Q1=!1,ju!==null&&Gg(ju)&&(ju=null),Uu!==null&&Gg(Uu)&&(Uu=null),Du!==null&&Gg(Du)&&(Du=null),_h.forEach(ek),yh.forEach(ek)}function Wg(i,A){i.blockedOn===A&&(i.blockedOn=null,Q1||(Q1=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,k8)))}var $g=null;function tk(i){$g!==i&&($g=i,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){$g===i&&($g=null);for(var A=0;A<i.length;A+=3){var d=i[A],p=i[A+1],_=i[A+2];if(typeof p!="function"){if(I1(p||d)===null)continue;break}var C=Ct(d);C!==null&&(i.splice(A,3),A-=3,Db(C,{pending:!0,data:_,method:d.method,action:p},p,_))}}))}function Md(i){function A(De){return Wg(De,i)}ju!==null&&Wg(ju,i),Uu!==null&&Wg(Uu,i),Du!==null&&Wg(Du,i),_h.forEach(A),yh.forEach(A);for(var d=0;d<Iu.length;d++){var p=Iu[d];p.blockedOn===i&&(p.blockedOn=null)}for(;0<Iu.length&&(d=Iu[0],d.blockedOn===null);)Z5(d),d.blockedOn===null&&Iu.shift();if(d=(i.ownerDocument||i).$$reactFormReplay,d!=null)for(p=0;p<d.length;p+=3){var _=d[p],C=d[p+1],W=_[ye]||null;if(typeof C=="function")W||tk(d);else if(W){var ge=null;if(C&&C.hasAttribute("formAction")){if(_=C,W=C[ye]||null)ge=W.formAction;else if(I1(_)!==null)continue}else ge=W.action;typeof ge=="function"?d[p+1]=ge:(d.splice(p,3),p-=3),tk(d)}}}function rk(){function i(C){C.canIntercept&&C.info==="react-transition"&&C.intercept({handler:function(){return new Promise(function(W){return _=W})},focusReset:"manual",scroll:"manual"})}function A(){_!==null&&(_(),_=null),p||setTimeout(d,20)}function d(){if(!p&&!navigation.transition){var C=navigation.currentEntry;C&&C.url!=null&&navigation.navigate(C.url,{state:C.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var p=!1,_=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",A),navigation.addEventListener("navigateerror",A),setTimeout(d,100),function(){p=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",A),navigation.removeEventListener("navigateerror",A),_!==null&&(_(),_=null)}}}function O1(i){this._internalRoot=i}Xg.prototype.render=O1.prototype.render=function(i){var A=this._internalRoot;if(A===null)throw Error(a(409));var d=A.current,p=go();G5(d,p,i,A,null,null)},Xg.prototype.unmount=O1.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var A=i.containerInfo;G5(i.current,2,null,i,null,null),Fg(),A[O]=null}};function Xg(i){this._internalRoot=i}Xg.prototype.unstable_scheduleHydration=function(i){if(i){var A=re();i={blockedOn:null,target:i,priority:A};for(var d=0;d<Iu.length&&A!==0&&A<Iu[d].priority;d++);Iu.splice(d,0,i),d===0&&Z5(i)}};var ak=t.version;if(ak!=="19.2.4")throw Error(a(527,ak,"19.2.4"));le.findDOMNode=function(i){var A=i._reactInternals;if(A===void 0)throw typeof i.render=="function"?Error(a(188)):(i=Object.keys(i).join(","),Error(a(268,i)));return i=f(A),i=i!==null?h(i):null,i=i===null?null:i.stateNode,i};var B8={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:ee,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Yg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Yg.isDisabled&&Yg.supportsFiber)try{Ht=Yg.inject(B8),Rt=Yg}catch{}}return Sh.createRoot=function(i,A){if(!s(i))throw Error(a(299));var d=!1,p="",_=cy,C=uy,W=dy;return A!=null&&(A.unstable_strictMode===!0&&(d=!0),A.identifierPrefix!==void 0&&(p=A.identifierPrefix),A.onUncaughtError!==void 0&&(_=A.onUncaughtError),A.onCaughtError!==void 0&&(C=A.onCaughtError),A.onRecoverableError!==void 0&&(W=A.onRecoverableError)),A=z5(i,1,!1,null,null,d,p,null,_,C,W,rk),i[O]=A.current,b1(i),new O1(A)},Sh.hydrateRoot=function(i,A,d){if(!s(i))throw Error(a(299));var p=!1,_="",C=cy,W=uy,ge=dy,De=null;return d!=null&&(d.unstable_strictMode===!0&&(p=!0),d.identifierPrefix!==void 0&&(_=d.identifierPrefix),d.onUncaughtError!==void 0&&(C=d.onUncaughtError),d.onCaughtError!==void 0&&(W=d.onCaughtError),d.onRecoverableError!==void 0&&(ge=d.onRecoverableError),d.formState!==void 0&&(De=d.formState)),A=z5(i,1,!0,A,d??null,p,_,De,C,W,ge,rk),A.context=V5(null),d=A.current,p=go(),p=fr(p),_=Dr(p),_.callback=null,ra(d,_,p),d=p,A.current.lanes=d,Bt(A,d),ic(A),i[O]=A.current,b1(i),new Xg(A)},Sh.version="19.2.4",Sh}var vk;function mL(){if(vk)return q1.exports;vk=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),q1.exports=gL(),q1.exports}var xL=mL();const Yr=e=>typeof e=="string",Nh=()=>{let e,t;const r=new Promise((a,s)=>{e=a,t=s});return r.resolve=e,r.reject=t,r},wk=e=>e==null?"":""+e,bL=(e,t,r)=>{e.forEach(a=>{t[a]&&(r[a]=t[a])})},vL=/###/g,_k=e=>e&&e.indexOf("###")>-1?e.replace(vL,"."):e,yk=e=>!e||Yr(e),Zh=(e,t,r)=>{const a=Yr(t)?t.split("."):t;let s=0;for(;s<a.length-1;){if(yk(e))return{};const n=_k(a[s]);!e[n]&&r&&(e[n]=new r),Object.prototype.hasOwnProperty.call(e,n)?e=e[n]:e={},++s}return yk(e)?{}:{obj:e,k:_k(a[s])}},kk=(e,t,r)=>{const{obj:a,k:s}=Zh(e,t,Object);if(a!==void 0||t.length===1){a[s]=r;return}let n=t[t.length-1],o=t.slice(0,t.length-1),c=Zh(e,o,Object);for(;c.obj===void 0&&o.length;)n=`${o[o.length-1]}.${n}`,o=o.slice(0,o.length-1),c=Zh(e,o,Object),c?.obj&&typeof c.obj[`${c.k}.${n}`]<"u"&&(c.obj=void 0);c.obj[`${c.k}.${n}`]=r},wL=(e,t,r,a)=>{const{obj:s,k:n}=Zh(e,t,Object);s[n]=s[n]||[],s[n].push(r)},cx=(e,t)=>{const{obj:r,k:a}=Zh(e,t);if(r&&Object.prototype.hasOwnProperty.call(r,a))return r[a]},_L=(e,t,r)=>{const a=cx(e,r);return a!==void 0?a:cx(t,r)},d3=(e,t,r)=>{for(const a in t)a!=="__proto__"&&a!=="constructor"&&(a in e?Yr(e[a])||e[a]instanceof String||Yr(t[a])||t[a]instanceof String?r&&(e[a]=t[a]):d3(e[a],t[a],r):e[a]=t[a]);return e},E0=e=>e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var yL={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const kL=e=>Yr(e)?e.replace(/[&<>"'\/]/g,t=>yL[t]):e;class BL{constructor(t){this.capacity=t,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(t){const r=this.regExpMap.get(t);if(r!==void 0)return r;const a=new RegExp(t);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(t,a),this.regExpQueue.push(t),a}}const CL=[" ",",","?","!",";"],SL=new BL(20),NL=(e,t,r)=>{t=t||"",r=r||"";const a=CL.filter(o=>t.indexOf(o)<0&&r.indexOf(o)<0);if(a.length===0)return!0;const s=SL.getRegExp(`(${a.map(o=>o==="?"?"\\?":o).join("|")})`);let n=!s.test(e);if(!n){const o=e.indexOf(r);o>0&&!s.test(e.substring(0,o))&&(n=!0)}return n},dw=(e,t,r=".")=>{if(!e)return;if(e[t])return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0;const a=t.split(r);let s=e;for(let n=0;n<a.length;){if(!s||typeof s!="object")return;let o,c="";for(let u=n;u<a.length;++u)if(u!==n&&(c+=r),c+=a[u],o=s[c],o!==void 0){if(["string","number","boolean"].indexOf(typeof o)>-1&&u<a.length-1)continue;n+=u-n+1;break}s=o}return s},kp=e=>e?.replace("_","-"),EL={type:"logger",log(e){this.output("log",e)},warn(e){this.output("warn",e)},error(e){this.output("error",e)},output(e,t){console?.[e]?.apply?.(console,t)}};let FL=class fw{constructor(t,r={}){this.init(t,r)}init(t,r={}){this.prefix=r.prefix||"i18next:",this.logger=t||EL,this.options=r,this.debug=r.debug}log(...t){return this.forward(t,"log","",!0)}warn(...t){return this.forward(t,"warn","",!0)}error(...t){return this.forward(t,"error","")}deprecate(...t){return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}forward(t,r,a,s){return s&&!this.debug?null:(Yr(t[0])&&(t[0]=`${a}${this.prefix} ${t[0]}`),this.logger[r](t))}create(t){return new fw(this.logger,{prefix:`${this.prefix}:${t}:`,...this.options})}clone(t){return t=t||this.options,t.prefix=t.prefix||this.prefix,new fw(this.logger,t)}};var _c=new FL;class Zx{constructor(){this.observers={}}on(t,r){return t.split(" ").forEach(a=>{this.observers[a]||(this.observers[a]=new Map);const s=this.observers[a].get(r)||0;this.observers[a].set(r,s+1)}),this}off(t,r){if(this.observers[t]){if(!r){delete this.observers[t];return}this.observers[t].delete(r)}}emit(t,...r){this.observers[t]&&Array.from(this.observers[t].entries()).forEach(([s,n])=>{for(let o=0;o<n;o++)s(...r)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([s,n])=>{for(let o=0;o<n;o++)s.apply(s,[t,...r])})}}class Bk extends Zx{constructor(t,r={ns:["translation"],defaultNS:"translation"}){super(),this.data=t||{},this.options=r,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}removeNamespaces(t){const r=this.options.ns.indexOf(t);r>-1&&this.options.ns.splice(r,1)}getResource(t,r,a,s={}){const n=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator,o=s.ignoreJSONStructure!==void 0?s.ignoreJSONStructure:this.options.ignoreJSONStructure;let c;t.indexOf(".")>-1?c=t.split("."):(c=[t,r],a&&(Array.isArray(a)?c.push(...a):Yr(a)&&n?c.push(...a.split(n)):c.push(a)));const u=cx(this.data,c);return!u&&!r&&!a&&t.indexOf(".")>-1&&(t=c[0],r=c[1],a=c.slice(2).join(".")),u||!o||!Yr(a)?u:dw(this.data?.[t]?.[r],a,n)}addResource(t,r,a,s,n={silent:!1}){const o=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator;let c=[t,r];a&&(c=c.concat(o?a.split(o):a)),t.indexOf(".")>-1&&(c=t.split("."),s=r,r=c[1]),this.addNamespaces(r),kk(this.data,c,s),n.silent||this.emit("added",t,r,a,s)}addResources(t,r,a,s={silent:!1}){for(const n in a)(Yr(a[n])||Array.isArray(a[n]))&&this.addResource(t,r,n,a[n],{silent:!0});s.silent||this.emit("added",t,r,a)}addResourceBundle(t,r,a,s,n,o={silent:!1,skipCopy:!1}){let c=[t,r];t.indexOf(".")>-1&&(c=t.split("."),s=a,a=r,r=c[1]),this.addNamespaces(r);let u=cx(this.data,c)||{};o.skipCopy||(a=JSON.parse(JSON.stringify(a))),s?d3(u,a,n):u={...u,...a},kk(this.data,c,u),o.silent||this.emit("added",t,r,a)}removeResourceBundle(t,r){this.hasResourceBundle(t,r)&&delete this.data[t][r],this.removeNamespaces(r),this.emit("removed",t,r)}hasResourceBundle(t,r){return this.getResource(t,r)!==void 0}getResourceBundle(t,r){return r||(r=this.options.defaultNS),this.getResource(t,r)}getDataByLanguage(t){return this.data[t]}hasLanguageSomeTranslations(t){const r=this.getDataByLanguage(t);return!!(r&&Object.keys(r)||[]).find(s=>r[s]&&Object.keys(r[s]).length>0)}toJSON(){return this.data}}var f3={processors:{},addPostProcessor(e){this.processors[e.name]=e},handle(e,t,r,a,s){return e.forEach(n=>{t=this.processors[n]?.process(t,r,a,s)??t}),t}};const h3=Symbol("i18next/PATH_KEY");function TL(){const e=[],t=Object.create(null);let r;return t.get=(a,s)=>(r?.revoke?.(),s===h3?e:(e.push(s),r=Proxy.revocable(a,t),r.proxy)),Proxy.revocable(Object.create(null),t).proxy}function hw(e,t){const{[h3]:r}=e(TL());return r.join(t?.keySeparator??".")}const Ck={},V1=e=>!Yr(e)&&typeof e!="boolean"&&typeof e!="number";class ux extends Zx{constructor(t,r={}){super(),bL(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],t,this),this.options=r,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=_c.create("translator")}changeLanguage(t){t&&(this.language=t)}exists(t,r={interpolation:{}}){const a={...r};if(t==null)return!1;const s=this.resolve(t,a);if(s?.res===void 0)return!1;const n=V1(s.res);return!(a.returnObjects===!1&&n)}extractFromKey(t,r){let a=r.nsSeparator!==void 0?r.nsSeparator:this.options.nsSeparator;a===void 0&&(a=":");const s=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator;let n=r.ns||this.options.defaultNS||[];const o=a&&t.indexOf(a)>-1,c=!this.options.userDefinedKeySeparator&&!r.keySeparator&&!this.options.userDefinedNsSeparator&&!r.nsSeparator&&!NL(t,a,s);if(o&&!c){const u=t.match(this.interpolator.nestingRegexp);if(u&&u.length>0)return{key:t,namespaces:Yr(n)?[n]:n};const f=t.split(a);(a!==s||a===s&&this.options.ns.indexOf(f[0])>-1)&&(n=f.shift()),t=f.join(s)}return{key:t,namespaces:Yr(n)?[n]:n}}translate(t,r,a){let s=typeof r=="object"?{...r}:r;if(typeof s!="object"&&this.options.overloadTranslationOptionHandler&&(s=this.options.overloadTranslationOptionHandler(arguments)),typeof s=="object"&&(s={...s}),s||(s={}),t==null)return"";typeof t=="function"&&(t=hw(t,{...this.options,...s})),Array.isArray(t)||(t=[String(t)]);const n=s.returnDetails!==void 0?s.returnDetails:this.options.returnDetails,o=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator,{key:c,namespaces:u}=this.extractFromKey(t[t.length-1],s),f=u[u.length-1];let h=s.nsSeparator!==void 0?s.nsSeparator:this.options.nsSeparator;h===void 0&&(h=":");const g=s.lng||this.language,x=s.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(g?.toLowerCase()==="cimode")return x?n?{res:`${f}${h}${c}`,usedKey:c,exactUsedKey:c,usedLng:g,usedNS:f,usedParams:this.getUsedParamsDetails(s)}:`${f}${h}${c}`:n?{res:c,usedKey:c,exactUsedKey:c,usedLng:g,usedNS:f,usedParams:this.getUsedParamsDetails(s)}:c;const m=this.resolve(t,s);let w=m?.res;const v=m?.usedKey||c,B=m?.exactUsedKey||c,k=["[object Number]","[object Function]","[object RegExp]"],E=s.joinArrays!==void 0?s.joinArrays:this.options.joinArrays,S=!this.i18nFormat||this.i18nFormat.handleAsObject,L=s.count!==void 0&&!Yr(s.count),P=ux.hasDefaultValue(s),R=L?this.pluralResolver.getSuffix(g,s.count,s):"",Q=s.ordinal&&L?this.pluralResolver.getSuffix(g,s.count,{ordinal:!1}):"",V=L&&!s.ordinal&&s.count===0,U=V&&s[`defaultValue${this.options.pluralSeparator}zero`]||s[`defaultValue${R}`]||s[`defaultValue${Q}`]||s.defaultValue;let M=w;S&&!w&&P&&(M=U);const T=V1(M),D=Object.prototype.toString.apply(M);if(S&&M&&T&&k.indexOf(D)<0&&!(Yr(E)&&Array.isArray(M))){if(!s.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const G=this.options.returnedObjectHandler?this.options.returnedObjectHandler(v,M,{...s,ns:u}):`key '${c} (${this.language})' returned an object instead of string.`;return n?(m.res=G,m.usedParams=this.getUsedParamsDetails(s),m):G}if(o){const G=Array.isArray(M),ne=G?[]:{},H=G?B:v;for(const ee in M)if(Object.prototype.hasOwnProperty.call(M,ee)){const le=`${H}${o}${ee}`;P&&!w?ne[ee]=this.translate(le,{...s,defaultValue:V1(U)?U[ee]:void 0,joinArrays:!1,ns:u}):ne[ee]=this.translate(le,{...s,joinArrays:!1,ns:u}),ne[ee]===le&&(ne[ee]=M[ee])}w=ne}}else if(S&&Yr(E)&&Array.isArray(w))w=w.join(E),w&&(w=this.extendTranslation(w,t,s,a));else{let G=!1,ne=!1;!this.isValidLookup(w)&&P&&(G=!0,w=U),this.isValidLookup(w)||(ne=!0,w=c);const ee=(s.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&ne?void 0:w,le=P&&U!==w&&this.options.updateMissing;if(ne||G||le){if(this.logger.log(le?"updateKey":"missingKey",g,f,c,le?U:w),o){const je=this.resolve(c,{...s,keySeparator:!1});je&&je.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let pe=[];const te=this.languageUtils.getFallbackCodes(this.options.fallbackLng,s.lng||this.language);if(this.options.saveMissingTo==="fallback"&&te&&te[0])for(let je=0;je<te.length;je++)pe.push(te[je]);else this.options.saveMissingTo==="all"?pe=this.languageUtils.toResolveHierarchy(s.lng||this.language):pe.push(s.lng||this.language);const Le=(je,F,K)=>{const I=P&&K!==w?K:ee;this.options.missingKeyHandler?this.options.missingKeyHandler(je,f,F,I,le,s):this.backendConnector?.saveMissing&&this.backendConnector.saveMissing(je,f,F,I,le,s),this.emit("missingKey",je,f,F,w)};this.options.saveMissing&&(this.options.saveMissingPlurals&&L?pe.forEach(je=>{const F=this.pluralResolver.getSuffixes(je,s);V&&s[`defaultValue${this.options.pluralSeparator}zero`]&&F.indexOf(`${this.options.pluralSeparator}zero`)<0&&F.push(`${this.options.pluralSeparator}zero`),F.forEach(K=>{Le([je],c+K,s[`defaultValue${K}`]||U)})}):Le(pe,c,U))}w=this.extendTranslation(w,t,s,m,a),ne&&w===c&&this.options.appendNamespaceToMissingKey&&(w=`${f}${h}${c}`),(ne||G)&&this.options.parseMissingKeyHandler&&(w=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${f}${h}${c}`:c,G?w:void 0,s))}return n?(m.res=w,m.usedParams=this.getUsedParamsDetails(s),m):w}extendTranslation(t,r,a,s,n){if(this.i18nFormat?.parse)t=this.i18nFormat.parse(t,{...this.options.interpolation.defaultVariables,...a},a.lng||this.language||s.usedLng,s.usedNS,s.usedKey,{resolved:s});else if(!a.skipInterpolation){a.interpolation&&this.interpolator.init({...a,interpolation:{...this.options.interpolation,...a.interpolation}});const u=Yr(t)&&(a?.interpolation?.skipOnVariables!==void 0?a.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let f;if(u){const g=t.match(this.interpolator.nestingRegexp);f=g&&g.length}let h=a.replace&&!Yr(a.replace)?a.replace:a;if(this.options.interpolation.defaultVariables&&(h={...this.options.interpolation.defaultVariables,...h}),t=this.interpolator.interpolate(t,h,a.lng||this.language||s.usedLng,a),u){const g=t.match(this.interpolator.nestingRegexp),x=g&&g.length;f<x&&(a.nest=!1)}!a.lng&&s&&s.res&&(a.lng=this.language||s.usedLng),a.nest!==!1&&(t=this.interpolator.nest(t,(...g)=>n?.[0]===g[0]&&!a.context?(this.logger.warn(`It seems you are nesting recursively key: ${g[0]} in key: ${r[0]}`),null):this.translate(...g,r),a)),a.interpolation&&this.interpolator.reset()}const o=a.postProcess||this.options.postProcess,c=Yr(o)?[o]:o;return t!=null&&c?.length&&a.applyPostProcessor!==!1&&(t=f3.handle(c,t,r,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...s,usedParams:this.getUsedParamsDetails(a)},...a}:a,this)),t}resolve(t,r={}){let a,s,n,o,c;return Yr(t)&&(t=[t]),t.forEach(u=>{if(this.isValidLookup(a))return;const f=this.extractFromKey(u,r),h=f.key;s=h;let g=f.namespaces;this.options.fallbackNS&&(g=g.concat(this.options.fallbackNS));const x=r.count!==void 0&&!Yr(r.count),m=x&&!r.ordinal&&r.count===0,w=r.context!==void 0&&(Yr(r.context)||typeof r.context=="number")&&r.context!=="",v=r.lngs?r.lngs:this.languageUtils.toResolveHierarchy(r.lng||this.language,r.fallbackLng);g.forEach(B=>{this.isValidLookup(a)||(c=B,!Ck[`${v[0]}-${B}`]&&this.utils?.hasLoadedNamespace&&!this.utils?.hasLoadedNamespace(c)&&(Ck[`${v[0]}-${B}`]=!0,this.logger.warn(`key "${s}" for languages "${v.join(", ")}" won't get resolved as namespace "${c}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),v.forEach(k=>{if(this.isValidLookup(a))return;o=k;const E=[h];if(this.i18nFormat?.addLookupKeys)this.i18nFormat.addLookupKeys(E,h,k,B,r);else{let L;x&&(L=this.pluralResolver.getSuffix(k,r.count,r));const P=`${this.options.pluralSeparator}zero`,R=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(x&&(r.ordinal&&L.indexOf(R)===0&&E.push(h+L.replace(R,this.options.pluralSeparator)),E.push(h+L),m&&E.push(h+P)),w){const Q=`${h}${this.options.contextSeparator||"_"}${r.context}`;E.push(Q),x&&(r.ordinal&&L.indexOf(R)===0&&E.push(Q+L.replace(R,this.options.pluralSeparator)),E.push(Q+L),m&&E.push(Q+P))}}let S;for(;S=E.pop();)this.isValidLookup(a)||(n=S,a=this.getResource(k,B,S,r))}))})}),{res:a,usedKey:s,exactUsedKey:n,usedLng:o,usedNS:c}}isValidLookup(t){return t!==void 0&&!(!this.options.returnNull&&t===null)&&!(!this.options.returnEmptyString&&t==="")}getResource(t,r,a,s={}){return this.i18nFormat?.getResource?this.i18nFormat.getResource(t,r,a,s):this.resourceStore.getResource(t,r,a,s)}getUsedParamsDetails(t={}){const r=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],a=t.replace&&!Yr(t.replace);let s=a?t.replace:t;if(a&&typeof t.count<"u"&&(s.count=t.count),this.options.interpolation.defaultVariables&&(s={...this.options.interpolation.defaultVariables,...s}),!a){s={...s};for(const n of r)delete s[n]}return s}static hasDefaultValue(t){const r="defaultValue";for(const a in t)if(Object.prototype.hasOwnProperty.call(t,a)&&r===a.substring(0,r.length)&&t[a]!==void 0)return!0;return!1}}class Sk{constructor(t){this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=_c.create("languageUtils")}getScriptPartFromCode(t){if(t=kp(t),!t||t.indexOf("-")<0)return null;const r=t.split("-");return r.length===2||(r.pop(),r[r.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(r.join("-"))}getLanguagePartFromCode(t){if(t=kp(t),!t||t.indexOf("-")<0)return t;const r=t.split("-");return this.formatLanguageCode(r[0])}formatLanguageCode(t){if(Yr(t)&&t.indexOf("-")>-1){let r;try{r=Intl.getCanonicalLocales(t)[0]}catch{}return r&&this.options.lowerCaseLng&&(r=r.toLowerCase()),r||(this.options.lowerCaseLng?t.toLowerCase():t)}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}isSupportedCode(t){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}getBestMatchFromCodes(t){if(!t)return null;let r;return t.forEach(a=>{if(r)return;const s=this.formatLanguageCode(a);(!this.options.supportedLngs||this.isSupportedCode(s))&&(r=s)}),!r&&this.options.supportedLngs&&t.forEach(a=>{if(r)return;const s=this.getScriptPartFromCode(a);if(this.isSupportedCode(s))return r=s;const n=this.getLanguagePartFromCode(a);if(this.isSupportedCode(n))return r=n;r=this.options.supportedLngs.find(o=>{if(o===n)return o;if(!(o.indexOf("-")<0&&n.indexOf("-")<0)&&(o.indexOf("-")>0&&n.indexOf("-")<0&&o.substring(0,o.indexOf("-"))===n||o.indexOf(n)===0&&n.length>1))return o})}),r||(r=this.getFallbackCodes(this.options.fallbackLng)[0]),r}getFallbackCodes(t,r){if(!t)return[];if(typeof t=="function"&&(t=t(r)),Yr(t)&&(t=[t]),Array.isArray(t))return t;if(!r)return t.default||[];let a=t[r];return a||(a=t[this.getScriptPartFromCode(r)]),a||(a=t[this.formatLanguageCode(r)]),a||(a=t[this.getLanguagePartFromCode(r)]),a||(a=t.default),a||[]}toResolveHierarchy(t,r){const a=this.getFallbackCodes((r===!1?[]:r)||this.options.fallbackLng||[],t),s=[],n=o=>{o&&(this.isSupportedCode(o)?s.push(o):this.logger.warn(`rejecting language code not found in supportedLngs: ${o}`))};return Yr(t)&&(t.indexOf("-")>-1||t.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&n(this.formatLanguageCode(t)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&n(this.getScriptPartFromCode(t)),this.options.load!=="currentOnly"&&n(this.getLanguagePartFromCode(t))):Yr(t)&&n(this.formatLanguageCode(t)),a.forEach(o=>{s.indexOf(o)<0&&n(this.formatLanguageCode(o))}),s}}const Nk={zero:0,one:1,two:2,few:3,many:4,other:5},Ek={select:e=>e===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class LL{constructor(t,r={}){this.languageUtils=t,this.options=r,this.logger=_c.create("pluralResolver"),this.pluralRulesCache={}}clearCache(){this.pluralRulesCache={}}getRule(t,r={}){const a=kp(t==="dev"?"en":t),s=r.ordinal?"ordinal":"cardinal",n=JSON.stringify({cleanedCode:a,type:s});if(n in this.pluralRulesCache)return this.pluralRulesCache[n];let o;try{o=new Intl.PluralRules(a,{type:s})}catch{if(typeof Intl>"u")return this.logger.error("No Intl support, please use an Intl polyfill!"),Ek;if(!t.match(/-|_/))return Ek;const u=this.languageUtils.getLanguagePartFromCode(t);o=this.getRule(u,r)}return this.pluralRulesCache[n]=o,o}needsPlural(t,r={}){let a=this.getRule(t,r);return a||(a=this.getRule("dev",r)),a?.resolvedOptions().pluralCategories.length>1}getPluralFormsOfKey(t,r,a={}){return this.getSuffixes(t,a).map(s=>`${r}${s}`)}getSuffixes(t,r={}){let a=this.getRule(t,r);return a||(a=this.getRule("dev",r)),a?a.resolvedOptions().pluralCategories.sort((s,n)=>Nk[s]-Nk[n]).map(s=>`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${s}`):[]}getSuffix(t,r,a={}){const s=this.getRule(t,a);return s?`${this.options.prepend}${a.ordinal?`ordinal${this.options.prepend}`:""}${s.select(r)}`:(this.logger.warn(`no plural rule found for: ${t}`),this.getSuffix("dev",r,a))}}const Fk=(e,t,r,a=".",s=!0)=>{let n=_L(e,t,r);return!n&&s&&Yr(r)&&(n=dw(e,r,a),n===void 0&&(n=dw(t,r,a))),n},G1=e=>e.replace(/\$/g,"$$$$");class Tk{constructor(t={}){this.logger=_c.create("interpolator"),this.options=t,this.format=t?.interpolation?.format||(r=>r),this.init(t)}init(t={}){t.interpolation||(t.interpolation={escapeValue:!0});const{escape:r,escapeValue:a,useRawValueToEscape:s,prefix:n,prefixEscaped:o,suffix:c,suffixEscaped:u,formatSeparator:f,unescapeSuffix:h,unescapePrefix:g,nestingPrefix:x,nestingPrefixEscaped:m,nestingSuffix:w,nestingSuffixEscaped:v,nestingOptionsSeparator:B,maxReplaces:k,alwaysFormat:E}=t.interpolation;this.escape=r!==void 0?r:kL,this.escapeValue=a!==void 0?a:!0,this.useRawValueToEscape=s!==void 0?s:!1,this.prefix=n?E0(n):o||"{{",this.suffix=c?E0(c):u||"}}",this.formatSeparator=f||",",this.unescapePrefix=h?"":g||"-",this.unescapeSuffix=this.unescapePrefix?"":h||"",this.nestingPrefix=x?E0(x):m||E0("$t("),this.nestingSuffix=w?E0(w):v||E0(")"),this.nestingOptionsSeparator=B||",",this.maxReplaces=k||1e3,this.alwaysFormat=E!==void 0?E:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const t=(r,a)=>r?.source===a?(r.lastIndex=0,r):new RegExp(a,"g");this.regexp=t(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=t(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=t(this.nestingRegexp,`${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`)}interpolate(t,r,a,s){let n,o,c;const u=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},f=m=>{if(m.indexOf(this.formatSeparator)<0){const k=Fk(r,u,m,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(k,void 0,a,{...s,...r,interpolationkey:m}):k}const w=m.split(this.formatSeparator),v=w.shift().trim(),B=w.join(this.formatSeparator).trim();return this.format(Fk(r,u,v,this.options.keySeparator,this.options.ignoreJSONStructure),B,a,{...s,...r,interpolationkey:v})};this.resetRegExp();const h=s?.missingInterpolationHandler||this.options.missingInterpolationHandler,g=s?.interpolation?.skipOnVariables!==void 0?s.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:m=>G1(m)},{regex:this.regexp,safeValue:m=>this.escapeValue?G1(this.escape(m)):G1(m)}].forEach(m=>{for(c=0;n=m.regex.exec(t);){const w=n[1].trim();if(o=f(w),o===void 0)if(typeof h=="function"){const B=h(t,n,s);o=Yr(B)?B:""}else if(s&&Object.prototype.hasOwnProperty.call(s,w))o="";else if(g){o=n[0];continue}else this.logger.warn(`missed to pass in variable ${w} for interpolating ${t}`),o="";else!Yr(o)&&!this.useRawValueToEscape&&(o=wk(o));const v=m.safeValue(o);if(t=t.replace(n[0],v),g?(m.regex.lastIndex+=o.length,m.regex.lastIndex-=n[0].length):m.regex.lastIndex=0,c++,c>=this.maxReplaces)break}}),t}nest(t,r,a={}){let s,n,o;const c=(u,f)=>{const h=this.nestingOptionsSeparator;if(u.indexOf(h)<0)return u;const g=u.split(new RegExp(`${E0(h)}[ ]*{`));let x=`{${g[1]}`;u=g[0],x=this.interpolate(x,o);const m=x.match(/'/g),w=x.match(/"/g);((m?.length??0)%2===0&&!w||(w?.length??0)%2!==0)&&(x=x.replace(/'/g,'"'));try{o=JSON.parse(x),f&&(o={...f,...o})}catch(v){return this.logger.warn(`failed parsing options string in nesting for key ${u}`,v),`${u}${h}${x}`}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,u};for(;s=this.nestingRegexp.exec(t);){let u=[];o={...a},o=o.replace&&!Yr(o.replace)?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;const f=/{.*}/.test(s[1])?s[1].lastIndexOf("}")+1:s[1].indexOf(this.formatSeparator);if(f!==-1&&(u=s[1].slice(f).split(this.formatSeparator).map(h=>h.trim()).filter(Boolean),s[1]=s[1].slice(0,f)),n=r(c.call(this,s[1].trim(),o),o),n&&s[0]===t&&!Yr(n))return n;Yr(n)||(n=wk(n)),n||(this.logger.warn(`missed to resolve ${s[1]} for nesting ${t}`),n=""),u.length&&(n=u.reduce((h,g)=>this.format(h,g,a.lng,{...a,interpolationkey:s[1].trim()}),n.trim())),t=t.replace(s[0],n),this.regexp.lastIndex=0}return t}}const jL=e=>{let t=e.toLowerCase().trim();const r={};if(e.indexOf("(")>-1){const a=e.split("(");t=a[0].toLowerCase().trim();const s=a[1].substring(0,a[1].length-1);t==="currency"&&s.indexOf(":")<0?r.currency||(r.currency=s.trim()):t==="relativetime"&&s.indexOf(":")<0?r.range||(r.range=s.trim()):s.split(";").forEach(o=>{if(o){const[c,...u]=o.split(":"),f=u.join(":").trim().replace(/^'+|'+$/g,""),h=c.trim();r[h]||(r[h]=f),f==="false"&&(r[h]=!1),f==="true"&&(r[h]=!0),isNaN(f)||(r[h]=parseInt(f,10))}})}return{formatName:t,formatOptions:r}},Lk=e=>{const t={};return(r,a,s)=>{let n=s;s&&s.interpolationkey&&s.formatParams&&s.formatParams[s.interpolationkey]&&s[s.interpolationkey]&&(n={...n,[s.interpolationkey]:void 0});const o=a+JSON.stringify(n);let c=t[o];return c||(c=e(kp(a),s),t[o]=c),c(r)}},UL=e=>(t,r,a)=>e(kp(r),a)(t);class DL{constructor(t={}){this.logger=_c.create("formatter"),this.options=t,this.init(t)}init(t,r={interpolation:{}}){this.formatSeparator=r.interpolation.formatSeparator||",";const a=r.cacheInBuiltFormats?Lk:UL;this.formats={number:a((s,n)=>{const o=new Intl.NumberFormat(s,{...n});return c=>o.format(c)}),currency:a((s,n)=>{const o=new Intl.NumberFormat(s,{...n,style:"currency"});return c=>o.format(c)}),datetime:a((s,n)=>{const o=new Intl.DateTimeFormat(s,{...n});return c=>o.format(c)}),relativetime:a((s,n)=>{const o=new Intl.RelativeTimeFormat(s,{...n});return c=>o.format(c,n.range||"day")}),list:a((s,n)=>{const o=new Intl.ListFormat(s,{...n});return c=>o.format(c)})}}add(t,r){this.formats[t.toLowerCase().trim()]=r}addCached(t,r){this.formats[t.toLowerCase().trim()]=Lk(r)}format(t,r,a,s={}){const n=r.split(this.formatSeparator);if(n.length>1&&n[0].indexOf("(")>1&&n[0].indexOf(")")<0&&n.find(c=>c.indexOf(")")>-1)){const c=n.findIndex(u=>u.indexOf(")")>-1);n[0]=[n[0],...n.splice(1,c)].join(this.formatSeparator)}return n.reduce((c,u)=>{const{formatName:f,formatOptions:h}=jL(u);if(this.formats[f]){let g=c;try{const x=s?.formatParams?.[s.interpolationkey]||{},m=x.locale||x.lng||s.locale||s.lng||a;g=this.formats[f](c,m,{...h,...s,...x})}catch(x){this.logger.warn(x)}return g}else this.logger.warn(`there was no format function for ${f}`);return c},t)}}const IL=(e,t)=>{e.pending[t]!==void 0&&(delete e.pending[t],e.pendingCount--)};class QL extends Zx{constructor(t,r,a,s={}){super(),this.backend=t,this.store=r,this.services=a,this.languageUtils=a.languageUtils,this.options=s,this.logger=_c.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=s.maxParallelReads||10,this.readingCalls=0,this.maxRetries=s.maxRetries>=0?s.maxRetries:5,this.retryTimeout=s.retryTimeout>=1?s.retryTimeout:350,this.state={},this.queue=[],this.backend?.init?.(a,s.backend,s)}queueLoad(t,r,a,s){const n={},o={},c={},u={};return t.forEach(f=>{let h=!0;r.forEach(g=>{const x=`${f}|${g}`;!a.reload&&this.store.hasResourceBundle(f,g)?this.state[x]=2:this.state[x]<0||(this.state[x]===1?o[x]===void 0&&(o[x]=!0):(this.state[x]=1,h=!1,o[x]===void 0&&(o[x]=!0),n[x]===void 0&&(n[x]=!0),u[g]===void 0&&(u[g]=!0)))}),h||(c[f]=!0)}),(Object.keys(n).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:s}),{toLoad:Object.keys(n),pending:Object.keys(o),toLoadLanguages:Object.keys(c),toLoadNamespaces:Object.keys(u)}}loaded(t,r,a){const s=t.split("|"),n=s[0],o=s[1];r&&this.emit("failedLoading",n,o,r),!r&&a&&this.store.addResourceBundle(n,o,a,void 0,void 0,{skipCopy:!0}),this.state[t]=r?-1:2,r&&a&&(this.state[t]=0);const c={};this.queue.forEach(u=>{wL(u.loaded,[n],o),IL(u,t),r&&u.errors.push(r),u.pendingCount===0&&!u.done&&(Object.keys(u.loaded).forEach(f=>{c[f]||(c[f]={});const h=u.loaded[f];h.length&&h.forEach(g=>{c[f][g]===void 0&&(c[f][g]=!0)})}),u.done=!0,u.errors.length?u.callback(u.errors):u.callback())}),this.emit("loaded",c),this.queue=this.queue.filter(u=>!u.done)}read(t,r,a,s=0,n=this.retryTimeout,o){if(!t.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:t,ns:r,fcName:a,tried:s,wait:n,callback:o});return}this.readingCalls++;const c=(f,h)=>{if(this.readingCalls--,this.waitingReads.length>0){const g=this.waitingReads.shift();this.read(g.lng,g.ns,g.fcName,g.tried,g.wait,g.callback)}if(f&&h&&s<this.maxRetries){setTimeout(()=>{this.read.call(this,t,r,a,s+1,n*2,o)},n);return}o(f,h)},u=this.backend[a].bind(this.backend);if(u.length===2){try{const f=u(t,r);f&&typeof f.then=="function"?f.then(h=>c(null,h)).catch(c):c(null,f)}catch(f){c(f)}return}return u(t,r,c)}prepareLoading(t,r,a={},s){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),s&&s();Yr(t)&&(t=this.languageUtils.toResolveHierarchy(t)),Yr(r)&&(r=[r]);const n=this.queueLoad(t,r,a,s);if(!n.toLoad.length)return n.pending.length||s(),null;n.toLoad.forEach(o=>{this.loadOne(o)})}load(t,r,a){this.prepareLoading(t,r,{},a)}reload(t,r,a){this.prepareLoading(t,r,{reload:!0},a)}loadOne(t,r=""){const a=t.split("|"),s=a[0],n=a[1];this.read(s,n,"read",void 0,void 0,(o,c)=>{o&&this.logger.warn(`${r}loading namespace ${n} for language ${s} failed`,o),!o&&c&&this.logger.log(`${r}loaded namespace ${n} for language ${s}`,c),this.loaded(t,o,c)})}saveMissing(t,r,a,s,n,o={},c=()=>{}){if(this.services?.utils?.hasLoadedNamespace&&!this.services?.utils?.hasLoadedNamespace(r)){this.logger.warn(`did not save key "${a}" as the namespace "${r}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(a==null||a==="")){if(this.backend?.create){const u={...o,isUpdate:n},f=this.backend.create.bind(this.backend);if(f.length<6)try{let h;f.length===5?h=f(t,r,a,s,u):h=f(t,r,a,s),h&&typeof h.then=="function"?h.then(g=>c(null,g)).catch(c):c(null,h)}catch(h){c(h)}else f(t,r,a,s,c,u)}!t||!t[0]||this.store.addResource(t[0],r,a,s)}}}const W1=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:e=>{let t={};if(typeof e[1]=="object"&&(t=e[1]),Yr(e[1])&&(t.defaultValue=e[1]),Yr(e[2])&&(t.tDescription=e[2]),typeof e[2]=="object"||typeof e[3]=="object"){const r=e[3]||e[2];Object.keys(r).forEach(a=>{t[a]=r[a]})}return t},interpolation:{escapeValue:!0,format:e=>e,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),jk=e=>(Yr(e.ns)&&(e.ns=[e.ns]),Yr(e.fallbackLng)&&(e.fallbackLng=[e.fallbackLng]),Yr(e.fallbackNS)&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs?.indexOf?.("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),typeof e.initImmediate=="boolean"&&(e.initAsync=e.initImmediate),e),Zg=()=>{},OL=e=>{Object.getOwnPropertyNames(Object.getPrototypeOf(e)).forEach(r=>{typeof e[r]=="function"&&(e[r]=e[r].bind(e))})};let Uk=!1;const RL=e=>!!(e?.modules?.backend?.name?.indexOf("Locize")>0||e?.modules?.backend?.constructor?.name?.indexOf("Locize")>0||e?.options?.backend?.backends&&e.options.backend.backends.some(t=>t?.name?.indexOf("Locize")>0||t?.constructor?.name?.indexOf("Locize")>0));class ep extends Zx{constructor(t={},r){if(super(),this.options=jk(t),this.services={},this.logger=_c,this.modules={external:[]},OL(this),r&&!this.isInitialized&&!t.isClone){if(!this.options.initAsync)return this.init(t,r),this;setTimeout(()=>{this.init(t,r)},0)}}init(t={},r){this.isInitializing=!0,typeof t=="function"&&(r=t,t={}),t.defaultNS==null&&t.ns&&(Yr(t.ns)?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));const a=W1();this.options={...a,...this.options,...jk(t)},this.options.interpolation={...a.interpolation,...this.options.interpolation},t.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=t.keySeparator),t.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=t.nsSeparator),typeof this.options.overloadTranslationOptionHandler!="function"&&(this.options.overloadTranslationOptionHandler=a.overloadTranslationOptionHandler),this.options.showSupportNotice!==!1&&!RL(this)&&!Uk&&(typeof console<"u"&&typeof console.info<"u"&&console.info(" i18next is maintained with support from Locize  consider powering your project with managed localization (AI, CDN, integrations): https://locize.com "),Uk=!0);const s=f=>f?typeof f=="function"?new f:f:null;if(!this.options.isClone){this.modules.logger?_c.init(s(this.modules.logger),this.options):_c.init(null,this.options);let f;this.modules.formatter?f=this.modules.formatter:f=DL;const h=new Sk(this.options);this.store=new Bk(this.options.resources,this.options);const g=this.services;g.logger=_c,g.resourceStore=this.store,g.languageUtils=h,g.pluralResolver=new LL(h,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==a.interpolation.format&&this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),f&&(!this.options.interpolation.format||this.options.interpolation.format===a.interpolation.format)&&(g.formatter=s(f),g.formatter.init&&g.formatter.init(g,this.options),this.options.interpolation.format=g.formatter.format.bind(g.formatter)),g.interpolator=new Tk(this.options),g.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},g.backendConnector=new QL(s(this.modules.backend),g.resourceStore,g,this.options),g.backendConnector.on("*",(m,...w)=>{this.emit(m,...w)}),this.modules.languageDetector&&(g.languageDetector=s(this.modules.languageDetector),g.languageDetector.init&&g.languageDetector.init(g,this.options.detection,this.options)),this.modules.i18nFormat&&(g.i18nFormat=s(this.modules.i18nFormat),g.i18nFormat.init&&g.i18nFormat.init(this)),this.translator=new ux(this.services,this.options),this.translator.on("*",(m,...w)=>{this.emit(m,...w)}),this.modules.external.forEach(m=>{m.init&&m.init(this)})}if(this.format=this.options.interpolation.format,r||(r=Zg),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const f=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);f.length>0&&f[0]!=="dev"&&(this.options.lng=f[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(f=>{this[f]=(...h)=>this.store[f](...h)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(f=>{this[f]=(...h)=>(this.store[f](...h),this)});const c=Nh(),u=()=>{const f=(h,g)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),c.resolve(g),r(h,g)};if(this.languages&&!this.isInitialized)return f(null,this.t.bind(this));this.changeLanguage(this.options.lng,f)};return this.options.resources||!this.options.initAsync?u():setTimeout(u,0),c}loadResources(t,r=Zg){let a=r;const s=Yr(t)?t:this.language;if(typeof t=="function"&&(a=t),!this.options.resources||this.options.partialBundledLanguages){if(s?.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return a();const n=[],o=c=>{if(!c||c==="cimode")return;this.services.languageUtils.toResolveHierarchy(c).forEach(f=>{f!=="cimode"&&n.indexOf(f)<0&&n.push(f)})};s?o(s):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(u=>o(u)),this.options.preload?.forEach?.(c=>o(c)),this.services.backendConnector.load(n,this.options.ns,c=>{!c&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),a(c)})}else a(null)}reloadResources(t,r,a){const s=Nh();return typeof t=="function"&&(a=t,t=void 0),typeof r=="function"&&(a=r,r=void 0),t||(t=this.languages),r||(r=this.options.ns),a||(a=Zg),this.services.backendConnector.reload(t,r,n=>{s.resolve(),a(n)}),s}use(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return t.type==="backend"&&(this.modules.backend=t),(t.type==="logger"||t.log&&t.warn&&t.error)&&(this.modules.logger=t),t.type==="languageDetector"&&(this.modules.languageDetector=t),t.type==="i18nFormat"&&(this.modules.i18nFormat=t),t.type==="postProcessor"&&f3.addPostProcessor(t),t.type==="formatter"&&(this.modules.formatter=t),t.type==="3rdParty"&&this.modules.external.push(t),this}setResolvedLanguage(t){if(!(!t||!this.languages)&&!(["cimode","dev"].indexOf(t)>-1)){for(let r=0;r<this.languages.length;r++){const a=this.languages[r];if(!(["cimode","dev"].indexOf(a)>-1)&&this.store.hasLanguageSomeTranslations(a)){this.resolvedLanguage=a;break}}!this.resolvedLanguage&&this.languages.indexOf(t)<0&&this.store.hasLanguageSomeTranslations(t)&&(this.resolvedLanguage=t,this.languages.unshift(t))}}changeLanguage(t,r){this.isLanguageChangingTo=t;const a=Nh();this.emit("languageChanging",t);const s=c=>{this.language=c,this.languages=this.services.languageUtils.toResolveHierarchy(c),this.resolvedLanguage=void 0,this.setResolvedLanguage(c)},n=(c,u)=>{u?this.isLanguageChangingTo===t&&(s(u),this.translator.changeLanguage(u),this.isLanguageChangingTo=void 0,this.emit("languageChanged",u),this.logger.log("languageChanged",u)):this.isLanguageChangingTo=void 0,a.resolve((...f)=>this.t(...f)),r&&r(c,(...f)=>this.t(...f))},o=c=>{!t&&!c&&this.services.languageDetector&&(c=[]);const u=Yr(c)?c:c&&c[0],f=this.store.hasLanguageSomeTranslations(u)?u:this.services.languageUtils.getBestMatchFromCodes(Yr(c)?[c]:c);f&&(this.language||s(f),this.translator.language||this.translator.changeLanguage(f),this.services.languageDetector?.cacheUserLanguage?.(f)),this.loadResources(f,h=>{n(h,f)})};return!t&&this.services.languageDetector&&!this.services.languageDetector.async?o(this.services.languageDetector.detect()):!t&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(o):this.services.languageDetector.detect(o):o(t),a}getFixedT(t,r,a){const s=(n,o,...c)=>{let u;typeof o!="object"?u=this.options.overloadTranslationOptionHandler([n,o].concat(c)):u={...o},u.lng=u.lng||s.lng,u.lngs=u.lngs||s.lngs,u.ns=u.ns||s.ns,u.keyPrefix!==""&&(u.keyPrefix=u.keyPrefix||a||s.keyPrefix);const f=this.options.keySeparator||".";let h;return u.keyPrefix&&Array.isArray(n)?h=n.map(g=>(typeof g=="function"&&(g=hw(g,{...this.options,...o})),`${u.keyPrefix}${f}${g}`)):(typeof n=="function"&&(n=hw(n,{...this.options,...o})),h=u.keyPrefix?`${u.keyPrefix}${f}${n}`:n),this.t(h,u)};return Yr(t)?s.lng=t:s.lngs=t,s.ns=r,s.keyPrefix=a,s}t(...t){return this.translator?.translate(...t)}exists(...t){return this.translator?.exists(...t)}setDefaultNamespace(t){this.options.defaultNS=t}hasLoadedNamespace(t,r={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const a=r.lng||this.resolvedLanguage||this.languages[0],s=this.options?this.options.fallbackLng:!1,n=this.languages[this.languages.length-1];if(a.toLowerCase()==="cimode")return!0;const o=(c,u)=>{const f=this.services.backendConnector.state[`${c}|${u}`];return f===-1||f===0||f===2};if(r.precheck){const c=r.precheck(this,o);if(c!==void 0)return c}return!!(this.hasResourceBundle(a,t)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(a,t)&&(!s||o(n,t)))}loadNamespaces(t,r){const a=Nh();return this.options.ns?(Yr(t)&&(t=[t]),t.forEach(s=>{this.options.ns.indexOf(s)<0&&this.options.ns.push(s)}),this.loadResources(s=>{a.resolve(),r&&r(s)}),a):(r&&r(),Promise.resolve())}loadLanguages(t,r){const a=Nh();Yr(t)&&(t=[t]);const s=this.options.preload||[],n=t.filter(o=>s.indexOf(o)<0&&this.services.languageUtils.isSupportedCode(o));return n.length?(this.options.preload=s.concat(n),this.loadResources(o=>{a.resolve(),r&&r(o)}),a):(r&&r(),Promise.resolve())}dir(t){if(t||(t=this.resolvedLanguage||(this.languages?.length>0?this.languages[0]:this.language)),!t)return"rtl";try{const s=new Intl.Locale(t);if(s&&s.getTextInfo){const n=s.getTextInfo();if(n&&n.direction)return n.direction}}catch{}const r=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],a=this.services?.languageUtils||new Sk(W1());return t.toLowerCase().indexOf("-latn")>1?"ltr":r.indexOf(a.getLanguagePartFromCode(t))>-1||t.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(t={},r){const a=new ep(t,r);return a.createInstance=ep.createInstance,a}cloneInstance(t={},r=Zg){const a=t.forkResourceStore;a&&delete t.forkResourceStore;const s={...this.options,...t,isClone:!0},n=new ep(s);if((t.debug!==void 0||t.prefix!==void 0)&&(n.logger=n.logger.clone(t)),["store","services","language"].forEach(c=>{n[c]=this[c]}),n.services={...this.services},n.services.utils={hasLoadedNamespace:n.hasLoadedNamespace.bind(n)},a){const c=Object.keys(this.store.data).reduce((u,f)=>(u[f]={...this.store.data[f]},u[f]=Object.keys(u[f]).reduce((h,g)=>(h[g]={...u[f][g]},h),u[f]),u),{});n.store=new Bk(c,s),n.services.resourceStore=n.store}if(t.interpolation){const u={...W1().interpolation,...this.options.interpolation,...t.interpolation},f={...s,interpolation:u};n.services.interpolator=new Tk(f)}return n.translator=new ux(n.services,s),n.translator.on("*",(c,...u)=>{n.emit(c,...u)}),n.init(s,r),n.translator.options=s,n.translator.backendConnector.services.utils={hasLoadedNamespace:n.hasLoadedNamespace.bind(n)},n}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const yl=ep.createInstance();yl.createInstance;yl.dir;yl.init;yl.loadResources;yl.reloadResources;yl.use;yl.changeLanguage;yl.getFixedT;yl.t;yl.exists;yl.setDefaultNamespace;yl.hasLoadedNamespace;yl.loadNamespaces;yl.loadLanguages;const ML=(e,t,r,a)=>{const s=[r,{code:t,...a||{}}];if(e?.services?.logger?.forward)return e.services.logger.forward(s,"warn","react-i18next::",!0);$0(s[0])&&(s[0]=`react-i18next:: ${s[0]}`),e?.services?.logger?.warn?e.services.logger.warn(...s):console?.warn&&console.warn(...s)},Dk={},p3=(e,t,r,a)=>{$0(r)&&Dk[r]||($0(r)&&(Dk[r]=new Date),ML(e,t,r,a))},g3=(e,t)=>()=>{if(e.isInitialized)t();else{const r=()=>{setTimeout(()=>{e.off("initialized",r)},0),t()};e.on("initialized",r)}},pw=(e,t,r)=>{e.loadNamespaces(t,g3(e,r))},Ik=(e,t,r,a)=>{if($0(r)&&(r=[r]),e.options.preload&&e.options.preload.indexOf(t)>-1)return pw(e,r,a);r.forEach(s=>{e.options.ns.indexOf(s)<0&&e.options.ns.push(s)}),e.loadLanguages(t,g3(e,a))},HL=(e,t,r={})=>!t.languages||!t.languages.length?(p3(t,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:t.languages}),!0):t.hasLoadedNamespace(e,{lng:r.lng,precheck:(a,s)=>{if(r.bindI18n&&r.bindI18n.indexOf("languageChanging")>-1&&a.services.backendConnector.backend&&a.isLanguageChangingTo&&!s(a.isLanguageChangingTo,e))return!1}}),$0=e=>typeof e=="string",PL=e=>typeof e=="object"&&e!==null,qL=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,KL={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},zL=e=>KL[e],VL=e=>e.replace(qL,zL);let gw={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:VL,transDefaultProps:void 0};const GL=(e={})=>{gw={...gw,...e}},WL=()=>gw;let m3;const $L=e=>{m3=e},XL=()=>m3,YL={type:"3rdParty",init(e){GL(e.options.react),$L(e)}},JL=Z.createContext();class ZL{constructor(){this.usedNamespaces={}}addUsedNamespaces(t){t.forEach(r=>{this.usedNamespaces[r]||(this.usedNamespaces[r]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}var ej=uL();const tj=(e,t)=>$0(t)?t:PL(t)&&$0(t.defaultValue)?t.defaultValue:Array.isArray(e)?e[e.length-1]:e,rj={t:tj,ready:!1},aj=()=>()=>{},ds=(e,t={})=>{const{i18n:r}=t,{i18n:a,defaultNS:s}=Z.useContext(JL)||{},n=r||a||XL();n&&!n.reportNamespaces&&(n.reportNamespaces=new ZL),n||p3(n,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const o=Z.useMemo(()=>({...WL(),...n?.options?.react,...t}),[n,t]),{useSuspense:c,keyPrefix:u}=o,f=s||n?.options?.defaultNS,h=$0(f)?[f]:f||["translation"],g=Z.useMemo(()=>h,h);n?.reportNamespaces?.addUsedNamespaces?.(g);const x=Z.useRef(0),m=Z.useCallback(U=>{if(!n)return aj;const{bindI18n:M,bindI18nStore:T}=o,D=()=>{x.current+=1,U()};return M&&n.on(M,D),T&&n.store.on(T,D),()=>{M&&M.split(" ").forEach(G=>n.off(G,D)),T&&T.split(" ").forEach(G=>n.store.off(G,D))}},[n,o]),w=Z.useRef(),v=Z.useCallback(()=>{if(!n)return rj;const U=!!(n.isInitialized||n.initializedStoreOnce)&&g.every(H=>HL(H,n,o)),M=t.lng||n.language,T=x.current,D=w.current;if(D&&D.ready===U&&D.lng===M&&D.keyPrefix===u&&D.revision===T)return D;const ne={t:n.getFixedT(M,o.nsMode==="fallback"?g:g[0],u),ready:U,lng:M,keyPrefix:u,revision:T};return w.current=ne,ne},[n,g,u,o,t.lng]),[B,k]=Z.useState(0),{t:E,ready:S}=ej.useSyncExternalStore(m,v,v);Z.useEffect(()=>{if(n&&!S&&!c){const U=()=>k(M=>M+1);t.lng?Ik(n,t.lng,g,U):pw(n,g,U)}},[n,t.lng,g,S,c,B]);const L=n||{},P=Z.useRef(null),R=Z.useRef(),Q=U=>{const M=Object.getOwnPropertyDescriptors(U);M.__original&&delete M.__original;const T=Object.create(Object.getPrototypeOf(U),M);if(!Object.prototype.hasOwnProperty.call(T,"__original"))try{Object.defineProperty(T,"__original",{value:U,writable:!1,enumerable:!1,configurable:!1})}catch{}return T},V=Z.useMemo(()=>{const U=L,M=U?.language;let T=U;U&&(P.current&&P.current.__original===U?R.current!==M?(T=Q(U),P.current=T,R.current=M):T=P.current:(T=Q(U),P.current=T,R.current=M));const D=[E,T,S];return D.t=E,D.i18n=T,D.ready=S,D},[E,L,S,L.resolvedLanguage,L.language,L.languages]);if(n&&c&&!S)throw new Promise(U=>{const M=()=>U();t.lng?Ik(n,t.lng,g,M):pw(n,g,M)});return V},{slice:sj,forEach:nj}=[];function ij(e){return nj.call(sj.call(arguments,1),t=>{if(t)for(const r in t)e[r]===void 0&&(e[r]=t[r])}),e}function lj(e){return typeof e!="string"?!1:[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some(r=>r.test(e))}const Qk=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,oj=function(e,t){const a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},s=encodeURIComponent(t);let n=`${e}=${s}`;if(a.maxAge>0){const o=a.maxAge-0;if(Number.isNaN(o))throw new Error("maxAge should be a Number");n+=`; Max-Age=${Math.floor(o)}`}if(a.domain){if(!Qk.test(a.domain))throw new TypeError("option domain is invalid");n+=`; Domain=${a.domain}`}if(a.path){if(!Qk.test(a.path))throw new TypeError("option path is invalid");n+=`; Path=${a.path}`}if(a.expires){if(typeof a.expires.toUTCString!="function")throw new TypeError("option expires is invalid");n+=`; Expires=${a.expires.toUTCString()}`}if(a.httpOnly&&(n+="; HttpOnly"),a.secure&&(n+="; Secure"),a.sameSite)switch(typeof a.sameSite=="string"?a.sameSite.toLowerCase():a.sameSite){case!0:n+="; SameSite=Strict";break;case"lax":n+="; SameSite=Lax";break;case"strict":n+="; SameSite=Strict";break;case"none":n+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return a.partitioned&&(n+="; Partitioned"),n},Ok={create(e,t,r,a){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};r&&(s.expires=new Date,s.expires.setTime(s.expires.getTime()+r*60*1e3)),a&&(s.domain=a),document.cookie=oj(e,t,s)},read(e){const t=`${e}=`,r=document.cookie.split(";");for(let a=0;a<r.length;a++){let s=r[a];for(;s.charAt(0)===" ";)s=s.substring(1,s.length);if(s.indexOf(t)===0)return s.substring(t.length,s.length)}return null},remove(e,t){this.create(e,"",-1,t)}};var Aj={name:"cookie",lookup(e){let{lookupCookie:t}=e;if(t&&typeof document<"u")return Ok.read(t)||void 0},cacheUserLanguage(e,t){let{lookupCookie:r,cookieMinutes:a,cookieDomain:s,cookieOptions:n}=t;r&&typeof document<"u"&&Ok.create(r,e,a,s,n)}},cj={name:"querystring",lookup(e){let{lookupQuerystring:t}=e,r;if(typeof window<"u"){let{search:a}=window.location;!window.location.search&&window.location.hash?.indexOf("?")>-1&&(a=window.location.hash.substring(window.location.hash.indexOf("?")));const n=a.substring(1).split("&");for(let o=0;o<n.length;o++){const c=n[o].indexOf("=");c>0&&n[o].substring(0,c)===t&&(r=n[o].substring(c+1))}}return r}},uj={name:"hash",lookup(e){let{lookupHash:t,lookupFromHashIndex:r}=e,a;if(typeof window<"u"){const{hash:s}=window.location;if(s&&s.length>2){const n=s.substring(1);if(t){const o=n.split("&");for(let c=0;c<o.length;c++){const u=o[c].indexOf("=");u>0&&o[c].substring(0,u)===t&&(a=o[c].substring(u+1))}}if(a)return a;if(!a&&r>-1){const o=s.match(/\/([a-zA-Z-]*)/g);return Array.isArray(o)?o[typeof r=="number"?r:0]?.replace("/",""):void 0}}}return a}};let Hd=null;const Rk=()=>{if(Hd!==null)return Hd;try{if(Hd=typeof window<"u"&&window.localStorage!==null,!Hd)return!1;const e="i18next.translate.boo";window.localStorage.setItem(e,"foo"),window.localStorage.removeItem(e)}catch{Hd=!1}return Hd};var dj={name:"localStorage",lookup(e){let{lookupLocalStorage:t}=e;if(t&&Rk())return window.localStorage.getItem(t)||void 0},cacheUserLanguage(e,t){let{lookupLocalStorage:r}=t;r&&Rk()&&window.localStorage.setItem(r,e)}};let Pd=null;const Mk=()=>{if(Pd!==null)return Pd;try{if(Pd=typeof window<"u"&&window.sessionStorage!==null,!Pd)return!1;const e="i18next.translate.boo";window.sessionStorage.setItem(e,"foo"),window.sessionStorage.removeItem(e)}catch{Pd=!1}return Pd};var fj={name:"sessionStorage",lookup(e){let{lookupSessionStorage:t}=e;if(t&&Mk())return window.sessionStorage.getItem(t)||void 0},cacheUserLanguage(e,t){let{lookupSessionStorage:r}=t;r&&Mk()&&window.sessionStorage.setItem(r,e)}},hj={name:"navigator",lookup(e){const t=[];if(typeof navigator<"u"){const{languages:r,userLanguage:a,language:s}=navigator;if(r)for(let n=0;n<r.length;n++)t.push(r[n]);a&&t.push(a),s&&t.push(s)}return t.length>0?t:void 0}},pj={name:"htmlTag",lookup(e){let{htmlTag:t}=e,r;const a=t||(typeof document<"u"?document.documentElement:null);return a&&typeof a.getAttribute=="function"&&(r=a.getAttribute("lang")),r}},gj={name:"path",lookup(e){let{lookupFromPathIndex:t}=e;if(typeof window>"u")return;const r=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(r)?r[typeof t=="number"?t:0]?.replace("/",""):void 0}},mj={name:"subdomain",lookup(e){let{lookupFromSubdomainIndex:t}=e;const r=typeof t=="number"?t+1:1,a=typeof window<"u"&&window.location?.hostname?.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i);if(a)return a[r]}};let x3=!1;try{document.cookie,x3=!0}catch{}const b3=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];x3||b3.splice(1,1);const xj=()=>({order:b3,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:e=>e});class v3{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(t,r)}init(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=t,this.options=ij(r,this.options||{},xj()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=s=>s.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=a,this.addDetector(Aj),this.addDetector(cj),this.addDetector(dj),this.addDetector(fj),this.addDetector(hj),this.addDetector(pj),this.addDetector(gj),this.addDetector(mj),this.addDetector(uj)}addDetector(t){return this.detectors[t.name]=t,this}detect(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,r=[];return t.forEach(a=>{if(this.detectors[a]){let s=this.detectors[a].lookup(this.options);s&&typeof s=="string"&&(s=[s]),s&&(r=r.concat(s))}}),r=r.filter(a=>a!=null&&!lj(a)).map(a=>this.options.convertDetectedLanguage(a)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?r:r.length>0?r[0]:null}cacheUserLanguage(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;r&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(t)>-1||r.forEach(a=>{this.detectors[a]&&this.detectors[a].cacheUserLanguage(t,this.options)}))}}v3.type="languageDetector";const bj={loading:"Loading...",save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",search:"Search...",no_data:"No data available",back:"Back",confirm_title:"Are you sure",success:"Success",error:"Error",warning:"Warning",info:"Information",input:"Input",remove:"Remove",add:"Add",export_pdf:"PDF",exporting:"Export...",deleted:"Deleted",pinned:"Pinned",unpinned:"Unpinned",details:"Details",results_count:"{{count}} results",apply:"Apply",new:"New",expand:"Expand",collapse:"Collapse",all:"All",settings:"Settings",done:"Done",default:"Default",rename:"Rename",confirm_delete:"Delete this item",read_only:"Read-Only",open_details:"Open details",refresh:"Refresh",show:"Show",hide:"Hide",open:"Open",open_in_inspector:"Open in Data Inspector",stop_sql:"Stop",storage_memory_warning:"Local persistence is currently unavailable. The database runs in memory and changes may be lost after reload.",storage_memory_reason:"Reason",name:"Name",description:"Description",saving:"Saving...",ok:"OK",not_available:"Not available"},vj={dashboard:"Overview",worklist:"Worklist",data_inspector:"Data Inspector",sql_workspace:"SQL Workspace",query_builder:"Widgets",datasource:"Data Management",settings:"Settings",analytics_platform:"Analytics Platform",clock:"Status & Clock",database_status:"Database Status",system_status:"System Status",records_count:"{{count}}k Records",reports:"Reporting",about:"About"},wj={title:"My Dashboard",subtitle:"Categorized evaluations and tiles.",add_widget:"Add Widget",manage_dashboards:"Manage Dashboards",presentation_mode:"Presentation Mode",system_widgets:"System Widgets",custom_widgets:"My Reports",default_name:"My Dashboard",add_title:"Add Widget",manage_title:"Manage Dashboards",new_dashboard:"New Dashboard",new_dashboard_title:"Create new dashboard",new_dashboard_placeholder:"Dashboard name (e.g., Costs for Customer X)",rename:"Rename",delete_confirm:"Delete dashboard",empty_msg:'"{{name}}" is still empty',empty_hint:"Add tiles to customize this dashboard.",confirm_delete_report:"Are you sure you want to remove this report from the dashboard",filters_title:"Global Dashboard Filters",filters_subtitle:"Slicers that affect all dashboard charts simultaneously.",add_filter:"Add Filter",filter_column:"Column...",filter_value:"Value...",no_filters:"No active filters. Click 'Add Filter' to constrain the dashboard.",op_contains:"contains",op_is_null:"is empty",pin_sidebar:"Add to menu",unpin_sidebar:"Remove from menu",active:"Active",no_reports:"No saved reports found.",tools_title:"Dashboard Tools",tools_tab_layout:"Layout",tools_tab_filters:"Filters",tools_layout_hint:"Reorder widgets and remove items without leaving the dashboard.",tools_filters_hint:"Manage global dashboard filters in one place.",tools_move_up:"Move up",tools_move_down:"Move down",tools_clear_filters:"Clear filters"},_j={add_dialog_title:"Add to worklist",add_priority_prompt:"Priority (low, normal, high, critical)",add_due_prompt:"Due date optional (YYYY-MM-DD), leave empty for none",subtitle:"Bookmarked records and verification results",filter_all:"All",filter_open:"New / Open",filter_in_progress:"In Progress",filter_done:"Done",filter_closed:"Closed",quick_all:"All",quick_overdue:"Overdue",quick_today:"Today",quick_high_priority:"High Priority",status_label:"Status",element_label:"Element",table_label:"Table",priority_label:"Priority",due_label:"Due",priority_low:"Low",priority_normal:"Normal",priority_high:"High",priority_critical:"Critical",context_label:"Comment",created_label:"Created At",status_open:"New / Open",status_in_progress:"In Progress",status_done:"Done",status_closed:"Closed",found_count:"{{count}} entries found",empty_msg:"No entries",empty_hint:"Your worklist is currently empty or restricted by filters.",details_btn:"Open details",remove_btn:"Remove from worklist",entry_id:"Entry #{{id}}",comment_present:"Comment",tools_title:"Worklist Tools",tools_tab_focus:"Focus",tools_tab_batch:"Batch",tools_tab_preview:"Preview",focus_open:"Open",tools_quick_filters:"Quick filters",tools_selected_count:"{{count}} selected"},yj={subtitle:"{{count}} Results  {{mode}}",table_mode:"Table",sql_mode:"SQL",output_results:"Results",output_explain:"Explain",result_tab_data:"Data",result_tab_profile:"Profiling",saved_views:"Saved views",profiling_settings:"Profiling settings",refresh_title:"Refresh data",export_excel:"Export Excel",search_placeholder:"Search in visible columns...",auto_limit:"Auto-Limit: {{limit}}",page_size:"Page Size",page_size_value:"{{size}} / page",prev_page:"Prev",next_page:"Next",page_info:"Page {{page}} / {{pages}} ({{total}} rows)",page_number_placeholder:"Page",go:"Go",sql_placeholder:"SELECT * FROM ...",back_to_dashboard:"Back to Dashboard",clear_sql:"Clear",run_sql:"Run",stop_sql:"Stop",cancel_not_available:"No cancellable SQL query is currently running in this tab.",limit_confirm_prompt:"This SELECT has no LIMIT. Continue anyway The result will be capped to {{limit}} rows.",limit_applied_notice:"Safety limit active: maximum {{limit}} rows are returned in SQL mode.",autocomplete_toggle_title:"Toggle SQL autocomplete",autocomplete_on:"Autocomplete on",autocomplete_off:"Autocomplete off",explain:"Explain",explain_mode:"Enable query explain plan",explain_title:"Explain Query Plan",explain_hint:"SQLite execution strategy",explain_empty:"Run a SQL query to see the explain plan.",empty_sql:"Enter and run SQL query.",sql_error:"SQL Error",write_confirm:"This SQL statement may modify data. Continue",templates:"Templates",template_top10:"Top 10",template_count:"Count Rows",template_nullscan:"Null Scan",template_duplicates:"Find Duplicates",template_outliers:"Find Outliers",recent_queries:"Recent Queries",pick_recent:"Select recent query...",clear_history:"Clear History",favorite_queries:"Favorite Queries",pick_favorite:"Select favorite query...",clear_favorites:"Clear Favorites",pin_query:"Pin query",unpin_query:"Unpin query",pin:"Pin",unpin:"Unpin",save_template:"Save Template",custom_templates:"Custom Templates",pick_custom_template:"Select custom template...",rename_template:"Rename Template",delete_template:"Delete Template",clear_templates:"Clear Templates",custom_template_prompt:"Template name:",custom_template_prompt_update:"Template name (updates existing):",rename_template_prompt:"New template name:",custom_template_overwrite_confirm:'A template named "{{name}}" already exists. Overwrite',custom_template_delete_confirm:"Delete selected custom template",clear_templates_confirm:"Delete all custom templates",sql_assist:"SQL Workspace",sql_manager_tab:"SQL Manager",assistant_tab:"SQL Builder",sql_manager_search_placeholder:"Search patterns...",sql_manager_no_results:"No matches",assistant_hint:"Build SQL by selecting table, columns and optional aggregation.",assistant_table:"Table",assistant_columns:"Columns",assistant_select_all:"Select all",assistant_clear_all:"Clear",assistant_column_search_placeholder:"Search columns...",assistant_aggregation:"Aggregation",assistant_aggregation_function:"Function",assistant_none:"None",assistant_aggregation_field:"Aggregation Field",assistant_group_by:"Group by",assistant_grouping_columns:"Grouping Columns",assistant_grouping_requires_aggregation:"Enable aggregation to configure grouping.",assistant_metric_alias:"Metric Alias",assistant_filter:"Filter",assistant_add_filter:"Add filter",assistant_filter_value:"Value",assistant_where:"WHERE",assistant_where_connector:"Join with filters",assistant_where_placeholder:"status = 'active'",assistant_order_by:"Order by",assistant_sort_field:"Sort field",assistant_add_sort:"Add sort",assistant_auto:"Auto",assistant_direction:"Direction",assistant_limit:"Limit",assistant_reset:"Reset",assistant_generated_sql:"Generated SQL",assistant_replace_editor:"Replace Editor",assistant_append:"Append",profiling_title:"Data Profiling",profiling_subtitle:"Calculated from {{count}} loaded rows",profiling_issues:"Issues: {{count}}",thresholds:"Thresholds",null_threshold:"Null",cardinality_threshold:"Cardinality",reset_thresholds:"Reset",type:"Type",issues:"Issues",type_number:"Number",type_text:"Text",type_date:"Date",type_mixed:"Mixed",type_unknown:"Unknown",issue_high_null:"High Null",issue_mixed_types:"Mixed Types",issue_high_cardinality:"High Cardinality",issue_suspicious_values:"Suspicious Values",patterns:"Patterns",suspicious_values:"Suspicious",pattern_email:"Email",pattern_uuid:"UUID",pattern_iban:"IBAN",pattern_url:"URL",pattern_date:"Date",distinct_values:"Distinct",null_rate:"Null Rate",min:"Min",max:"Max",top_values:"Top Values",no_profile:"No profile data available.",show_profile:"Show Profile",hide_profile:"Hide Profile",resize_profile:"Resize profile panel",resize_sql_split:"Resize SQL and results panes",select_view:"Select view...",save_view:"Save View",update_view:"Update View",delete_view:"Delete View",new_view_prompt:"View name:",delete_view_confirm:"Delete this saved view",table_tools:"Table Tools",table_tools_tab_columns:"Columns",table_tools_tab_filters:"Filters",table_tools_tab_actions:"Actions",table_tools_columns_hint:"Inspect schema and set sorting per column.",table_tools_filters_hint:"Manage global search and column filters.",table_tools_actions_hint:"Quick actions for current table context.",table_tools_column:"Column",table_tools_filter_value:"Filter",table_tools_filter_apply:"Apply",table_tools_toggle_filter_row:"Show filter row in table",table_tools_clear_all:"Clear all",table_tools_no_filters:"No active column filters",table_tools_global_search:"Global Search",table_tools_sort_asc:"Sort ascending",table_tools_sort_desc:"Sort descending",table_tools_export_rows:"Export current rows",table_tools_open_sql:"Open as SQL",table_tools_create_index:"Create index",table_tools_field_picker:"Field Picker",table_tools_selected_count:"{{count}} selected",table_tools_select_all_fields:"Select all",table_tools_clear_field_selection:"Clear",table_tools_to_sql_workspace:"To SQL Workspace",table_tools_apply_to_table:"Apply to Table",table_tools_run_selected_sql:"Run",table_tools_pick_fields_required:"Select at least one field.",index_suggestions_title:"Index Suggestions",index_suggestions_generate:"Generate",index_suggestions_hint:"Based on active filters, sorting, cardinality and existing indexes.",index_suggestions_empty:"No suggestions yet. Generate to analyze this table.",index_suggestions_columns:"Columns",index_suggestions_apply:"Create",index_suggestion_reason_filter:"Used in active table filter",index_suggestion_reason_sort:"Used as active sort column",index_suggestion_reason_composite:"Composite index for combined filters",index_suggestion_reason_filter_sort:"Composite index for filter + sort",index_suggestion_reason_cardinality:"High cardinality column"},kj={subtitle:"Build widgets based on saved SQL statements.",visual_builder:"Visual Builder",direct_editor:"SQL View",sql_query:"Selected SQL statement",apply:"Apply",preview:"Preview ({{count}} results)",preview_panel_title:"Preview",preview_tab_graphic:"Graphic",preview_tab_table:"Table",preview_tab_sql:"SQL",preview_graphic_no_query_hint:"No data query is selected yet. Choose a query in Source, or continue with a text, markdown, status, section, KPI Manual, or image widget without data.",preview_graphic_not_selected_hint:"Select a chart type to show a preview.",preview_table_no_query_hint:"Table view is only available when a query exists.",preview_sql_no_query_hint:"SQL view is only available when a query exists.",preview_no_data_source:"No data source selected. Please choose a query or a widget with a data source.",graph_type:"Visualization Type",graph:"Graph",archive:"Archive",table:"Table",bar:"Bar",line:"Line",area:"Area",pie:"Pie",kpi:"KPI",composed:"Composed",radar:"Radar",scatter:"Scatter",text:"Text",markdown:"Markdown",status:"Status",section:"Section",kpi_manual:"KPI Manual",image:"Image",x_axis:"X-Axis",y_axis:"Y-Axis",label:"Label",value:"Value",please_select:"Please select...",save_as_widget:"Save as Widget",update_widget:"Update Widget",new_report:"New Widget",saved_reports:"Saved Widgets",start_new:"New",start_open:"Open",source_tab_none:"None",source_tab_query:"Select query",source_tab_widget:"Select widget",source_tab_none_hint:"Continue without data query or widget by clicking Next.",mode_open_select:"Select an existing widget from the list.",sql_manager_source:"SQL Manager Source",widget_studio_sql_source_hint:"Select SQL in SQL Manager above",widget_studio_sql_locked_hint:"SQL selection is done in the start step under New.",search_sql_statements:"Search SQL statements...",no_sql_statements:"No SQL statements found.",new_without_sql_creates_text_widget:"If nothing is selected, continuing will create a text widget automatically.",new_mode_with_query:"With query",new_mode_without_query:"Without query",new_with_query_hint:"Select an SQL statement from SQL Manager to create a query-based widget.",new_without_query_hint:"Without a selection, clicking Next creates a new text widget without a data query.",search_saved_reports:"Search saved widgets...",no_saved_reports_filtered:"No matching widgets found.",editing:"Editing: {{name}}",query:"Query",focus:"Focus",centered:"Centered",no_data_prompt:"No preview\\nSelect data source",save_title:"Save Report",update_title:"Update Report",archive_name:"Archive Name",archive_placeholder:"e.g., Monthly Hardware Costs",save_new:"Save as New",success_save:"Widget saved!",success_update:"Widget updated!",error_save:"Error saving: ",confirm_overwrite_widget_name:'A widget named "{{name}}" already exists. Overwrite it',error_widget_name_exists:'A widget named "{{name}}" already exists.',labels:"Labels",label_on:"ON",label_off:"OFF",select_column:"Select column...",add_y_axis:"Add Y-Axis",y_axes:"Y-Axes",pivot:"Pivot Table",pivot_rows:"Rows",pivot_cols:"Columns",pivot_measures:"Measures",pivot_add_row:"Add Row",pivot_add_col:"Add Column",pivot_add_measure:"Add Measure",pivot_agg_sum:"Sum",pivot_agg_count:"Count",pivot_agg_avg:"Average",pivot_agg_min:"Min",pivot_agg_max:"Max",kpi_rules:"KPI Alerts / Thresholds",add_rule:"Add Rule",rule_operator:"Operator",rule_value:"Value",rule_color:"Color",hint_run_query_before_export:"Run a query first to export.",hint_run_query_before_save:"Run a query or create text content first to save.",hint_select_sql_statement_for_widget:"Please select an SQL statement in SQL Manager first.",hint_select_sql_statement_before_save:"Please select an SQL statement from SQL Manager.",hint_run_query_before_continue:"Please run the query first.",hint_configure_visualization_before_continue:"Please configure the visualization to continue.",visual_text_only_hint:"Without a selected query, only text, markdown, status, section, KPI Manual, or image widgets are available.",hint_save_shortcut:"Shortcut: Ctrl/Cmd + S",hint_export_shortcut:"Export current preview",workflow_guided:"Guided",workflow_advanced:"Advanced",guided_panel:"Guided Panel",tab_source:"Source",tab_visualization:"Visualization",tab_widget:"Widget",current_step:"Current step",step_start:"Start",step_source:"Source",step_source_run:"Query",step_run:"Run",step_visualize:"Visualize",step_finalize:"Finalize",step_help_start:"Choose whether you want to create a new query or continue working on a saved one.",step_help_source_run:"In the 'Source' tab, select an SQL statement and run it to load data.",step_help_visualize:"In the 'Visualization' tab, configure chart type, axes and display options.",step_help_finalize:"In the 'Widget' tab, review the result and save the widget.",mode_new_active:"Mode: New query",mode_new_text_active:"Mode: New Text-Widget",mode_editing_active:"Mode: Editing {{name}}",mode_new_text_without_data:"Create new widget (Text - No data)",mode_new_query_widget:"Create new widget (Query)",mode_widget_edit:"Edit widget",start_new_query:"New Query",start_existing_query:"Edit Existing",new_query_card_title:"Create new query widget...",new_query_card_subtitle:"Define a new query",new_query_card_type:"< new type >",new_text_card_title:"Create new text widget...",new_text_card_subtitle:"Define a text message",new_text_card_type:"TEXT",new_markdown_card_type:"MARKDOWN",new_status_card_type:"STATUS",new_section_card_type:"SECTION",new_kpi_manual_card_type:"KPI MANUAL",new_image_card_type:"IMAGE",preview_new_widget_title:"New widget ...",next:"Next",back:"Back",finish:"Finish",unsaved_changes:"Unsaved changes",confirm_discard_changes:"You have unsaved changes. Discard them and continue",check_start_ready:"Start option selected",check_source_ready:"Source selected",check_run_ready:"Query executed",check_visual_ready:"Visualization configured",check_save_ready:"Ready to save",text_content:"Text Content",text_placeholder:"Enter your text here...",markdown_content:"Markdown Content",markdown_placeholder:`# Title
Text with **bold** and [link](https://example.com)`,markdown_help:"Supports headings, lists, **bold**, *italic*, `code`, and links.",status_level:"Status level",status_level_ok:"OK",status_level_info:"Info",status_level_warning:"Warning",status_level_critical:"Critical",status_title:"Title",status_message:"Message",status_placeholder_title:"System status",status_placeholder_message:"All core systems are running stable.",status_pulse:"Signal animation",section_title:"Header",section_subtitle:"Subheader",section_placeholder_title:"Section title",section_placeholder_subtitle:"Optional helper text",section_align:"Alignment",section_divider:"Divider",section_divider_line:"Line",section_divider_double:"Double",section_divider_none:"None",kpi_title:"Metric title",kpi_value:"Value",kpi_unit:"Unit",kpi_target:"Target",kpi_trend:"Trend",kpi_trend_up:"Rising",kpi_trend_flat:"Stable",kpi_trend_down:"Falling",kpi_status_on_target:"On target",kpi_status_near_target:"Near target",kpi_status_below_target:"Below target",kpi_status_no_compare:"No target comparison",kpi_note:"Note",kpi_placeholder_title:"e.g. Availability",kpi_placeholder_value:"99.9",kpi_placeholder_unit:"%",kpi_placeholder_target:"99.5",kpi_placeholder_note:"Optional context for this KPI.",image_url:"Image URL",image_alt:"Alt text",image_caption:"Caption",image_fit:"Fit mode",image_fit_contain:"Contain",image_fit_cover:"Cover",image_placeholder_url:"https://...",image_placeholder_alt:"Description for screen readers",image_placeholder_caption:"Optional",image_empty_hint:"Please provide an image URL.",image_load_error_title:"Image could not be loaded.",image_load_error_hint:"Please check URL access and CORS/hotlink protection.",text_size:"Text Size",text_size_sm:"Small",text_size_md:"Medium",text_size_lg:"Large",text_size_xl:"Extra Large",text_size_2xl:"2x Large",text_align:"Alignment",text_align_left:"Left",text_align_center:"Center",text_align_right:"Right",text_style:"Style",text_bold:"Bold",text_italic:"Italic",text_underline:"Underline",finalize_mode:"Mode",finalize_source:"Source",finalize_chart:"Visualization",finalize_axes:"X: {{x}}  Y series: {{count}}",finalize_text_length:"Characters: {{count}}",finalize_status_level:"Status: {{level}}",finalize_section_style:"Divider: {{style}}",finalize_kpi_target:"Target: {{target}}",finalize_image_url:"Image: {{url}}",finalize_ready:"Preview is ready for saving.",preview_not_renderable_title:"This chart cannot be rendered with the current settings yet.",preview_not_renderable_hint:"Add the required fields (for example axes, values, or grouping) and click Apply."},Bj={title:"Reporting",subtitle:"Build and export multi-page management reports.",new_pack_name:"New Report Package",default_category:"General",category:"Category",new_category:"New category",new_category_placeholder:"Category name (e.g. Management)",manage_categories:"Manage categories",expand_all_packs:"Expand all reports",collapse_all_packs:"Collapse all reports",move_category:"Move to category",move_category_unavailable:"No other category available",rename_category_prompt:"New category name:",category_exists:"A category with this name already exists.",delete_category_confirm:"Delete this category",delete_category_with_packs_confirm:'Delete category "{{category}}" and all {{count}} report packages in it',delete_empty_category:"Delete empty category",delete_with_content:"Delete category and its report packages",default_category_protected:"Default category cannot be deleted",no_categories:"No categories yet.",no_packages_in_category:"No packages in this category yet.",packages:"packages",pages:"Pages",export_batch:"Start Export",export_ppt:"Export PPT",export_html:"Export HTML",export_json:"Export JSON",import_json:"Import JSON",import_overwrite_confirm:'Replace "{{name}}" with the imported definition',import_success:"Report package was imported successfully.",import_failed:"Import failed. Invalid report package JSON.",panel_title:"Reporting Assistant",panel_overview:"Overview",panel_metric_packs:"Packs",panel_metric_pages:"Pages",panel_metric_issues:"Issues",panel_quick_actions:"Quick Actions",panel_action_new_pack:"New pack",panel_action_import_json:"Import JSON",panel_action_expand_all:"Expand all",panel_action_collapse_all:"Collapse all",panel_quality_global:"Quality (Global)",export_failed:"Export failed.",add_page:"Add Page",pack_settings:"Package Settings",pick_content:"Select Content",select_pack:"Please select a package",cover_page:"Cover Page",author:"Author",subtitle_label:"Subtitle",title_label:"Title",logo_url:"Logo URL",upload_logo:"Upload logo",logo_upload_failed:"Logo upload failed.",theme_color:"Theme color",toc:"Table of Contents",no_packages:"No Packages",general:"General",export_options:"Header / Footer",show_header:"Show header",show_footer:"Show footer",header_text:"Header text (optional)",footer_text:"Footer text (optional)",data_as_of:"Data as of",include_audit_appendix:"Include audit appendix (SQL sources)",audit_appendix_title:"Audit Appendix",audit_sql_sources:"SQL Sources",pack_name:"Package",status_info:"Info",status_ok:"OK",status_warning:"Warning",status_critical:"Critical",status_threshold:"Threshold / target note",page_comment:"Page comment (analysis note)",template_none:"No template",template_summary:"Management Summary",template_kpi:"KPI Page",template_detail:"Detail Page",template_summary_threshold:"Top KPIs within plan",template_summary_comment:"Management summary with trends and key highlights.",template_kpi_threshold:"Target >= 95%",template_kpi_comment:"Focused KPI page with target, variance and interpretation.",template_detail_threshold:"Review outliers and exceptions",template_detail_comment:"Detailed analysis page with drilldown context and notes.",quality:"Quality",quality_missing_title:"Missing page title",quality_missing_template:"No template selected",quality_missing_status:"No status set",quality_missing_threshold:"No threshold/target note",quality_missing_comment:"No page comment",quality_missing_data_source:"No data source linked",quality_all_good:"All pages look good.",quality_issues_count:"{{count}} quality issues found.",quality_fix_all:"Fix all",quality_fix:"Fix",quality_row_ok:"No issues",page_options:"Per-Page Options",no_pages:"No pages in this package yet.",page_title_override:"Page title override (optional)",landscape:"Landscape",portrait:"Portrait",preview:"Live Preview",content_page_preview:"Content Page Preview",page_content:"Page content",pack_name_placeholder:"Package Name",page:"Page",generated_on:"Generated on",author_prefix:"Author"},Cj={title:"Settings",subtitle:"Dashboard configuration and notifications",tab_appearance:"General",tab_security:"Security",tab_apps:"Apps",tab_controls:"Controls",tab_inspector:"Inspector",tab_querybuilder:"Widgets",tab_import:"Import",tab_datatable:"Data Table",tab_notifications:"Notifications",tab_about:"About",appearance:"Appearance",appearance_hint:"Customize the dashboard look.",language_panel_title:"Language",language_panel_hint:"Configure app language and visibility of the sidebar language switch.",language:"Language",language_de:"German",language_en:"English",show_sidebar_language_switch:"Show language switch in sidebar",health_link_title:"Diagnostics",health_link_hint:"Open the system health check and diagnostics overview.",health_link_open:"Open Health Check",show_sidebar_system_status:"Show 'System Status' in sidebar",theme_light:"Light",theme_dark:"Dark",theme_system:"System",inspector_title:"Data Inspector",inspector_hint:"Central defaults for Data Inspector behavior.",inspector_autocomplete:"SQL autocomplete",inspector_explain:"Enable explain mode by default",inspector_sql_assist:"Open SQL assist by default",inspector_profiling:"Show data profiling by default",inspector_page_size:"Default page size",inspector_thresholds:"Profiling thresholds",inspector_null_threshold:"Null threshold (%)",inspector_cardinality_threshold:"Cardinality threshold (%)",inspector_sql_safety:"SQL safety",inspector_sql_confirm_without_limit:"Confirm SELECT statements without LIMIT",inspector_sql_max_rows:"Maximum rows returned per SQL run",inspector_reset_title:"Reset",inspector_reset_layout:"Reset layout and views",inspector_reset_sql:"Clear SQL history and templates",inspector_reset_layout_confirm:"Reset Data Inspector layout and saved views",inspector_reset_layout_done:"Data Inspector layout and saved views were reset.",inspector_reset_sql_confirm:"Clear SQL history, favorites and custom templates",inspector_reset_sql_done:"SQL history, favorites and templates were cleared.",sql_workspace_title:"SQL Workspace",sql_workspace_hint:"Default behavior for SQL editor and execution in SQL Workspace.",sql_workspace_autocomplete:"SQL autocomplete",sql_workspace_explain:"Enable explain mode by default",sql_workspace_assist:"Open SQL assistant by default",sql_workspace_sql_safety:"SQL safety",sql_workspace_confirm_without_limit:"Confirm SELECT statements without LIMIT",sql_workspace_max_rows:"Maximum rows returned per SQL run",sql_workspace_reset_title:"Reset",sql_workspace_reset_layout:"Reset SQL Workspace layout",sql_workspace_reset_sql:"Clear SQL history and templates",sql_workspace_reset_layout_confirm:"Reset SQL Workspace layout",sql_workspace_reset_layout_done:"SQL Workspace layout was reset.",sql_workspace_reset_sql_confirm:"Clear SQL history, favorites and custom templates",sql_workspace_reset_sql_done:"SQL history, favorites and templates were cleared.",querybuilder_title:"Widgets",querybuilder_hint:"Defaults for widget creation and SQL preview.",querybuilder_no_tunable_options:"There are currently no additional widgets-specific options required.",reports_title:"Reporting",reports_hint:"Central options for report packages and exports.",reports_no_tunable_options:"There are currently no additional reporting-specific options required.",reports_default_author:"Default author for new packages",reports_default_theme_color:"Default theme color",reports_default_show_header:"Show header by default",reports_default_show_footer:"Show footer by default",reports_default_include_audit:"Enable audit appendix by default",reports_defaults_apply_hint:"These defaults apply to newly created report packages.",worklist_title:"Worklist",worklist_hint:"Central options for the worklist.",worklist_no_tunable_options:"There are currently no additional worklist-specific options required.",worklist_default_view:"Default view on open",worklist_hide_completed:"Hide done/closed items by default",worklist_default_priority:"Default priority on add",worklist_default_due_days:"Default due date in days",worklist_default_due_days_hint:"0 = no automatic due date",import_title:"Import",import_hint:"Default behavior for Excel imports.",backup_hint:"Default behavior for backup and restore.",import_default_mode:"Default import mode",import_auto_save_mappings:"Auto-save mappings",backup_name_pattern:"Backup filename pattern",backup_name_pattern_hint:"Tokens: {date}, {time}, {datetime}, {mode}.",backup_use_saved_location:"Use saved backup folder",backup_use_saved_location_hint:"Default: try the selected backup folder first, then fall back to file picker.",backup_folder:"Backup folder",backup_folder_none:"No folder selected",backup_folder_choose:"Choose folder",backup_folder_not_supported:"Your browser does not support persistent folder access.",backup_folder_select_error:"Folder could not be selected.",health_snapshot_retention_title:"Health snapshot retention",health_snapshot_retention_days:"Delete older than (days)",health_snapshot_keep_latest:"Always keep latest",health_snapshot_retention_hint:"Used by the cleanup action in the Health Check overview.",datatable_title:"Data Table",datatable_hint:"Central display defaults for data tables.",datatable_density:"Row density",datatable_density_normal:"Normal",datatable_density_compact:"Compact",datatable_wrap_cells:"Wrap long cell content",datatable_default_filters:"Show filter row by default",notifications_title:"Notifications",notifications_hint:"Behavior for safety and confirmation prompts.",notifications_confirm_destructive:"Confirm destructive actions",log_level:"Log level",log_level_off:"Off",log_level_error:"Errors only",log_level_warn:"Warnings + errors",log_level_info:"Info + warnings + errors",log_level_debug:"Debug (verbose)",security:"Security",security_hint:"Protect access to the dashboard.",access_restriction_title:"Access Restriction",access_restriction_hint:"Configure lock protection for application access.",enable_pin:"Enable PIN protection",pin_placeholder:"New PIN (min. 4 digits)",pin_error_min:"PIN must be at least 4 digits.",pin_success:"PIN protection enabled.",pin_confirm_remove:"Do you really want to remove PIN protection",pin_active:"PIN protection active",pin_active_hint:"Dashboard is locked on restart",admin_mode:"Admin Mode",admin_mode_hint:"Show system tables (sys_) in selections.",admin_mode_panel_hint:"Control visibility of advanced system structures.",admin_mode_active:"Admin Mode active",user_mode:"User Mode",last_update:"Last update: {{date}}, {{time}}"},Sj={subtitle:"Central management for imports, structures and system maintenance.",tab_import:"Data Import",tab_structure:"Structure & Schema",tab_system:"Maintenance & Backup",smart_import_title:"Create New Table (Smart Import)",smart_import_hint:"Analyzes Excel files and automatically creates matching tables.",or_separator:"OR",append_data_title:"Append Data",append_data_hint:"Import data into an existing table.",select_target_table:"Select target table...",user_tables:"Custom Tables",user_tables_hint:"Manage your own table structures.",new_table:"New Table",no_user_tables:"No custom tables found.",user_views:"Views",user_views_hint:"SQL views available in the local database.",no_user_views:"No views available.",view_type:"VIEW",show_schema:"Show Schema",append_data_short:"Append Data",system_tables:"System Tables (Read-Only)",backup_restore:"Backup & Restore",backup_recommended:"{{count}} unsaved changes. Backup recommended.",encryption_active:"Encryption enabled",encryption_standard:"Standard Backup (Unencrypted)",encryption_active_hint:"File will be protected with a password.",encryption_standard_hint:"File is readable by everyone.",backup_password_placeholder:"Set backup password...",backup_password_error:"Please provide a secure password (min. 4 characters).",save_backup_secure:"Save Protected",save_backup_standard:"Save Backup",backup_saved_success:"Backup was created successfully.",backup_saved_success_details:`Backup was created successfully.
File: {{fileName}}
Location: {{location}}`,backup_saved_location_named:"Backup folder: {{folder}}",backup_saved_location_remembered:"Remembered backup folder",backup_saved_location_downloads:"Browser download folder",backup_save_failed:"Backup could not be created",restore_backup:"Restore Backup",restore_from_saved_location:"From backup folder",restore_confirm:"Warning: This overwrites ALL local data! Continue",restore_invalid:"The backup file is invalid or corrupted.",restore_missing_tables:"The following system tables are missing:",restore_missing_columns:"The following columns are missing in the tables:",restore_success_reload:"Backup successfully validated and imported. The page will now reload.",restore_warning_title:"Compatibility Warning",restore_warning_hint:"The backup seems to be from an older version. Some features might be limited.",restore_encrypted_prompt:"This file seems to be encrypted. Please enter password:",restore_failed:"Decryption failed! Wrong password or corrupted file.",danger_zone:"Danger Zone",danger_zone_hint:"Destructive actions - changes cannot be undone.",clear_reset:"Clear Data (Reset)",clear_reset_hint:"Removes all rows from the selected table but keeps the structure.",clear_btn:"Clear",factory_reset_title:"Factory settings",factory_reset_confirm:"Are you sure All data (including tables, views, and indexes), dashboards, widgets, and local settings will be permanently deleted. This cannot be undone.",factory_reset_prompt:'Please type "RESET" to continue:',factory_reset_success:"Database and local settings were reset to factory defaults. Reloading...",factory_reset_aborted:"Canceled: Wrong input.",factory_reset_btn:"Reset completely",factory_reset_hint:"Deletes the entire database including tables, views, and indexes, resets local settings, and recreates a fresh empty schema at the latest version.",sql_manager_reset_title:"SQL Manager reset",sql_manager_reset_confirm:"Reset SQL Manager All saved SQL statements and favorites will be deleted.",sql_manager_reset_prompt:'Please type "RESET" to continue:',sql_manager_reset_success:"SQL Manager was reset.",sql_manager_reset_aborted:"Canceled: Wrong input.",sql_manager_reset_btn:"Reset SQL Manager",sql_manager_reset_hint:"Deletes all saved SQL statements in the SQL Manager, including favorites and usage counters.",clear_confirm:'Irrevocably delete all data in table "{{name}}"',cleared_success:"Table cleared.",drop_table_title:"Remove Table",drop_table_hint:"Deletes the entire table including structure. Only possible for custom tables.",drop_confirm:'Really delete table "{{name}}"',drop_view_title:"Delete view",drop_view_confirm:'Really delete view "{{name}}"',create_table_title:"New Table",assistant:"Assistant",create_btn:"Create",table_created:"Table created!",schema_not_available:"No schema available",name_label:"Name",columns_label:"Columns",add_column:"+ Column",records_label:"Records ({{name}})",table_meta_rows:"{{count}} rows",table_meta_indexes:"{{count}} indexes",view_invalid:"Invalid view",mappings_saved:"{{count}} Mappings saved",export_mappings:"Export mappings (JSON)",import_mappings:"Import mappings (JSON)",clear_mappings:"Clear all mappings",clear_mappings_confirm:"Are you sure you want to delete ALL saved mappings This cannot be undone.",drop_btn:"Delete",create_index_title:"Create index",create_index_btn:"Create index",index_create_for_table:"Table",index_name:"Index name",index_unique:"Unique index",index_columns:"Columns",index_order:"Column order",index_where_optional:"WHERE (optional)",index_create_name_required:"Please provide an index name.",index_create_columns_required:"Please select at least one column.",index_create_success:"Index created.",indexes_title:"Indexes",indexes_empty:"No indexes available.",indexes_columns:"Columns",smart_import:{step_upload:"Upload",step_config:"Preview & Config",step_import:"Import",upload_label:"Select Excel File",upload_hint:"We analyze the structure automatically.",found_tables:"Found Tables",found_tables_hint:"Select which sheets should be imported and check the names.",sheet_label:"Sheet:",table_label:"Table:",invalid_prefix:"Reserved prefix 'sys_' not allowed.",invalid_sheet:"Invalid",columns_count:"{{count}} columns detected",rows_count:"{{count}} rows",more_columns:"+{{count}} more",import_running:"Importing data...",done_btn:"Done",back_btn:"Back",start_import:"Start Import",error_analyzing:"Error analyzing file.",step_success:"Completed",import_success_title:"Import successful!",import_success_hint:"{{count}} tables have been successfully created and populated.",finish_btn:"Finish"},excel_import:{processing_file:"Processing file...",error_reading:"Error reading file: {{error}}",error_loading:"File could not be loaded: {{error}}",no_config:"No import configuration available.",no_data:"No data found in file.",no_valid_data:"No valid data found to import.",import_failed:"Import failed: {{error}}",success_msg:"Successfully imported {{count}} records.",append:"Add",overwrite:"Overwrite",drop_hint:"Click or drag file here",none_selected:"No table selected"}},Nj={title:"About LiteBI Studio",subtitle:"Information about the project and system",tagline:"The lightweight business intelligence platform directly in your browser.",status_stable:"Stable (Local)",philosophy_title:"Our Philosophy",philosophy_description:"LiteBI Studio was developed with the goal of making data analysis as simple and secure as possible. Unlike traditional BI tools, your data never leaves your browser with LiteBI Studio.",point_privacy_title:"Privacy First",point_privacy_desc:"No server storage, no cloud constraints.",point_speed_title:"Speed",point_speed_desc:"Local processing using SQLite WASM technology.",point_offline_title:"Offline-Ready",point_offline_desc:"Works even without an active internet connection.",tech_stack_title:"Tech Stack",tech_ui_framework:"UI Framework",tech_language:"Language",tech_build_tool:"Build Tool",tech_styling:"Styling",tech_local_database:"Local Database",tech_visualization:"Visualization",tech_i18n:"Internationalization",tech_pdf_export:"PDF Export",tech_icon_system:"Icon System",links_title:"Links",link_github:"GitHub Repository",link_readme:"README",link_changelog:"Changelog",link_docs:"Documentation",link_website:"Website",support_title:"Support",support_text:"Do you have questions or feedback We look forward to your message.",contact_cta:"Contact us",copyright_prefix:" {{year}} LiteBI Studio Project. Released under ",settings_hint:"Learn more about the project, the version and the vision behind LiteBI Studio.",view_info:"Project Information"},Ej={title:"Record Details",navigation:"Navigate",schema_definition:"Show Schema Definition",add_worklist:"Add to worklist",remove_worklist:"Remove from worklist",set_reference:"Set as reference for comparison",clear_reference:"Stop reference mode",deleted_badge:"DELETED",status_label:"Processing Status",status_pending:"Open / New",status_in_progress:"In Progress",status_error:"Error",status_obsolete:"Obsolete",status_done:"Completed (OK)",comment_label:"Remark / Note",comment_placeholder:"Enter your notes or verification results here...",comparison_active:"Comparison active:",differences_relative:"Differences are shown relative to {{id}}.",empty_value:"<empty>",pattern_email:"Email",pattern_uuid:"UUID",pattern_iban:"IBAN",pattern_url:"URL",pattern_date:"Date",suspicious:"Suspicious",close:"Close"},Fj={system_status:{title:"System Status",description:"Platform health status",memory_usage:"Memory Usage",load_time:"Load Time",heap_from:"of {{total}} MB Heap",details:"Details"},data_inspector:{title:"Data Inspector",description:"Direct access to table data",records_total:"Records Total",tables:"Tables",details:"Details"},database_status:{title:"Database Status",description:"Storage usage and statistics",last_backup:"Last Backup",modifications:"Changes",records_since_backup:"Records since backup",data_management:"Data Management",never:"Never"},clock:{title:"Time",description:"Simple clock"},worklist:{title:"Worklist",description:"Statistics of bookmarked records",open_tasks:"Open Tasks",all_done:"All Done",total_entries:"Total Entries",open_list:"Open List"},system_health:{title:"System Diagnostics & Health",tab_overview:"Overview",tab_storage:"Storage",tab_database:"Database",app_environment:"Application Environment",version:"Version",build_date:"Build Date",environment:"Environment",user_agent:"User Agent",cpu_cores:"CPU Cores",device_memory:"Device Memory",memory_limit_hint:"Browser limits display to max. 8GB",used_storage:"Used Storage",max_available:"Max Available (Quota)",quota_used:"{{percent}}% of quota used",no_storage_info:"No storage information available.",overview_db_health:"DB Health",overview_storage_health:"Storage Health",overview_last_backup:"Last Backup",overview_not_available:"Not available",overview_quick_actions:"Quick Actions",overview_action_run_health:"Run Health Check",overview_action_open_storage:"Open Storage",overview_action_backup:"Backup Center",overview_action_inspector:"Open Inspector",overview_action_prune_snapshots:"Delete old diagnostics",overview_snapshot_hint:"Each health check run stores a snapshot that can be evaluated in reporting.",snapshot_cleanup_admin_only:"This action is only available in admin mode.",snapshot_cleanup_confirm:"Delete old diagnostic snapshots? Entries older than {{days}} days will be removed (latest {{keep}} are kept).",snapshot_cleanup_success:"{{count}} old diagnostic snapshot(s) were deleted.",snapshot_cleanup_failed:"Old diagnostic snapshots could not be deleted:",opfs_title:"Origin Private File System (OPFS)",opfs_description:"The database is stored in an isolated, high-performance area of the browser. This storage is persistent but managed by the browser.",analyzing_db:"Analyzing database...",db_size:"Logical DB Size",connected:"Connected",worker_active:"SQLite Worker active",table_stats:"Table Statistics",health_check_title:"Database Health Check",health_status_ok:"Healthy",health_status_warning:"Needs attention",health_status_error:"Critical issues",health_score:"Score: {{score}} / 100",health_meta:"Checks: {{checks}} | Last run: {{timestamp}}",severity_error:"Error",severity_warning:"Warning",severity_info:"Info",recommendation_prefix:"Recommendation:",show_details:"Show details",hide_details:"Hide details",quick_fix:"Quick fix",quick_fix_running:"Applying...",quick_fix_confirm:"Apply suggested index fixes now",quick_fix_success:"Quick fix completed. {{count}} index(es) created or confirmed.",quick_fix_failed:"Quick fix failed:",quick_fix_none:"No automatic fix could be generated for this finding.",client_health_title:"Environment & Settings Health",client_health_meta:"Checks: {{checks}}",client_storage_quota_critical:"Storage quota critically high",client_storage_quota_high:"Storage quota high",client_storage_quota_ok:"Storage quota in healthy range",client_storage_quota_unknown:"Storage quota unavailable",client_local_storage_large:"Local storage usage is high",client_local_storage_ok:"Local storage usage is normal",client_session_storage_large:"Session storage usage is high",client_session_storage_ok:"Session storage usage is normal",client_destructive_confirm_off:"Destructive confirmations disabled",client_destructive_confirm_off_detail:"Delete/reset confirmations are turned off.",client_destructive_confirm_on:"Destructive confirmations enabled",client_destructive_confirm_on_detail:"Safety confirmations are active.",client_log_level_debug:"Debug logging enabled",client_log_level_debug_detail:"Verbose browser logging may affect performance.",client_log_level_ok:"Log level is suitable",client_backup_missing:"No backup timestamp found",client_backup_missing_detail:"Create a backup to improve recovery readiness.",client_backup_exists:"Backup information available",user_tables:"User Tables",system_tables:"System Tables",refresh_diag:"Refresh Diagnostics",diag_failed:"Diagnostics failed",retry:"Retry"}},Tj={common:bj,sidebar:vj,dashboard:wj,worklist:_j,datainspector:yj,querybuilder:kj,reports:Bj,settings:Cj,datasource:Sj,about:Nj,record_detail:Ej,widgets:Fj},Lj={loading:"Laden...",save:"Speichern",cancel:"Abbrechen",delete:"Lschen",edit:"Bearbeiten",search:"Suchen...",no_data:"Keine Daten verfgbar",back:"Zurck",confirm_title:"Sind Sie sicher",success:"Erfolgreich",error:"Fehler",warning:"Warnung",info:"Information",input:"Eingabe",remove:"Entfernen",add:"Hinzufgen",export_pdf:"PDF",exporting:"Exportieren...",deleted:"Gelscht",pinned:"Angeheftet",unpinned:"Gelst",details:"Details",results_count:"{{count}} Ergebnisse",apply:"Sbernehmen",new:"Neu",expand:"Vergrxern",collapse:"Einklappen",all:"Alle",settings:"Einstellungen",done:"Fertig",default:"Standard",rename:"Umbenennen",confirm_delete:"Wirklich lschen",read_only:"Lese-Modus",open_details:"Detailansicht",refresh:"Aktualisieren",show:"Anzeigen",hide:"Ausblenden",open:"Oeffnen",open_in_inspector:"Im Data Inspector oeffnen",stop_sql:"Stop",storage_memory_warning:"Persistenter lokaler Speicher ist aktuell nicht verfuegbar. Die Datenbank laeuft im Arbeitsspeicher und Aenderungen gehen nach einem Neuladen moeglicherweise verloren.",storage_memory_reason:"Grund",name:"Name",description:"Beschreibung",saving:"Speichern...",ok:"OK",not_available:"Nicht verfuegbar"},jj={dashboard:"Sbersicht",worklist:"Arbeitsvorrat",data_inspector:"Data Inspector",sql_workspace:"SQL Workspace",query_builder:"Widgets",datasource:"Datenverwaltung",settings:"Einstellungen",analytics_platform:"Analyse-Plattform",clock:"Status & Uhr",database_status:"Datenbank-Status",system_status:"System-Status",records_count:"{{count}}k Datenstze",reports:"Berichtswesen",about:"Sber"},Uj={title:"Mein Dashboard",subtitle:"Kategorisierte Auswertungen und Kacheln.",add_widget:"Widget hinzufgen",manage_dashboards:"Dashboards verwalten",presentation_mode:"Prsentationsmodus",system_widgets:"System-Kacheln",custom_widgets:"Meine Berichte",default_name:"Mein Dashboard",add_title:"Widget hinzufgen",manage_title:"Dashboards verwalten",new_dashboard:"Neues Dashboard",new_dashboard_title:"Neues Dashboard erstellen",new_dashboard_placeholder:"Dashboard Name (z.B. Kosten fr Kunde X)",rename:"Umbenennen",delete_confirm:"Dashboard lschen",empty_msg:'"{{name}}" ist noch leer',empty_hint:"Fge Kacheln hinzu, um dieses Dashboard anzupassen.",confirm_delete_report:"Mchten Sie diesen Bericht wirklich vom Dashboard entfernen",filters_title:"Globale Dashboard-Filter",filters_subtitle:"Filter, die alle Dashboard-Grafiken gleichzeitig beeinflussen.",add_filter:"Filter hinzufgen",filter_column:"Spalte...",filter_value:"Wert...",no_filters:"Keine aktiven Filter. Klicke auf 'Filter hinzufgen', um das Dashboard einzuschrnken.",op_contains:"enthlt",op_is_null:"ist leer",pin_sidebar:"Zum Men hinzufgen",unpin_sidebar:"Vom Men entfernen",active:"Aktiv",no_reports:"Keine gespeicherten Berichte gefunden.",tools_title:"Dashboard Tools",tools_tab_layout:"Layout",tools_tab_filters:"Filter",tools_layout_hint:"Widgets umsortieren und entfernen, ohne die Uebersicht zu verlassen.",tools_filters_hint:"Globale Dashboard-Filter zentral verwalten.",tools_move_up:"Nach oben",tools_move_down:"Nach unten",tools_clear_filters:"Filter leeren"},Dj={add_dialog_title:"Zum Arbeitsvorrat",add_priority_prompt:"Prioritaet (low, normal, high, critical)",add_due_prompt:"Faelligkeit optional (YYYY-MM-DD), leer lassen fuer keine",subtitle:"Gemerkte Datenstze und Prfergebnisse",filter_all:"Alle",filter_open:"Neu / Offen",filter_in_progress:"In Bearbeitung",filter_done:"Erledigt",filter_closed:"Geschlossen",quick_all:"Alles",quick_overdue:"Ueberfaellig",quick_today:"Heute",quick_high_priority:"Hohe Prioritaet",status_label:"Status",element_label:"Element",table_label:"Tabelle",priority_label:"Prioritaet",due_label:"Faellig",priority_low:"Niedrig",priority_normal:"Normal",priority_high:"Hoch",priority_critical:"Kritisch",context_label:"Kommentar",created_label:"Erstellt am",status_open:"Neu / Offen",status_in_progress:"In Bearbeitung",status_done:"Erledigt",status_closed:"Geschlossen",found_count:"{{count}} Eintrge gefunden",empty_msg:"Keine Eintrge",empty_hint:"Dein Arbeitsvorrat ist aktuell leer oder durch Filter eingeschrnkt.",details_btn:"Details ffnen",remove_btn:"Vom Arbeitsvorrat entfernen",entry_id:"Eintrag #{{id}}",comment_present:"Kommentar",tools_title:"Arbeitsvorrat Tools",tools_tab_focus:"Fokus",tools_tab_batch:"Batch",tools_tab_preview:"Vorschau",focus_open:"Offen",tools_quick_filters:"Schnellfilter",tools_selected_count:"{{count}} ausgewaehlt"},Ij={subtitle:"{{count}} Ergebnisse  {{mode}}",table_mode:"Tabelle",sql_mode:"SQL",output_results:"Ergebnisse",output_explain:"Explain",result_tab_data:"Daten",result_tab_profile:"Profiling",saved_views:"Gespeicherte Ansichten",profiling_settings:"Profiling-Einstellungen",refresh_title:"Daten aktualisieren",export_excel:"Excel Export",search_placeholder:"In sichtbaren Spalten suchen...",auto_limit:"Auto-Limit: {{limit}}",page_size:"Seitengrxe",page_size_value:"{{size}} / Seite",prev_page:"Zurck",next_page:"Weiter",page_info:"Seite {{page}} / {{pages}} ({{total}} Zeilen)",page_number_placeholder:"Seite",go:"Los",sql_placeholder:"SELECT * FROM ...",back_to_dashboard:"Zurueck zum Dashboard",clear_sql:"Leeren",run_sql:"Ausfhren",stop_sql:"Stop",cancel_not_available:"In diesem Tab luft aktuell keine abbrechbare SQL-Abfrage.",limit_confirm_prompt:"Dieses SELECT hat kein LIMIT. Trotzdem ausfuehren Das Ergebnis wird auf {{limit}} Zeilen begrenzt.",limit_applied_notice:"Sicherheitslimit aktiv: Im SQL-Modus werden maximal {{limit}} Zeilen zurueckgegeben.",autocomplete_toggle_title:"SQL-Autocomplete umschalten",autocomplete_on:"Autocomplete an",autocomplete_off:"Autocomplete aus",explain:"Explain",explain_mode:"Abfrage-Ausfhrungsplan anzeigen",explain_title:"Explain Query Plan",explain_hint:"SQLite Ausfhrungsstrategie",explain_empty:"Fhren Sie eine SQL-Abfrage aus, um den Ausfhrungsplan zu sehen.",empty_sql:"SQL-Abfrage eingeben und ausfhren.",sql_error:"SQL Fehler",write_confirm:"Diese SQL-Anweisung kann Daten ndern. Trotzdem ausfhren",templates:"Vorlagen",template_top10:"Top 10",template_count:"Zeilen zhlen",template_nullscan:"Null-Scan",template_duplicates:"Duplikate finden",template_outliers:"Ausreixer finden",recent_queries:"Letzte Abfragen",pick_recent:"Letzte Abfrage whlen...",clear_history:"Verlauf lschen",favorite_queries:"Favorisierte Abfragen",pick_favorite:"Favorisierte Abfrage whlen...",clear_favorites:"Favoriten lschen",pin_query:"Abfrage anheften",unpin_query:"Abfrage lsen",pin:"Anheften",unpin:"Lsen",save_template:"Vorlage speichern",custom_templates:"Eigene Vorlagen",pick_custom_template:"Eigene Vorlage whlen...",rename_template:"Vorlage umbenennen",delete_template:"Vorlage lschen",clear_templates:"Vorlagen lschen",custom_template_prompt:"Name der Vorlage:",custom_template_prompt_update:"Name der Vorlage (bestehende wird aktualisiert):",rename_template_prompt:"Neuer Vorlagenname:",custom_template_overwrite_confirm:'Eine Vorlage mit dem Namen "{{name}}" existiert bereits. Sberschreiben',custom_template_delete_confirm:"Ausgewhlte eigene Vorlage lschen",clear_templates_confirm:"Alle eigenen Vorlagen lschen",sql_assist:"SQL Workspace",sql_manager_tab:"SQL Manager",assistant_tab:"SQL Builder",sql_manager_search_placeholder:"Muster suchen...",sql_manager_no_results:"Keine Treffer",assistant_hint:"SQL per Auswahl von Tabelle, Spalten und optionaler Aggregation erstellen.",assistant_table:"Tabelle",assistant_columns:"Spalten",assistant_select_all:"Alle waehlen",assistant_clear_all:"Leeren",assistant_column_search_placeholder:"Spalten suchen...",assistant_aggregation:"Aggregation",assistant_aggregation_function:"Funktion",assistant_none:"Keine",assistant_aggregation_field:"Aggregationsfeld",assistant_group_by:"Gruppieren nach",assistant_grouping_columns:"Gruppierungsspalten",assistant_grouping_requires_aggregation:"Aggregation aktivieren, um Gruppierung zu konfigurieren.",assistant_metric_alias:"Metrik-Alias",assistant_filter:"Filter",assistant_add_filter:"Filter hinzufuegen",assistant_filter_value:"Wert",assistant_where:"WHERE",assistant_where_connector:"Mit Filtern verknuepfen",assistant_where_placeholder:"status = 'active'",assistant_order_by:"Sortieren nach",assistant_sort_field:"Sortierfeld",assistant_add_sort:"Sortierung hinzufuegen",assistant_auto:"Auto",assistant_direction:"Richtung",assistant_limit:"Limit",assistant_reset:"Zuruecksetzen",assistant_generated_sql:"Generiertes SQL",assistant_replace_editor:"Editor ersetzen",assistant_append:"Anhaengen",profiling_title:"Datenprofil",profiling_subtitle:"Berechnet auf Basis von {{count}} geladenen Zeilen",profiling_issues:"Hinweise: {{count}}",thresholds:"Schwellwerte",null_threshold:"Null",cardinality_threshold:"Kardinalitt",reset_thresholds:"Zurcksetzen",type:"Typ",issues:"Hinweise",type_number:"Zahl",type_text:"Text",type_date:"Datum",type_mixed:"Gemischt",type_unknown:"Unbekannt",issue_high_null:"Hohe Nullquote",issue_mixed_types:"Gemischte Typen",issue_high_cardinality:"Hohe Kardinalitt",issue_suspicious_values:"Auffllige Werte",patterns:"Muster",suspicious_values:"Auffllig",pattern_email:"E-Mail",pattern_uuid:"UUID",pattern_iban:"IBAN",pattern_url:"URL",pattern_date:"Datum",distinct_values:"Unikate",null_rate:"Null-Quote",min:"Min",max:"Max",top_values:"Hufigste Werte",no_profile:"Keine Profildaten verfgbar.",show_profile:"Profil anzeigen",hide_profile:"Profil ausblenden",resize_profile:"Profilbereich in der Hhe anpassen",resize_sql_split:"SQL- und Ergebnisbereich in der Hhe anpassen",select_view:"Ansicht whlen...",save_view:"Ansicht speichern",update_view:"Ansicht aktualisieren",delete_view:"Ansicht lschen",new_view_prompt:"Name der Ansicht:",delete_view_confirm:"Diese gespeicherte Ansicht lschen",table_tools:"Table Tools",table_tools_tab_columns:"Spalten",table_tools_tab_filters:"Filter",table_tools_tab_actions:"Aktionen",table_tools_columns_hint:"Schema einsehen und Sortierung pro Spalte setzen.",table_tools_filters_hint:"Globale Suche und Spaltenfilter verwalten.",table_tools_actions_hint:"Schnellaktionen fuer den aktuellen Tabellenkontext.",table_tools_column:"Spalte",table_tools_filter_value:"Filter",table_tools_filter_apply:"Anwenden",table_tools_toggle_filter_row:"Filterzeile in der Tabelle anzeigen",table_tools_clear_all:"Alles zuruecksetzen",table_tools_no_filters:"Keine aktiven Spaltenfilter",table_tools_global_search:"Globale Suche",table_tools_sort_asc:"Aufsteigend sortieren",table_tools_sort_desc:"Absteigend sortieren",table_tools_export_rows:"Aktuelle Zeilen exportieren",table_tools_open_sql:"Als SQL oeffnen",table_tools_create_index:"Index erstellen",table_tools_field_picker:"Feld-Auswahl",table_tools_selected_count:"{{count}} ausgewaehlt",table_tools_select_all_fields:"Alle waehlen",table_tools_clear_field_selection:"Leeren",table_tools_to_sql_workspace:"In SQL Workspace",table_tools_apply_to_table:"Auf Tabelle anwenden",table_tools_run_selected_sql:"Ausfuehren",table_tools_pick_fields_required:"Bitte mindestens ein Feld waehlen.",index_suggestions_title:"Index-Vorschlaege",index_suggestions_generate:"Erzeugen",index_suggestions_hint:"Basiert auf aktiven Filtern, Sortierung, Kardinalitaet und vorhandenen Indizes.",index_suggestions_empty:"Noch keine Vorschlaege. Erzeugen startet die Analyse dieser Tabelle.",index_suggestions_columns:"Spalten",index_suggestions_apply:"Erstellen",index_suggestion_reason_filter:"In aktivem Tabellenfilter verwendet",index_suggestion_reason_sort:"Als aktive Sortierspalte verwendet",index_suggestion_reason_composite:"Kombinierter Index fuer gemeinsame Filter",index_suggestion_reason_filter_sort:"Kombinierter Index fuer Filter + Sortierung",index_suggestion_reason_cardinality:"Spalte mit hoher Kardinalitaet"},Qj={subtitle:"Widgets auf Basis gespeicherter SQL-Statements erstellen.",new_report:"Neues Widget",save_as_widget:"Als Widget speichern",update_widget:"Aktualisieren",archive:"Archiv",query:"Abfrage",graph:"Grafik",saved_reports:"Gespeicherte Widgets",start_new:"Neu",start_open:"Oeffnen",source_tab_none:"Kein",source_tab_query:"Abfrage auswaehlen",source_tab_widget:"Widget auswaehlen",source_tab_none_hint:"Ohne Datenabfrage oder Widget mit Weiter zum naechsten Schritt gehen.",mode_open_select:"Waehle ein bestehendes Widget aus der Liste.",sql_manager_source:"SQL Manager Quelle",widget_studio_sql_source_hint:"SQL waehlen im SQL-Manager oben",widget_studio_sql_locked_hint:"SQL-Auswahl erfolgt im Startschritt unter Neu.",search_sql_statements:"SQL-Statements durchsuchen...",no_sql_statements:"Keine SQL-Statements gefunden.",new_without_sql_creates_text_widget:"Ohne Auswahl wird beim Weitergehen automatisch ein Text-Widget erstellt.",new_mode_with_query:"Mit Datenabfrage",new_mode_without_query:"Ohne Datenabfrage",new_with_query_hint:"Waehle ein SQL-Statement aus dem SQL-Manager, um ein Abfrage-Widget zu erstellen.",new_without_query_hint:"Ohne Auswahl und mit Klick auf Weiter wird ein neues Text-Widget ohne Datenabfrage erstellt.",search_saved_reports:"Gespeicherte Widgets durchsuchen...",no_saved_reports_filtered:"Keine passenden Widgets gefunden.",editing:"Bearbeiten: {{name}}",visual_builder:"Visueller Builder",direct_editor:"SQL-Ansicht",sql_query:"Ausgewaehltes SQL-Statement",apply:"Anwenden",graph_type:"Grafik-Typ",table:"Tabelle",bar:"Balken",line:"Linie",area:"Flche",pie:"Kreis",kpi:"Kennzahl",composed:"Kombiniert",radar:"Radar",scatter:"Streuung",text:"Text",markdown:"Markdown",status:"Status",section:"Section",kpi_manual:"KPI Manual",image:"Bild",x_axis:"X-Achse",y_axis:"Y-Achsen",label:"Beschriftung",value:"Wert",please_select:"Bitte whlen...",preview:"Vorschau ({{count}})",preview_panel_title:"Vorschau",preview_tab_graphic:"Grafisch",preview_tab_table:"Tabelle",preview_tab_sql:"SQL",preview_graphic_no_query_hint:"Es liegt noch keine Datenabfrage vor. Waehlen Sie unter Quelle eine Abfrage oder nutzen Sie ein Text-, Markdown-, Status-, Section-, KPI-Manual- oder Image-Widget ohne Daten.",preview_graphic_not_selected_hint:"Waehlen Sie einen Grafik-Typ, um eine Vorschau anzuzeigen.",preview_table_no_query_hint:"Tabellarische Ansicht ist nur mit Abfrage verfuegbar.",preview_sql_no_query_hint:"SQL-Ansicht ist nur mit Abfrage verfuegbar.",preview_no_data_source:"Keine Datenquelle ausgewaehlt. Bitte waehlen Sie eine Abfrage oder ein Widget mit Datenquelle.",focus:"Fokus",centered:"Zentriert",no_data_prompt:"Keine Vorschau\\nDatenquelle waehlen",save_title:"Bericht speichern",update_title:"Bericht aktualisieren",archive_name:"Archivierungs-Name",archive_placeholder:"z.B. Monatliche Hardware-Kosten",save_new:"Neu speichern",success_save:"Widget gespeichert!",success_update:"Widget aktualisiert!",error_save:"Fehler beim Speichern: ",confirm_overwrite_widget_name:'Ein Widget mit dem Namen "{{name}}" existiert bereits. Ueberschreiben',error_widget_name_exists:'Ein Widget mit dem Namen "{{name}}" existiert bereits.',labels:"Beschriftungen",label_on:"AN",label_off:"AUS",select_column:"Spalte whlen...",add_y_axis:"Y-Achse hinzufgen",y_axes:"Y-Achsen",pivot:"Pivot-Tabelle",pivot_rows:"Zeilen",pivot_cols:"Spalten",pivot_measures:"Messwerte",pivot_add_row:"Zeile hinzufgen",pivot_add_col:"Spalte hinzufgen",pivot_add_measure:"Messwert hinzufgen",pivot_agg_sum:"Summe",pivot_agg_count:"Anzahl",pivot_agg_avg:"Mittelwert",pivot_agg_min:"Min",pivot_agg_max:"Max",kpi_rules:"KPI-Alerts / Schwellenwerte",add_rule:"Regel hinzufgen",rule_operator:"Operator",rule_value:"Wert",rule_color:"Farbe",hint_run_query_before_export:"Fhren Sie zuerst eine Abfrage aus, um zu exportieren.",hint_run_query_before_save:"Fhren Sie zuerst eine Abfrage aus oder erstellen Sie Textinhalt, um zu speichern.",hint_select_sql_statement_for_widget:"Bitte zuerst ein SQL-Statement im SQL-Manager auswaehlen.",hint_select_sql_statement_before_save:"Bitte ein SQL-Statement aus dem SQL-Manager auswaehlen.",hint_run_query_before_continue:"Bitte die Abfrage zuerst ausfuehren.",hint_configure_visualization_before_continue:"Bitte Visualisierung konfigurieren, um fortzufahren.",visual_text_only_hint:"Ohne ausgewaehlte Abfrage sind nur Text-, Markdown-, Status-, Section-, KPI-Manual- oder Image-Widgets verfuegbar.",hint_save_shortcut:"Shortcut: Strg/Cmd + S",hint_export_shortcut:"Aktuelle Vorschau exportieren",workflow_guided:"Gefhrt",workflow_advanced:"Erweitert",guided_panel:"Gefhrtes Panel",tab_source:"Quelle",tab_visualization:"Visualisierung",tab_widget:"Widget",current_step:"Aktueller Schritt",step_start:"Start",step_source:"Quelle",step_source_run:"Abfrage",step_run:"Ausfhren",step_visualize:"Visualisieren",step_finalize:"Abschliexen",step_help_start:"Whlen Sie, ob Sie eine neue Query erstellen oder eine gespeicherte Query weiterbearbeiten mchten.",step_help_source_run:"Waehlen Sie im Tab 'Quelle' ein SQL-Statement und fuehren Sie es aus, um Daten zu laden.",step_help_visualize:"Konfigurieren Sie im Tab 'Visualisierung' Diagrammtyp, Achsen und Anzeigeoptionen.",step_help_finalize:"Pruefen Sie im Tab 'Widget' das Ergebnis und speichern Sie das Widget.",mode_new_active:"Modus: Neue Query",mode_new_text_active:"Modus: New Text-Widget",mode_editing_active:"Modus: Bearbeitung {{name}}",mode_new_text_without_data:"Neues Widget erstellen (Text - Ohne Daten)",mode_new_query_widget:"Neues Widget erstellen (Abfrage)",mode_widget_edit:"Widget aendern",start_new_query:"Neue Query",start_existing_query:"Bestehende bearbeiten",new_query_card_title:"Neues Abfrage-Widget erstellen...",new_query_card_subtitle:"Neue zu definierende Query",new_query_card_type:"< neuer Typ >",new_text_card_title:"Neues Text-Widget erstellen...",new_text_card_subtitle:"Define a text message",new_text_card_type:"TEXT",new_markdown_card_type:"MARKDOWN",new_status_card_type:"STATUS",new_section_card_type:"SECTION",new_kpi_manual_card_type:"KPI MANUAL",new_image_card_type:"IMAGE",preview_new_widget_title:"Neues Widget ...",next:"Weiter",back:"Zurck",finish:"Fertig",unsaved_changes:"Ungespeicherte nderungen",confirm_discard_changes:"Es gibt ungespeicherte nderungen. Verwerfen und fortfahren",check_start_ready:"Startoption ausgewhlt",check_source_ready:"Quelle ausgewhlt",check_run_ready:"Abfrage ausgefhrt",check_visual_ready:"Visualisierung konfiguriert",check_save_ready:"Bereit zum Speichern",text_content:"Textinhalt",text_placeholder:"Geben Sie hier Ihren Text ein...",markdown_content:"Markdown-Inhalt",markdown_placeholder:`# Titel
Text mit **Fett** und [Link](https://example.com)`,markdown_help:"Unterstuetzt u. a. Ueberschriften, Listen, **Fett**, *Kursiv*, `Code` und Links.",status_level:"Status-Level",status_level_ok:"OK",status_level_info:"Info",status_level_warning:"Warnung",status_level_critical:"Kritisch",status_title:"Titel",status_message:"Nachricht",status_placeholder_title:"Systemstatus",status_placeholder_message:"Alle Kernsysteme laufen stabil.",status_pulse:"Signal-Animation",section_title:"Ueberschrift",section_subtitle:"Untertitel",section_placeholder_title:"Abschnittstitel",section_placeholder_subtitle:"Optionaler Hinweistext",section_align:"Ausrichtung",section_divider:"Trennlinie",section_divider_line:"Linie",section_divider_double:"Doppelt",section_divider_none:"Keine",kpi_title:"Kennzahl-Titel",kpi_value:"Wert",kpi_unit:"Einheit",kpi_target:"Ziel",kpi_trend:"Trend",kpi_trend_up:"Steigend",kpi_trend_flat:"Stabil",kpi_trend_down:"Fallend",kpi_status_on_target:"Im Ziel",kpi_status_near_target:"Nahe am Ziel",kpi_status_below_target:"Unter Ziel",kpi_status_no_compare:"Kein Zielvergleich",kpi_note:"Hinweis",kpi_placeholder_title:"z. B. Verfuegbarkeit",kpi_placeholder_value:"99.9",kpi_placeholder_unit:"%",kpi_placeholder_target:"99.5",kpi_placeholder_note:"Optionaler Kontext zur Kennzahl.",image_url:"Bild-URL",image_alt:"Alternativtext",image_caption:"Bildunterschrift",image_fit:"Darstellung",image_fit_contain:"Einpassen",image_fit_cover:"Ausfuellen",image_placeholder_url:"https://...",image_placeholder_alt:"Beschreibung fuer Screenreader",image_placeholder_caption:"Optional",image_empty_hint:"Bitte eine Bild-URL hinterlegen.",image_load_error_title:"Bild konnte nicht geladen werden.",image_load_error_hint:"Bitte URL, Zugriff und CORS/Hotlink-Schutz pruefen.",text_size:"Textgrxe",text_size_sm:"Klein",text_size_md:"Mittel",text_size_lg:"Grox",text_size_xl:"Sehr grox",text_size_2xl:"2x grox",text_align:"Ausrichtung",text_align_left:"Links",text_align_center:"Zentriert",text_align_right:"Rechts",text_style:"Stil",text_bold:"Fett",text_italic:"Kursiv",text_underline:"Unterstrichen",finalize_mode:"Modus",finalize_source:"Quelle",finalize_chart:"Visualisierung",finalize_axes:"X: {{x}}  Y-Serien: {{count}}",finalize_text_length:"Zeichen: {{count}}",finalize_status_level:"Status: {{level}}",finalize_section_style:"Trennlinie: {{style}}",finalize_kpi_target:"Ziel: {{target}}",finalize_image_url:"Bild: {{url}}",finalize_ready:"Vorschau ist bereit zum Speichern.",preview_not_renderable_title:"Diese Grafik kann mit den aktuellen Angaben noch nicht erstellt werden.",preview_not_renderable_hint:"Ergaenzen Sie die benoetigten Felder (z. B. Achsen, Werte oder Gruppierung) und klicken Sie auf Anwenden."},Oj={title:"Berichtswesen",subtitle:"Erstellen und exportieren Sie mehrseitige Management-Berichte.",new_pack_name:"Neues Berichtspaket",default_category:"General",category:"Kategorie",new_category:"Neue Kategorie",new_category_placeholder:"Kategoriename (z.B. Management)",manage_categories:"Kategorien verwalten",expand_all_packs:"Alle Berichte aufklappen",collapse_all_packs:"Alle Berichte zuklappen",move_category:"In Kategorie verschieben",move_category_unavailable:"Keine weitere Kategorie vorhanden",rename_category_prompt:"Neuer Kategoriename:",category_exists:"Eine Kategorie mit diesem Namen existiert bereits.",delete_category_confirm:"Diese Kategorie lschen",delete_category_with_packs_confirm:'Kategorie "{{category}}" und alle {{count}} enthaltenen Berichtspakete lschen',delete_empty_category:"Leere Kategorie lschen",delete_with_content:"Kategorie und enthaltene Berichtspakete lschen",default_category_protected:"Die Standard-Kategorie kann nicht gelscht werden",no_categories:"Noch keine Kategorien vorhanden.",no_packages_in_category:"In dieser Kategorie sind noch keine Pakete vorhanden.",packages:"Pakete",pages:"Seiten",export_batch:"Export starten",export_ppt:"PPT exportieren",export_html:"HTML exportieren",export_json:"JSON exportieren",import_json:"JSON importieren",import_overwrite_confirm:'"{{name}}" mit der importierten Definition ersetzen',import_success:"Berichtspaket wurde erfolgreich importiert.",import_failed:"Import fehlgeschlagen. Ungueltige Berichtspaket-JSON.",panel_title:"Berichtswesen Assistent",panel_overview:"Sbersicht",panel_metric_packs:"Pakete",panel_metric_pages:"Seiten",panel_metric_issues:"Probleme",panel_quick_actions:"Schnellaktionen",panel_action_new_pack:"Neues Paket",panel_action_import_json:"JSON importieren",panel_action_expand_all:"Alle aufklappen",panel_action_collapse_all:"Alle zuklappen",panel_quality_global:"Qualitt (Global)",export_failed:"Export fehlgeschlagen.",add_page:"Seite hinzufgen",pack_settings:"Paket-Einstellungen",pick_content:"Inhalt auswhlen",select_pack:"Bitte whlen Sie ein Paket",cover_page:"Deckblatt",author:"Autor",subtitle_label:"Untertitel",title_label:"Titel",logo_url:"Logo-URL",upload_logo:"Logo hochladen",logo_upload_failed:"Logo-Upload fehlgeschlagen.",theme_color:"Farbthema",toc:"Inhaltsverzeichnis",no_packages:"Keine Pakete",general:"Allgemein",export_options:"Kopf- / Fuxzeile",show_header:"Kopfzeile anzeigen",show_footer:"Fuxzeile anzeigen",header_text:"Kopfzeilentext (optional)",footer_text:"Fuxzeilentext (optional)",data_as_of:"Datenstand",include_audit_appendix:"Audit-Anhang (SQL-Quellen) einfgen",audit_appendix_title:"Audit-Anhang",audit_sql_sources:"SQL-Quellen",pack_name:"Paket",status_info:"Info",status_ok:"OK",status_warning:"Warnung",status_critical:"Kritisch",status_threshold:"Schwellwert / Ziel-Hinweis",page_comment:"Seitenkommentar (Analysehinweis)",template_none:"Keine Vorlage",template_summary:"Management Summary",template_kpi:"KPI-Seite",template_detail:"Detailseite",template_summary_threshold:"Top-KPIs innerhalb Plan",template_summary_comment:"Management-Zusammenfassung mit Trends und Kernaussagen.",template_kpi_threshold:"Ziel >= 95%",template_kpi_comment:"Fokussierte KPI-Seite mit Ziel, Abweichung und Einordnung.",template_detail_threshold:"Ausreisser und Ausnahmen prfen",template_detail_comment:"Detailanalyse mit Drilldown-Kontext und Kommentaren.",quality:"Qualitt",quality_missing_title:"Fehlender Seitentitel",quality_missing_template:"Keine Vorlage ausgewhlt",quality_missing_status:"Kein Status gesetzt",quality_missing_threshold:"Kein Schwellwert/Ziel-Hinweis",quality_missing_comment:"Kein Seitenkommentar",quality_missing_data_source:"Keine Datenquelle verknpft",quality_all_good:"Alle Seiten sehen gut aus.",quality_issues_count:"{{count}} Qualittsprobleme gefunden.",quality_fix_all:"Alle korrigieren",quality_fix:"Korrigieren",quality_row_ok:"Keine Probleme",page_options:"Seitenoptionen",no_pages:"Noch keine Seiten in diesem Paket.",page_title_override:"Seitentitel-Override (optional)",landscape:"Querformat",portrait:"Hochformat",preview:"Live-Vorschau",content_page_preview:"Inhaltsseite Vorschau",page_content:"Seiteninhalt",pack_name_placeholder:"Paket Name",page:"Seite",generated_on:"Erstellt am",author_prefix:"Erstellt von"},Rj={title:"Einstellungen",subtitle:"Dashboard-Konfiguration und Benachrichtigungen",tab_appearance:"Allgemein",tab_security:"Sicherheit",tab_apps:"Apps",tab_controls:"Controls",tab_inspector:"Inspector",tab_querybuilder:"Widgets",tab_import:"Import",tab_datatable:"Data Table",tab_notifications:"Hinweise",tab_about:"Info",appearance:"Darstellung",appearance_hint:"Passe das Erscheinungsbild des Dashboards an.",language_panel_title:"Sprache",language_panel_hint:"Konfigurieren Sie die App-Sprache und die Sichtbarkeit des Sprachumschalters in der Sidebar.",language:"Sprache",language_de:"Deutsch",language_en:"Englisch",show_sidebar_language_switch:"Sprachumschalter in der Sidebar anzeigen",health_link_title:"Diagnose",health_link_hint:"Oeffnen Sie den System-Health-Check und die Diagnose-Uebersicht.",health_link_open:"Health Check oeffnen",show_sidebar_system_status:"'System-Status' in der Sidebar anzeigen",theme_light:"Hell",theme_dark:"Dunkel",theme_system:"System",inspector_title:"Data Inspector",inspector_hint:"Zentrale Standardwerte fuer den Data Inspector.",inspector_autocomplete:"SQL Autocomplete",inspector_explain:"Explain-Modus standardmaessig",inspector_sql_assist:"SQL Assist standardmaessig offen",inspector_profiling:"Datenprofil standardmaessig anzeigen",inspector_page_size:"Standard Seitengroesse",inspector_thresholds:"Profiling Schwellwerte",inspector_null_threshold:"Null-Schwelle (%)",inspector_cardinality_threshold:"Kardinalitaetsschwelle (%)",inspector_sql_safety:"SQL Sicherheit",inspector_sql_confirm_without_limit:"SELECT ohne LIMIT bestaetigen",inspector_sql_max_rows:"Maximale Zeilen pro SQL-Ausfuehrung",inspector_reset_title:"Zuruecksetzen",inspector_reset_layout:"Layout und Ansichten zuruecksetzen",inspector_reset_sql:"SQL-Verlauf und Vorlagen loeschen",inspector_reset_layout_confirm:"Data-Inspector-Layout und gespeicherte Ansichten zuruecksetzen",inspector_reset_layout_done:"Data-Inspector-Layout und Ansichten wurden zurueckgesetzt.",inspector_reset_sql_confirm:"SQL-Verlauf, Favoriten und eigene Vorlagen loeschen",inspector_reset_sql_done:"SQL-Verlauf, Favoriten und Vorlagen wurden geloescht.",sql_workspace_title:"SQL Workspace",sql_workspace_hint:"Standardwerte fuer SQL-Editor und Ausfuehrung im SQL Workspace.",sql_workspace_autocomplete:"SQL Autocomplete",sql_workspace_explain:"Explain-Modus standardmaessig",sql_workspace_assist:"SQL Assistant standardmaessig offen",sql_workspace_sql_safety:"SQL Sicherheit",sql_workspace_confirm_without_limit:"SELECT ohne LIMIT bestaetigen",sql_workspace_max_rows:"Maximale Zeilen pro SQL-Ausfuehrung",sql_workspace_reset_title:"Zuruecksetzen",sql_workspace_reset_layout:"SQL-Workspace-Layout zuruecksetzen",sql_workspace_reset_sql:"SQL-Verlauf und Vorlagen loeschen",sql_workspace_reset_layout_confirm:"SQL-Workspace-Layout zuruecksetzen",sql_workspace_reset_layout_done:"SQL-Workspace-Layout wurde zurueckgesetzt.",sql_workspace_reset_sql_confirm:"SQL-Verlauf, Favoriten und eigene Vorlagen loeschen",sql_workspace_reset_sql_done:"SQL-Verlauf, Favoriten und Vorlagen wurden geloescht.",querybuilder_title:"Widgets",querybuilder_hint:"Standardwerte fuer die Widget-Erstellung und SQL-Vorschau.",querybuilder_no_tunable_options:"Derzeit sind keine weiteren Widgets-spezifischen Optionen erforderlich.",reports_title:"Berichtswesen",reports_hint:"Zentrale Optionen fuer Berichtspakete und Exporte.",reports_no_tunable_options:"Derzeit sind keine weiteren Berichtswesen-spezifischen Optionen erforderlich.",reports_default_author:"Standard-Autor fuer neue Pakete",reports_default_theme_color:"Standard-Themenfarbe",reports_default_show_header:"Header standardmaessig anzeigen",reports_default_show_footer:"Footer standardmaessig anzeigen",reports_default_include_audit:"Audit-Anhang standardmaessig aktivieren",reports_defaults_apply_hint:"Diese Vorgaben gelten fuer neu erstellte Berichtspakete.",worklist_title:"Arbeitsvorrat",worklist_hint:"Zentrale Optionen fuer den Arbeitsvorrat.",worklist_no_tunable_options:"Derzeit sind keine weiteren Arbeitsvorrat-spezifischen Optionen erforderlich.",worklist_default_view:"Standardansicht beim Oeffnen",worklist_hide_completed:"Erledigte/Geschlossene standardmaessig ausblenden",worklist_default_priority:"Standard-Prioritaet beim Hinzufuegen",worklist_default_due_days:"Standard-Faelligkeit in Tagen",worklist_default_due_days_hint:"0 = keine automatische Faelligkeit",import_title:"Import",import_hint:"Standardverhalten fuer Excel-Importe.",backup_hint:"Standardverhalten fuer Backup und Wiederherstellung.",import_default_mode:"Standard Importmodus",import_auto_save_mappings:"Mappings automatisch speichern",backup_name_pattern:"Backup-Dateinamenmuster",backup_name_pattern_hint:"Platzhalter: {date}, {time}, {datetime}, {mode}.",backup_use_saved_location:"Gemerkten Backup-Ordner verwenden",backup_use_saved_location_hint:"Standard: zuerst den gewhlten Backup-Ordner nutzen, danach auf Dateiauswahl zurckfallen.",backup_folder:"Backup-Ordner",backup_folder_none:"Kein Ordner ausgewhlt",backup_folder_choose:"Ordner whlen",backup_folder_not_supported:"Ihr Browser untersttzt keinen persistenten Ordnerzugriff.",backup_folder_select_error:"Ordner konnte nicht ausgewhlt werden.",health_snapshot_retention_title:"Health-Snapshot-Aufbewahrung",health_snapshot_retention_days:"Loeschen aelter als (Tage)",health_snapshot_keep_latest:"Neueste immer behalten",health_snapshot_retention_hint:"Wird fuer die Bereinigungsaktion in der Health-Check-Uebersicht verwendet.",datatable_title:"Data Table",datatable_hint:"Zentrale Darstellungseinstellungen fuer Tabellen.",datatable_density:"Zeilendichte",datatable_density_normal:"Normal",datatable_density_compact:"Kompakt",datatable_wrap_cells:"Lange Zellinhalte umbrechen",datatable_default_filters:"Filterzeile standardmaessig anzeigen",notifications_title:"Benachrichtigungen",notifications_hint:"Verhalten fuer Sicherheits- und Bestaetigungsdialoge.",notifications_confirm_destructive:"Destruktive Aktionen bestaetigen",log_level:"Log-Level",log_level_off:"Aus",log_level_error:"Nur Fehler",log_level_warn:"Warnungen + Fehler",log_level_info:"Info + Warnungen + Fehler",log_level_debug:"Debug (ausfuehrlich)",security:"Sicherheit",security_hint:"Schtzen Sie den Zugriff auf das Dashboard.",access_restriction_title:"Zugriffsbeschraenkung",access_restriction_hint:"Konfigurieren Sie den Sperrschutz fuer den Zugriff auf die Anwendung.",enable_pin:"PIN-Schutz aktivieren",pin_placeholder:"Neue PIN (min. 4 Stellen)",pin_error_min:"Die PIN muss mindestens 4 Stellen haben.",pin_success:"PIN-Schutz aktiviert.",pin_confirm_remove:"Mchten Sie den PIN-Schutz wirklich entfernen",pin_active:"PIN-Schutz aktiv",pin_active_hint:"Dashboard ist gesperrt beim Neustart",admin_mode:"Admin-Modus",admin_mode_hint:"System-Tabellen (sys_) in der Auswahl anzeigen.",admin_mode_panel_hint:"Steuern Sie die Sichtbarkeit erweiterter Systemstrukturen.",admin_mode_active:"Admin-Modus aktiv",user_mode:"User-Modus",last_update:"Letzte Aktualisierung: {{date}}, {{time}}"},Mj={subtitle:"Zentrale Verwaltung fr Importe, Strukturen und Systemwartung.",tab_import:"Daten-Import",tab_structure:"Struktur & Schema",tab_system:"Wartung & Backup",smart_import_title:"Neue Tabelle erstellen (Smart Import)",smart_import_hint:"Analysiert Excel-Dateien und erstellt automatisch die passenden Tabellen.",or_separator:"ODER",append_data_title:"Daten anfgen",append_data_hint:"Importieren Sie Daten in eine bestehende Tabelle.",select_target_table:"Ziel-Tabelle whlen...",user_tables:"Benutzerdefinierte Tabellen",user_tables_hint:"Verwalten Sie Ihre eigenen Tabellenstrukturen.",new_table:"Neue Tabelle",no_user_tables:"Keine eigenen Tabellen vorhanden.",user_views:"Views",user_views_hint:"SQL-Views in der lokalen Datenbank.",no_user_views:"Keine Views vorhanden.",view_type:"VIEW",show_schema:"Schema anzeigen",append_data_short:"Daten anfgen",system_tables:"System-Tabellen (Read-Only)",backup_restore:"Backup & Restore",backup_recommended:"{{count}} ungesicherte nderungen. Backup empfohlen.",encryption_active:"Verschlsselung aktiviert",encryption_standard:"Standard-Backup (Unverschlsselt)",encryption_active_hint:"Datei wird mit Passwort geschtzt.",encryption_standard_hint:"Datei ist fr jeden lesbar.",backup_password_placeholder:"Passwort fr Backup setzen...",backup_password_error:"Bitte ein sicheres Passwort angeben (min. 4 Zeichen).",save_backup_secure:"Geschtzt speichern",save_backup_standard:"Backup speichern",backup_saved_success:"Backup wurde erfolgreich erstellt.",backup_saved_success_details:`Backup wurde erfolgreich erstellt.
Datei: {{fileName}}
Ablageort: {{location}}`,backup_saved_location_named:"Backup-Ordner: {{folder}}",backup_saved_location_remembered:"Gemerkter Backup-Ordner",backup_saved_location_downloads:"Browser-Downloadordner",backup_save_failed:"Backup konnte nicht erstellt werden",restore_backup:"Backup wiederherstellen",restore_from_saved_location:"Aus Backup-Ordner",restore_confirm:"Achtung: Dies berschreibt ALLE lokalen Daten! Fortfahren",restore_invalid:"Die Backup-Datei ist ungltig oder beschdigt.",restore_missing_tables:"Folgende System-Tabellen fehlen:",restore_missing_columns:"Folgende Spalten fehlen in den Tabellen:",restore_success_reload:"Backup erfolgreich validiert und eingespielt. Die Seite wird nun neu geladen.",restore_warning_title:"Kompatibilitts-Warnung",restore_warning_hint:"Das Backup scheint aus einer lteren Version zu sein. Einige Funktionen knnten eingeschrnkt sein.",restore_encrypted_prompt:"Diese Datei scheint verschlsselt zu sein. Bitte Passwort eingeben:",restore_failed:"Entschlsselung fehlgeschlagen! Falsches Passwort oder beschdigte Datei.",danger_zone:"Gefahrenzone",danger_zone_hint:"Destruktive Aktionen  nderungen knnen nicht rckgngig gemacht werden.",clear_reset:"Daten lschen (Reset)",clear_reset_hint:"Entfernt alle Zeilen aus der gewhlten Tabelle, behlt aber die Struktur bei.",clear_btn:"Leeren",factory_reset_title:"Werkseinstellungen",factory_reset_confirm:"Bist du sicher Alle Daten (inkl. Tabellen, Views und Indizes), Dashboards, Widgets und lokale Einstellungen werden endgueltig geloescht. Dies kann nicht rueckgaengig gemacht werden!",factory_reset_prompt:'Bitte tippe "RESET" ein, um fortzufahren:',factory_reset_success:"Datenbank und lokale Einstellungen wurden auf Werkseinstellungen zurueckgesetzt. Lade neu...",factory_reset_aborted:"Abgebrochen: Falsche Eingabe.",factory_reset_btn:"Komplett zuruecksetzen",factory_reset_hint:"Loescht die gesamte Datenbank inklusive Tabellen, Views und Indizes, setzt lokale Einstellungen zurueck und erstellt ein frisches, leeres Schema der neuesten Version.",sql_manager_reset_title:"SQL Manager zuruecksetzen",sql_manager_reset_confirm:"SQL Manager zuruecksetzen Alle gespeicherten SQL-Statements und Favoriten werden geloescht.",sql_manager_reset_prompt:'Bitte tippe "RESET" ein, um fortzufahren:',sql_manager_reset_success:"SQL Manager wurde zurueckgesetzt.",sql_manager_reset_aborted:"Abgebrochen: Falsche Eingabe.",sql_manager_reset_btn:"SQL Manager zuruecksetzen",sql_manager_reset_hint:"Loescht alle gespeicherten SQL-Statements im SQL Manager inklusive Favoriten und Nutzungszaehlern.",clear_confirm:'Alle Daten in Tabelle "{{name}}" unwiderruflich lschen',cleared_success:"Tabelle geleert.",drop_table_title:"Tabelle entfernen",drop_table_hint:"Lscht die komplette Tabelle inklusive Struktur. Nur fr eigene Tabellen mglich.",drop_confirm:'Tabelle "{{name}}" wirklich lschen',drop_view_title:"View lschen",drop_view_confirm:'View "{{name}}" wirklich lschen',create_table_title:"Neue Tabelle",assistant:"Assistent",create_btn:"Erstellen",table_created:"Tabelle erstellt!",schema_not_available:"Kein Schema verfgbar",name_label:"Name",columns_label:"Spalten",add_column:"+ Spalte",records_label:"Datenstze ({{name}})",table_meta_rows:"{{count}} Eintrge",table_meta_indexes:"{{count}} Indizes",view_invalid:"Defekter View",mappings_saved:"{{count}} Mappings gespeichert",export_mappings:"Mappings exportieren (JSON)",import_mappings:"Mappings importieren (JSON)",clear_mappings:"Alle Mappings lschen",clear_mappings_confirm:"Sind Sie sicher, dass Sie ALLE gespeicherten Mappings lschen mchten Dies kann nicht rckgngig gemacht werden.",drop_btn:"Lschen",create_index_title:"Index erstellen",create_index_btn:"Index erstellen",index_create_for_table:"Tabelle",index_name:"Indexname",index_unique:"Eindeutiger Index (UNIQUE)",index_columns:"Spalten",index_order:"Spaltenreihenfolge",index_where_optional:"WHERE (optional)",index_create_name_required:"Bitte einen Indexnamen angeben.",index_create_columns_required:"Bitte mindestens eine Spalte auswhlen.",index_create_success:"Index erstellt.",indexes_title:"Indizes",indexes_empty:"Keine Indizes vorhanden.",indexes_columns:"Spalten",smart_import:{step_upload:"Upload",step_config:"Vorschau & Config",step_import:"Import",upload_label:"Excel-Datei auswhlen",upload_hint:"Wir analysieren die Struktur automatisch.",found_tables:"Gefundene Tabellen",found_tables_hint:"Whlen Sie aus, welche Bltter importiert werden sollen und prfen Sie die Namen.",sheet_label:"Blatt:",table_label:"Tabelle:",invalid_prefix:"Reserviertes Prfix 'sys_' nicht erlaubt.",invalid_sheet:"Ungltig",columns_count:"{{count}} Spalten erkannt",rows_count:"{{count}} Zeilen",more_columns:"+{{count}} weitere",import_running:"Importiere Daten...",done_btn:"Fertig",back_btn:"Zurck",start_import:"Import Starten",error_analyzing:"Fehler beim Analysieren der Datei.",step_success:"Abgeschlossen",import_success_title:"Import erfolgreich!",import_success_hint:"{{count}} Tabellen wurden erfolgreich angelegt und befllt.",finish_btn:"Abschliexen"},excel_import:{processing_file:"Datei wird verarbeitet...",error_reading:"Fehler beim Lesen der Datei: {{error}}",error_loading:"Datei konnte nicht geladen werden: {{error}}",no_config:"Keine Import-Konfiguration vorhanden.",no_data:"Keine Daten in der Datei gefunden.",no_valid_data:"Keine gltigen Daten zum Importieren gefunden.",import_failed:"Import fehlgeschlagen: {{error}}",success_msg:"Erfolgreich {{count}} Datenstze importiert.",append:"Hinzufgen",overwrite:"Sberschreiben",drop_hint:"Klicken oder Datei hierher ziehen",none_selected:"Keine Tabelle gewhlt"}},Hj={title:"Sber LiteBI Studio",subtitle:"Informationen zum Projekt und System",tagline:"Die leichtgewichtige Business Intelligence Plattform direkt im Browser.",status_stable:"Stabil (Lokal)",philosophy_title:"Unsere Philosophie",philosophy_description:"LiteBI Studio wurde mit dem Ziel entwickelt, Datenanalyse so einfach und sicher wie mglich zu machen. Im Gegensatz zu herkmmlichen BI-Tools verlassen Ihre Daten bei LiteBI Studio niemals Ihren Browser.",point_privacy_title:"Privacy First",point_privacy_desc:"Keine Server-Speicherung, keine Cloud-Zwnge.",point_speed_title:"Speed",point_speed_desc:"Lokale Verarbeitung mittels SQLite WASM Technologie.",point_offline_title:"Offline-Ready",point_offline_desc:"Funktioniert auch ohne aktive Internetverbindung.",tech_stack_title:"Technologie-Stack",tech_ui_framework:"UI-Framework",tech_language:"Sprache",tech_build_tool:"Build-Tool",tech_styling:"Styling",tech_local_database:"Lokale Datenbank",tech_visualization:"Visualisierung",tech_i18n:"Internationalisierung",tech_pdf_export:"PDF-Export",tech_icon_system:"Icon-System",links_title:"Links",link_github:"GitHub Repository",link_readme:"README",link_changelog:"Changelog",link_docs:"Dokumentation",link_website:"Webseite",support_title:"Support",support_text:"Haben Sie Fragen oder Feedback Wir freuen uns ber Ihre Nachricht.",contact_cta:"Kontakt aufnehmen",copyright_prefix:"(c) {{year}} LiteBI Studio Projekt. Freigegeben unter ",settings_hint:"Erfahren Sie mehr ber das Projekt, die Version und die Vision hinter LiteBI Studio.",view_info:"Projekt-Informationen"},Pj={title:"Datensatz-Details",navigation:"Navigieren",schema_definition:"Schema-Definition anzeigen",add_worklist:"Zum Arbeitsvorrat hinzufgen",remove_worklist:"Vom Arbeitsvorrat entfernen",set_reference:"Als Referenz fr Vergleich setzen",clear_reference:"Referenz-Modus beenden",deleted_badge:"GELOESCHT",status_label:"Bearbeitungsstatus",status_pending:"Offen / Neu",status_in_progress:"In Arbeit",status_error:"Fehlerhaft",status_obsolete:"Obsolet",status_done:"Abgeschlossen (OK)",comment_label:"Bemerkung / Notiz",comment_placeholder:"Geben Sie hier Ihre Notizen oder Prfungsergebnisse ein...",comparison_active:"Vergleich aktiv:",differences_relative:"Unterschiede werden relativ zu {{id}} angezeigt.",empty_value:"<leer>",pattern_email:"E-Mail",pattern_uuid:"UUID",pattern_iban:"IBAN",pattern_url:"URL",pattern_date:"Datum",suspicious:"Auffllig",close:"Schliexen"},qj={system_status:{title:"System-Status",description:"Gesundheitsstatus der Plattform",memory_usage:"Speichernutzung",load_time:"Ladezeit",heap_from:"von {{total}} MB Heap",details:"Details"},data_inspector:{title:"Data Inspector",description:"Direkter Zugriff auf Tabellendaten",records_total:"Records Gesamt",tables:"Tabellen",details:"Details"},database_status:{title:"Datenbank-Status",description:"Speichernutzung und Statistiken",last_backup:"Letztes Backup",modifications:"nderungen",records_since_backup:"Datenstze seit Backup",data_management:"Datenverwaltung",never:"Nie"},clock:{title:"Uhrzeit",description:"Einfache Uhr"},worklist:{title:"Arbeitsvorrat",description:"Statistik gemerkter Datenstze",open_tasks:"Offene Aufgaben",all_done:"Alles Erledigt",total_entries:"Gesamteintrge",open_list:"Liste ffnen"},system_health:{title:"System Diagnose & Health",tab_overview:"Sbersicht",tab_storage:"Speicher",tab_database:"Datenbank",app_environment:"Anwendungs-Umgebung",version:"Version",build_date:"Build-Datum",environment:"Umgebung",user_agent:"User Agent",cpu_cores:"CPU Kerne",device_memory:"Gertespeicher",memory_limit_hint:"Browser limitiert Anzeige auf max. 8GB",used_storage:"Belegter Speicher",max_available:"Maximal Verfgbar (Quota)",quota_used:"{{percent}}% des Kontingents genutzt",no_storage_info:"Keine Speicherinformationen verfgbar.",overview_db_health:"DB-Health",overview_storage_health:"Storage-Health",overview_last_backup:"Letztes Backup",overview_not_available:"Nicht verfuegbar",overview_quick_actions:"Quick Actions",overview_action_run_health:"Health Check starten",overview_action_open_storage:"Storage oeffnen",overview_action_backup:"Backup-Zentrum",overview_action_inspector:"Inspector oeffnen",overview_action_prune_snapshots:"Alte Diagnosen loeschen",overview_snapshot_hint:"Bei jedem Health-Check wird ein Snapshot gespeichert und kann im Berichtswesen ausgewertet werden.",snapshot_cleanup_admin_only:"Diese Aktion ist nur im Admin-Modus verfuegbar.",snapshot_cleanup_confirm:"Alte Diagnose-Snapshots loeschen? Es werden Eintraege entfernt, die aelter als {{days}} Tage sind (die neuesten {{keep}} bleiben erhalten).",snapshot_cleanup_success:"{{count}} alte Diagnose-Snapshot(s) wurden geloescht.",snapshot_cleanup_failed:"Alte Diagnose-Snapshots konnten nicht geloescht werden:",opfs_title:"Origin Private File System (OPFS)",opfs_description:"Die Datenbank wird in einem isolierten, hoch-performanten Bereich des Browsers gespeichert. Dieser Speicher ist persistent, wird aber vom Browser verwaltet. Lschen von Browserdaten kann diese Datenbank entfernen.",analyzing_db:"Analysiere Datenbank...",db_size:"Logische DB-Grxe",connected:"Verbunden",worker_active:"SQLite Worker aktiv",table_stats:"Tabellen-Statistik",health_check_title:"Datenbank-Health-Check",health_status_ok:"Gesund",health_status_warning:"Handlungsbedarf",health_status_error:"Kritische Probleme",health_score:"Score: {{score}} / 100",health_meta:"Checks: {{checks}} | Letzter Lauf: {{timestamp}}",severity_error:"Fehler",severity_warning:"Warnung",severity_info:"Info",recommendation_prefix:"Empfehlung:",show_details:"Details anzeigen",hide_details:"Details ausblenden",quick_fix:"Quick Fix",quick_fix_running:"Wird angewendet...",quick_fix_confirm:"Vorgeschlagene Index-Fixes jetzt anwenden",quick_fix_success:"Quick Fix abgeschlossen. {{count}} Index(e) erstellt oder bestaetigt.",quick_fix_failed:"Quick Fix fehlgeschlagen:",quick_fix_none:"Fuer dieses Finding konnte kein automatischer Fix erzeugt werden.",client_health_title:"Umgebungs- & Einstellungs-Health",client_health_meta:"Checks: {{checks}}",client_storage_quota_critical:"Speicherkontingent kritisch hoch",client_storage_quota_high:"Speicherkontingent hoch",client_storage_quota_ok:"Speicherkontingent im gruenen Bereich",client_storage_quota_unknown:"Speicherkontingent nicht verfuegbar",client_local_storage_large:"Local-Storage-Nutzung ist hoch",client_local_storage_ok:"Local-Storage-Nutzung ist normal",client_session_storage_large:"Session-Storage-Nutzung ist hoch",client_session_storage_ok:"Session-Storage-Nutzung ist normal",client_destructive_confirm_off:"Bestaetigungen fuer destruktive Aktionen deaktiviert",client_destructive_confirm_off_detail:"Loeschen/Reset-Bestaetigungen sind ausgeschaltet.",client_destructive_confirm_on:"Bestaetigungen fuer destruktive Aktionen aktiviert",client_destructive_confirm_on_detail:"Sicherheitsbestaetigungen sind aktiv.",client_log_level_debug:"Debug-Logging aktiviert",client_log_level_debug_detail:"Ausfuehrliches Browser-Logging kann Performance kosten.",client_log_level_ok:"Log-Level ist geeignet",client_backup_missing:"Kein Backup-Zeitstempel gefunden",client_backup_missing_detail:"Erstellen Sie ein Backup, um die Wiederherstellbarkeit zu verbessern.",client_backup_exists:"Backup-Information vorhanden",user_tables:"User Tabellen",system_tables:"System Tabellen",refresh_diag:"Diagnose aktualisieren",diag_failed:"Diagnose fehlgeschlagen",retry:"Erneut versuchen"}},Kj={common:Lj,sidebar:jj,dashboard:Uj,worklist:Dj,datainspector:Ij,querybuilder:Qj,reports:Oj,settings:Rj,datasource:Mj,about:Hj,record_detail:Pj,widgets:qj};yl.use(v3).use(YL).init({resources:{en:{translation:Tj},de:{translation:Kj}},fallbackLng:"en",interpolation:{escapeValue:!1},detection:{order:["localStorage","navigator"],caches:["localStorage"]}});const w3="app_log_level",mw="error",Hk={off:0,error:1,warn:2,info:3,debug:4};function zj(e){return e&&(e==="off"||e==="error"||e==="warn"||e==="info"||e==="debug")?e:mw}function Vj(e,t){return Hk[e]>=Hk[t]}function S2(){return typeof window>"u"?mw:zj(window.localStorage.getItem(w3))}function em(e){return Vj(S2(),e)}function UA(e){return{error:(...t)=>{em("error")&&console.error(`[${e}]`,...t)},warn:(...t)=>{em("warn")&&console.warn(`[${e}]`,...t)},info:(...t)=>{em("info")&&console.info(`[${e}]`,...t)},debug:(...t)=>{em("debug")&&console.debug(`[${e}]`,...t)}}}const $1=UA("useLocalStorage");function Jt(e,t){const[r,a]=Z.useState(()=>{if(typeof window>"u")return t;try{const n=window.localStorage.getItem(e);if(n===null)return t;try{return JSON.parse(n)}catch{return n}}catch(n){return $1.error("Initial read error:",n),t}});Z.useEffect(()=>{const n=o=>{if(o.key===e&&o.newValue!==null)try{const c=JSON.parse(o.newValue);a(c),$1.debug(`Synced ${e} from other tab:`,c)}catch{a(o.newValue)}};return window.addEventListener("storage",n),()=>window.removeEventListener("storage",n)},[e]);const s=Z.useCallback(n=>{a(o=>{try{const c=n instanceof Function?n(o):n;if(typeof window<"u"){const u=typeof c=="string"?c:JSON.stringify(c);window.localStorage.setItem(e,u)}return c}catch(c){return $1.error("Write error:",c),o}})},[e]);return[r,s]}const Gu=[{id:"clock",title:"Status & Uhrzeit",component:"ClockComponent",defaultSize:"small"},{id:"data-inspector",title:"Data Inspector",component:"DataInspectorComponent",targetView:"/inspector",defaultSize:"small"},{id:"system-status",title:"System Status",component:"SystemStatusComponent",defaultSize:"small"},{id:"database-status",title:"Datenbank Status",component:"DatabaseStatusComponent",defaultSize:"small"},{id:"worklist",title:"Arbeitsvorrat",component:"WorklistComponent",targetView:"/worklist",defaultSize:"medium"}],X1=UA("DashboardContext"),_3=Z.createContext(void 0),Gj=({children:e})=>{const r=Array.from({length:60},(T,D)=>`slot-${D}`);Gu.forEach((T,D)=>{D<60&&(r[D]=T.id)});const[a,s]=Jt("visibleComponentIds",Gu.map(T=>T.id)),[n,o]=Jt("visibleSidebarComponentIds",Gu.filter(T=>T.targetView).map(T=>T.id)),[c,u]=Jt("componentOrder",r),[f,h]=Jt("isSidebarCollapsed",!1),[g,x]=Jt("litebistudio_last_backup",null),[m,w]=Jt("litebistudio_changes_since_backup",0),v=Wt.useCallback(()=>{x(new Date().toISOString()),w(0)},[x,w]);Wt.useEffect(()=>{const T=D=>{const G=D.detail||{};if(G.type==="restore")X1.debug("DB Restore detected. Resetting count to 0."),w(0),x(new Date().toISOString());else if(G.type==="clear")X1.debug("DB Clear detected. Incrementing count."),w(ne=>ne+1);else{const ne=G.count||1;X1.debug(`DB Change detected (${G.type}, count=${ne}). New count will be based on current state.`),w(H=>H+ne)}};return window.addEventListener("db-changed",T),()=>window.removeEventListener("db-changed",T)},[w,x]),Wt.useEffect(()=>{const D=Gu.map(G=>G.id).filter(G=>!c.includes(G));if(D.length>0){u(ne=>{const H=[...ne];let ee=0;for(let le=0;le<H.length&&ee<D.length;le++)H[le].startsWith("slot-")&&(H[le]=D[ee++]);return[...H,...D.slice(ee)]}),s(ne=>[...new Set([...ne,...D])]);const G=D.filter(ne=>Gu.find(H=>H.id===ne)?.targetView);G.length>0&&o(ne=>[...new Set([...ne,...G])])}},[c,u,a,s,o]);const[B,k]=Wt.useState(()=>!!localStorage.getItem("litebistudio_app_pin")),E=Wt.useCallback(()=>k(!0),[]),S=Wt.useCallback(()=>k(!1),[]),[L,P]=Wt.useState(!1),R=Wt.useCallback(()=>P(T=>!T),[]),[Q,V]=Wt.useState(!1),[U,M]=Jt("litebistudio_admin_mode",!1);return l.jsx(_3.Provider,{value:{visibleComponentIds:a,setVisibleComponentIds:s,visibleSidebarComponentIds:n,setVisibleSidebarComponentIds:o,componentOrder:c,setComponentOrder:u,isSidebarCollapsed:f,setSidebarCollapsed:h,changeCount:m,lastBackup:g,markBackupComplete:v,isLocked:B,lockApp:E,unlockApp:S,isPresentationMode:L,togglePresentationMode:R,isReadOnly:Q,setIsReadOnly:V,isAdminMode:U,setIsAdminMode:M},children:e})},So=()=>{const e=Z.useContext(_3);if(!e)throw new Error("useDashboard must be used within a DashboardProvider");return e};class Wj{cache=new Map;listeners=new Map;set(t,r,a=60*1e3){this.cache.set(t,{data:r,timestamp:Date.now(),ttl:a}),this.notify(t)}get(t){const r=this.cache.get(t);return r?Date.now()-r.timestamp>r.ttl?(this.cache.delete(t),null):r.data:null}invalidate(t){this.cache.delete(t),this.notify(t)}subscribe(t,r){const a=this.listeners.get(t)||new Set;return a.add(r),this.listeners.set(t,a),()=>{const s=this.listeners.get(t);s&&(s.delete(r),s.size===0&&this.listeners.delete(t))}}notify(t){this.listeners.get(t)?.forEach(r=>r())}getStats(){return{size:this.cache.size,keys:Array.from(this.cache.keys())}}}const Eh=new Wj;function $j(e){if(e===null)return"null";if(e===void 0)return"undefined";if(typeof e=="string")return`str:${e}`;if(typeof e=="number")return`num:${e}`;if(typeof e=="boolean")return`bool:${e}`;if(typeof e=="bigint")return`bigint:${e.toString()}`;if(typeof e=="function")return`fn:${e.name||"anonymous"}`;try{return`json:${JSON.stringify(e)}`}catch{return`obj:${String(e)}`}}function Ai(e,t=[],r={}){const{cacheKey:a,ttl:s}=r,[n,o]=Z.useState(()=>a&&Eh.get(a)||null),[c,u]=Z.useState(()=>!(a&&Eh.get(a))),[f,h]=Z.useState(null),[g,x]=Z.useState(0),m=Z.useRef(0),w=t.map($j).join("|"),v=Z.useRef(e);Z.useEffect(()=>{v.current=e});const B=Z.useCallback(()=>{x(k=>k+1)},[]);return Z.useEffect(()=>{let k=!0;const E=++m.current,S=async()=>{try{a&&Eh.get(a)!==null||u(!0);const R=await v.current();k&&E===m.current&&(o(R),h(null),a&&Eh.set(a,R,s))}catch(P){k&&E===m.current&&h(P instanceof Error?P:new Error(String(P)))}finally{k&&E===m.current&&u(!1)}};S();const L=()=>{a&&Eh.invalidate(a),S()};return window.addEventListener("db-updated",L),()=>{k=!1,window.removeEventListener("db-updated",L)}},[w,g,a,s]),{data:n,loading:c,error:f,refresh:B}}function ni(...e){return j8(U8(e))}function O0(e){return e?/^[a-zA-Z0-9_]+$/.test(e):!1}var dx={};dx.version="0.18.5";var y3=1252,Xj=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],N2={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},E2=function(e){Xj.indexOf(e)!=-1&&(y3=N2[0]=e)};function Yj(){E2(1252)}var SA=function(e){E2(e)};function F2(){SA(1200),Yj()}function Pk(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function Jj(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function k3(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Ph=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Jj(e.slice(2)):t==254&&r==255?k3(e.slice(2)):t==65279?e.slice(1):e},tm=function(t){return String.fromCharCode(t)},qk=function(t){return String.fromCharCode(t)},Bp,$u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Cp(e){for(var t="",r=0,a=0,s=0,n=0,o=0,c=0,u=0,f=0;f<e.length;)r=e.charCodeAt(f++),n=r>>2,a=e.charCodeAt(f++),o=(r&3)<<4|a>>4,s=e.charCodeAt(f++),c=(a&15)<<2|s>>6,u=s&63,isNaN(a)?c=u=64:isNaN(s)&&(u=64),t+=$u.charAt(n)+$u.charAt(o)+$u.charAt(c)+$u.charAt(u);return t}function Co(e){var t="",r=0,a=0,s=0,n=0,o=0,c=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)n=$u.indexOf(e.charAt(f++)),o=$u.indexOf(e.charAt(f++)),r=n<<2|o>>4,t+=String.fromCharCode(r),c=$u.indexOf(e.charAt(f++)),a=(o&15)<<4|c>>2,c!==64&&(t+=String.fromCharCode(a)),u=$u.indexOf(e.charAt(f++)),s=(c&3)<<6|u,u!==64&&(t+=String.fromCharCode(s));return t}var la=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Au=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function i0(e){return la?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Kk(e){return la?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var wo=function(t){return la?Au(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function eb(e){if(typeof ArrayBuffer>"u")return wo(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function p0(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Zj(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function T2(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return T2(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var yi=la?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Au(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(n){return Array.isArray(n)?n:[].slice.call(n)}))};function eU(e){for(var t=[],r=0,a=e.length+250,s=i0(e.length+255),n=0;n<e.length;++n){var o=e.charCodeAt(n);if(o<128)s[r++]=o;else if(o<2048)s[r++]=192|o>>6&31,s[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var c=e.charCodeAt(++n)&1023;s[r++]=240|o>>8&7,s[r++]=128|o>>2&63,s[r++]=128|c>>6&15|(o&3)<<4,s[r++]=128|c&63}else s[r++]=224|o>>12&15,s[r++]=128|o>>6&63,s[r++]=128|o&63;r>a&&(t.push(s.slice(0,r)),r=0,s=i0(65535),a=65530)}return t.push(s.slice(0,r)),yi(t)}var _l=/\u0000/g,qh=/[\u0001-\u0006]/g;function vf(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function NA(e,t){var r=""+e;return r.length>=t?r:An("0",t-r.length)+r}function L2(e,t){var r=""+e;return r.length>=t?r:An(" ",t-r.length)+r}function fx(e,t){var r=""+e;return r.length>=t?r:r+An(" ",t-r.length)}function tU(e,t){var r=""+Math.round(e);return r.length>=t?r:An("0",t-r.length)+r}function rU(e,t){var r=""+e;return r.length>=t?r:An("0",t-r.length)+r}var zk=Math.pow(2,32);function qd(e,t){if(e>zk||e<-zk)return tU(e,t);var r=Math.round(e);return rU(r,t)}function hx(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Vk=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Y1=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function aU(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Rr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Gk={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},sU={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function px(e,t,r){for(var a=e<0?-1:1,s=e*a,n=0,o=1,c=0,u=1,f=0,h=0,g=Math.floor(s);f<t&&(g=Math.floor(s),c=g*o+n,h=g*f+u,!(s-g<5e-8));)s=1/(s-g),n=o,o=c,u=f,f=h;if(h>t&&(f>t?(h=u,c=n):(h=f,c=o)),!r)return[0,a*c,h];var x=Math.floor(a*c/h);return[x,a*c-x*h,h]}function R0(e,t,r){if(e>2958465||e<0)return null;var a=e|0,s=Math.floor(86400*(e-a)),n=0,o=[],c={D:a,T:s,u:86400*(e-a)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),t&&t.date1904&&(a+=1462),c.u>.9999&&(c.u=0,++s==86400&&(c.T=s=0,++a,++c.D)),a===60)o=r?[1317,10,29]:[1900,2,29],n=3;else if(a===0)o=r?[1317,8,29]:[1900,1,0],n=6;else{a>60&&--a;var u=new Date(1900,0,1);u.setDate(u.getDate()+a-1),o=[u.getFullYear(),u.getMonth()+1,u.getDate()],n=u.getDay(),a<60&&(n=(n+6)%7),r&&(n=cU(u,o))}return c.y=o[0],c.m=o[1],c.d=o[2],c.S=s%60,s=Math.floor(s/60),c.M=s%60,s=Math.floor(s/60),c.H=s,c.q=n,c}var B3=new Date(1899,11,31,0,0,0),nU=B3.getTime(),iU=new Date(1900,2,1,0,0,0);function C3(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=iU&&(r+=1440*60*1e3),(r-(nU+(e.getTimezoneOffset()-B3.getTimezoneOffset())*6e4))/(1440*60*1e3)}function j2(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function lU(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function oU(e){var t=e<0?12:11,r=j2(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function AU(e){var t=j2(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Sp(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=oU(e):t===10?r=e.toFixed(10).substr(0,12):r=AU(e),j2(lU(r.toUpperCase()))}function X0(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Sp(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return rA(14,C3(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function cU(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function uU(e,t,r,a){var s="",n=0,o=0,c=r.y,u,f=0;switch(e){case 98:c=r.y+543;case 121:switch(t.length){case 1:case 2:u=c%100,f=2;break;default:u=c%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:u=r.m,f=t.length;break;case 3:return Y1[r.m-1][1];case 5:return Y1[r.m-1][0];default:return Y1[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:u=r.d,f=t.length;break;case 3:return Vk[r.q][0];default:return Vk[r.q][1]}break;case 104:switch(t.length){case 1:case 2:u=1+(r.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:u=r.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:u=r.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?NA(r.S,t.length):(a>=2?o=a===3?1e3:100:o=a===1?10:1,n=Math.round(o*(r.S+r.u)),n>=60*o&&(n=0),t==="s"?n===0?"0":""+n/o:(s=NA(n,2+a),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":u=r.D*24+r.H;break;case"[m]":case"[mm]":u=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":u=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:u=c,f=1;break}var h=f>0?NA(u,f):"";return h}function Xu(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var S3=/%/g;function dU(e,t,r){var a=t.replace(S3,""),s=t.length-a.length;return ru(e,a,r*Math.pow(10,2*s))+An("%",s)}function fU(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return ru(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function N3(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+N3(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var n=Math.floor(Math.log(t)*Math.LOG10E)%s;if(n<0&&(n+=s),r=(t/Math.pow(10,n)).toPrecision(a+1+(s+n)%s),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+n):r+="E+"+(o-n);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,u,f,h){return u+f+h.substr(0,(s+n)%s)+"."+h.substr(n)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var E3=/# (\?+)( ?)\/( ?)(\d+)/;function hU(e,t,r){var a=parseInt(e[4],10),s=Math.round(t*a),n=Math.floor(s/a),o=s-n*a,c=a;return r+(n===0?"":""+n)+" "+(o===0?An(" ",e[1].length+1+e[4].length):L2(o,e[1].length)+e[2]+"/"+e[3]+NA(c,e[4].length))}function pU(e,t,r){return r+(t===0?"":""+t)+An(" ",e[1].length+2+e[4].length)}var F3=/^#*0*\.([0#]+)/,T3=/\).*[0#]/,L3=/\(###\) ###\\?-####/;function xl(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Wk(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function $k(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function gU(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function mU(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function qo(e,t,r){if(e.charCodeAt(0)===40&&!t.match(T3)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?qo("n",a,r):"("+qo("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return fU(e,t,r);if(t.indexOf("%")!==-1)return dU(e,t,r);if(t.indexOf("E")!==-1)return N3(t,r);if(t.charCodeAt(0)===36)return"$"+qo(e,t.substr(t.charAt(1)==" "?2:1),r);var s,n,o,c,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+qd(u,t.length);if(t.match(/^[#?]+$/))return s=qd(r,0),s==="0"&&(s=""),s.length>t.length?s:xl(t.substr(0,t.length-s.length))+s;if(n=t.match(E3))return hU(n,u,f);if(t.match(/^#+0+$/))return f+qd(u,t.length-t.indexOf("0"));if(n=t.match(F3))return s=Wk(r,n[1].length).replace(/^([^\.]+)$/,"$1."+xl(n[1])).replace(/\.$/,"."+xl(n[1])).replace(/\.(\d*)$/,function(w,v){return"."+v+An("0",xl(n[1]).length-v.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),n=t.match(/^(0*)\.(#*)$/))return f+Wk(u,n[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=t.match(/^#{1,3},##0(\.?)$/))return f+Xu(qd(u,0));if(n=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+qo(e,t,-r):Xu(""+(Math.floor(r)+gU(r,n[1].length)))+"."+NA($k(r,n[1].length),n[1].length);if(n=t.match(/^#,#*,#0/))return qo(e,t.replace(/^#,#*,/,""),r);if(n=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=vf(qo(e,t.replace(/[\\-]/g,""),r)),o=0,vf(vf(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return o<s.length?s.charAt(o++):w==="0"?"0":""}));if(t.match(L3))return s=qo(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var h="";if(n=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(n[4].length,7),c=px(u,Math.pow(10,o)-1,!1),s=""+f,h=ru("n",n[1],c[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),s+=h+n[2]+"/"+n[3],h=fx(c[2],o),h.length<n[4].length&&(h=xl(n[4].substr(n[4].length-h.length))+h),s+=h,s;if(n=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(n[1].length,n[4].length),7),c=px(u,Math.pow(10,o)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?L2(c[1],o)+n[2]+"/"+n[3]+fx(c[2],o):An(" ",2*o+1+n[2].length+n[3].length));if(n=t.match(/^[#0?]+$/))return s=qd(r,0),t.length<=s.length?s:xl(t.substr(0,t.length-s.length))+s;if(n=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var g=t.indexOf(".")-o,x=t.length-s.length-g;return xl(t.substr(0,g)+s+t.substr(t.length-x))}if(n=t.match(/^00,000\.([#0]*0)$/))return o=$k(r,n[1].length),r<0?"-"+qo(e,t,-r):Xu(mU(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?NA(0,3-w.length):"")+w})+"."+NA(o,n[1].length);switch(t){case"###,##0.00":return qo(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Xu(qd(u,0));return m!=="0"?f+m:"";case"###,###.00":return qo(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return qo(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function xU(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return ru(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function bU(e,t,r){var a=t.replace(S3,""),s=t.length-a.length;return ru(e,a,r*Math.pow(10,2*s))+An("%",s)}function j3(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+j3(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var n=Math.floor(Math.log(t)*Math.LOG10E)%s;if(n<0&&(n+=s),r=(t/Math.pow(10,n)).toPrecision(a+1+(s+n)%s),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+n):r+="E+"+(o-n),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,u,f,h){return u+f+h.substr(0,(s+n)%s)+"."+h.substr(n)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function dc(e,t,r){if(e.charCodeAt(0)===40&&!t.match(T3)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?dc("n",a,r):"("+dc("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return xU(e,t,r);if(t.indexOf("%")!==-1)return bU(e,t,r);if(t.indexOf("E")!==-1)return j3(t,r);if(t.charCodeAt(0)===36)return"$"+dc(e,t.substr(t.charAt(1)==" "?2:1),r);var s,n,o,c,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+NA(u,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:xl(t.substr(0,t.length-s.length))+s;if(n=t.match(E3))return pU(n,u,f);if(t.match(/^#+0+$/))return f+NA(u,t.length-t.indexOf("0"));if(n=t.match(F3))return s=(""+r).replace(/^([^\.]+)$/,"$1."+xl(n[1])).replace(/\.$/,"."+xl(n[1])),s=s.replace(/\.(\d*)$/,function(w,v){return"."+v+An("0",xl(n[1]).length-v.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),n=t.match(/^(0*)\.(#*)$/))return f+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=t.match(/^#{1,3},##0(\.?)$/))return f+Xu(""+u);if(n=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+dc(e,t,-r):Xu(""+r)+"."+An("0",n[1].length);if(n=t.match(/^#,#*,#0/))return dc(e,t.replace(/^#,#*,/,""),r);if(n=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=vf(dc(e,t.replace(/[\\-]/g,""),r)),o=0,vf(vf(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return o<s.length?s.charAt(o++):w==="0"?"0":""}));if(t.match(L3))return s=dc(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var h="";if(n=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(n[4].length,7),c=px(u,Math.pow(10,o)-1,!1),s=""+f,h=ru("n",n[1],c[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),s+=h+n[2]+"/"+n[3],h=fx(c[2],o),h.length<n[4].length&&(h=xl(n[4].substr(n[4].length-h.length))+h),s+=h,s;if(n=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(n[1].length,n[4].length),7),c=px(u,Math.pow(10,o)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?L2(c[1],o)+n[2]+"/"+n[3]+fx(c[2],o):An(" ",2*o+1+n[2].length+n[3].length));if(n=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:xl(t.substr(0,t.length-s.length))+s;if(n=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var g=t.indexOf(".")-o,x=t.length-s.length-g;return xl(t.substr(0,g)+s+t.substr(t.length-x))}if(n=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+dc(e,t,-r):Xu(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?NA(0,3-w.length):"")+w})+"."+NA(0,n[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=Xu(""+u);return m!=="0"?f+m:"";default:if(t.match(/\.[0#?]*$/))return dc(e,t.slice(0,t.lastIndexOf(".")),r)+xl(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ru(e,t,r){return(r|0)===r?dc(e,t,r):qo(e,t,r)}function vU(e){for(var t=[],r=!1,a=0,s=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(s,a-s),s=a+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var U3=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Qf(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":hx(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(U3))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function wU(e,t,r,a){for(var s=[],n="",o=0,c="",u="t",f,h,g,x="H";o<e.length;)switch(c=e.charAt(o)){case"G":if(!hx(e,o))throw new Error("unrecognized character "+c+" in "+e);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(n="";(g=e.charCodeAt(++o))!==34&&o<e.length;)n+=String.fromCharCode(g);s[s.length]={t:"t",v:n},++o;break;case"\\":var m=e.charAt(++o),w=m==="("||m===")"?m:"t";s[s.length]={t:w,v:m},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(f==null&&(f=R0(t,r,e.charAt(o+1)==="2"),f==null))return"";s[s.length]={t:"X",v:e.substr(o,2)},u=c,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=R0(t,r),f==null))return"";for(n=c;++o<e.length&&e.charAt(o).toLowerCase()===c;)n+=c;c==="m"&&u.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=x),s[s.length]={t:c,v:n},u=c;break;case"A":case"a":case"":var v={t:c,v:c};if(f==null&&(f=R0(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(f!=null&&(v.v=f.H>=12?"P":"A"),v.t="T",x="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(f!=null&&(v.v=f.H>=12?"PM":"AM"),v.t="T",o+=5,x="h"):e.substr(o,5).toUpperCase()==="/"?(f!=null&&(v.v=f.H>=12?"":""),v.t="T",o+=5,x="h"):(v.t="t",++o),f==null&&v.t==="T")return"";s[s.length]=v,u=c;break;case"[":for(n=c;e.charAt(o++)!=="]"&&o<e.length;)n+=e.charAt(o);if(n.slice(-1)!=="]")throw'unterminated "[" block: |'+n+"|";if(n.match(U3)){if(f==null&&(f=R0(t,r),f==null))return"";s[s.length]={t:"Z",v:n.toLowerCase()},u=n.charAt(1)}else n.indexOf("$")>-1&&(n=(n.match(/\$([^-\[\]]*)/)||[])[1]||"$",Qf(e)||(s[s.length]={t:"t",v:n}));break;case".":if(f!=null){for(n=c;++o<e.length&&(c=e.charAt(o))==="0";)n+=c;s[s.length]={t:"s",v:n};break}case"0":case"#":for(n=c;++o<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(o))>-1;)n+=c;s[s.length]={t:"n",v:n};break;case"?":for(n=c;e.charAt(++o)===c;)n+=c;s[s.length]={t:c,v:n},u=c;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:a===1?"t":c,v:c},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(n=c;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)n+=e.charAt(o);s[s.length]={t:"D",v:n};break;case" ":s[s.length]={t:c,v:c},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);s[s.length]={t:"t",v:c},++o;break}var B=0,k=0,E;for(o=s.length-1,u="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=x,u="h",B<1&&(B=1);break;case"s":(E=s[o].v.match(/\.0+$/))&&(k=Math.max(k,E[0].length-1)),B<3&&(B=3);case"d":case"y":case"M":case"e":u=s[o].t;break;case"m":u==="s"&&(s[o].t="M",B<2&&(B=2));break;case"X":break;case"Z":B<1&&s[o].v.match(/[Hh]/)&&(B=1),B<2&&s[o].v.match(/[Mm]/)&&(B=2),B<3&&s[o].v.match(/[Ss]/)&&(B=3)}switch(B){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var S="",L;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=uU(s[o].t.charCodeAt(0),s[o].v,f,k),s[o].t="t";break;case"n":case"?":for(L=o+1;s[L]!=null&&((c=s[L].t)==="?"||c==="D"||(c===" "||c==="t")&&s[L+1]!=null&&(s[L+1].t==="?"||s[L+1].t==="t"&&s[L+1].v==="/")||s[o].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(s[L].v==="/"||s[L].v===" "&&s[L+1]!=null&&s[L+1].t=="?"));)s[o].v+=s[L].v,s[L]={v:"",t:";"},++L;S+=s[o].v,o=L-1;break;case"G":s[o].t="t",s[o].v=X0(t,r);break}var P="",R,Q;if(S.length>0){S.charCodeAt(0)==40?(R=t<0&&S.charCodeAt(0)===45?-t:t,Q=ru("n",S,R)):(R=t<0&&a>1?-t:t,Q=ru("n",S,R),R<0&&s[0]&&s[0].t=="t"&&(Q=Q.substr(1),s[0].v="-"+s[0].v)),L=Q.length-1;var V=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){V=o;break}var U=s.length;if(V===s.length&&Q.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(L>=s[o].v.length-1?(L-=s[o].v.length,s[o].v=Q.substr(L+1,s[o].v.length)):L<0?s[o].v="":(s[o].v=Q.substr(0,L+1),L=-1),s[o].t="t",U=o);L>=0&&U<s.length&&(s[U].v=Q.substr(0,L+1)+s[U].v)}else if(V!==s.length&&Q.indexOf("E")===-1){for(L=Q.indexOf(".")-1,o=V;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(h=s[o].v.indexOf(".")>-1&&o===V?s[o].v.indexOf(".")-1:s[o].v.length-1,P=s[o].v.substr(h+1);h>=0;--h)L>=0&&(s[o].v.charAt(h)==="0"||s[o].v.charAt(h)==="#")&&(P=Q.charAt(L--)+P);s[o].v=P,s[o].t="t",U=o}for(L>=0&&U<s.length&&(s[U].v=Q.substr(0,L+1)+s[U].v),L=Q.indexOf(".")+1,o=V;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==V)){for(h=s[o].v.indexOf(".")>-1&&o===V?s[o].v.indexOf(".")+1:0,P=s[o].v.substr(0,h);h<s[o].v.length;++h)L<Q.length&&(P+=Q.charAt(L++));s[o].v=P,s[o].t="t",U=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(R=a>1&&t<0&&o>0&&s[o-1].v==="-"?-t:t,s[o].v=ru(s[o].t,s[o].v,R),s[o].t="t");var M="";for(o=0;o!==s.length;++o)s[o]!=null&&(M+=s[o].v);return M}var Xk=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Yk(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function _U(e,t){var r=vU(e),a=r.length,s=r[a-1].indexOf("@");if(a<4&&s>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var n=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,n];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Xk),c=r[1].match(Xk);return Yk(t,o)?[a,r[0]]:Yk(t,c)?[a,r[1]]:[a,r[o!=null&&c!=null?2:1]]}return[a,n]}function rA(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:Rr)[e],a==null&&(a=r.table&&r.table[Gk[e]]||Rr[Gk[e]]),a==null&&(a=sU[e]||"General");break}if(hx(a,0))return X0(t,r);t instanceof Date&&(t=C3(t,r.date1904));var s=_U(a,t);if(hx(s[1]))return X0(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return wU(s[1],t,r,s[0])}function au(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Rr[r]==null){t<0&&(t=r);continue}if(Rr[r]==e){t=r;break}}t<0&&(t=391)}return Rr[t]=e,t}function tb(e){for(var t=0;t!=392;++t)e[t]!==void 0&&au(e[t],t)}function Of(){Rr=aU()}var yU={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},D3=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function kU(e){var t=typeof e=="number"?Rr[e]:e;return t=t.replace(D3,"(\\d+)"),new RegExp("^"+t+"$")}function BU(e,t,r){var a=-1,s=-1,n=-1,o=-1,c=-1,u=-1;(t.match(D3)||[]).forEach(function(g,x){var m=parseInt(r[x+1],10);switch(g.toLowerCase().charAt(0)){case"y":a=m;break;case"d":n=m;break;case"h":o=m;break;case"s":u=m;break;case"m":o>=0?c=m:s=m;break}}),u>=0&&c==-1&&s>=0&&(c=s,s=-1);var f=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(n>=1?n:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var h=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return o==-1&&c==-1&&u==-1?f:a==-1&&s==-1&&n==-1?h:f+"T"+h}var CU=(function(){var e={};e.version="1.2.0";function t(){for(var Q=0,V=new Array(256),U=0;U!=256;++U)Q=U,Q=Q&1?-306674912^Q>>>1:Q>>>1,Q=Q&1?-306674912^Q>>>1:Q>>>1,Q=Q&1?-306674912^Q>>>1:Q>>>1,Q=Q&1?-306674912^Q>>>1:Q>>>1,Q=Q&1?-306674912^Q>>>1:Q>>>1,Q=Q&1?-306674912^Q>>>1:Q>>>1,Q=Q&1?-306674912^Q>>>1:Q>>>1,Q=Q&1?-306674912^Q>>>1:Q>>>1,V[U]=Q;return typeof Int32Array<"u"?new Int32Array(V):V}var r=t();function a(Q){var V=0,U=0,M=0,T=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(M=0;M!=256;++M)T[M]=Q[M];for(M=0;M!=256;++M)for(U=Q[M],V=256+M;V<4096;V+=256)U=T[V]=U>>>8^Q[U&255];var D=[];for(M=1;M!=16;++M)D[M-1]=typeof Int32Array<"u"?T.subarray(M*256,M*256+256):T.slice(M*256,M*256+256);return D}var s=a(r),n=s[0],o=s[1],c=s[2],u=s[3],f=s[4],h=s[5],g=s[6],x=s[7],m=s[8],w=s[9],v=s[10],B=s[11],k=s[12],E=s[13],S=s[14];function L(Q,V){for(var U=V^-1,M=0,T=Q.length;M<T;)U=U>>>8^r[(U^Q.charCodeAt(M++))&255];return~U}function P(Q,V){for(var U=V^-1,M=Q.length-15,T=0;T<M;)U=S[Q[T++]^U&255]^E[Q[T++]^U>>8&255]^k[Q[T++]^U>>16&255]^B[Q[T++]^U>>>24]^v[Q[T++]]^w[Q[T++]]^m[Q[T++]]^x[Q[T++]]^g[Q[T++]]^h[Q[T++]]^f[Q[T++]]^u[Q[T++]]^c[Q[T++]]^o[Q[T++]]^n[Q[T++]]^r[Q[T++]];for(M+=15;T<M;)U=U>>>8^r[(U^Q[T++])&255];return~U}function R(Q,V){for(var U=V^-1,M=0,T=Q.length,D=0,G=0;M<T;)D=Q.charCodeAt(M++),D<128?U=U>>>8^r[(U^D)&255]:D<2048?(U=U>>>8^r[(U^(192|D>>6&31))&255],U=U>>>8^r[(U^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,G=Q.charCodeAt(M++)&1023,U=U>>>8^r[(U^(240|D>>8&7))&255],U=U>>>8^r[(U^(128|D>>2&63))&255],U=U>>>8^r[(U^(128|G>>6&15|(D&3)<<4))&255],U=U>>>8^r[(U^(128|G&63))&255]):(U=U>>>8^r[(U^(224|D>>12&15))&255],U=U>>>8^r[(U^(128|D>>6&63))&255],U=U>>>8^r[(U^(128|D&63))&255]);return~U}return e.table=r,e.bstr=L,e.buf=P,e.str=R,e})(),Tr=(function(){var t={};t.version="1.2.1";function r(re,ke){for(var me=re.split("/"),be=ke.split("/"),ye=0,O=0,ce=Math.min(me.length,be.length);ye<ce;++ye){if(O=me[ye].length-be[ye].length)return O;if(me[ye]!=be[ye])return me[ye]<be[ye]?-1:1}return me.length-be.length}function a(re){if(re.charAt(re.length-1)=="/")return re.slice(0,-1).indexOf("/")===-1?re:a(re.slice(0,-1));var ke=re.lastIndexOf("/");return ke===-1?re:re.slice(0,ke+1)}function s(re){if(re.charAt(re.length-1)=="/")return s(re.slice(0,-1));var ke=re.lastIndexOf("/");return ke===-1?re:re.slice(ke+1)}function n(re,ke){typeof ke=="string"&&(ke=new Date(ke));var me=ke.getHours();me=me<<6|ke.getMinutes(),me=me<<5|ke.getSeconds()>>>1,re.write_shift(2,me);var be=ke.getFullYear()-1980;be=be<<4|ke.getMonth()+1,be=be<<5|ke.getDate(),re.write_shift(2,be)}function o(re){var ke=re.read_shift(2)&65535,me=re.read_shift(2)&65535,be=new Date,ye=me&31;me>>>=5;var O=me&15;me>>>=4,be.setMilliseconds(0),be.setFullYear(me+1980),be.setMonth(O-1),be.setDate(ye);var ce=ke&31;ke>>>=5;var Fe=ke&63;return ke>>>=6,be.setHours(ke),be.setMinutes(Fe),be.setSeconds(ce<<1),be}function c(re){Ii(re,0);for(var ke={},me=0;re.l<=re.length-4;){var be=re.read_shift(2),ye=re.read_shift(2),O=re.l+ye,ce={};be===21589&&(me=re.read_shift(1),me&1&&(ce.mtime=re.read_shift(4)),ye>5&&(me&2&&(ce.atime=re.read_shift(4)),me&4&&(ce.ctime=re.read_shift(4))),ce.mtime&&(ce.mt=new Date(ce.mtime*1e3))),re.l=O,ke[be]=ce}return ke}var u;function f(){return u||(u={})}function h(re,ke){if(re[0]==80&&re[1]==75)return rr(re,ke);if((re[0]|32)==109&&(re[1]|32)==105)return Bt(re,ke);if(re.length<512)throw new Error("CFB file size "+re.length+" < 512");var me=3,be=512,ye=0,O=0,ce=0,Fe=0,Ne=0,Te=[],Ue=re.slice(0,512);Ii(Ue,0);var tt=g(Ue);switch(me=tt[0],me){case 3:be=512;break;case 4:be=4096;break;case 0:if(tt[1]==0)return rr(re,ke);default:throw new Error("Major Version: Expected 3 or 4 saw "+me)}be!==512&&(Ue=re.slice(0,be),Ii(Ue,28));var _t=re.slice(0,be);x(Ue,me);var Ct=Ue.read_shift(4,"i");if(me===3&&Ct!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ct);Ue.l+=4,ce=Ue.read_shift(4,"i"),Ue.l+=4,Ue.chk("00100000","Mini Stream Cutoff Size: "),Fe=Ue.read_shift(4,"i"),ye=Ue.read_shift(4,"i"),Ne=Ue.read_shift(4,"i"),O=Ue.read_shift(4,"i");for(var yt=-1,Ut=0;Ut<109&&(yt=Ue.read_shift(4,"i"),!(yt<0));++Ut)Te[Ut]=yt;var zt=m(re,be);B(Ne,O,zt,be,Te);var Gr=E(zt,ce,Te,be);Gr[ce].name="!Directory",ye>0&&Fe!==G&&(Gr[Fe].name="!MiniFAT"),Gr[Te[0]].name="!FAT",Gr.fat_addrs=Te,Gr.ssz=be;var Qr={},oa=[],fs=[],Tn=[];S(ce,Gr,zt,oa,ye,Qr,fs,Fe),w(fs,Tn,oa),oa.shift();var Vn={FileIndex:fs,FullPaths:Tn};return ke&&ke.raw&&(Vn.raw={header:_t,sectors:zt}),Vn}function g(re){if(re[re.l]==80&&re[re.l+1]==75)return[0,0];re.chk(ne,"Header Signature: "),re.l+=16;var ke=re.read_shift(2,"u");return[re.read_shift(2,"u"),ke]}function x(re,ke){var me=9;switch(re.l+=2,me=re.read_shift(2)){case 9:if(ke!=3)throw new Error("Sector Shift: Expected 9 saw "+me);break;case 12:if(ke!=4)throw new Error("Sector Shift: Expected 12 saw "+me);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+me)}re.chk("0600","Mini Sector Shift: "),re.chk("000000000000","Reserved: ")}function m(re,ke){for(var me=Math.ceil(re.length/ke)-1,be=[],ye=1;ye<me;++ye)be[ye-1]=re.slice(ye*ke,(ye+1)*ke);return be[me-1]=re.slice(me*ke),be}function w(re,ke,me){for(var be=0,ye=0,O=0,ce=0,Fe=0,Ne=me.length,Te=[],Ue=[];be<Ne;++be)Te[be]=Ue[be]=be,ke[be]=me[be];for(;Fe<Ue.length;++Fe)be=Ue[Fe],ye=re[be].L,O=re[be].R,ce=re[be].C,Te[be]===be&&(ye!==-1&&Te[ye]!==ye&&(Te[be]=Te[ye]),O!==-1&&Te[O]!==O&&(Te[be]=Te[O])),ce!==-1&&(Te[ce]=be),ye!==-1&&be!=Te[be]&&(Te[ye]=Te[be],Ue.lastIndexOf(ye)<Fe&&Ue.push(ye)),O!==-1&&be!=Te[be]&&(Te[O]=Te[be],Ue.lastIndexOf(O)<Fe&&Ue.push(O));for(be=1;be<Ne;++be)Te[be]===be&&(O!==-1&&Te[O]!==O?Te[be]=Te[O]:ye!==-1&&Te[ye]!==ye&&(Te[be]=Te[ye]));for(be=1;be<Ne;++be)if(re[be].type!==0){if(Fe=be,Fe!=Te[Fe])do Fe=Te[Fe],ke[be]=ke[Fe]+"/"+ke[be];while(Fe!==0&&Te[Fe]!==-1&&Fe!=Te[Fe]);Te[be]=-1}for(ke[0]+="/",be=1;be<Ne;++be)re[be].type!==2&&(ke[be]+="/")}function v(re,ke,me){for(var be=re.start,ye=re.size,O=[],ce=be;me&&ye>0&&ce>=0;)O.push(ke.slice(ce*D,ce*D+D)),ye-=D,ce=j0(me,ce*4);return O.length===0?At(0):yi(O).slice(0,re.size)}function B(re,ke,me,be,ye){var O=G;if(re===G){if(ke!==0)throw new Error("DIFAT chain shorter than expected")}else if(re!==-1){var ce=me[re],Fe=(be>>>2)-1;if(!ce)return;for(var Ne=0;Ne<Fe&&(O=j0(ce,Ne*4))!==G;++Ne)ye.push(O);B(j0(ce,be-4),ke-1,me,be,ye)}}function k(re,ke,me,be,ye){var O=[],ce=[];ye||(ye=[]);var Fe=be-1,Ne=0,Te=0;for(Ne=ke;Ne>=0;){ye[Ne]=!0,O[O.length]=Ne,ce.push(re[Ne]);var Ue=me[Math.floor(Ne*4/be)];if(Te=Ne*4&Fe,be<4+Te)throw new Error("FAT boundary crossed: "+Ne+" 4 "+be);if(!re[Ue])break;Ne=j0(re[Ue],Te)}return{nodes:O,data:A4([ce])}}function E(re,ke,me,be){var ye=re.length,O=[],ce=[],Fe=[],Ne=[],Te=be-1,Ue=0,tt=0,_t=0,Ct=0;for(Ue=0;Ue<ye;++Ue)if(Fe=[],_t=Ue+ke,_t>=ye&&(_t-=ye),!ce[_t]){Ne=[];var yt=[];for(tt=_t;tt>=0;){yt[tt]=!0,ce[tt]=!0,Fe[Fe.length]=tt,Ne.push(re[tt]);var Ut=me[Math.floor(tt*4/be)];if(Ct=tt*4&Te,be<4+Ct)throw new Error("FAT boundary crossed: "+tt+" 4 "+be);if(!re[Ut]||(tt=j0(re[Ut],Ct),yt[tt]))break}O[_t]={nodes:Fe,data:A4([Ne])}}return O}function S(re,ke,me,be,ye,O,ce,Fe){for(var Ne=0,Te=be.length?2:0,Ue=ke[re].data,tt=0,_t=0,Ct;tt<Ue.length;tt+=128){var yt=Ue.slice(tt,tt+128);Ii(yt,64),_t=yt.read_shift(2),Ct=M2(yt,0,_t-Te),be.push(Ct);var Ut={name:Ct,type:yt.read_shift(1),color:yt.read_shift(1),L:yt.read_shift(4,"i"),R:yt.read_shift(4,"i"),C:yt.read_shift(4,"i"),clsid:yt.read_shift(16),state:yt.read_shift(4,"i"),start:0,size:0},zt=yt.read_shift(2)+yt.read_shift(2)+yt.read_shift(2)+yt.read_shift(2);zt!==0&&(Ut.ct=L(yt,yt.l-8));var Gr=yt.read_shift(2)+yt.read_shift(2)+yt.read_shift(2)+yt.read_shift(2);Gr!==0&&(Ut.mt=L(yt,yt.l-8)),Ut.start=yt.read_shift(4,"i"),Ut.size=yt.read_shift(4,"i"),Ut.size<0&&Ut.start<0&&(Ut.size=Ut.type=0,Ut.start=G,Ut.name=""),Ut.type===5?(Ne=Ut.start,ye>0&&Ne!==G&&(ke[Ne].name="!StreamData")):Ut.size>=4096?(Ut.storage="fat",ke[Ut.start]===void 0&&(ke[Ut.start]=k(me,Ut.start,ke.fat_addrs,ke.ssz)),ke[Ut.start].name=Ut.name,Ut.content=ke[Ut.start].data.slice(0,Ut.size)):(Ut.storage="minifat",Ut.size<0?Ut.size=0:Ne!==G&&Ut.start!==G&&ke[Ne]&&(Ut.content=v(Ut,ke[Ne].data,(ke[Fe]||{}).data))),Ut.content&&Ii(Ut.content,0),O[Ct]=Ut,ce.push(Ut)}}function L(re,ke){return new Date((vo(re,ke+4)/1e7*Math.pow(2,32)+vo(re,ke)/1e7-11644473600)*1e3)}function P(re,ke){return f(),h(u.readFileSync(re),ke)}function R(re,ke){var me=ke&&ke.type;switch(me||la&&Buffer.isBuffer(re)&&(me="buffer"),me||"base64"){case"file":return P(re,ke);case"base64":return h(wo(Co(re)),ke);case"binary":return h(wo(re),ke)}return h(re,ke)}function Q(re,ke){var me=ke||{},be=me.root||"Root Entry";if(re.FullPaths||(re.FullPaths=[]),re.FileIndex||(re.FileIndex=[]),re.FullPaths.length!==re.FileIndex.length)throw new Error("inconsistent CFB structure");re.FullPaths.length===0&&(re.FullPaths[0]=be+"/",re.FileIndex[0]={name:be,type:5}),me.CLSID&&(re.FileIndex[0].clsid=me.CLSID),V(re)}function V(re){var ke="Sh33tJ5";if(!Tr.find(re,"/"+ke)){var me=At(4);me[0]=55,me[1]=me[3]=50,me[2]=54,re.FileIndex.push({name:ke,type:2,content:me,size:4,L:69,R:69,C:69}),re.FullPaths.push(re.FullPaths[0]+ke),U(re)}}function U(re,ke){Q(re);for(var me=!1,be=!1,ye=re.FullPaths.length-1;ye>=0;--ye){var O=re.FileIndex[ye];switch(O.type){case 0:be?me=!0:(re.FileIndex.pop(),re.FullPaths.pop());break;case 1:case 2:case 5:be=!0,isNaN(O.R*O.L*O.C)&&(me=!0),O.R>-1&&O.L>-1&&O.R==O.L&&(me=!0);break;default:me=!0;break}}if(!(!me&&!ke)){var ce=new Date(1987,1,19),Fe=0,Ne=Object.create?Object.create(null):{},Te=[];for(ye=0;ye<re.FullPaths.length;++ye)Ne[re.FullPaths[ye]]=!0,re.FileIndex[ye].type!==0&&Te.push([re.FullPaths[ye],re.FileIndex[ye]]);for(ye=0;ye<Te.length;++ye){var Ue=a(Te[ye][0]);be=Ne[Ue],be||(Te.push([Ue,{name:s(Ue).replace("/",""),type:1,clsid:ee,ct:ce,mt:ce,content:null}]),Ne[Ue]=!0)}for(Te.sort(function(Ct,yt){return r(Ct[0],yt[0])}),re.FullPaths=[],re.FileIndex=[],ye=0;ye<Te.length;++ye)re.FullPaths[ye]=Te[ye][0],re.FileIndex[ye]=Te[ye][1];for(ye=0;ye<Te.length;++ye){var tt=re.FileIndex[ye],_t=re.FullPaths[ye];if(tt.name=s(_t).replace("/",""),tt.L=tt.R=tt.C=-(tt.color=1),tt.size=tt.content?tt.content.length:0,tt.start=0,tt.clsid=tt.clsid||ee,ye===0)tt.C=Te.length>1?1:-1,tt.size=0,tt.type=5;else if(_t.slice(-1)=="/"){for(Fe=ye+1;Fe<Te.length&&a(re.FullPaths[Fe])!=_t;++Fe);for(tt.C=Fe>=Te.length?-1:Fe,Fe=ye+1;Fe<Te.length&&a(re.FullPaths[Fe])!=a(_t);++Fe);tt.R=Fe>=Te.length?-1:Fe,tt.type=1}else a(re.FullPaths[ye+1]||"")==a(_t)&&(tt.R=ye+1),tt.type=2}}}function M(re,ke){var me=ke||{};if(me.fileType=="mad")return Yt(re,me);if(U(re),me.fileType==="zip")return Kt(re,me);var be=(function(Ct){for(var yt=0,Ut=0,zt=0;zt<Ct.FileIndex.length;++zt){var Gr=Ct.FileIndex[zt];if(Gr.content){var Qr=Gr.content.length;Qr>0&&(Qr<4096?yt+=Qr+63>>6:Ut+=Qr+511>>9)}}for(var oa=Ct.FullPaths.length+3>>2,fs=yt+7>>3,Tn=yt+127>>7,Vn=fs+Ut+oa+Tn,ve=Vn+127>>7,it=ve<=109?0:Math.ceil((ve-109)/127);Vn+ve+it+127>>7>ve;)it=++ve<=109?0:Math.ceil((ve-109)/127);var St=[1,it,ve,Tn,oa,Ut,yt,0];return Ct.FileIndex[0].size=yt<<6,St[7]=(Ct.FileIndex[0].start=St[0]+St[1]+St[2]+St[3]+St[4]+St[5])+(St[6]+7>>3),St})(re),ye=At(be[7]<<9),O=0,ce=0;{for(O=0;O<8;++O)ye.write_shift(1,H[O]);for(O=0;O<8;++O)ye.write_shift(2,0);for(ye.write_shift(2,62),ye.write_shift(2,3),ye.write_shift(2,65534),ye.write_shift(2,9),ye.write_shift(2,6),O=0;O<3;++O)ye.write_shift(2,0);for(ye.write_shift(4,0),ye.write_shift(4,be[2]),ye.write_shift(4,be[0]+be[1]+be[2]+be[3]-1),ye.write_shift(4,0),ye.write_shift(4,4096),ye.write_shift(4,be[3]?be[0]+be[1]+be[2]-1:G),ye.write_shift(4,be[3]),ye.write_shift(-4,be[1]?be[0]-1:G),ye.write_shift(4,be[1]),O=0;O<109;++O)ye.write_shift(-4,O<be[2]?be[1]+O:-1)}if(be[1])for(ce=0;ce<be[1];++ce){for(;O<236+ce*127;++O)ye.write_shift(-4,O<be[2]?be[1]+O:-1);ye.write_shift(-4,ce===be[1]-1?G:ce+1)}var Fe=function(Ct){for(ce+=Ct;O<ce-1;++O)ye.write_shift(-4,O+1);Ct&&(++O,ye.write_shift(-4,G))};for(ce=O=0,ce+=be[1];O<ce;++O)ye.write_shift(-4,le.DIFSECT);for(ce+=be[2];O<ce;++O)ye.write_shift(-4,le.FATSECT);Fe(be[3]),Fe(be[4]);for(var Ne=0,Te=0,Ue=re.FileIndex[0];Ne<re.FileIndex.length;++Ne)Ue=re.FileIndex[Ne],Ue.content&&(Te=Ue.content.length,!(Te<4096)&&(Ue.start=ce,Fe(Te+511>>9)));for(Fe(be[6]+7>>3);ye.l&511;)ye.write_shift(-4,le.ENDOFCHAIN);for(ce=O=0,Ne=0;Ne<re.FileIndex.length;++Ne)Ue=re.FileIndex[Ne],Ue.content&&(Te=Ue.content.length,!(!Te||Te>=4096)&&(Ue.start=ce,Fe(Te+63>>6)));for(;ye.l&511;)ye.write_shift(-4,le.ENDOFCHAIN);for(O=0;O<be[4]<<2;++O){var tt=re.FullPaths[O];if(!tt||tt.length===0){for(Ne=0;Ne<17;++Ne)ye.write_shift(4,0);for(Ne=0;Ne<3;++Ne)ye.write_shift(4,-1);for(Ne=0;Ne<12;++Ne)ye.write_shift(4,0);continue}Ue=re.FileIndex[O],O===0&&(Ue.start=Ue.size?Ue.start-1:G);var _t=O===0&&me.root||Ue.name;if(Te=2*(_t.length+1),ye.write_shift(64,_t,"utf16le"),ye.write_shift(2,Te),ye.write_shift(1,Ue.type),ye.write_shift(1,Ue.color),ye.write_shift(-4,Ue.L),ye.write_shift(-4,Ue.R),ye.write_shift(-4,Ue.C),Ue.clsid)ye.write_shift(16,Ue.clsid,"hex");else for(Ne=0;Ne<4;++Ne)ye.write_shift(4,0);ye.write_shift(4,Ue.state||0),ye.write_shift(4,0),ye.write_shift(4,0),ye.write_shift(4,0),ye.write_shift(4,0),ye.write_shift(4,Ue.start),ye.write_shift(4,Ue.size),ye.write_shift(4,0)}for(O=1;O<re.FileIndex.length;++O)if(Ue=re.FileIndex[O],Ue.size>=4096)if(ye.l=Ue.start+1<<9,la&&Buffer.isBuffer(Ue.content))Ue.content.copy(ye,ye.l,0,Ue.size),ye.l+=Ue.size+511&-512;else{for(Ne=0;Ne<Ue.size;++Ne)ye.write_shift(1,Ue.content[Ne]);for(;Ne&511;++Ne)ye.write_shift(1,0)}for(O=1;O<re.FileIndex.length;++O)if(Ue=re.FileIndex[O],Ue.size>0&&Ue.size<4096)if(la&&Buffer.isBuffer(Ue.content))Ue.content.copy(ye,ye.l,0,Ue.size),ye.l+=Ue.size+63&-64;else{for(Ne=0;Ne<Ue.size;++Ne)ye.write_shift(1,Ue.content[Ne]);for(;Ne&63;++Ne)ye.write_shift(1,0)}if(la)ye.l=ye.length;else for(;ye.l<ye.length;)ye.write_shift(1,0);return ye}function T(re,ke){var me=re.FullPaths.map(function(Ne){return Ne.toUpperCase()}),be=me.map(function(Ne){var Te=Ne.split("/");return Te[Te.length-(Ne.slice(-1)=="/"?2:1)]}),ye=!1;ke.charCodeAt(0)===47?(ye=!0,ke=me[0].slice(0,-1)+ke):ye=ke.indexOf("/")!==-1;var O=ke.toUpperCase(),ce=ye===!0?me.indexOf(O):be.indexOf(O);if(ce!==-1)return re.FileIndex[ce];var Fe=!O.match(qh);for(O=O.replace(_l,""),Fe&&(O=O.replace(qh,"!")),ce=0;ce<me.length;++ce)if((Fe?me[ce].replace(qh,"!"):me[ce]).replace(_l,"")==O||(Fe?be[ce].replace(qh,"!"):be[ce]).replace(_l,"")==O)return re.FileIndex[ce];return null}var D=64,G=-2,ne="d0cf11e0a1b11ae1",H=[208,207,17,224,161,177,26,225],ee="00000000000000000000000000000000",le={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:G,FREESECT:-1,HEADER_SIGNATURE:ne,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ee,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function pe(re,ke,me){f();var be=M(re,me);u.writeFileSync(ke,be)}function te(re){for(var ke=new Array(re.length),me=0;me<re.length;++me)ke[me]=String.fromCharCode(re[me]);return ke.join("")}function Le(re,ke){var me=M(re,ke);switch(ke&&ke.type||"buffer"){case"file":return f(),u.writeFileSync(ke.filename,me),me;case"binary":return typeof me=="string"?me:te(me);case"base64":return Cp(typeof me=="string"?me:te(me));case"buffer":if(la)return Buffer.isBuffer(me)?me:Au(me);case"array":return typeof me=="string"?wo(me):me}return me}var je;function F(re){try{var ke=re.InflateRaw,me=new ke;if(me._processChunk(new Uint8Array([3,0]),me._finishFlushFlag),me.bytesRead)je=re;else throw new Error("zlib does not expose bytesRead")}catch(be){console.error("cannot use native zlib: "+(be.message||be))}}function K(re,ke){if(!je)return kr(re,ke);var me=je.InflateRaw,be=new me,ye=be._processChunk(re.slice(re.l),be._finishFlushFlag);return re.l+=be.bytesRead,ye}function I(re){return je?je.deflateRawSync(re):Nt(re)}var q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Y=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function de(re){var ke=(re<<1|re<<11)&139536|(re<<5|re<<15)&558144;return(ke>>16|ke>>8|ke)&255}for(var ue=typeof Uint8Array<"u",we=ue?new Uint8Array(256):[],Ie=0;Ie<256;++Ie)we[Ie]=de(Ie);function Ae(re,ke){var me=we[re&255];return ke<=8?me>>>8-ke:(me=me<<8|we[re>>8&255],ke<=16?me>>>16-ke:(me=me<<8|we[re>>16&255],me>>>24-ke))}function oe(re,ke){var me=ke&7,be=ke>>>3;return(re[be]|(me<=6?0:re[be+1]<<8))>>>me&3}function He(re,ke){var me=ke&7,be=ke>>>3;return(re[be]|(me<=5?0:re[be+1]<<8))>>>me&7}function se(re,ke){var me=ke&7,be=ke>>>3;return(re[be]|(me<=4?0:re[be+1]<<8))>>>me&15}function qe(re,ke){var me=ke&7,be=ke>>>3;return(re[be]|(me<=3?0:re[be+1]<<8))>>>me&31}function Ye(re,ke){var me=ke&7,be=ke>>>3;return(re[be]|(me<=1?0:re[be+1]<<8))>>>me&127}function at(re,ke,me){var be=ke&7,ye=ke>>>3,O=(1<<me)-1,ce=re[ye]>>>be;return me<8-be||(ce|=re[ye+1]<<8-be,me<16-be)||(ce|=re[ye+2]<<16-be,me<24-be)||(ce|=re[ye+3]<<24-be),ce&O}function Ge(re,ke,me){var be=ke&7,ye=ke>>>3;return be<=5?re[ye]|=(me&7)<<be:(re[ye]|=me<<be&255,re[ye+1]=(me&7)>>8-be),ke+3}function pt(re,ke,me){var be=ke&7,ye=ke>>>3;return me=(me&1)<<be,re[ye]|=me,ke+1}function nt(re,ke,me){var be=ke&7,ye=ke>>>3;return me<<=be,re[ye]|=me&255,me>>>=8,re[ye+1]=me,ke+8}function Dt(re,ke,me){var be=ke&7,ye=ke>>>3;return me<<=be,re[ye]|=me&255,me>>>=8,re[ye+1]=me&255,re[ye+2]=me>>>8,ke+16}function It(re,ke){var me=re.length,be=2*me>ke?2*me:ke+5,ye=0;if(me>=ke)return re;if(la){var O=Kk(be);if(re.copy)re.copy(O);else for(;ye<re.length;++ye)O[ye]=re[ye];return O}else if(ue){var ce=new Uint8Array(be);if(ce.set)ce.set(re);else for(;ye<me;++ye)ce[ye]=re[ye];return ce}return re.length=be,re}function Ot(re){for(var ke=new Array(re),me=0;me<re;++me)ke[me]=0;return ke}function sr(re,ke,me){var be=1,ye=0,O=0,ce=0,Fe=0,Ne=re.length,Te=ue?new Uint16Array(32):Ot(32);for(O=0;O<32;++O)Te[O]=0;for(O=Ne;O<me;++O)re[O]=0;Ne=re.length;var Ue=ue?new Uint16Array(Ne):Ot(Ne);for(O=0;O<Ne;++O)Te[ye=re[O]]++,be<ye&&(be=ye),Ue[O]=0;for(Te[0]=0,O=1;O<=be;++O)Te[O+16]=Fe=Fe+Te[O-1]<<1;for(O=0;O<Ne;++O)Fe=re[O],Fe!=0&&(Ue[O]=Te[Fe+16]++);var tt=0;for(O=0;O<Ne;++O)if(tt=re[O],tt!=0)for(Fe=Ae(Ue[O],be)>>be-tt,ce=(1<<be+4-tt)-1;ce>=0;--ce)ke[Fe|ce<<tt]=tt&15|O<<4;return be}var er=ue?new Uint16Array(512):Ot(512),cr=ue?new Uint16Array(32):Ot(32);if(!ue){for(var Vt=0;Vt<512;++Vt)er[Vt]=0;for(Vt=0;Vt<32;++Vt)cr[Vt]=0}(function(){for(var re=[],ke=0;ke<32;ke++)re.push(5);sr(re,cr,32);var me=[];for(ke=0;ke<=143;ke++)me.push(8);for(;ke<=255;ke++)me.push(9);for(;ke<=279;ke++)me.push(7);for(;ke<=287;ke++)me.push(8);sr(me,er,288)})();var mt=(function(){for(var ke=ue?new Uint8Array(32768):[],me=0,be=0;me<Y.length-1;++me)for(;be<Y[me+1];++be)ke[be]=me;for(;be<32768;++be)ke[be]=29;var ye=ue?new Uint8Array(259):[];for(me=0,be=0;me<J.length-1;++me)for(;be<J[me+1];++be)ye[be]=me;function O(Fe,Ne){for(var Te=0;Te<Fe.length;){var Ue=Math.min(65535,Fe.length-Te),tt=Te+Ue==Fe.length;for(Ne.write_shift(1,+tt),Ne.write_shift(2,Ue),Ne.write_shift(2,~Ue&65535);Ue-- >0;)Ne[Ne.l++]=Fe[Te++]}return Ne.l}function ce(Fe,Ne){for(var Te=0,Ue=0,tt=ue?new Uint16Array(32768):[];Ue<Fe.length;){var _t=Math.min(65535,Fe.length-Ue);if(_t<10){for(Te=Ge(Ne,Te,+(Ue+_t==Fe.length)),Te&7&&(Te+=8-(Te&7)),Ne.l=Te/8|0,Ne.write_shift(2,_t),Ne.write_shift(2,~_t&65535);_t-- >0;)Ne[Ne.l++]=Fe[Ue++];Te=Ne.l*8;continue}Te=Ge(Ne,Te,+(Ue+_t==Fe.length)+2);for(var Ct=0;_t-- >0;){var yt=Fe[Ue];Ct=(Ct<<5^yt)&32767;var Ut=-1,zt=0;if((Ut=tt[Ct])&&(Ut|=Ue&-32768,Ut>Ue&&(Ut-=32768),Ut<Ue))for(;Fe[Ut+zt]==Fe[Ue+zt]&&zt<250;)++zt;if(zt>2){yt=ye[zt],yt<=22?Te=nt(Ne,Te,we[yt+1]>>1)-1:(nt(Ne,Te,3),Te+=5,nt(Ne,Te,we[yt-23]>>5),Te+=3);var Gr=yt<8?0:yt-4>>2;Gr>0&&(Dt(Ne,Te,zt-J[yt]),Te+=Gr),yt=ke[Ue-Ut],Te=nt(Ne,Te,we[yt]>>3),Te-=3;var Qr=yt<4?0:yt-2>>1;Qr>0&&(Dt(Ne,Te,Ue-Ut-Y[yt]),Te+=Qr);for(var oa=0;oa<zt;++oa)tt[Ct]=Ue&32767,Ct=(Ct<<5^Fe[Ue])&32767,++Ue;_t-=zt-1}else yt<=143?yt=yt+48:Te=pt(Ne,Te,1),Te=nt(Ne,Te,we[yt]),tt[Ct]=Ue&32767,++Ue}Te=nt(Ne,Te,0)-1}return Ne.l=(Te+7)/8|0,Ne.l}return function(Ne,Te){return Ne.length<8?O(Ne,Te):ce(Ne,Te)}})();function Nt(re){var ke=At(50+Math.floor(re.length*1.1)),me=mt(re,ke);return ke.slice(0,me)}var gt=ue?new Uint16Array(32768):Ot(32768),dr=ue?new Uint16Array(32768):Ot(32768),Ht=ue?new Uint16Array(128):Ot(128),Rt=1,$t=1;function vr(re,ke){var me=qe(re,ke)+257;ke+=5;var be=qe(re,ke)+1;ke+=5;var ye=se(re,ke)+4;ke+=4;for(var O=0,ce=ue?new Uint8Array(19):Ot(19),Fe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ne=1,Te=ue?new Uint8Array(8):Ot(8),Ue=ue?new Uint8Array(8):Ot(8),tt=ce.length,_t=0;_t<ye;++_t)ce[q[_t]]=O=He(re,ke),Ne<O&&(Ne=O),Te[O]++,ke+=3;var Ct=0;for(Te[0]=0,_t=1;_t<=Ne;++_t)Ue[_t]=Ct=Ct+Te[_t-1]<<1;for(_t=0;_t<tt;++_t)(Ct=ce[_t])!=0&&(Fe[_t]=Ue[Ct]++);var yt=0;for(_t=0;_t<tt;++_t)if(yt=ce[_t],yt!=0){Ct=we[Fe[_t]]>>8-yt;for(var Ut=(1<<7-yt)-1;Ut>=0;--Ut)Ht[Ct|Ut<<yt]=yt&7|_t<<3}var zt=[];for(Ne=1;zt.length<me+be;)switch(Ct=Ht[Ye(re,ke)],ke+=Ct&7,Ct>>>=3){case 16:for(O=3+oe(re,ke),ke+=2,Ct=zt[zt.length-1];O-- >0;)zt.push(Ct);break;case 17:for(O=3+He(re,ke),ke+=3;O-- >0;)zt.push(0);break;case 18:for(O=11+Ye(re,ke),ke+=7;O-- >0;)zt.push(0);break;default:zt.push(Ct),Ne<Ct&&(Ne=Ct);break}var Gr=zt.slice(0,me),Qr=zt.slice(me);for(_t=me;_t<286;++_t)Gr[_t]=0;for(_t=be;_t<30;++_t)Qr[_t]=0;return Rt=sr(Gr,gt,286),$t=sr(Qr,dr,30),ke}function vt(re,ke){if(re[0]==3&&!(re[1]&3))return[i0(ke),2];for(var me=0,be=0,ye=Kk(ke||1<<18),O=0,ce=ye.length>>>0,Fe=0,Ne=0;(be&1)==0;){if(be=He(re,me),me+=3,be>>>1)be>>1==1?(Fe=9,Ne=5):(me=vr(re,me),Fe=Rt,Ne=$t);else{me&7&&(me+=8-(me&7));var Te=re[me>>>3]|re[(me>>>3)+1]<<8;if(me+=32,Te>0)for(!ke&&ce<O+Te&&(ye=It(ye,O+Te),ce=ye.length);Te-- >0;)ye[O++]=re[me>>>3],me+=8;continue}for(;;){!ke&&ce<O+32767&&(ye=It(ye,O+32767),ce=ye.length);var Ue=at(re,me,Fe),tt=be>>>1==1?er[Ue]:gt[Ue];if(me+=tt&15,tt>>>=4,(tt>>>8&255)===0)ye[O++]=tt;else{if(tt==256)break;tt-=257;var _t=tt<8?0:tt-4>>2;_t>5&&(_t=0);var Ct=O+J[tt];_t>0&&(Ct+=at(re,me,_t),me+=_t),Ue=at(re,me,Ne),tt=be>>>1==1?cr[Ue]:dr[Ue],me+=tt&15,tt>>>=4;var yt=tt<4?0:tt-2>>1,Ut=Y[tt];for(yt>0&&(Ut+=at(re,me,yt),me+=yt),!ke&&ce<Ct&&(ye=It(ye,Ct+100),ce=ye.length);O<Ct;)ye[O]=ye[O-Ut],++O}}}return ke?[ye,me+7>>>3]:[ye.slice(0,O),me+7>>>3]}function kr(re,ke){var me=re.slice(re.l||0),be=vt(me,ke);return re.l+=be[1],be[0]}function tr(re,ke){if(re)typeof console<"u"&&console.error(ke);else throw new Error(ke)}function rr(re,ke){var me=re;Ii(me,0);var be=[],ye=[],O={FileIndex:be,FullPaths:ye};Q(O,{root:ke.root});for(var ce=me.length-4;(me[ce]!=80||me[ce+1]!=75||me[ce+2]!=5||me[ce+3]!=6)&&ce>=0;)--ce;me.l=ce+4,me.l+=4;var Fe=me.read_shift(2);me.l+=6;var Ne=me.read_shift(4);for(me.l=Ne,ce=0;ce<Fe;++ce){me.l+=20;var Te=me.read_shift(4),Ue=me.read_shift(4),tt=me.read_shift(2),_t=me.read_shift(2),Ct=me.read_shift(2);me.l+=8;var yt=me.read_shift(4),Ut=c(me.slice(me.l+tt,me.l+tt+_t));me.l+=tt+_t+Ct;var zt=me.l;me.l=yt+4,Xt(me,Te,Ue,O,Ut),me.l=zt}return O}function Xt(re,ke,me,be,ye){re.l+=2;var O=re.read_shift(2),ce=re.read_shift(2),Fe=o(re);if(O&8257)throw new Error("Unsupported ZIP encryption");for(var Ne=re.read_shift(4),Te=re.read_shift(4),Ue=re.read_shift(4),tt=re.read_shift(2),_t=re.read_shift(2),Ct="",yt=0;yt<tt;++yt)Ct+=String.fromCharCode(re[re.l++]);if(_t){var Ut=c(re.slice(re.l,re.l+_t));(Ut[21589]||{}).mt&&(Fe=Ut[21589].mt),((ye||{})[21589]||{}).mt&&(Fe=ye[21589].mt)}re.l+=_t;var zt=re.slice(re.l,re.l+Te);switch(ce){case 8:zt=K(re,Ue);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ce)}var Gr=!1;O&8&&(Ne=re.read_shift(4),Ne==134695760&&(Ne=re.read_shift(4),Gr=!0),Te=re.read_shift(4),Ue=re.read_shift(4)),Te!=ke&&tr(Gr,"Bad compressed size: "+ke+" != "+Te),Ue!=me&&tr(Gr,"Bad uncompressed size: "+me+" != "+Ue),Jr(be,Ct,zt,{unsafe:!0,mt:Fe})}function Kt(re,ke){var me=ke||{},be=[],ye=[],O=At(1),ce=me.compression?8:0,Fe=0,Ne=0,Te=0,Ue=0,tt=0,_t=re.FullPaths[0],Ct=_t,yt=re.FileIndex[0],Ut=[],zt=0;for(Ne=1;Ne<re.FullPaths.length;++Ne)if(Ct=re.FullPaths[Ne].slice(_t.length),yt=re.FileIndex[Ne],!(!yt.size||!yt.content||Ct=="Sh33tJ5")){var Gr=Ue,Qr=At(Ct.length);for(Te=0;Te<Ct.length;++Te)Qr.write_shift(1,Ct.charCodeAt(Te)&127);Qr=Qr.slice(0,Qr.l),Ut[tt]=CU.buf(yt.content,0);var oa=yt.content;ce==8&&(oa=I(oa)),O=At(30),O.write_shift(4,67324752),O.write_shift(2,20),O.write_shift(2,Fe),O.write_shift(2,ce),yt.mt?n(O,yt.mt):O.write_shift(4,0),O.write_shift(-4,Ut[tt]),O.write_shift(4,oa.length),O.write_shift(4,yt.content.length),O.write_shift(2,Qr.length),O.write_shift(2,0),Ue+=O.length,be.push(O),Ue+=Qr.length,be.push(Qr),Ue+=oa.length,be.push(oa),O=At(46),O.write_shift(4,33639248),O.write_shift(2,0),O.write_shift(2,20),O.write_shift(2,Fe),O.write_shift(2,ce),O.write_shift(4,0),O.write_shift(-4,Ut[tt]),O.write_shift(4,oa.length),O.write_shift(4,yt.content.length),O.write_shift(2,Qr.length),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(4,0),O.write_shift(4,Gr),zt+=O.l,ye.push(O),zt+=Qr.length,ye.push(Qr),++tt}return O=At(22),O.write_shift(4,101010256),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,tt),O.write_shift(2,tt),O.write_shift(4,zt),O.write_shift(4,Ue),O.write_shift(2,0),yi([yi(be),yi(ye),O])}var Ft={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Zt(re,ke){if(re.ctype)return re.ctype;var me=re.name||"",be=me.match(/\.([^\.]+)$/);return be&&Ft[be[1]]||ke&&(be=(me=ke).match(/[\.\\]([^\.\\])+$/),be&&Ft[be[1]])?Ft[be[1]]:"application/octet-stream"}function wr(re){for(var ke=Cp(re),me=[],be=0;be<ke.length;be+=76)me.push(ke.slice(be,be+76));return me.join(`\r
`)+`\r
`}function Re(re){var ke=re.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Te){var Ue=Te.charCodeAt(0).toString(16).toUpperCase();return"="+(Ue.length==1?"0"+Ue:Ue)});ke=ke.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ke.charAt(0)==`
`&&(ke="=0D"+ke.slice(1)),ke=ke.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var me=[],be=ke.split(`\r
`),ye=0;ye<be.length;++ye){var O=be[ye];if(O.length==0){me.push("");continue}for(var ce=0;ce<O.length;){var Fe=76,Ne=O.slice(ce,ce+Fe);Ne.charAt(Fe-1)=="="?Fe--:Ne.charAt(Fe-2)=="="?Fe-=2:Ne.charAt(Fe-3)=="="&&(Fe-=3),Ne=O.slice(ce,ce+Fe),ce+=Fe,ce<O.length&&(Ne+="="),me.push(Ne)}}return me.join(`\r
`)}function Et(re){for(var ke=[],me=0;me<re.length;++me){for(var be=re[me];me<=re.length&&be.charAt(be.length-1)=="=";)be=be.slice(0,be.length-1)+re[++me];ke.push(be)}for(var ye=0;ye<ke.length;++ye)ke[ye]=ke[ye].replace(/[=][0-9A-Fa-f]{2}/g,function(O){return String.fromCharCode(parseInt(O.slice(1),16))});return wo(ke.join(`\r
`))}function Tt(re,ke,me){for(var be="",ye="",O="",ce,Fe=0;Fe<10;++Fe){var Ne=ke[Fe];if(!Ne||Ne.match(/^\s*$/))break;var Te=Ne.match(/^(.*?):\s*([^\s].*)$/);if(Te)switch(Te[1].toLowerCase()){case"content-location":be=Te[2].trim();break;case"content-type":O=Te[2].trim();break;case"content-transfer-encoding":ye=Te[2].trim();break}}switch(++Fe,ye.toLowerCase()){case"base64":ce=wo(Co(ke.slice(Fe).join("")));break;case"quoted-printable":ce=Et(ke.slice(Fe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ye)}var Ue=Jr(re,be.slice(me.length),ce,{unsafe:!0});O&&(Ue.ctype=O)}function Bt(re,ke){if(te(re.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var me=ke&&ke.root||"",be=(la&&Buffer.isBuffer(re)?re.toString("binary"):te(re)).split(`\r
`),ye=0,O="";for(ye=0;ye<be.length;++ye)if(O=be[ye],!!/^Content-Location:/i.test(O)&&(O=O.slice(O.indexOf("file")),me||(me=O.slice(0,O.lastIndexOf("/")+1)),O.slice(0,me.length)!=me))for(;me.length>0&&(me=me.slice(0,me.length-1),me=me.slice(0,me.lastIndexOf("/")+1),O.slice(0,me.length)!=me););var ce=(be[1]||"").match(/boundary="(.*?)"/);if(!ce)throw new Error("MAD cannot find boundary");var Fe="--"+(ce[1]||""),Ne=[],Te=[],Ue={FileIndex:Ne,FullPaths:Te};Q(Ue);var tt,_t=0;for(ye=0;ye<be.length;++ye){var Ct=be[ye];Ct!==Fe&&Ct!==Fe+"--"||(_t++&&Tt(Ue,be.slice(tt,ye),me),tt=ye)}return Ue}function Yt(re,ke){var me=ke||{},be=me.boundary||"SheetJS";be="------="+be;for(var ye=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+be.slice(2)+'"',"","",""],O=re.FullPaths[0],ce=O,Fe=re.FileIndex[0],Ne=1;Ne<re.FullPaths.length;++Ne)if(ce=re.FullPaths[Ne].slice(O.length),Fe=re.FileIndex[Ne],!(!Fe.size||!Fe.content||ce=="Sh33tJ5")){ce=ce.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(zt){return"_x"+zt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(zt){return"_u"+zt.charCodeAt(0).toString(16)+"_"});for(var Te=Fe.content,Ue=la&&Buffer.isBuffer(Te)?Te.toString("binary"):te(Te),tt=0,_t=Math.min(1024,Ue.length),Ct=0,yt=0;yt<=_t;++yt)(Ct=Ue.charCodeAt(yt))>=32&&Ct<128&&++tt;var Ut=tt>=_t*4/5;ye.push(be),ye.push("Content-Location: "+(me.root||"file:///C:/SheetJS/")+ce),ye.push("Content-Transfer-Encoding: "+(Ut?"quoted-printable":"base64")),ye.push("Content-Type: "+Zt(Fe,ce)),ye.push(""),ye.push(Ut?Re(Ue):wr(Ue))}return ye.push(be+`--\r
`),ye.join(`\r
`)}function Mr(re){var ke={};return Q(ke,re),ke}function Jr(re,ke,me,be){var ye=be&&be.unsafe;ye||Q(re);var O=!ye&&Tr.find(re,ke);if(!O){var ce=re.FullPaths[0];ke.slice(0,ce.length)==ce?ce=ke:(ce.slice(-1)!="/"&&(ce+="/"),ce=(ce+ke).replace("//","/")),O={name:s(ke),type:2},re.FileIndex.push(O),re.FullPaths.push(ce),ye||Tr.utils.cfb_gc(re)}return O.content=me,O.size=me?me.length:0,be&&(be.CLSID&&(O.clsid=be.CLSID),be.mt&&(O.mt=be.mt),be.ct&&(O.ct=be.ct)),O}function jr(re,ke){Q(re);var me=Tr.find(re,ke);if(me){for(var be=0;be<re.FileIndex.length;++be)if(re.FileIndex[be]==me)return re.FileIndex.splice(be,1),re.FullPaths.splice(be,1),!0}return!1}function fr(re,ke,me){Q(re);var be=Tr.find(re,ke);if(be){for(var ye=0;ye<re.FileIndex.length;++ye)if(re.FileIndex[ye]==be)return re.FileIndex[ye].name=s(me),re.FullPaths[ye]=me,!0}return!1}function Cr(re){U(re,!0)}return t.find=T,t.read=R,t.parse=h,t.write=Le,t.writeFile=pe,t.utils={cfb_new:Mr,cfb_add:Jr,cfb_del:jr,cfb_mov:fr,cfb_gc:Cr,ReadShift:tp,CheckField:aN,prep_blob:Ii,bconcat:yi,use_zlib:F,_deflateRaw:Nt,_inflateRaw:kr,consts:le},t})();function SU(e){return typeof e=="string"?eb(e):Array.isArray(e)?Zj(e):e}function Gp(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=eb(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?yc(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var s=new Blob([SU(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var n=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(n)},6e4),chrome.downloads.download({url:n,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=n,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(n)},6e4),n}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(e);return c.open("w"),c.encoding="binary",Array.isArray(t)&&(t=p0(t)),c.write(t),c.close(),t}catch(u){if(!u.message||!u.message.match(/onstruct/))throw u}throw new Error("cannot save file "+e)}function NU(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function un(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function Jk(e,t){for(var r=[],a=un(e),s=0;s!==a.length;++s)r[e[a[s]][t]]==null&&(r[e[a[s]][t]]=a[s]);return r}function rb(e){for(var t=[],r=un(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function ab(e){for(var t=[],r=un(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function EU(e){for(var t=[],r=un(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var gx=new Date(1899,11,30,0,0,0);function ui(e,t){var r=e.getTime(),a=gx.getTime()+(e.getTimezoneOffset()-gx.getTimezoneOffset())*6e4;return(r-a)/(1440*60*1e3)}var I3=new Date,FU=gx.getTime()+(I3.getTimezoneOffset()-gx.getTimezoneOffset())*6e4,Zk=I3.getTimezoneOffset();function sb(e){var t=new Date;return t.setTime(e*24*60*60*1e3+FU),t.getTimezoneOffset()!==Zk&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Zk)*6e4),t}function TU(e){var t=0,r=0,a=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var n=1;n!=s.length;++n)if(s[n]){switch(r=1,n>3&&(a=!0),s[n].slice(s[n].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[n].slice(s[n].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[n],10)}return t}var e4=new Date("2017-02-19T19:06:09.000Z"),Q3=isNaN(e4.getFullYear())?new Date("2/19/17"):e4,LU=Q3.getFullYear()==2017;function Fs(e,t){var r=new Date(e);if(LU)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Q3.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],n=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(n=new Date(n.getTime()-n.getTimezoneOffset()*60*1e3)),n}function Y0(e,t){if(la&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return yc(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return yc(k3(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return yc(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return yc(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(n){return r[n]||n})}catch{}for(var a=[],s=0;s!=e.length;++s)a.push(String.fromCharCode(e[s]));return a.join("")}function Ts(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Ts(e[r]));return t}function An(e,t){for(var r="";r.length<t;)r+=e;return r}function EA(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(s,n){return r=-r,n}),!isNaN(t=Number(a)))?t/r:t}var jU=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ff(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),s=t.getMonth(),n=t.getDate();if(isNaN(n))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&jU.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return a<0||a>8099?r:(s>0||n>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var UU=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,s){if(e||typeof a=="string")return r.split(a);for(var n=r.split(a),o=[n[0]],c=1;c<n.length;++c)o.push(s),o.push(n[c]);return o}})();function O3(e){return e?e.content&&e.type?Y0(e.content,!0):e.data?Ph(e.data):e.asNodeBuffer&&la?Ph(e.asNodeBuffer().toString("binary")):e.asBinary?Ph(e.asBinary()):e._data&&e._data.getContent?Ph(Y0(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function R3(e){if(!e)return null;if(e.data)return Pk(e.data);if(e.asNodeBuffer&&la)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Pk(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function DU(e){return e&&e.name.slice(-4)===".bin"?R3(e):O3(e)}function Vo(e,t){for(var r=e.FullPaths||un(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),s=a.replace(/\\/g,"/"),n=0;n<r.length;++n){var o=r[n].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==o||s==o)return e.files?e.files[r[n]]:e.FileIndex[n]}return null}function U2(e,t){var r=Vo(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Pn(e,t,r){if(!r)return DU(U2(e,t));if(!t)return null;try{return Pn(e,t)}catch{return null}}function _o(e,t,r){if(!r)return O3(U2(e,t));if(!t)return null;try{return _o(e,t)}catch{return null}}function IU(e,t,r){return R3(U2(e,t))}function t4(e){for(var t=e.FullPaths||un(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function na(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return la?a=Au(r):a=eU(r),Tr.utils.cfb_add(e,t,a)}Tr.utils.cfb_add(e,t,r)}else e.file(t,r)}function D2(){return Tr.utils.cfb_new()}function M3(e,t){switch(t.type){case"base64":return Tr.read(e,{type:"base64"});case"binary":return Tr.read(e,{type:"binary"});case"buffer":case"array":return Tr.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Kh(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var s=a.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var Fn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,QU=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,r4=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,OU=/<[^>]*>/g,Al=Fn.match(r4)?r4:OU,RU=/<\w*:/,MU=/<(\/?)\w+:/;function zr(e,t,r){for(var a={},s=0,n=0;s!==e.length&&!((n=e.charCodeAt(s))===32||n===10||n===13);++s);if(t||(a[0]=e.slice(0,s)),s===e.length)return a;var o=e.match(QU),c=0,u="",f=0,h="",g="",x=1;if(o)for(f=0;f!=o.length;++f){for(g=o[f],n=0;n!=g.length&&g.charCodeAt(n)!==61;++n);for(h=g.slice(0,n).trim();g.charCodeAt(n+1)==32;)++n;for(x=(s=g.charCodeAt(n+1))==34||s==39?1:0,u=g.slice(n+1+x,g.length-x),c=0;c!=h.length&&h.charCodeAt(c)!==58;++c);if(c===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),a[h]=u,a[h.toLowerCase()]=u;else{var m=(c===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(c+1);if(a[m]&&h.slice(c-3,c)=="ext")continue;a[m]=u,a[m.toLowerCase()]=u}}return a}function Cc(e){return e.replace(MU,"<$1")}var H3={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},I2=rb(H3),Fa=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var s=a+"",n=s.indexOf("<![CDATA[");if(n==-1)return s.replace(e,function(c,u){return H3[c]||String.fromCharCode(parseInt(u,c.indexOf("x")>-1?16:10))||c}).replace(t,function(c,u){return String.fromCharCode(parseInt(u,16))});var o=s.indexOf("]]>");return r(s.slice(0,n))+s.slice(n+9,o)+r(s.slice(o+3))}})(),Q2=/[&<>'"]/g,HU=/[\u0000-\u0008\u000b-\u001f]/g;function Ja(e){var t=e+"";return t.replace(Q2,function(r){return I2[r]}).replace(HU,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function a4(e){return Ja(e).replace(/ /g,"_x0020_")}var P3=/[\u0000-\u001f]/g;function O2(e){var t=e+"";return t.replace(Q2,function(r){return I2[r]}).replace(/\n/g,"<br/>").replace(P3,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function PU(e){var t=e+"";return t.replace(Q2,function(r){return I2[r]}).replace(P3,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var s4=(function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}})();function qU(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Ns(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function J1(e){for(var t="",r=0,a=0,s=0,n=0,o=0,c=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),a>191&&a<224){o=(a&31)<<6,o|=s&63,t+=String.fromCharCode(o);continue}if(n=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(s&63)<<6|n&63);continue}o=e.charCodeAt(r++),c=((a&7)<<18|(s&63)<<12|(n&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(c>>>10&1023)),t+=String.fromCharCode(56320+(c&1023))}return t}function n4(e){var t=i0(2*e.length),r,a,s=1,n=0,o=0,c;for(a=0;a<e.length;a+=s)s=1,(c=e.charCodeAt(a))<128?r=c:c<224?(r=(c&31)*64+(e.charCodeAt(a+1)&63),s=2):c<240?(r=(c&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),s=3):(s=4,r=(c&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[n++]=o&255,t[n++]=o>>>8,o=0),t[n++]=r%256,t[n++]=r>>>8;return t.slice(0,n).toString("ucs2")}function i4(e){return Au(e,"binary").toString("utf8")}var rm="foo bar baz",is=la&&(i4(rm)==J1(rm)&&i4||n4(rm)==J1(rm)&&n4)||J1,yc=la?function(e){return Au(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,s=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,s=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},Np=(function(){var e={};return function(r,a){var s=r+"|"+(a||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}})(),q3=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)a=a.replace(e[s][0],e[s][1]);return a}})(),KU=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),zU=/<\/?(?:vt:)?variant>/g,VU=/<(?:vt:)([^>]*)>([\s\S]*)</;function l4(e,t){var r=zr(e),a=e.match(KU(r.baseType))||[],s=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return s}return a.forEach(function(n){var o=n.replace(zU,"").match(VU);o&&s.push({v:is(o[2]),t:o[1]})}),s}var K3=/(^\s|\s$|\n)/;function Qi(e,t){return"<"+e+(t.match(K3)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Ep(e){return un(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Mt(e,t,r){return"<"+e+(r!=null?Ep(r):"")+(t!=null?(t.match(K3)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function xw(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function GU(e,t){switch(typeof e){case"string":var r=Mt("vt:lpwstr",Ja(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Mt((e|0)==e?"vt:i4":"vt:r8",Ja(String(e)));case"boolean":return Mt("vt:bool",e?"true":"false")}if(e instanceof Date)return Mt("vt:filetime",xw(e));throw new Error("Unable to serialize "+e)}function R2(e){if(la&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return is(p0(T2(e)));throw new Error("Bad input format: expected Buffer or string")}var Fp=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,ci={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},sd=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],bo={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function WU(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,n=5;n>=0;--n)s=s*256+e[t+n];return a==2047?s==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,s+=Math.pow(2,52)),r*Math.pow(2,a-52)*s)}function $U(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,s=0,n=0,o=a?-t:t;isFinite(o)?o==0?s=n=0:(s=Math.floor(Math.log(o)/Math.LN2),n=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(n)||n<Math.pow(2,52))?s=-1022:(n-=Math.pow(2,52),s+=1023)):(s=2047,n=isNaN(t)?26985:0);for(var c=0;c<=5;++c,n/=256)e[r+c]=n&255;e[r+6]=(s&15)<<4|n&15,e[r+7]=s>>4|a}var o4=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var s=0,n=e[0][a].length;s<n;s+=r)t.push.apply(t,e[0][a].slice(s,s+r));return t},A4=la?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Au(t)})):o4(e)}:o4,c4=function(e,t,r){for(var a=[],s=t;s<r;s+=2)a.push(String.fromCharCode(tu(e,s)));return a.join("").replace(_l,"")},M2=la?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(_l,""):c4(e,t,r)}:c4,u4=function(e,t,r){for(var a=[],s=t;s<t+r;++s)a.push(("0"+e[s].toString(16)).slice(-2));return a.join("")},z3=la?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):u4(e,t,r)}:u4,d4=function(e,t,r){for(var a=[],s=t;s<r;s++)a.push(String.fromCharCode(of(e,s)));return a.join("")},Wp=la?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):d4(t,r,a)}:d4,V3=function(e,t){var r=vo(e,t);return r>0?Wp(e,t+4,t+4+r-1):""},G3=V3,W3=function(e,t){var r=vo(e,t);return r>0?Wp(e,t+4,t+4+r-1):""},$3=W3,X3=function(e,t){var r=2*vo(e,t);return r>0?Wp(e,t+4,t+4+r-1):""},Y3=X3,J3=function(t,r){var a=vo(t,r);return a>0?M2(t,r+4,r+4+a):""},Z3=J3,eN=function(e,t){var r=vo(e,t);return r>0?Wp(e,t+4,t+4+r):""},tN=eN,rN=function(e,t){return WU(e,t)},mx=rN,H2=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};la&&(G3=function(t,r){if(!Buffer.isBuffer(t))return V3(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},$3=function(t,r){if(!Buffer.isBuffer(t))return W3(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},Y3=function(t,r){if(!Buffer.isBuffer(t))return X3(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},Z3=function(t,r){if(!Buffer.isBuffer(t))return J3(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},tN=function(t,r){if(!Buffer.isBuffer(t))return eN(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},mx=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):rN(t,r)},H2=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var of=function(e,t){return e[t]},tu=function(e,t){return e[t+1]*256+e[t]},XU=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},vo=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},j0=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},YU=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function tp(e,t){var r="",a,s,n=[],o,c,u,f;switch(t){case"dbcs":if(f=this.l,la&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)r+=String.fromCharCode(tu(this,f)),f+=2;e*=2;break;case"utf8":r=Wp(this,this.l,this.l+e);break;case"utf16le":e*=2,r=M2(this,this.l,this.l+e);break;case"wstr":return tp.call(this,e,"dbcs");case"lpstr-ansi":r=G3(this,this.l),e=4+vo(this,this.l);break;case"lpstr-cp":r=$3(this,this.l),e=4+vo(this,this.l);break;case"lpwstr":r=Y3(this,this.l),e=4+2*vo(this,this.l);break;case"lpp4":e=4+vo(this,this.l),r=Z3(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+vo(this,this.l),r=tN(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=of(this,this.l+e++))!==0;)n.push(tm(o));r=n.join("");break;case"_wstr":for(e=0,r="";(o=tu(this,this.l+e))!==0;)n.push(tm(o)),e+=2;e+=2,r=n.join("");break;case"dbcs-cont":for(r="",f=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return o=of(this,f),this.l=f+1,c=tp.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),n.join("")+c;n.push(tm(tu(this,f))),f+=2}r=n.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",f=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return o=of(this,f),this.l=f+1,c=tp.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),n.join("")+c;n.push(tm(of(this,f))),f+=1}r=n.join("");break;default:switch(e){case 1:return a=of(this,this.l),this.l++,a;case 2:return a=(t==="i"?XU:tu)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(a=(e>0?j0:YU)(this,this.l),this.l+=4,a):(s=vo(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=mx(this,this.l):s=mx([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=z3(this,this.l,e);break}}return this.l+=e,r}var JU=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},ZU=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},e7=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function t7(e,t,r){var a=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)e7(this,t.charCodeAt(s),this.l+2*s);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;a=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var n=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var o=t.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<n;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,JU(this,t,this.l);break;case 8:if(a=8,r==="f"){$U(this,t,this.l);break}case 16:break;case-4:a=4,ZU(this,t,this.l);break}return this.l+=a,this}function aN(e,t){var r=z3(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Ii(e,t){e.l=t,e.read_shift=tp,e.chk=aN,e.write_shift=t7}function ol(e,t){e.l+=t}function At(e){var t=i0(e);return Ii(t,0),t}function cu(e,t,r){if(e){var a,s,n;Ii(e,e.l||0);for(var o=e.length,c=0,u=0;e.l<o;){c=e.read_shift(1),c&128&&(c=(c&127)+((e.read_shift(1)&127)<<7));var f=Ip[c]||Ip[65535];for(a=e.read_shift(1),n=a&127,s=1;s<4&&a&128;++s)n+=((a=e.read_shift(1))&127)<<7*s;u=e.l+n;var h=f.f&&f.f(e,n,r);if(e.l=u,t(h,f,c))return}}}function to(){var e=[],t=la?256:2048,r=function(f){var h=At(f);return Ii(h,0),h},a=r(t),s=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},n=function(f){return a&&f<a.length-a.l?a:(s(),a=r(Math.max(f+1,t)))},o=function(){return s(),yi(e)},c=function(f){s(),a=f,a.l==null&&(a.l=a.length),n(t)};return{next:n,push:c,end:o,_bufs:e}}function kt(e,t,r,a){var s=+t,n;if(!isNaN(s)){a||(a=Ip[s].p||(r||[]).length||0),n=1+(s>=128?1:0)+1,a>=128&&++n,a>=16384&&++n,a>=2097152&&++n;var o=e.next(n);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var c=0;c!=4;++c)if(a>=128)o.write_shift(1,(a&127)+128),a>>=7;else{o.write_shift(1,a);break}a>0&&H2(r)&&e.push(r)}}function rp(e,t,r){var a=Ts(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function f4(e,t,r){var a=Ts(e);return a.s=rp(a.s,t.s,r),a.e=rp(a.e,t.s,r),a}function ap(e,t){if(e.cRel&&e.c<0)for(e=Ts(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Ts(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Kr(e);return!e.cRel&&e.cRel!=null&&(r=s7(r)),!e.rRel&&e.rRel!=null&&(r=r7(r)),r}function Z1(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+$s(e.s.c)+":"+(e.e.cRel?"":"$")+$s(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+En(e.s.r)+":"+(e.e.rRel?"":"$")+En(e.e.r):ap(e.s,t.biff)+":"+ap(e.e,t.biff)}function P2(e){return parseInt(a7(e),10)-1}function En(e){return""+(e+1)}function r7(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function a7(e){return e.replace(/\$(\d+)$/,"$1")}function q2(e){for(var t=n7(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function $s(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function s7(e){return e.replace(/^([A-Z])/,"$$$1")}function n7(e){return e.replace(/^\$([A-Z])/,"$1")}function i7(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Xs(e){for(var t=0,r=0,a=0;a<e.length;++a){var s=e.charCodeAt(a);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Kr(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function ro(e){var t=e.indexOf(":");return t==-1?{s:Xs(e),e:Xs(e)}:{s:Xs(e.slice(0,t)),e:Xs(e.slice(t+1))}}function aa(e,t){return typeof t>"u"||typeof t=="number"?aa(e.s,e.e):(typeof e!="string"&&(e=Kr(e)),typeof t!="string"&&(t=Kr(t)),e==t?e:e+":"+t)}function Ta(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,s=0,n=e.length;for(r=0;a<n&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.s.c=--r,r=0;a<n&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;if(t.s.r=--r,a===n||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=n&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.e.c=--r,r=0;a!=n&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;return t.e.r=--r,t}function h4(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=rA(e.z,r?ui(t):t)}catch{}try{return e.w=rA((e.XF||{}).numFmtId||(r?14:0),r?ui(t):t)}catch{return""+t}}function lu(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?uu[e.v]||e.v:t==null?h4(e,e.v):h4(e,t))}function g0(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function sN(e,t,r){var a=r||{},s=e?Array.isArray(e):a.dense,n=e||(s?[]:{}),o=0,c=0;if(n&&a.origin!=null){if(typeof a.origin=="number")o=a.origin;else{var u=typeof a.origin=="string"?Xs(a.origin):a.origin;o=u.r,c=u.c}n["!ref"]||(n["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(n["!ref"]){var h=Ta(n["!ref"]);f.s.c=h.s.c,f.s.r=h.s.r,f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),o==-1&&(f.e.r=o=h.e.r+1)}for(var g=0;g!=t.length;++g)if(t[g]){if(!Array.isArray(t[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=t[g].length;++x)if(!(typeof t[g][x]>"u")){var m={v:t[g][x]},w=o+g,v=c+x;if(f.s.r>w&&(f.s.r=w),f.s.c>v&&(f.s.c=v),f.e.r<w&&(f.e.r=w),f.e.c<v&&(f.e.c=v),t[g][x]&&typeof t[g][x]=="object"&&!Array.isArray(t[g][x])&&!(t[g][x]instanceof Date))m=t[g][x];else if(Array.isArray(m.v)&&(m.f=t[g][x][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(a.nullError)m.t="e",m.v=0;else if(a.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=a.dateNF||Rr[14],a.cellDates?(m.t="d",m.w=rA(m.z,ui(m.v))):(m.t="n",m.v=ui(m.v),m.w=rA(m.z,m.v))):m.t="s";if(s)n[w]||(n[w]=[]),n[w][v]&&n[w][v].z&&(m.z=n[w][v].z),n[w][v]=m;else{var B=Kr({c:v,r:w});n[B]&&n[B].z&&(m.z=n[B].z),n[B]=m}}}return f.s.c<1e7&&(n["!ref"]=aa(f)),n}function Rf(e,t){return sN(null,e,t)}function l7(e){return e.read_shift(4,"i")}function FA(e,t){return t||(t=At(4)),t.write_shift(4,e),t}function ll(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function ki(e,t){var r=!1;return t==null&&(r=!0,t=At(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function o7(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function A7(e,t){return t||(t=At(4)),t.write_shift(2,0),t.write_shift(2,0),t}function K2(e,t){var r=e.l,a=e.read_shift(1),s=ll(e),n=[],o={t:s,h:s};if((a&1)!==0){for(var c=e.read_shift(4),u=0;u!=c;++u)n.push(o7(e));o.r=n}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function c7(e,t){var r=!1;return t==null&&(r=!0,t=At(15+4*e.t.length)),t.write_shift(1,0),ki(e.t,t),r?t.slice(0,t.l):t}var u7=K2;function d7(e,t){var r=!1;return t==null&&(r=!0,t=At(23+4*e.t.length)),t.write_shift(1,1),ki(e.t,t),t.write_shift(4,1),A7({},t),r?t.slice(0,t.l):t}function sA(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function nd(e,t){return t==null&&(t=At(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function id(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function ld(e,t){return t==null&&(t=At(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var f7=ll,nN=ki;function z2(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function xx(e,t){var r=!1;return t==null&&(r=!0,t=At(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var h7=ll,bw=z2,V2=xx;function G2(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var s=a===0?mx([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):j0(t,0)>>2;return r?s/100:s}function iN(e,t){t==null&&(t=At(4));var r=0,a=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?a=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function lN(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function p7(e,t){return t||(t=At(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var od=lN,Mf=p7;function il(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function J0(e,t){return(t||At(8)).write_shift(8,e,"f")}function g7(e){var t={},r=e.read_shift(1),a=r>>>1,s=e.read_shift(1),n=e.read_shift(2,"i"),o=e.read_shift(1),c=e.read_shift(1),u=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=s;var f=P0[s];f&&(t.rgb=Lp(f));break;case 2:t.rgb=Lp([o,c,u]);break;case 3:t.theme=s;break}return n!=0&&(t.tint=n>0?n/32767:n/32768),t}function bx(e,t){if(t||(t=At(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function m7(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function x7(e,t){t||(t=At(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function oN(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function b7(e){return oN(e,1)}function v7(e){return oN(e,2)}var W2=2,Xl=3,am=11,p4=12,vx=19,sm=64,w7=65,_7=71,y7=4108,k7=4126,vi=80,AN=81,B7=[vi,AN],vw={1:{n:"CodePage",t:W2},2:{n:"Category",t:vi},3:{n:"PresentationFormat",t:vi},4:{n:"ByteCount",t:Xl},5:{n:"LineCount",t:Xl},6:{n:"ParagraphCount",t:Xl},7:{n:"SlideCount",t:Xl},8:{n:"NoteCount",t:Xl},9:{n:"HiddenCount",t:Xl},10:{n:"MultimediaClipCount",t:Xl},11:{n:"ScaleCrop",t:am},12:{n:"HeadingPairs",t:y7},13:{n:"TitlesOfParts",t:k7},14:{n:"Manager",t:vi},15:{n:"Company",t:vi},16:{n:"LinksUpToDate",t:am},17:{n:"CharacterCount",t:Xl},19:{n:"SharedDoc",t:am},22:{n:"HyperlinksChanged",t:am},23:{n:"AppVersion",t:Xl,p:"version"},24:{n:"DigSig",t:w7},26:{n:"ContentType",t:vi},27:{n:"ContentStatus",t:vi},28:{n:"Language",t:vi},29:{n:"Version",t:vi},255:{},2147483648:{n:"Locale",t:vx},2147483651:{n:"Behavior",t:vx},1919054434:{}},ww={1:{n:"CodePage",t:W2},2:{n:"Title",t:vi},3:{n:"Subject",t:vi},4:{n:"Author",t:vi},5:{n:"Keywords",t:vi},6:{n:"Comments",t:vi},7:{n:"Template",t:vi},8:{n:"LastAuthor",t:vi},9:{n:"RevNumber",t:vi},10:{n:"EditTime",t:sm},11:{n:"LastPrinted",t:sm},12:{n:"CreatedDate",t:sm},13:{n:"ModifiedDate",t:sm},14:{n:"PageCount",t:Xl},15:{n:"WordCount",t:Xl},16:{n:"CharCount",t:Xl},17:{n:"Thumbnail",t:_7},18:{n:"Application",t:vi},19:{n:"DocSecurity",t:Xl},255:{},2147483648:{n:"Locale",t:vx},2147483651:{n:"Behavior",t:vx},1919054434:{}},g4={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},C7=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function S7(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var N7=S7([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),P0=Ts(N7),uu={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},cN={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},_w={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},nm={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function $2(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function E7(e){var t=$2();if(!e||!e.match)return t;var r={};if((e.match(Al)||[]).forEach(function(a){var s=zr(a);switch(s[0].replace(RU,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[_w[s.ContentType]]!==void 0&&t[_w[s.ContentType]].push(s.PartName);break}}),t.xmlns!==ci.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function uN(e,t){var r=EU(_w),a=[],s;a[a.length]=Fn,a[a.length]=Mt("Types",null,{xmlns:ci.CT,"xmlns:xsd":ci.xsd,"xmlns:xsi":ci.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(u){return Mt("Default",null,{Extension:u[0],ContentType:u[1]})}));var n=function(u){e[u]&&e[u].length>0&&(s=e[u][0],a[a.length]=Mt("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:nm[u][t.bookType]||nm[u].xlsx}))},o=function(u){(e[u]||[]).forEach(function(f){a[a.length]=Mt("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:nm[u][t.bookType]||nm[u].xlsx})})},c=function(u){(e[u]||[]).forEach(function(f){a[a.length]=Mt("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:r[u][0]})})};return n("workbooks"),o("sheets"),o("charts"),c("themes"),["strs","styles"].forEach(n),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),o("metadata"),c("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var ua={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Tp(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function sp(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(Al)||[]).forEach(function(s){var n=zr(s);if(n[0]==="<Relationship"){var o={};o.Type=n.Type,o.Target=n.Target,o.Id=n.Id,n.TargetMode&&(o.TargetMode=n.TargetMode);var c=n.TargetMode==="External"?n.Target:Kh(n.Target,t);r[c]=o,a[n.Id]=o}}),r["!id"]=a,r}function wf(e){var t=[Fn,Mt("Relationships",null,{xmlns:ci.RELS})];return un(e["!id"]).forEach(function(r){t[t.length]=Mt("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Xa(e,t,r,a,s,n){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=a,s.Target=r,[ua.HLINK,ua.XPATH,ua.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var F7="application/vnd.oasis.opendocument.spreadsheet";function T7(e,t){for(var r=R2(e),a,s;a=Fp.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(s=zr(a[0],!1),s.path=="/"&&s.type!==F7)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}function L7(e){var t=[Fn];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function m4(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function j7(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function U7(e){var t=[Fn];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(m4(e[r][0],e[r][1])),t.push(j7("",e[r][0]));return t.push(m4("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function dN(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+dx.version+"</meta:generator></office:meta></office:document-meta>"}var tA=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],D7=(function(){for(var e=new Array(tA.length),t=0;t<tA.length;++t){var r=tA[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e})();function fN(e){var t={};e=is(e);for(var r=0;r<tA.length;++r){var a=tA[r],s=e.match(D7[r]);s!=null&&s.length>0&&(t[a[1]]=Fa(s[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=Fs(t[a[1]]))}return t}function ev(e,t,r,a,s){s[e]!=null||t==null||t===""||(s[e]=t,t=Ja(t),a[a.length]=r?Mt(e,t,r):Qi(e,t))}function hN(e,t){var r=t||{},a=[Fn,Mt("cp:coreProperties",null,{"xmlns:cp":ci.CORE_PROPS,"xmlns:dc":ci.dc,"xmlns:dcterms":ci.dcterms,"xmlns:dcmitype":ci.dcmitype,"xmlns:xsi":ci.xsi})],s={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&ev("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:xw(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s),e.ModifiedDate!=null&&ev("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:xw(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s));for(var n=0;n!=tA.length;++n){var o=tA[n],c=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&ev(o[0],c,null,a,s)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var q0=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],pN=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function gN(e,t,r,a){var s=[];if(typeof e=="string")s=l4(e,a);else for(var n=0;n<e.length;++n)s=s.concat(e[n].map(function(h){return{v:h}}));var o=typeof t=="string"?l4(t,a).map(function(h){return h.v}):t,c=0,u=0;if(o.length>0)for(var f=0;f!==s.length;f+=2){switch(u=+s[f+1].v,s[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=u,r.SheetNames=o.slice(c,c+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=u,r.DefinedNames=o.slice(c,c+u);break;case"Charts":case"Diagramme":r.Chartsheets=u,r.ChartNames=o.slice(c,c+u);break}c+=u}}function I7(e,t,r){var a={};return t||(t={}),e=is(e),q0.forEach(function(s){var n=(e.match(Np(s[0]))||[])[1];switch(s[2]){case"string":n&&(t[s[1]]=Fa(n));break;case"bool":t[s[1]]=n==="true";break;case"raw":var o=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));o&&o.length>0&&(a[s[1]]=o[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&gN(a.HeadingPairs,a.TitlesOfParts,t,r),t}function mN(e){var t=[],r=Mt;return e||(e={}),e.Application="SheetJS",t[t.length]=Fn,t[t.length]=Mt("Properties",null,{xmlns:ci.EXT_PROPS,"xmlns:vt":ci.vt}),q0.forEach(function(a){if(e[a[1]]!==void 0){var s;switch(a[2]){case"string":s=Ja(String(e[a[1]]));break;case"bool":s=e[a[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(a[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+Ja(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Q7=/<[^>]+>[^<]*/g;function O7(e,t){var r={},a="",s=e.match(Q7);if(s)for(var n=0;n!=s.length;++n){var o=s[n],c=zr(o);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":a=Fa(c.name);break;case"</property>":a=null;break;default:if(o.indexOf("<vt:")===0){var u=o.split(">"),f=u[0].slice(4),h=u[1];switch(f){case"lpstr":case"bstr":case"lpwstr":r[a]=Fa(h);break;case"bool":r[a]=Ns(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(h,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(h);break;case"filetime":case"date":r[a]=Fs(h);break;case"cy":case"error":r[a]=Fa(h);break;default:if(f.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,f,u)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function xN(e){var t=[Fn,Mt("Properties",null,{xmlns:ci.CUST_PROPS,"xmlns:vt":ci.vt})];if(!e)return t.join("");var r=1;return un(e).forEach(function(s){++r,t[t.length]=Mt("property",GU(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ja(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var yw={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},tv;function R7(e,t,r){tv||(tv=rb(yw)),t=tv[t]||t,e[t]=r}function M7(e,t){var r=[];return un(yw).map(function(a){for(var s=0;s<tA.length;++s)if(tA[s][1]==a)return tA[s];for(s=0;s<q0.length;++s)if(q0[s][1]==a)return q0[s];throw a}).forEach(function(a){if(e[a[1]]!=null){var s=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];a[2]==="date"&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"Z")),typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Qi(yw[a[1]]||a[1],s))}}),Mt("DocumentProperties",r.join(""),{xmlns:bo.o})}function H7(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",s=[];return e&&un(e).forEach(function(n){if(Object.prototype.hasOwnProperty.call(e,n)){for(var o=0;o<tA.length;++o)if(n==tA[o][1])return;for(o=0;o<q0.length;++o)if(n==q0[o][1])return;for(o=0;o<r.length;++o)if(n==r[o])return;var c=e[n],u="string";typeof c=="number"?(u="float",c=String(c)):c===!0||c===!1?(u="boolean",c=c?"1":"0"):c=String(c),s.push(Mt(a4(n),c,{"dt:dt":u}))}}),t&&un(t).forEach(function(n){if(Object.prototype.hasOwnProperty.call(t,n)&&!(e&&Object.prototype.hasOwnProperty.call(e,n))){var o=t[n],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o instanceof Date?(c="dateTime.tz",o=o.toISOString()):o=String(o),s.push(Mt(a4(n),o,{"dt:dt":c}))}}),"<"+a+' xmlns="'+bo.o+'">'+s.join("")+"</"+a+">"}function X2(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function P7(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),s=(r-a)/Math.pow(2,32);a*=1e7,s*=1e7;var n=a/Math.pow(2,32)|0;n>0&&(a=a%Math.pow(2,32),s+=n);var o=At(8);return o.write_shift(4,a),o.write_shift(4,s),o}function bN(e,t,r){var a=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return s}function vN(e,t,r){var a=e.read_shift(0,"lpwstr");return a}function wN(e,t,r){return t===31?vN(e):bN(e,t,r)}function kw(e,t,r){return wN(e,t,r===!1?0:4)}function q7(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return wN(e,t,0)}function K7(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var s=e.l;r[a]=e.read_shift(0,"lpwstr").replace(_l,""),e.l-s&2&&(e.l+=2)}return r}function z7(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(_l,"");return r}function V7(e){var t=e.l,r=wx(e,AN);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=wx(e,Xl);return[r,a]}function G7(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(V7(e));return r}function x4(e,t){for(var r=e.read_shift(4),a={},s=0;s!=r;++s){var n=e.read_shift(4),o=e.read_shift(4);a[n]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(_l,"").replace(qh,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function _N(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function W7(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function wx(e,t,r){var a=e.read_shift(2),s,n=r||{};if(e.l+=2,t!==p4&&a!==t&&B7.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===p4?a:t){case 2:return s=e.read_shift(2,"i"),n.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return bN(e,a,4).replace(_l,"");case 31:return vN(e);case 64:return X2(e);case 65:return _N(e);case 71:return W7(e);case 80:return kw(e,a,!n.raw).replace(_l,"");case 81:return q7(e,a).replace(_l,"");case 4108:return G7(e);case 4126:case 4127:return a==4127?K7(e):z7(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function b4(e,t){var r=At(4),a=At(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=At(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=P7(t);break;case 31:case 80:for(a=At(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return yi([r,a])}function v4(e,t){var r=e.l,a=e.read_shift(4),s=e.read_shift(4),n=[],o=0,c=0,u=-1,f={};for(o=0;o!=s;++o){var h=e.read_shift(4),g=e.read_shift(4);n[o]=[h,g+r]}n.sort(function(E,S){return E[1]-S[1]});var x={};for(o=0;o!=s;++o){if(e.l!==n[o][1]){var m=!0;if(o>0&&t)switch(t[n[o-1][0]].t){case 2:e.l+2===n[o][1]&&(e.l+=2,m=!1);break;case 80:e.l<=n[o][1]&&(e.l=n[o][1],m=!1);break;case 4108:e.l<=n[o][1]&&(e.l=n[o][1],m=!1);break}if((!t||o==0)&&e.l<=n[o][1]&&(m=!1,e.l=n[o][1]),m)throw new Error("Read Error: Expected address "+n[o][1]+" at "+e.l+" :"+o)}if(t){var w=t[n[o][0]];if(x[w.n]=wx(e,w.t,{raw:!0}),w.p==="version"&&(x[w.n]=String(x[w.n]>>16)+"."+("0000"+String(x[w.n]&65535)).slice(-4)),w.n=="CodePage")switch(x[w.n]){case 0:x[w.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:SA(c=x[w.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+x[w.n])}}else if(n[o][0]===1){if(c=x.CodePage=wx(e,W2),SA(c),u!==-1){var v=e.l;e.l=n[u][1],f=x4(e,c),e.l=v}}else if(n[o][0]===0){if(c===0){u=o,e.l=n[o+1][1];continue}f=x4(e,c)}else{var B=f[n[o][0]],k;switch(e[e.l]){case 65:e.l+=4,k=_N(e);break;case 30:e.l+=4,k=kw(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,k=kw(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,k=e.read_shift(4,"i");break;case 19:e.l+=4,k=e.read_shift(4);break;case 5:e.l+=4,k=e.read_shift(8,"f");break;case 11:e.l+=4,k=vn(e,4);break;case 64:e.l+=4,k=Fs(X2(e));break;default:throw new Error("unparsed value: "+e[e.l])}x[B]=k}}return e.l=r+a,x}var yN=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function $7(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function w4(e,t,r){var a=At(8),s=[],n=[],o=8,c=0,u=At(8),f=At(8);if(u.write_shift(4,2),u.write_shift(4,1200),f.write_shift(4,1),n.push(u),s.push(f),o+=8+u.length,!t){f=At(8),f.write_shift(4,0),s.unshift(f);var h=[At(4)];for(h[0].write_shift(4,e.length),c=0;c<e.length;++c){var g=e[c][0];for(u=At(8+2*(g.length+1)+(g.length%2?0:2)),u.write_shift(4,c+2),u.write_shift(4,g.length+1),u.write_shift(0,g,"dbcs");u.l!=u.length;)u.write_shift(1,0);h.push(u)}u=yi(h),n.unshift(u),o+=8+u.length}for(c=0;c<e.length;++c)if(!(t&&!t[e[c][0]])&&!(yN.indexOf(e[c][0])>-1||pN.indexOf(e[c][0])>-1)&&e[c][1]!=null){var x=e[c][1],m=0;if(t){m=+t[e[c][0]];var w=r[m];if(w.p=="version"&&typeof x=="string"){var v=x.split(".");x=(+v[0]<<16)+(+v[1]||0)}u=b4(w.t,x)}else{var B=$7(x);B==-1&&(B=31,x=String(x)),u=b4(B,x)}n.push(u),f=At(8),f.write_shift(4,t?m:2+c),s.push(f),o+=8+u.length}var k=8*(n.length+1);for(c=0;c<n.length;++c)s[c].write_shift(4,k),k+=n[c].length;return a.write_shift(4,o),a.write_shift(4,n.length),yi([a].concat(s).concat(n))}function _4(e,t,r){var a=e.content;if(!a)return{};Ii(a,0);var s,n,o,c,u=0;a.chk("feff","Byte Order: "),a.read_shift(2);var f=a.read_shift(4),h=a.read_shift(16);if(h!==Tr.utils.consts.HEADER_CLSID&&h!==r)throw new Error("Bad PropertySet CLSID "+h);if(s=a.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(n=a.read_shift(16),c=a.read_shift(4),s===1&&c!==a.l)throw new Error("Length mismatch: "+c+" !== "+a.l);s===2&&(o=a.read_shift(16),u=a.read_shift(4));var g=v4(a,t),x={SystemIdentifier:f};for(var m in g)x[m]=g[m];if(x.FMTID=n,s===1)return x;if(u-a.l==2&&(a.l+=2),a.l!==u)throw new Error("Length mismatch 2: "+a.l+" !== "+u);var w;try{w=v4(a,null)}catch{}for(m in w)x[m]=w[m];return x.FMTID=[n,o],x}function y4(e,t,r,a,s,n){var o=At(s?68:48),c=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Tr.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,s?68:48);var u=w4(e,r,a);if(c.push(u),s){var f=w4(s,null,null);o.write_shift(16,n,"hex"),o.write_shift(4,68+u.length),c.push(f)}return yi(c)}function Ou(e,t){return e.read_shift(t),null}function X7(e,t){t||(t=At(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function Y7(e,t,r){for(var a=[],s=e.l+t;e.l<s;)a.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return a}function vn(e,t){return e.read_shift(t)===1}function bl(e,t){return t||(t=At(2)),t.write_shift(2,+!!e),t}function qn(e){return e.read_shift(2,"u")}function Wo(e,t){return t||(t=At(2)),t.write_shift(2,e),t}function kN(e,t){return Y7(e,t,qn)}function J7(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function BN(e,t,r){return r||(r=At(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function $p(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var n=e.read_shift(1);n&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var o=a?e.read_shift(a,s):"";return o}function Z7(e){var t=e.read_shift(2),r=e.read_shift(1),a=r&4,s=r&8,n=1+(r&1),o=0,c,u={};s&&(o=e.read_shift(2)),a&&(c=e.read_shift(4));var f=n==2?"dbcs-cont":"sbcs-cont",h=t===0?"":e.read_shift(t,f);return s&&(e.l+=4*o),a&&(e.l+=c),u.t=h,s||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function eD(e){var t=e.t||"",r=At(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=At(2*t.length);a.write_shift(2*t.length,t,"utf16le");var s=[r,a];return yi(s)}function Z0(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function Xp(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):Z0(e,a,r)}function Ad(e,t,r){if(r.biff>5)return Xp(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function CN(e,t,r){return r||(r=At(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function tD(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function rD(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var s=e.read_shift((a?t-24:t)>>1,"utf16le").replace(_l,"");return a&&(e.l+=24),s}function aD(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+a.replace(/\\/g,"/");var n=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(n>>1,"utf16le").replace(_l,"");return r+o}function sD(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return rD(e);case"0303000000000000c000000000000046":return aD(e);default:throw new Error("Unsupported Moniker "+r)}}function im(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(_l,""):"";return r}function k4(e,t){t||(t=At(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function nD(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var s=e.read_shift(2);e.l+=2;var n,o,c,u,f="",h,g;s&16&&(n=im(e,r-e.l)),s&128&&(o=im(e,r-e.l)),(s&257)===257&&(c=im(e,r-e.l)),(s&257)===1&&(u=sD(e,r-e.l)),s&8&&(f=im(e,r-e.l)),s&32&&(h=e.read_shift(16)),s&64&&(g=X2(e)),e.l=r;var x=o||c||u||"";x&&f&&(x+="#"+f),x||(x="#"+f),s&2&&x.charAt(0)=="/"&&x.charAt(1)!="/"&&(x="file://"+x);var m={Target:x};return h&&(m.guid=h),g&&(m.time=g),n&&(m.Tooltip=n),m}function iD(e){var t=At(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var s=a.indexOf("#"),n=s>-1?31:23;switch(a.charAt(0)){case"#":n=28;break;case".":n&=-3;break}t.write_shift(4,2),t.write_shift(4,n);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(n==28)a=a.slice(1),k4(a,t);else if(n&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var c=s>-1?a.slice(0,s):a;for(t.write_shift(4,2*(c.length+1)),r=0;r<c.length;++r)t.write_shift(2,c.charCodeAt(r));t.write_shift(2,0),n&8&&k4(s>-1?a.slice(s+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var u=0;a.slice(u*3,u*3+3)=="../"||a.slice(u*3,u*3+3)=="..\\";)++u;for(t.write_shift(2,u),t.write_shift(4,a.length-3*u+1),r=0;r<a.length-3*u;++r)t.write_shift(1,a.charCodeAt(r+3*u)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function SN(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),s=e.read_shift(1);return[t,r,a,s]}function NN(e,t){var r=SN(e);return r[3]=0,r}function Sc(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function ed(e,t,r,a){return a||(a=At(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function lD(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function oD(e,t,r){return t===0?"":Ad(e,t,r)}function AD(e,t,r){var a=r.biff>8?4:2,s=e.read_shift(a),n=e.read_shift(a,"i"),o=e.read_shift(a,"i");return[s,n,o]}function EN(e){var t=e.read_shift(2),r=G2(e);return[t,r]}function cD(e,t,r){e.l+=4,t-=4;var a=e.l+t,s=$p(e,t,r),n=e.read_shift(2);if(a-=e.l,n!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+n);return e.l+=n,s}function nb(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);return{s:{c:a,r:t},e:{c:s,r}}}function FN(e,t){return t||(t=At(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function TN(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),s=e.read_shift(1);return{s:{c:a,r:t},e:{c:s,r}}}var uD=TN;function LN(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function dD(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function fD(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Xi(e){e.l+=2,e.l+=e.read_shift(2)}var hD={0:Xi,4:Xi,5:Xi,6:Xi,7:fD,8:Xi,9:Xi,10:Xi,11:Xi,12:Xi,13:dD,14:Xi,15:Xi,16:Xi,17:Xi,18:Xi,19:Xi,20:Xi,21:LN};function pD(e,t){for(var r=e.l+t,a=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{a.push(hD[s](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function lm(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Y2(e,t,r){var a=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,s=8;break;case"biff4":a=4,s=6;break;case"biff3":a=3,s=6;break;case"biff2":a=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var n=At(s);return n.write_shift(2,a),n.write_shift(2,t),s>4&&n.write_shift(2,29282),s>6&&n.write_shift(2,1997),s>8&&(n.write_shift(2,49161),n.write_shift(2,1),n.write_shift(2,1798),n.write_shift(2,0)),n}function gD(e,t){return t===0||e.read_shift(2),1200}function mD(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,s=Ad(e,0,r);return e.read_shift(t+a-e.l),s}function xD(e,t){var r=!t||t.biff==8,a=At(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function bD(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function vD(e,t,r){var a=e.read_shift(4),s=e.read_shift(1)&3,n=e.read_shift(1);switch(n){case 0:n="Worksheet";break;case 1:n="Macrosheet";break;case 2:n="Chartsheet";break;case 6:n="VBAModule";break}var o=$p(e,0,r);return o.length===0&&(o="Sheet1"),{pos:a,hs:s,dt:n,name:o}}function wD(e,t){var r=!t||t.biff>=8?2:1,a=At(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=a.slice(0,a.l);return s.l=a.l,s}function _D(e,t){for(var r=e.l+t,a=e.read_shift(4),s=e.read_shift(4),n=[],o=0;o!=s&&e.l<r;++o)n.push(Z7(e));return n.Count=a,n.Unique=s,n}function yD(e,t){var r=At(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],s=0;s<e.length;++s)a[s]=eD(e[s]);var n=yi([r].concat(a));return n.parts=[r.length].concat(a.map(function(o){return o.length})),n}function kD(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function BD(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function CD(e){var t=lD(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function SD(e){return e.read_shift(2),e.read_shift(4)}function B4(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(a=1-(s>>15),s&=32767);var n={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[n,s]}function ND(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2),f=e.read_shift(2);return{Pos:[t,r],Dim:[a,s],Flags:n,CurTab:o,FirstTab:c,Selected:u,TabRatio:f}}function ED(){var e=At(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function FD(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function TD(e){var t=At(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function LD(){}function jD(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=$p(e,0,r),a}function UD(e,t){var r=e.name||"Arial",a=t&&t.biff==5,s=a?15+r.length:16+2*r.length,n=At(s);return n.write_shift(2,e.sz*20),n.write_shift(4,0),n.write_shift(2,400),n.write_shift(4,0),n.write_shift(2,0),n.write_shift(1,r.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),n}function DD(e){var t=Sc(e);return t.isst=e.read_shift(4),t}function ID(e,t,r,a){var s=At(10);return ed(e,t,a,s),s.write_shift(4,r),s}function QD(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,s=Sc(e);r.biff==2&&e.l++;var n=Xp(e,a-e.l,r);return s.val=n,s}function OD(e,t,r,a,s){var n=!s||s.biff==8,o=At(8+ +n+(1+n)*r.length);return ed(e,t,a,o),o.write_shift(2,r.length),n&&o.write_shift(1,1),o.write_shift((1+n)*r.length,r,n?"utf16le":"sbcs"),o}function RD(e,t,r){var a=e.read_shift(2),s=Ad(e,0,r);return[a,s]}function MD(e,t,r,a){var s=r&&r.biff==5;a||(a=At(s?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(s?1:2,t.length),s||a.write_shift(1,1),a.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var n=a.length>a.l?a.slice(0,a.l):a;return n.l==null&&(n.l=n.length),n}var HD=Ad;function C4(e,t,r){var a=e.l+t,s=r.biff==8||!r.biff?4:2,n=e.read_shift(s),o=e.read_shift(s),c=e.read_shift(2),u=e.read_shift(2);return e.l=a,{s:{r:n,c},e:{r:o,c:u}}}function PD(e,t){var r=t.biff==8||!t.biff?4:2,a=At(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function qD(e){var t=e.read_shift(2),r=e.read_shift(2),a=EN(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function KD(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),n=[];e.l<r;)n.push(EN(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(n.length!=o-s+1)throw new Error("MulRK length mismatch");return{r:a,c:s,C:o,rkrec:n}}function zD(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),n=[];e.l<r;)n.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(n.length!=o-s+1)throw new Error("MulBlank length mismatch");return{r:a,c:s,C:o,ixfe:n}}function VD(e,t,r,a){var s={},n=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(4),u=e.read_shift(2);return s.patternType=C7[c>>26],a.cellStyles&&(s.alc=n&7,s.fWrap=n>>3&1,s.alcV=n>>4&7,s.fJustLast=n>>7&1,s.trot=n>>8&255,s.cIndent=n>>16&15,s.fShrinkToFit=n>>20&1,s.iReadOrder=n>>22&2,s.fAtrNum=n>>26&1,s.fAtrFnt=n>>27&1,s.fAtrAlc=n>>28&1,s.fAtrBdr=n>>29&1,s.fAtrPat=n>>30&1,s.fAtrProt=n>>31&1,s.dgLeft=o&15,s.dgRight=o>>4&15,s.dgTop=o>>8&15,s.dgBottom=o>>12&15,s.icvLeft=o>>16&127,s.icvRight=o>>23&127,s.grbitDiag=o>>30&3,s.icvTop=c&127,s.icvBottom=c>>7&127,s.icvDiag=c>>14&127,s.dgDiag=c>>21&15,s.icvFore=u&127,s.icvBack=u>>7&127,s.fsxButton=u>>14&1),s}function GD(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=VD(e,t,a.fStyle,r),a}function S4(e,t,r,a){var s=r&&r.biff==5;a||(a=At(s?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var n=0;return e.numFmtId>0&&s&&(n|=1024),a.write_shift(4,n),a.write_shift(4,0),s||a.write_shift(4,0),a.write_shift(2,0),a}function WD(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function $D(e){var t=At(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function N4(e,t,r){var a=Sc(e);(r.biff==2||t==9)&&++e.l;var s=J7(e);return a.val=s,a.t=s===!0||s===!1?"b":"e",a}function XD(e,t,r,a,s,n){var o=At(8);return ed(e,t,a,o),BN(r,n,o),o}function YD(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=Sc(e),s=il(e);return a.val=s,a}function JD(e,t,r,a){var s=At(14);return ed(e,t,a,s),J0(r,s),s}var E4=oD;function ZD(e,t,r){var a=e.l+t,s=e.read_shift(2),n=e.read_shift(2);if(r.sbcch=n,n==1025||n==14849)return[n,s];if(n<1||n>255)throw new Error("Unexpected SupBook type: "+n);for(var o=Z0(e,n),c=[];a>e.l;)c.push(Xp(e));return[n,s,o,c]}function F4(e,t,r){var a=e.read_shift(2),s,n={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(s=cD(e,t-2,r)),n.body=s||e.read_shift(t-2),typeof s=="string"&&(n.Name=s),n}var eI=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function T4(e,t,r){var a=e.l+t,s=e.read_shift(2),n=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(r&&r.biff==2?1:2),u=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),u=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var f=Z0(e,o,r);s&32&&(f=eI[f.charCodeAt(0)]);var h=a-e.l;r&&r.biff==2&&--h;var g=a==e.l||c===0||!(h>0)?[]:pM(e,h,r,c);return{chKey:n,Name:f,itab:u,rgce:g}}function jN(e,t,r){if(r.biff<8)return tI(e,t,r);for(var a=[],s=e.l+t,n=e.read_shift(r.biff>8?4:2);n--!==0;)a.push(AD(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return a}function tI(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=$p(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function rI(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),s=e.read_shift(2),n=Z0(e,a,r),o=Z0(e,s,r);return[n,o]}function aI(e,t,r){var a=TN(e);e.l++;var s=e.read_shift(1);return t-=8,[gM(e,t,r),s,a]}function L4(e,t,r){var a=uD(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,fM(e,t,r)]}function sI(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function nI(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2),o=e.read_shift(2),c=Ad(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:s},c,o,n]}}function iI(e,t,r){return nI(e,t,r)}function lI(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(nb(e));return r}function oI(e){var t=At(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)FN(e[r],t);return t}function AI(e,t,r){if(r&&r.biff<8)return uI(e,t,r);var a=LN(e),s=pD(e,t-22,a[1]);return{cmo:a,ft:s}}var cI={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:a}}};function uI(e,t,r){e.l+=4;var a=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((cI[a]||ol)(e,t,r)),{cmo:[s,a,n],ft:o}}function dI(e,t,r){var a=e.l,s="";try{e.l+=4;var n=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(n)==-1?e.l+=6:o=tD(e,6,r);var c=e.read_shift(2);e.read_shift(2),qn(e,2);var u=e.read_shift(2);e.l+=u;for(var f=1;f<e.lens.length-1;++f){if(e.l-a!=e.lens[f])throw new Error("TxO: bad continue record");var h=e[e.l],g=Z0(e,e.lens[f+1]-e.lens[f]-1);if(s+=g,s.length>=(h?c:2*c))break}if(s.length!==c&&s.length!==c*2)throw new Error("cchText: "+c+" != "+s.length);return e.l=a+t,{t:s}}catch{return e.l=a+t,{t:s}}}function fI(e,t){var r=nb(e);e.l+=16;var a=nD(e,t-24);return[r,a]}function hI(e){var t=At(24),r=Xs(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(a[s],16));return yi([t,iD(e[1])])}function pI(e,t){e.read_shift(2);var r=nb(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(_l,""),[r,a]}function gI(e){var t=e[1].Tooltip,r=At(10+2*(t.length+1));r.write_shift(2,2048);var a=Xs(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function mI(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=g4[r]||r,r=e.read_shift(2),t[1]=g4[r]||r,t}function xI(e){return e||(e=At(4)),e.write_shift(2,1),e.write_shift(2,1),e}function bI(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(NN(e));return r}function vI(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(NN(e));return r}function wI(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function UN(e,t,r){if(!r.cellStyles)return ol(e,t);var a=r&&r.biff>=12?4:2,s=e.read_shift(a),n=e.read_shift(a),o=e.read_shift(a),c=e.read_shift(a),u=e.read_shift(2);a==2&&(e.l+=2);var f={s,e:n,w:o,ixfe:c,flags:u};return(r.biff>=5||!r.biff)&&(f.level=u>>8&7),f}function _I(e,t){var r=At(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function yI(e,t){var r={};return t<32||(e.l+=16,r.header=il(e),r.footer=il(e),e.l+=2),r}function kI(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var s=e.read_shift(1);return e.l+=3,s&16&&(a.area=!0),a}function BI(e){for(var t=At(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var CI=Sc,SI=kN,NI=Xp;function EI(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,s}function FI(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=Sc(e);++e.l;var s=Ad(e,t-7,r);return a.t="str",a.val=s,a}function TI(e){var t=Sc(e);++e.l;var r=il(e);return t.t="n",t.val=r,t}function LI(e,t,r){var a=At(15);return eg(a,e,t),a.write_shift(8,r,"f"),a}function jI(e){var t=Sc(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function UI(e,t,r){var a=At(9);return eg(a,e,t),a.write_shift(2,r),a}function DI(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function II(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function QI(e,t,r){var a=e.l+t,s=Sc(e),n=e.read_shift(2),o=Z0(e,n,r);return e.l=a,s.t="str",s.val=o,s}var OI=[2,3,48,49,131,139,140,245],Bw=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=rb({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(c,u){var f=[],h=i0(1);switch(u.type){case"base64":h=wo(Co(c));break;case"binary":h=wo(c);break;case"buffer":case"array":h=c;break}Ii(h,0);var g=h.read_shift(1),x=!!(g&136),m=!1,w=!1;switch(g){case 2:break;case 3:break;case 48:m=!0,x=!0;break;case 49:m=!0,x=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var v=0,B=521;g==2&&(v=h.read_shift(2)),h.l+=3,g!=2&&(v=h.read_shift(4)),v>1048576&&(v=1e6),g!=2&&(B=h.read_shift(2));var k=h.read_shift(2),E=u.codepage||1252;g!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(E=e[h[h.l]]),h.l+=1,h.l+=2),w&&(h.l+=36);for(var S=[],L={},P=Math.min(h.length,g==2?521:B-10-(m?264:0)),R=w?32:11;h.l<P&&h[h.l]!=13;)switch(L={},L.name=Bp.utils.decode(E,h.slice(h.l,h.l+R)).replace(/[\u0000\r\n].*$/g,""),h.l+=R,L.type=String.fromCharCode(h.read_shift(1)),g!=2&&!w&&(L.offset=h.read_shift(4)),L.len=h.read_shift(1),g==2&&(L.offset=h.read_shift(2)),L.dec=h.read_shift(1),L.name.length&&S.push(L),g!=2&&(h.l+=w?13:14),L.type){case"B":(!m||L.len!=8)&&u.WTF&&console.log("Skipping "+L.name+":"+L.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+L.name+":"+L.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+L.type)}if(h[h.l]!==13&&(h.l=B-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=B;var Q=0,V=0;for(f[0]=[],V=0;V!=S.length;++V)f[0][V]=S[V].name;for(;v-- >0;){if(h[h.l]===42){h.l+=k;continue}for(++h.l,f[++Q]=[],V=0,V=0;V!=S.length;++V){var U=h.slice(h.l,h.l+S[V].len);h.l+=S[V].len,Ii(U,0);var M=Bp.utils.decode(E,U);switch(S[V].type){case"C":M.trim().length&&(f[Q][V]=M.replace(/\s+$/,""));break;case"D":M.length===8?f[Q][V]=new Date(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8)):f[Q][V]=M;break;case"F":f[Q][V]=parseFloat(M.trim());break;case"+":case"I":f[Q][V]=w?U.read_shift(-4,"i")^2147483648:U.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":f[Q][V]=!0;break;case"N":case"F":f[Q][V]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));f[Q][V]="##MEMO##"+(w?parseInt(M.trim(),10):U.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(f[Q][V]=+M||0);break;case"@":f[Q][V]=new Date(U.read_shift(-8,"f")-621356832e5);break;case"T":f[Q][V]=new Date((U.read_shift(4)-2440588)*864e5+U.read_shift(4));break;case"Y":f[Q][V]=U.read_shift(4,"i")/1e4+U.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[Q][V]=-U.read_shift(-8,"f");break;case"B":if(m&&S[V].len==8){f[Q][V]=U.read_shift(8,"f");break}case"G":case"P":U.l+=S[V].len;break;case"0":if(S[V].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[V].type)}}}if(g!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return u&&u.sheetRows&&(f=f.slice(0,u.sheetRows)),u.DBF=S,f}function a(c,u){var f=u||{};f.dateNF||(f.dateNF="yyyymmdd");var h=Rf(r(c,f),f);return h["!cols"]=f.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete f.DBF,h}function s(c,u){try{return g0(a(c,u),u)}catch(f){if(u&&u.WTF)throw f}return{SheetNames:[],Sheets:{}}}var n={B:8,C:250,L:1,D:8,"?":0,"":0};function o(c,u){var f=u||{};if(+f.codepage>=0&&SA(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var h=to(),g=Bx(c,{header:1,raw:!0,cellDates:!0}),x=g[0],m=g.slice(1),w=c["!cols"]||[],v=0,B=0,k=0,E=1;for(v=0;v<x.length;++v){if(((w[v]||{}).DBF||{}).name){x[v]=w[v].DBF.name,++k;continue}if(x[v]!=null){if(++k,typeof x[v]=="number"&&(x[v]=x[v].toString(10)),typeof x[v]!="string")throw new Error("DBF Invalid column name "+x[v]+" |"+typeof x[v]+"|");if(x.indexOf(x[v])!==v){for(B=0;B<1024;++B)if(x.indexOf(x[v]+"_"+B)==-1){x[v]+="_"+B;break}}}}var S=Ta(c["!ref"]),L=[],P=[],R=[];for(v=0;v<=S.e.c-S.s.c;++v){var Q="",V="",U=0,M=[];for(B=0;B<m.length;++B)m[B][v]!=null&&M.push(m[B][v]);if(M.length==0||x[v]==null){L[v]="?";continue}for(B=0;B<M.length;++B){switch(typeof M[B]){case"number":V="B";break;case"string":V="C";break;case"boolean":V="L";break;case"object":V=M[B]instanceof Date?"D":"C";break;default:V="C"}U=Math.max(U,String(M[B]).length),Q=Q&&Q!=V?"C":V}U>250&&(U=250),V=((w[v]||{}).DBF||{}).type,V=="C"&&w[v].DBF.len>U&&(U=w[v].DBF.len),Q=="B"&&V=="N"&&(Q="N",R[v]=w[v].DBF.dec,U=w[v].DBF.len),P[v]=Q=="C"||V=="N"?U:n[Q]||0,E+=P[v],L[v]=Q}var T=h.next(32);for(T.write_shift(4,318902576),T.write_shift(4,m.length),T.write_shift(2,296+32*k),T.write_shift(2,E),v=0;v<4;++v)T.write_shift(4,0);for(T.write_shift(4,0|(+t[y3]||3)<<8),v=0,B=0;v<x.length;++v)if(x[v]!=null){var D=h.next(32),G=(x[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,G,"sbcs"),D.write_shift(1,L[v]=="?"?"C":L[v],"sbcs"),D.write_shift(4,B),D.write_shift(1,P[v]||n[L[v]]||0),D.write_shift(1,R[v]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),B+=P[v]||n[L[v]]||0}var ne=h.next(264);for(ne.write_shift(4,13),v=0;v<65;++v)ne.write_shift(4,0);for(v=0;v<m.length;++v){var H=h.next(E);for(H.write_shift(1,0),B=0;B<x.length;++B)if(x[B]!=null)switch(L[B]){case"L":H.write_shift(1,m[v][B]==null?63:m[v][B]?84:70);break;case"B":H.write_shift(8,m[v][B]||0,"f");break;case"N":var ee="0";for(typeof m[v][B]=="number"&&(ee=m[v][B].toFixed(R[B]||0)),k=0;k<P[B]-ee.length;++k)H.write_shift(1,32);H.write_shift(1,ee,"sbcs");break;case"D":m[v][B]?(H.write_shift(4,("0000"+m[v][B].getFullYear()).slice(-4),"sbcs"),H.write_shift(2,("00"+(m[v][B].getMonth()+1)).slice(-2),"sbcs"),H.write_shift(2,("00"+m[v][B].getDate()).slice(-2),"sbcs")):H.write_shift(8,"00000000","sbcs");break;case"C":var le=String(m[v][B]!=null?m[v][B]:"").slice(0,P[B]);for(H.write_shift(1,le,"sbcs"),k=0;k<P[B]-le.length;++k)H.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:s,to_sheet:a,from_sheet:o}})(),DN=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+un(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(x,m){var w=e[m];return typeof w=="number"?qk(w):w},a=function(x,m,w){var v=m.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return v==59?x:qk(v)};e["|"]=254;function s(x,m){switch(m.type){case"base64":return n(Co(x),m);case"binary":return n(x,m);case"buffer":return n(la&&Buffer.isBuffer(x)?x.toString("binary"):p0(x),m);case"array":return n(Y0(x),m)}throw new Error("Unrecognized type "+m.type)}function n(x,m){var w=x.split(/[\n\r]+/),v=-1,B=-1,k=0,E=0,S=[],L=[],P=null,R={},Q=[],V=[],U=[],M=0,T;for(+m.codepage>=0&&SA(+m.codepage);k!==w.length;++k){M=0;var D=w[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),G=D.replace(/;;/g,"\0").split(";").map(function(q){return q.replace(/\u0000/g,";")}),ne=G[0],H;if(D.length>0)switch(ne){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":G[1].charAt(0)=="P"&&L.push(D.slice(3).replace(/;;/g,";"));break;case"C":var ee=!1,le=!1,pe=!1,te=!1,Le=-1,je=-1;for(E=1;E<G.length;++E)switch(G[E].charAt(0)){case"A":break;case"X":B=parseInt(G[E].slice(1))-1,le=!0;break;case"Y":for(v=parseInt(G[E].slice(1))-1,le||(B=0),T=S.length;T<=v;++T)S[T]=[];break;case"K":H=G[E].slice(1),H.charAt(0)==='"'?H=H.slice(1,H.length-1):H==="TRUE"?H=!0:H==="FALSE"?H=!1:isNaN(EA(H))?isNaN(Ff(H).getDate())||(H=Fs(H)):(H=EA(H),P!==null&&Qf(P)&&(H=sb(H))),ee=!0;break;case"E":te=!0;var F=_f(G[E].slice(1),{r:v,c:B});S[v][B]=[S[v][B],F];break;case"S":pe=!0,S[v][B]=[S[v][B],"S5S"];break;case"G":break;case"R":Le=parseInt(G[E].slice(1))-1;break;case"C":je=parseInt(G[E].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}if(ee&&(S[v][B]&&S[v][B].length==2?S[v][B][0]=H:S[v][B]=H,P=null),pe){if(te)throw new Error("SYLK shared formula cannot have own formula");var K=Le>-1&&S[Le][je];if(!K||!K[1])throw new Error("SYLK shared formula cannot find base");S[v][B][1]=ZN(K[1],{r:v-Le,c:B-je})}break;case"F":var I=0;for(E=1;E<G.length;++E)switch(G[E].charAt(0)){case"X":B=parseInt(G[E].slice(1))-1,++I;break;case"Y":for(v=parseInt(G[E].slice(1))-1,T=S.length;T<=v;++T)S[T]=[];break;case"M":M=parseInt(G[E].slice(1))/20;break;case"F":break;case"G":break;case"P":P=L[parseInt(G[E].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(U=G[E].slice(1).split(" "),T=parseInt(U[0],10);T<=parseInt(U[1],10);++T)M=parseInt(U[2],10),V[T-1]=M===0?{hidden:!0}:{wch:M},l0(V[T-1]);break;case"C":B=parseInt(G[E].slice(1))-1,V[B]||(V[B]={});break;case"R":v=parseInt(G[E].slice(1))-1,Q[v]||(Q[v]={}),M>0?(Q[v].hpt=M,Q[v].hpx=Lf(M)):M===0&&(Q[v].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}I<1&&(P=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}}return Q.length>0&&(R["!rows"]=Q),V.length>0&&(R["!cols"]=V),m&&m.sheetRows&&(S=S.slice(0,m.sheetRows)),[S,R]}function o(x,m){var w=s(x,m),v=w[0],B=w[1],k=Rf(v,m);return un(B).forEach(function(E){k[E]=B[E]}),k}function c(x,m){return g0(o(x,m),m)}function u(x,m,w,v){var B="C;Y"+(w+1)+";X"+(v+1)+";K";switch(x.t){case"n":B+=x.v||0,x.f&&!x.F&&(B+=";E"+a_(x.f,{r:w,c:v}));break;case"b":B+=x.v?"TRUE":"FALSE";break;case"e":B+=x.w||x.v;break;case"d":B+='"'+(x.w||x.v)+'"';break;case"s":B+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return B}function f(x,m){m.forEach(function(w,v){var B="F;W"+(v+1)+" "+(v+1)+" ";w.hidden?B+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=jp(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=Up(w.wpx)),typeof w.wch=="number"&&(B+=Math.round(w.wch))),B.charAt(B.length-1)!=" "&&x.push(B)})}function h(x,m){m.forEach(function(w,v){var B="F;";w.hidden?B+="M0;":w.hpt?B+="M"+20*w.hpt+";":w.hpx&&(B+="M"+20*Dp(w.hpx)+";"),B.length>2&&x.push(B+"R"+(v+1))})}function g(x,m){var w=["ID;PWXL;N;E"],v=[],B=Ta(x["!ref"]),k,E=Array.isArray(x),S=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),x["!cols"]&&f(w,x["!cols"]),x["!rows"]&&h(w,x["!rows"]),w.push("B;Y"+(B.e.r-B.s.r+1)+";X"+(B.e.c-B.s.c+1)+";D"+[B.s.c,B.s.r,B.e.c,B.e.r].join(" "));for(var L=B.s.r;L<=B.e.r;++L)for(var P=B.s.c;P<=B.e.c;++P){var R=Kr({r:L,c:P});k=E?(x[L]||[])[P]:x[R],!(!k||k.v==null&&(!k.f||k.F))&&v.push(u(k,x,L,P))}return w.join(S)+S+v.join(S)+S+"E"+S}return{to_workbook:c,to_sheet:o,from_sheet:g}})(),IN=(function(){function e(n,o){switch(o.type){case"base64":return t(Co(n),o);case"binary":return t(n,o);case"buffer":return t(la&&Buffer.isBuffer(n)?n.toString("binary"):p0(n),o);case"array":return t(Y0(n),o)}throw new Error("Unrecognized type "+o.type)}function t(n,o){for(var c=n.split(`
`),u=-1,f=-1,h=0,g=[];h!==c.length;++h){if(c[h].trim()==="BOT"){g[++u]=[],f=0;continue}if(!(u<0)){var x=c[h].trim().split(","),m=x[0],w=x[1];++h;for(var v=c[h]||"";(v.match(/["]/g)||[]).length&1&&h<c.length-1;)v+=`
`+c[++h];switch(v=v.trim(),+m){case-1:if(v==="BOT"){g[++u]=[],f=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?g[u][f]=!0:v==="FALSE"?g[u][f]=!1:isNaN(EA(w))?isNaN(Ff(w).getDate())?g[u][f]=w:g[u][f]=Fs(w):g[u][f]=EA(w),++f;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),g[u][f++]=v!==""?v:null;break}if(v==="EOD")break}}return o&&o.sheetRows&&(g=g.slice(0,o.sheetRows)),g}function r(n,o){return Rf(e(n,o),o)}function a(n,o){return g0(r(n,o),o)}var s=(function(){var n=function(u,f,h,g,x){u.push(f),u.push(h+","+g),u.push('"'+x.replace(/"/g,'""')+'"')},o=function(u,f,h,g){u.push(f+","+h),u.push(f==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(u){var f=[],h=Ta(u["!ref"]),g,x=Array.isArray(u);n(f,"TABLE",0,1,"sheetjs"),n(f,"VECTORS",0,h.e.r-h.s.r+1,""),n(f,"TUPLES",0,h.e.c-h.s.c+1,""),n(f,"DATA",0,0,"");for(var m=h.s.r;m<=h.e.r;++m){o(f,-1,0,"BOT");for(var w=h.s.c;w<=h.e.c;++w){var v=Kr({r:m,c:w});if(g=x?(u[m]||[])[w]:u[v],!g){o(f,1,0,"");continue}switch(g.t){case"n":var B=g.w;!B&&g.v!=null&&(B=g.v),B==null?g.f&&!g.F?o(f,1,0,"="+g.f):o(f,1,0,""):o(f,0,B,"V");break;case"b":o(f,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":o(f,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=rA(g.z||Rr[14],ui(Fs(g.v)))),o(f,0,g.w,"V");break;default:o(f,1,0,"")}}}o(f,-1,0,"EOD");var k=`\r
`,E=f.join(k);return E}})();return{to_workbook:a,to_sheet:r,from_sheet:s}})(),QN=(function(){function e(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(g,x){for(var m=g.split(`
`),w=-1,v=-1,B=0,k=[];B!==m.length;++B){var E=m[B].trim().split(":");if(E[0]==="cell"){var S=Xs(E[1]);if(k.length<=S.r)for(w=k.length;w<=S.r;++w)k[w]||(k[w]=[]);switch(w=S.r,v=S.c,E[2]){case"t":k[w][v]=e(E[3]);break;case"v":k[w][v]=+E[3];break;case"vtf":var L=E[E.length-1];case"vtc":E[3]==="nl"?k[w][v]=!!+E[4]:k[w][v]=+E[4],E[2]=="vtf"&&(k[w][v]=[k[w][v],L])}}}return x&&x.sheetRows&&(k=k.slice(0,x.sheetRows)),k}function a(g,x){return Rf(r(g,x),x)}function s(g,x){return g0(a(g,x),x)}var n=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function f(g){if(!g||!g["!ref"])return"";for(var x=[],m=[],w,v="",B=ro(g["!ref"]),k=Array.isArray(g),E=B.s.r;E<=B.e.r;++E)for(var S=B.s.c;S<=B.e.c;++S)if(v=Kr({r:E,c:S}),w=k?(g[E]||[])[S]:g[v],!(!w||w.v==null||w.t==="z")){switch(m=["cell",v,"t"],w.t){case"s":case"str":m.push(t(w.v));break;case"n":w.f?(m[2]="vtf",m[3]="n",m[4]=w.v,m[5]=t(w.f)):(m[2]="v",m[3]=w.v);break;case"b":m[2]="vt"+(w.f?"f":"c"),m[3]="nl",m[4]=w.v?"1":"0",m[5]=t(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var L=ui(Fs(w.v));m[2]="vtc",m[3]="nd",m[4]=""+L,m[5]=w.w||rA(w.z||Rr[14],L);break;case"e":continue}x.push(m.join(":"))}return x.push("sheet:c:"+(B.e.c-B.s.c+1)+":r:"+(B.e.r-B.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function h(g){return[n,o,c,o,f(g),u].join(`
`)}return{to_workbook:s,to_sheet:a,from_sheet:h}})(),Tf=(function(){function e(h,g,x,m,w){w.raw?g[x][m]=h:h===""||(h==="TRUE"?g[x][m]=!0:h==="FALSE"?g[x][m]=!1:isNaN(EA(h))?isNaN(Ff(h).getDate())?g[x][m]=h:g[x][m]=Fs(h):g[x][m]=EA(h))}function t(h,g){var x=g||{},m=[];if(!h||h.length===0)return m;for(var w=h.split(/[\r\n]/),v=w.length-1;v>=0&&w[v].length===0;)--v;for(var B=10,k=0,E=0;E<=v;++E)k=w[E].indexOf(" "),k==-1?k=w[E].length:k++,B=Math.max(B,k);for(E=0;E<=v;++E){m[E]=[];var S=0;for(e(w[E].slice(0,B).trim(),m,E,S,x),S=1;S<=(w[E].length-B)/10+1;++S)e(w[E].slice(B+(S-1)*10,B+S*10).trim(),m,E,S,x)}return x.sheetRows&&(m=m.slice(0,x.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function s(h){for(var g={},x=!1,m=0,w=0;m<h.length;++m)(w=h.charCodeAt(m))==34?x=!x:!x&&w in r&&(g[w]=(g[w]||0)+1);w=[];for(m in g)Object.prototype.hasOwnProperty.call(g,m)&&w.push([g[m],m]);if(!w.length){g=a;for(m in g)Object.prototype.hasOwnProperty.call(g,m)&&w.push([g[m],m])}return w.sort(function(v,B){return v[0]-B[0]||a[v[1]]-a[B[1]]}),r[w.pop()[1]]||44}function n(h,g){var x=g||{},m="",w=x.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(m=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(m=h.charAt(4),h=h.slice(6)):m=s(h.slice(0,1024)):x&&x.FS?m=x.FS:m=s(h.slice(0,1024));var B=0,k=0,E=0,S=0,L=0,P=m.charCodeAt(0),R=!1,Q=0,V=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var U=x.dateNF!=null?kU(x.dateNF):null;function M(){var T=h.slice(S,L),D={};if(T.charAt(0)=='"'&&T.charAt(T.length-1)=='"'&&(T=T.slice(1,-1).replace(/""/g,'"')),T.length===0)D.t="z";else if(x.raw)D.t="s",D.v=T;else if(T.trim().length===0)D.t="s",D.v=T;else if(T.charCodeAt(0)==61)T.charCodeAt(1)==34&&T.charCodeAt(T.length-1)==34?(D.t="s",D.v=T.slice(2,-1).replace(/""/g,'"')):ZO(T)?(D.t="n",D.f=T.slice(1)):(D.t="s",D.v=T);else if(T=="TRUE")D.t="b",D.v=!0;else if(T=="FALSE")D.t="b",D.v=!1;else if(!isNaN(E=EA(T)))D.t="n",x.cellText!==!1&&(D.w=T),D.v=E;else if(!isNaN(Ff(T).getDate())||U&&T.match(U)){D.z=x.dateNF||Rr[14];var G=0;U&&T.match(U)&&(T=BU(T,x.dateNF,T.match(U)||[]),G=1),x.cellDates?(D.t="d",D.v=Fs(T,G)):(D.t="n",D.v=ui(Fs(T,G))),x.cellText!==!1&&(D.w=rA(D.z,D.v instanceof Date?ui(D.v):D.v)),x.cellNF||delete D.z}else D.t="s",D.v=T;if(D.t=="z"||(x.dense?(w[B]||(w[B]=[]),w[B][k]=D):w[Kr({c:k,r:B})]=D),S=L+1,V=h.charCodeAt(S),v.e.c<k&&(v.e.c=k),v.e.r<B&&(v.e.r=B),Q==P)++k;else if(k=0,++B,x.sheetRows&&x.sheetRows<=B)return!0}e:for(;L<h.length;++L)switch(Q=h.charCodeAt(L)){case 34:V===34&&(R=!R);break;case P:case 10:case 13:if(!R&&M())break e;break}return L-S>0&&M(),w["!ref"]=aa(v),w}function o(h,g){return!(g&&g.PRN)||g.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?n(h,g):Rf(t(h,g),g)}function c(h,g){var x="",m=g.type=="string"?[0,0,0,0]:u_(h,g);switch(g.type){case"base64":x=Co(h);break;case"binary":x=h;break;case"buffer":g.codepage==65001?x=h.toString("utf8"):g.codepage&&typeof Bp<"u"||(x=la&&Buffer.isBuffer(h)?h.toString("binary"):p0(h));break;case"array":x=Y0(h);break;case"string":x=h;break;default:throw new Error("Unrecognized type "+g.type)}return m[0]==239&&m[1]==187&&m[2]==191?x=is(x.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?x=is(x):g.type=="binary"&&typeof Bp<"u",x.slice(0,19)=="socialcalc:version:"?QN.to_sheet(g.type=="string"?x:is(x),g):o(x,g)}function u(h,g){return g0(c(h,g),g)}function f(h){for(var g=[],x=Ta(h["!ref"]),m,w=Array.isArray(h),v=x.s.r;v<=x.e.r;++v){for(var B=[],k=x.s.c;k<=x.e.c;++k){var E=Kr({r:v,c:k});if(m=w?(h[v]||[])[k]:h[E],!m||m.v==null){B.push("          ");continue}for(var S=(m.w||(lu(m),m.w)||"").slice(0,10);S.length<10;)S+=" ";B.push(S+(k===0?" ":""))}g.push(B.join(""))}return g.join(`
`)}return{to_workbook:u,to_sheet:c,from_sheet:f}})();function RI(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var s=DN.to_workbook(e,r);return r.WTF=a,s}catch(n){if(r.WTF=a,!n.message.match(/SYLK bad record ID/)&&a)throw n;return Tf.to_workbook(e,t)}}var K0=(function(){function e(F,K,I){if(F){Ii(F,F.l||0);for(var q=I.Enum||Le;F.l<F.length;){var J=F.read_shift(2),Y=q[J]||q[65535],de=F.read_shift(2),ue=F.l+de,we=Y.f&&Y.f(F,de,I);if(F.l=ue,K(we,Y,J))return}}}function t(F,K){switch(K.type){case"base64":return r(wo(Co(F)),K);case"binary":return r(wo(F),K);case"buffer":case"array":return r(F,K)}throw"Unsupported type "+K.type}function r(F,K){if(!F)return F;var I=K||{},q=I.dense?[]:{},J="Sheet1",Y="",de=0,ue={},we=[],Ie=[],Ae={s:{r:0,c:0},e:{r:0,c:0}},oe=I.sheetRows||0;if(F[2]==0&&(F[3]==8||F[3]==9)&&F.length>=16&&F[14]==5&&F[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(F[2]==2)I.Enum=Le,e(F,function(Ye,at,Ge){switch(Ge){case 0:I.vers=Ye,Ye>=4096&&(I.qpro=!0);break;case 6:Ae=Ye;break;case 204:Ye&&(Y=Ye);break;case 222:Y=Ye;break;case 15:case 51:I.qpro||(Ye[1].v=Ye[1].v.slice(1));case 13:case 14:case 16:Ge==14&&(Ye[2]&112)==112&&(Ye[2]&15)>1&&(Ye[2]&15)<15&&(Ye[1].z=I.dateNF||Rr[14],I.cellDates&&(Ye[1].t="d",Ye[1].v=sb(Ye[1].v))),I.qpro&&Ye[3]>de&&(q["!ref"]=aa(Ae),ue[J]=q,we.push(J),q=I.dense?[]:{},Ae={s:{r:0,c:0},e:{r:0,c:0}},de=Ye[3],J=Y||"Sheet"+(de+1),Y="");var pt=I.dense?(q[Ye[0].r]||[])[Ye[0].c]:q[Kr(Ye[0])];if(pt){pt.t=Ye[1].t,pt.v=Ye[1].v,Ye[1].z!=null&&(pt.z=Ye[1].z),Ye[1].f!=null&&(pt.f=Ye[1].f);break}I.dense?(q[Ye[0].r]||(q[Ye[0].r]=[]),q[Ye[0].r][Ye[0].c]=Ye[1]):q[Kr(Ye[0])]=Ye[1];break}},I);else if(F[2]==26||F[2]==14)I.Enum=je,F[2]==14&&(I.qpro=!0,F.l=0),e(F,function(Ye,at,Ge){switch(Ge){case 204:J=Ye;break;case 22:Ye[1].v=Ye[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ye[3]>de&&(q["!ref"]=aa(Ae),ue[J]=q,we.push(J),q=I.dense?[]:{},Ae={s:{r:0,c:0},e:{r:0,c:0}},de=Ye[3],J="Sheet"+(de+1)),oe>0&&Ye[0].r>=oe)break;I.dense?(q[Ye[0].r]||(q[Ye[0].r]=[]),q[Ye[0].r][Ye[0].c]=Ye[1]):q[Kr(Ye[0])]=Ye[1],Ae.e.c<Ye[0].c&&(Ae.e.c=Ye[0].c),Ae.e.r<Ye[0].r&&(Ae.e.r=Ye[0].r);break;case 27:Ye[14e3]&&(Ie[Ye[14e3][0]]=Ye[14e3][1]);break;case 1537:Ie[Ye[0]]=Ye[1],Ye[0]==de&&(J=Ye[1]);break}},I);else throw new Error("Unrecognized LOTUS BOF "+F[2]);if(q["!ref"]=aa(Ae),ue[Y||J]=q,we.push(Y||J),!Ie.length)return{SheetNames:we,Sheets:ue};for(var He={},se=[],qe=0;qe<Ie.length;++qe)ue[we[qe]]?(se.push(Ie[qe]||we[qe]),He[Ie[qe]]=ue[Ie[qe]]||ue[we[qe]]):(se.push(Ie[qe]),He[Ie[qe]]={"!ref":"A1"});return{SheetNames:se,Sheets:He}}function a(F,K){var I=K||{};if(+I.codepage>=0&&SA(+I.codepage),I.type=="string")throw new Error("Cannot write WK1 to JS string");var q=to(),J=Ta(F["!ref"]),Y=Array.isArray(F),de=[];Pt(q,0,n(1030)),Pt(q,6,u(J));for(var ue=Math.min(J.e.r,8191),we=J.s.r;we<=ue;++we)for(var Ie=En(we),Ae=J.s.c;Ae<=J.e.c;++Ae){we===J.s.r&&(de[Ae]=$s(Ae));var oe=de[Ae]+Ie,He=Y?(F[we]||[])[Ae]:F[oe];if(!(!He||He.t=="z"))if(He.t=="n")(He.v|0)==He.v&&He.v>=-32768&&He.v<=32767?Pt(q,13,m(we,Ae,He.v)):Pt(q,14,v(we,Ae,He.v));else{var se=lu(He);Pt(q,15,g(we,Ae,se.slice(0,239)))}}return Pt(q,1),q.end()}function s(F,K){var I=K||{};if(+I.codepage>=0&&SA(+I.codepage),I.type=="string")throw new Error("Cannot write WK3 to JS string");var q=to();Pt(q,0,o(F));for(var J=0,Y=0;J<F.SheetNames.length;++J)(F.Sheets[F.SheetNames[J]]||{})["!ref"]&&Pt(q,27,te(F.SheetNames[J],Y++));var de=0;for(J=0;J<F.SheetNames.length;++J){var ue=F.Sheets[F.SheetNames[J]];if(!(!ue||!ue["!ref"])){for(var we=Ta(ue["!ref"]),Ie=Array.isArray(ue),Ae=[],oe=Math.min(we.e.r,8191),He=we.s.r;He<=oe;++He)for(var se=En(He),qe=we.s.c;qe<=we.e.c;++qe){He===we.s.r&&(Ae[qe]=$s(qe));var Ye=Ae[qe]+se,at=Ie?(ue[He]||[])[qe]:ue[Ye];if(!(!at||at.t=="z"))if(at.t=="n")Pt(q,23,M(He,qe,de,at.v));else{var Ge=lu(at);Pt(q,22,Q(He,qe,de,Ge.slice(0,239)))}}++de}}return Pt(q,1),q.end()}function n(F){var K=At(2);return K.write_shift(2,F),K}function o(F){var K=At(26);K.write_shift(2,4096),K.write_shift(2,4),K.write_shift(4,0);for(var I=0,q=0,J=0,Y=0;Y<F.SheetNames.length;++Y){var de=F.SheetNames[Y],ue=F.Sheets[de];if(!(!ue||!ue["!ref"])){++J;var we=ro(ue["!ref"]);I<we.e.r&&(I=we.e.r),q<we.e.c&&(q=we.e.c)}}return I>8191&&(I=8191),K.write_shift(2,I),K.write_shift(1,J),K.write_shift(1,q),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(1,1),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(4,0),K}function c(F,K,I){var q={s:{c:0,r:0},e:{c:0,r:0}};return K==8&&I.qpro?(q.s.c=F.read_shift(1),F.l++,q.s.r=F.read_shift(2),q.e.c=F.read_shift(1),F.l++,q.e.r=F.read_shift(2),q):(q.s.c=F.read_shift(2),q.s.r=F.read_shift(2),K==12&&I.qpro&&(F.l+=2),q.e.c=F.read_shift(2),q.e.r=F.read_shift(2),K==12&&I.qpro&&(F.l+=2),q.s.c==65535&&(q.s.c=q.e.c=q.s.r=q.e.r=0),q)}function u(F){var K=At(8);return K.write_shift(2,F.s.c),K.write_shift(2,F.s.r),K.write_shift(2,F.e.c),K.write_shift(2,F.e.r),K}function f(F,K,I){var q=[{c:0,r:0},{t:"n",v:0},0,0];return I.qpro&&I.vers!=20768?(q[0].c=F.read_shift(1),q[3]=F.read_shift(1),q[0].r=F.read_shift(2),F.l+=2):(q[2]=F.read_shift(1),q[0].c=F.read_shift(2),q[0].r=F.read_shift(2)),q}function h(F,K,I){var q=F.l+K,J=f(F,K,I);if(J[1].t="s",I.vers==20768){F.l++;var Y=F.read_shift(1);return J[1].v=F.read_shift(Y,"utf8"),J}return I.qpro&&F.l++,J[1].v=F.read_shift(q-F.l,"cstr"),J}function g(F,K,I){var q=At(7+I.length);q.write_shift(1,255),q.write_shift(2,K),q.write_shift(2,F),q.write_shift(1,39);for(var J=0;J<q.length;++J){var Y=I.charCodeAt(J);q.write_shift(1,Y>=128?95:Y)}return q.write_shift(1,0),q}function x(F,K,I){var q=f(F,K,I);return q[1].v=F.read_shift(2,"i"),q}function m(F,K,I){var q=At(7);return q.write_shift(1,255),q.write_shift(2,K),q.write_shift(2,F),q.write_shift(2,I,"i"),q}function w(F,K,I){var q=f(F,K,I);return q[1].v=F.read_shift(8,"f"),q}function v(F,K,I){var q=At(13);return q.write_shift(1,255),q.write_shift(2,K),q.write_shift(2,F),q.write_shift(8,I,"f"),q}function B(F,K,I){var q=F.l+K,J=f(F,K,I);if(J[1].v=F.read_shift(8,"f"),I.qpro)F.l=q;else{var Y=F.read_shift(2);L(F.slice(F.l,F.l+Y),J),F.l+=Y}return J}function k(F,K,I){var q=K&32768;return K&=-32769,K=(q?F:0)+(K>=8192?K-16384:K),(q?"":"$")+(I?$s(K):En(K))}var E={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},S=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function L(F,K){Ii(F,0);for(var I=[],q=0,J="",Y="",de="",ue="";F.l<F.length;){var we=F[F.l++];switch(we){case 0:I.push(F.read_shift(8,"f"));break;case 1:Y=k(K[0].c,F.read_shift(2),!0),J=k(K[0].r,F.read_shift(2),!1),I.push(Y+J);break;case 2:{var Ie=k(K[0].c,F.read_shift(2),!0),Ae=k(K[0].r,F.read_shift(2),!1);Y=k(K[0].c,F.read_shift(2),!0),J=k(K[0].r,F.read_shift(2),!1),I.push(Ie+Ae+":"+Y+J)}break;case 3:if(F.l<F.length){console.error("WK1 premature formula end");return}break;case 4:I.push("("+I.pop()+")");break;case 5:I.push(F.read_shift(2));break;case 6:{for(var oe="";we=F[F.l++];)oe+=String.fromCharCode(we);I.push('"'+oe.replace(/"/g,'""')+'"')}break;case 8:I.push("-"+I.pop());break;case 23:I.push("+"+I.pop());break;case 22:I.push("NOT("+I.pop()+")");break;case 20:case 21:ue=I.pop(),de=I.pop(),I.push(["AND","OR"][we-20]+"("+de+","+ue+")");break;default:if(we<32&&S[we])ue=I.pop(),de=I.pop(),I.push(de+S[we]+ue);else if(E[we]){if(q=E[we][1],q==69&&(q=F[F.l++]),q>I.length){console.error("WK1 bad formula parse 0x"+we.toString(16)+":|"+I.join("|")+"|");return}var He=I.slice(-q);I.length-=q,I.push(E[we][0]+"("+He.join(",")+")")}else return we<=7?console.error("WK1 invalid opcode "+we.toString(16)):we<=24?console.error("WK1 unsupported op "+we.toString(16)):we<=30?console.error("WK1 invalid opcode "+we.toString(16)):we<=115?console.error("WK1 unsupported function opcode "+we.toString(16)):console.error("WK1 unrecognized opcode "+we.toString(16))}}I.length==1?K[1].f=""+I[0]:console.error("WK1 bad formula parse |"+I.join("|")+"|")}function P(F){var K=[{c:0,r:0},{t:"n",v:0},0];return K[0].r=F.read_shift(2),K[3]=F[F.l++],K[0].c=F[F.l++],K}function R(F,K){var I=P(F);return I[1].t="s",I[1].v=F.read_shift(K-4,"cstr"),I}function Q(F,K,I,q){var J=At(6+q.length);J.write_shift(2,F),J.write_shift(1,I),J.write_shift(1,K),J.write_shift(1,39);for(var Y=0;Y<q.length;++Y){var de=q.charCodeAt(Y);J.write_shift(1,de>=128?95:de)}return J.write_shift(1,0),J}function V(F,K){var I=P(F);I[1].v=F.read_shift(2);var q=I[1].v>>1;if(I[1].v&1)switch(q&7){case 0:q=(q>>3)*5e3;break;case 1:q=(q>>3)*500;break;case 2:q=(q>>3)/20;break;case 3:q=(q>>3)/200;break;case 4:q=(q>>3)/2e3;break;case 5:q=(q>>3)/2e4;break;case 6:q=(q>>3)/16;break;case 7:q=(q>>3)/64;break}return I[1].v=q,I}function U(F,K){var I=P(F),q=F.read_shift(4),J=F.read_shift(4),Y=F.read_shift(2);if(Y==65535)return q===0&&J===3221225472?(I[1].t="e",I[1].v=15):q===0&&J===3489660928?(I[1].t="e",I[1].v=42):I[1].v=0,I;var de=Y&32768;return Y=(Y&32767)-16446,I[1].v=(1-de*2)*(J*Math.pow(2,Y+32)+q*Math.pow(2,Y)),I}function M(F,K,I,q){var J=At(14);if(J.write_shift(2,F),J.write_shift(1,I),J.write_shift(1,K),q==0)return J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,65535),J;var Y=0,de=0,ue=0,we=0;return q<0&&(Y=1,q=-q),de=Math.log2(q)|0,q/=Math.pow(2,de-31),we=q>>>0,(we&2147483648)==0&&(q/=2,++de,we=q>>>0),q-=we,we|=2147483648,we>>>=0,q*=Math.pow(2,32),ue=q>>>0,J.write_shift(4,ue),J.write_shift(4,we),de+=16383+(Y?32768:0),J.write_shift(2,de),J}function T(F,K){var I=U(F);return F.l+=K-14,I}function D(F,K){var I=P(F),q=F.read_shift(4);return I[1].v=q>>6,I}function G(F,K){var I=P(F),q=F.read_shift(8,"f");return I[1].v=q,I}function ne(F,K){var I=G(F);return F.l+=K-10,I}function H(F,K){return F[F.l+K-1]==0?F.read_shift(K,"cstr"):""}function ee(F,K){var I=F[F.l++];I>K-1&&(I=K-1);for(var q="";q.length<I;)q+=String.fromCharCode(F[F.l++]);return q}function le(F,K,I){if(!(!I.qpro||K<21)){var q=F.read_shift(1);F.l+=17,F.l+=1,F.l+=2;var J=F.read_shift(K-21,"cstr");return[q,J]}}function pe(F,K){for(var I={},q=F.l+K;F.l<q;){var J=F.read_shift(2);if(J==14e3){for(I[J]=[0,""],I[J][0]=F.read_shift(2);F[F.l];)I[J][1]+=String.fromCharCode(F[F.l]),F.l++;F.l++}}return I}function te(F,K){var I=At(5+F.length);I.write_shift(2,14e3),I.write_shift(2,K);for(var q=0;q<F.length;++q){var J=F.charCodeAt(q);I[I.l++]=J>127?95:J}return I[I.l++]=0,I}var Le={0:{n:"BOF",f:qn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:B},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:H},222:{n:"SHEETNAMELP",f:ee},65535:{n:""}},je={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:R},23:{n:"NUMBER17",f:U},24:{n:"NUMBER18",f:V},25:{n:"FORMULA19",f:T},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:pe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:G},40:{n:"FORMULA28",f:ne},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:H},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:le},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:s,to_workbook:t}})();function MI(e){var t={},r=e.match(Al),a=0,s=!1;if(r)for(;a!=r.length;++a){var n=zr(r[a]);switch(n[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!n.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(n.val=="1")break;t.cp=N2[parseInt(n.val,10)];break;case"<outline":if(!n.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=n.val;break;case"<sz":t.sz=n.val;break;case"<strike":if(!n.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!n.val)break;switch(n.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(n.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(n.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":n.rgb&&(t.color=n.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=n.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=n.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+n[0])}}return t}var HI=(function(){var e=Np("t"),t=Np("rPr");function r(n){var o=n.match(e);if(!o)return{t:"s",v:""};var c={t:"s",v:Fa(o[1])},u=n.match(t);return u&&(c.s=MI(u[1])),c}var a=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(o){return o.replace(a,"").split(s).map(r).filter(function(c){return c.v})}})(),PI=(function(){var t=/(\r\n|\n)/g;function r(s,n,o){var c=[];s.u&&c.push("text-decoration: underline;"),s.uval&&c.push("text-underline-style:"+s.uval+";"),s.sz&&c.push("font-size:"+s.sz+"pt;"),s.outline&&c.push("text-effect: outline;"),s.shadow&&c.push("text-shadow: auto;"),n.push('<span style="'+c.join("")+'">'),s.b&&(n.push("<b>"),o.push("</b>")),s.i&&(n.push("<i>"),o.push("</i>")),s.strike&&(n.push("<s>"),o.push("</s>"));var u=s.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(n.push("<"+u+">"),o.push("</"+u+">")),o.push("</span>"),s}function a(s){var n=[[],s.v,[]];return s.v?(s.s&&r(s.s,n[0],n[2]),n[0].join("")+n[1].replace(t,"<br/>")+n[2].join("")):""}return function(n){return n.map(a).join("")}})(),qI=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,KI=/<(?:\w+:)?r>/,zI=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function J2(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=Fa(is(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=is(e),r&&(a.h=O2(a.t))):e.match(KI)&&(a.r=is(e),a.t=Fa(is((e.replace(zI,"").match(qI)||[]).join("").replace(Al,""))),r&&(a.h=PI(HI(a.r)))),a):{t:""}}var VI=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,GI=/<(?:\w+:)?(?:si|sstItem)>/g,WI=/<\/(?:\w+:)?(?:si|sstItem)>/;function $I(e,t){var r=[],a="";if(!e)return r;var s=e.match(VI);if(s){a=s[2].replace(GI,"").split(WI);for(var n=0;n!=a.length;++n){var o=J2(a[n].trim(),t);o!=null&&(r[r.length]=o)}s=zr(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var XI=/^\s|\s$|[\t\n\r]/;function ON(e,t){if(!t.bookSST)return"";var r=[Fn];r[r.length]=Mt("sst",null,{xmlns:sd[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var s=e[a],n="<si>";s.r?n+=s.r:(n+="<t",s.t||(s.t=""),s.t.match(XI)&&(n+=' xml:space="preserve"'),n+=">"+Ja(s.t)+"</t>"),n+="</si>",r[r.length]=n}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function YI(e){return[e.read_shift(4),e.read_shift(4)]}function JI(e,t){var r=[],a=!1;return cu(e,function(n,o,c){switch(c){case 159:r.Count=n[0],r.Unique=n[1];break;case 19:r.push(n);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(o.T,!a||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function ZI(e,t){return t||(t=At(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var eQ=c7;function tQ(e){var t=to();kt(t,159,ZI(e));for(var r=0;r<e.length;++r)kt(t,19,eQ(e[r]));return kt(t,160),t.end()}function RN(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function su(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function rQ(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=su(e,4),t.U=su(e,4),t.W=su(e,4),t}function aQ(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},s=e.read_shift(4),n=[];s-- >0;)n.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=n,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function sQ(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(aQ(e));return t}function nQ(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function iQ(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=su(e,4),t.U=su(e,4),t.W=su(e,4),t}function lQ(e){var t=iQ(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function MN(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var s=!1;switch(a.AlgID){case 26126:case 26127:case 26128:s=a.Flags==36;break;case 26625:s=a.Flags==4;break;case 0:s=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function HN(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function oQ(e){var t=su(e);switch(t.Minor){case 2:return[t.Minor,AQ(e)];case 3:return[t.Minor,cQ()];case 4:return[t.Minor,uQ(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function AQ(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=MN(e,r),s=HN(e,e.length-e.l);return{t:"Std",h:a,v:s}}function cQ(){throw new Error("File is password-protected: ECMA-376 Extensible")}function uQ(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(Al,function(n){var o=zr(n);switch(Cc(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(c){a[c]=o[c]});break;case"<dataIntegrity":a.encryptedHmacKey=o.encryptedHmacKey,a.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(o);break;default:throw o[0]}}),a}function dQ(e,t){var r={},a=r.EncryptionVersionInfo=su(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=MN(e,s),t-=s,r.EncryptionVerifier=HN(e,t),r}function fQ(e){var t={},r=t.EncryptionVersionInfo=su(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Z2(e){var t=0,r,a=RN(e),s=a.length+1,n,o,c,u,f;for(r=i0(s),r[0]=a.length,n=1;n!=s;++n)r[n]=a[n-1];for(n=s-1;n>=0;--n)o=r[n],c=(t&16384)===0?0:1,u=t<<1&32767,f=c|u,t=f^o;return t^52811}var PN=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(o){return(o/2|o*128)&255},s=function(o,c){return a(o^c)},n=function(o){for(var c=t[o.length-1],u=104,f=o.length-1;f>=0;--f)for(var h=o[f],g=0;g!=7;++g)h&64&&(c^=r[u]),h*=2,--u;return c};return function(o){for(var c=RN(o),u=n(c),f=c.length,h=i0(16),g=0;g!=16;++g)h[g]=0;var x,m,w;for((f&1)===1&&(x=u>>8,h[f]=s(e[0],x),--f,x=u&255,m=c[c.length-1],h[f]=s(m,x));f>0;)--f,x=u>>8,h[f]=s(c[f],x),--f,x=u&255,h[f]=s(c[f],x);for(f=15,w=15-c.length;w>0;)x=u>>8,h[f]=s(e[w],x),--f,--w,x=u&255,h[f]=s(c[f],x),--f,--w;return h}})(),hQ=function(e,t,r,a,s){s||(s=t),a||(a=PN(e));var n,o;for(n=0;n!=t.length;++n)o=t[n],o^=a[r],o=(o>>5|o<<3)&255,s[n]=o,++r;return[s,r,a]},pQ=function(e){var t=0,r=PN(e);return function(a){var s=hQ("",a,t,r);return t=s[1],s[0]}};function gQ(e,t,r,a){var s={key:qn(e),verificationBytes:qn(e)};return r.password&&(s.verifier=Z2(r.password)),a.valid=s.verificationBytes===s.verifier,a.valid&&(a.insitu=pQ(r.password)),s}function mQ(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=fQ(e):a.Data=dQ(e,t),a}function xQ(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?mQ(e,t-2,a):gQ(e,r.biff>=8?t:t-2,r,a),a}var qN=(function(){function e(s,n){switch(n.type){case"base64":return t(Co(s),n);case"binary":return t(s,n);case"buffer":return t(la&&Buffer.isBuffer(s)?s.toString("binary"):p0(s),n);case"array":return t(Y0(s),n)}throw new Error("Unrecognized type "+n.type)}function t(s,n){var o=n||{},c=o.dense?[]:{},u=s.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(h,g){Array.isArray(c)&&(c[g]=[]);for(var x=/\\\w+\b/g,m=0,w,v=-1;w=x.exec(h);){switch(w[0]){case"\\cell":var B=h.slice(m,x.lastIndex-w[0].length);if(B[0]==" "&&(B=B.slice(1)),++v,B.length){var k={v:B,t:"s"};Array.isArray(c)?c[g][v]=k:c[Kr({r:g,c:v})]=k}break}m=x.lastIndex}v>f.e.c&&(f.e.c=v)}),c["!ref"]=aa(f),c}function r(s,n){return g0(e(s,n),n)}function a(s){for(var n=["{\\rtf1\\ansi"],o=Ta(s["!ref"]),c,u=Array.isArray(s),f=o.s.r;f<=o.e.r;++f){n.push("\\trowd\\trautofit1");for(var h=o.s.c;h<=o.e.c;++h)n.push("\\cellx"+(h+1));for(n.push("\\pard\\intbl"),h=o.s.c;h<=o.e.c;++h){var g=Kr({r:f,c:h});c=u?(s[f]||[])[h]:s[g],!(!c||c.v==null&&(!c.f||c.F))&&(n.push(" "+(c.w||(lu(c),c.w))),n.push("\\cell"))}n.push("\\pard\\intbl\\row")}return n.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}})();function bQ(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Lp(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function vQ(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,s=Math.max(t,r,a),n=Math.min(t,r,a),o=s-n;if(o===0)return[0,0,t];var c=0,u=0,f=s+n;switch(u=o/(f>1?2-f:f),s){case t:c=((r-a)/o+6)%6;break;case r:c=(a-t)/o+2;break;case a:c=(t-r)/o+4;break}return[c/6,u,f/2]}function wQ(e){var t=e[0],r=e[1],a=e[2],s=r*2*(a<.5?a:1-a),n=a-s/2,o=[n,n,n],c=6*t,u;if(r!==0)switch(c|0){case 0:case 6:u=s*c,o[0]+=s,o[1]+=u;break;case 1:u=s*(2-c),o[0]+=u,o[1]+=s;break;case 2:u=s*(c-2),o[1]+=s,o[2]+=u;break;case 3:u=s*(4-c),o[1]+=u,o[2]+=s;break;case 4:u=s*(c-4),o[2]+=s,o[0]+=u;break;case 5:u=s*(6-c),o[2]+=u,o[0]+=s;break}for(var f=0;f!=3;++f)o[f]=Math.round(o[f]*255);return o}function _x(e,t){if(t===0)return e;var r=vQ(bQ(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Lp(wQ(r))}var KN=6,_Q=15,yQ=1,nl=KN;function jp(e){return Math.floor((e+Math.round(128/nl)/256)*nl)}function Up(e){return Math.floor((e-5)/nl*100+.5)/100}function yx(e){return Math.round((e*nl+5)/nl*256)/256}function rv(e){return yx(Up(jp(e)))}function e_(e){var t=Math.abs(e-rv(e)),r=nl;if(t>.005)for(nl=yQ;nl<_Q;++nl)Math.abs(e-rv(e))<=t&&(t=Math.abs(e-rv(e)),r=nl);nl=r}function l0(e){e.width?(e.wpx=jp(e.width),e.wch=Up(e.wpx),e.MDW=nl):e.wpx?(e.wch=Up(e.wpx),e.width=yx(e.wch),e.MDW=nl):typeof e.wch=="number"&&(e.width=yx(e.wch),e.wpx=jp(e.width),e.MDW=nl),e.customWidth&&delete e.customWidth}var kQ=96,zN=kQ;function Dp(e){return e*96/zN}function Lf(e){return e*zN/96}var BQ={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function CQ(e,t,r,a){t.Borders=[];var s={},n=!1;(e[0].match(Al)||[]).forEach(function(o){var c=zr(o);switch(Cc(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},c.diagonalUp&&(s.diagonalUp=Ns(c.diagonalUp)),c.diagonalDown&&(s.diagonalDown=Ns(c.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(a&&a.WTF&&!n)throw new Error("unrecognized "+c[0]+" in borders")}})}function SQ(e,t,r,a){t.Fills=[];var s={},n=!1;(e[0].match(Al)||[]).forEach(function(o){var c=zr(o);switch(Cc(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":c.patternType&&(s.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),c.indexed&&(s.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(s.bgColor.theme=parseInt(c.theme,10)),c.tint&&(s.bgColor.tint=parseFloat(c.tint)),c.rgb&&(s.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),c.theme&&(s.fgColor.theme=parseInt(c.theme,10)),c.tint&&(s.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(s.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(a&&a.WTF&&!n)throw new Error("unrecognized "+c[0]+" in fills")}})}function NQ(e,t,r,a){t.Fonts=[];var s={},n=!1;(e[0].match(Al)||[]).forEach(function(o){var c=zr(o);switch(Cc(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":c.val&&(s.name=is(c.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=c.val?Ns(c.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=c.val?Ns(c.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(c.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=c.val?Ns(c.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=c.val?Ns(c.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=c.val?Ns(c.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=c.val?Ns(c.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=c.val?Ns(c.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":c.val&&(s.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(s.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(s.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(s.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=N2[parseInt(c.val,10)];break;case"<color":if(s.color||(s.color={}),c.auto&&(s.color.auto=Ns(c.auto)),c.rgb)s.color.rgb=c.rgb.slice(-6);else if(c.indexed){s.color.index=parseInt(c.indexed,10);var u=P0[s.color.index];s.color.index==81&&(u=P0[1]),u||(u=P0[1]),s.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else c.theme&&(s.color.theme=parseInt(c.theme,10),c.tint&&(s.color.tint=parseFloat(c.tint)),c.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=_x(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(a&&a.WTF&&!n)throw new Error("unrecognized "+c[0]+" in fonts")}})}function EQ(e,t,r){t.NumberFmt=[];for(var a=un(Rr),s=0;s<a.length;++s)t.NumberFmt[a[s]]=Rr[a[s]];var n=e[0].match(Al);if(n)for(s=0;s<n.length;++s){var o=zr(n[s]);switch(Cc(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=Fa(is(o.formatCode)),u=parseInt(o.numFmtId,10);if(t.NumberFmt[u]=c,u>0){if(u>392){for(u=392;u>60&&t.NumberFmt[u]!=null;--u);t.NumberFmt[u]=c}au(c,u)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function FQ(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=Mt("numFmt",null,{numFmtId:a,formatCode:Ja(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Mt("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var om=["numFmtId","fillId","fontId","borderId","xfId"],Am=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function TQ(e,t,r){t.CellXf=[];var a,s=!1;(e[0].match(Al)||[]).forEach(function(n){var o=zr(n),c=0;switch(Cc(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=o,delete a[0],c=0;c<om.length;++c)a[om[c]]&&(a[om[c]]=parseInt(a[om[c]],10));for(c=0;c<Am.length;++c)a[Am[c]]&&(a[Am[c]]=Ns(a[Am[c]]));if(t.NumberFmt&&a.numFmtId>392){for(c=392;c>60;--c)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[c]){a.numFmtId=c;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};o.vertical&&(u.vertical=o.vertical),o.horizontal&&(u.horizontal=o.horizontal),o.textRotation!=null&&(u.textRotation=o.textRotation),o.indent&&(u.indent=o.indent),o.wrapText&&(u.wrapText=Ns(o.wrapText)),a.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function LQ(e){var t=[];return t[t.length]=Mt("cellXfs",null),e.forEach(function(r){t[t.length]=Mt("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Mt("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var jQ=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,n=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,u,f){var h={};if(!c)return h;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var g;return(g=c.match(t))&&EQ(g,h,f),(g=c.match(s))&&NQ(g,h,u,f),(g=c.match(a))&&SQ(g,h,u,f),(g=c.match(n))&&CQ(g,h,u,f),(g=c.match(r))&&TQ(g,h,f),h}})();function VN(e,t){var r=[Fn,Mt("styleSheet",null,{xmlns:sd[0],"xmlns:vt":ci.vt})],a;return e.SSF&&(a=FQ(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=LQ(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function UQ(e,t){var r=e.read_shift(2),a=ll(e);return[r,a]}function DQ(e,t,r){r||(r=At(6+4*t.length)),r.write_shift(2,e),ki(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function IQ(e,t,r){var a={};a.sz=e.read_shift(2)/20;var s=m7(e);s.fItalic&&(a.italic=1),s.fCondense&&(a.condense=1),s.fExtend&&(a.extend=1),s.fShadow&&(a.shadow=1),s.fOutline&&(a.outline=1),s.fStrikeout&&(a.strike=1);var n=e.read_shift(2);switch(n===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(a.underline=o);var c=e.read_shift(1);c>0&&(a.family=c);var u=e.read_shift(1);switch(u>0&&(a.charset=u),e.l++,a.color=g7(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=ll(e),a}function QQ(e,t){t||(t=At(153)),t.write_shift(2,e.sz*20),x7(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),bx(e.color,t);var a=0;return a=2,t.write_shift(1,a),ki(e.name,t),t.length>t.l?t.slice(0,t.l):t}var OQ=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],av,RQ=ol;function j4(e,t){t||(t=At(84)),av||(av=rb(OQ));var r=av[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(bx({auto:1},t),bx({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function MQ(e,t){var r=e.l+t,a=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:s}}function GN(e,t,r){r||(r=At(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Fh(e,t){return t||(t=At(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var HQ=ol;function PQ(e,t){return t||(t=At(51)),t.write_shift(1,0),Fh(null,t),Fh(null,t),Fh(null,t),Fh(null,t),Fh(null,t),t.length>t.l?t.slice(0,t.l):t}function qQ(e,t){return t||(t=At(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),xx(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function KQ(e,t,r){var a=At(2052);return a.write_shift(4,e),xx(t,a),xx(r,a),a.length>a.l?a.slice(0,a.l):a}function zQ(e,t,r){var a={};a.NumberFmt=[];for(var s in Rr)a.NumberFmt[s]=Rr[s];a.CellXf=[],a.Fonts=[];var n=[],o=!1;return cu(e,function(u,f,h){switch(h){case 44:a.NumberFmt[u[0]]=u[1],au(u[1],u[0]);break;case 43:a.Fonts.push(u),u.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(u.color.rgb=_x(t.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:n[n.length-1]==617&&a.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:n.push(h),o=!0;break;case 38:n.pop(),o=!1;break;default:if(f.T>0)n.push(h);else if(f.T<0)n.pop();else if(!o||r.WTF&&n[n.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),a}function VQ(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&++r}),r!=0&&(kt(e,615,FA(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&kt(e,44,DQ(s,t[s]))}),kt(e,616))}}function GQ(e){var t=1;kt(e,611,FA(t)),kt(e,43,QQ({sz:12,color:{theme:1},name:"Calibri",family:2})),kt(e,612)}function WQ(e){var t=2;kt(e,603,FA(t)),kt(e,45,j4({patternType:"none"})),kt(e,45,j4({patternType:"gray125"})),kt(e,604)}function $Q(e){var t=1;kt(e,613,FA(t)),kt(e,46,PQ()),kt(e,614)}function XQ(e){var t=1;kt(e,626,FA(t)),kt(e,47,GN({numFmtId:0},65535)),kt(e,627)}function YQ(e,t){kt(e,617,FA(t.length)),t.forEach(function(r){kt(e,47,GN(r,0))}),kt(e,618)}function JQ(e){var t=1;kt(e,619,FA(t)),kt(e,48,qQ({xfId:0,name:"Normal"})),kt(e,620)}function ZQ(e){var t=0;kt(e,505,FA(t)),kt(e,506)}function eO(e){var t=0;kt(e,508,KQ(t,"TableStyleMedium9","PivotStyleMedium4")),kt(e,509)}function tO(e,t){var r=to();return kt(r,278),VQ(r,e.SSF),GQ(r),WQ(r),$Q(r),XQ(r),YQ(r,t.cellXfs),JQ(r),ZQ(r),eO(r),kt(r,279),r.end()}var rO=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function aO(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(Al)||[]).forEach(function(s){var n=zr(s);switch(n[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=n.val;break;case"<a:sysClr":a.rgb=n.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":n[0].charAt(1)==="/"?(t.themeElements.clrScheme[rO.indexOf(n[0])]=a,a={}):a.name=n[0].slice(3,n[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+n[0]+" in clrScheme")}})}function sO(){}function nO(){}var iO=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,lO=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,oO=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function AO(e,t,r){t.themeElements={};var a;[["clrScheme",iO,aO],["fontScheme",lO,sO],["fmtScheme",oO,nO]].forEach(function(s){if(!(a=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](a,t,r)})}var cO=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function WN(e,t){(!e||e.length===0)&&(e=t_());var r,a={};if(!(r=e.match(cO)))throw new Error("themeElements not found in theme");return AO(r[0],a,t),a.raw=e,a}function t_(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Fn];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function uO(e,t,r){var a=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=a;return}var n=e.slice(e.l);e.l=a;var o;try{o=M3(n,{type:"array"})}catch{return}var c=_o(o,"theme/theme/theme1.xml",!0);if(c)return WN(c,r)}}function dO(e){return e.read_shift(4)}function fO(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=hO(e,4);break;case 2:t.xclrValue=SN(e);break;case 3:t.xclrValue=dO(e);break;case 4:e.l+=4;break}return e.l+=8,t}function hO(e,t){return ol(e,t)}function pO(e,t){return ol(e,t)}function gO(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=fO(e);break;case 6:a[1]=pO(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function mO(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),n=[];s-- >0;)n.push(gO(e,r-e.l));return{ixfe:a,ext:n}}function xO(e,t){t.forEach(function(r){r[0]})}function bO(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:ll(e)}}function vO(e){var t=At(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),ki(e.name,t),t.slice(0,t.l)}function wO(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function _O(e){var t=At(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function yO(e,t){var r=At(8+2*t.length);return r.write_shift(4,e),ki(t,r),r.slice(0,r.l)}function kO(e){return e.l+=4,e.read_shift(4)!=0}function BO(e,t){var r=At(8);return r.write_shift(4,e),r.write_shift(4,1),r}function CO(e,t,r){var a={Types:[],Cell:[],Value:[]},s=r||{},n=[],o=!1,c=2;return cu(e,function(u,f,h){switch(h){case 335:a.Types.push({name:u.name});break;case 51:u.forEach(function(g){c==1?a.Cell.push({type:a.Types[g[0]-1].name,index:g[1]}):c==0&&a.Value.push({type:a.Types[g[0]-1].name,index:g[1]})});break;case 337:c=u?1:0;break;case 338:c=2;break;case 35:n.push(h),o=!0;break;case 36:n.pop(),o=!1;break;default:if(!f.T){if(!o||s.WTF&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),a}function SO(){var e=to();return kt(e,332),kt(e,334,FA(1)),kt(e,335,vO({name:"XLDAPR",version:12e4,flags:3496657072})),kt(e,336),kt(e,339,yO(1,"XLDAPR")),kt(e,52),kt(e,35,FA(514)),kt(e,4096,FA(0)),kt(e,4097,Wo(1)),kt(e,36),kt(e,53),kt(e,340),kt(e,337,BO(1)),kt(e,51,_O([[1,0]])),kt(e,338),kt(e,333),e.end()}function NO(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var s=!1,n=2,o;return e.replace(Al,function(c){var u=zr(c);switch(Cc(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<a.Types.length;++f)a.Types[f].name==u.name&&(o=a.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":n==1?a.Cell.push({type:a.Types[u.t-1].name,index:+u.v}):n==0&&a.Value.push({type:a.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":n=1;break;case"</cellMetadata>":n=2;break;case"<valueMetadata":n=0;break;case"</valueMetadata>":n=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+u.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return c}),a}function $N(){var e=[Fn];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function EO(e){var t=[];if(!e)return t;var r=1;return(e.match(Al)||[]).forEach(function(a){var s=zr(a);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function FO(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Kr(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function TO(e,t,r){var a=[];return cu(e,function(n,o,c){switch(c){case 63:a.push(n);break;default:if(!o.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),a}function LO(e,t,r,a){if(!e)return e;var s=a||{},n=!1;cu(e,function(c,u,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:n=!0;break;case 36:n=!1;break;default:if(!u.T){if(!n||s.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},s)}function jO(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var hf=1024;function XN(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Mt("xml",null,{"xmlns:v":bo.v,"xmlns:o":bo.o,"xmlns:x":bo.x,"xmlns:mv":bo.mv}).replace(/\/>/,">"),Mt("o:shapelayout",Mt("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Mt("v:shapetype",[Mt("v:stroke",null,{joinstyle:"miter"}),Mt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];hf<e*1e3;)hf+=1e3;return t.forEach(function(n){var o=Xs(n[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var u=c.type=="gradient"?Mt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,f=Mt("v:fill",u,c),h={on:"t",obscured:"t"};++hf,s=s.concat(["<v:shape"+Ep({id:"_x0000_s"+hf,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(n[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",f,Mt("v:shadow",null,h),Mt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Qi("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Qi("x:AutoFill","False"),Qi("x:Row",String(o.r)),Qi("x:Column",String(o.c)),n[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function U4(e,t,r,a){var s=Array.isArray(e),n;t.forEach(function(o){var c=Xs(o.ref);if(s?(e[c.r]||(e[c.r]=[]),n=e[c.r][c.c]):n=e[o.ref],!n){n={t:"z"},s?e[c.r][c.c]=n:e[o.ref]=n;var u=Ta(e["!ref"]||"BDWGO1000001:A1");u.s.r>c.r&&(u.s.r=c.r),u.e.r<c.r&&(u.e.r=c.r),u.s.c>c.c&&(u.s.c=c.c),u.e.c<c.c&&(u.e.c=c.c);var f=aa(u);f!==e["!ref"]&&(e["!ref"]=f)}n.c||(n.c=[]);var h={a:o.author,t:o.t,r:o.r,T:r};o.h&&(h.h=o.h);for(var g=n.c.length-1;g>=0;--g){if(!r&&n.c[g].T)return;r&&!n.c[g].T&&n.c.splice(g,1)}if(r&&a){for(g=0;g<a.length;++g)if(h.a==a[g].id){h.a=a[g].name||h.a;break}}n.c.push(h)})}function UO(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&r.push(c[1])}});var n=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return n&&n[1]&&n[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?comment[^>]*>/);if(c){var u=zr(c[0]),f={author:u.authorId&&r[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},h=Xs(u.ref);if(!(t.sheetRows&&t.sheetRows<=h.r)){var g=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),x=!!g&&!!g[1]&&J2(g[1])||{r:"",t:"",h:""};f.r=x.r,x.r=="<t></t>"&&(x.t=x.h=""),f.t=(x.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(f.h=x.h),a.push(f)}}}}),a}function YN(e){var t=[Fn,Mt("comments",null,{xmlns:sd[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(s){var n=Ja(s.a);r.indexOf(n)==-1&&(r.push(n),t.push("<author>"+n+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var s=0,n=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?s=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(u){u.a&&(s=r.indexOf(Ja(u.a))),n.push(u.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+s+'"><text>'),n.length<=1)t.push(Qi("t",Ja(n[0]||"")));else{for(var o=`Comment:
    `+n[0]+`
`,c=1;c<n.length;++c)o+=`Reply:
    `+n[c]+`
`;t.push(Qi("t",Ja(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function DO(e,t){var r=[],a=!1,s={},n=0;return e.replace(Al,function(c,u){var f=zr(c);switch(Cc(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":n=u+c.length;break;case"</text>":s.t=e.slice(n,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return c}),r}function IO(e,t,r){var a=[Fn,Mt("ThreadedComments",null,{xmlns:ci.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var n="";(s[1]||[]).forEach(function(o,c){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var u={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};c==0?n=u.id:u.parentId=n,o.ID=u.id,o.a&&(u.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),a.push(Mt("threadedComment",Qi("text",o.t||""),u))})}),a.push("</ThreadedComments>"),a.join("")}function QO(e,t){var r=[],a=!1;return e.replace(Al,function(n){var o=zr(n);switch(Cc(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return n}),r}function OO(e){var t=[Fn,Mt("personList",null,{xmlns:ci.TCMNT,"xmlns:x":sd[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(Mt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function RO(e){var t={};t.iauthor=e.read_shift(4);var r=od(e);return t.rfx=r.s,t.ref=Kr(r.s),e.l+=16,t}function MO(e,t){return t==null&&(t=At(36)),t.write_shift(4,e[1].iauthor),Mf(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var HO=ll;function PO(e){return ki(e.slice(0,54))}function qO(e,t){var r=[],a=[],s={},n=!1;return cu(e,function(c,u,f){switch(f){case 632:a.push(c);break;case 635:s=c;break;case 637:s.t=c.t,s.h=c.h,s.r=c.r;break;case 636:if(s.author=a[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:n=!0;break;case 36:n=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!n||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),r}function KO(e){var t=to(),r=[];return kt(t,628),kt(t,630),e.forEach(function(a){a[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),kt(t,632,PO(s.a)))})}),kt(t,631),kt(t,633),e.forEach(function(a){a[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var n={s:Xs(a[0]),e:Xs(a[0])};kt(t,635,MO([n,s])),s.t&&s.t.length>0&&kt(t,637,d7(s)),kt(t,636),delete s.iauthor})}),kt(t,634),kt(t,629),t.end()}var zO="application/vnd.ms-office.vbaProject";function VO(e){var t=Tr.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Tr.utils.cfb_add(t,s,e.FileIndex[a].content)}}),Tr.write(t)}function GO(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Tr.utils.cfb_add(e,s,t.FileIndex[a].content)}})}var JN=["xlsb","xlsm","xlam","biff8","xla"];function WO(){return{"!type":"dialog"}}function $O(){return{"!type":"dialog"}}function XO(){return{"!type":"macro"}}function YO(){return{"!type":"macro"}}var _f=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,s,n,o){var c=!1,u=!1;n.length==0?u=!0:n.charAt(0)=="["&&(u=!0,n=n.slice(1,-1)),o.length==0?c=!0:o.charAt(0)=="["&&(c=!0,o=o.slice(1,-1));var f=n.length>0?parseInt(n,10)|0:0,h=o.length>0?parseInt(o,10)|0:0;return c?h+=t.c:--h,u?f+=t.r:--f,s+(c?"":"$")+$s(h)+(u?"":"$")+En(f)}return function(s,n){return t=n,s.replace(e,r)}})(),r_=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,a_=(function(){return function(t,r){return t.replace(r_,function(a,s,n,o,c,u){var f=q2(o)-(n?0:r.c),h=P2(u)-(c?0:r.r),g=h==0?"":c?h+1:"["+h+"]",x=f==0?"":n?f+1:"["+f+"]";return s+"R"+g+"C"+x})}})();function ZN(e,t){return e.replace(r_,function(r,a,s,n,o,c){return a+(s=="$"?s+n:$s(q2(n)+t.c))+(o=="$"?o+c:En(P2(c)+t.r))})}function JO(e,t,r){var a=ro(t),s=a.s,n=Xs(r),o={r:n.r-s.r,c:n.c-s.c};return ZN(e,o)}function ZO(e){return e.length!=1}function D4(e){return e.replace(/_xlfn\./g,"")}function Hn(e){e.l+=1}function o0(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function eE(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return tE(e);r.biff==12&&(a=4)}var s=e.read_shift(a),n=e.read_shift(a),o=o0(e),c=o0(e);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:n,c:c[0],cRel:c[1],rRel:c[2]}}}function tE(e){var t=o0(e),r=o0(e),a=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function eR(e,t,r){if(r.biff<8)return tE(e);var a=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),n=o0(e),o=o0(e);return{s:{r:a,c:n[0],cRel:n[1],rRel:n[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function rE(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return tR(e);var a=e.read_shift(r&&r.biff==12?4:2),s=o0(e);return{r:a,c:s[0],cRel:s[1],rRel:s[2]}}function tR(e){var t=o0(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function rR(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function aR(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return sR(e);var s=e.read_shift(a>=12?4:2),n=e.read_shift(2),o=(n&16384)>>14,c=(n&32768)>>15;if(n&=16383,c==1)for(;s>524287;)s-=1048576;if(o==1)for(;n>8191;)n=n-16384;return{r:s,c:n,cRel:o,rRel:c}}function sR(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:a}}function nR(e,t,r){var a=(e[e.l++]&96)>>5,s=eE(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,s]}function iR(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),n=8;if(r)switch(r.biff){case 5:e.l+=12,n=6;break;case 12:n=12;break}var o=eE(e,n,r);return[a,s,o]}function lR(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function oR(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),n=8;if(r)switch(r.biff){case 5:e.l+=12,n=6;break;case 12:n=12;break}return e.l+=n,[a,s]}function AR(e,t,r){var a=(e[e.l++]&96)>>5,s=eR(e,t-1,r);return[a,s]}function cR(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function I4(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function uR(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),s=[],n=0;n<=a;++n)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function dR(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function fR(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function hR(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function pR(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function aE(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function gR(e){return e.read_shift(2),aE(e)}function mR(e){return e.read_shift(2),aE(e)}function xR(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=rE(e,0,r);return[a,s]}function bR(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=aR(e,0,r);return[a,s]}function vR(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var n=rE(e,0,r);return[a,s,n]}function wR(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[kM[s],iE[s],a]}function _R(e,t,r){var a=e[e.l++],s=e.read_shift(1),n=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:yR(e);return[s,(n[0]===0?iE:yM)[n[1]]]}function yR(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function kR(e,t,r){e.l+=r&&r.biff==2?3:4}function BR(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function CR(e){return e.l++,uu[e.read_shift(1)]}function SR(e){return e.l++,e.read_shift(2)}function NR(e){return e.l++,e.read_shift(1)!==0}function ER(e){return e.l++,il(e)}function FR(e,t,r){return e.l++,$p(e,t-1,r)}function TR(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=vn(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=uu[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=il(e);break;case 2:r[1]=Ad(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function LR(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),s=[],n=0;n!=a;++n)s.push((r.biff==12?od:nb)(e));return s}function jR(e,t,r){var a=0,s=0;r.biff==12?(a=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--s==0&&(s=256));for(var n=0,o=[];n!=a&&(o[n]=[]);++n)for(var c=0;c!=s;++c)o[n][c]=TR(e,r.biff);return o}function UR(e,t,r){var a=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,n=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,n]}function DR(e,t,r){if(r.biff==5)return IR(e);var a=e.read_shift(1)>>>5&3,s=e.read_shift(2),n=e.read_shift(4);return[a,s,n]}function IR(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function QR(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function OR(e,t,r){var a=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function RR(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function MR(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),n=4;if(r)switch(r.biff){case 5:n=15;break;case 12:n=6;break}return e.l+=n,[a,s]}var HR=ol,PR=ol,qR=ol;function Yp(e,t,r){return e.l+=2,[rR(e)]}function s_(e){return e.l+=6,[]}var KR=Yp,zR=s_,VR=s_,GR=Yp;function sE(e){return e.l+=2,[qn(e),e.read_shift(2)&1]}var WR=Yp,$R=sE,XR=s_,YR=Yp,JR=Yp,ZR=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function eM(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s=e.read_shift(2),n=e.read_shift(2),o=ZR[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:a,c:s,C:n}}function tM(e){return e.l+=2,[e.read_shift(4)]}function rM(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function aM(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function sM(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function nM(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function iM(e){return e.l+=4,[0,0]}var Q4={1:{n:"PtgExp",f:BR},2:{n:"PtgTbl",f:qR},3:{n:"PtgAdd",f:Hn},4:{n:"PtgSub",f:Hn},5:{n:"PtgMul",f:Hn},6:{n:"PtgDiv",f:Hn},7:{n:"PtgPower",f:Hn},8:{n:"PtgConcat",f:Hn},9:{n:"PtgLt",f:Hn},10:{n:"PtgLe",f:Hn},11:{n:"PtgEq",f:Hn},12:{n:"PtgGe",f:Hn},13:{n:"PtgGt",f:Hn},14:{n:"PtgNe",f:Hn},15:{n:"PtgIsect",f:Hn},16:{n:"PtgUnion",f:Hn},17:{n:"PtgRange",f:Hn},18:{n:"PtgUplus",f:Hn},19:{n:"PtgUminus",f:Hn},20:{n:"PtgPercent",f:Hn},21:{n:"PtgParen",f:Hn},22:{n:"PtgMissArg",f:Hn},23:{n:"PtgStr",f:FR},26:{n:"PtgSheet",f:rM},27:{n:"PtgEndSheet",f:aM},28:{n:"PtgErr",f:CR},29:{n:"PtgBool",f:NR},30:{n:"PtgInt",f:SR},31:{n:"PtgNum",f:ER},32:{n:"PtgArray",f:cR},33:{n:"PtgFunc",f:wR},34:{n:"PtgFuncVar",f:_R},35:{n:"PtgName",f:UR},36:{n:"PtgRef",f:xR},37:{n:"PtgArea",f:nR},38:{n:"PtgMemArea",f:QR},39:{n:"PtgMemErr",f:HR},40:{n:"PtgMemNoMem",f:PR},41:{n:"PtgMemFunc",f:OR},42:{n:"PtgRefErr",f:RR},43:{n:"PtgAreaErr",f:lR},44:{n:"PtgRefN",f:bR},45:{n:"PtgAreaN",f:AR},46:{n:"PtgMemAreaN",f:sM},47:{n:"PtgMemNoMemN",f:nM},57:{n:"PtgNameX",f:DR},58:{n:"PtgRef3d",f:vR},59:{n:"PtgArea3d",f:iR},60:{n:"PtgRefErr3d",f:MR},61:{n:"PtgAreaErr3d",f:oR},255:{}},lM={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},oM={1:{n:"PtgElfLel",f:sE},2:{n:"PtgElfRw",f:YR},3:{n:"PtgElfCol",f:KR},6:{n:"PtgElfRwV",f:JR},7:{n:"PtgElfColV",f:GR},10:{n:"PtgElfRadical",f:WR},11:{n:"PtgElfRadicalS",f:XR},13:{n:"PtgElfColS",f:zR},15:{n:"PtgElfColSV",f:VR},16:{n:"PtgElfRadicalLel",f:$R},25:{n:"PtgList",f:eM},29:{n:"PtgSxName",f:tM},255:{}},AM={0:{n:"PtgAttrNoop",f:iM},1:{n:"PtgAttrSemi",f:pR},2:{n:"PtgAttrIf",f:fR},4:{n:"PtgAttrChoose",f:uR},8:{n:"PtgAttrGoto",f:dR},16:{n:"PtgAttrSum",f:kR},32:{n:"PtgAttrBaxcel",f:I4},33:{n:"PtgAttrBaxcel",f:I4},64:{n:"PtgAttrSpace",f:gR},65:{n:"PtgAttrSpaceSemi",f:mR},128:{n:"PtgAttrIfError",f:hR},255:{}};function Jp(e,t,r,a){if(a.biff<8)return ol(e,t);for(var s=e.l+t,n=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=jR(e,0,a),n.push(r[o][1]);break;case"PtgMemArea":r[o][2]=LR(e,r[o][1],a),n.push(r[o][2]);break;case"PtgExp":a&&a.biff==12&&(r[o][1][1]=e.read_shift(4),n.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=s-e.l,t!==0&&n.push(ol(e,t)),n}function Zp(e,t,r){for(var a=e.l+t,s,n,o=[];a!=e.l;)t=a-e.l,n=e[e.l],s=Q4[n]||Q4[lM[n]],(n===24||n===25)&&(s=(n===24?oM:AM)[e[e.l+1]]),!s||!s.f?ol(e,t):o.push([s.n,s.f(e,t,r)]);return o}function cM(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],s=[],n=0;n<a.length;++n){var o=a[n];o?o[0]===2?s.push('"'+o[1].replace(/"/g,'""')+'"'):s.push(o[1]):s.push("")}t.push(s.join(","))}return t.join(";")}var uM={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function dM(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function nE(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[a[0]][0]){case 357:return s=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return s=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(n){return n.Name}).join(";;");default:return e[a[0]][0][3]?(s=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?s:s+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function O4(e,t,r){var a=nE(e,t,r);return a=="#REF"?a:dM(a,r)}function al(e,t,r,a,s){var n=s&&s.biff||8,o={s:{c:0,r:0}},c=[],u,f,h,g=0,x=0,m,w="";if(!e[0]||!e[0][0])return"";for(var v=-1,B="",k=0,E=e[0].length;k<E;++k){var S=e[0][k];switch(S[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=c.pop(),f=c.pop(),v>=0){switch(e[0][v][1][0]){case 0:B=An(" ",e[0][v][1][1]);break;case 1:B=An("\r",e[0][v][1][1]);break;default:if(B="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}f=f+B,v=-1}c.push(f+uM[S[0]]+u);break;case"PtgIsect":u=c.pop(),f=c.pop(),c.push(f+" "+u);break;case"PtgUnion":u=c.pop(),f=c.pop(),c.push(f+","+u);break;case"PtgRange":u=c.pop(),f=c.pop(),c.push(f+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=rp(S[1][1],o,s),c.push(ap(h,n));break;case"PtgRefN":h=r?rp(S[1][1],r,s):S[1][1],c.push(ap(h,n));break;case"PtgRef3d":g=S[1][1],h=rp(S[1][2],o,s),w=O4(a,g,s),c.push(w+"!"+ap(h,n));break;case"PtgFunc":case"PtgFuncVar":var L=S[1][0],P=S[1][1];L||(L=0),L&=127;var R=L==0?[]:c.slice(-L);c.length-=L,P==="User"&&(P=R.shift()),c.push(P+"("+R.join(",")+")");break;case"PtgBool":c.push(S[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(S[1]);break;case"PtgNum":c.push(String(S[1]));break;case"PtgStr":c.push('"'+S[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(S[1]);break;case"PtgAreaN":m=f4(S[1][1],r?{s:r}:o,s),c.push(Z1(m,s));break;case"PtgArea":m=f4(S[1][1],o,s),c.push(Z1(m,s));break;case"PtgArea3d":g=S[1][1],m=S[1][2],w=O4(a,g,s),c.push(w+"!"+Z1(m,s));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=S[1][2];var Q=(a.names||[])[x-1]||(a[0]||[])[x],V=Q?Q.Name:"SH33TJSNAME"+String(x);V&&V.slice(0,6)=="_xlfn."&&!s.xlfn&&(V=V.slice(6)),c.push(V);break;case"PtgNameX":var U=S[1][1];x=S[1][2];var M;if(s.biff<=5)U<0&&(U=-U),a[U]&&(M=a[U][x]);else{var T="";if(((a[U]||[])[0]||[])[0]==14849||(((a[U]||[])[0]||[])[0]==1025?a[U][x]&&a[U][x].itab>0&&(T=a.SheetNames[a[U][x].itab-1]+"!"):T=a.SheetNames[x-1]+"!"),a[U]&&a[U][x])T+=a[U][x].Name;else if(a[0]&&a[0][x])T+=a[0][x].Name;else{var D=(nE(a,U,s)||"").split(";;");D[x-1]?T=D[x-1]:T+="SH33TJSERRX"}c.push(T);break}M||(M={Name:"SH33TJSERRY"}),c.push(M.Name);break;case"PtgParen":var G="(",ne=")";if(v>=0){switch(B="",e[0][v][1][0]){case 2:G=An(" ",e[0][v][1][1])+G;break;case 3:G=An("\r",e[0][v][1][1])+G;break;case 4:ne=An(" ",e[0][v][1][1])+ne;break;case 5:ne=An("\r",e[0][v][1][1])+ne;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}v=-1}c.push(G+c.pop()+ne);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":h={c:S[1][1],r:S[1][0]};var H={c:r.c,r:r.r};if(a.sharedf[Kr(h)]){var ee=a.sharedf[Kr(h)];c.push(al(ee,o,H,a,s))}else{var le=!1;for(u=0;u!=a.arrayf.length;++u)if(f=a.arrayf[u],!(h.c<f[0].s.c||h.c>f[0].e.c)&&!(h.r<f[0].s.r||h.r>f[0].e.r)){c.push(al(f[1],o,H,a,s)),le=!0;break}le||c.push(S[1])}break;case"PtgArray":c.push("{"+cM(S[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+S[1].idx+"[#"+S[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(S));default:throw new Error("Unrecognized Formula Token: "+String(S))}var pe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&v>=0&&pe.indexOf(e[0][k][0])==-1){S=e[0][v];var te=!0;switch(S[1][0]){case 4:te=!1;case 0:B=An(" ",S[1][1]);break;case 5:te=!1;case 1:B=An("\r",S[1][1]);break;default:if(B="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+S[1][0])}c.push((te?B:"")+c.pop()+(te?"":B)),v=-1}}if(c.length>1&&s.WTF)throw new Error("bad formula stack");return c[0]}function fM(e,t,r){var a=e.l+t,s=r.biff==2?1:2,n,o=e.read_shift(s);if(o==65535)return[[],ol(e,t-2)];var c=Zp(e,o,r);return t!==o+s&&(n=Jp(e,t-o-s,c,r)),e.l=a,[c,n]}function hM(e,t,r){var a=e.l+t,s=r.biff==2?1:2,n,o=e.read_shift(s);if(o==65535)return[[],ol(e,t-2)];var c=Zp(e,o,r);return t!==o+s&&(n=Jp(e,t-o-s,c,r)),e.l=a,[c,n]}function pM(e,t,r,a){var s=e.l+t,n=Zp(e,a,r),o;return s!==e.l&&(o=Jp(e,s-e.l,n,r)),[n,o]}function gM(e,t,r){var a=e.l+t,s,n=e.read_shift(2),o=Zp(e,n,r);return n==65535?[[],ol(e,t-2)]:(t!==n+2&&(s=Jp(e,a-n-2,o,r)),[o,s])}function mM(e){var t;if(tu(e,e.l+6)!==65535)return[il(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function xM(e){if(e==null){var t=At(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return J0(e);return J0(0)}function sv(e,t,r){var a=e.l+t,s=Sc(e);r.biff==2&&++e.l;var n=mM(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var c=hM(e,a-e.l,r);return{cell:s,val:n[0],formula:c,shared:o>>3&1,tt:n[1]}}function bM(e,t,r,a,s){var n=ed(t,r,s),o=xM(e.v),c=At(6),u=33;c.write_shift(2,u),c.write_shift(4,0);for(var f=At(e.bf.length),h=0;h<e.bf.length;++h)f[h]=e.bf[h];var g=yi([n,o,c,f]);return g}function ib(e,t,r){var a=e.read_shift(4),s=Zp(e,a,r),n=e.read_shift(4),o=n>0?Jp(e,n,s,r):null;return[s,o]}var vM=ib,lb=ib,wM=ib,_M=ib,yM={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},iE={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},kM={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function R4(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function BM(e){var t="of:="+e.replace(r_,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function nv(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function CM(e){return e.replace(/\./,"!")}var np={},yf={},ip=typeof Map<"u";function n_(e,t,r){var a=0,s=e.length;if(r){if(ip?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var n=ip?r.get(t):r[t];a<n.length;++a)if(e[n[a]].t===t)return e.Count++,n[a]}}else for(;a<s;++a)if(e[a].t===t)return e.Count++,a;return e[s]={t},e.Count++,e.Unique++,r&&(ip?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function ob(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(nl=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=Up(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=yx(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function z0(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function m0(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],s=60,n=e.length;if(a==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){au(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=a=s;break}}for(s=0;s!=n;++s)if(e[s].numFmtId===a)return s;return e[n]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},n}function lE(e,t,r,a,s,n){try{a.cellNF&&(e.z=Rr[t])}catch(c){if(a.WTF)throw c}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Fs(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(Rr[t]==null&&au(yU[t]||"General",t),e.t==="e")e.w=e.w||uu[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Sp(e.v);else if(e.t==="d"){var o=ui(e.v);(o|0)===o?e.w=o.toString(10):e.w=Sp(o)}else{if(e.v===void 0)return"";e.w=X0(e.v,yf)}else e.t==="d"?e.w=rA(t,ui(e.v),yf):e.w=rA(t,e.v,yf)}catch(c){if(a.WTF)throw c}if(a.cellStyles&&r!=null)try{e.s=n.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=_x(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=_x(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(a.WTF&&n.Fills)throw c}}}function SM(e,t,r){if(e&&e["!ref"]){var a=Ta(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function NM(e,t){var r=Ta(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=aa(r))}var EM=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,FM=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,TM=/<(?:\w:)?hyperlink [^>]*>/mg,LM=/"(\w*:\w*)"/,jM=/<(?:\w:)?col\b[^>]*[\/]?>/g,UM=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,DM=/<(?:\w:)?pageMargins[^>]*\/>/g,oE=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,IM=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,QM=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function OM(e,t,r,a,s,n,o){if(!e)return e;a||(a={"!id":{}});var c=t.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",h="",g=e.match(FM);g?(f=e.slice(0,g.index),h=e.slice(g.index+g[0].length)):f=h=e;var x=f.match(oE);x?i_(x[0],c,s,r):(x=f.match(IM))&&MM(x[0],x[1]||"",c,s,r);var m=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var w=f.slice(m,m+50).match(LM);w&&NM(c,w[1])}var v=f.match(QM);v&&v[1]&&ZM(v[1],s);var B=[];if(t.cellStyles){var k=f.match(jM);k&&WM(B,k)}g&&r9(g[1],c,t,u,n,o);var E=h.match(UM);E&&(c["!autofilter"]=XM(E[0]));var S=[],L=h.match(EM);if(L)for(m=0;m!=L.length;++m)S[m]=Ta(L[m].slice(L[m].indexOf('"')+1));var P=h.match(TM);P&&zM(c,P,a);var R=h.match(DM);if(R&&(c["!margins"]=VM(zr(R[0]))),!c["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(c["!ref"]=aa(u)),t.sheetRows>0&&c["!ref"]){var Q=Ta(c["!ref"]);t.sheetRows<=+Q.e.r&&(Q.e.r=t.sheetRows-1,Q.e.r>u.e.r&&(Q.e.r=u.e.r),Q.e.r<Q.s.r&&(Q.s.r=Q.e.r),Q.e.c>u.e.c&&(Q.e.c=u.e.c),Q.e.c<Q.s.c&&(Q.s.c=Q.e.c),c["!fullref"]=c["!ref"],c["!ref"]=aa(Q))}return B.length>0&&(c["!cols"]=B),S.length>0&&(c["!merges"]=S),c}function RM(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+aa(e[r])+'"/>';return t+"</mergeCells>"}function i_(e,t,r,a){var s=zr(e);r.Sheets[a]||(r.Sheets[a]={}),s.codeName&&(r.Sheets[a].CodeName=Fa(is(s.codeName)))}function MM(e,t,r,a,s){i_(e.slice(0,e.indexOf(">")),r,a,s)}function HM(e,t,r,a,s){var n=!1,o={},c=null;if(a.bookType!=="xlsx"&&t.vbaraw){var u=t.SheetNames[r];try{t.Workbook&&(u=t.Workbook.Sheets[r].CodeName||u)}catch{}n=!0,o.codeName=yc(Ja(u))}if(e&&e["!outline"]){var f={summaryBelow:1,summaryRight:1};e["!outline"].above&&(f.summaryBelow=0),e["!outline"].left&&(f.summaryRight=0),c=(c||"")+Mt("outlinePr",null,f)}!n&&!c||(s[s.length]=Mt("sheetPr",c,o))}var PM=["objects","scenarios","selectLockedCells","selectUnlockedCells"],qM=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function KM(e){var t={sheet:1};return PM.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),qM.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Z2(e.password).toString(16).toUpperCase()),Mt("sheetProtection",null,t)}function zM(e,t,r){for(var a=Array.isArray(e),s=0;s!=t.length;++s){var n=zr(is(t[s]),!0);if(!n.ref)return;var o=((r||{})["!id"]||[])[n.id];o?(n.Target=o.Target,n.location&&(n.Target+="#"+Fa(n.location))):(n.Target="#"+Fa(n.location),o={Target:n.Target,TargetMode:"Internal"}),n.Rel=o,n.tooltip&&(n.Tooltip=n.tooltip,delete n.tooltip);for(var c=Ta(n.ref),u=c.s.r;u<=c.e.r;++u)for(var f=c.s.c;f<=c.e.c;++f){var h=Kr({c:f,r:u});a?(e[u]||(e[u]=[]),e[u][f]||(e[u][f]={t:"z",v:void 0}),e[u][f].l=n):(e[h]||(e[h]={t:"z",v:void 0}),e[h].l=n)}}}function VM(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function GM(e){return z0(e),Mt("pageMargins",null,e)}function WM(e,t){for(var r=!1,a=0;a!=t.length;++a){var s=zr(t[a],!0);s.hidden&&(s.hidden=Ns(s.hidden));var n=parseInt(s.min,10)-1,o=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,e_(s.width)),l0(s);n<=o;)e[n++]=Ts(s)}}function $M(e,t){for(var r=["<cols>"],a,s=0;s!=t.length;++s)(a=t[s])&&(r[r.length]=Mt("col",null,ob(s,a)));return r[r.length]="</cols>",r.join("")}function XM(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function YM(e,t,r,a){var s=typeof e.ref=="string"?e.ref:aa(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var n=r.Workbook.Names,o=ro(s);o.s.r==o.e.r&&(o.e.r=ro(t["!ref"]).e.r,s=aa(o));for(var c=0;c<n.length;++c){var u=n[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==a){u.Ref="'"+r.SheetNames[a]+"'!"+s;break}}return c==n.length&&n.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+s}),Mt("autoFilter",null,{ref:s})}var JM=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function ZM(e,t){t.Views||(t.Views=[{}]),(e.match(JM)||[]).forEach(function(r,a){var s=zr(r);t.Views[a]||(t.Views[a]={}),+s.zoomScale&&(t.Views[a].zoom=+s.zoomScale),Ns(s.rightToLeft)&&(t.Views[a].RTL=!0)})}function e9(e,t,r,a){var s={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Mt("sheetViews",Mt("sheetView",null,s),{})}function t9(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",n=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=uu[e.v];break;case"d":a&&a.cellDates?s=Fs(e.v,-1).toISOString():(e=Ts(e),e.t="n",s=""+(e.v=ui(Fs(e.v)))),typeof e.z>"u"&&(e.z=Rr[14]);break;default:s=e.v;break}var c=Qi("v",Ja(s)),u={r:t},f=m0(a.cellXfs,e,a);switch(f!==0&&(u.s=f),e.t){case"n":break;case"d":u.t="d";break;case"b":u.t="b";break;case"e":u.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){c=Qi("v",""+n_(a.Strings,e.v,a.revStrings)),u.t="s";break}u.t="str";break}if(e.t!=n&&(e.t=n,e.v=o),typeof e.f=="string"&&e.f){var h=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;c=Mt("f",Ja(e.f),h)+(e.v!=null?c:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(u.cm=1),Mt("c",c,u)}var r9=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,n=Np("v"),o=Np("f");return function(u,f,h,g,x,m){for(var w=0,v="",B=[],k=[],E=0,S=0,L=0,P="",R,Q,V=0,U=0,M,T,D=0,G=0,ne=Array.isArray(m.CellXf),H,ee=[],le=[],pe=Array.isArray(f),te=[],Le={},je=!1,F=!!h.sheetStubs,K=u.split(t),I=0,q=K.length;I!=q;++I){v=K[I].trim();var J=v.length;if(J!==0){var Y=0;e:for(w=0;w<J;++w)switch(v[w]){case">":if(v[w-1]!="/"){++w;break e}if(h&&h.cellStyles){if(Q=zr(v.slice(Y,w),!0),V=Q.r!=null?parseInt(Q.r,10):V+1,U=-1,h.sheetRows&&h.sheetRows<V)continue;Le={},je=!1,Q.ht&&(je=!0,Le.hpt=parseFloat(Q.ht),Le.hpx=Lf(Le.hpt)),Q.hidden=="1"&&(je=!0,Le.hidden=!0),Q.outlineLevel!=null&&(je=!0,Le.level=+Q.outlineLevel),je&&(te[V-1]=Le)}break;case"<":Y=w;break}if(Y>=w)break;if(Q=zr(v.slice(Y,w),!0),V=Q.r!=null?parseInt(Q.r,10):V+1,U=-1,!(h.sheetRows&&h.sheetRows<V)){g.s.r>V-1&&(g.s.r=V-1),g.e.r<V-1&&(g.e.r=V-1),h&&h.cellStyles&&(Le={},je=!1,Q.ht&&(je=!0,Le.hpt=parseFloat(Q.ht),Le.hpx=Lf(Le.hpt)),Q.hidden=="1"&&(je=!0,Le.hidden=!0),Q.outlineLevel!=null&&(je=!0,Le.level=+Q.outlineLevel),je&&(te[V-1]=Le)),B=v.slice(w).split(e);for(var de=0;de!=B.length&&B[de].trim().charAt(0)=="<";++de);for(B=B.slice(de),w=0;w!=B.length;++w)if(v=B[w].trim(),v.length!==0){if(k=v.match(r),E=w,S=0,L=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,k!=null&&k.length===2){for(E=0,P=k[1],S=0;S!=P.length&&!((L=P.charCodeAt(S)-64)<1||L>26);++S)E=26*E+L;--E,U=E}else++U;for(S=0;S!=v.length&&v.charCodeAt(S)!==62;++S);if(++S,Q=zr(v.slice(0,S),!0),Q.r||(Q.r=Kr({r:V-1,c:U})),P=v.slice(S),R={t:""},(k=P.match(n))!=null&&k[1]!==""&&(R.v=Fa(k[1])),h.cellFormula){if((k=P.match(o))!=null&&k[1]!==""){if(R.f=Fa(is(k[1])).replace(/\r\n/g,`
`),h.xlfn||(R.f=D4(R.f)),k[0].indexOf('t="array"')>-1)R.F=(P.match(s)||[])[1],R.F.indexOf(":")>-1&&ee.push([Ta(R.F),R.F]);else if(k[0].indexOf('t="shared"')>-1){T=zr(k[0]);var ue=Fa(is(k[1]));h.xlfn||(ue=D4(ue)),le[parseInt(T.si,10)]=[T,ue,Q.r]}}else(k=P.match(/<f[^>]*\/>/))&&(T=zr(k[0]),le[T.si]&&(R.f=JO(le[T.si][1],le[T.si][2],Q.r)));var we=Xs(Q.r);for(S=0;S<ee.length;++S)we.r>=ee[S][0].s.r&&we.r<=ee[S][0].e.r&&we.c>=ee[S][0].s.c&&we.c<=ee[S][0].e.c&&(R.F=ee[S][1])}if(Q.t==null&&R.v===void 0)if(R.f||R.F)R.v=0,R.t="n";else if(F)R.t="z";else continue;else R.t=Q.t||"n";switch(g.s.c>U&&(g.s.c=U),g.e.c<U&&(g.e.c=U),R.t){case"n":if(R.v==""||R.v==null){if(!F)continue;R.t="z"}else R.v=parseFloat(R.v);break;case"s":if(typeof R.v>"u"){if(!F)continue;R.t="z"}else M=np[parseInt(R.v,10)],R.v=M.t,R.r=M.r,h.cellHTML&&(R.h=M.h);break;case"str":R.t="s",R.v=R.v!=null?is(R.v):"",h.cellHTML&&(R.h=O2(R.v));break;case"inlineStr":k=P.match(a),R.t="s",k!=null&&(M=J2(k[1]))?(R.v=M.t,h.cellHTML&&(R.h=M.h)):R.v="";break;case"b":R.v=Ns(R.v);break;case"d":h.cellDates?R.v=Fs(R.v,1):(R.v=ui(Fs(R.v,1)),R.t="n");break;case"e":(!h||h.cellText!==!1)&&(R.w=R.v),R.v=cN[R.v];break}if(D=G=0,H=null,ne&&Q.s!==void 0&&(H=m.CellXf[Q.s],H!=null&&(H.numFmtId!=null&&(D=H.numFmtId),h.cellStyles&&H.fillId!=null&&(G=H.fillId))),lE(R,D,G,h,x,m),h.cellDates&&ne&&R.t=="n"&&Qf(Rr[D])&&(R.t="d",R.v=sb(R.v)),Q.cm&&h.xlmeta){var Ie=(h.xlmeta.Cell||[])[+Q.cm-1];Ie&&Ie.type=="XLDAPR"&&(R.D=!0)}if(pe){var Ae=Xs(Q.r);f[Ae.r]||(f[Ae.r]=[]),f[Ae.r][Ae.c]=R}else f[Q.r]=R}}}}te.length>0&&(f["!rows"]=te)}})();function a9(e,t,r,a){var s=[],n=[],o=Ta(e["!ref"]),c="",u,f="",h=[],g=0,x=0,m=e["!rows"],w=Array.isArray(e),v={r:f},B,k=-1;for(x=o.s.c;x<=o.e.c;++x)h[x]=$s(x);for(g=o.s.r;g<=o.e.r;++g){for(n=[],f=En(g),x=o.s.c;x<=o.e.c;++x){u=h[x]+f;var E=w?(e[g]||[])[x]:e[u];E!==void 0&&(c=t9(E,u,e,t))!=null&&n.push(c)}(n.length>0||m&&m[g])&&(v={r:f},m&&m[g]&&(B=m[g],B.hidden&&(v.hidden=1),k=-1,B.hpx?k=Dp(B.hpx):B.hpt&&(k=B.hpt),k>-1&&(v.ht=k,v.customHeight=1),B.level&&(v.outlineLevel=B.level)),s[s.length]=Mt("row",n.join(""),v))}if(m)for(;g<m.length;++g)m&&m[g]&&(v={r:g+1},B=m[g],B.hidden&&(v.hidden=1),k=-1,B.hpx?k=Dp(B.hpx):B.hpt&&(k=B.hpt),k>-1&&(v.ht=k,v.customHeight=1),B.level&&(v.outlineLevel=B.level),s[s.length]=Mt("row","",v));return s.join("")}function AE(e,t,r,a){var s=[Fn,Mt("worksheet",null,{xmlns:sd[0],"xmlns:r":ci.r})],n=r.SheetNames[e],o=0,c="",u=r.Sheets[n];u==null&&(u={});var f=u["!ref"]||"A1",h=Ta(f);if(h.e.c>16383||h.e.r>1048575){if(t.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),f=aa(h)}a||(a={}),u["!comments"]=[];var g=[];HM(u,r,e,t,s),s[s.length]=Mt("dimension",null,{ref:f}),s[s.length]=e9(u,t,e,r),t.sheetFormat&&(s[s.length]=Mt("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),u["!cols"]!=null&&u["!cols"].length>0&&(s[s.length]=$M(u,u["!cols"])),s[o=s.length]="<sheetData/>",u["!links"]=[],u["!ref"]!=null&&(c=a9(u,t),c.length>0&&(s[s.length]=c)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),u["!protect"]&&(s[s.length]=KM(u["!protect"])),u["!autofilter"]!=null&&(s[s.length]=YM(u["!autofilter"],u,r,e)),u["!merges"]!=null&&u["!merges"].length>0&&(s[s.length]=RM(u["!merges"]));var x=-1,m,w=-1;return u["!links"].length>0&&(s[s.length]="<hyperlinks>",u["!links"].forEach(function(v){v[1].Target&&(m={ref:v[0]},v[1].Target.charAt(0)!="#"&&(w=Xa(a,-1,Ja(v[1].Target).replace(/#.*$/,""),ua.HLINK),m["r:id"]="rId"+w),(x=v[1].Target.indexOf("#"))>-1&&(m.location=Ja(v[1].Target.slice(x+1))),v[1].Tooltip&&(m.tooltip=Ja(v[1].Tooltip)),s[s.length]=Mt("hyperlink",null,m))}),s[s.length]="</hyperlinks>"),delete u["!links"],u["!margins"]!=null&&(s[s.length]=GM(u["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=Qi("ignoredErrors",Mt("ignoredError",null,{numberStoredAsText:1,sqref:f}))),g.length>0&&(w=Xa(a,-1,"../drawings/drawing"+(e+1)+".xml",ua.DRAW),s[s.length]=Mt("drawing",null,{"r:id":"rId"+w}),u["!drawing"]=g),u["!comments"].length>0&&(w=Xa(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",ua.VML),s[s.length]=Mt("legacyDrawing",null,{"r:id":"rId"+w}),u["!legacy"]=w),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function s9(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var n=e.read_shift(1);return e.l=a,n&7&&(r.level=n&7),n&16&&(r.hidden=!0),n&32&&(r.hpt=s/20),r}function n9(e,t,r){var a=At(145),s=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var n=320;s.hpx?n=Dp(s.hpx)*20:s.hpt&&(n=s.hpt*20),a.write_shift(2,n),a.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),a.write_shift(1,o),a.write_shift(1,0);var c=0,u=a.l;a.l+=4;for(var f={r:e,c:0},h=0;h<16;++h)if(!(t.s.c>h+1<<10||t.e.c<h<<10)){for(var g=-1,x=-1,m=h<<10;m<h+1<<10;++m){f.c=m;var w=Array.isArray(r)?(r[f.r]||[])[f.c]:r[Kr(f)];w&&(g<0&&(g=m),x=m)}g<0||(++c,a.write_shift(4,g),a.write_shift(4,x))}var v=a.l;return a.l=u,a.write_shift(4,c),a.l=v,a.length>a.l?a.slice(0,a.l):a}function i9(e,t,r,a){var s=n9(a,r,t);(s.length>17||(t["!rows"]||[])[a])&&kt(e,0,s)}var l9=od,o9=Mf;function A9(){}function c9(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=f7(e),r}function u9(e,t,r){r==null&&(r=At(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var s=1;s<3;++s)r.write_shift(1,0);return bx({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),nN(e,r),r.slice(0,r.l)}function d9(e){var t=sA(e);return[t]}function f9(e,t,r){return r==null&&(r=At(8)),nd(t,r)}function h9(e){var t=id(e);return[t]}function p9(e,t,r){return r==null&&(r=At(4)),ld(t,r)}function g9(e){var t=sA(e),r=e.read_shift(1);return[t,r,"b"]}function m9(e,t,r){return r==null&&(r=At(9)),nd(t,r),r.write_shift(1,e.v?1:0),r}function x9(e){var t=id(e),r=e.read_shift(1);return[t,r,"b"]}function b9(e,t,r){return r==null&&(r=At(5)),ld(t,r),r.write_shift(1,e.v?1:0),r}function v9(e){var t=sA(e),r=e.read_shift(1);return[t,r,"e"]}function w9(e,t,r){return r==null&&(r=At(9)),nd(t,r),r.write_shift(1,e.v),r}function _9(e){var t=id(e),r=e.read_shift(1);return[t,r,"e"]}function y9(e,t,r){return r==null&&(r=At(8)),ld(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function k9(e){var t=sA(e),r=e.read_shift(4);return[t,r,"s"]}function B9(e,t,r){return r==null&&(r=At(12)),nd(t,r),r.write_shift(4,t.v),r}function C9(e){var t=id(e),r=e.read_shift(4);return[t,r,"s"]}function S9(e,t,r){return r==null&&(r=At(8)),ld(t,r),r.write_shift(4,t.v),r}function N9(e){var t=sA(e),r=il(e);return[t,r,"n"]}function E9(e,t,r){return r==null&&(r=At(16)),nd(t,r),J0(e.v,r),r}function cE(e){var t=id(e),r=il(e);return[t,r,"n"]}function F9(e,t,r){return r==null&&(r=At(12)),ld(t,r),J0(e.v,r),r}function T9(e){var t=sA(e),r=G2(e);return[t,r,"n"]}function L9(e,t,r){return r==null&&(r=At(12)),nd(t,r),iN(e.v,r),r}function j9(e){var t=id(e),r=G2(e);return[t,r,"n"]}function U9(e,t,r){return r==null&&(r=At(8)),ld(t,r),iN(e.v,r),r}function D9(e){var t=sA(e),r=K2(e);return[t,r,"is"]}function I9(e){var t=sA(e),r=ll(e);return[t,r,"str"]}function Q9(e,t,r){return r==null&&(r=At(12+4*e.v.length)),nd(t,r),ki(e.v,r),r.length>r.l?r.slice(0,r.l):r}function O9(e){var t=id(e),r=ll(e);return[t,r,"str"]}function R9(e,t,r){return r==null&&(r=At(8+4*e.v.length)),ld(t,r),ki(e.v,r),r.length>r.l?r.slice(0,r.l):r}function M9(e,t,r){var a=e.l+t,s=sA(e);s.r=r["!row"];var n=e.read_shift(1),o=[s,n,"b"];if(r.cellFormula){e.l+=2;var c=lb(e,a-e.l,r);o[3]=al(c,null,s,r.supbooks,r)}else e.l=a;return o}function H9(e,t,r){var a=e.l+t,s=sA(e);s.r=r["!row"];var n=e.read_shift(1),o=[s,n,"e"];if(r.cellFormula){e.l+=2;var c=lb(e,a-e.l,r);o[3]=al(c,null,s,r.supbooks,r)}else e.l=a;return o}function P9(e,t,r){var a=e.l+t,s=sA(e);s.r=r["!row"];var n=il(e),o=[s,n,"n"];if(r.cellFormula){e.l+=2;var c=lb(e,a-e.l,r);o[3]=al(c,null,s,r.supbooks,r)}else e.l=a;return o}function q9(e,t,r){var a=e.l+t,s=sA(e);s.r=r["!row"];var n=ll(e),o=[s,n,"str"];if(r.cellFormula){e.l+=2;var c=lb(e,a-e.l,r);o[3]=al(c,null,s,r.supbooks,r)}else e.l=a;return o}var K9=od,z9=Mf;function V9(e,t){return t==null&&(t=At(4)),t.write_shift(4,e),t}function G9(e,t){var r=e.l+t,a=od(e),s=z2(e),n=ll(e),o=ll(e),c=ll(e);e.l=r;var u={rfx:a,relId:s,loc:n,display:c};return o&&(u.Tooltip=o),u}function W9(e,t){var r=At(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Mf({s:Xs(e[0]),e:Xs(e[0])},r),V2("rId"+t,r);var a=e[1].Target.indexOf("#"),s=a==-1?"":e[1].Target.slice(a+1);return ki(s||"",r),ki(e[1].Tooltip||"",r),ki("",r),r.slice(0,r.l)}function $9(){}function X9(e,t,r){var a=e.l+t,s=lN(e),n=e.read_shift(1),o=[s];if(o[2]=n,r.cellFormula){var c=vM(e,a-e.l,r);o[1]=c}else e.l=a;return o}function Y9(e,t,r){var a=e.l+t,s=od(e),n=[s];if(r.cellFormula){var o=_M(e,a-e.l,r);n[1]=o,e.l=a}else e.l=a;return n}function J9(e,t,r){r==null&&(r=At(18));var a=ob(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof a.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var uE=["left","right","top","bottom","header","footer"];function Z9(e){var t={};return uE.forEach(function(r){t[r]=il(e)}),t}function eH(e,t){return t==null&&(t=At(48)),z0(e),uE.forEach(function(r){J0(e[r],t)}),t}function tH(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function rH(e,t,r){r==null&&(r=At(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function aH(e){var t=At(24);return t.write_shift(4,4),t.write_shift(4,1),Mf(e,t),t}function sH(e,t){return t==null&&(t=At(66)),t.write_shift(2,e.password?Z2(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function nH(){}function iH(){}function lH(e,t,r,a,s,n,o){if(!e)return e;var c=t||{};a||(a={"!id":{}});var u=c.dense?[]:{},f,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=!1,x=!1,m,w,v,B,k,E,S,L,P,R=[];c.biff=12,c["!row"]=0;var Q=0,V=!1,U=[],M={},T=c.supbooks||s.supbooks||[[]];if(T.sharedf=M,T.arrayf=U,T.SheetNames=s.SheetNames||s.Sheets.map(function(pe){return pe.name}),!c.supbooks&&(c.supbooks=T,s.Names))for(var D=0;D<s.Names.length;++D)T[0][D+1]=s.Names[D];var G=[],ne=[],H=!1;Ip[16]={n:"BrtShortReal",f:cE};var ee;if(cu(e,function(te,Le,je){if(!x)switch(je){case 148:f=te;break;case 0:m=te,c.sheetRows&&c.sheetRows<=m.r&&(x=!0),L=En(B=m.r),c["!row"]=m.r,(te.hidden||te.hpt||te.level!=null)&&(te.hpt&&(te.hpx=Lf(te.hpt)),ne[te.r]=te);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(w={t:te[2]},te[2]){case"n":w.v=te[1];break;case"s":S=np[te[1]],w.v=S.t,w.r=S.r;break;case"b":w.v=!!te[1];break;case"e":w.v=te[1],c.cellText!==!1&&(w.w=uu[w.v]);break;case"str":w.t="s",w.v=te[1];break;case"is":w.t="s",w.v=te[1].t;break}if((v=o.CellXf[te[0].iStyleRef])&&lE(w,v.numFmtId,null,c,n,o),k=te[0].c==-1?k+1:te[0].c,c.dense?(u[B]||(u[B]=[]),u[B][k]=w):u[$s(k)+L]=w,c.cellFormula){for(V=!1,Q=0;Q<U.length;++Q){var F=U[Q];m.r>=F[0].s.r&&m.r<=F[0].e.r&&k>=F[0].s.c&&k<=F[0].e.c&&(w.F=aa(F[0]),V=!0)}!V&&te.length>3&&(w.f=te[3])}if(h.s.r>m.r&&(h.s.r=m.r),h.s.c>k&&(h.s.c=k),h.e.r<m.r&&(h.e.r=m.r),h.e.c<k&&(h.e.c=k),c.cellDates&&v&&w.t=="n"&&Qf(Rr[v.numFmtId])){var K=R0(w.v);K&&(w.t="d",w.v=new Date(K.y,K.m-1,K.d,K.H,K.M,K.S,K.u))}ee&&(ee.type=="XLDAPR"&&(w.D=!0),ee=void 0);break;case 1:case 12:if(!c.sheetStubs||g)break;w={t:"z",v:void 0},k=te[0].c==-1?k+1:te[0].c,c.dense?(u[B]||(u[B]=[]),u[B][k]=w):u[$s(k)+L]=w,h.s.r>m.r&&(h.s.r=m.r),h.s.c>k&&(h.s.c=k),h.e.r<m.r&&(h.e.r=m.r),h.e.c<k&&(h.e.c=k),ee&&(ee.type=="XLDAPR"&&(w.D=!0),ee=void 0);break;case 176:R.push(te);break;case 49:ee=((c.xlmeta||{}).Cell||[])[te-1];break;case 494:var I=a["!id"][te.relId];for(I?(te.Target=I.Target,te.loc&&(te.Target+="#"+te.loc),te.Rel=I):te.relId==""&&(te.Target="#"+te.loc),B=te.rfx.s.r;B<=te.rfx.e.r;++B)for(k=te.rfx.s.c;k<=te.rfx.e.c;++k)c.dense?(u[B]||(u[B]=[]),u[B][k]||(u[B][k]={t:"z",v:void 0}),u[B][k].l=te):(E=Kr({c:k,r:B}),u[E]||(u[E]={t:"z",v:void 0}),u[E].l=te);break;case 426:if(!c.cellFormula)break;U.push(te),P=c.dense?u[B][k]:u[$s(k)+L],P.f=al(te[1],h,{r:m.r,c:k},T,c),P.F=aa(te[0]);break;case 427:if(!c.cellFormula)break;M[Kr(te[0].s)]=te[1],P=c.dense?u[B][k]:u[$s(k)+L],P.f=al(te[1],h,{r:m.r,c:k},T,c);break;case 60:if(!c.cellStyles)break;for(;te.e>=te.s;)G[te.e--]={width:te.w/256,hidden:!!(te.flags&1),level:te.level},H||(H=!0,e_(te.w/256)),l0(G[te.e+1]);break;case 161:u["!autofilter"]={ref:aa(te)};break;case 476:u["!margins"]=te;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),te.name&&(s.Sheets[r].CodeName=te.name),(te.above||te.left)&&(u["!outline"]={above:te.above,left:te.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),te.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:g=!0;break;case 36:g=!1;break;case 37:g=!0;break;case 38:g=!1;break;default:if(!Le.T){if(!g||c.WTF)throw new Error("Unexpected record 0x"+je.toString(16))}}},c),delete c.supbooks,delete c["!row"],!u["!ref"]&&(h.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(u["!ref"]=aa(f||h)),c.sheetRows&&u["!ref"]){var le=Ta(u["!ref"]);c.sheetRows<=+le.e.r&&(le.e.r=c.sheetRows-1,le.e.r>h.e.r&&(le.e.r=h.e.r),le.e.r<le.s.r&&(le.s.r=le.e.r),le.e.c>h.e.c&&(le.e.c=h.e.c),le.e.c<le.s.c&&(le.s.c=le.e.c),u["!fullref"]=u["!ref"],u["!ref"]=aa(le))}return R.length>0&&(u["!merges"]=R),G.length>0&&(u["!cols"]=G),ne.length>0&&(u["!rows"]=ne),u}function oH(e,t,r,a,s,n,o){if(t.v===void 0)return!1;var c="";switch(t.t){case"b":c=t.v?"1":"0";break;case"d":t=Ts(t),t.z=t.z||Rr[14],t.v=ui(Fs(t.v)),t.t="n";break;case"n":case"e":c=""+t.v;break;default:c=t.v;break}var u={r,c:a};switch(u.s=m0(s.cellXfs,t,s),t.l&&n["!links"].push([Kr(u),t.l]),t.c&&n["!comments"].push([Kr(u),t.c]),t.t){case"s":case"str":return s.bookSST?(c=n_(s.Strings,t.v,s.revStrings),u.t="s",u.v=c,o?kt(e,18,S9(t,u)):kt(e,7,B9(t,u))):(u.t="str",o?kt(e,17,R9(t,u)):kt(e,6,Q9(t,u))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?kt(e,13,U9(t,u)):kt(e,2,L9(t,u)):o?kt(e,16,F9(t,u)):kt(e,5,E9(t,u)),!0;case"b":return u.t="b",o?kt(e,15,b9(t,u)):kt(e,4,m9(t,u)),!0;case"e":return u.t="e",o?kt(e,14,y9(t,u)):kt(e,3,w9(t,u)),!0}return o?kt(e,12,p9(t,u)):kt(e,1,f9(t,u)),!0}function AH(e,t,r,a){var s=Ta(t["!ref"]||"A1"),n,o="",c=[];kt(e,145);var u=Array.isArray(t),f=s.e.r;t["!rows"]&&(f=Math.max(s.e.r,t["!rows"].length-1));for(var h=s.s.r;h<=f;++h){o=En(h),i9(e,t,s,h);var g=!1;if(h<=s.e.r)for(var x=s.s.c;x<=s.e.c;++x){h===s.s.r&&(c[x]=$s(x)),n=c[x]+o;var m=u?(t[h]||[])[x]:t[n];if(!m){g=!1;continue}g=oH(e,m,h,x,a,t,g)}}kt(e,146)}function cH(e,t){!t||!t["!merges"]||(kt(e,177,V9(t["!merges"].length)),t["!merges"].forEach(function(r){kt(e,176,z9(r))}),kt(e,178))}function uH(e,t){!t||!t["!cols"]||(kt(e,390),t["!cols"].forEach(function(r,a){r&&kt(e,60,J9(a,r))}),kt(e,391))}function dH(e,t){!t||!t["!ref"]||(kt(e,648),kt(e,649,aH(Ta(t["!ref"]))),kt(e,650))}function fH(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var s=Xa(r,-1,a[1].Target.replace(/#.*$/,""),ua.HLINK);kt(e,494,W9(a,s))}}),delete t["!links"]}function hH(e,t,r,a){if(t["!comments"].length>0){var s=Xa(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",ua.VML);kt(e,551,V2("rId"+s)),t["!legacy"]=s}}function pH(e,t,r,a){if(t["!autofilter"]){var s=t["!autofilter"],n=typeof s.ref=="string"?s.ref:aa(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,c=ro(n);c.s.r==c.e.r&&(c.e.r=ro(t["!ref"]).e.r,n=aa(c));for(var u=0;u<o.length;++u){var f=o[u];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==a){f.Ref="'"+r.SheetNames[a]+"'!"+n;break}}u==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),kt(e,161,Mf(Ta(n))),kt(e,162)}}function gH(e,t,r){kt(e,133),kt(e,137,rH(t,r)),kt(e,138),kt(e,134)}function mH(e,t){t["!protect"]&&kt(e,535,sH(t["!protect"]))}function xH(e,t,r,a){var s=to(),n=r.SheetNames[e],o=r.Sheets[n]||{},c=n;try{r&&r.Workbook&&(c=r.Workbook.Sheets[e].CodeName||c)}catch{}var u=Ta(o["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],kt(s,129),(r.vbaraw||o["!outline"])&&kt(s,147,u9(c,o["!outline"])),kt(s,148,o9(u)),gH(s,o,r.Workbook),uH(s,o),AH(s,o,e,t),mH(s,o),pH(s,o,r,e),cH(s,o),fH(s,o,a),o["!margins"]&&kt(s,476,eH(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&dH(s,o),hH(s,o,e,a),kt(s,130),s.end()}function bH(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(n){var o=n.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var s=Fa((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(n){a=n.replace(/<.*?>/g,"")}),[t,s,a]}function vH(e,t,r,a,s,n){var o=n||{"!type":"chart"};if(!e)return n;var c=0,u=0,f="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(g){var x=bH(g);h.s.r=h.s.c=0,h.e.c=c,f=$s(c),x[0].forEach(function(m,w){o[f+En(w)]={t:"n",v:m,z:x[1]},u=w}),h.e.r<u&&(h.e.r=u),++c}),c>0&&(o["!ref"]=aa(h)),o}function wH(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var n={"!type":"chart","!drawel":null,"!rel":""},o,c=e.match(oE);return c&&i_(c[0],n,s,r),(o=e.match(/drawing r:id="(.*?)"/))&&(n["!rel"]=o[1]),a["!id"][n["!rel"]]&&(n["!drawel"]=a["!id"][n["!rel"]]),n}function _H(e,t){e.l+=10;var r=ll(e);return{name:r}}function yH(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var n={"!type":"chart","!drawel":null,"!rel":""},o=!1;return cu(e,function(u,f,h){switch(h){case 550:n["!rel"]=u;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),u.name&&(s.Sheets[r].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}},t),a["!id"][n["!rel"]]&&(n["!drawel"]=a["!id"][n["!rel"]]),n}var l_=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],kH=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],BH=[],CH=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function M4(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],s=0;s!=t.length;++s){var n=t[s];if(a[n[0]]==null)a[n[0]]=n[1];else switch(n[2]){case"bool":typeof a[n[0]]=="string"&&(a[n[0]]=Ns(a[n[0]]));break;case"int":typeof a[n[0]]=="string"&&(a[n[0]]=parseInt(a[n[0]],10));break}}}function H4(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=Ns(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function dE(e){H4(e.WBProps,l_),H4(e.CalcPr,CH),M4(e.WBView,kH),M4(e.Sheets,BH),yf.date1904=Ns(e.WBProps.date1904)}function SH(e){return!e.Workbook||!e.Workbook.WBProps?"false":Ns(e.Workbook.WBProps.date1904)?"true":"false"}var NH="][*?/\\".split("");function fE(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return NH.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function EH(e,t,r){e.forEach(function(a,s){fE(a);for(var n=0;n<s;++n)if(a==e[n])throw new Error("Duplicate Sheet Name: "+a);if(r){var o=t&&t[s]&&t[s].CodeName||a;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function FH(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];EH(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)SM(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var TH=/<\w+:workbook/;function LH(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,s="xmlns",n={},o=0;if(e.replace(Al,function(u,f){var h=zr(u);switch(Cc(h[0])){case"<?xml":break;case"<workbook":u.match(TH)&&(s="xmlns"+u.match(/<(\w+):/)[1]),r.xmlns=h[s];break;case"</workbook>":break;case"<fileVersion":delete h[0],r.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":l_.forEach(function(g){if(h[g[0]]!=null)switch(g[2]){case"bool":r.WBProps[g[0]]=Ns(h[g[0]]);break;case"int":r.WBProps[g[0]]=parseInt(h[g[0]],10);break;default:r.WBProps[g[0]]=h[g[0]]}}),h.codeName&&(r.WBProps.CodeName=is(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],r.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=Fa(is(h.name)),delete h[0],r.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":n={},n.Name=is(h.name),h.comment&&(n.Comment=h.comment),h.localSheetId&&(n.Sheet=+h.localSheetId),Ns(h.hidden||"0")&&(n.Hidden=!0),o=f+u.length;break;case"</definedName>":n.Ref=Fa(is(e.slice(o,f))),r.Names.push(n);break;case"<definedName/>":break;case"<calcPr":delete h[0],r.CalcPr=h;break;case"<calcPr/>":delete h[0],r.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return u}),sd.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return dE(r),r}function hE(e){var t=[Fn];t[t.length]=Mt("workbook",null,{xmlns:sd[0],"xmlns:r":ci.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(l_.forEach(function(c){e.Workbook.WBProps[c[0]]!=null&&e.Workbook.WBProps[c[0]]!=c[1]&&(a[c[0]]=e.Workbook.WBProps[c[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=Mt("workbookPr",null,a);var s=e.Workbook&&e.Workbook.Sheets||[],n=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",n=0;n!=e.SheetNames.length&&!(!s[n]||!s[n].Hidden);++n);n==e.SheetNames.length&&(n=0),t[t.length]='<workbookView firstSheet="'+n+'" activeTab="'+n+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",n=0;n!=e.SheetNames.length;++n){var o={name:Ja(e.SheetNames[n].slice(0,31))};if(o.sheetId=""+(n+1),o["r:id"]="rId"+(n+1),s[n])switch(s[n].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Mt("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(c){var u={name:c.Name};c.Comment&&(u.comment=c.Comment),c.Sheet!=null&&(u.localSheetId=""+c.Sheet),c.Hidden&&(u.hidden="1"),c.Ref&&(t[t.length]=Mt("definedName",Ja(c.Ref),u))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function jH(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=bw(e),r.name=ll(e),r}function UH(e,t){return t||(t=At(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),V2(e.strRelID,t),ki(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function DH(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?ll(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function IH(e,t){t||(t=At(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),nN(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function QH(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function OH(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),n=h7(e),o=wM(e,0,r),c=z2(e);e.l=a;var u={Name:n,Ptg:o};return s<268435455&&(u.Sheet=s),c&&(u.Comment=c),u}function RH(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],s=!1;t||(t={}),t.biff=12;var n=[],o=[[]];return o.SheetNames=[],o.XTI=[],Ip[16]={n:"BrtFRTArchID$",f:QH},cu(e,function(u,f,h){switch(h){case 156:o.SheetNames.push(u.name),r.Sheets.push(u);break;case 153:r.WBProps=u;break;case 39:u.Sheet!=null&&(t.SID=u.Sheet),u.Ref=al(u.Ptg,null,null,o,t),delete t.SID,delete u.Ptg,n.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([h,u]):o[0]=[h,u],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(u),o.XTI=o.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(h),s=!0;break;case 36:a.pop(),s=!1;break;case 37:a.push(h),s=!0;break;case 38:a.pop(),s=!1;break;case 16:break;default:if(!f.T){if(!s||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},t),dE(r),r.Names=n,r.supbooks=o,r}function MH(e,t){kt(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};kt(e,156,UH(s))}kt(e,144)}function HH(e,t){t||(t=At(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return ki("SheetJS",t),ki(dx.version,t),ki(dx.version,t),ki("7262",t),t.length>t.l?t.slice(0,t.l):t}function PH(e,t){t||(t=At(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function qH(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,s=-1,n=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&s==-1?s=a:r[a].Hidden==1&&n==-1&&(n=a);n>s||(kt(e,135),kt(e,158,PH(s)),kt(e,136))}}function KH(e,t){var r=to();return kt(r,131),kt(r,128,HH()),kt(r,153,IH(e.Workbook&&e.Workbook.WBProps||null)),qH(r,e),MH(r,e),kt(r,132),r.end()}function zH(e,t,r){return t.slice(-4)===".bin"?RH(e,r):LH(e,r)}function VH(e,t,r,a,s,n,o,c){return t.slice(-4)===".bin"?lH(e,a,r,s,n,o,c):OM(e,a,r,s,n,o,c)}function GH(e,t,r,a,s,n,o,c){return t.slice(-4)===".bin"?yH(e,a,r,s,n):wH(e,a,r,s,n)}function WH(e,t,r,a,s,n,o,c){return t.slice(-4)===".bin"?XO():YO()}function $H(e,t,r,a,s,n,o,c){return t.slice(-4)===".bin"?WO():$O()}function XH(e,t,r,a){return t.slice(-4)===".bin"?zQ(e,r,a):jQ(e,r,a)}function YH(e,t,r){return WN(e,r)}function JH(e,t,r){return t.slice(-4)===".bin"?JI(e,r):$I(e,r)}function ZH(e,t,r){return t.slice(-4)===".bin"?qO(e,r):UO(e,r)}function eP(e,t,r){return t.slice(-4)===".bin"?TO(e):EO(e)}function tP(e,t,r,a){return r.slice(-4)===".bin"?LO(e,t,r,a):void 0}function rP(e,t,r){return t.slice(-4)===".bin"?CO(e,t,r):NO(e,t,r)}function aP(e,t,r){return(t.slice(-4)===".bin"?KH:hE)(e)}function sP(e,t,r,a,s){return(t.slice(-4)===".bin"?xH:AE)(e,r,a,s)}function nP(e,t,r){return(t.slice(-4)===".bin"?tO:VN)(e,r)}function iP(e,t,r){return(t.slice(-4)===".bin"?tQ:ON)(e,r)}function lP(e,t,r){return(t.slice(-4)===".bin"?KO:YN)(e)}function oP(e){return(e.slice(-4)===".bin"?SO:$N)()}var pE=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,gE=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function _A(e,t){var r=e.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var s=e.match(pE),n,o,c,u;if(s)for(u=0;u!=s.length;++u)n=s[u].match(gE),(o=n[1].indexOf(":"))===-1?a[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?c="xmlns"+n[1].slice(6):c=n[1].slice(o+1),a[c]=n[2].slice(1,n[2].length-1));return a}function AP(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(pE),s,n,o,c;if(a)for(c=0;c!=a.length;++c)s=a[c].match(gE),(n=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(n+1),r[o]=s[2].slice(1,s[2].length-1));return r}var lp;function cP(e,t){var r=lp[e]||Fa(e);return r==="General"?X0(t):rA(r,t)}function uP(e,t,r,a){var s=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Ns(a);break;case"i2":case"int":s=parseInt(a,10);break;case"r4":case"float":s=parseFloat(a);break;case"date":case"dateTime.tz":s=Fs(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Fa(t)]=s}function dP(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||uu[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Sp(e.v):e.w=X0(e.v):e.w=cP(t||"General",e.v)}catch(n){if(r.WTF)throw n}try{var a=lp[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&Qf(a)){var s=R0(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(n){if(r.WTF)throw n}}}function fP(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=BQ[a.Pattern]||a.Pattern)}e[t.ID]=t}function hP(e,t,r,a,s,n,o,c,u,f){var h="General",g=a.StyleID,x={};f=f||{};var m=[],w=0;for(g===void 0&&c&&(g=c.StyleID),g===void 0&&o&&(g=o.StyleID);n[g]!==void 0&&(n[g].nf&&(h=n[g].nf),n[g].Interior&&m.push(n[g].Interior),!!n[g].Parent);)g=n[g].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=Ns(e);break;case"String":a.t="s",a.r=s4(Fa(e)),a.v=e.indexOf("<")>-1?Fa(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(Fs(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),a.v!==a.v?a.v=Fa(e):a.v<60&&(a.v=a.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=cN[e],f.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=s4(t||e));break}if(dP(a,h,f),f.cellFormula!==!1)if(a.Formula){var v=Fa(a.Formula);v.charCodeAt(0)==61&&(v=v.slice(1)),a.f=_f(v,s),delete a.Formula,a.ArrayRange=="RC"?a.F=_f("RC:RC",s):a.ArrayRange&&(a.F=_f(a.ArrayRange,s),u.push([Ta(a.F),a.F]))}else for(w=0;w<u.length;++w)s.r>=u[w][0].s.r&&s.r<=u[w][0].e.r&&s.c>=u[w][0].s.c&&s.c<=u[w][0].e.c&&(a.F=u[w][1]);f.cellStyles&&(m.forEach(function(B){!x.patternType&&B.patternType&&(x.patternType=B.patternType)}),a.s=x),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function pP(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function iv(e,t){var r=t||{};Of();var a=Ph(R2(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=is(a));var s=a.slice(0,1024).toLowerCase(),n=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var o=Ts(r);return o.type="string",Tf.to_workbook(a,o)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(at){s.indexOf("<"+at)>=0&&(n=!0)}),n)return eq(a,r);lp={"General Number":"General","General Date":Rr[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Rr[15],"Short Date":Rr[14],"Long Time":Rr[19],"Medium Time":Rr[18],"Short Time":Rr[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Rr[2],Standard:Rr[4],Percent:Rr[10],Scientific:Rr[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,u=[],f,h={},g=[],x=r.dense?[]:{},m="",w={},v={},B=_A('<Data ss:Type="String">'),k=0,E=0,S=0,L={s:{r:2e6,c:2e6},e:{r:0,c:0}},P={},R={},Q="",V=0,U=[],M={},T={},D=0,G=[],ne=[],H={},ee=[],le,pe=!1,te=[],Le=[],je={},F=0,K=0,I={Sheets:[],WBProps:{date1904:!1}},q={};Fp.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var J="";c=Fp.exec(a);)switch(c[3]=(J=c[3]).toLowerCase()){case"data":if(J=="data"){if(c[1]==="/"){if((f=u.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break}if(u[u.length-1][1])break;c[1]==="/"?hP(a.slice(k,c.index),Q,B,u[u.length-1][0]=="comment"?H:w,{c:E,r:S},P,ee[E],v,te,r):(Q="",B=_A(c[0]),k=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(ne.length>0&&(w.c=ne),(!r.sheetRows||r.sheetRows>S)&&w.v!==void 0&&(r.dense?(x[S]||(x[S]=[]),x[S][E]=w):x[$s(E)+En(S)]=w),w.HRef&&(w.l={Target:Fa(w.HRef)},w.HRefScreenTip&&(w.l.Tooltip=w.HRefScreenTip),delete w.HRef,delete w.HRefScreenTip),(w.MergeAcross||w.MergeDown)&&(F=E+(parseInt(w.MergeAcross,10)|0),K=S+(parseInt(w.MergeDown,10)|0),U.push({s:{c:E,r:S},e:{c:F,r:K}})),!r.sheetStubs)w.MergeAcross?E=F+1:++E;else if(w.MergeAcross||w.MergeDown){for(var Y=E;Y<=F;++Y)for(var de=S;de<=K;++de)(Y>E||de>S)&&(r.dense?(x[de]||(x[de]=[]),x[de][Y]={t:"z"}):x[$s(Y)+En(de)]={t:"z"});E=F+1}else++E;else w=AP(c[0]),w.Index&&(E=+w.Index-1),E<L.s.c&&(L.s.c=E),E>L.e.c&&(L.e.c=E),c[0].slice(-2)==="/>"&&++E,ne=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(S<L.s.r&&(L.s.r=S),S>L.e.r&&(L.e.r=S),c[0].slice(-2)==="/>"&&(v=_A(c[0]),v.Index&&(S=+v.Index-1)),E=0,++S):(v=_A(c[0]),v.Index&&(S=+v.Index-1),je={},(v.AutoFitHeight=="0"||v.Height)&&(je.hpx=parseInt(v.Height,10),je.hpt=Dp(je.hpx),Le[S]=je),v.Hidden=="1"&&(je.hidden=!0,Le[S]=je));break;case"worksheet":if(c[1]==="/"){if((f=u.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"));g.push(m),L.s.r<=L.e.r&&L.s.c<=L.e.c&&(x["!ref"]=aa(L),r.sheetRows&&r.sheetRows<=L.e.r&&(x["!fullref"]=x["!ref"],L.e.r=r.sheetRows-1,x["!ref"]=aa(L))),U.length&&(x["!merges"]=U),ee.length>0&&(x["!cols"]=ee),Le.length>0&&(x["!rows"]=Le),h[m]=x}else L={s:{r:2e6,c:2e6},e:{r:0,c:0}},S=E=0,u.push([c[3],!1]),f=_A(c[0]),m=Fa(f.Name),x=r.dense?[]:{},U=[],te=[],Le=[],q={name:m,Hidden:0},I.Sheets.push(q);break;case"table":if(c[1]==="/"){if((f=u.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else{if(c[0].slice(-2)=="/>")break;u.push([c[3],!1]),ee=[],pe=!1}break;case"style":c[1]==="/"?fP(P,R,r):R=_A(c[0]);break;case"numberformat":R.nf=Fa(_A(c[0]).Format||"General"),lp[R.nf]&&(R.nf=lp[R.nf]);for(var ue=0;ue!=392&&Rr[ue]!=R.nf;++ue);if(ue==392){for(ue=57;ue!=392;++ue)if(Rr[ue]==null){au(R.nf,ue);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(le=_A(c[0]),le.Hidden&&(le.hidden=!0,delete le.Hidden),le.Width&&(le.wpx=parseInt(le.Width,10)),!pe&&le.wpx>10){pe=!0,nl=KN;for(var we=0;we<ee.length;++we)ee[we]&&l0(ee[we])}pe&&l0(le),ee[le.Index-1||ee.length]=le;for(var Ie=0;Ie<+le.Span;++Ie)ee[ee.length]=Ts(le);break;case"namedrange":if(c[1]==="/")break;I.Names||(I.Names=[]);var Ae=zr(c[0]),oe={Name:Ae.Name,Ref:_f(Ae.RefersTo.slice(1),{r:0,c:0})};I.Sheets.length>0&&(oe.Sheet=I.Sheets.length-1),I.Names.push(oe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?Q+=a.slice(V,c.index):V=c.index+c[0].length;break;case"interior":if(!r.cellStyles)break;R.Interior=_A(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?R7(M,J,a.slice(D,c.index)):D=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((f=u.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else u.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((f=u.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"));pP(H),ne.push(H)}else u.push([c[3],!1]),f=_A(c[0]),H={a:f.Author};break;case"autofilter":if(c[1]==="/"){if((f=u.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var He=_A(c[0]);x["!autofilter"]={ref:_f(He.Range).replace(/\$/g,"")},u.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((f=u.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((f=u.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break;case"null":break;default:if(u.length==0&&c[3]=="document"||u.length==0&&c[3]=="uof")return V4(a,r);var se=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:se=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:se=!1}break;case"excelworkbook":switch(c[3]){case"date1904":I.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:se=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:se=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(a.slice(D,c.index)){case"SheetHidden":q.Hidden=1;break;case"SheetVeryHidden":q.Hidden=2;break}else D=c.index+c[0].length;break;case"header":x["!margins"]||z0(x["!margins"]={},"xlml"),isNaN(+zr(c[0]).Margin)||(x["!margins"].header=+zr(c[0]).Margin);break;case"footer":x["!margins"]||z0(x["!margins"]={},"xlml"),isNaN(+zr(c[0]).Margin)||(x["!margins"].footer=+zr(c[0]).Margin);break;case"pagemargins":var qe=zr(c[0]);x["!margins"]||z0(x["!margins"]={},"xlml"),isNaN(+qe.Top)||(x["!margins"].top=+qe.Top),isNaN(+qe.Left)||(x["!margins"].left=+qe.Left),isNaN(+qe.Right)||(x["!margins"].right=+qe.Right),isNaN(+qe.Bottom)||(x["!margins"].bottom=+qe.Bottom);break;case"displayrighttoleft":I.Views||(I.Views=[]),I.Views[0]||(I.Views[0]={}),I.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:se=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:se=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:se=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:se=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:se=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:se=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:se=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:se=!1}break;case"smarttags":break;default:se=!1;break}if(se||c[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?uP(T,J,G,a.slice(D,c.index)):(G=c,D=c.index+c[0].length);break}if(r.WTF)throw"Unrecognized tag: "+c[3]+"|"+u.join("|")}var Ye={};return!r.bookSheets&&!r.bookProps&&(Ye.Sheets=h),Ye.SheetNames=g,Ye.Workbook=I,Ye.SSF=Ts(Rr),Ye.Props=M,Ye.Custprops=T,Ye}function Cw(e,t){switch(A_(t=t||{}),t.type||"base64"){case"base64":return iv(Co(e),t);case"binary":case"buffer":case"file":return iv(e,t);case"array":return iv(p0(e),t)}}function gP(e,t){var r=[];return e.Props&&r.push(M7(e.Props,t)),e.Custprops&&r.push(H7(e.Props,e.Custprops)),r.join("")}function mP(){return""}function xP(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,s){var n=[];n.push(Mt("NumberFormat",null,{"ss:Format":Ja(Rr[a.numFmtId])}));var o={"ss:ID":"s"+(21+s)};r.push(Mt("Style",n.join(""),o))}),Mt("Styles",r.join(""))}function mE(e){return Mt("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+a_(e.Ref,{r:0,c:0})})}function bP(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var s=t[a];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(mE(s)))}return Mt("Names",r.join(""))}function vP(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var s=a.Workbook.Names,n=[],o=0;o<s.length;++o){var c=s[o];c.Sheet==r&&(c.Name.match(/^_xlfn\./)||n.push(mE(c)))}return n.join("")}function wP(e,t,r,a){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Mt("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Mt("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Mt("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)s.push(Mt("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var n=0;n<r&&!(a.Workbook.Sheets[n]&&!a.Workbook.Sheets[n].Hidden);++n);n==r&&s.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Qi("ProtectContents","True")),e["!protect"].objects&&s.push(Qi("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Qi("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Qi("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Qi("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":Mt("WorksheetOptions",s.join(""),{xmlns:bo.x})}function _P(e){return e.map(function(t){var r=qU(t.t||""),a=Mt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Mt("Comment",a,{"ss:Author":t.a})}).join("")}function yP(e,t,r,a,s,n,o){if(!e||e.v==null&&e.f==null)return"";var c={};if(e.f&&(c["ss:Formula"]="="+Ja(a_(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var u=Xs(e.F.slice(t.length+1));c["ss:ArrayRange"]="RC:R"+(u.r==o.r?"":"["+(u.r-o.r)+"]")+"C"+(u.c==o.c?"":"["+(u.c-o.c)+"]")}if(e.l&&e.l.Target&&(c["ss:HRef"]=Ja(e.l.Target),e.l.Tooltip&&(c["x:HRefScreenTip"]=Ja(e.l.Tooltip))),r["!merges"])for(var f=r["!merges"],h=0;h!=f.length;++h)f[h].s.c!=o.c||f[h].s.r!=o.r||(f[h].e.c>f[h].s.c&&(c["ss:MergeAcross"]=f[h].e.c-f[h].s.c),f[h].e.r>f[h].s.r&&(c["ss:MergeDown"]=f[h].e.r-f[h].s.r));var g="",x="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":g="Number",x=String(e.v);break;case"b":g="Boolean",x=e.v?"1":"0";break;case"e":g="Error",x=uu[e.v];break;case"d":g="DateTime",x=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Rr[14]);break;case"s":g="String",x=PU(e.v||"");break}var m=m0(a.cellXfs,e,a);c["ss:StyleID"]="s"+(21+m),c["ss:Index"]=o.c+1;var w=e.v!=null?x:"",v=e.t=="z"?"":'<Data ss:Type="'+g+'">'+w+"</Data>";return(e.c||[]).length>0&&(v+=_P(e.c)),Mt("Cell",v,c)}function kP(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Lf(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function BP(e,t,r,a){if(!e["!ref"])return"";var s=Ta(e["!ref"]),n=e["!merges"]||[],o=0,c=[];e["!cols"]&&e["!cols"].forEach(function(B,k){l0(B);var E=!!B.width,S=ob(k,B),L={"ss:Index":k+1};E&&(L["ss:Width"]=jp(S.width)),B.hidden&&(L["ss:Hidden"]="1"),c.push(Mt("Column",null,L))});for(var u=Array.isArray(e),f=s.s.r;f<=s.e.r;++f){for(var h=[kP(f,(e["!rows"]||[])[f])],g=s.s.c;g<=s.e.c;++g){var x=!1;for(o=0;o!=n.length;++o)if(!(n[o].s.c>g)&&!(n[o].s.r>f)&&!(n[o].e.c<g)&&!(n[o].e.r<f)){(n[o].s.c!=g||n[o].s.r!=f)&&(x=!0);break}if(!x){var m={r:f,c:g},w=Kr(m),v=u?(e[f]||[])[g]:e[w];h.push(yP(v,w,e,t,r,a,m))}}h.push("</Row>"),h.length>2&&c.push(h.join(""))}return c.join("")}function CP(e,t,r){var a=[],s=r.SheetNames[e],n=r.Sheets[s],o=n?vP(n,t,e,r):"";return o.length>0&&a.push("<Names>"+o+"</Names>"),o=n?BP(n,t,e,r):"",o.length>0&&a.push("<Table>"+o+"</Table>"),a.push(wP(n,t,e,r)),a.join("")}function SP(e,t){t||(t={}),e.SSF||(e.SSF=Ts(Rr)),e.SSF&&(Of(),tb(e.SSF),t.revssf=ab(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],m0(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(gP(e,t)),r.push(mP()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(Mt("Worksheet",CP(a,t,e),{"ss:Name":Ja(e.SheetNames[a])}));return r[2]=xP(e,t),r[3]=bP(e),Fn+Mt("Workbook",r.join(""),{xmlns:bo.ss,"xmlns:o":bo.o,"xmlns:x":bo.x,"xmlns:ss":bo.ss,"xmlns:dt":bo.dt,"xmlns:html":bo.html})}function NP(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=b7(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=v7(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var EP=[60,1084,2066,2165,2175];function FP(e,t,r,a,s){var n=a,o=[],c=r.slice(r.l,r.l+n);if(s&&s.enc&&s.enc.insitu&&c.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(c)}o.push(c),r.l+=n;for(var u=tu(r,r.l),f=Sw[u],h=0;f!=null&&EP.indexOf(u)>-1;)n=tu(r,r.l+2),h=r.l+4,u==2066?h+=4:(u==2165||u==2175)&&(h+=12),c=r.slice(h,r.l+4+n),o.push(c),r.l+=4+n,f=Sw[u=tu(r,r.l)];var g=yi(o);Ii(g,0);var x=0;g.lens=[];for(var m=0;m<o.length;++m)g.lens.push(x),x+=o[m].length;if(g.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+g.length+" < "+a;return t.f(g,g.length,s)}function Ac(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Rr[a])}catch(n){if(t.WTF)throw n}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||uu[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Sp(e.v):e.w=X0(e.v):e.w=rA(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(n){if(t.WTF)throw n}if(t.cellDates&&a&&e.t=="n"&&Qf(Rr[a]||String(a))){var s=R0(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function cm(e,t,r){return{v:e,ixfe:t,t:r}}function TP(e,t){var r={opts:{}},a={},s=t.dense?[]:{},n={},o={},c=null,u=[],f="",h={},g,x="",m,w,v,B,k={},E=[],S,L,P=[],R=[],Q={Sheets:[],WBProps:{date1904:!1},Views:[{}]},V={},U=function(Nt){return Nt<8?P0[Nt]:Nt<64&&R[Nt-8]||P0[Nt]},M=function(Nt,gt,dr){var Ht=gt.XF.data;if(!(!Ht||!Ht.patternType||!dr||!dr.cellStyles)){gt.s={},gt.s.patternType=Ht.patternType;var Rt;(Rt=Lp(U(Ht.icvFore)))&&(gt.s.fgColor={rgb:Rt}),(Rt=Lp(U(Ht.icvBack)))&&(gt.s.bgColor={rgb:Rt})}},T=function(Nt,gt,dr){if(!(je>1)&&!(dr.sheetRows&&Nt.r>=dr.sheetRows)){if(dr.cellStyles&&gt.XF&&gt.XF.data&&M(Nt,gt,dr),delete gt.ixfe,delete gt.XF,g=Nt,x=Kr(Nt),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Nt.r<o.s.r&&(o.s.r=Nt.r),Nt.c<o.s.c&&(o.s.c=Nt.c),Nt.r+1>o.e.r&&(o.e.r=Nt.r+1),Nt.c+1>o.e.c&&(o.e.c=Nt.c+1),dr.cellFormula&&gt.f){for(var Ht=0;Ht<E.length;++Ht)if(!(E[Ht][0].s.c>Nt.c||E[Ht][0].s.r>Nt.r)&&!(E[Ht][0].e.c<Nt.c||E[Ht][0].e.r<Nt.r)){gt.F=aa(E[Ht][0]),(E[Ht][0].s.c!=Nt.c||E[Ht][0].s.r!=Nt.r)&&delete gt.f,gt.f&&(gt.f=""+al(E[Ht][1],o,Nt,te,D));break}}dr.dense?(s[Nt.r]||(s[Nt.r]=[]),s[Nt.r][Nt.c]=gt):s[x]=gt}},D={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:E,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(D.password=t.password);var G,ne=[],H=[],ee=[],le=[],pe=!1,te=[];te.SheetNames=D.snames,te.sharedf=D.sharedf,te.arrayf=D.arrayf,te.names=[],te.XTI=[];var Le=0,je=0,F=0,K=[],I=[],q;D.codepage=1200,SA(1200);for(var J=!1;e.l<e.length-1;){var Y=e.l,de=e.read_shift(2);if(de===0&&Le===10)break;var ue=e.l===e.length?0:e.read_shift(2),we=Sw[de];if(we&&we.f){if(t.bookSheets&&Le===133&&de!==133)break;if(Le=de,we.r===2||we.r==12){var Ie=e.read_shift(2);if(ue-=2,!D.enc&&Ie!==de&&((Ie&255)<<8|Ie>>8)!==de)throw new Error("rt mismatch: "+Ie+"!="+de);we.r==12&&(e.l+=10,ue-=10)}var Ae={};if(de===10?Ae=we.f(e,ue,D):Ae=FP(de,we,e,ue,D),je==0&&[9,521,1033,2057].indexOf(Le)===-1)continue;switch(de){case 34:r.opts.Date1904=Q.WBProps.date1904=Ae;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(D.enc||(e.l=0),D.enc=Ae,!t.password)throw new Error("File is password-protected");if(Ae.valid==null)throw new Error("Encryption scheme unsupported");if(!Ae.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=Ae;break;case 66:var oe=Number(Ae);switch(oe){case 21010:oe=1200;break;case 32768:oe=1e4;break;case 32769:oe=1252;break}SA(D.codepage=oe),J=!0;break;case 317:D.rrtabid=Ae;break;case 25:D.winlocked=Ae;break;case 439:r.opts.RefreshAll=Ae;break;case 12:r.opts.CalcCount=Ae;break;case 16:r.opts.CalcDelta=Ae;break;case 17:r.opts.CalcIter=Ae;break;case 13:r.opts.CalcMode=Ae;break;case 14:r.opts.CalcPrecision=Ae;break;case 95:r.opts.CalcSaveRecalc=Ae;break;case 15:D.CalcRefMode=Ae;break;case 2211:r.opts.FullCalc=Ae;break;case 129:Ae.fDialog&&(s["!type"]="dialog"),Ae.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),Ae.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:P.push(Ae);break;case 430:te.push([Ae]),te[te.length-1].XTI=[];break;case 35:case 547:te[te.length-1].push(Ae);break;case 24:case 536:q={Name:Ae.Name,Ref:al(Ae.rgce,o,null,te,D)},Ae.itab>0&&(q.Sheet=Ae.itab-1),te.names.push(q),te[0]||(te[0]=[],te[0].XTI=[]),te[te.length-1].push(Ae),Ae.Name=="_xlnm._FilterDatabase"&&Ae.itab>0&&Ae.rgce&&Ae.rgce[0]&&Ae.rgce[0][0]&&Ae.rgce[0][0][0]=="PtgArea3d"&&(I[Ae.itab-1]={ref:aa(Ae.rgce[0][0][1][2])});break;case 22:D.ExternCount=Ae;break;case 23:te.length==0&&(te[0]=[],te[0].XTI=[]),te[te.length-1].XTI=te[te.length-1].XTI.concat(Ae),te.XTI=te.XTI.concat(Ae);break;case 2196:if(D.biff<8)break;q!=null&&(q.Comment=Ae[1]);break;case 18:s["!protect"]=Ae;break;case 19:Ae!==0&&D.WTF&&console.error("Password verifier: "+Ae);break;case 133:n[Ae.pos]=Ae,D.snames.push(Ae.name);break;case 10:{if(--je)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,s["!ref"]=aa(o),t.sheetRows&&t.sheetRows<=o.e.r){var He=o.e.r;o.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=aa(o),o.e.r=He}o.e.r++,o.e.c++}ne.length>0&&(s["!merges"]=ne),H.length>0&&(s["!objects"]=H),ee.length>0&&(s["!cols"]=ee),le.length>0&&(s["!rows"]=le),Q.Sheets.push(V)}f===""?h=s:a[f]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(D.biff===8&&(D.biff={9:2,521:3,1033:4}[de]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Ae.BIFFVer]||8),D.biffguess=Ae.BIFFVer==0,Ae.BIFFVer==0&&Ae.dt==4096&&(D.biff=5,J=!0,SA(D.codepage=28591)),D.biff==8&&Ae.BIFFVer==0&&Ae.dt==16&&(D.biff=2),je++)break;if(s=t.dense?[]:{},D.biff<8&&!J&&(J=!0,SA(D.codepage=t.codepage||1252)),D.biff<5||Ae.BIFFVer==0&&Ae.dt==4096){f===""&&(f="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var se={pos:e.l-ue,name:f};n[se.pos]=se,D.snames.push(f)}else f=(n[Y]||{name:""}).name;Ae.dt==32&&(s["!type"]="chart"),Ae.dt==64&&(s["!type"]="macro"),ne=[],H=[],D.arrayf=E=[],ee=[],le=[],pe=!1,V={Hidden:(n[Y]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[Ae.r]||[])[Ae.c]:s[Kr({c:Ae.c,r:Ae.r})])&&++Ae.c,S={ixfe:Ae.ixfe,XF:P[Ae.ixfe]||{},v:Ae.val,t:"n"},F>0&&(S.z=K[S.ixfe>>8&63]),Ac(S,t,r.opts.Date1904),T({c:Ae.c,r:Ae.r},S,t);break;case 5:case 517:S={ixfe:Ae.ixfe,XF:P[Ae.ixfe],v:Ae.val,t:Ae.t},F>0&&(S.z=K[S.ixfe>>8&63]),Ac(S,t,r.opts.Date1904),T({c:Ae.c,r:Ae.r},S,t);break;case 638:S={ixfe:Ae.ixfe,XF:P[Ae.ixfe],v:Ae.rknum,t:"n"},F>0&&(S.z=K[S.ixfe>>8&63]),Ac(S,t,r.opts.Date1904),T({c:Ae.c,r:Ae.r},S,t);break;case 189:for(var qe=Ae.c;qe<=Ae.C;++qe){var Ye=Ae.rkrec[qe-Ae.c][0];S={ixfe:Ye,XF:P[Ye],v:Ae.rkrec[qe-Ae.c][1],t:"n"},F>0&&(S.z=K[S.ixfe>>8&63]),Ac(S,t,r.opts.Date1904),T({c:qe,r:Ae.r},S,t)}break;case 6:case 518:case 1030:{if(Ae.val=="String"){c=Ae;break}if(S=cm(Ae.val,Ae.cell.ixfe,Ae.tt),S.XF=P[S.ixfe],t.cellFormula){var at=Ae.formula;if(at&&at[0]&&at[0][0]&&at[0][0][0]=="PtgExp"){var Ge=at[0][0][1][0],pt=at[0][0][1][1],nt=Kr({r:Ge,c:pt});k[nt]?S.f=""+al(Ae.formula,o,Ae.cell,te,D):S.F=((t.dense?(s[Ge]||[])[pt]:s[nt])||{}).F}else S.f=""+al(Ae.formula,o,Ae.cell,te,D)}F>0&&(S.z=K[S.ixfe>>8&63]),Ac(S,t,r.opts.Date1904),T(Ae.cell,S,t),c=Ae}break;case 7:case 519:if(c)c.val=Ae,S=cm(Ae,c.cell.ixfe,"s"),S.XF=P[S.ixfe],t.cellFormula&&(S.f=""+al(c.formula,o,c.cell,te,D)),F>0&&(S.z=K[S.ixfe>>8&63]),Ac(S,t,r.opts.Date1904),T(c.cell,S,t),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{E.push(Ae);var Dt=Kr(Ae[0].s);if(m=t.dense?(s[Ae[0].s.r]||[])[Ae[0].s.c]:s[Dt],t.cellFormula&&m){if(!c||!Dt||!m)break;m.f=""+al(Ae[1],o,Ae[0],te,D),m.F=aa(Ae[0])}}break;case 1212:{if(!t.cellFormula)break;if(x){if(!c)break;k[Kr(c.cell)]=Ae[0],m=t.dense?(s[c.cell.r]||[])[c.cell.c]:s[Kr(c.cell)],(m||{}).f=""+al(Ae[0],o,g,te,D)}}break;case 253:S=cm(u[Ae.isst].t,Ae.ixfe,"s"),u[Ae.isst].h&&(S.h=u[Ae.isst].h),S.XF=P[S.ixfe],F>0&&(S.z=K[S.ixfe>>8&63]),Ac(S,t,r.opts.Date1904),T({c:Ae.c,r:Ae.r},S,t);break;case 513:t.sheetStubs&&(S={ixfe:Ae.ixfe,XF:P[Ae.ixfe],t:"z"},F>0&&(S.z=K[S.ixfe>>8&63]),Ac(S,t,r.opts.Date1904),T({c:Ae.c,r:Ae.r},S,t));break;case 190:if(t.sheetStubs)for(var It=Ae.c;It<=Ae.C;++It){var Ot=Ae.ixfe[It-Ae.c];S={ixfe:Ot,XF:P[Ot],t:"z"},F>0&&(S.z=K[S.ixfe>>8&63]),Ac(S,t,r.opts.Date1904),T({c:It,r:Ae.r},S,t)}break;case 214:case 516:case 4:S=cm(Ae.val,Ae.ixfe,"s"),S.XF=P[S.ixfe],F>0&&(S.z=K[S.ixfe>>8&63]),Ac(S,t,r.opts.Date1904),T({c:Ae.c,r:Ae.r},S,t);break;case 0:case 512:je===1&&(o=Ae);break;case 252:u=Ae;break;case 1054:if(D.biff==4){K[F++]=Ae[1];for(var sr=0;sr<F+163&&Rr[sr]!=Ae[1];++sr);sr>=163&&au(Ae[1],F+163)}else au(Ae[1],Ae[0]);break;case 30:{K[F++]=Ae;for(var er=0;er<F+163&&Rr[er]!=Ae;++er);er>=163&&au(Ae,F+163)}break;case 229:ne=ne.concat(Ae);break;case 93:H[Ae.cmo[0]]=D.lastobj=Ae;break;case 438:D.lastobj.TxO=Ae;break;case 127:D.lastobj.ImData=Ae;break;case 440:for(B=Ae[0].s.r;B<=Ae[0].e.r;++B)for(v=Ae[0].s.c;v<=Ae[0].e.c;++v)m=t.dense?(s[B]||[])[v]:s[Kr({c:v,r:B})],m&&(m.l=Ae[1]);break;case 2048:for(B=Ae[0].s.r;B<=Ae[0].e.r;++B)for(v=Ae[0].s.c;v<=Ae[0].e.c;++v)m=t.dense?(s[B]||[])[v]:s[Kr({c:v,r:B})],m&&m.l&&(m.l.Tooltip=Ae[1]);break;case 28:{if(D.biff<=5&&D.biff>=2)break;m=t.dense?(s[Ae[0].r]||[])[Ae[0].c]:s[Kr(Ae[0])];var cr=H[Ae[2]];m||(t.dense?(s[Ae[0].r]||(s[Ae[0].r]=[]),m=s[Ae[0].r][Ae[0].c]={t:"z"}):m=s[Kr(Ae[0])]={t:"z"},o.e.r=Math.max(o.e.r,Ae[0].r),o.s.r=Math.min(o.s.r,Ae[0].r),o.e.c=Math.max(o.e.c,Ae[0].c),o.s.c=Math.min(o.s.c,Ae[0].c)),m.c||(m.c=[]),w={a:Ae[1],t:cr.TxO.t},m.c.push(w)}break;case 2173:xO(P[Ae.ixfe],Ae.ext);break;case 125:{if(!D.cellStyles)break;for(;Ae.e>=Ae.s;)ee[Ae.e--]={width:Ae.w/256,level:Ae.level||0,hidden:!!(Ae.flags&1)},pe||(pe=!0,e_(Ae.w/256)),l0(ee[Ae.e+1])}break;case 520:{var Vt={};Ae.level!=null&&(le[Ae.r]=Vt,Vt.level=Ae.level),Ae.hidden&&(le[Ae.r]=Vt,Vt.hidden=!0),Ae.hpt&&(le[Ae.r]=Vt,Vt.hpt=Ae.hpt,Vt.hpx=Lf(Ae.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||z0(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[de]]=Ae;break;case 161:s["!margins"]||z0(s["!margins"]={}),s["!margins"].header=Ae.header,s["!margins"].footer=Ae.footer;break;case 574:Ae.RTL&&(Q.Views[0].RTL=!0);break;case 146:R=Ae;break;case 2198:G=Ae;break;case 140:L=Ae;break;case 442:f?V.CodeName=Ae||V.name:Q.WBProps.CodeName=Ae||"ThisWorkbook";break}}else we||console.error("Missing Info for XLS Record 0x"+de.toString(16)),e.l+=ue}return r.SheetNames=un(n).sort(function(mt,Nt){return Number(mt)-Number(Nt)}).map(function(mt){return n[mt].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&h["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=h)):r.Preamble=h,r.Sheets&&I.forEach(function(mt,Nt){r.Sheets[r.SheetNames[Nt]]["!autofilter"]=mt}),r.Strings=u,r.SSF=Ts(Rr),D.enc&&(r.Encryption=D.enc),G&&(r.Themes=G),r.Metadata={},L!==void 0&&(r.Metadata.Country=L),te.names.length>0&&(Q.Names=te.names),r.Workbook=Q,r}var op={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function LP(e,t,r){var a=Tr.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var s=_4(a,vw,op.DSI);for(var n in s)t[n]=s[n]}catch(f){if(r.WTF)throw f}var o=Tr.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var c=_4(o,ww,op.SI);for(var u in c)t[u]==null&&(t[u]=c[u])}catch(f){if(r.WTF)throw f}t.HeadingPairs&&t.TitlesOfParts&&(gN(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function jP(e,t){var r=[],a=[],s=[],n=0,o,c=Jk(vw,"n"),u=Jk(ww,"n");if(e.Props)for(o=un(e.Props),n=0;n<o.length;++n)(Object.prototype.hasOwnProperty.call(c,o[n])?r:Object.prototype.hasOwnProperty.call(u,o[n])?a:s).push([o[n],e.Props[o[n]]]);if(e.Custprops)for(o=un(e.Custprops),n=0;n<o.length;++n)Object.prototype.hasOwnProperty.call(e.Props||{},o[n])||(Object.prototype.hasOwnProperty.call(c,o[n])?r:Object.prototype.hasOwnProperty.call(u,o[n])?a:s).push([o[n],e.Custprops[o[n]]]);var f=[];for(n=0;n<s.length;++n)yN.indexOf(s[n][0])>-1||pN.indexOf(s[n][0])>-1||s[n][1]!=null&&f.push(s[n]);a.length&&Tr.utils.cfb_add(t,"/SummaryInformation",y4(a,op.SI,u,ww)),(r.length||f.length)&&Tr.utils.cfb_add(t,"/DocumentSummaryInformation",y4(r,op.DSI,c,vw,f.length?f:null,op.UDI))}function xE(e,t){t||(t={}),A_(t),F2(),t.codepage&&E2(t.codepage);var r,a;if(e.FullPaths){if(Tr.find(e,"/encryption"))throw new Error("File is password-protected");r=Tr.find(e,"!CompObj"),a=Tr.find(e,"/Workbook")||Tr.find(e,"/Book")}else{switch(t.type){case"base64":e=wo(Co(e));break;case"binary":e=wo(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Ii(e,0),a={content:e}}var s,n;if(r&&NP(r),t.bookProps&&!t.bookSheets)s={};else{var o=la?"buffer":"array";if(a&&a.content)s=TP(a.content,t);else if((n=Tr.find(e,"PerfectOffice_MAIN"))&&n.content)s=K0.to_workbook(n.content,(t.type=o,t));else if((n=Tr.find(e,"NativeContent_MAIN"))&&n.content)s=K0.to_workbook(n.content,(t.type=o,t));else throw(n=Tr.find(e,"MN0"))&&n.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Tr.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=VO(e))}var c={};return e.FullPaths&&LP(e,c,t),s.Props=s.Custprops=c,t.bookFiles&&(s.cfb=e),s}function UP(e,t){var r=t||{},a=Tr.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Tr.utils.cfb_add(a,s,bE(e,r)),r.biff==8&&(e.Props||e.Custprops)&&jP(e,a),r.biff==8&&e.vbaraw&&GO(a,Tr.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var Ip={0:{f:s9},1:{f:d9},2:{f:T9},3:{f:v9},4:{f:g9},5:{f:N9},6:{f:I9},7:{f:k9},8:{f:q9},9:{f:P9},10:{f:M9},11:{f:H9},12:{f:h9},13:{f:j9},14:{f:_9},15:{f:x9},16:{f:cE},17:{f:O9},18:{f:C9},19:{f:K2},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:OH},40:{},42:{},43:{f:IQ},44:{f:UQ},45:{f:RQ},46:{f:HQ},47:{f:MQ},48:{},49:{f:l7},50:{},51:{f:wO},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:UN},62:{f:D9},63:{f:FO},64:{f:nH},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ol,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:tH},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:c9},148:{f:l9,p:16},151:{f:$9},152:{},153:{f:DH},154:{},155:{},156:{f:jH},157:{},158:{},159:{T:1,f:YI},160:{T:-1},161:{T:1,f:od},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:K9},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:bO},336:{T:-1},337:{f:kO,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:bw},357:{},358:{},359:{},360:{T:1},361:{},362:{f:jN},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:X9},427:{f:Y9},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Z9},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:A9},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:G9},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:bw},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:HO},633:{T:1},634:{T:-1},635:{T:1,f:RO},636:{T:-1},637:{f:u7},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:_H},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:iH},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Sw={6:{f:sv},10:{f:Ou},12:{f:qn},13:{f:qn},14:{f:vn},15:{f:vn},16:{f:il},17:{f:vn},18:{f:vn},19:{f:qn},20:{f:E4},21:{f:E4},23:{f:jN},24:{f:T4},25:{f:vn},26:{},27:{},28:{f:iI},29:{},34:{f:vn},35:{f:F4},38:{f:il},39:{f:il},40:{f:il},41:{f:il},42:{f:vn},43:{f:vn},47:{f:xQ},49:{f:jD},51:{f:qn},60:{},61:{f:ND},64:{f:vn},65:{f:LD},66:{f:qn},77:{},80:{},81:{},82:{},85:{f:qn},89:{},90:{},91:{},92:{f:mD},93:{f:AI},94:{},95:{f:vn},96:{},97:{},99:{f:vn},125:{f:UN},128:{f:WD},129:{f:bD},130:{f:qn},131:{f:vn},132:{f:vn},133:{f:vD},134:{},140:{f:mI},141:{f:qn},144:{},146:{f:vI},151:{},152:{},153:{},154:{},155:{},156:{f:qn},157:{},158:{},160:{f:SI},161:{f:yI},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:KD},190:{f:zD},193:{f:Ou},197:{},198:{},199:{},200:{},201:{},202:{f:vn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:qn},220:{},221:{f:vn},222:{},224:{f:GD},225:{f:gD},226:{f:Ou},227:{},229:{f:lI},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:_D},253:{f:DD},255:{f:kD},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:kN},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:vn},353:{f:Ou},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:ZD},431:{f:vn},432:{},433:{},434:{},437:{},438:{f:dI},439:{f:vn},440:{f:fI},441:{},442:{f:Xp},443:{},444:{f:qn},445:{},446:{},448:{f:Ou},449:{f:SD,r:2},450:{f:Ou},512:{f:C4},513:{f:CI},515:{f:YD},516:{f:QD},517:{f:N4},519:{f:NI},520:{f:BD},523:{},545:{f:L4},549:{f:B4},566:{},574:{f:FD},638:{f:qD},659:{},1048:{},1054:{f:RD},1084:{},1212:{f:aI},2048:{f:pI},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:lm},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ou},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:wI,r:12},2173:{f:mO,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:vn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:rI,r:12},2197:{},2198:{f:uO,r:12},2199:{},2200:{},2201:{},2202:{f:sI,r:12},2203:{f:Ou},2204:{},2205:{},2206:{},2207:{},2211:{f:CD},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:qn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:kI},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:bI},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:C4},1:{},2:{f:jI},3:{f:TI},4:{f:FI},5:{f:N4},7:{f:DI},8:{},9:{f:lm},11:{},22:{f:qn},30:{f:HD},31:{},32:{},33:{f:L4},36:{},37:{f:B4},50:{f:II},62:{},52:{},67:{},68:{f:qn},69:{},86:{},126:{},127:{f:EI},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:QI},223:{},234:{},354:{},421:{},518:{f:sv},521:{f:lm},536:{f:T4},547:{f:F4},561:{},579:{},1030:{f:sv},1033:{f:lm},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Pt(e,t,r,a){var s=t;if(!isNaN(s)){var n=a||(r||[]).length||0,o=e.next(4);o.write_shift(2,s),o.write_shift(2,n),n>0&&H2(r)&&e.push(r)}}function DP(e,t,r,a){var s=(r||[]).length||0;if(s<=8224)return Pt(e,t,r,s);var n=t;if(!isNaN(n)){for(var o=r.parts||[],c=0,u=0,f=0;f+(o[c]||8224)<=8224;)f+=o[c]||8224,c++;var h=e.next(4);for(h.write_shift(2,n),h.write_shift(2,f),e.push(r.slice(u,u+f)),u+=f;u<s;){for(h=e.next(4),h.write_shift(2,60),f=0;f+(o[c]||8224)<=8224;)f+=o[c]||8224,c++;h.write_shift(2,f),e.push(r.slice(u,u+f)),u+=f}}}function eg(e,t,r){return e||(e=At(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function IP(e,t,r,a){var s=At(9);return eg(s,e,t),BN(r,a||"b",s),s}function QP(e,t,r){var a=At(8+2*r.length);return eg(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function OP(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?ui(Fs(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?Pt(e,2,UI(r,a,s)):Pt(e,3,LI(r,a,s));return;case"b":case"e":Pt(e,5,IP(r,a,t.v,t.t));return;case"s":case"str":Pt(e,4,QP(r,a,(t.v||"").slice(0,255)));return}Pt(e,1,eg(null,r,a))}function RP(e,t,r,a){var s=Array.isArray(t),n=Ta(t["!ref"]||"A1"),o,c="",u=[];if(n.e.c>255||n.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");n.e.c=Math.min(n.e.c,255),n.e.r=Math.min(n.e.c,16383),o=aa(n)}for(var f=n.s.r;f<=n.e.r;++f){c=En(f);for(var h=n.s.c;h<=n.e.c;++h){f===n.s.r&&(u[h]=$s(h)),o=u[h]+c;var g=s?(t[f]||[])[h]:t[o];g&&OP(e,g,f,h)}}}function MP(e,t){for(var r=t||{},a=to(),s=0,n=0;n<e.SheetNames.length;++n)e.SheetNames[n]==r.sheet&&(s=n);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Pt(a,r.biff==4?1033:r.biff==3?521:9,Y2(e,16,r)),RP(a,e.Sheets[e.SheetNames[s]],s,r),Pt(a,10),a.end()}function HP(e,t,r){Pt(e,49,UD({sz:12,name:"Arial"},r))}function PP(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&Pt(e,1054,MD(s,t[s],r))})}function qP(e,t){var r=At(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Pt(e,2151,r),r=At(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),FN(Ta(t["!ref"]||"A1"),r),r.write_shift(4,4),Pt(e,2152,r)}function KP(e,t){for(var r=0;r<16;++r)Pt(e,224,S4({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){Pt(e,224,S4(a,0,t))})}function zP(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];Pt(e,440,hI(a)),a[1].Tooltip&&Pt(e,2048,gI(a))}delete t["!links"]}function VP(e,t){if(t){var r=0;t.forEach(function(a,s){++r<=256&&a&&Pt(e,125,_I(ob(s,a),s))})}}function GP(e,t,r,a,s){var n=16+m0(s.cellXfs,t,s);if(t.v==null&&!t.bf){Pt(e,513,ed(r,a,n));return}if(t.bf)Pt(e,6,bM(t,r,a,s,n));else switch(t.t){case"d":case"n":var o=t.t=="d"?ui(Fs(t.v)):t.v;Pt(e,515,JD(r,a,o,n));break;case"b":case"e":Pt(e,517,XD(r,a,t.v,n,s,t.t));break;case"s":case"str":if(s.bookSST){var c=n_(s.Strings,t.v,s.revStrings);Pt(e,253,ID(r,a,c,n))}else Pt(e,516,OD(r,a,(t.v||"").slice(0,255),n,s));break;default:Pt(e,513,ed(r,a,n))}}function WP(e,t,r){var a=to(),s=r.SheetNames[e],n=r.Sheets[s]||{},o=(r||{}).Workbook||{},c=(o.Sheets||[])[e]||{},u=Array.isArray(n),f=t.biff==8,h,g="",x=[],m=Ta(n["!ref"]||"A1"),w=f?65536:16384;if(m.e.c>255||m.e.r>=w){if(t.WTF)throw new Error("Range "+(n["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,w-1)}Pt(a,2057,Y2(r,16,t)),Pt(a,13,Wo(1)),Pt(a,12,Wo(100)),Pt(a,15,bl(!0)),Pt(a,17,bl(!1)),Pt(a,16,J0(.001)),Pt(a,95,bl(!0)),Pt(a,42,bl(!1)),Pt(a,43,bl(!1)),Pt(a,130,Wo(1)),Pt(a,128,$D()),Pt(a,131,bl(!1)),Pt(a,132,bl(!1)),f&&VP(a,n["!cols"]),Pt(a,512,PD(m,t)),f&&(n["!links"]=[]);for(var v=m.s.r;v<=m.e.r;++v){g=En(v);for(var B=m.s.c;B<=m.e.c;++B){v===m.s.r&&(x[B]=$s(B)),h=x[B]+g;var k=u?(n[v]||[])[B]:n[h];k&&(GP(a,k,v,B,t),f&&k.l&&n["!links"].push([h,k.l]))}}var E=c.CodeName||c.name||s;return f&&Pt(a,574,TD((o.Views||[])[0])),f&&(n["!merges"]||[]).length&&Pt(a,229,oI(n["!merges"])),f&&zP(a,n),Pt(a,442,CN(E)),f&&qP(a,n),Pt(a,10),a.end()}function $P(e,t,r){var a=to(),s=(e||{}).Workbook||{},n=s.Sheets||[],o=s.WBProps||{},c=r.biff==8,u=r.biff==5;if(Pt(a,2057,Y2(e,5,r)),r.bookType=="xla"&&Pt(a,135),Pt(a,225,c?Wo(1200):null),Pt(a,193,X7(2)),u&&Pt(a,191),u&&Pt(a,192),Pt(a,226),Pt(a,92,xD("SheetJS",r)),Pt(a,66,Wo(c?1200:1252)),c&&Pt(a,353,Wo(0)),c&&Pt(a,448),Pt(a,317,BI(e.SheetNames.length)),c&&e.vbaraw&&Pt(a,211),c&&e.vbaraw){var f=o.CodeName||"ThisWorkbook";Pt(a,442,CN(f))}Pt(a,156,Wo(17)),Pt(a,25,bl(!1)),Pt(a,18,bl(!1)),Pt(a,19,Wo(0)),c&&Pt(a,431,bl(!1)),c&&Pt(a,444,Wo(0)),Pt(a,61,ED()),Pt(a,64,bl(!1)),Pt(a,141,Wo(0)),Pt(a,34,bl(SH(e)=="true")),Pt(a,14,bl(!0)),c&&Pt(a,439,bl(!1)),Pt(a,218,Wo(0)),HP(a,e,r),PP(a,e.SSF,r),KP(a,r),c&&Pt(a,352,bl(!1));var h=a.end(),g=to();c&&Pt(g,140,xI()),c&&r.Strings&&DP(g,252,yD(r.Strings)),Pt(g,10);var x=g.end(),m=to(),w=0,v=0;for(v=0;v<e.SheetNames.length;++v)w+=(c?12:11)+(c?2:1)*e.SheetNames[v].length;var B=h.length+w+x.length;for(v=0;v<e.SheetNames.length;++v){var k=n[v]||{};Pt(m,133,wD({pos:B,hs:k.Hidden||0,dt:0,name:e.SheetNames[v]},r)),B+=t[v].length}var E=m.end();if(w!=E.length)throw new Error("BS8 "+w+" != "+E.length);var S=[];return h.length&&S.push(h),E.length&&S.push(E),x.length&&S.push(x),yi(S)}function XP(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=Ts(Rr)),e&&e.SSF&&(Of(),tb(e.SSF),r.revssf=ab(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,c_(r),r.cellXfs=[],m0(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)a[a.length]=WP(s,r,e);return a.unshift($P(e,a,r)),yi(a)}function bE(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var s=ro(a["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var n=t||{};switch(n.biff||2){case 8:case 5:return XP(e,t);case 4:case 3:case 2:return MP(e,t)}throw new Error("invalid type "+n.bookType+" for BIFF")}function P4(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var n=e.match(/<\/table/i),o=s.index,c=n&&n.index||e.length,u=UU(e.slice(o,c),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,h=0,g=0,x=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},w=[];for(o=0;o<u.length;++o){var v=u[o].trim(),B=v.slice(0,3).toLowerCase();if(B=="<tr"){if(++f,r.sheetRows&&r.sheetRows<=f){--f;break}h=0;continue}if(!(B!="<td"&&B!="<th")){var k=v.split(/<\/t[dh]>/i);for(c=0;c<k.length;++c){var E=k[c].trim();if(E.match(/<t[dh]/i)){for(var S=E,L=0;S.charAt(0)=="<"&&(L=S.indexOf(">"))>-1;)S=S.slice(L+1);for(var P=0;P<w.length;++P){var R=w[P];R.s.c==h&&R.s.r<f&&f<=R.e.r&&(h=R.e.c+1,P=-1)}var Q=zr(E.slice(0,E.indexOf(">")));x=Q.colspan?+Q.colspan:1,((g=+Q.rowspan)>1||x>1)&&w.push({s:{r:f,c:h},e:{r:f+(g||1)-1,c:h+x-1}});var V=Q.t||Q["data-t"]||"";if(!S.length){h+=x;continue}if(S=q3(S),m.s.r>f&&(m.s.r=f),m.e.r<f&&(m.e.r=f),m.s.c>h&&(m.s.c=h),m.e.c<h&&(m.e.c=h),!S.length){h+=x;continue}var U={t:"s",v:S};r.raw||!S.trim().length||V=="s"||(S==="TRUE"?U={t:"b",v:!0}:S==="FALSE"?U={t:"b",v:!1}:isNaN(EA(S))?isNaN(Ff(S).getDate())||(U={t:"d",v:Fs(S)},r.cellDates||(U={t:"n",v:ui(U.v)}),U.z=r.dateNF||Rr[14]):U={t:"n",v:EA(S)}),r.dense?(a[f]||(a[f]=[]),a[f][h]=U):a[Kr({r:f,c:h})]=U,h+=x}}}}return a["!ref"]=aa(m),w.length&&(a["!merges"]=w),a}function YP(e,t,r,a){for(var s=e["!merges"]||[],n=[],o=t.s.c;o<=t.e.c;++o){for(var c=0,u=0,f=0;f<s.length;++f)if(!(s[f].s.r>r||s[f].s.c>o)&&!(s[f].e.r<r||s[f].e.c<o)){if(s[f].s.r<r||s[f].s.c<o){c=-1;break}c=s[f].e.r-s[f].s.r+1,u=s[f].e.c-s[f].s.c+1;break}if(!(c<0)){var h=Kr({r,c:o}),g=a.dense?(e[r]||[])[o]:e[h],x=g&&g.v!=null&&(g.h||O2(g.w||(lu(g),g.w)||""))||"",m={};c>1&&(m.rowspan=c),u>1&&(m.colspan=u),a.editable?x='<span contenteditable="true">'+x+"</span>":g&&(m["data-t"]=g&&g.t||"z",g.v!=null&&(m["data-v"]=g.v),g.z!=null&&(m["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+g.l.Target+'">'+x+"</a>")),m.id=(a.id||"sjs")+"-"+h,n.push(Mt("td",x,m))}}var w="<tr>";return w+n.join("")+"</tr>"}var JP='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',ZP="</body></html>";function eq(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return g0(P4(r[0],t),t);var a=f_();return r.forEach(function(s,n){h_(a,P4(s,t),"Sheet"+(n+1))}),a}function tq(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function vE(e,t){var r=t||{},a=r.header!=null?r.header:JP,s=r.footer!=null?r.footer:ZP,n=[a],o=ro(e["!ref"]);r.dense=Array.isArray(e),n.push(tq(e,o,r));for(var c=o.s.r;c<=o.e.r;++c)n.push(YP(e,o,c,r));return n.push("</table>"+s),n.join("")}function wE(e,t,r){var a=r||{},s=0,n=0;if(a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var o=typeof a.origin=="string"?Xs(a.origin):a.origin;s=o.r,n=o.c}var c=t.getElementsByTagName("tr"),u=Math.min(a.sheetRows||1e7,c.length),f={s:{r:0,c:0},e:{r:s,c:n}};if(e["!ref"]){var h=ro(e["!ref"]);f.s.r=Math.min(f.s.r,h.s.r),f.s.c=Math.min(f.s.c,h.s.c),f.e.r=Math.max(f.e.r,h.e.r),f.e.c=Math.max(f.e.c,h.e.c),s==-1&&(f.e.r=s=h.e.r+1)}var g=[],x=0,m=e["!rows"]||(e["!rows"]=[]),w=0,v=0,B=0,k=0,E=0,S=0;for(e["!cols"]||(e["!cols"]=[]);w<c.length&&v<u;++w){var L=c[w];if(q4(L)){if(a.display)continue;m[v]={hidden:!0}}var P=L.children;for(B=k=0;B<P.length;++B){var R=P[B];if(!(a.display&&q4(R))){var Q=R.hasAttribute("data-v")?R.getAttribute("data-v"):R.hasAttribute("v")?R.getAttribute("v"):q3(R.innerHTML),V=R.getAttribute("data-z")||R.getAttribute("z");for(x=0;x<g.length;++x){var U=g[x];U.s.c==k+n&&U.s.r<v+s&&v+s<=U.e.r&&(k=U.e.c+1-n,x=-1)}S=+R.getAttribute("colspan")||1,((E=+R.getAttribute("rowspan")||1)>1||S>1)&&g.push({s:{r:v+s,c:k+n},e:{r:v+s+(E||1)-1,c:k+n+(S||1)-1}});var M={t:"s",v:Q},T=R.getAttribute("data-t")||R.getAttribute("t")||"";Q!=null&&(Q.length==0?M.t=T||"z":a.raw||Q.trim().length==0||T=="s"||(Q==="TRUE"?M={t:"b",v:!0}:Q==="FALSE"?M={t:"b",v:!1}:isNaN(EA(Q))?isNaN(Ff(Q).getDate())||(M={t:"d",v:Fs(Q)},a.cellDates||(M={t:"n",v:ui(M.v)}),M.z=a.dateNF||Rr[14]):M={t:"n",v:EA(Q)})),M.z===void 0&&V!=null&&(M.z=V);var D="",G=R.getElementsByTagName("A");if(G&&G.length)for(var ne=0;ne<G.length&&!(G[ne].hasAttribute("href")&&(D=G[ne].getAttribute("href"),D.charAt(0)!="#"));++ne);D&&D.charAt(0)!="#"&&(M.l={Target:D}),a.dense?(e[v+s]||(e[v+s]=[]),e[v+s][k+n]=M):e[Kr({c:k+n,r:v+s})]=M,f.e.c<k+n&&(f.e.c=k+n),k+=S}}++v}return g.length&&(e["!merges"]=(e["!merges"]||[]).concat(g)),f.e.r=Math.max(f.e.r,v-1+s),e["!ref"]=aa(f),v>=u&&(e["!fullref"]=aa((f.e.r=c.length-w+v-1+s,f))),e}function _E(e,t){var r=t||{},a=r.dense?[]:{};return wE(a,e,t)}function rq(e,t){return g0(_E(e,t),t)}function q4(e){var t="",r=aq(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function aq(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function sq(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Fa(t.replace(/<[^>]*>/g,""));return[r]}var K4={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function yE(e,t){var r=t||{},a=R2(e),s=[],n,o,c={name:""},u="",f=0,h,g,x={},m=[],w=r.dense?[]:{},v,B,k={value:""},E="",S=0,L=[],P=-1,R=-1,Q={s:{r:1e6,c:1e7},e:{r:0,c:0}},V=0,U={},M=[],T={},D=0,G=0,ne=[],H=1,ee=1,le=[],pe={Names:[]},te={},Le=["",""],je=[],F={},K="",I=0,q=!1,J=!1,Y=0;for(Fp.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=Fp.exec(a);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"":v[1]==="/"?(Q.e.c>=Q.s.c&&Q.e.r>=Q.s.r?w["!ref"]=aa(Q):w["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=Q.e.r&&(w["!fullref"]=w["!ref"],Q.e.r=r.sheetRows-1,w["!ref"]=aa(Q)),M.length&&(w["!merges"]=M),ne.length&&(w["!rows"]=ne),h.name=h.||h.name,typeof JSON<"u"&&JSON.stringify(h),m.push(h.name),x[h.name]=w,J=!1):v[0].charAt(v[0].length-2)!=="/"&&(h=zr(v[0],!1),P=R=-1,Q.s.r=Q.s.c=1e7,Q.e.r=Q.e.c=0,w=r.dense?[]:{},M=[],ne=[],J=!0);break;case"table-row-group":v[1]==="/"?--V:++V;break;case"table-row":case"":if(v[1]==="/"){P+=H,H=1;break}if(g=zr(v[0],!1),g.?P=g.-1:P==-1&&(P=0),H=+g["number-rows-repeated"]||1,H<10)for(Y=0;Y<H;++Y)V>0&&(ne[P+Y]={level:V});R=-1;break;case"covered-table-cell":v[1]!=="/"&&++R,r.sheetStubs&&(r.dense?(w[P]||(w[P]=[]),w[P][R]={t:"z"}):w[Kr({r:P,c:R})]={t:"z"}),E="",L=[];break;case"table-cell":case"":if(v[0].charAt(v[0].length-2)==="/")++R,k=zr(v[0],!1),ee=parseInt(k["number-columns-repeated"]||"1",10),B={t:"z",v:null},k.formula&&r.cellFormula!=!1&&(B.f=R4(Fa(k.formula))),(k.||k["value-type"])=="string"&&(B.t="s",B.v=Fa(k["string-value"]||""),r.dense?(w[P]||(w[P]=[]),w[P][R]=B):w[Kr({r:P,c:R})]=B),R+=ee-1;else if(v[1]!=="/"){++R,E="",S=0,L=[],ee=1;var de=H?P+H-1:P;if(R>Q.e.c&&(Q.e.c=R),R<Q.s.c&&(Q.s.c=R),P<Q.s.r&&(Q.s.r=P),de>Q.e.r&&(Q.e.r=de),k=zr(v[0],!1),je=[],F={},B={t:k.||k["value-type"],v:null},r.cellFormula)if(k.formula&&(k.formula=Fa(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(D=parseInt(k["number-matrix-rows-spanned"],10)||0,G=parseInt(k["number-matrix-columns-spanned"],10)||0,T={s:{r:P,c:R},e:{r:P+D-1,c:R+G-1}},B.F=aa(T),le.push([T,B.F])),k.formula)B.f=R4(k.formula);else for(Y=0;Y<le.length;++Y)P>=le[Y][0].s.r&&P<=le[Y][0].e.r&&R>=le[Y][0].s.c&&R<=le[Y][0].e.c&&(B.F=le[Y][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(D=parseInt(k["number-rows-spanned"],10)||0,G=parseInt(k["number-columns-spanned"],10)||0,T={s:{r:P,c:R},e:{r:P+D-1,c:R+G-1}},M.push(T)),k["number-columns-repeated"]&&(ee=parseInt(k["number-columns-repeated"],10)),B.t){case"boolean":B.t="b",B.v=Ns(k["boolean-value"]);break;case"float":B.t="n",B.v=parseFloat(k.value);break;case"percentage":B.t="n",B.v=parseFloat(k.value);break;case"currency":B.t="n",B.v=parseFloat(k.value);break;case"date":B.t="d",B.v=Fs(k["date-value"]),r.cellDates||(B.t="n",B.v=ui(B.v)),B.z="m/d/yy";break;case"time":B.t="n",B.v=TU(k["time-value"])/86400,r.cellDates&&(B.t="d",B.v=sb(B.v)),B.z="HH:MM:SS";break;case"number":B.t="n",B.v=parseFloat(k.);break;default:if(B.t==="string"||B.t==="text"||!B.t)B.t="s",k["string-value"]!=null&&(E=Fa(k["string-value"]),L=[]);else throw new Error("Unsupported value type "+B.t)}}else{if(q=!1,B.t==="s"&&(B.v=E||"",L.length&&(B.R=L),q=S==0),te.Target&&(B.l=te),je.length>0&&(B.c=je,je=[]),E&&r.cellText!==!1&&(B.w=E),q&&(B.t="z",delete B.v),(!q||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=P))for(var ue=0;ue<H;++ue){if(ee=parseInt(k["number-columns-repeated"]||"1",10),r.dense)for(w[P+ue]||(w[P+ue]=[]),w[P+ue][R]=ue==0?B:Ts(B);--ee>0;)w[P+ue][R+ee]=Ts(B);else for(w[Kr({r:P+ue,c:R})]=B;--ee>0;)w[Kr({r:P+ue,c:R+ee})]=Ts(B);Q.e.c<=R&&(Q.e.c=R)}ee=parseInt(k["number-columns-repeated"]||"1",10),R+=ee-1,ee=0,B={},E="",L=[]}te={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((n=s.pop())[0]!==v[3])throw"Bad state: "+n}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((n=s.pop())[0]!==v[3])throw"Bad state: "+n;F.t=E,L.length&&(F.R=L),F.a=K,je.push(F)}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);K="",I=0,E="",S=0,L=[];break;case"creator":v[1]==="/"?K=a.slice(I,v.index):I=v.index+v[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((n=s.pop())[0]!==v[3])throw"Bad state: "+n}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);E="",S=0,L=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(U[c.name]=u,(n=s.pop())[0]!==v[3])throw"Bad state: "+n}else v[0].charAt(v[0].length-2)!=="/"&&(u="",c=zr(v[0],!1),s.push([v[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":o=zr(v[0],!1),u+=K4[v[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":o=zr(v[0],!1),u+=K4[v[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":u+=a.slice(f,v.index);break}else f=v.index+v[0].length;break;case"named-range":o=zr(v[0],!1),Le=nv(o["cell-range-address"]);var we={Name:o.name,Ref:Le[0]+"!"+Le[1]};J&&(we.Sheet=m.length),pe.Names.push(we);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(v[1]==="/"&&(!k||!k["string-value"])){var Ie=sq(a.slice(S,v.index));E=(E.length>0?E+`
`:"")+Ie[0]}else zr(v[0],!1),S=v.index+v[0].length;break;case"s":break;case"database-range":if(v[1]==="/")break;try{Le=nv(zr(v[0])["target-range-address"]),x[Le[0]]["!autofilter"]={ref:Le[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(v[1]!=="/"){if(te=zr(v[0],!1),!te.href)break;te.Target=Fa(te.href),delete te.href,te.Target.charAt(0)=="#"&&te.Target.indexOf(".")>-1?(Le=nv(te.Target.slice(1)),te.Target="#"+Le[0]+"!"+Le[1]):te.Target.match(/^\.\.[\\\/]/)&&(te.Target=te.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(v)}}var Ae={Sheets:x,SheetNames:m,Workbook:pe};return r.bookSheets&&delete Ae.Sheets,Ae}function z4(e,t){t=t||{},Vo(e,"META-INF/manifest.xml")&&T7(Pn(e,"META-INF/manifest.xml"),t);var r=_o(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=yE(is(r),t);return Vo(e,"meta.xml")&&(a.Props=fN(Pn(e,"meta.xml"))),a}function V4(e,t){return yE(e,t)}var nq=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Ep({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Fn+t}})(),G4=(function(){var e=function(n){return Ja(n).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(n,o,c){var u=[];u.push('      <table:table table:name="'+Ja(o.SheetNames[c])+`" table:style-name="ta1">
`);var f=0,h=0,g=ro(n["!ref"]||"A1"),x=n["!merges"]||[],m=0,w=Array.isArray(n);if(n["!cols"])for(h=0;h<=g.e.c;++h)u.push("        <table:table-column"+(n["!cols"][h]?' table:style-name="co'+n["!cols"][h].ods+'"':"")+`></table:table-column>
`);var v="",B=n["!rows"]||[];for(f=0;f<g.s.r;++f)v=B[f]?' table:style-name="ro'+B[f].ods+'"':"",u.push("        <table:table-row"+v+`></table:table-row>
`);for(;f<=g.e.r;++f){for(v=B[f]?' table:style-name="ro'+B[f].ods+'"':"",u.push("        <table:table-row"+v+`>
`),h=0;h<g.s.c;++h)u.push(t);for(;h<=g.e.c;++h){var k=!1,E={},S="";for(m=0;m!=x.length;++m)if(!(x[m].s.c>h)&&!(x[m].s.r>f)&&!(x[m].e.c<h)&&!(x[m].e.r<f)){(x[m].s.c!=h||x[m].s.r!=f)&&(k=!0),E["table:number-columns-spanned"]=x[m].e.c-x[m].s.c+1,E["table:number-rows-spanned"]=x[m].e.r-x[m].s.r+1;break}if(k){u.push(r);continue}var L=Kr({r:f,c:h}),P=w?(n[f]||[])[h]:n[L];if(P&&P.f&&(E["table:formula"]=Ja(BM(P.f)),P.F&&P.F.slice(0,L.length)==L)){var R=ro(P.F);E["table:number-matrix-columns-spanned"]=R.e.c-R.s.c+1,E["table:number-matrix-rows-spanned"]=R.e.r-R.s.r+1}if(!P){u.push(t);continue}switch(P.t){case"b":S=P.v?"TRUE":"FALSE",E["office:value-type"]="boolean",E["office:boolean-value"]=P.v?"true":"false";break;case"n":S=P.w||String(P.v||0),E["office:value-type"]="float",E["office:value"]=P.v||0;break;case"s":case"str":S=P.v==null?"":P.v,E["office:value-type"]="string";break;case"d":S=P.w||Fs(P.v).toISOString(),E["office:value-type"]="date",E["office:date-value"]=Fs(P.v).toISOString(),E["table:style-name"]="ce1";break;default:u.push(t);continue}var Q=e(S);if(P.l&&P.l.Target){var V=P.l.Target;V=V.charAt(0)=="#"?"#"+CM(V.slice(1)):V,V.charAt(0)!="#"&&!V.match(/^\w+:/)&&(V="../"+V),Q=Mt("text:a",Q,{"xlink:href":V.replace(/&/g,"&amp;")})}u.push("          "+Mt("table:table-cell",Mt("text:p",Q,{}),E)+`
`)}u.push(`        </table:table-row>
`)}return u.push(`      </table:table>
`),u.join("")},s=function(n,o){n.push(` <office:automatic-styles>
`),n.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),n.push(`   <number:month number:style="long"/>
`),n.push(`   <number:text>/</number:text>
`),n.push(`   <number:day number:style="long"/>
`),n.push(`   <number:text>/</number:text>
`),n.push(`   <number:year/>
`),n.push(`  </number:date-style>
`);var c=0;o.SheetNames.map(function(f){return o.Sheets[f]}).forEach(function(f){if(f&&f["!cols"]){for(var h=0;h<f["!cols"].length;++h)if(f["!cols"][h]){var g=f["!cols"][h];if(g.width==null&&g.wpx==null&&g.wch==null)continue;l0(g),g.ods=c;var x=f["!cols"][h].wpx+"px";n.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),n.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),n.push(`  </style:style>
`),++c}}});var u=0;o.SheetNames.map(function(f){return o.Sheets[f]}).forEach(function(f){if(f&&f["!rows"]){for(var h=0;h<f["!rows"].length;++h)if(f["!rows"][h]){f["!rows"][h].ods=u;var g=f["!rows"][h].hpx+"px";n.push('  <style:style style:name="ro'+u+`" style:family="table-row">
`),n.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+g+`"/>
`),n.push(`  </style:style>
`),++u}}}),n.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),n.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),n.push(`  </style:style>
`),n.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),n.push(` </office:automatic-styles>
`)};return function(o,c){var u=[Fn],f=Ep({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=Ep({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(u.push("<office:document"+f+h+`>
`),u.push(dN().replace(/office:document-meta/g,"office:meta"))):u.push("<office:document-content"+f+`>
`),s(u,o),u.push(`  <office:body>
`),u.push(`    <office:spreadsheet>
`);for(var g=0;g!=o.SheetNames.length;++g)u.push(a(o.Sheets[o.SheetNames[g]],o,g));return u.push(`    </office:spreadsheet>
`),u.push(`  </office:body>
`),c.bookType=="fods"?u.push("</office:document>"):u.push("</office:document-content>"),u.join("")}})();function kE(e,t){if(t.bookType=="fods")return G4(e,t);var r=D2(),a="",s=[],n=[];return a="mimetype",na(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",na(r,a,G4(e,t)),s.push([a,"text/xml"]),n.push([a,"ContentFile"]),a="styles.xml",na(r,a,nq(e,t)),s.push([a,"text/xml"]),n.push([a,"StylesFile"]),a="meta.xml",na(r,a,Fn+dN()),s.push([a,"text/xml"]),n.push([a,"MetadataFile"]),a="manifest.rdf",na(r,a,U7(n)),s.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",na(r,a,L7(s)),r}function td(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Nw(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):is(p0(e))}function iq(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):wo(yc(e))}function lq(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function A0(e){var t=e.reduce(function(s,n){return s+n.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(s){r.set(s,a),a+=s.length}),r}function W4(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function oq(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,s=t+13;s>=t;--s)a=a*256+e[s];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function Aq(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var n=0;s>=1;++n,s/=256)e[t+n]=s&255;e[t+15]|=r>=0?0:128}function Qp(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function Wa(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function cn(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Da(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],s=Qp(e,r),n=s&7;s=Math.floor(s/8);var o=0,c;if(s==0)break;switch(n){case 0:{for(var u=r[0];e[r[0]++]>=128;);c=e.slice(u,r[0])}break;case 5:o=4,c=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,c=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Qp(e,r),c=e.slice(r[0],r[0]+o),r[0]+=o;break;default:throw new Error("PB Type ".concat(n," for Field ").concat(s," at offset ").concat(a))}var f={data:c,type:n};t[s]==null?t[s]=[f]:t[s].push(f)}return t}function Ui(e){var t=[];return e.forEach(function(r,a){r.forEach(function(s){s.data&&(t.push(Wa(a*8+s.type)),s.type==2&&t.push(Wa(s.data.length)),t.push(s.data))})}),A0(t)}function o_(e,t){return e?.map(function(r){return t(r.data)})||[]}function Ko(e){for(var t,r=[],a=[0];a[0]<e.length;){var s=Qp(e,a),n=Da(e.slice(a[0],a[0]+s));a[0]+=s;var o={id:cn(n[1][0].data),messages:[]};n[2].forEach(function(c){var u=Da(c.data),f=cn(u[3][0].data);o.messages.push({meta:u,data:e.slice(a[0],a[0]+f)}),a[0]+=f}),(t=n[3])!=null&&t[0]&&(o.merge=cn(n[3][0].data)>>>0>0),r.push(o)}return r}function Kd(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:Wa(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:Wa(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:Wa(o.data.length)}],a[2].push({data:Ui(o.meta),type:2})});var n=Ui(a);t.push(Wa(n.length)),t.push(n),s.forEach(function(o){return t.push(o)})}),A0(t)}function cq(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=Qp(t,r),s=[];r[0]<t.length;){var n=t[r[0]]&3;if(n==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var c=o-59;o=t[r[0]],c>1&&(o|=t[r[0]+1]<<8),c>2&&(o|=t[r[0]+2]<<16),c>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=c}s.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var u=0,f=0;if(n==1?(f=(t[r[0]]>>2&7)+4,u=(t[r[0]++]&224)<<3,u|=t[r[0]++]):(f=(t[r[0]++]>>2)+1,n==2?(u=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(u=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[A0(s)],u==0)throw new Error("Invalid offset 0");if(u>s[0].length)throw new Error("Invalid offset beyond length");if(f>=u)for(s.push(s[0].slice(-u)),f-=u;f>=s[s.length-1].length;)s.push(s[s.length-1]),f-=s[s.length-1].length;s.push(s[0].slice(-u,-u+f))}}var h=A0(s);if(h.length!=a)throw new Error("Unexpected length: ".concat(h.length," != ").concat(a));return h}function zo(e){for(var t=[],r=0;r<e.length;){var a=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(cq(a,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return A0(t)}function zd(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var n=Wa(a),o=n.length;t.push(n),a<=60?(o++,t.push(new Uint8Array([a-1<<2]))):a<=256?(o+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(o+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(o+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(o+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),o+=a,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,r+=a}return A0(t)}function uq(e,t,r,a){var s=td(e),n=s.getUint32(4,!0),o=(a>1?12:8)+W4(n&(a>1?3470:398))*4,c=-1,u=-1,f=NaN,h=new Date(2001,0,1);n&512&&(c=s.getUint32(o,!0),o+=4),o+=W4(n&(a>1?12288:4096))*4,n&16&&(u=s.getUint32(o,!0),o+=4),n&32&&(f=s.getFloat64(o,!0),o+=8),n&64&&(h.setTime(h.getTime()+s.getFloat64(o,!0)*1e3),o+=8);var g;switch(e[2]){case 0:break;case 2:g={t:"n",v:f};break;case 3:g={t:"s",v:t[u]};break;case 5:g={t:"d",v:h};break;case 6:g={t:"b",v:f>0};break;case 7:g={t:"n",v:f/86400};break;case 8:g={t:"e",v:0};break;case 9:if(c>-1)g={t:"s",v:r[c]};else if(u>-1)g={t:"s",v:t[u]};else if(!isNaN(f))g={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return g}function dq(e,t,r){var a=td(e),s=a.getUint32(8,!0),n=12,o=-1,c=-1,u=NaN,f=NaN,h=new Date(2001,0,1);s&1&&(u=oq(e,n),n+=16),s&2&&(f=a.getFloat64(n,!0),n+=8),s&4&&(h.setTime(h.getTime()+a.getFloat64(n,!0)*1e3),n+=8),s&8&&(c=a.getUint32(n,!0),n+=4),s&16&&(o=a.getUint32(n,!0),n+=4);var g;switch(e[1]){case 0:break;case 2:g={t:"n",v:u};break;case 3:g={t:"s",v:t[c]};break;case 5:g={t:"d",v:h};break;case 6:g={t:"b",v:f>0};break;case 7:g={t:"n",v:f/86400};break;case 8:g={t:"e",v:0};break;case 9:if(o>-1)g={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:g={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return g}function lv(e,t){var r=new Uint8Array(32),a=td(r),s=12,n=0;switch(r[0]=5,e.t){case"n":r[1]=2,Aq(r,s,e.v),n|=1,s+=16;break;case"b":r[1]=6,a.setFloat64(s,e.v?1:0,!0),n|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(s,t.indexOf(e.v),!0),n|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,n,!0),r.slice(0,s)}function ov(e,t){var r=new Uint8Array(32),a=td(r),s=12,n=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(s,e.v,!0),n|=32,s+=8;break;case"b":r[2]=6,a.setFloat64(s,e.v?1:0,!0),n|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(s,t.indexOf(e.v),!0),n|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,n,!0),r.slice(0,s)}function fq(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return uq(e,t,r,e[0]);case 5:return dq(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function rl(e){var t=Da(e);return Qp(t[1][0].data)}function $4(e,t){var r=Da(t.data),a=cn(r[1][0].data),s=r[3],n=[];return(s||[]).forEach(function(o){var c=Da(o.data),u=cn(c[1][0].data)>>>0;switch(a){case 1:n[u]=Nw(c[3][0].data);break;case 8:{var f=e[rl(c[9][0].data)][0],h=Da(f.data),g=e[rl(h[1][0].data)][0],x=cn(g.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var m=Da(g.data);n[u]=m[3].map(function(w){return Nw(w.data)}).join("")}break}}),n}function hq(e,t){var r,a,s,n,o,c,u,f,h,g,x,m,w,v,B=Da(e),k=cn(B[1][0].data)>>>0,E=cn(B[2][0].data)>>>0,S=((a=(r=B[8])==null?void 0:r[0])==null?void 0:a.data)&&cn(B[8][0].data)>0||!1,L,P;if((n=(s=B[7])==null?void 0:s[0])!=null&&n.data&&t!=0)L=(c=(o=B[7])==null?void 0:o[0])==null?void 0:c.data,P=(f=(u=B[6])==null?void 0:u[0])==null?void 0:f.data;else if((g=(h=B[4])==null?void 0:h[0])!=null&&g.data&&t!=1)L=(m=(x=B[4])==null?void 0:x[0])==null?void 0:m.data,P=(v=(w=B[3])==null?void 0:w[0])==null?void 0:v.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var R=S?4:1,Q=td(L),V=[],U=0;U<L.length/2;++U){var M=Q.getUint16(U*2,!0);M<65535&&V.push([U,M])}if(V.length!=E)throw"Expected ".concat(E," cells, found ").concat(V.length);var T=[];for(U=0;U<V.length-1;++U)T[V[U][0]]=P.subarray(V[U][1]*R,V[U+1][1]*R);return V.length>=1&&(T[V[V.length-1][0]]=P.subarray(V[V.length-1][1]*R)),{R:k,cells:T}}function pq(e,t){var r,a=Da(t.data),s=(r=a?.[7])!=null&&r[0]?cn(a[7][0].data)>>>0>0?1:0:-1,n=o_(a[5],function(o){return hq(o,s)});return{nrows:cn(a[4][0].data)>>>0,data:n.reduce(function(o,c){return o[c.R]||(o[c.R]=[]),c.cells.forEach(function(u,f){if(o[c.R][f])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(f));o[c.R][f]=u}),o},[])}}function gq(e,t,r){var a,s=Da(t.data),n={s:{r:0,c:0},e:{r:0,c:0}};if(n.e.r=(cn(s[6][0].data)>>>0)-1,n.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(n.e.c=(cn(s[7][0].data)>>>0)-1,n.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=aa(n);var o=Da(s[4][0].data),c=$4(e,e[rl(o[4][0].data)][0]),u=(a=o[17])!=null&&a[0]?$4(e,e[rl(o[17][0].data)][0]):[],f=Da(o[3][0].data),h=0;f[1].forEach(function(g){var x=Da(g.data),m=e[rl(x[2][0].data)][0],w=cn(m.meta[1][0].data);if(w!=6002)throw new Error("6001 unexpected reference to ".concat(w));var v=pq(e,m);v.data.forEach(function(B,k){B.forEach(function(E,S){var L=Kr({r:h+k,c:S}),P=fq(E,c,u);P&&(r[L]=P)})}),h+=v.nrows})}function mq(e,t){var r=Da(t.data),a={"!ref":"A1"},s=e[rl(r[2][0].data)],n=cn(s[0].meta[1][0].data);if(n!=6001)throw new Error("6000 unexpected reference to ".concat(n));return gq(e,s[0],a),a}function xq(e,t){var r,a=Da(t.data),s={name:(r=a[1])!=null&&r[0]?Nw(a[1][0].data):"",sheets:[]},n=o_(a[2],rl);return n.forEach(function(o){e[o].forEach(function(c){var u=cn(c.meta[1][0].data);u==6e3&&s.sheets.push(mq(e,c))})}),s}function bq(e,t){var r=f_(),a=Da(t.data),s=o_(a[1],rl);if(s.forEach(function(n){e[n].forEach(function(o){var c=cn(o.meta[1][0].data);if(c==2){var u=xq(e,o);u.sheets.forEach(function(f,h){h_(r,f,h==0?u.name:u.name+"_"+h,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Av(e){var t,r,a,s,n={},o=[];if(e.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var f;try{f=zo(u.content)}catch(g){return console.log("?? "+u.content.length+" "+(g.message||g))}var h;try{h=Ko(f)}catch(g){return console.log("## "+(g.message||g))}h.forEach(function(g){n[g.id]=g.messages,o.push(g.id)})}}),!o.length)throw new Error("File has no messages");var c=((s=(a=(r=(t=n?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:s[0].data)&&cn(n[1][0].meta[1][0].data)==1&&n[1][0];if(c||o.forEach(function(u){n[u].forEach(function(f){var h=cn(f.meta[1][0].data)>>>0;if(h==1)if(!c)c=f;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return bq(n,c)}function vq(e,t,r){var a,s,n,o;if(!((a=e[6])!=null&&a[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var c=((o=(n=e[8])==null?void 0:n[0])==null?void 0:o.data)&&cn(e[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var u=0,f=td(e[7][0].data),h=0,g=[],x=td(e[4][0].data),m=0,w=[],v=0;v<t.length;++v){if(t[v]==null){f.setUint16(v*2,65535,!0),x.setUint16(v*2,65535);continue}f.setUint16(v*2,h,!0),x.setUint16(v*2,m,!0);var B,k;switch(typeof t[v]){case"string":B=lv({t:"s",v:t[v]},r),k=ov({t:"s",v:t[v]},r);break;case"number":B=lv({t:"n",v:t[v]},r),k=ov({t:"n",v:t[v]},r);break;case"boolean":B=lv({t:"b",v:t[v]},r),k=ov({t:"b",v:t[v]},r);break;default:throw new Error("Unsupported value "+t[v])}g.push(B),h+=B.length,w.push(k),m+=k.length,++u}for(e[2][0].data=Wa(u);v<e[7][0].data.length/2;++v)f.setUint16(v*2,65535,!0),x.setUint16(v*2,65535,!0);return e[6][0].data=A0(g),e[3][0].data=A0(w),u}function wq(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=ro(r["!ref"]);a.s.r=a.s.c=0;var s=!1;a.e.c>9&&(s=!0,a.e.c=9),a.e.r>49&&(s=!0,a.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(aa(a)));var n=Bx(r,{range:a,header:1}),o=["~Sh33tJ5~"];n.forEach(function(K){return K.forEach(function(I){typeof I=="string"&&o.push(I)})});var c={},u=[],f=Tr.read(t.numbers,{type:"base64"});f.FileIndex.map(function(K,I){return[K,f.FullPaths[I]]}).forEach(function(K){var I=K[0],q=K[1];if(I.type==2&&I.name.match(/\.iwa/)){var J=I.content,Y=zo(J),de=Ko(Y);de.forEach(function(ue){u.push(ue.id),c[ue.id]={deps:[],location:q,type:cn(ue.messages[0].meta[1][0].data)}})}}),u.sort(function(K,I){return K-I});var h=u.filter(function(K){return K>1}).map(function(K){return[K,Wa(K)]});f.FileIndex.map(function(K,I){return[K,f.FullPaths[I]]}).forEach(function(K){var I=K[0];if(K[1],!!I.name.match(/\.iwa/)){var q=Ko(zo(I.content));q.forEach(function(J){J.messages.forEach(function(Y){h.forEach(function(de){J.messages.some(function(ue){return cn(ue.meta[1][0].data)!=11006&&lq(ue.data,de[1])})&&c[de[0]].deps.push(J.id)})})})}});for(var g=Tr.find(f,c[1].location),x=Ko(zo(g.content)),m,w=0;w<x.length;++w){var v=x[w];v.id==1&&(m=v)}var B=rl(Da(m.messages[0].data)[1][0].data);for(g=Tr.find(f,c[B].location),x=Ko(zo(g.content)),w=0;w<x.length;++w)v=x[w],v.id==B&&(m=v);for(B=rl(Da(m.messages[0].data)[2][0].data),g=Tr.find(f,c[B].location),x=Ko(zo(g.content)),w=0;w<x.length;++w)v=x[w],v.id==B&&(m=v);for(B=rl(Da(m.messages[0].data)[2][0].data),g=Tr.find(f,c[B].location),x=Ko(zo(g.content)),w=0;w<x.length;++w)v=x[w],v.id==B&&(m=v);var k=Da(m.messages[0].data);{k[6][0].data=Wa(a.e.r+1),k[7][0].data=Wa(a.e.c+1);var E=rl(k[46][0].data),S=Tr.find(f,c[E].location),L=Ko(zo(S.content));{for(var P=0;P<L.length&&L[P].id!=E;++P);if(L[P].id!=E)throw"Bad ColumnRowUIDMapArchive";var R=Da(L[P].messages[0].data);R[1]=[],R[2]=[],R[3]=[];for(var Q=0;Q<=a.e.c;++Q){var V=[];V[1]=V[2]=[{type:0,data:Wa(Q+420690)}],R[1].push({type:2,data:Ui(V)}),R[2].push({type:0,data:Wa(Q)}),R[3].push({type:0,data:Wa(Q)})}R[4]=[],R[5]=[],R[6]=[];for(var U=0;U<=a.e.r;++U)V=[],V[1]=V[2]=[{type:0,data:Wa(U+726270)}],R[4].push({type:2,data:Ui(V)}),R[5].push({type:0,data:Wa(U)}),R[6].push({type:0,data:Wa(U)});L[P].messages[0].data=Ui(R)}S.content=zd(Kd(L)),S.size=S.content.length,delete k[46];var M=Da(k[4][0].data);{M[7][0].data=Wa(a.e.r+1);var T=Da(M[1][0].data),D=rl(T[2][0].data);S=Tr.find(f,c[D].location),L=Ko(zo(S.content));{if(L[0].id!=D)throw"Bad HeaderStorageBucket";var G=Da(L[0].messages[0].data);for(U=0;U<n.length;++U){var ne=Da(G[2][0].data);ne[1][0].data=Wa(U),ne[4][0].data=Wa(n[U].length),G[2][U]={type:G[2][0].type,data:Ui(ne)}}L[0].messages[0].data=Ui(G)}S.content=zd(Kd(L)),S.size=S.content.length;var H=rl(M[2][0].data);S=Tr.find(f,c[H].location),L=Ko(zo(S.content));{if(L[0].id!=H)throw"Bad HeaderStorageBucket";for(G=Da(L[0].messages[0].data),Q=0;Q<=a.e.c;++Q)ne=Da(G[2][0].data),ne[1][0].data=Wa(Q),ne[4][0].data=Wa(a.e.r+1),G[2][Q]={type:G[2][0].type,data:Ui(ne)};L[0].messages[0].data=Ui(G)}S.content=zd(Kd(L)),S.size=S.content.length;var ee=rl(M[4][0].data);(function(){for(var K=Tr.find(f,c[ee].location),I=Ko(zo(K.content)),q,J=0;J<I.length;++J){var Y=I[J];Y.id==ee&&(q=Y)}var de=Da(q.messages[0].data);{de[3]=[];var ue=[];o.forEach(function(Ae,oe){ue[1]=[{type:0,data:Wa(oe)}],ue[2]=[{type:0,data:Wa(1)}],ue[3]=[{type:2,data:iq(Ae)}],de[3].push({type:2,data:Ui(ue)})})}q.messages[0].data=Ui(de);var we=Kd(I),Ie=zd(we);K.content=Ie,K.size=K.content.length})();var le=Da(M[3][0].data);{var pe=le[1][0];delete le[2];var te=Da(pe.data);{var Le=rl(te[2][0].data);(function(){for(var K=Tr.find(f,c[Le].location),I=Ko(zo(K.content)),q,J=0;J<I.length;++J){var Y=I[J];Y.id==Le&&(q=Y)}var de=Da(q.messages[0].data);{delete de[6],delete le[7];var ue=new Uint8Array(de[5][0].data);de[5]=[];for(var we=0,Ie=0;Ie<=a.e.r;++Ie){var Ae=Da(ue);we+=vq(Ae,n[Ie],o),Ae[1][0].data=Wa(Ie),de[5].push({data:Ui(Ae),type:2})}de[1]=[{type:0,data:Wa(a.e.c+1)}],de[2]=[{type:0,data:Wa(a.e.r+1)}],de[3]=[{type:0,data:Wa(we)}],de[4]=[{type:0,data:Wa(a.e.r+1)}]}q.messages[0].data=Ui(de);var oe=Kd(I),He=zd(oe);K.content=He,K.size=K.content.length})()}pe.data=Ui(te)}M[3][0].data=Ui(le)}k[4][0].data=Ui(M)}m.messages[0].data=Ui(k);var je=Kd(x),F=zd(je);return g.content=F,g.size=g.content.length,f}function BE(e){return function(r){for(var a=0;a!=e.length;++a){var s=e[a];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function A_(e){BE([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function c_(e){BE([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function _q(e){return ua.WS.indexOf(e)>-1?"sheet":e==ua.CS?"chart":e==ua.DS?"dialog":e==ua.MS?"macro":e&&e.length?e:"sheet"}function yq(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,_q(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function kq(e,t,r,a,s,n,o,c,u,f,h,g){try{n[a]=sp(_o(e,r,!0),t);var x=Pn(e,t),m;switch(c){case"sheet":m=VH(x,t,s,u,n[a],f,h,g);break;case"chart":if(m=GH(x,t,s,u,n[a],f,h,g),!m||!m["!drawel"])break;var w=Kh(m["!drawel"].Target,t),v=Tp(w),B=jO(_o(e,w,!0),sp(_o(e,v,!0),w)),k=Kh(B,w),E=Tp(k);m=vH(_o(e,k,!0),k,u,sp(_o(e,E,!0),k),f,m);break;case"macro":m=WH(x,t,s,u,n[a],f,h,g);break;case"dialog":m=$H(x,t,s,u,n[a],f,h,g);break;default:throw new Error("Unrecognized sheet type "+c)}o[a]=m;var S=[];n&&n[a]&&un(n[a]).forEach(function(L){var P="";if(n[a][L].Type==ua.CMNT){P=Kh(n[a][L].Target,t);var R=ZH(Pn(e,P,!0),P,u);if(!R||!R.length)return;U4(m,R,!1)}n[a][L].Type==ua.TCMNT&&(P=Kh(n[a][L].Target,t),S=S.concat(DO(Pn(e,P,!0),u)))}),S&&S.length&&U4(m,S,!0,u.people||[])}catch(L){if(u.WTF)throw L}}function Ho(e){return e.charAt(0)=="/"?e.slice(1):e}function Bq(e,t){if(Of(),t=t||{},A_(t),Vo(e,"META-INF/manifest.xml")||Vo(e,"objectdata.xml"))return z4(e,t);if(Vo(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Av<"u"){if(e.FileIndex)return Av(e);var r=Tr.utils.cfb_new();return t4(e).forEach(function(ne){na(r,ne,IU(e,ne))}),Av(r)}throw new Error("Unsupported NUMBERS file")}if(!Vo(e,"[Content_Types].xml"))throw Vo(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Vo(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=t4(e),s=E7(_o(e,"[Content_Types].xml")),n=!1,o,c;if(s.workbooks.length===0&&(c="xl/workbook.xml",Pn(e,c,!0)&&s.workbooks.push(c)),s.workbooks.length===0){if(c="xl/workbook.bin",!Pn(e,c,!0))throw new Error("Could not find workbook");s.workbooks.push(c),n=!0}s.workbooks[0].slice(-3)=="bin"&&(n=!0);var u={},f={};if(!t.bookSheets&&!t.bookProps){if(np=[],s.sst)try{np=JH(Pn(e,Ho(s.sst)),s.sst,t)}catch(ne){if(t.WTF)throw ne}t.cellStyles&&s.themes.length&&(u=YH(_o(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(f=XH(Pn(e,Ho(s.style)),s.style,u,t))}s.links.map(function(ne){try{var H=sp(_o(e,Tp(Ho(ne))),ne);return tP(Pn(e,Ho(ne)),H,ne,t)}catch{}});var h=zH(Pn(e,Ho(s.workbooks[0])),s.workbooks[0],t),g={},x="";s.coreprops.length&&(x=Pn(e,Ho(s.coreprops[0]),!0),x&&(g=fN(x)),s.extprops.length!==0&&(x=Pn(e,Ho(s.extprops[0]),!0),x&&I7(x,g,t)));var m={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(x=_o(e,Ho(s.custprops[0]),!0),x&&(m=O7(x,t)));var w={};if((t.bookSheets||t.bookProps)&&(h.Sheets?o=h.Sheets.map(function(H){return H.name}):g.Worksheets&&g.SheetNames.length>0&&(o=g.SheetNames),t.bookProps&&(w.Props=g,w.Custprops=m),t.bookSheets&&typeof o<"u"&&(w.SheetNames=o),t.bookSheets?w.SheetNames:t.bookProps))return w;o={};var v={};t.bookDeps&&s.calcchain&&(v=eP(Pn(e,Ho(s.calcchain)),s.calcchain));var B=0,k={},E,S;{var L=h.Sheets;g.Worksheets=L.length,g.SheetNames=[];for(var P=0;P!=L.length;++P)g.SheetNames[P]=L[P].name}var R=n?"bin":"xml",Q=s.workbooks[0].lastIndexOf("/"),V=(s.workbooks[0].slice(0,Q+1)+"_rels/"+s.workbooks[0].slice(Q+1)+".rels").replace(/^\//,"");Vo(e,V)||(V="xl/_rels/workbook."+R+".rels");var U=sp(_o(e,V,!0),V.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=rP(Pn(e,Ho(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=QO(Pn(e,Ho(s.people[0])),t)),U&&(U=yq(U,h.Sheets));var M=Pn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(B=0;B!=g.Worksheets;++B){var T="sheet";if(U&&U[B]?(E="xl/"+U[B][1].replace(/[\/]?xl\//,""),Vo(e,E)||(E=U[B][1]),Vo(e,E)||(E=V.replace(/_rels\/.*$/,"")+U[B][1]),T=U[B][2]):(E="xl/worksheets/sheet"+(B+1-M)+"."+R,E=E.replace(/sheet0\./,"sheet.")),S=E.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(B!=t.sheets)continue e;break;case"string":if(g.SheetNames[B].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var D=!1,G=0;G!=t.sheets.length;++G)typeof t.sheets[G]=="number"&&t.sheets[G]==B&&(D=1),typeof t.sheets[G]=="string"&&t.sheets[G].toLowerCase()==g.SheetNames[B].toLowerCase()&&(D=1);if(!D)continue e}}kq(e,E,S,g.SheetNames[B],B,k,o,T,t,h,u,f)}return w={Directory:s,Workbook:h,Props:g,Custprops:m,Deps:v,Sheets:o,SheetNames:g.SheetNames,Strings:np,Styles:f,Themes:u,SSF:Ts(Rr)},t&&t.bookFiles&&(e.files?(w.keys=a,w.files=e.files):(w.keys=[],w.files={},e.FullPaths.forEach(function(ne,H){ne=ne.replace(/^Root Entry[\/]/,""),w.keys.push(ne),w.files[ne]=e.FileIndex[H]}))),t&&t.bookVBA&&(s.vba.length>0?w.vbaraw=Pn(e,Ho(s.vba[0]),!0):s.defaults&&s.defaults.bin===zO&&(w.vbaraw=Pn(e,"xl/vbaProject.bin",!0))),w}function Cq(e,t){var r=t||{},a="Workbook",s=Tr.find(e,a);try{if(a="/!DataSpaces/Version",s=Tr.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(rQ(s.content),a="/!DataSpaces/DataSpaceMap",s=Tr.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var n=sQ(s.content);if(n.length!==1||n[0].comps.length!==1||n[0].comps[0].t!==0||n[0].name!=="StrongEncryptionDataSpace"||n[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Tr.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=nQ(s.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Tr.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);lQ(s.content)}catch{}if(a="/EncryptionInfo",s=Tr.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var c=oQ(s.content);if(a="/EncryptedPackage",s=Tr.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],s.content,r.password||"",r);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function Sq(e,t){return t.bookType=="ods"?kE(e,t):t.bookType=="numbers"?wq(e,t):t.bookType=="xlsb"?Nq(e,t):Eq(e,t)}function Nq(e,t){hf=1024,e&&!e.SSF&&(e.SSF=Ts(Rr)),e&&e.SSF&&(Of(),tb(e.SSF),t.revssf=ab(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ip?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=JN.indexOf(t.bookType)>-1,s=$2();c_(t=t||{});var n=D2(),o="",c=0;if(t.cellXfs=[],m0(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",na(n,o,hN(e.Props,t)),s.coreprops.push(o),Xa(t.rels,2,o,ua.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&u.push(e.SheetNames[f]);e.Props.SheetNames=u}for(e.Props.Worksheets=e.Props.SheetNames.length,na(n,o,mN(e.Props)),s.extprops.push(o),Xa(t.rels,3,o,ua.EXT_PROPS),e.Custprops!==e.Props&&un(e.Custprops||{}).length>0&&(o="docProps/custom.xml",na(n,o,xN(e.Custprops)),s.custprops.push(o),Xa(t.rels,4,o,ua.CUST_PROPS)),c=1;c<=e.SheetNames.length;++c){var h={"!id":{}},g=e.Sheets[e.SheetNames[c-1]],x=(g||{})["!type"]||"sheet";if(o="xl/worksheets/sheet"+c+"."+r,na(n,o,sP(c-1,o,t,e,h)),s.sheets.push(o),Xa(t.wbrels,-1,"worksheets/sheet"+c+"."+r,ua.WS[0]),g){var m=g["!comments"],w=!1,v="";m&&m.length>0&&(v="xl/comments"+c+"."+r,na(n,v,lP(m,v)),s.comments.push(v),Xa(h,-1,"../comments"+c+"."+r,ua.CMNT),w=!0),g["!legacy"]&&w&&na(n,"xl/drawings/vmlDrawing"+c+".vml",XN(c,g["!comments"])),delete g["!comments"],delete g["!legacy"]}h["!id"].rId1&&na(n,Tp(o),wf(h))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,na(n,o,iP(t.Strings,o,t)),s.strs.push(o),Xa(t.wbrels,-1,"sharedStrings."+r,ua.SST)),o="xl/workbook."+r,na(n,o,aP(e,o)),s.workbooks.push(o),Xa(t.rels,1,o,ua.WB),o="xl/theme/theme1.xml",na(n,o,t_(e.Themes,t)),s.themes.push(o),Xa(t.wbrels,-1,"theme/theme1.xml",ua.THEME),o="xl/styles."+r,na(n,o,nP(e,o,t)),s.styles.push(o),Xa(t.wbrels,-1,"styles."+r,ua.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",na(n,o,e.vbaraw),s.vba.push(o),Xa(t.wbrels,-1,"vbaProject.bin",ua.VBA)),o="xl/metadata."+r,na(n,o,oP(o)),s.metadata.push(o),Xa(t.wbrels,-1,"metadata."+r,ua.XLMETA),na(n,"[Content_Types].xml",uN(s,t)),na(n,"_rels/.rels",wf(t.rels)),na(n,"xl/_rels/workbook."+r+".rels",wf(t.wbrels)),delete t.revssf,delete t.ssf,n}function Eq(e,t){hf=1024,e&&!e.SSF&&(e.SSF=Ts(Rr)),e&&e.SSF&&(Of(),tb(e.SSF),t.revssf=ab(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ip?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=JN.indexOf(t.bookType)>-1,s=$2();c_(t=t||{});var n=D2(),o="",c=0;if(t.cellXfs=[],m0(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",na(n,o,hN(e.Props,t)),s.coreprops.push(o),Xa(t.rels,2,o,ua.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&u.push(e.SheetNames[f]);e.Props.SheetNames=u}e.Props.Worksheets=e.Props.SheetNames.length,na(n,o,mN(e.Props)),s.extprops.push(o),Xa(t.rels,3,o,ua.EXT_PROPS),e.Custprops!==e.Props&&un(e.Custprops||{}).length>0&&(o="docProps/custom.xml",na(n,o,xN(e.Custprops)),s.custprops.push(o),Xa(t.rels,4,o,ua.CUST_PROPS));var h=["SheetJ5"];for(t.tcid=0,c=1;c<=e.SheetNames.length;++c){var g={"!id":{}},x=e.Sheets[e.SheetNames[c-1]],m=(x||{})["!type"]||"sheet";if(o="xl/worksheets/sheet"+c+"."+r,na(n,o,AE(c-1,t,e,g)),s.sheets.push(o),Xa(t.wbrels,-1,"worksheets/sheet"+c+"."+r,ua.WS[0]),x){var w=x["!comments"],v=!1,B="";if(w&&w.length>0){var k=!1;w.forEach(function(E){E[1].forEach(function(S){S.T==!0&&(k=!0)})}),k&&(B="xl/threadedComments/threadedComment"+c+"."+r,na(n,B,IO(w,h,t)),s.threadedcomments.push(B),Xa(g,-1,"../threadedComments/threadedComment"+c+"."+r,ua.TCMNT)),B="xl/comments"+c+"."+r,na(n,B,YN(w)),s.comments.push(B),Xa(g,-1,"../comments"+c+"."+r,ua.CMNT),v=!0}x["!legacy"]&&v&&na(n,"xl/drawings/vmlDrawing"+c+".vml",XN(c,x["!comments"])),delete x["!comments"],delete x["!legacy"]}g["!id"].rId1&&na(n,Tp(o),wf(g))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,na(n,o,ON(t.Strings,t)),s.strs.push(o),Xa(t.wbrels,-1,"sharedStrings."+r,ua.SST)),o="xl/workbook."+r,na(n,o,hE(e)),s.workbooks.push(o),Xa(t.rels,1,o,ua.WB),o="xl/theme/theme1.xml",na(n,o,t_(e.Themes,t)),s.themes.push(o),Xa(t.wbrels,-1,"theme/theme1.xml",ua.THEME),o="xl/styles."+r,na(n,o,VN(e,t)),s.styles.push(o),Xa(t.wbrels,-1,"styles."+r,ua.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",na(n,o,e.vbaraw),s.vba.push(o),Xa(t.wbrels,-1,"vbaProject.bin",ua.VBA)),o="xl/metadata."+r,na(n,o,$N()),s.metadata.push(o),Xa(t.wbrels,-1,"metadata."+r,ua.XLMETA),h.length>1&&(o="xl/persons/person.xml",na(n,o,OO(h)),s.people.push(o),Xa(t.wbrels,-1,"persons/person.xml",ua.PEOPLE)),na(n,"[Content_Types].xml",uN(s,t)),na(n,"_rels/.rels",wf(t.rels)),na(n,"xl/_rels/workbook."+r+".rels",wf(t.wbrels)),delete t.revssf,delete t.ssf,n}function u_(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Co(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Fq(e,t){return Tr.find(e,"EncryptedPackage")?Cq(e,t):xE(e,t)}function Tq(e,t){var r,a=e,s=t||{};return s.type||(s.type=la&&Buffer.isBuffer(e)?"buffer":"base64"),r=M3(a,s),Bq(r,s)}function CE(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Cw(e.slice(r),t);default:break e}return Tf.to_workbook(e,t)}function Lq(e,t){var r="",a=u_(e,t);switch(t.type){case"base64":r=Co(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Y0(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=is(r)),t.type="binary",CE(r,t)}function jq(e,t){var r=e;return t.type=="base64"&&(r=Co(r)),r=Bp.utils.decode(1200,r.slice(2),"str"),t.type="binary",CE(r,t)}function Uq(e){return e.match(/[^\x00-\x7F]/)?yc(e):e}function cv(e,t,r,a){return a?(r.type="string",Tf.to_workbook(e,r)):Tf.to_workbook(t,r)}function kx(e,t){F2();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return kx(new Uint8Array(e),(r=Ts(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,s=[0,0,0,0],n=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),yf={},r.dateNF&&(yf.dateNF=r.dateNF),r.type||(r.type=la&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=la?"buffer":"binary",a=NU(e),typeof Uint8Array<"u"&&!la&&(r.type="array")),r.type=="string"&&(n=!0,r.type="binary",r.codepage=65001,a=Uq(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),c=new Uint8Array(o);if(c.foo="bar",!c.foo)return r=Ts(r),r.type="array",kx(T2(a),r)}switch((s=u_(a,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return Fq(Tr.read(a,r),r);break;case 9:if(s[1]<=8)return xE(a,r);break;case 60:return Cw(a,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return RI(a,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return IN.to_workbook(a,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?Tq(a,r):cv(e,a,r,n);case 239:return s[3]===60?Cw(a,r):cv(e,a,r,n);case 255:if(s[1]===254)return jq(a,r);if(s[1]===0&&s[2]===2&&s[3]===0)return K0.to_workbook(a,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return K0.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return Bw.to_workbook(a,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return qN.to_workbook(a,r);break;case 10:case 13:case 32:return Lq(a,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return OI.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?Bw.to_workbook(a,r):cv(e,a,r,n)}function SE(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Gp(t.file,Tr.write(e,{type:la?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Tr.write(e,t)}function Dq(e,t){var r=Ts(t||{}),a=Sq(e,r);return Iq(a,r)}function Iq(e,t){var r={},a=la?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?Tr.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(eb(s))}return t.password&&typeof encrypt_agile<"u"?SE(encrypt_agile(s,t.password),t):t.type==="file"?Gp(t.file,s):t.type=="string"?is(s):s}function Qq(e,t){var r=t||{},a=UP(e,r);return SE(a,r)}function fc(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return Cp(yc(a));case"binary":return yc(a);case"string":return e;case"file":return Gp(t.file,a,"utf8");case"buffer":return la?Au(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):fc(a,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Oq(e,t){switch(t.type){case"base64":return Cp(e);case"binary":return e;case"string":return e;case"file":return Gp(t.file,e,"binary");case"buffer":return la?Au(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function um(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?Cp(r):t.type=="string"?is(r):r;case"file":return Gp(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function NE(e,t){F2(),FH(e);var r=Ts(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=NE(e,r);return r.type="array",eb(a)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return fc(SP(e,r),r);case"slk":case"sylk":return fc(DN.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return fc(vE(e.Sheets[e.SheetNames[s]],r),r);case"txt":return Oq(EE(e.Sheets[e.SheetNames[s]],r),r);case"csv":return fc(d_(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return fc(IN.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return um(Bw.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return fc(Tf.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return fc(qN.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return fc(QN.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return fc(kE(e,r),r);case"wk1":return um(K0.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return um(K0.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),um(bE(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Qq(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Dq(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Rq(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Mq(e,t,r){var a={};return a.type="file",a.file=t,Rq(a),NE(e,a)}function Hq(e,t,r,a,s,n,o,c){var u=En(r),f=c.defval,h=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),g=!0,x=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:r,enumerable:!1})}catch{x.__rowNum__=r}else x.__rowNum__=r;if(!o||e[r])for(var m=t.s.c;m<=t.e.c;++m){var w=o?e[r][m]:e[a[m]+u];if(w===void 0||w.t===void 0){if(f===void 0)continue;n[m]!=null&&(x[n[m]]=f);continue}var v=w.v;switch(w.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(n[m]!=null){if(v==null)if(w.t=="e"&&v===null)x[n[m]]=null;else if(f!==void 0)x[n[m]]=f;else if(h&&v===null)x[n[m]]=null;else continue;else x[n[m]]=h&&(w.t!=="n"||w.t==="n"&&c.rawNumbers!==!1)?v:lu(w,v,c);v!=null&&(g=!1)}}return{row:x,isempty:g}}function Bx(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,s=1,n=[],o=0,c="",u={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},h=f.range!=null?f.range:e["!ref"];switch(f.header===1?a=1:f.header==="A"?a=2:Array.isArray(f.header)?a=3:f.header==null&&(a=0),typeof h){case"string":u=Ta(h);break;case"number":u=Ta(e["!ref"]),u.s.r=h;break;default:u=h}a>0&&(s=0);var g=En(u.s.r),x=[],m=[],w=0,v=0,B=Array.isArray(e),k=u.s.r,E=0,S={};B&&!e[k]&&(e[k]=[]);var L=f.skipHidden&&e["!cols"]||[],P=f.skipHidden&&e["!rows"]||[];for(E=u.s.c;E<=u.e.c;++E)if(!(L[E]||{}).hidden)switch(x[E]=$s(E),r=B?e[k][E]:e[x[E]+g],a){case 1:n[E]=E-u.s.c;break;case 2:n[E]=x[E];break;case 3:n[E]=f.header[E-u.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),c=o=lu(r,null,f),v=S[o]||0,!v)S[o]=1;else{do c=o+"_"+v++;while(S[c]);S[o]=v,S[c]=1}n[E]=c}for(k=u.s.r+s;k<=u.e.r;++k)if(!(P[k]||{}).hidden){var R=Hq(e,u,k,x,a,n,B,f);(R.isempty===!1||(a===1?f.blankrows!==!1:f.blankrows))&&(m[w++]=R.row)}return m.length=w,m}var X4=/"/g;function Pq(e,t,r,a,s,n,o,c){for(var u=!0,f=[],h="",g=En(r),x=t.s.c;x<=t.e.c;++x)if(a[x]){var m=c.dense?(e[r]||[])[x]:e[a[x]+g];if(m==null)h="";else if(m.v!=null){u=!1,h=""+(c.rawNumbers&&m.t=="n"?m.v:lu(m,null,c));for(var w=0,v=0;w!==h.length;++w)if((v=h.charCodeAt(w))===s||v===n||v===34||c.forceQuotes){h='"'+h.replace(X4,'""')+'"';break}h=="ID"&&(h='"ID"')}else m.f!=null&&!m.F?(u=!1,h="="+m.f,h.indexOf(",")>=0&&(h='"'+h.replace(X4,'""')+'"')):h="";f.push(h)}return c.blankrows===!1&&u?null:f.join(o)}function d_(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var s=Ta(e["!ref"]),n=a.FS!==void 0?a.FS:",",o=n.charCodeAt(0),c=a.RS!==void 0?a.RS:`
`,u=c.charCodeAt(0),f=new RegExp((n=="|"?"\\|":n)+"+$"),h="",g=[];a.dense=Array.isArray(e);for(var x=a.skipHidden&&e["!cols"]||[],m=a.skipHidden&&e["!rows"]||[],w=s.s.c;w<=s.e.c;++w)(x[w]||{}).hidden||(g[w]=$s(w));for(var v=0,B=s.s.r;B<=s.e.r;++B)(m[B]||{}).hidden||(h=Pq(e,s,B,g,o,u,n,a),h!=null&&(a.strip&&(h=h.replace(f,"")),(h||a.blankrows!==!1)&&r.push((v++?c:"")+h)));return delete a.dense,r.join("")}function EE(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=d_(e,t);return r}function qq(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var s=Ta(e["!ref"]),n="",o=[],c,u=[],f=Array.isArray(e);for(c=s.s.c;c<=s.e.c;++c)o[c]=$s(c);for(var h=s.s.r;h<=s.e.r;++h)for(n=En(h),c=s.s.c;c<=s.e.c;++c)if(t=o[c]+n,r=f?(e[h]||[])[c]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}u[u.length]=t+"="+a}return u}function FE(e,t,r){var a=r||{},s=+!a.skipHeader,n=e||{},o=0,c=0;if(n&&a.origin!=null)if(typeof a.origin=="number")o=a.origin;else{var u=typeof a.origin=="string"?Xs(a.origin):a.origin;o=u.r,c=u.c}var f,h={s:{c:0,r:0},e:{c,r:o+t.length-1+s}};if(n["!ref"]){var g=Ta(n["!ref"]);h.e.c=Math.max(h.e.c,g.e.c),h.e.r=Math.max(h.e.r,g.e.r),o==-1&&(o=g.e.r+1,h.e.r=o+t.length-1+s)}else o==-1&&(o=0,h.e.r=t.length-1+s);var x=a.header||[],m=0;t.forEach(function(v,B){un(v).forEach(function(k){(m=x.indexOf(k))==-1&&(x[m=x.length]=k);var E=v[k],S="z",L="",P=Kr({c:c+m,r:o+B+s});f=Op(n,P),E&&typeof E=="object"&&!(E instanceof Date)?n[P]=E:(typeof E=="number"?S="n":typeof E=="boolean"?S="b":typeof E=="string"?S="s":E instanceof Date?(S="d",a.cellDates||(S="n",E=ui(E)),L=a.dateNF||Rr[14]):E===null&&a.nullError&&(S="e",E=0),f?(f.t=S,f.v=E,delete f.w,delete f.R,L&&(f.z=L)):n[P]=f={t:S,v:E},L&&(f.z=L))})}),h.e.c=Math.max(h.e.c,c+x.length-1);var w=En(o);if(s)for(m=0;m<x.length;++m)n[$s(m+c)+w]={t:"s",v:x[m]};return n["!ref"]=aa(h),n}function Kq(e,t){return FE(null,e,t)}function Op(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=Xs(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Op(e,Kr(t)):Op(e,Kr({r:t,c:r||0}))}function zq(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function f_(){return{SheetNames:[],Sheets:{}}}function h_(e,t,r,a){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var n=r.match(/(^.*?)(\d+)$/);s=n&&+n[2]||0;var o=n&&n[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=o+s)!=-1;++s);}if(fE(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Vq(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=zq(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function Gq(e,t){return e.z=t,e}function TE(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Wq(e,t,r){return TE(e,"#"+t,r)}function $q(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Xq(e,t,r,a){for(var s=typeof t!="string"?t:Ta(t),n=typeof t=="string"?t:aa(t),o=s.s.r;o<=s.e.r;++o)for(var c=s.s.c;c<=s.e.c;++c){var u=Op(e,o,c);u.t="n",u.F=n,delete u.v,o==s.s.r&&c==s.s.c&&(u.f=r,a&&(u.D=!0))}return e}var Ap={encode_col:$s,encode_row:En,encode_cell:Kr,encode_range:aa,decode_col:q2,decode_row:P2,split_cell:i7,decode_cell:Xs,decode_range:ro,format_cell:lu,sheet_add_aoa:sN,sheet_add_json:FE,sheet_add_dom:wE,aoa_to_sheet:Rf,json_to_sheet:Kq,table_to_sheet:_E,table_to_book:rq,sheet_to_csv:d_,sheet_to_txt:EE,sheet_to_json:Bx,sheet_to_html:vE,sheet_to_formulae:qq,sheet_to_row_object_array:Bx,sheet_get_cell:Op,book_new:f_,book_append_sheet:h_,book_set_sheet_visibility:Vq,cell_set_number_format:Gq,cell_set_hyperlink:TE,cell_set_internal_link:Wq,cell_add_comment:$q,sheet_set_array_formula:Xq,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Yq=(e,t,r="Sheet1")=>{const a=Ap.json_to_sheet(e),s=Ap.book_new();Ap.book_append_sheet(s,a,r);const n=t.endsWith(".xlsx")?t:`${t}.xlsx`;Mq(s,n)},Bo=({isOpen:e,onClose:t,title:r,children:a,noScroll:s,variant:n="default"})=>(Z.useEffect(()=>{const o=c=>{c.key==="Escape"&&t()};return e&&(document.body.style.overflow="hidden",window.addEventListener("keydown",o)),()=>{document.body.style.overflow="unset",window.removeEventListener("keydown",o)}},[e,t]),e?I0.createPortal(l.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[l.jsx("div",{className:"absolute inset-0 bg-slate-900/60 backdrop-blur-sm animate-in fade-in duration-200",onClick:t}),l.jsxs("div",{className:ni("relative bg-white dark:bg-slate-800 border border-slate-200/80 dark:border-slate-700 shadow-2xl w-full max-h-[90vh] flex flex-col animate-in zoom-in-95 duration-200 z-10 overflow-hidden",n==="dialog"?"max-w-xl rounded-xl":"max-w-4xl rounded-2xl"),children:[l.jsxs("div",{className:ni("flex items-center justify-between border-b border-slate-200 dark:border-slate-700 shrink-0",n==="dialog"?"px-4 py-3 bg-slate-50 dark:bg-slate-900/60":"p-6 bg-gradient-to-r from-slate-50 to-white dark:from-slate-800 dark:to-slate-800/90"),children:[l.jsx("h3",{className:ni("text-slate-900 dark:text-white",n==="dialog"?"text-sm font-semibold":"text-xl font-bold"),children:r}),l.jsx("button",{onClick:t,className:ni("text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500/60",n==="dialog"?"p-1 rounded-md hover:bg-slate-200/70 dark:hover:bg-slate-700":"p-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700"),children:l.jsx(vl,{className:ni(n==="dialog"?"w-4 h-4":"w-5 h-5")})})]}),l.jsx("div",{className:ni("flex-1 min-h-0 flex flex-col",!s&&"overflow-auto p-6"),children:a})]})]}),document.body):null),Jq="modulepreload",Zq=function(e){return"/litebistudio/"+e},Y4={},BA=function(t,r,a){let s=Promise.resolve();if(r&&r.length>0){let u=function(f){return Promise.all(f.map(h=>Promise.resolve(h).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=o?.nonce||o?.getAttribute("nonce");s=u(r.map(f=>{if(f=Zq(f),f in Y4)return;Y4[f]=!0;const h=f.endsWith(".css"),g=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${g}`))return;const x=document.createElement("link");if(x.rel=h?"stylesheet":Jq,h||(x.as="script"),x.crossOrigin="",x.href=f,c&&x.setAttribute("nonce",c),document.head.appendChild(x),h)return new Promise((m,w)=>{x.addEventListener("load",m),x.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${f}`)))})}))}function n(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return s.then(o=>{for(const c of o||[])c.status==="rejected"&&n(c.reason);return t().catch(n)})};function eK(e){return new Worker("/litebistudio/assets/db.worker-BvC8utWs.js",{name:e?.name})}let Bc=null,Cx=0;const a0=UA("DB"),yo=new Map,pf=new BroadcastChannel("litebistudio_db_v1"),Sx=new Set;let Ew=!1,bc=!1,jf=!1;const Nx=sessionStorage.getItem("litebistudio_instance_id")||crypto.randomUUID();sessionStorage.setItem("litebistudio_instance_id",Nx);function tK(e){return e instanceof Error?e.message:String(e)}function rK(e){return typeof e=="object"&&e!==null&&"sql"in e&&typeof e.sql=="string"}pf.onmessage=async e=>{if(e.data&&e.data.type==="PING")bc&&e.data.instanceId!==Nx&&pf.postMessage({type:"MASTER_PONG",instanceId:e.data.instanceId});else if(e.data&&e.data.type==="MASTER_PONG")e.data.instanceId===Nx&&aK();else if(e.data&&e.data.type==="RPC_REQ"&&bc){const{id:t,actionType:r,payload:a}=e.data;try{const s=await kl(r,a);pf.postMessage({type:"RPC_RES",id:t,result:s})}catch(s){pf.postMessage({type:"RPC_RES",id:t,error:tK(s)})}}else if(e.data&&e.data.type==="RPC_RES"&&!bc){const{id:t,result:r,error:a}=e.data;if(yo.has(t)){const{resolve:s,reject:n}=yo.get(t);yo.delete(t),a?n(new Error(a)):s(r)}}};const LE=new AbortController;function p_(e=!1){jf=!0,sessionStorage.setItem("litebistudio_accepted_readonly","true"),Sx.forEach(t=>t(!0,!0)),LE.abort(),e||(window.location.hash="#/")}function aK(){Ew||(Ew=!0,a0.warn("Tab conflict detected! Access restricted to one tab."),sessionStorage.getItem("litebistudio_accepted_readonly")==="true"?p_(!0):Sx.forEach(e=>e(!0,jf)))}function jE(e){return Sx.add(e),Ew&&e(!0,jf),()=>{Sx.delete(e)}}pf.postMessage({type:"PING",instanceId:Nx});let uv=null;function UE(){const e=new eK;return e.onmessage=t=>{const{id:r,result:a,error:s}=t.data;if(yo.has(r)){const n=yo.get(r);yo.delete(r),s?n.reject(new Error(s)):n.resolve(a)}},e.postMessage({id:++Cx,type:"SET_LOG_LEVEL",payload:{level:S2()}}),e}function sK(){return uv||(uv=new Promise(e=>{navigator.locks.request("litebistudio_db_lifecycle",{ifAvailable:!0},async t=>{if(!t){bc=!1,e();try{await navigator.locks.request("litebistudio_db_lifecycle",{signal:LE.signal},async()=>{a0.info("Previous master tab closed. Reloading to take over..."),window.location.reload()})}catch(r){r instanceof DOMException&&r.name==="AbortError"||a0.error("Background lock request failed:",r)}return}if(jf){bc=!1,e();return}bc=!0,Bc=UE(),e(),await new Promise(()=>{})}).catch(t=>{t.name!=="AbortError"&&a0.error("Failed to acquire DB lock:",t),bc=!1,e()})})),uv.then(()=>bc&&Bc?Bc:"SLAVE")}window.addEventListener("beforeunload",()=>{Bc&&Bc.postMessage({type:"CLOSE"})});function kl(e,t){const r=performance.now();window.dispatchEvent(new CustomEvent("db-query-start"));const a=()=>{const o=performance.now()-r;window.dispatchEvent(new CustomEvent("db-query-end",{detail:{duration:o}}))},s=()=>{if(jf){if(e==="EXEC"&&rK(t)){const o=t.sql.toUpperCase().trimStart();if(!o.startsWith("SELECT")&&!o.startsWith("PRAGMA"))return Promise.reject(new Error(`Action ${e} (WRITE) not permitted in Read-Only mode.`))}else if(e!=="INIT"&&e!=="GET_DIAGNOSTICS"&&e!=="GET_DATABASE_HEALTH"&&e!=="GET_STORAGE_STATUS"&&e!=="EXPORT")return Promise.reject(new Error(`Action ${e} not permitted in Read-Only mode.`))}return new Promise((o,c)=>{const u=++Cx,f=setTimeout(()=>{yo.has(u)&&(yo.delete(u),a0.error(`RPC Timeout for action: ${e} (Master tab unresponsive)`),c(new Error("Database Master unresponsive (Timeout after 5s). Please focus the first tab or refresh.")))},5e3);yo.set(u,{actionType:e,resolve:h=>{clearTimeout(f),o(h)},reject:h=>{clearTimeout(f),c(h)}}),pf.postMessage({type:"RPC_REQ",id:u,actionType:e,payload:t})})};let n;return!bc&&jf?n=s():n=sK().then(o=>{if(o==="SLAVE")return s();const c=o;return new Promise((u,f)=>{const h=++Cx;yo.set(h,{actionType:e,resolve:g=>u(g),reject:f}),c.postMessage({id:h,type:e,payload:t})})}),n.finally(a)}function Bi(e=1,t="insert"){a0.debug(`Dispatched db-changed event: type=${t}, count=${e}`),window.dispatchEvent(new CustomEvent("db-changed",{detail:{type:t,count:e}}))}async function nK(){if(!Array.from(yo.values()).some(t=>t.actionType==="EXEC"))return!1;if(!bc||!Bc)return a0.warn("Abort requested without local DB master. Query cancel is only available in the active master tab."),!1;a0.warn("Aborting active SQL execution by restarting DB worker.");for(const[t,r]of Array.from(yo.entries()))yo.delete(t),r.actionType==="EXEC"?r.reject(new Error("Query cancelled by user.")):r.reject(new Error("Operation interrupted by query cancellation."));return Bc.terminate(),Bc=UE(),!0}typeof window<"u"&&window.addEventListener("app-log-level-changed",()=>{Bc&&Bc.postMessage({id:++Cx,type:"SET_LOG_LEVEL",payload:{level:S2()}})});function nA(){return kl("INIT").then(()=>{})}async function Vr(e,t){return await nA(),kl("EXEC",{sql:e,bind:t})}async function iK(){return await nA(),kl("CLEAR")}async function lK(){return await nA(),kl("FACTORY_RESET")}async function oK(e){return await nA(),kl("CLEAR_TABLE",{tableName:e})}async function AK(){return await nA(),kl("EXPORT")}async function cK(e){const t=await kl("IMPORT",e);return t&&t.isValid&&Bi(0,"restore"),t}async function uK(e){return await nA(),kl("LOAD_DEMO",e)}async function dK(){return await nA(),kl("EXPORT_DEMO_DATA")}async function fK(){return await nA(),kl("INIT_SCHEMA")}async function hK(){return await nA(),kl("GET_DIAGNOSTICS")}async function pK(){return await nA(),kl("GET_DATABASE_HEALTH")}async function gK(){return await nA(),kl("GET_STORAGE_STATUS")}function mK(e,t){return kl("GENERIC_BULK_INSERT",{tableName:e,records:t})}const Wu=Object.freeze(Object.defineProperty({__proto__:null,abortActiveQueries:nK,clearDatabase:iK,clearTable:oK,exportDatabase:AK,exportDemoData:dK,factoryResetDatabase:lK,genericBulkInsert:mK,getDatabaseHealth:pK,getDiagnostics:hK,getStorageStatus:gK,importDatabase:cK,initDB:nA,initSchema:fK,loadDemoData:uK,notifyDbChange:Bi,onTabConflict:jE,runQuery:Vr,setReadOnlyMode:p_},Symbol.toStringTag,{value:"Module"}));function xK(e){return{async saveHealthSnapshot(t){const r=t.id||(typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():`health_${Date.now()}_${Math.random().toString(36).slice(2,10)}`);await Vr(`INSERT INTO sys_health_snapshot
                    (id, scope, status, score, checks_run, findings_json, metadata_json)
                 VALUES (?, ?, ?, ?, ?, ?, ?)`,[r,t.scope||"database",t.status,Math.max(0,Math.round(Number(t.score)||0)),Math.max(0,Math.round(Number(t.checksRun)||0)),JSON.stringify(Array.isArray(t.findings)?t.findings:[]),t.metadata?JSON.stringify(t.metadata):null]),Bi()},async pruneHealthSnapshots(t){if(!e.isAdminModeActive())throw new Error(e.getSystemTableWriteBlockedMessage());const r=Math.max(1,Math.floor(Number(t?.olderThanDays??90))),a=Math.max(0,Math.floor(Number(t?.keepLatest??200))),s=`-${r} days`;await Vr(`
                DELETE FROM sys_health_snapshot
                WHERE id NOT IN (
                    SELECT id
                    FROM sys_health_snapshot
                    ORDER BY datetime(created_at) DESC
                    LIMIT ?
                )
                AND datetime(created_at) < datetime('now', ?)
                `,[a,s]);const n=await Vr("SELECT changes() AS count"),o=Number(n[0]?.count||0);return Bi(o,"clear"),o}}}function bK(){return{async getUserWidgets(){return await Vr("SELECT * FROM sys_user_widgets ORDER BY created_at DESC")},async saveUserWidget(e){(await Vr("SELECT id FROM sys_user_widgets WHERE id = ?",[e.id])).length>0?await Vr("UPDATE sys_user_widgets SET name = ?, description = ?, sql_statement_id = ?, sql_query = ?, visualization_config = ?, visual_builder_config = ?, updated_at = CURRENT_TIMESTAMP WHERE id = ?",[e.name,e.description,e.sql_statement_id||null,e.sql_query,JSON.stringify(e.visualization_config),JSON.stringify(e.visual_builder_config),e.id]):await Vr("INSERT INTO sys_user_widgets (id, name, description, sql_statement_id, sql_query, visualization_config, visual_builder_config) VALUES (?, ?, ?, ?, ?, ?, ?)",[e.id,e.name,e.description,e.sql_statement_id||null,e.sql_query,JSON.stringify(e.visualization_config),JSON.stringify(e.visual_builder_config)]),Bi()},async deleteUserWidget(e){await Vr("DELETE FROM sys_user_widgets WHERE id = ?",[e]),Bi()},async getDashboards(){return(await Vr("SELECT * FROM sys_dashboards ORDER BY created_at ASC")).map(t=>({...t,layout:typeof t.layout=="string"?JSON.parse(t.layout):t.layout}))},async saveDashboard(e,t=!1){(await Vr("SELECT id FROM sys_dashboards WHERE id = ?",[e.id])).length>0?await Vr("UPDATE sys_dashboards SET name = ?, layout = ?, is_default = ?, updated_at = CURRENT_TIMESTAMP WHERE id = ?",[e.name,JSON.stringify(e.layout),e.is_default?1:0,e.id]):await Vr("INSERT INTO sys_dashboards (id, name, layout, is_default) VALUES (?, ?, ?, ?)",[e.id,e.name,JSON.stringify(e.layout),e.is_default?1:0]),t||Bi()},async deleteDashboard(e){await Vr("DELETE FROM sys_dashboards WHERE id = ?",[e]),Bi()}}}function vK(){return{async getReportPacks(){return(await Vr("SELECT * FROM sys_report_packs ORDER BY created_at DESC")).map(t=>({...t,category:typeof t.category=="string"&&t.category.trim().length>0?t.category:"General",config:typeof t.config=="string"?JSON.parse(t.config):t.config}))},async saveReportPack(e){(await Vr("SELECT id FROM sys_report_packs WHERE id = ?",[e.id])).length>0?await Vr("UPDATE sys_report_packs SET name = ?, category = ?, description = ?, config = ?, updated_at = CURRENT_TIMESTAMP WHERE id = ?",[e.name,e.category||"General",e.description,JSON.stringify(e.config),e.id]):await Vr("INSERT INTO sys_report_packs (id, name, category, description, config) VALUES (?, ?, ?, ?, ?)",[e.id,e.name,e.category||"General",e.description,JSON.stringify(e.config)]),Bi()},async deleteReportPack(e){await Vr("DELETE FROM sys_report_packs WHERE id = ?",[e]),Bi()}}}function wK(){return{async listSqlStatements(e="global"){return await Vr(`SELECT id, name, sql_text, description, scope, tags, is_favorite, use_count, last_used_at, created_at, updated_at
                 FROM sys_sql_statement
                 WHERE scope = ?
                 ORDER BY is_favorite DESC, COALESCE(last_used_at, updated_at, created_at) DESC, name ASC`,[e])},async saveSqlStatement(e){const t=(e.scope||"global").trim()||"global";(await Vr("SELECT id FROM sys_sql_statement WHERE id = ?",[e.id])).length>0?await Vr(`UPDATE sys_sql_statement
                     SET name = ?, sql_text = ?, description = ?, scope = ?, tags = ?, is_favorite = ?, updated_at = CURRENT_TIMESTAMP
                     WHERE id = ?`,[e.name,e.sql_text,e.description||"",t,e.tags||"",e.is_favorite?1:0,e.id]):await Vr(`INSERT INTO sys_sql_statement (id, name, sql_text, description, scope, tags, is_favorite)
                     VALUES (?, ?, ?, ?, ?, ?, ?)`,[e.id,e.name,e.sql_text,e.description||"",t,e.tags||"",e.is_favorite?1:0]),Bi()},async deleteSqlStatement(e){await Vr("DELETE FROM sys_sql_statement WHERE id = ?",[e]),Bi()},async setSqlStatementFavorite(e,t){await Vr("UPDATE sys_sql_statement SET is_favorite = ?, updated_at = CURRENT_TIMESTAMP WHERE id = ?",[t?1:0,e]),Bi()},async markSqlStatementUsed(e){await Vr(`UPDATE sys_sql_statement
                 SET use_count = COALESCE(use_count, 0) + 1,
                     last_used_at = CURRENT_TIMESTAMP
                 WHERE id = ?`,[e]),Bi()}}}function _K(e){return{async getWorklist(){return await Vr("SELECT * FROM sys_worklist ORDER BY created_at DESC")},async updateWorklistItem(t,r){const a=[],s=[];if(r.status!==void 0&&(a.push("status = ?"),s.push(r.status)),r.comment!==void 0&&(a.push("comment = ?"),s.push(r.comment)),r.priority!==void 0&&(a.push("priority = ?"),s.push(r.priority)),r.due_at!==void 0&&(a.push("due_at = ?"),s.push(r.due_at)),a.length===0)return;a.push("updated_at = CURRENT_TIMESTAMP"),s.push(Number(t));const n=`UPDATE sys_worklist SET ${a.join(", ")} WHERE id = ?`;await Vr(n,s),Bi()},async checkRecordExists(t,r){if(!O0(t))return!1;try{return(await Vr(`SELECT 1 FROM "${t}" WHERE id = ? LIMIT 1`,[r])).length>0}catch{try{const s=(await e.getTableSchema(t)).find(o=>o.pk===1||o.name.toLowerCase()==="id")?.name;return s&&s.toLowerCase()!=="id"?(await Vr(`SELECT 1 FROM "${t}" WHERE "${s}" = ? LIMIT 1`,[r])).length>0:(await Vr(`SELECT 1 FROM "${t}" WHERE rowid = ? LIMIT 1`,[r])).length>0}catch{return!1}}},async getRecordMetadata(t,r){if(!O0(t))return{exists:!1,isInWorklist:!1,worklistItem:null};if(r==null)return{exists:!1,isInWorklist:!1,worklistItem:null};const[a,s]=await Promise.all([Vr(`SELECT 1 FROM "${t}" WHERE id = ? LIMIT 1`,[r]).catch(async()=>{try{const o=(await e.getTableSchema(t)).find(c=>c.pk===1||c.name.toLowerCase()==="id")?.name;return o&&o.toLowerCase()!=="id"?await Vr(`SELECT 1 FROM "${t}" WHERE "${o}" = ? LIMIT 1`,[r]):await Vr(`SELECT 1 FROM "${t}" WHERE rowid = ? LIMIT 1`,[r])}catch{return[]}}),Vr("SELECT * FROM sys_worklist WHERE source_table = ? AND source_id = ?",[t,r]).catch(()=>[])]);return{exists:a.length>0,isInWorklist:s.length>0,worklistItem:s[0]||null}}}}const dv=new Map;function J4(e){return e.filter(t=>t.type.toUpperCase().includes("TEXT")||t.name.toLowerCase().includes("id")||t.name.toLowerCase().includes("name"))}function Z4(e,t){if(!t||!e.length)return{clause:"",params:[]};const r=e.map(s=>`${s.name} LIKE '%' || ? || '%'`).join(" OR "),a=Array(e.length).fill(t);return{clause:r,params:a}}async function eB(e){if(!O0(e))return[];if(dv.has(e))return dv.get(e);const t=await Vr(`PRAGMA table_info("${e}")`);return dv.set(e,t),t}function DE(){return typeof window>"u"?!1:window.localStorage.getItem("litebistudio_admin_mode")==="true"}function IE(){return typeof window>"u"?"Write access to system tables (sys_*) is only allowed in admin mode.":String(window.localStorage.getItem("i18nextLng")||"en").toLowerCase().startsWith("de")?"Schreibzugriffe auf Systemtabellen (sys_*) sind nur im Admin-Modus erlaubt.":"Write access to system tables (sys_*) is only allowed in admin mode."}function yK(e){if(DE())return;const t=e.split(";").map(s=>s.trim()).filter(s=>s.length>0),r=/^(INSERT|UPDATE|DELETE|DROP|ALTER|CREATE|REPLACE)\b/i,a=/\bsys_[a-z0-9_]+\b/i;for(const s of t)if(r.test(s)&&a.test(s))throw new Error(IE())}const jt={async getDatabaseStats(){const e=await this.getTables();let t=0;for(const r of e){const a=await Vr(`SELECT count(*) as count FROM "${r}"`);t+=a[0]?.count||0}return{tables:e.length,records:t}},async getTotalRecordCount(){return(await this.getDatabaseStats()).records},async getDiagnostics(){return await BA(()=>Promise.resolve().then(()=>Wu),void 0).then(e=>e.getDiagnostics())},async getDatabaseHealth(){return await BA(()=>Promise.resolve().then(()=>Wu),void 0).then(e=>e.getDatabaseHealth())},async getStorageStatus(){return await BA(()=>Promise.resolve().then(()=>Wu),void 0).then(e=>e.getStorageStatus())},...xK({isAdminModeActive:DE,getSystemTableWriteBlockedMessage:IE}),async getTables(){return(await Vr("SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%'")).map(t=>typeof t.name=="string"?t.name:"").filter(t=>t.length>0)},async getDataSources(){return(await Vr(`
            SELECT name, type
            FROM sqlite_master
            WHERE type IN ('table', 'view')
              AND name NOT LIKE 'sqlite_%'
            ORDER BY name ASC
        `)).map(t=>{const r=typeof t.name=="string"?t.name:"",a=t.type==="view"?"view":"table";return{name:r,type:a}}).filter(t=>t.name.length>0)},async getDataSourceType(e){if(!O0(e))return"unknown";const r=(await Vr("SELECT type FROM sqlite_master WHERE name = ? AND type IN ('table', 'view') LIMIT 1",[e]))[0]?.type;return r==="table"||r==="view"?r:"unknown"},async getTableSchema(e){return await eB(e)},async getTableIndexes(e){if(!O0(e))return[];const t=e.replace(/"/g,'""'),r=await Vr(`PRAGMA index_list("${t}")`),a=await Vr("SELECT name, sql FROM sqlite_master WHERE type='index' AND LOWER(tbl_name) = LOWER(?) AND name NOT LIKE 'sqlite_%' ORDER BY name",[e]),s=new Map;for(const u of a){const f=typeof u.name=="string"?u.name:"";f&&s.set(f,typeof u.sql=="string"?u.sql:"")}const n=new Set;for(const u of r)typeof u.name=="string"&&u.name&&n.add(u.name);for(const u of a)typeof u.name=="string"&&u.name&&n.add(u.name);const o=Array.from(n);return o.length?(await Promise.all(o.map(async u=>{const f=u.replace(/"/g,'""'),g=(await Vr(`PRAGMA index_info("${f}")`)).sort((k,E)=>Number(k.seqno||0)-Number(E.seqno||0)).map(k=>typeof k.name=="string"?k.name:"").filter(k=>k.length>0),x=r.find(k=>k.name===u),m=s.get(u)||"",w=x?Number(x.unique||0)===1:!1,v=x?Number(x.partial||0)===1:!1,B=x&&typeof x.origin=="string"?x.origin:void 0;return{name:u,unique:w||/\bCREATE\s+UNIQUE\s+INDEX\b/i.test(m),columns:g,origin:B||"c",partial:v||/\bWHERE\b/i.test(m)}}))).sort((u,f)=>u.name.localeCompare(f.name)):[]},async inspectTable(e,t,r,a=0,s){if(!O0(e))throw new Error(`Invalid table name: ${e}`);const o=(s||await this.getDataSourceType(e))==="table";let c=o?`SELECT rowid as _rowid, * FROM "${e}"`:`SELECT * FROM "${e}"`;const u=[];if(r){const f=await this.getTableSchema(e),h=J4(f),{clause:g,params:x}=Z4(h,r);g&&(c+=` WHERE ${g}`,u.push(...x))}return o&&(c+=" ORDER BY rowid DESC"),c+=" LIMIT ? OFFSET ?",u.push(t),u.push(Math.max(0,a)),await Vr(c,u)},async countTableRows(e,t){if(!O0(e))throw new Error(`Invalid table name: ${e}`);let r=`SELECT COUNT(*) as count FROM "${e}"`;const a=[];if(t){const n=await this.getTableSchema(e),o=J4(n),{clause:c,params:u}=Z4(o,t);c&&(r+=` WHERE ${c}`,a.push(...u))}const s=await Vr(r,a);return Number(s[0]?.count||0)},async executeRaw(e,t){yK(e);const r=await Vr(e,t),a=e.trim().toUpperCase();return(a.startsWith("INSERT")||a.startsWith("UPDATE")||a.startsWith("DELETE")||a.startsWith("DROP")||a.startsWith("CREATE")||a.startsWith("ALTER"))&&Bi(),r},async abortActiveQueries(){return await BA(()=>Promise.resolve().then(()=>Wu),void 0).then(e=>e.abortActiveQueries())},async bulkInsert(e,t){const{genericBulkInsert:r}=await BA(async()=>{const{genericBulkInsert:s}=await Promise.resolve().then(()=>Wu);return{genericBulkInsert:s}},void 0),a=await r(e,t);return Bi(a),a},...bK(),...vK(),...wK(),..._K({getTableSchema:eB})};let cp=null,tB=Promise.resolve();function kK(e){const t=tB.then(e,e);return tB=t.then(()=>{},()=>{}),t}function BK(e){return cp=e,()=>{cp===e&&(cp=null)}}function CK(e){if(e.kind==="confirm")return{confirmed:window.confirm(e.message)};if(e.kind==="prompt"){const t=window.prompt(e.message,e.defaultValue||"");return{confirmed:t!==null,value:t??void 0}}return window.alert(e.message),{confirmed:!0}}async function Th(e){return cp?kK(()=>cp(e)):CK(e)}const Qt={async info(e,t){await Th({kind:"info",title:t,message:e})},async warning(e,t){await Th({kind:"warning",title:t,message:e})},async error(e,t){await Th({kind:"error",title:t,message:e})},async confirm(e,t){return(await Th({kind:"confirm",title:t,message:e})).confirmed},async prompt(e,t){const r=await Th({kind:"prompt",title:t?.title,message:e,defaultValue:t?.defaultValue,placeholder:t?.placeholder});return r.confirmed?r.value??"":null}},g_=({isOpen:e,onClose:t})=>{const{t:r}=ds(),{isAdminMode:a}=So(),s=jA(),[n]=Jt("health_snapshot_retention_days",90),[o]=Jt("health_snapshot_keep_latest",200),[c,u]=Z.useState("overview"),[f,h]=Z.useState("health"),[g,x]=Z.useState({}),[m,w]=Z.useState(null),[v,B]=Z.useState(null),[k,E]=Z.useState(null),[S,L]=Z.useState(null),{data:P,loading:R,refresh:Q}=Ai(()=>jt.getDiagnostics(),[e]),{data:V,loading:U,refresh:M}=Ai(async()=>{if(!e)return null;const I=await jt.getDatabaseHealth();return I&&jt.saveHealthSnapshot({scope:"database",status:I.status,score:I.score,checksRun:I.checksRun,findings:I.findings,metadata:{checked_at:I.checkedAt,app_version:"1.2.0",build_date:"28.02.2026, 07:37"}}),I},[e]),T="1.2.0",D="28.02.2026, 07:37",G=navigator;Z.useEffect(()=>{e&&navigator.storage&&navigator.storage.estimate&&navigator.storage.estimate().then(I=>x(I))},[e]),Z.useEffect(()=>{if(!e)return;const I=[];let q=0;const J=(at,Ge,pt,nt,Dt)=>{I.push({severity:at,code:Ge,title:pt,details:nt,recommendation:Dt})};if(q+=1,g.quota&&g.usage!==void 0){const at=g.usage/g.quota,Ge=(at*100).toFixed(2);at>=.9?J("error","storage_quota_critical",r("widgets.system_health.client_storage_quota_critical"),`${Ge}%`):at>=.75?J("warning","storage_quota_high",r("widgets.system_health.client_storage_quota_high"),`${Ge}%`):J("info","storage_quota_ok",r("widgets.system_health.client_storage_quota_ok"),`${Ge}%`)}else J("info","storage_quota_unknown",r("widgets.system_health.client_storage_quota_unknown"),r("widgets.system_health.no_storage_info"));q+=1;const Y=Object.keys(window.localStorage),de=Y.reduce((at,Ge)=>at+(Ge.length+(window.localStorage.getItem(Ge)?.length||0))*2,0),ue=Y.slice(0,8).join(", ");de>4*1024*1024?J("warning","local_storage_large",r("widgets.system_health.client_local_storage_large"),`${(de/1024/1024).toFixed(2)} MB | ${Y.length} keys`,ue?`Keys: ${ue}${Y.length>8?" ...":""}`:void 0):J("info","local_storage_ok",r("widgets.system_health.client_local_storage_ok"),`${Y.length} keys`,ue?`Keys: ${ue}${Y.length>8?" ...":""}`:void 0),q+=1;const we=Object.keys(window.sessionStorage),Ie=we.reduce((at,Ge)=>at+(Ge.length+(window.sessionStorage.getItem(Ge)?.length||0))*2,0),Ae=we.slice(0,8).join(", ");Ie>1024*1024?J("warning","session_storage_large",r("widgets.system_health.client_session_storage_large"),`${(Ie/1024/1024).toFixed(2)} MB | ${we.length} keys`,Ae?`Keys: ${Ae}${we.length>8?" ...":""}`:void 0):J("info","session_storage_ok",r("widgets.system_health.client_session_storage_ok"),`${we.length} keys`,Ae?`Keys: ${Ae}${we.length>8?" ...":""}`:void 0),q+=1,window.localStorage.getItem("notifications_confirm_destructive")==="false"?J("warning","destructive_confirm_off",r("widgets.system_health.client_destructive_confirm_off"),r("widgets.system_health.client_destructive_confirm_off_detail")):J("info","destructive_confirm_on",r("widgets.system_health.client_destructive_confirm_on"),r("widgets.system_health.client_destructive_confirm_on_detail")),q+=1;const oe=(window.localStorage.getItem("app_log_level")||"info").toLowerCase();oe==="debug"?J("warning","log_level_debug",r("widgets.system_health.client_log_level_debug"),r("widgets.system_health.client_log_level_debug_detail")):J("info","log_level_ok",r("widgets.system_health.client_log_level_ok"),`Level: ${oe}`),q+=1;const He=window.localStorage.getItem("litebistudio_last_backup");He?J("info","backup_exists",r("widgets.system_health.client_backup_exists"),new Date(He).toLocaleString()):J("warning","backup_missing",r("widgets.system_health.client_backup_missing"),r("widgets.system_health.client_backup_missing_detail"));const se=I.filter(at=>at.severity==="error").length,qe=I.filter(at=>at.severity==="warning").length,Ye=I.filter(at=>at.severity==="info").length;L({status:se>0?"error":qe>0?"warning":"ok",score:Math.max(0,100-se*25-qe*10-Ye*1),checksRun:q,findings:I})},[e,g,r]);const ne=()=>{Q(),M(),u("database"),h("health")},H=()=>{sessionStorage.setItem("litebistudio_datasource_tab","system"),s("/datasource")},ee=()=>{s("/inspector")},le=async()=>{if(!a){await Qt.warning(r("widgets.system_health.snapshot_cleanup_admin_only"));return}const I=Math.max(1,Math.min(3650,Number(n)||90)),q=Math.max(0,Math.min(1e4,Number(o)||200));if(await Qt.confirm(r("widgets.system_health.snapshot_cleanup_confirm",{days:I,keep:q})))try{const Y=await jt.pruneHealthSnapshots({olderThanDays:I,keepLatest:q});await Qt.info(r("widgets.system_health.snapshot_cleanup_success",{count:Y})),Q(),M()}catch(Y){const de=Y instanceof Error?Y.message:String(Y);await Qt.error(`${r("widgets.system_health.snapshot_cleanup_failed")} ${de}`)}},pe=I=>{if(!I)return"0 B";const q=1024,J=["B","KB","MB","GB","TB"],Y=Math.floor(Math.log(I)/Math.log(q));return parseFloat((I/Math.pow(q,Y)).toFixed(2))+" "+J[Y]},te=I=>I.replace(/"/g,'""'),Le=I=>{const q=I.details||"";return I.code==="query_plan_full_scan_risk"?Array.from(q.matchAll(/([a-zA-Z0-9_]+)\s+\(column:\s*([a-zA-Z0-9_]+)\)/g)).map(Y=>({table:Y[1],column:Y[2]})):I.code==="large_unindexed_tables"?Array.from(q.matchAll(/([a-zA-Z0-9_]+)\s+\(\d+\s+rows\)/g)).map(Y=>({table:Y[1]})):[]},je=async I=>{if(I.code==="orphan_widget_sql_references")return[`
                UPDATE sys_user_widgets
                SET sql_statement_id = NULL
                WHERE COALESCE(TRIM(sql_statement_id), '') <> ''
                  AND sql_statement_id NOT IN (SELECT id FROM sys_sql_statement)
                `.trim()];if(I.code==="worklist_enum_inconsistencies")return[`
                UPDATE sys_worklist
                SET status = 'open'
                WHERE COALESCE(TRIM(status), '') NOT IN ('open', 'in_progress', 'done', 'closed')
                `.trim(),`
                UPDATE sys_worklist
                SET priority = 'normal'
                WHERE COALESCE(TRIM(priority), '') NOT IN ('low', 'normal', 'high', 'critical')
                `.trim()];const q=Le(I),J=[];for(const Y of q){const de=Y.table,ue=await jt.getTableSchema(de);if(!ue.length)continue;const we=Y.column&&ue.some(Ae=>Ae.name===Y.column)?Y.column:ue.find(Ae=>Number(Ae.pk||0)>0)?.name||ue[0]?.name;if(!we)continue;const Ie=`idx_auto_${de}_${we}`.slice(0,60);J.push(`CREATE INDEX IF NOT EXISTS "${te(Ie)}" ON "${te(de)}"("${te(we)}")`)}return J},F=I=>I.code==="query_plan_full_scan_risk"||I.code==="large_unindexed_tables"||I.code==="orphan_widget_sql_references"||I.code==="worklist_enum_inconsistencies",K=async(I,q)=>{try{E(q);const J=await je(I);if(!J.length){await Qt.warning(r("widgets.system_health.quick_fix_none"));return}const Y=J.slice(0,5).join(`;
`);if(!await Qt.confirm(`${r("widgets.system_health.quick_fix_confirm")}

${Y}${J.length>5?`
...`:""}`))return;for(const ue of J)await jt.executeRaw(ue);await Qt.info(r("widgets.system_health.quick_fix_success",{count:J.length})),Q(),M()}catch(J){const Y=J instanceof Error?J.message:String(J);await Qt.error(`${r("widgets.system_health.quick_fix_failed")} ${Y}`)}finally{E(null)}};return l.jsx(Bo,{isOpen:e,onClose:t,title:r("widgets.system_health.title"),children:l.jsxs("div",{className:"h-[70vh] min-h-[520px] max-h-[760px] flex flex-col",children:[l.jsxs("div",{className:"flex border-b border-slate-200 dark:border-slate-700 mb-6 sticky top-0 bg-white dark:bg-slate-800 z-10 -mx-6 px-6 pt-2",children:[l.jsxs("button",{onClick:()=>u("overview"),className:`pb-3 px-4 text-sm font-medium transition-colors relative ${c==="overview"?"text-blue-600 dark:text-blue-400":"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"}`,children:[r("widgets.system_health.tab_overview"),c==="overview"&&l.jsx("div",{className:"absolute bottom-0 left-0 w-full h-0.5 bg-blue-600 dark:bg-blue-400 rounded-t-full"})]}),l.jsxs("button",{onClick:()=>u("storage"),className:`pb-3 px-4 text-sm font-medium transition-colors relative ${c==="storage"?"text-blue-600 dark:text-blue-400":"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"}`,children:[r("widgets.system_health.tab_storage"),c==="storage"&&l.jsx("div",{className:"absolute bottom-0 left-0 w-full h-0.5 bg-blue-600 dark:bg-blue-400 rounded-t-full"})]}),l.jsxs("button",{onClick:()=>u("database"),className:`pb-3 px-4 text-sm font-medium transition-colors relative ${c==="database"?"text-blue-600 dark:text-blue-400":"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"}`,children:[r("widgets.system_health.tab_database"),c==="database"&&l.jsx("div",{className:"absolute bottom-0 left-0 w-full h-0.5 bg-blue-600 dark:bg-blue-400 rounded-t-full"})]})]}),l.jsxs("div",{className:"flex-1 min-h-0 overflow-hidden",children:[c==="overview"&&l.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-bottom-2 duration-300",children:[l.jsxs("div",{className:"bg-slate-50 dark:bg-slate-900/50 p-4 rounded-xl border border-slate-100 dark:border-slate-800",children:[l.jsxs("h4",{className:"text-sm font-semibold text-slate-900 dark:text-white mb-3 flex items-center gap-2",children:[l.jsx(HS,{className:"w-4 h-4 text-indigo-500"}),r("widgets.system_health.app_environment")]}),l.jsxs("div",{className:"space-y-2 text-sm",children:[l.jsxs("div",{className:"flex justify-between border-b border-slate-200 dark:border-slate-700/50 pb-2",children:[l.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:r("widgets.system_health.version")}),l.jsx("span",{className:"font-mono font-medium text-slate-900 dark:text-white",children:T})]}),P?.schemaVersion!==void 0&&l.jsxs("div",{className:"flex justify-between border-b border-slate-200 dark:border-slate-700/50 pb-2",children:[l.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:"Database Schema"}),l.jsxs("span",{className:"font-mono font-bold text-blue-600 dark:text-blue-400",children:["V",P.schemaVersion]})]}),l.jsxs("div",{className:"flex justify-between border-b border-slate-200 dark:border-slate-700/50 pb-2",children:[l.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:r("widgets.system_health.build_date")}),l.jsx("span",{className:"font-mono font-medium text-slate-900 dark:text-white",children:D})]}),l.jsxs("div",{className:"flex justify-between border-b border-slate-200 dark:border-slate-700/50 pb-2",children:[l.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:r("widgets.system_health.environment")}),l.jsx("span",{className:"font-mono font-medium text-slate-900 dark:text-white uppercase text-xs bg-slate-200 dark:bg-slate-700 px-2 py-0.5 rounded",children:"production"})]}),l.jsxs("div",{className:"flex flex-col gap-1 pb-1",children:[l.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:r("widgets.system_health.user_agent")}),l.jsx("div",{className:"font-mono text-[10px] text-slate-500 dark:text-slate-400 break-all bg-slate-100 dark:bg-slate-900/50 p-2 rounded border border-slate-200 dark:border-slate-800/50",children:navigator.userAgent})]})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{className:"p-4 rounded-xl bg-blue-50 dark:bg-blue-900/10 border border-blue-100 dark:border-blue-900/30",children:[l.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400 font-bold uppercase mb-1",children:r("widgets.system_health.cpu_cores")}),l.jsx("div",{className:"text-2xl font-black text-blue-700 dark:text-blue-300",children:navigator.hardwareConcurrency||"?"})]}),l.jsxs("div",{className:"p-4 rounded-xl bg-purple-50 dark:bg-purple-900/10 border border-purple-100 dark:border-purple-900/30",children:[l.jsx("div",{className:"text-xs text-purple-600 dark:text-purple-400 font-bold uppercase mb-1",children:r("widgets.system_health.device_memory")}),l.jsx("div",{className:"text-2xl font-black text-purple-700 dark:text-purple-300",title:r("widgets.system_health.memory_limit_hint"),children:G.deviceMemory?`${G.deviceMemory>=8?" ":"~"}${G.deviceMemory} GB`:"?"}),l.jsx("div",{className:"text-[9px] text-purple-400 dark:text-purple-500 mt-1 leading-tight",children:r("widgets.system_health.memory_limit_hint")})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[l.jsxs("div",{className:"rounded-xl border border-slate-200 dark:border-slate-700 p-3 bg-white dark:bg-slate-900",children:[l.jsx("div",{className:"text-[10px] uppercase tracking-wider font-bold text-slate-500",children:r("widgets.system_health.overview_db_health")}),l.jsx("div",{className:`mt-1 text-sm font-semibold ${V?.status==="error"?"text-red-600 dark:text-red-300":V?.status==="warning"?"text-amber-600 dark:text-amber-300":"text-emerald-600 dark:text-emerald-300"}`,children:r(V?`widgets.system_health.health_status_${V.status}`:"widgets.system_health.overview_not_available")}),V&&l.jsx("div",{className:"text-[11px] text-slate-500 dark:text-slate-400",children:r("widgets.system_health.health_score",{score:V.score})})]}),l.jsxs("div",{className:"rounded-xl border border-slate-200 dark:border-slate-700 p-3 bg-white dark:bg-slate-900",children:[l.jsx("div",{className:"text-[10px] uppercase tracking-wider font-bold text-slate-500",children:r("widgets.system_health.overview_storage_health")}),l.jsx("div",{className:`mt-1 text-sm font-semibold ${S?.status==="error"?"text-red-600 dark:text-red-300":S?.status==="warning"?"text-amber-600 dark:text-amber-300":"text-emerald-600 dark:text-emerald-300"}`,children:r(S?`widgets.system_health.health_status_${S.status}`:"widgets.system_health.overview_not_available")}),S&&l.jsx("div",{className:"text-[11px] text-slate-500 dark:text-slate-400",children:r("widgets.system_health.health_score",{score:S.score})})]}),l.jsxs("div",{className:"rounded-xl border border-slate-200 dark:border-slate-700 p-3 bg-white dark:bg-slate-900",children:[l.jsx("div",{className:"text-[10px] uppercase tracking-wider font-bold text-slate-500",children:r("widgets.system_health.overview_last_backup")}),l.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-800 dark:text-slate-200",children:window.localStorage.getItem("litebistudio_last_backup")?new Date(String(window.localStorage.getItem("litebistudio_last_backup"))).toLocaleString():r("widgets.system_health.overview_not_available")})]})]}),l.jsxs("div",{className:"rounded-xl border border-slate-200 dark:border-slate-700 p-3 bg-white dark:bg-slate-900",children:[l.jsx("div",{className:"text-[10px] uppercase tracking-wider font-bold text-slate-500 mb-2",children:r("widgets.system_health.overview_quick_actions")}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsx("button",{onClick:ne,className:"px-3 py-1.5 text-xs font-bold rounded border border-blue-300 text-blue-700 dark:border-blue-700 dark:text-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors",children:r("widgets.system_health.overview_action_run_health")}),l.jsx("button",{onClick:()=>u("storage"),className:"px-3 py-1.5 text-xs font-bold rounded border border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",children:r("widgets.system_health.overview_action_open_storage")}),l.jsx("button",{onClick:H,className:"px-3 py-1.5 text-xs font-bold rounded border border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",children:r("widgets.system_health.overview_action_backup")}),l.jsx("button",{onClick:ee,className:"px-3 py-1.5 text-xs font-bold rounded border border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",children:r("widgets.system_health.overview_action_inspector")}),l.jsx("button",{onClick:()=>{le()},className:`px-3 py-1.5 text-xs font-bold rounded border transition-colors ${a?"border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800":"border-slate-200 dark:border-slate-700 text-slate-400 dark:text-slate-500 cursor-not-allowed"}`,disabled:!a,title:a?void 0:r("widgets.system_health.snapshot_cleanup_admin_only"),children:r("widgets.system_health.overview_action_prune_snapshots")})]}),l.jsx("p",{className:"mt-3 text-[11px] text-slate-500 dark:text-slate-400",children:r("widgets.system_health.overview_snapshot_hint")})]})]}),c==="storage"&&l.jsx("div",{className:"h-full min-h-0 overflow-y-auto xl:overflow-hidden pr-1 xl:pr-0 animate-in fade-in slide-in-from-bottom-2 duration-300",children:l.jsxs("div",{className:"h-full min-h-0 grid grid-cols-1 xl:grid-cols-12 gap-4",children:[l.jsxs("div",{className:"xl:col-span-5 space-y-4",children:[l.jsxs("div",{className:"p-6 rounded-2xl bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-800 border border-slate-200 dark:border-slate-700 text-center",children:[l.jsx(PS,{className:"w-12 h-12 text-slate-400 mx-auto mb-4"}),g.quota?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-1",children:r("widgets.system_health.used_storage")}),l.jsx("div",{className:"text-3xl font-black text-slate-900 dark:text-white mb-4",children:pe(g.usage)}),l.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest mb-1",children:r("widgets.system_health.max_available")}),l.jsx("div",{className:"text-sm text-slate-600 dark:text-slate-300 mb-6 font-mono",children:pe(g.quota)}),l.jsx("div",{className:"relative h-2 bg-slate-100 dark:bg-slate-700 rounded-full overflow-hidden max-w-xs mx-auto mb-2",children:l.jsx("div",{className:"absolute top-0 left-0 h-full bg-blue-500 transition-all duration-1000",style:{width:`${Math.min(100,Math.max(1,(g.usage||0)/(g.quota||1)*100))}%`}})}),l.jsx("div",{className:"text-[10px] text-slate-400",children:r("widgets.system_health.quota_used",{percent:((g.usage||0)/(g.quota||1)*100).toFixed(6)})})]}):l.jsx("div",{className:"text-slate-500 italic",children:r("widgets.system_health.no_storage_info")})]}),l.jsxs("div",{className:"flex gap-4 p-4 bg-amber-50 dark:bg-amber-900/10 border border-amber-100 dark:border-amber-900/30 rounded-xl",children:[l.jsx(iu,{className:"w-5 h-5 text-amber-600 dark:text-amber-400 shrink-0 mt-0.5"}),l.jsxs("div",{className:"text-xs text-amber-800 dark:text-amber-300",children:[l.jsx("p",{className:"font-bold mb-1",children:r("widgets.system_health.opfs_title")}),l.jsx("p",{children:r("widgets.system_health.opfs_description")})]})]})]}),S&&l.jsx("div",{className:"xl:col-span-7 min-h-0",children:l.jsxs("div",{className:"h-full min-h-0 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl overflow-hidden flex flex-col",children:[l.jsx("div",{className:"bg-slate-50 dark:bg-slate-800/50 px-4 py-2 border-b border-slate-200 dark:border-slate-700 text-xs font-bold text-slate-500 uppercase tracking-wider",children:r("widgets.system_health.client_health_title")}),l.jsxs("div",{className:"p-4 space-y-3 flex-1 min-h-0 flex flex-col",children:[l.jsxs("div",{className:"flex items-center justify-between gap-2",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[S.status==="ok"&&l.jsx(R1,{className:"w-4 h-4 text-emerald-600 dark:text-emerald-400"}),S.status==="warning"&&l.jsx(t0,{className:"w-4 h-4 text-amber-600 dark:text-amber-400"}),S.status==="error"&&l.jsx(ow,{className:"w-4 h-4 text-red-600 dark:text-red-400"}),l.jsx("span",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:r(`widgets.system_health.health_status_${S.status}`)})]}),l.jsx("div",{className:"text-xs font-mono text-slate-500 dark:text-slate-400",children:r("widgets.system_health.health_score",{score:S.score})})]}),l.jsx("div",{className:"text-[11px] text-slate-500 dark:text-slate-400",children:r("widgets.system_health.client_health_meta",{checks:S.checksRun})}),l.jsx("div",{className:"space-y-2 flex-1 min-h-0 overflow-auto pr-1",children:S.findings.map((I,q)=>{const J=`client-${I.code}-${q}`,Y=!!(I.recommendation&&I.recommendation.trim().length>0);return l.jsxs("div",{className:`rounded-lg border px-3 py-2 ${I.severity==="error"?"border-red-200 bg-red-50 dark:border-red-900/40 dark:bg-red-900/10":I.severity==="warning"?"border-amber-200 bg-amber-50 dark:border-amber-900/40 dark:bg-amber-900/10":"border-slate-200 bg-slate-50 dark:border-slate-700 dark:bg-slate-800/30"}`,children:[l.jsxs("div",{className:"flex items-center justify-between gap-2",children:[l.jsx("span",{className:"text-xs font-semibold text-slate-900 dark:text-white",children:I.title}),l.jsx("span",{className:`text-[10px] uppercase font-bold ${I.severity==="error"?"text-red-700 dark:text-red-300":I.severity==="warning"?"text-amber-700 dark:text-amber-300":"text-slate-500 dark:text-slate-400"}`,children:r(`widgets.system_health.severity_${I.severity}`)})]}),l.jsx("div",{className:"text-[11px] text-slate-600 dark:text-slate-300 mt-1",children:I.details}),l.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:l.jsx("button",{disabled:!Y,onClick:()=>B(de=>de===J?null:J),className:`px-2 py-1 text-[10px] font-bold rounded border transition-colors ${Y?"border-slate-300 dark:border-slate-600 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700":"border-slate-200 dark:border-slate-700 text-slate-400 dark:text-slate-500 bg-slate-100/60 dark:bg-slate-800/60 cursor-not-allowed"}`,children:r(v===J?"widgets.system_health.hide_details":"widgets.system_health.show_details")})}),v===J&&I.recommendation&&l.jsxs("div",{className:"text-[11px] text-slate-500 dark:text-slate-400 mt-1",children:[r("widgets.system_health.recommendation_prefix")," ",I.recommendation]})]},J)})})]})]})})]})}),c==="database"&&l.jsx("div",{className:"h-full min-h-0 flex flex-col space-y-4 animate-in fade-in slide-in-from-bottom-2 duration-300",children:R||U?l.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center py-12 text-slate-400",children:[l.jsx(nk,{className:"w-8 h-8 animate-spin mb-2"}),l.jsx("p",{children:r("widgets.system_health.analyzing_db")})]}):P?l.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-4",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{className:"bg-emerald-50 dark:bg-emerald-900/10 p-4 rounded-xl border border-emerald-100 dark:border-emerald-900/30",children:[l.jsx("div",{className:"text-xs text-emerald-600 dark:text-emerald-400 font-bold uppercase mb-1",children:r("widgets.system_health.db_size")}),l.jsx("div",{className:"text-2xl font-black text-emerald-700 dark:text-emerald-300",children:pe(P.dbSize)}),l.jsxs("div",{className:"text-[10px] text-emerald-600/70 mt-1 font-mono",children:[P.pageCount," Pages @ ",P.pageSize," Bytes"]})]}),l.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-4 rounded-xl border border-slate-100 dark:border-slate-700 flex flex-col justify-center items-center text-center",children:[l.jsxs("div",{className:"flex items-center gap-2 text-green-600 dark:text-green-400 mb-1",children:[l.jsx(R1,{className:"w-5 h-5"}),l.jsx("span",{className:"font-bold",children:r("widgets.system_health.connected")})]}),l.jsx("div",{className:"text-xs text-slate-400",children:r("widgets.system_health.worker_active")})]})]}),l.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl overflow-hidden flex-1 min-h-0 flex flex-col",children:[l.jsx("div",{className:"bg-slate-50 dark:bg-slate-800/50 px-3 py-2 border-b border-slate-200 dark:border-slate-700",children:l.jsxs("div",{className:"inline-flex rounded-lg border border-slate-200 dark:border-slate-700 overflow-hidden",children:[l.jsx("button",{onClick:()=>h("health"),className:`px-3 py-1.5 text-xs font-bold transition-colors ${f==="health"?"bg-blue-600 text-white":"bg-white dark:bg-slate-900 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800"}`,children:r("widgets.system_health.health_check_title")}),l.jsx("button",{onClick:()=>h("stats"),className:`px-3 py-1.5 text-xs font-bold transition-colors ${f==="stats"?"bg-blue-600 text-white":"bg-white dark:bg-slate-900 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800"}`,children:r("widgets.system_health.table_stats")})]})}),f==="health"&&V&&l.jsxs("div",{className:"p-4 space-y-3 flex-1 min-h-0 flex flex-col",children:[l.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[V.status==="ok"&&l.jsx(R1,{className:"w-4 h-4 text-emerald-600 dark:text-emerald-400"}),V.status==="warning"&&l.jsx(t0,{className:"w-4 h-4 text-amber-600 dark:text-amber-400"}),V.status==="error"&&l.jsx(ow,{className:"w-4 h-4 text-red-600 dark:text-red-400"}),l.jsx("span",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:r(`widgets.system_health.health_status_${V.status}`)})]}),l.jsx("div",{className:"text-xs font-mono text-slate-500 dark:text-slate-400",children:r("widgets.system_health.health_score",{score:V.score})})]}),l.jsx("div",{className:"text-[11px] text-slate-500 dark:text-slate-400",children:r("widgets.system_health.health_meta",{checks:V.checksRun,timestamp:new Date(V.checkedAt).toLocaleString()})}),l.jsx("div",{className:"space-y-2 flex-1 min-h-0 overflow-auto pr-1",children:V.findings.map((I,q)=>{const J=`${I.code}-${q}`,Y=!!(I.recommendation&&I.recommendation.trim().length>0);return l.jsxs("div",{className:`rounded-lg border px-3 py-2 ${I.severity==="error"?"border-red-200 bg-red-50 dark:border-red-900/40 dark:bg-red-900/10":I.severity==="warning"?"border-amber-200 bg-amber-50 dark:border-amber-900/40 dark:bg-amber-900/10":"border-slate-200 bg-slate-50 dark:border-slate-700 dark:bg-slate-800/30"}`,children:[l.jsxs("div",{className:"flex items-center justify-between gap-2",children:[l.jsx("span",{className:"text-xs font-semibold text-slate-900 dark:text-white",children:I.title}),l.jsx("span",{className:`text-[10px] uppercase font-bold ${I.severity==="error"?"text-red-700 dark:text-red-300":I.severity==="warning"?"text-amber-700 dark:text-amber-300":"text-slate-500 dark:text-slate-400"}`,children:r(`widgets.system_health.severity_${I.severity}`)})]}),l.jsx("div",{className:"text-[11px] text-slate-600 dark:text-slate-300 mt-1",children:I.details}),l.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[l.jsx("button",{disabled:!Y,onClick:()=>w(de=>de===J?null:J),className:`px-2 py-1 text-[10px] font-bold rounded border transition-colors ${Y?"border-slate-300 dark:border-slate-600 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700":"border-slate-200 dark:border-slate-700 text-slate-400 dark:text-slate-500 bg-slate-100/60 dark:bg-slate-800/60 cursor-not-allowed"}`,children:r(m===J?"widgets.system_health.hide_details":"widgets.system_health.show_details")}),F(I)&&l.jsxs("button",{disabled:k===J,onClick:()=>K(I,J),className:"inline-flex items-center gap-1 px-2 py-1 text-[10px] font-bold rounded border border-blue-300 text-blue-700 dark:border-blue-700 dark:text-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[l.jsx(D8,{className:"w-3 h-3"}),r(k===J?"widgets.system_health.quick_fix_running":"widgets.system_health.quick_fix")]})]}),m===J&&I.recommendation&&l.jsxs("div",{className:"text-[11px] text-slate-500 dark:text-slate-400 mt-2",children:[r("widgets.system_health.recommendation_prefix")," ",I.recommendation]})]},J)})})]}),f==="stats"&&l.jsxs("div",{className:"divide-y divide-slate-100 dark:divide-slate-800 flex-1 min-h-0 overflow-auto",children:[Object.entries(P.tableStats||{}).filter(([I])=>!I.startsWith("sys_")&&!I.startsWith("sqlite_")).length>0&&l.jsx("div",{className:"bg-blue-50/30 dark:bg-blue-900/10 px-4 py-1.5 text-[10px] font-bold text-blue-600 dark:text-blue-400 uppercase tracking-tight",children:r("widgets.system_health.user_tables")}),Object.entries(P.tableStats||{}).filter(([I])=>!I.startsWith("sys_")&&!I.startsWith("sqlite_")).map(([I,q])=>l.jsxs("div",{className:"flex justify-between px-4 py-3 text-sm hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors",children:[l.jsx("span",{className:"font-mono text-slate-700 dark:text-slate-200",children:I}),l.jsx("span",{className:"font-bold text-slate-900 dark:text-white",children:q.toLocaleString()})]},I)),l.jsx("div",{className:"bg-slate-100 dark:bg-slate-800/80 px-4 py-1.5 text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-tight",children:r("widgets.system_health.system_tables")}),Object.entries(P.tableStats||{}).filter(([I])=>I.startsWith("sys_")||I.startsWith("sqlite_")).map(([I,q])=>l.jsxs("div",{className:"flex justify-between px-4 py-3 text-sm opacity-70 hover:opacity-100 transition-opacity",children:[l.jsx("span",{className:"font-mono text-slate-500 dark:text-slate-400 text-xs",children:I}),l.jsx("span",{className:"font-medium text-slate-700 dark:text-slate-300",children:q.toLocaleString()})]},I))]})]}),l.jsx("div",{className:"flex justify-end pt-2",children:l.jsxs("button",{onClick:()=>{Q(),M()},className:"flex items-center gap-2 px-4 py-2 bg-slate-100 dark:bg-slate-800 hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300 rounded-lg text-xs font-bold transition-colors",children:[l.jsx(nk,{className:"w-3.5 h-3.5"}),r("widgets.system_health.refresh_diag")]})})]}):l.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center py-12 text-red-400",children:[l.jsx(t0,{className:"w-8 h-8 mb-2"}),l.jsx("p",{children:r("widgets.system_health.diag_failed")}),l.jsx("button",{onClick:Q,className:"mt-4 text-blue-500 underline text-sm",children:r("widgets.system_health.retry")})]})})]})]})})},SK=({isCollapsed:e})=>{const{t}=ds(),[r,a]=Z.useState(!1);return l.jsxs(l.Fragment,{children:[l.jsxs("button",{onClick:()=>a(!0),className:`w-full flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-md transition-all text-slate-700 hover:bg-slate-100 dark:text-slate-200 dark:hover:bg-slate-800 ${e?"md:justify-center md:px-0":""}`,title:e?t("sidebar.system_status"):"",children:[l.jsx(r0,{className:"w-5 h-5 flex-shrink-0 text-blue-500"}),l.jsx("span",{className:`transition-all duration-300 ${e?"md:opacity-0 md:w-0 overflow-hidden":"opacity-100"}`,children:t("sidebar.system_status")})]}),l.jsx(g_,{isOpen:r,onClose:()=>a(!1)})]})},Ab=({size:e=40,className:t=""})=>l.jsx("div",{className:`relative inline-flex items-center justify-center ${t}`,style:{width:e,height:e},"aria-hidden":"true",children:l.jsxs("svg",{viewBox:"0 0 64 64",width:e,height:e,className:"overflow-visible",role:"img","aria-label":"LiteBI Studio",children:[l.jsxs("defs",{children:[l.jsxs("linearGradient",{id:"litebi-bars",x1:"0",y1:"1",x2:"1",y2:"0",children:[l.jsx("stop",{offset:"0%",stopColor:"#73e23d"}),l.jsx("stop",{offset:"45%",stopColor:"#19b57a"}),l.jsx("stop",{offset:"100%",stopColor:"#0b8fe9"})]}),l.jsxs("linearGradient",{id:"litebi-arrow",x1:"0",y1:"1",x2:"1",y2:"0",children:[l.jsx("stop",{offset:"0%",stopColor:"#1fb2ff"}),l.jsx("stop",{offset:"100%",stopColor:"#147be9"})]}),l.jsxs("linearGradient",{id:"litebi-dot",x1:"0",y1:"1",x2:"1",y2:"0",children:[l.jsx("stop",{offset:"0%",stopColor:"#2ecb7f"}),l.jsx("stop",{offset:"100%",stopColor:"#7ddf3b"})]})]}),l.jsx("path",{d:"M5 52c10 3 22 3 35 0",fill:"none",stroke:"#3f78a3",strokeWidth:"3.2",strokeLinecap:"round",opacity:"0.9"}),l.jsx("path",{d:"M8 47h7V38H8zM17 47h8V34h-8zM27 47h8V30h-8zM37 47h10V22h-10z",fill:"url(#litebi-bars)"}),l.jsx("path",{d:"M7 33c11 0 20-3 28-12",fill:"none",stroke:"url(#litebi-arrow)",strokeWidth:"3.4",strokeLinecap:"round"}),l.jsx("path",{d:"M32 19l7-2-2 7z",fill:"url(#litebi-arrow)"}),l.jsx("circle",{cx:"49",cy:"13",r:"3.9",fill:"url(#litebi-dot)"})]})}),NK=({isCollapsed:e,sidebarOpen:t,onToggleCollapse:r,onCloseMobile:a,isReadOnly:s})=>{const{t:n,i18n:o}=ds(),{visibleSidebarComponentIds:c,lockApp:u}=So(),[f,h]=Wt.useState(!!localStorage.getItem("litebistudio_app_pin")),[g,x]=Jt("ui_sidebar_show_language_switch",!0),[m,w]=Jt("ui_sidebar_show_system_status",!0);Wt.useEffect(()=>{const R=()=>{h(!!localStorage.getItem("litebistudio_app_pin"))};return window.addEventListener("pin-changed",R),()=>window.removeEventListener("pin-changed",R)},[]),Wt.useEffect(()=>{const R=Q=>{const V=Q;typeof V.detail?.visible=="boolean"&&x(V.detail.visible)};return window.addEventListener("sidebar-language-visibility-changed",R),()=>window.removeEventListener("sidebar-language-visibility-changed",R)},[x]),Wt.useEffect(()=>{const R=Q=>{const V=Q;typeof V.detail?.visible=="boolean"&&w(V.detail.visible)};return window.addEventListener("sidebar-system-status-visibility-changed",R),()=>window.removeEventListener("sidebar-system-status-visibility-changed",R)},[w]);const v=()=>{const R=o.language.startsWith("de")?"en":"de";o.changeLanguage(R)},B={ItCostsComponent:l.jsx(R8,{className:"w-5 h-5 flex-shrink-0 text-emerald-500"}),SystemsComponent:l.jsx(O8,{className:"w-5 h-5 flex-shrink-0 text-blue-500"}),AnomalyRadarComponent:l.jsx(Q8,{className:"w-5 h-5 flex-shrink-0 text-rose-500"}),WorklistComponent:l.jsx(bf,{className:"w-5 h-5 flex-shrink-0 text-amber-500"}),DataInspectorComponent:l.jsx(Zo,{className:"w-5 h-5 flex-shrink-0 text-indigo-500"})},k=[{to:"/",icon:l.jsx(ik,{className:"w-5 h-5 flex-shrink-0"}),label:n("sidebar.dashboard")}],E=Gu.filter(R=>R.targetView&&c.includes(R.id)).map(R=>({to:R.targetView,icon:B[R.component]||l.jsx(ik,{className:"w-5 h-5 flex-shrink-0"}),label:n(`sidebar.${R.id.replace(/-/g,"_")}`,R.title)})),S=[{to:"/datasource",icon:l.jsx(wl,{className:"w-5 h-5 flex-shrink-0"}),label:n("sidebar.datasource")},{to:"/sql-workspace",icon:l.jsx(I8,{className:"w-5 h-5 flex-shrink-0"}),label:n("sidebar.sql_workspace")},{to:"/query",icon:l.jsx(Q0,{className:"w-5 h-5 flex-shrink-0"}),label:n("sidebar.query_builder")},{to:"/reports",icon:l.jsx(xf,{className:"w-5 h-5 flex-shrink-0"}),label:n("sidebar.reports")},{to:"/about",icon:l.jsx(iu,{className:"w-5 h-5 flex-shrink-0"}),label:n("sidebar.about")}],L={"/":0,"/datasource":1,"/inspector":2,"/sql-workspace":3,"/query":4,"/reports":5,"/worklist":6,"/settings":7,"/about":8},P=[...k,...E,...S].sort((R,Q)=>{const V=L[R.to]??100,U=L[Q.to]??100;return V!==U?V-U:R.label.localeCompare(Q.label)});return l.jsxs("aside",{className:`
            fixed inset-y-0 left-0 z-50 bg-white dark:bg-slate-800 border-r border-slate-300 dark:border-slate-700 transform transition-all duration-300 ease-in-out
            ${e?"md:w-20":"md:w-64"}
            ${t?"translate-x-0 w-64":"-translate-x-full md:translate-x-0"}
        `,children:[l.jsxs("div",{className:`p-6 border-b border-slate-300 dark:border-slate-700 flex items-center justify-between ${e?"md:p-4 md:justify-center":""}`,children:[l.jsxs("div",{className:"flex items-center gap-2.5 overflow-hidden",children:[l.jsx(Ab,{size:32,className:"flex-shrink-0"}),l.jsxs("div",{className:`transition-all duration-300 ${e?"md:opacity-0 md:w-0":"opacity-100 flex flex-col"}`,children:[l.jsxs("h1",{className:"text-lg font-extrabold tracking-tight text-slate-900 dark:text-white leading-tight whitespace-nowrap",children:["LiteBI ",l.jsx("span",{className:"text-blue-600",children:"Studio"})]}),l.jsx("p",{className:"text-[10px] font-medium text-slate-400 uppercase tracking-widest whitespace-nowrap",children:n("sidebar.analytics_platform")})]})]}),l.jsx("button",{onClick:a,className:"md:hidden p-1 text-slate-500 hover:text-slate-700",children:l.jsx(qS,{className:"w-6 h-6"})}),l.jsx("button",{onClick:r,className:"hidden md:flex absolute -right-3 top-1/2 -translate-y-1/2 w-6 h-6 bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-700 rounded-full items-center justify-center shadow-md hover:text-blue-600 transition-colors z-50",children:e?l.jsx(Yl,{className:"w-4 h-4"}):l.jsx(KS,{className:"w-4 h-4"})})]}),l.jsxs("div",{className:"flex flex-col h-[calc(100%-80px)] justify-between",children:[l.jsxs("div",{children:[s&&l.jsxs("div",{className:`bg-amber-50 dark:bg-amber-900/20 border-b border-amber-200 dark:border-amber-800/50 px-4 py-3 flex items-start gap-3 text-amber-800 dark:text-amber-400 overflow-hidden ${e?"md:px-0 md:justify-center":""}`,children:[l.jsx(iu,{className:"w-5 h-5 flex-shrink-0"}),l.jsxs("div",{className:`text-xs transition-all duration-300 ${e?"md:opacity-0 md:w-0":"opacity-100"}`,children:[l.jsx("span",{className:"font-semibold block text-sm",children:"Lese-Modus"}),"Schreibschutz aktiv (2. Tab)"]})]}),l.jsx("nav",{className:"p-4 space-y-1",children:P.map(({to:R,icon:Q,label:V})=>l.jsxs(sk,{to:R,end:R==="/",onClick:a,className:({isActive:U})=>`w-full flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-md transition-all ${e?"md:justify-center md:px-0":""} ${U?"bg-blue-50 text-blue-700 dark:bg-blue-900/20 dark:text-blue-200":"text-slate-700 hover:bg-slate-100 dark:text-slate-200 dark:hover:bg-slate-800"}`,title:e?V:"",children:[Q,l.jsx("span",{className:`transition-all duration-300 ${e?"md:opacity-0 md:w-0 overflow-hidden":"opacity-100"}`,children:V})]},`${V}-${R}`))})]}),l.jsxs("div",{className:`p-4 border-t border-slate-300 dark:border-slate-700 transition-all space-y-1 ${e?"md:p-2 md:py-4":""}`,children:[g&&l.jsxs("button",{onClick:v,className:`w-full flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-md text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 transition-all ${e?"md:justify-center md:px-0":""}`,title:o.language.startsWith("de")?"Switch to English":"Auf Deutsch umstellen",children:[l.jsx(wp,{className:"w-5 h-5 flex-shrink-0"}),l.jsx("span",{className:`transition-all duration-300 ${e?"md:opacity-0 md:w-0 overflow-hidden":"opacity-100"}`,children:o.language.startsWith("de")?"English":"Deutsch"})]}),l.jsxs(sk,{to:"/settings",onClick:a,className:({isActive:R})=>`w-full flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-md transition-all ${e?"md:justify-center md:px-0":""} ${R?"bg-blue-50 text-blue-700 dark:bg-blue-900/20 dark:text-blue-200":"text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800"}`,title:e?n("sidebar.settings"):"",children:[l.jsx(_p,{className:"w-5 h-5 flex-shrink-0"}),l.jsx("span",{className:`transition-all duration-300 ${e?"md:opacity-0 md:w-0 overflow-hidden":"opacity-100"}`,children:n("sidebar.settings")})]}),f&&l.jsxs("button",{onClick:u,className:`w-full flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-md text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 transition-all ${e?"md:justify-center md:px-0":""}`,title:o.language.startsWith("de")?"Lock screen":"Sperrbildschirm aktivieren",children:[l.jsx(H0,{className:"w-5 h-5 flex-shrink-0"}),l.jsx("span",{className:`transition-all duration-300 ${e?"md:opacity-0 md:w-0 overflow-hidden":"opacity-100"}`,children:o.language.startsWith("de")?"Lock":"Sperren"})]}),m&&l.jsx(SK,{isCollapsed:e})]})]})]})},EK=()=>l.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-slate-900/80 backdrop-blur-sm animate-in fade-in duration-300",children:l.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-3xl shadow-2xl border border-slate-200 dark:border-slate-700 max-w-md w-full overflow-hidden animate-in zoom-in-95 duration-300",children:[l.jsxs("div",{className:"p-8",children:[l.jsx("div",{className:"flex items-center justify-center w-16 h-16 bg-amber-100 dark:bg-amber-900/30 rounded-2xl mb-6 mx-auto",children:l.jsx(t0,{className:"w-8 h-8 text-amber-600 dark:text-amber-500"})}),l.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white text-center mb-3",children:"Zweite Instanz erkannt"}),l.jsxs("p",{className:"text-slate-600 dark:text-slate-400 text-center mb-8 leading-relaxed",children:["LiteBI Studio ist bereits in einem anderen Tab geffnet. Um Datenverlust zu vermeiden, ist der Zugriff auf ",l.jsx("span",{className:"font-semibold text-slate-900 dark:text-white",children:"einen aktiven Tab"})," beschrnkt."]}),l.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800/50 rounded-2xl p-4 flex gap-3 items-start mb-6",children:[l.jsx(ow,{className:"w-5 h-5 text-amber-600 dark:text-amber-500 mt-0.5 shrink-0"}),l.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-400",children:"Bitte schlieen Sie diesen Tab manuell und nutzen Sie die bereits geffnete Instanz."})]}),l.jsxs("button",{onClick:()=>p_(),className:"w-full flex items-center justify-center gap-2 py-3 px-4 bg-slate-900 hover:bg-slate-800 dark:bg-white dark:hover:bg-slate-100 text-white dark:text-slate-900 font-medium rounded-xl transition-colors mb-2",children:[l.jsx(M8,{className:"w-5 h-5 flex-shrink-0"}),"Weiter im Lese-Modus"]})]}),l.jsx("div",{className:"bg-slate-50 dark:bg-slate-900/50 p-4 border-t border-slate-100 dark:border-slate-800 flex justify-center",children:l.jsxs("a",{href:"https://github.com/hrmnns/litebistudio/blob/48f73003fb415174711f4e77baaf1433637d76ff/docs/Single-Instance-Policy.md",target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-500 hover:text-blue-600 flex items-center gap-1 transition-colors",children:["Warum ist das so? ",l.jsx(Vu,{className:"w-3 h-3"})]})})]})});function FK(e=16){const t=new Uint8Array(e);return crypto.getRandomValues(t),Array.from(t).map(r=>r.toString(16).padStart(2,"0")).join("")}async function QE(e,t){const a=new TextEncoder().encode(t?t+e:e),s=await crypto.subtle.digest("SHA-256",a);return Array.from(new Uint8Array(s)).map(o=>o.toString(16).padStart(2,"0")).join("")}async function OE(e){const t=new TextEncoder;return crypto.subtle.importKey("raw",t.encode(e),{name:"PBKDF2"},!1,["deriveBits","deriveKey"])}async function RE(e,t){return crypto.subtle.deriveKey({name:"PBKDF2",salt:t,iterations:1e5,hash:"SHA-256"},e,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"])}async function TK(e,t){const r=crypto.getRandomValues(new Uint8Array(16)),a=crypto.getRandomValues(new Uint8Array(12)),s=await OE(t),n=await RE(s,new Uint8Array(r).buffer),o=await crypto.subtle.encrypt({name:"AES-GCM",iv:a},n,e),c=new Uint8Array(r.byteLength+a.byteLength+o.byteLength);return c.set(r,0),c.set(a,r.byteLength),c.set(new Uint8Array(o),r.byteLength+a.byteLength),c.buffer}async function LK(e,t){const r=e instanceof Uint8Array?e:new Uint8Array(e),a=r.slice(0,16),s=r.slice(16,28),n=r.slice(28),o=await OE(t),c=await RE(o,new Uint8Array(a).buffer);return crypto.subtle.decrypt({name:"AES-GCM",iv:s},c,n)}const jK=()=>{const{isLocked:e,unlockApp:t}=So(),[r,a]=Z.useState(""),[s,n]=Z.useState(""),[o,c]=Z.useState(!1);if(!e)return null;const u=async f=>{f&&f.preventDefault();const h=localStorage.getItem("litebistudio_app_pin"),g=localStorage.getItem("litebistudio_app_pin_salt")||"";if(!h){t();return}await QE(r,g)===h?(t(),a(""),n("")):(n("Falsche PIN"),c(!0),setTimeout(()=>c(!1),500),a(""))};return l.jsxs("div",{className:"fixed inset-0 z-[100] bg-slate-900/95 backdrop-blur-sm flex items-center justify-center p-4",children:[l.jsxs("div",{className:`w-full max-w-sm bg-slate-800 border border-slate-700 rounded-2xl shadow-2xl p-8 flex flex-col items-center gap-6 ${o?"animate-shake":""}`,children:[l.jsx("div",{className:"p-4 bg-slate-700/50 rounded-full ring-4 ring-slate-800",children:l.jsx(H0,{className:"w-8 h-8 text-blue-500"})}),l.jsxs("div",{className:"text-center space-y-2",children:[l.jsx("h2",{className:"text-2xl font-bold text-white",children:"System gesperrt"}),l.jsx("p",{className:"text-slate-400",children:"Bitte geben Sie Ihre PIN ein, um fortzufahren."})]}),l.jsxs("form",{onSubmit:u,className:"w-full space-y-4",children:[l.jsx("div",{className:"relative",children:l.jsx("input",{type:"password",inputMode:"numeric",pattern:"[0-9]*",autoFocus:!0,maxLength:6,value:r,onChange:f=>{n(""),a(f.target.value)},className:"w-full bg-slate-900 border border-slate-700 text-white text-center text-3xl tracking-[1em] py-4 rounded-xl focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 placeholder:tracking-normal font-mono",placeholder:""})}),s&&l.jsxs("div",{className:"flex items-center justify-center gap-2 text-red-400 text-sm animate-fade-in",children:[l.jsx(Cn,{className:"w-4 h-4"}),s]}),l.jsxs("button",{type:"submit",disabled:r.length<4,className:"w-full py-3 bg-blue-600 hover:bg-blue-500 active:bg-blue-700 text-white font-semibold rounded-xl transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[l.jsx(zS,{className:"w-4 h-4"}),"Entsperren"]})]}),l.jsx("div",{className:"text-xs text-slate-500 mt-4",children:"LiteBI Studio Protected"})]}),l.jsx("style",{children:`
                @keyframes shake {
                    0%, 100% { transform: translateX(0); }
                    25% { transform: translateX(-5px); }
                    75% { transform: translateX(5px); }
                }
                .animate-shake {
                    animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
                }
            `})]})},UK=()=>{const[e,t]=Z.useState(!1),[r,a]=Z.useState(!1),{isSidebarCollapsed:s,setSidebarCollapsed:n,isPresentationMode:o,togglePresentationMode:c,isReadOnly:u,setIsReadOnly:f}=So();return Z.useEffect(()=>{const h=jE((g,x)=>{a(g),f(x??!1)});return()=>{h()}},[f]),l.jsxs("div",{className:"h-screen overflow-hidden bg-slate-50 dark:bg-slate-900 text-slate-900 dark:text-slate-100 flex flex-col md:flex-row",children:[!o&&l.jsx(NK,{isCollapsed:s,sidebarOpen:e,onToggleCollapse:()=>n(!s),onCloseMobile:()=>t(!1),isReadOnly:u}),l.jsxs("main",{className:`flex-1 flex flex-col min-w-0 overflow-hidden transition-all duration-300 ${o?"ml-0":s?"md:ml-20":"md:ml-64"}`,children:[!o&&l.jsxs("header",{className:"md:hidden bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 p-4 flex items-center gap-4",children:[l.jsx("button",{onClick:()=>t(!0),className:"p-1 text-slate-500 hover:text-slate-700",children:l.jsx(qS,{className:"w-6 h-6"})}),l.jsxs("h1",{className:"text-lg font-bold flex items-center gap-2",children:[l.jsx(Ab,{size:24}),"LiteBI Studio",u&&l.jsx("span",{className:"text-[10px] uppercase font-bold tracking-wider bg-amber-100 dark:bg-amber-900/50 text-amber-700 dark:text-amber-400 px-2 py-0.5 rounded-full border border-amber-200 dark:border-amber-800",children:"Lese-Modus"})]})]}),l.jsx("div",{className:"flex-1 min-h-0 overflow-hidden relative",children:l.jsx(E8,{})})]}),e&&l.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 md:hidden glass",onClick:()=>t(!1)}),r&&!u&&l.jsx(EK,{}),l.jsx(jK,{}),o&&l.jsxs("button",{onClick:c,className:"fixed bottom-6 right-6 z-50 p-4 bg-slate-900 text-white rounded-full shadow-2xl hover:bg-slate-800 transition-all hover:scale-105 active:scale-95 group",title:"Prsentationsmodus beenden",children:[l.jsx(y2,{className:"w-6 h-6"}),l.jsx("span",{className:"absolute right-full mr-3 top-1/2 -translate-y-1/2 bg-slate-900 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap pointer-events-none",children:"Modus beenden"})]})]})},ME=Z.createContext(void 0),DK=({children:e})=>{const[t,r]=Jt("theme","system");return Z.useEffect(()=>{const a=window.document.documentElement,s=()=>{a.classList.remove("light","dark")},n=o=>{if(s(),o==="system"){const c=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";a.classList.add(c);return}a.classList.add(o)};if(n(t),t==="system"){const o=window.matchMedia("(prefers-color-scheme: dark)"),c=()=>n("system");return o.addEventListener("change",c),()=>o.removeEventListener("change",c)}},[t]),l.jsx(ME.Provider,{value:{theme:t,setTheme:r},children:e})},IK=()=>{const e=Z.useContext(ME);if(!e)throw new Error("useThemeContext must be used within a ThemeProvider");return e},Fw={sm:"w-[min(100vw,26rem)]",md:"w-[min(100vw,34rem)]",lg:"w-[min(100vw,42rem)]"},QK=e=>{if(typeof e=="number")return{width:`${e}px`};if(typeof e=="string"&&!Fw[e])return{width:e}},OK=e=>e?typeof e!="string"?"w-full max-w-full":Fw[e]??"w-full max-w-full":Fw.md,HE=({isOpen:e,onClose:t,title:r,children:a,width:s="md",noScroll:n})=>(Z.useEffect(()=>{if(!e)return;const o=document.body.style.overflow,c=u=>{u.key==="Escape"&&t()};return document.body.style.overflow="hidden",window.addEventListener("keydown",c),()=>{document.body.style.overflow=o,window.removeEventListener("keydown",c)}},[e,t]),e?I0.createPortal(l.jsxs("div",{className:"fixed inset-0 z-[90] flex justify-end",children:[l.jsx("div",{className:"absolute inset-0 bg-slate-900/60 backdrop-blur-sm animate-in fade-in duration-200",onClick:t}),l.jsx("aside",{role:"dialog","aria-modal":"true",className:ni("relative h-full max-h-screen bg-white dark:bg-slate-800 shadow-2xl border-l border-slate-200 dark:border-slate-700","animate-in slide-in-from-right-16 duration-200",OK(s)),style:QK(s),children:l.jsxs("div",{className:"h-full min-h-0 flex flex-col",children:[l.jsxs("div",{className:"px-5 py-4 border-b border-slate-200 dark:border-slate-700 flex items-center justify-between gap-3",children:[l.jsx("h3",{className:"text-base font-bold text-slate-900 dark:text-white truncate",children:r}),l.jsx("button",{onClick:t,className:"p-2 rounded-lg text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors","aria-label":"Close panel",children:l.jsx(vl,{className:"w-4 h-4"})})]}),l.jsx("div",{className:ni("flex-1 min-h-0 p-5",!n&&"overflow-auto"),children:a})]})})]}),document.body):null),RK={error:{bg:"bg-red-50 dark:bg-red-900/10",border:"border-red-200 dark:border-red-800/40",text:"text-red-800 dark:text-red-300",icon:""},warning:{bg:"bg-amber-50 dark:bg-amber-900/10",border:"border-amber-200 dark:border-amber-800/40",text:"text-amber-800 dark:text-amber-300",icon:""},info:{bg:"bg-blue-50 dark:bg-blue-900/10",border:"border-blue-200 dark:border-blue-800/40",text:"text-blue-800 dark:text-blue-300",icon:""},success:{bg:"bg-emerald-50 dark:bg-emerald-900/10",border:"border-emerald-200 dark:border-emerald-800/40",text:"text-emerald-800 dark:text-emerald-300",icon:""}},x0=({header:e,alerts:t,children:r,sidebar:a,footer:s,breadcrumbs:n,className:o,fillHeight:c,rightPanel:u})=>{const{t:f}=ds(),{isAdminMode:h,isReadOnly:g}=So(),[x,m]=Z.useState(0),[w,v]=Z.useState(null),[B,k]=Z.useState(!!u?.defaultOpen),{data:E}=Ai(()=>jt.getStorageStatus(),[],{cacheKey:"db-storage-status",ttl:15e3});Z.useEffect(()=>{const M=()=>m(D=>D+1),T=D=>{m(ne=>Math.max(0,ne-1));const G=D.detail;G?.duration!==void 0&&v(G.duration)};return window.addEventListener("db-query-start",M),window.addEventListener("db-query-end",T),()=>{window.removeEventListener("db-query-start",M),window.removeEventListener("db-query-end",T)}},[]);const S=[...t??[]];if(E?.mode==="memory"){const M=E.reason?` ${f("common.storage_memory_reason","Reason")}: ${E.reason}`:"";S.unshift({level:"warning",message:`${f("common.storage_memory_warning","Local persistence is currently unavailable. The database runs in memory and changes may be lost after reload.")}${M}`})}const L=async()=>{await jt.abortActiveQueries()},P=u?.isOpen!==void 0,R=u?P?!!u.isOpen:B:!1,Q=!!(u&&(u.enabled??!0)),V=Q&&R,U=M=>{u&&(P||k(M),u.onOpenChange?.(M))};return l.jsxs("div",{className:ni("h-full flex flex-col overflow-hidden animate-in slide-in-from-right-4 duration-500",o),children:[l.jsx("header",{className:"flex-shrink-0 px-6 md:px-8 py-4 border-b border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm",children:l.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[l.jsx("div",{className:"flex items-center gap-4",children:l.jsxs("div",{children:[l.jsx("h1",{className:"text-xl md:text-2xl font-black text-slate-900 dark:text-white tracking-tight leading-tight",children:e.title}),e.subtitle&&l.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-0.5",children:e.subtitle})]})}),l.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.actions,l.jsx("button",{type:"button",onClick:()=>{Q&&U(!0)},title:Q?u?.triggerTitle||f("common.open","Open"):f("common.not_available","Not available"),"aria-label":Q?u?.triggerTitle||f("common.open","Open"):f("common.not_available","Not available"),disabled:!Q,className:ni("h-10 w-10 flex items-center justify-center rounded-lg border transition-all",Q?"bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-700":"bg-slate-100 dark:bg-slate-800/60 text-slate-300 dark:text-slate-600 border-slate-200 dark:border-slate-700 cursor-not-allowed",Q&&V&&"ring-2 ring-blue-500/30",u?.triggerClassName),children:l.jsx(H8,{className:"w-4 h-4"})})]})]})}),l.jsx("div",{className:ni("flex-1",c?"flex flex-col overflow-hidden":"overflow-y-auto"),children:l.jsxs("div",{className:ni("px-6 md:px-8 py-6",c?"flex-1 flex flex-col gap-6 overflow-hidden":"space-y-6"),children:[S.length>0&&l.jsx("div",{className:"space-y-3 flex-shrink-0",children:S.map((M,T)=>{const D=RK[M.level];return l.jsxs("div",{className:ni("flex items-center justify-between gap-4 p-4 rounded-xl border",D.bg,D.border),children:[l.jsxs("div",{className:ni("flex items-center gap-3 text-sm font-medium",D.text),children:[l.jsx("span",{className:"text-base flex-shrink-0",children:D.icon}),l.jsx("span",{children:M.message})]}),M.action&&l.jsx("button",{onClick:M.action.onClick,className:"flex-shrink-0 px-4 py-1.5 text-xs font-bold uppercase tracking-wider border border-current rounded-lg hover:bg-black/5 dark:hover:bg-white/5 transition-colors",children:M.action.label})]},T)})}),a?l.jsxs("div",{className:ni("flex flex-col lg:flex-row gap-6",c&&"flex-1 overflow-hidden"),children:[l.jsx("div",{className:ni("flex-1 min-w-0",c?"flex flex-col gap-6 overflow-hidden":"space-y-6"),children:r}),l.jsx("aside",{className:"w-full lg:w-72 flex-shrink-0 space-y-6",children:a})]}):l.jsx("div",{className:ni(c?"flex-1 flex flex-col gap-6 overflow-hidden":"space-y-6"),children:r})]})}),(s||n&&n.length>0||x>0||w!==null)&&l.jsx("footer",{className:"flex-shrink-0 px-6 md:px-8 py-3 border-t border-slate-300 dark:border-slate-700 bg-slate-50/50 dark:bg-slate-800/50",children:l.jsxs("div",{className:"flex items-center justify-between gap-4",children:[l.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-400 dark:text-slate-500",children:[g&&l.jsxs("div",{className:"flex items-center gap-2 px-2.5 py-0.5 rounded-lg bg-rose-100 dark:bg-rose-900/40 border border-rose-300 dark:border-rose-700 shadow-sm",title:f("common.read_only","Read-Only"),children:[l.jsx(H0,{className:"w-3.5 h-3.5 text-rose-700 dark:text-rose-300"}),l.jsx("span",{className:"text-[10px] font-black uppercase tracking-wider text-rose-800 dark:text-rose-200",children:f("common.read_only","Read-Only")})]}),h?l.jsxs("div",{className:"flex items-center gap-2 px-2.5 py-0.5 rounded-lg bg-amber-100 dark:bg-amber-900/40 border border-amber-300 dark:border-amber-700 shadow-sm",title:f("settings.admin_mode_active","Admin Mode active"),children:[l.jsx(P8,{className:"w-3.5 h-3.5 text-amber-700 dark:text-amber-300"}),l.jsx("span",{className:"text-[10px] font-black uppercase tracking-wider text-amber-800 dark:text-amber-200",children:f("settings.admin_mode","Admin Mode")})]}):l.jsx("div",{className:"flex items-center px-1.5 py-0.5 rounded-full text-slate-400 dark:text-slate-500",title:f("settings.user_mode","User Mode"),children:l.jsx(VS,{className:"w-3.5 h-3.5"})}),(x>0||w!==null)&&l.jsx("div",{className:"flex items-center gap-2 px-2 py-0.5 rounded-full bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shadow-sm transition-all",title:"Letzte Datenbank-Antwortzeit",children:x>0?l.jsxs(l.Fragment,{children:[l.jsx(nx,{className:"w-3 h-3 animate-spin text-blue-500"}),l.jsx("span",{className:"text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:f("common.loading","Loading...")})]}):l.jsxs(l.Fragment,{children:[l.jsx(r0,{className:"w-3 h-3 text-emerald-500"}),l.jsxs("span",{className:"text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:[Math.round(w)," ms"]})]})}),x>0&&l.jsx("button",{type:"button",onClick:()=>{L()},className:"px-2 py-0.5 rounded-full bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shadow-sm text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider hover:text-rose-600 dark:hover:text-rose-400 hover:border-rose-300 dark:hover:border-rose-700 transition-colors",title:f("common.stop_sql","Stop"),children:f("common.stop_sql","Stop")})]}),l.jsxs("div",{className:"flex items-center gap-3 text-right",children:[s&&l.jsx("div",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:s}),s&&n&&n.length>0&&l.jsx("div",{className:"w-1 h-1 rounded-full bg-slate-300 dark:bg-slate-600"}),n&&n.length>0&&l.jsx("nav",{className:"flex items-center gap-1.5 text-[10px] uppercase font-black tracking-wider",children:n.map((M,T)=>l.jsxs(Wt.Fragment,{children:[T>0&&l.jsx("span",{className:"text-slate-300 dark:text-slate-600",children:"/"}),M.href||M.onClick?l.jsx("a",{href:M.href||"#",onClick:D=>{M.onClick&&(D.preventDefault(),M.onClick())},className:"text-slate-400 dark:text-slate-500 hover:text-blue-600 dark:hover:text-blue-400 transition-colors cursor-pointer",children:M.label}):l.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:M.label})]},T))})]})]})}),u&&Q&&l.jsx(HE,{isOpen:V,onClose:()=>U(!1),title:u.title,width:u.width,noScroll:u.noScroll,children:u.content})]})},MK="litebi-backup-location",c0="handles",m_="backup-directory-handle",x_="backup_saved_folder_label",Hf=typeof window<"u",b_=()=>new Promise((e,t)=>{const r=indexedDB.open(MK,1);r.onupgradeneeded=()=>{const a=r.result;a.objectStoreNames.contains(c0)||a.createObjectStore(c0)},r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)}),HK=async e=>{const t=await b_();await new Promise((r,a)=>{const s=t.transaction(c0,"readwrite");s.objectStore(c0).put(e,m_),s.oncomplete=()=>r(),s.onerror=()=>a(s.error),s.onabort=()=>a(s.error)})},PE=async()=>{const e=await b_();return await new Promise((t,r)=>{const s=e.transaction(c0,"readonly").objectStore(c0).get(m_);s.onsuccess=()=>t(s.result||null),s.onerror=()=>r(s.error)})},PK=async()=>{const e=await b_();await new Promise((t,r)=>{const a=e.transaction(c0,"readwrite");a.objectStore(c0).delete(m_),a.oncomplete=()=>t(),a.onerror=()=>r(a.error),a.onabort=()=>r(a.error)})},qK=async(e,t)=>!e.queryPermission||!e.requestPermission||await e.queryPermission({mode:t})==="granted"?!0:await e.requestPermission({mode:t})==="granted",tg=()=>Hf?typeof window.showDirectoryPicker=="function":!1,qE=()=>Hf&&localStorage.getItem(x_)||"",KK=async()=>{if(!Hf||!tg())return null;const e=window.showDirectoryPicker,t=await e();if(!t)return null;await HK(t);const r=t.name||"";return localStorage.setItem(x_,r),r},zK=async()=>{Hf&&(await PK(),localStorage.removeItem(x_))},VK=async(e,t)=>{if(!Hf||!tg())return!1;const r=await PE();if(!r||!r.getFileHandle||!await qK(r,"readwrite"))return!1;const s=await r.getFileHandle(t,{create:!0});if(!s?.createWritable)return!1;const n=await s.createWritable();return await n.write(e),await n.close(),!0},GK=async()=>{if(!Hf||!tg())return{file:null,cancelled:!1};const e=window.showOpenFilePicker;if(!e)return{file:null,cancelled:!1};const t=await PE();try{const r=await e({multiple:!1,startIn:t||void 0,types:[{description:"SQLite Backup",accept:{"application/x-sqlite3":[".sqlite3",".sqlite",".db"]}}]});return r?.length?{file:await r[0].getFile(),cancelled:!1}:{file:null,cancelled:!1}}catch(r){return(r instanceof DOMException?r.name:"")==="AbortError"?{file:null,cancelled:!0}:{file:null,cancelled:!1}}},WK=()=>{const{t:e,i18n:t}=ds(),r="1.2.0",a="20260228-0737",{theme:s,setTheme:n}=IK(),{isReadOnly:o,isAdminMode:c,setIsAdminMode:u}=So(),[f,h]=Wt.useState("appearance"),[g,x]=Wt.useState("datamanagement"),[m,w]=Wt.useState("datatable"),[v,B]=Wt.useState(!1),k=[{value:"light",label:e("settings.theme_light")},{value:"dark",label:e("settings.theme_dark")},{value:"system",label:e("settings.theme_system")}],[E,S]=Wt.useState(!!localStorage.getItem("litebistudio_app_pin")),[L,P]=Wt.useState(!1),[R,Q]=Wt.useState(""),[V,U]=Jt("data_inspector_page_size",100),[M,T]=Jt("data_inspector_show_profiling",!0),[D,G]=Jt("data_inspector_explain_mode",!1),[ne,H]=Jt("data_inspector_sql_assist_open",!1),[ee,le]=Jt("data_inspector_autocomplete_enabled",!0),[pe,te]=Jt("data_inspector_sql_require_limit_confirm",!0),[Le,je]=Jt("data_inspector_sql_max_rows",5e3),[F,K]=Jt("data_inspector_profiling_thresholds",{nullRate:30,cardinalityRate:95}),[I,q]=Jt("import_default_mode","append"),[J,Y]=Jt("import_auto_save_mappings",!0),[de,ue]=Jt("backup_file_name_pattern","backup_{date}_{mode}"),[we,Ie]=Jt("backup_use_saved_location",!0),[Ae,oe]=Jt("backup_saved_folder_label",""),[He,se]=Jt("health_snapshot_retention_days",90),[qe,Ye]=Jt("health_snapshot_keep_latest",200),[at,Ge]=Jt("reports_default_author","LiteBI Studio"),[pt,nt]=Jt("reports_default_theme_color","#1e293b"),[Dt,It]=Jt("reports_default_show_header",!0),[Ot,sr]=Jt("reports_default_show_footer",!0),[er,cr]=Jt("reports_default_include_audit_appendix",!1),[Vt,mt]=Jt("worklist_default_view","all"),[Nt,gt]=Jt("worklist_hide_completed",!1),[dr,Ht]=Jt("worklist_default_priority","normal"),[Rt,$t]=Jt("worklist_default_due_days",0),[vr,vt]=Jt("ui_table_density","normal"),[kr,tr]=Jt("ui_table_wrap_cells",!1),[rr,Xt]=Jt("data_table_default_show_filters",!1),[Kt,Ft]=Jt("notifications_confirm_destructive",!0),[Zt,wr]=Jt(w3,"error"),[Re,Et]=Jt("ui_sidebar_show_language_switch",!0),[Tt,Bt]=Jt("ui_sidebar_show_system_status",!0),Yt=async ce=>Kt?await Qt.confirm(ce):!0,Mr=async()=>{await Yt(e("settings.inspector_reset_layout_confirm"))&&(localStorage.removeItem("data_inspector_column_widths_v1"),localStorage.removeItem("data_inspector_saved_views"),localStorage.removeItem("data_inspector_active_view"),localStorage.removeItem("data_inspector_sql_editor_height"),await Qt.info(e("settings.inspector_reset_layout_done")))},Jr=async()=>{await Yt(e("settings.sql_workspace_reset_layout_confirm"))&&(localStorage.removeItem("sql_workspace_sql_editor_height"),await Qt.info(e("settings.sql_workspace_reset_layout_done")))},jr=async()=>{await Yt(e("settings.sql_workspace_reset_sql_confirm"))&&(localStorage.removeItem("data_inspector_sql_history"),localStorage.removeItem("data_inspector_favorite_queries"),localStorage.removeItem("data_inspector_custom_sql_templates"),localStorage.removeItem("data_inspector_selected_custom_template"),localStorage.removeItem("data_inspector_last_select_sql"),await Qt.info(e("settings.sql_workspace_reset_sql_done")))},fr=async()=>{if(R.length<4){await Qt.warning(e("settings.pin_error_min"));return}const ce=FK(),Fe=await QE(R,ce);localStorage.setItem("litebistudio_app_pin_salt",ce),localStorage.setItem("litebistudio_app_pin",Fe),S(!0),P(!1),Q(""),window.dispatchEvent(new Event("pin-changed")),await Qt.info(e("settings.pin_success"))},Cr=async()=>{await Qt.confirm(e("settings.pin_confirm_remove"))&&(localStorage.removeItem("litebistudio_app_pin"),localStorage.removeItem("litebistudio_app_pin_salt"),S(!1),window.dispatchEvent(new Event("pin-changed")))},re=new Date,ke=t.language.startsWith("de")?"de-DE":"en-US",me=tg(),be=e("settings.last_update",{date:re.toLocaleDateString(ke),time:re.toLocaleTimeString(ke,{hour:"2-digit",minute:"2-digit"})}),ye=async()=>{try{const ce=await KK();oe(ce||qE())}catch{await Qt.warning(e("settings.backup_folder_select_error","Folder could not be selected."))}},O=async()=>{await zK(),oe("")};return l.jsxs(x0,{header:{title:e("sidebar.settings"),subtitle:e("settings.subtitle")},rightPanel:{title:e("settings.quick_access_panel","Quick Access"),triggerTitle:e("settings.quick_access_open","Quick Access"),width:"sm",content:l.jsxs("div",{className:"space-y-4 text-sm",children:[l.jsx("p",{className:"text-slate-500",children:e("settings.quick_access_hint","Open frequently used sections without adding more controls to the main layout.")}),l.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[l.jsx("button",{type:"button",onClick:()=>h("appearance"),className:`px-3 py-2 rounded-lg text-left border transition-colors ${f==="appearance"?"border-blue-300 bg-blue-50 text-blue-700":"border-slate-200 bg-white text-slate-600 hover:bg-slate-50"}`,children:e("settings.tab_appearance")}),l.jsx("button",{type:"button",onClick:()=>h("security"),className:`px-3 py-2 rounded-lg text-left border transition-colors ${f==="security"?"border-blue-300 bg-blue-50 text-blue-700":"border-slate-200 bg-white text-slate-600 hover:bg-slate-50"}`,children:e("settings.tab_security")}),l.jsx("button",{type:"button",onClick:()=>{h("apps"),x("inspector")},className:`px-3 py-2 rounded-lg text-left border transition-colors ${f==="apps"?"border-blue-300 bg-blue-50 text-blue-700":"border-slate-200 bg-white text-slate-600 hover:bg-slate-50"}`,children:e("sidebar.data_inspector")}),l.jsx("button",{type:"button",onClick:()=>B(!0),className:"px-3 py-2 rounded-lg text-left border border-slate-200 bg-white text-slate-600 hover:bg-slate-50 transition-colors",children:e("settings.open_health_check","Open Health Check")})]})]})},footer:be,breadcrumbs:[{label:e("sidebar.settings")}],children:[l.jsxs("div",{className:"max-w-3xl space-y-6",children:[l.jsx("div",{className:"flex items-center justify-between border-b border-slate-200 dark:border-slate-800",children:l.jsx("div",{className:"flex items-center overflow-x-auto",children:[{id:"appearance",label:e("settings.tab_appearance")},{id:"security",label:e("settings.tab_security")},{id:"apps",label:e("settings.tab_apps","Apps")},{id:"controls",label:e("settings.tab_controls","Controls")},{id:"about",label:e("settings.tab_about")}].map(ce=>l.jsx("button",{onClick:()=>h(ce.id),className:`px-4 py-2.5 text-sm font-bold transition-all border-b-2 whitespace-nowrap ${f===ce.id?"text-blue-600 border-blue-600":"text-slate-400 hover:text-blue-600 border-transparent"}`,children:ce.label},ce.id))})}),f==="apps"&&l.jsx("div",{className:"flex items-center justify-between border-b border-slate-200 dark:border-slate-800 -mt-2",children:l.jsx("div",{className:"flex items-center overflow-x-auto",children:[{id:"datamanagement",label:e("sidebar.datasource")},{id:"inspector",label:e("sidebar.data_inspector")},{id:"sqlworkspace",label:e("sidebar.sql_workspace")},{id:"querybuilder",label:e("sidebar.query_builder")},{id:"reports",label:e("sidebar.reports")},{id:"worklist",label:e("sidebar.worklist")}].map(ce=>l.jsx("button",{onClick:()=>x(ce.id),className:`px-4 py-2 text-xs font-bold transition-all border-b-2 whitespace-nowrap ${g===ce.id?"text-blue-600 border-blue-600":"text-slate-400 hover:text-blue-600 border-transparent"}`,children:ce.label},ce.id))})}),f==="controls"&&l.jsx("div",{className:"flex items-center justify-between border-b border-slate-200 dark:border-slate-800 -mt-2",children:l.jsx("div",{className:"flex items-center overflow-x-auto",children:[{id:"datatable",label:e("settings.tab_datatable")},{id:"notifications",label:e("settings.tab_notifications")}].map(ce=>l.jsx("button",{onClick:()=>w(ce.id),className:`px-4 py-2 text-xs font-bold transition-all border-b-2 whitespace-nowrap ${m===ce.id?"text-blue-600 border-blue-600":"text-slate-400 hover:text-blue-600 border-transparent"}`,children:ce.label},ce.id))})}),f==="appearance"&&l.jsxs("div",{className:`space-y-4 transition-opacity ${o?"opacity-50 pointer-events-none":""}`,children:[l.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm",children:[l.jsxs("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[l.jsx("span",{className:"p-1.5 bg-slate-100 dark:bg-slate-700 rounded-lg",children:l.jsx(q8,{className:"w-4 h-4 text-blue-500"})}),e("settings.appearance")]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:e("settings.appearance_hint")}),l.jsx("div",{className:"grid grid-cols-3 gap-3",children:k.map(({value:ce,label:Fe})=>l.jsx("button",{onClick:()=>n(ce),className:`p-3 rounded-xl border flex flex-col items-center gap-2 transition-all ${s===ce?"bg-blue-50 border-blue-200 text-blue-700 dark:bg-blue-900/20 dark:border-blue-800 dark:text-blue-200 ring-2 ring-blue-500 ring-offset-2 dark:ring-offset-slate-800":"border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-700/50 text-slate-600 dark:text-slate-400"}`,children:l.jsx("span",{className:"text-sm font-medium",children:Fe})},ce))})]})]}),l.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm",children:[l.jsxs("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[l.jsx("span",{className:"p-1.5 bg-slate-100 dark:bg-slate-700 rounded-lg",children:l.jsx(wp,{className:"w-4 h-4 text-blue-500"})}),e("settings.language_panel_title")]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:e("settings.language_panel_hint")}),l.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold uppercase tracking-wider text-slate-500 mb-2",children:e("settings.language")}),l.jsxs("select",{value:t.language.startsWith("de")?"de":"en",onChange:ce=>{t.changeLanguage(ce.target.value)},className:"w-full px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200",children:[l.jsx("option",{value:"de",children:e("settings.language_de")}),l.jsx("option",{value:"en",children:e("settings.language_en")})]})]}),l.jsx("div",{className:"flex items-end",children:l.jsxs("label",{className:"w-full flex items-center justify-between rounded-xl border border-slate-200 dark:border-slate-700 px-3 py-2",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(wp,{className:"w-4 h-4 text-blue-500"}),l.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:e("settings.show_sidebar_language_switch")})]}),l.jsx("button",{type:"button",onClick:()=>{const ce=!Re;Et(ce),window.dispatchEvent(new CustomEvent("sidebar-language-visibility-changed",{detail:{visible:ce}}))},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${Re?"bg-blue-600":"bg-slate-300 dark:bg-slate-600"}`,"aria-pressed":Re,"aria-label":e("settings.show_sidebar_language_switch"),children:l.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${Re?"translate-x-6":"translate-x-1"}`})})]})})]})]})]}),l.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm",children:[l.jsxs("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[l.jsx("span",{className:"p-1.5 bg-slate-100 dark:bg-slate-700 rounded-lg",children:l.jsx(r0,{className:"w-4 h-4 text-blue-500"})}),e("settings.health_link_title")]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:e("settings.health_link_hint")}),l.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[l.jsxs("button",{onClick:()=>B(!0),className:"inline-flex items-center gap-2 px-3 py-2 text-sm font-semibold rounded-lg border border-blue-300 text-blue-700 dark:border-blue-700 dark:text-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors",children:[l.jsx(r0,{className:"w-4 h-4"}),e("settings.health_link_open")]}),l.jsxs("label",{className:"inline-flex items-center gap-3 rounded-xl border border-slate-200 dark:border-slate-700 px-3 py-2",children:[l.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:e("settings.show_sidebar_system_status")}),l.jsx("button",{type:"button",onClick:()=>{const ce=!Tt;Bt(ce),window.dispatchEvent(new CustomEvent("sidebar-system-status-visibility-changed",{detail:{visible:ce}}))},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${Tt?"bg-blue-600":"bg-slate-300 dark:bg-slate-600"}`,"aria-pressed":Tt,"aria-label":e("settings.show_sidebar_system_status"),children:l.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${Tt?"translate-x-6":"translate-x-1"}`})})]})]})]})]})]}),f==="security"&&l.jsxs("div",{className:`space-y-4 transition-opacity ${o?"opacity-50 pointer-events-none":""}`,children:[l.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm",children:[l.jsxs("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[l.jsx("span",{className:"p-1.5 bg-slate-100 dark:bg-slate-700 rounded-lg",children:l.jsx(H0,{className:"w-4 h-4 text-emerald-500"})}),e("settings.access_restriction_title")]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:e("settings.access_restriction_hint")}),!E&&!L&&l.jsxs("button",{onClick:()=>P(!0),className:"w-full h-12 border-2 border-dashed border-slate-300 dark:border-slate-600 rounded-xl flex items-center justify-center gap-2 text-slate-500 hover:border-blue-500 hover:text-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-all font-medium",children:[l.jsx(H0,{className:"w-4 h-4"}),e("settings.enable_pin")]}),L&&l.jsxs("div",{className:"flex items-center gap-2 animate-in fade-in slide-in-from-top-2",children:[l.jsx("input",{type:"password",inputMode:"numeric",pattern:"[0-9]*",placeholder:e("settings.pin_placeholder"),className:"flex-1 px-4 py-2 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none",value:R,onChange:ce=>Q(ce.target.value),autoFocus:!0}),l.jsx("button",{onClick:fr,className:"p-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors",title:e("common.save"),children:l.jsx(Yx,{className:"w-5 h-5"})}),l.jsx("button",{onClick:()=>{P(!1),Q("")},className:"p-2 bg-slate-200 dark:bg-slate-700 text-slate-600 dark:text-slate-300 rounded-lg hover:bg-slate-300 dark:hover:bg-slate-600 transition-colors",title:e("common.cancel"),children:l.jsx(vl,{className:"w-5 h-5"})})]}),E&&l.jsxs("div",{className:"flex items-center justify-between p-4 bg-emerald-50 dark:bg-emerald-900/10 border border-emerald-100 dark:border-emerald-900/30 rounded-xl",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-2 bg-emerald-100 dark:bg-emerald-900/30 rounded-full",children:l.jsx(H0,{className:"w-4 h-4 text-emerald-600 dark:text-emerald-400"})}),l.jsxs("div",{children:[l.jsx("div",{className:"font-semibold text-emerald-900 dark:text-emerald-100",children:e("settings.pin_active")}),l.jsx("div",{className:"text-xs text-emerald-700 dark:text-emerald-400",children:e("settings.pin_active_hint")})]})]}),l.jsx("button",{onClick:Cr,className:"p-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:e("common.remove"),children:l.jsx(ii,{className:"w-4 h-4"})})]})]})]}),l.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm",children:[l.jsxs("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[l.jsx("span",{className:"p-1.5 bg-slate-100 dark:bg-slate-700 rounded-lg",children:l.jsx(lk,{className:"w-4 h-4 text-amber-500"})}),e("settings.admin_mode")]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:e("settings.admin_mode_panel_hint")}),l.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-slate-200 dark:border-slate-700 px-3 py-2",children:[l.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:e("settings.admin_mode_hint")}),l.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[l.jsx("input",{type:"checkbox",className:"sr-only peer",checked:c,onChange:()=>u(!c)}),l.jsx("div",{className:"w-11 h-6 bg-slate-200 peer-focus:outline-none rounded-full peer dark:bg-slate-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-slate-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-slate-600 peer-checked:bg-amber-500"})]})]})]})]})]}),f==="apps"&&g==="inspector"&&l.jsxs("div",{className:`bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm transition-opacity ${o?"opacity-50 pointer-events-none":""}`,children:[l.jsxs("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[l.jsx("span",{className:"p-1.5 bg-slate-100 dark:bg-slate-700 rounded-lg",children:l.jsx(nf,{className:"w-4 h-4 text-blue-500"})}),e("settings.inspector_title")]}),l.jsxs("div",{className:"space-y-5",children:[l.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:e("settings.inspector_hint")}),l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:l.jsxs("label",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-200 dark:border-slate-700",children:[l.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:e("settings.inspector_profiling")}),l.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:M,onChange:()=>T(!M)})]})}),l.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-700 space-y-3",children:[l.jsx("label",{className:"block text-xs font-bold uppercase tracking-wider text-slate-500",children:e("settings.inspector_page_size")}),l.jsx("select",{value:String(V),onChange:ce=>U(Number(ce.target.value)),className:"w-full sm:w-52 p-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm",children:[50,100,250,500].map(ce=>l.jsx("option",{value:ce,children:ce},ce))})]}),l.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-700 space-y-4",children:[l.jsx("p",{className:"text-xs font-bold uppercase tracking-wider text-slate-500",children:e("settings.inspector_thresholds")}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[l.jsxs("label",{className:"space-y-1",children:[l.jsx("span",{className:"text-xs text-slate-500",children:e("settings.inspector_null_threshold")}),l.jsx("input",{type:"number",min:0,max:100,value:F.nullRate,onChange:ce=>{const Fe=Math.max(0,Math.min(100,Number(ce.target.value)||0));K({...F,nullRate:Fe})},className:"w-full p-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm"})]}),l.jsxs("label",{className:"space-y-1",children:[l.jsx("span",{className:"text-xs text-slate-500",children:e("settings.inspector_cardinality_threshold")}),l.jsx("input",{type:"number",min:0,max:100,value:F.cardinalityRate,onChange:ce=>{const Fe=Math.max(0,Math.min(100,Number(ce.target.value)||0));K({...F,cardinalityRate:Fe})},className:"w-full p-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm"})]})]})]}),l.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-700 space-y-3",children:[l.jsx("p",{className:"text-xs font-bold uppercase tracking-wider text-slate-500",children:e("settings.inspector_reset_title")}),l.jsx("div",{className:"flex flex-wrap gap-2",children:l.jsx("button",{type:"button",onClick:Mr,className:"px-3 py-2 rounded-lg border border-slate-300 dark:border-slate-600 text-xs font-semibold text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors",children:e("settings.inspector_reset_layout")})})]})]})]}),f==="apps"&&g==="sqlworkspace"&&l.jsxs("div",{className:`bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm transition-opacity ${o?"opacity-50 pointer-events-none":""}`,children:[l.jsxs("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[l.jsx("span",{className:"p-1.5 bg-slate-100 dark:bg-slate-700 rounded-lg",children:l.jsx(nf,{className:"w-4 h-4 text-blue-500"})}),e("settings.sql_workspace_title")]}),l.jsxs("div",{className:"space-y-5",children:[l.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:e("settings.sql_workspace_hint")}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[l.jsxs("label",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-200 dark:border-slate-700",children:[l.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:e("settings.sql_workspace_autocomplete")}),l.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:ee,onChange:()=>le(!ee)})]}),l.jsxs("label",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-200 dark:border-slate-700",children:[l.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:e("settings.sql_workspace_explain")}),l.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:D,onChange:()=>G(!D)})]}),l.jsxs("label",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-200 dark:border-slate-700",children:[l.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:e("settings.sql_workspace_assist")}),l.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:ne,onChange:()=>H(!ne)})]})]}),l.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-700 space-y-4",children:[l.jsx("p",{className:"text-xs font-bold uppercase tracking-wider text-slate-500",children:e("settings.sql_workspace_sql_safety")}),l.jsxs("label",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-200 dark:border-slate-700",children:[l.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:e("settings.sql_workspace_confirm_without_limit")}),l.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:pe,onChange:()=>te(!pe)})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"text-xs text-slate-500",children:e("settings.sql_workspace_max_rows")}),l.jsx("input",{type:"number",min:100,max:5e4,value:Le,onChange:ce=>{const Fe=Math.max(100,Math.min(5e4,Number(ce.target.value)||100));je(Fe)},className:"w-full sm:w-52 p-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm"})]})]}),l.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-700 space-y-3",children:[l.jsx("p",{className:"text-xs font-bold uppercase tracking-wider text-slate-500",children:e("settings.sql_workspace_reset_title")}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsx("button",{type:"button",onClick:Jr,className:"px-3 py-2 rounded-lg border border-slate-300 dark:border-slate-600 text-xs font-semibold text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors",children:e("settings.sql_workspace_reset_layout")}),l.jsx("button",{type:"button",onClick:jr,className:"px-3 py-2 rounded-lg border border-slate-300 dark:border-slate-600 text-xs font-semibold text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors",children:e("settings.sql_workspace_reset_sql")})]})]})]})]}),f==="apps"&&g==="querybuilder"&&l.jsxs("div",{className:`bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm transition-opacity ${o?"opacity-50 pointer-events-none":""}`,children:[l.jsxs("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[l.jsx("span",{className:"p-1.5 bg-slate-100 dark:bg-slate-700 rounded-lg",children:l.jsx(nf,{className:"w-4 h-4 text-blue-500"})}),e("settings.querybuilder_title")]}),l.jsxs("div",{className:"space-y-5",children:[l.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:e("settings.querybuilder_hint")}),l.jsx("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-700 text-sm text-slate-600 dark:text-slate-300",children:e("settings.querybuilder_no_tunable_options","Derzeit sind keine weiteren Widgets-spezifischen Optionen erforderlich.")})]})]}),f==="apps"&&g==="reports"&&l.jsxs("div",{className:`bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm transition-opacity ${o?"opacity-50 pointer-events-none":""}`,children:[l.jsxs("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[l.jsx("span",{className:"p-1.5 bg-slate-100 dark:bg-slate-700 rounded-lg",children:l.jsx(nf,{className:"w-4 h-4 text-blue-500"})}),e("settings.reports_title")]}),l.jsxs("div",{className:"space-y-5",children:[l.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:e("settings.reports_hint")}),l.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-700 space-y-3",children:[l.jsx("label",{className:"block text-xs font-bold uppercase tracking-wider text-slate-500",children:e("settings.reports_default_author")}),l.jsx("input",{value:at,onChange:ce=>Ge(ce.target.value),className:"w-full sm:w-80 p-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200"})]}),l.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-700 space-y-3",children:[l.jsx("label",{className:"block text-xs font-bold uppercase tracking-wider text-slate-500",children:e("settings.reports_default_theme_color")}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"color",value:pt,onChange:ce=>nt(ce.target.value),className:"h-9 w-14 p-1 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900"}),l.jsx("input",{value:pt,onChange:ce=>nt(ce.target.value),className:"w-full sm:w-40 p-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 font-mono"})]})]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[l.jsxs("label",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-200 dark:border-slate-700",children:[l.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:e("settings.reports_default_show_header")}),l.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:Dt,onChange:()=>It(!Dt)})]}),l.jsxs("label",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-200 dark:border-slate-700",children:[l.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:e("settings.reports_default_show_footer")}),l.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:Ot,onChange:()=>sr(!Ot)})]})]}),l.jsxs("label",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-200 dark:border-slate-700",children:[l.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:e("settings.reports_default_include_audit")}),l.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:er,onChange:()=>cr(!er)})]}),l.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:e("settings.reports_defaults_apply_hint")})]})]}),f==="apps"&&g==="worklist"&&l.jsxs("div",{className:`bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm transition-opacity ${o?"opacity-50 pointer-events-none":""}`,children:[l.jsxs("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[l.jsx("span",{className:"p-1.5 bg-slate-100 dark:bg-slate-700 rounded-lg",children:l.jsx(nf,{className:"w-4 h-4 text-blue-500"})}),e("settings.worklist_title")]}),l.jsxs("div",{className:"space-y-5",children:[l.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:e("settings.worklist_hint")}),l.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-700 space-y-3",children:[l.jsx("label",{className:"block text-xs font-bold uppercase tracking-wider text-slate-500",children:e("settings.worklist_default_view")}),l.jsxs("select",{value:Vt,onChange:ce=>mt(ce.target.value),className:"w-full sm:w-60 p-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200",children:[l.jsx("option",{value:"all",children:e("worklist.filter_all")}),l.jsx("option",{value:"open",children:e("worklist.filter_open")}),l.jsx("option",{value:"overdue",children:e("worklist.quick_overdue")}),l.jsx("option",{value:"today",children:e("worklist.quick_today")}),l.jsx("option",{value:"high_priority",children:e("worklist.quick_high_priority")})]})]}),l.jsxs("label",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-200 dark:border-slate-700",children:[l.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:e("settings.worklist_hide_completed")}),l.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:Nt,onChange:()=>gt(!Nt)})]}),l.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-700 space-y-3",children:[l.jsx("label",{className:"block text-xs font-bold uppercase tracking-wider text-slate-500",children:e("settings.worklist_default_priority")}),l.jsxs("select",{value:dr,onChange:ce=>Ht(ce.target.value),className:"w-full sm:w-60 p-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200",children:[l.jsx("option",{value:"low",children:e("worklist.priority_low")}),l.jsx("option",{value:"normal",children:e("worklist.priority_normal")}),l.jsx("option",{value:"high",children:e("worklist.priority_high")}),l.jsx("option",{value:"critical",children:e("worklist.priority_critical")})]})]}),l.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-700 space-y-3",children:[l.jsx("label",{className:"block text-xs font-bold uppercase tracking-wider text-slate-500",children:e("settings.worklist_default_due_days")}),l.jsx("input",{type:"number",min:0,max:365,value:Rt,onChange:ce=>{const Fe=Math.max(0,Math.min(365,Number(ce.target.value)||0));$t(Fe)},className:"w-full sm:w-40 p-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200"}),l.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:e("settings.worklist_default_due_days_hint")})]})]})]}),f==="apps"&&g==="datamanagement"&&l.jsxs("div",{className:`space-y-6 transition-opacity ${o?"opacity-50 pointer-events-none":""}`,children:[l.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm space-y-5",children:[l.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:e("settings.import_title")}),l.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:e("settings.import_hint")}),l.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-700 space-y-3",children:[l.jsx("label",{className:"block text-xs font-bold uppercase tracking-wider text-slate-500",children:e("settings.import_default_mode")}),l.jsxs("select",{value:I,onChange:ce=>q(ce.target.value),className:"w-full sm:w-52 p-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm",children:[l.jsx("option",{value:"append",children:e("datasource.excel_import.append")}),l.jsx("option",{value:"overwrite",children:e("datasource.excel_import.overwrite")})]})]}),l.jsxs("label",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-200 dark:border-slate-700",children:[l.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:e("settings.import_auto_save_mappings")}),l.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:J,onChange:()=>Y(!J)})]})]}),l.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm space-y-5",children:[l.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:e("datasource.backup_restore")}),l.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:e("settings.backup_hint","Defaults for backup and restore behavior.")}),l.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-700 space-y-3",children:[l.jsx("label",{className:"block text-xs font-bold uppercase tracking-wider text-slate-500",children:e("settings.backup_name_pattern","Backup filename pattern")}),l.jsx("input",{value:de,onChange:ce=>ue(ce.target.value),placeholder:"backup_{date}_{mode}",className:"w-full sm:w-[28rem] p-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm"}),l.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:e("settings.backup_name_pattern_hint","Tokens: {date}, {time}, {datetime}, {mode}.")})]}),l.jsxs("label",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-200 dark:border-slate-700",children:[l.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:e("settings.backup_use_saved_location","Use saved backup folder")}),l.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:we,onChange:()=>Ie(!we)})]}),l.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 -mt-2",children:e("settings.backup_use_saved_location_hint","Default: try the selected backup folder first, then fall back to file picker.")}),l.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-700 space-y-3",children:[l.jsx("label",{className:"block text-xs font-bold uppercase tracking-wider text-slate-500",children:e("settings.backup_folder","Backup folder")}),me?l.jsxs(l.Fragment,{children:[l.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-200",children:Ae||e("settings.backup_folder_none","No folder selected")}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{type:"button",onClick:()=>{ye()},className:"px-3 py-1.5 text-xs font-semibold rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-700 dark:text-slate-200",children:e("settings.backup_folder_choose","Choose folder")}),l.jsx("button",{type:"button",onClick:()=>{O()},className:"px-3 py-1.5 text-xs font-semibold rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",children:e("common.clear","Clear")})]})]}):l.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:e("settings.backup_folder_not_supported","Your browser does not support persistent folder access.")})]}),l.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-700 space-y-3",children:[l.jsx("p",{className:"text-xs font-bold uppercase tracking-wider text-slate-500",children:e("settings.health_snapshot_retention_title","Health snapshot retention")}),l.jsxs("div",{className:"flex flex-wrap items-end gap-4",children:[l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"block text-xs text-slate-500",children:e("settings.health_snapshot_retention_days","Delete older than (days)")}),l.jsx("input",{type:"number",min:1,max:3650,value:He,onChange:ce=>{const Fe=Math.max(1,Math.min(3650,Number(ce.target.value)||1));se(Fe)},className:"w-40 p-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200"})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"block text-xs text-slate-500",children:e("settings.health_snapshot_keep_latest","Always keep latest")}),l.jsx("input",{type:"number",min:0,max:1e4,value:qe,onChange:ce=>{const Fe=Math.max(0,Math.min(1e4,Number(ce.target.value)||0));Ye(Fe)},className:"w-40 p-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200"})]})]}),l.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:e("settings.health_snapshot_retention_hint","Used by the cleanup action in the Health Check overview.")})]})]})]}),f==="controls"&&m==="datatable"&&l.jsxs("div",{className:`bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm transition-opacity ${o?"opacity-50 pointer-events-none":""}`,children:[l.jsxs("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[l.jsx("span",{className:"p-1.5 bg-slate-100 dark:bg-slate-700 rounded-lg",children:l.jsx(GS,{className:"w-4 h-4 text-blue-500"})}),e("settings.datatable_title")]}),l.jsxs("div",{className:"space-y-5",children:[l.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:e("settings.datatable_hint")}),l.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-700 space-y-3",children:[l.jsx("label",{className:"block text-xs font-bold uppercase tracking-wider text-slate-500",children:e("settings.datatable_density")}),l.jsxs("select",{value:vr,onChange:ce=>vt(ce.target.value),className:"w-full sm:w-52 p-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm",children:[l.jsx("option",{value:"normal",children:e("settings.datatable_density_normal")}),l.jsx("option",{value:"compact",children:e("settings.datatable_density_compact")})]})]}),l.jsxs("label",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-200 dark:border-slate-700",children:[l.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:e("settings.datatable_wrap_cells")}),l.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:kr,onChange:()=>tr(!kr)})]}),l.jsxs("label",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-200 dark:border-slate-700",children:[l.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:e("settings.datatable_default_filters")}),l.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:rr,onChange:()=>Xt(!rr)})]})]})]}),f==="controls"&&m==="notifications"&&l.jsxs("div",{className:`bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm transition-opacity ${o?"opacity-50 pointer-events-none":""}`,children:[l.jsxs("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[l.jsx("span",{className:"p-1.5 bg-slate-100 dark:bg-slate-700 rounded-lg",children:l.jsx(K8,{className:"w-4 h-4 text-blue-500"})}),e("settings.notifications_title")]}),l.jsxs("div",{className:"space-y-5",children:[l.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:e("settings.notifications_hint")}),l.jsxs("label",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-200 dark:border-slate-700",children:[l.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:e("settings.notifications_confirm_destructive")}),l.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:Kt,onChange:()=>Ft(!Kt)})]}),l.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-700 space-y-3",children:[l.jsx("label",{className:"block text-xs font-bold uppercase tracking-wider text-slate-500",children:e("settings.log_level")}),l.jsxs("select",{value:Zt,onChange:ce=>{const Fe=ce.target.value;wr(Fe),window.dispatchEvent(new CustomEvent("app-log-level-changed",{detail:{level:Fe}}))},className:"w-full sm:w-52 p-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm",children:[l.jsx("option",{value:"off",children:e("settings.log_level_off")}),l.jsx("option",{value:"error",children:e("settings.log_level_error")}),l.jsx("option",{value:"warn",children:e("settings.log_level_warn")}),l.jsx("option",{value:"info",children:e("settings.log_level_info")}),l.jsx("option",{value:"debug",children:e("settings.log_level_debug")})]})]})]})]}),f==="about"&&l.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm",children:[l.jsxs("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[l.jsx("span",{className:"p-1.5 bg-slate-100 dark:bg-slate-700 rounded-lg",children:l.jsx(iu,{className:"w-4 h-4 text-blue-500"})}),e("about.title","About LiteBI Studio")]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:e("about.settings_hint","Learn more about the project, the version and the vision behind LiteBI Studio.")}),l.jsxs(F8,{to:"/about",className:"w-full flex items-center justify-between p-4 bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-700 rounded-xl hover:bg-slate-100 dark:hover:bg-slate-700 transition-all group",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:l.jsx(lk,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"})}),l.jsxs("div",{children:[l.jsx("div",{className:"font-semibold text-slate-900 dark:text-white",children:e("about.view_info","Project Information")}),l.jsxs("div",{className:"mt-1 flex items-center gap-2 text-xs text-slate-500 dark:text-slate-400",children:[l.jsxs("span",{children:["Version ",r]}),l.jsx("span",{className:"text-slate-300 dark:text-slate-600",children:"|"}),l.jsxs("span",{children:["Build ",a]})]})]})]}),l.jsx(Yl,{className:"w-5 h-5 text-slate-400 group-hover:text-blue-500 transition-colors"})]})]})]})]}),l.jsx(g_,{isOpen:v,onClose:()=>B(!1)})]})},$K=()=>l.jsx(WK,{}),KE=6048e5,XK=864e5,YK=6e4,JK=36e5,ZK=1e3,rB=Symbol.for("constructDateFrom");function Ci(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&rB in e?e[rB](t):e instanceof Date?new e.constructor(t):new Date(t)}function zn(e,t){return Ci(t||e,e)}function zE(e,t,r){const a=zn(e,r?.in);return isNaN(t)?Ci(r?.in||e,NaN):(t&&a.setDate(a.getDate()+t),a)}let ez={};function Pf(){return ez}function u0(e,t){const r=Pf(),a=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,s=zn(e,t?.in),n=s.getDay(),o=(n<a?7:0)+n-a;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function Uf(e,t){return u0(e,{...t,weekStartsOn:1})}function VE(e,t){const r=zn(e,t?.in),a=r.getFullYear(),s=Ci(r,0);s.setFullYear(a+1,0,4),s.setHours(0,0,0,0);const n=Uf(s),o=Ci(r,0);o.setFullYear(a,0,4),o.setHours(0,0,0,0);const c=Uf(o);return r.getTime()>=n.getTime()?a+1:r.getTime()>=c.getTime()?a:a-1}function Ex(e){const t=zn(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function tz(e,...t){const r=Ci.bind(null,t.find(a=>typeof a=="object"));return t.map(r)}function aB(e,t){const r=zn(e,t?.in);return r.setHours(0,0,0,0),r}function rz(e,t,r){const[a,s]=tz(r?.in,e,t),n=aB(a),o=aB(s),c=+n-Ex(n),u=+o-Ex(o);return Math.round((c-u)/XK)}function az(e,t){const r=VE(e,t),a=Ci(e,0);return a.setFullYear(r,0,4),a.setHours(0,0,0,0),Uf(a)}function sz(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Tw(e){return!(!sz(e)&&typeof e!="number"||isNaN(+zn(e)))}function nz(e,t){const r=zn(e,t?.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const iz={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},lz=(e,t,r)=>{let a;const s=iz[e];return typeof s=="string"?a=s:t===1?a=s.one:a=s.other.replace("{{count}}",t.toString()),r?.addSuffix?r.comparison&&r.comparison>0?"in "+a:a+" ago":a};function fv(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const oz={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Az={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},cz={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},uz={date:fv({formats:oz,defaultWidth:"full"}),time:fv({formats:Az,defaultWidth:"full"}),dateTime:fv({formats:cz,defaultWidth:"full"})},dz={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},fz=(e,t,r,a)=>dz[e];function Lh(e){return(t,r)=>{const a=r?.context?String(r.context):"standalone";let s;if(a==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,c=r?.width?String(r.width):o;s=e.formattingValues[c]||e.formattingValues[o]}else{const o=e.defaultWidth,c=r?.width?String(r.width):e.defaultWidth;s=e.values[c]||e.values[o]}const n=e.argumentCallback?e.argumentCallback(t):t;return s[n]}}const hz={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},pz={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},gz={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},mz={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},xz={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},bz={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},vz=(e,t)=>{const r=Number(e),a=r%100;if(a>20||a<10)switch(a%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},wz={ordinalNumber:vz,era:Lh({values:hz,defaultWidth:"wide"}),quarter:Lh({values:pz,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Lh({values:gz,defaultWidth:"wide"}),day:Lh({values:mz,defaultWidth:"wide"}),dayPeriod:Lh({values:xz,defaultWidth:"wide",formattingValues:bz,defaultFormattingWidth:"wide"})};function jh(e){return(t,r={})=>{const a=r.width,s=a&&e.matchPatterns[a]||e.matchPatterns[e.defaultMatchWidth],n=t.match(s);if(!n)return null;const o=n[0],c=a&&e.parsePatterns[a]||e.parsePatterns[e.defaultParseWidth],u=Array.isArray(c)?yz(c,g=>g.test(o)):_z(c,g=>g.test(o));let f;f=e.valueCallback?e.valueCallback(u):u,f=r.valueCallback?r.valueCallback(f):f;const h=t.slice(o.length);return{value:f,rest:h}}}function _z(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function yz(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function kz(e){return(t,r={})=>{const a=t.match(e.matchPattern);if(!a)return null;const s=a[0],n=t.match(e.parsePattern);if(!n)return null;let o=e.valueCallback?e.valueCallback(n[0]):n[0];o=r.valueCallback?r.valueCallback(o):o;const c=t.slice(s.length);return{value:o,rest:c}}}const Bz=/^(\d+)(th|st|nd|rd)?/i,Cz=/\d+/i,Sz={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Nz={any:[/^b/i,/^(a|c)/i]},Ez={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Fz={any:[/1/i,/2/i,/3/i,/4/i]},Tz={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Lz={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},jz={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Uz={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Dz={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Iz={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Qz={ordinalNumber:kz({matchPattern:Bz,parsePattern:Cz,valueCallback:e=>parseInt(e,10)}),era:jh({matchPatterns:Sz,defaultMatchWidth:"wide",parsePatterns:Nz,defaultParseWidth:"any"}),quarter:jh({matchPatterns:Ez,defaultMatchWidth:"wide",parsePatterns:Fz,defaultParseWidth:"any",valueCallback:e=>e+1}),month:jh({matchPatterns:Tz,defaultMatchWidth:"wide",parsePatterns:Lz,defaultParseWidth:"any"}),day:jh({matchPatterns:jz,defaultMatchWidth:"wide",parsePatterns:Uz,defaultParseWidth:"any"}),dayPeriod:jh({matchPatterns:Dz,defaultMatchWidth:"any",parsePatterns:Iz,defaultParseWidth:"any"})},GE={code:"en-US",formatDistance:lz,formatLong:uz,formatRelative:fz,localize:wz,match:Qz,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Oz(e,t){const r=zn(e,t?.in);return rz(r,nz(r))+1}function WE(e,t){const r=zn(e,t?.in),a=+Uf(r)-+az(r);return Math.round(a/KE)+1}function v_(e,t){const r=zn(e,t?.in),a=r.getFullYear(),s=Pf(),n=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,o=Ci(t?.in||e,0);o.setFullYear(a+1,0,n),o.setHours(0,0,0,0);const c=u0(o,t),u=Ci(t?.in||e,0);u.setFullYear(a,0,n),u.setHours(0,0,0,0);const f=u0(u,t);return+r>=+c?a+1:+r>=+f?a:a-1}function Rz(e,t){const r=Pf(),a=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,s=v_(e,t),n=Ci(t?.in||e,0);return n.setFullYear(s,0,a),n.setHours(0,0,0,0),u0(n,t)}function $E(e,t){const r=zn(e,t?.in),a=+u0(r,t)-+Rz(r,t);return Math.round(a/KE)+1}function $a(e,t){const r=e<0?"-":"",a=Math.abs(e).toString().padStart(t,"0");return r+a}const Ru={y(e,t){const r=e.getFullYear(),a=r>0?r:1-r;return $a(t==="yy"?a%100:a,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):$a(r+1,2)},d(e,t){return $a(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];default:return r==="am"?"a.m.":"p.m."}},h(e,t){return $a(e.getHours()%12||12,t.length)},H(e,t){return $a(e.getHours(),t.length)},m(e,t){return $a(e.getMinutes(),t.length)},s(e,t){return $a(e.getSeconds(),t.length)},S(e,t){const r=t.length,a=e.getMilliseconds(),s=Math.trunc(a*Math.pow(10,r-3));return $a(s,t.length)}},Vd={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},sB={G:function(e,t,r){const a=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(a,{width:"abbreviated"});case"GGGGG":return r.era(a,{width:"narrow"});default:return r.era(a,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const a=e.getFullYear(),s=a>0?a:1-a;return r.ordinalNumber(s,{unit:"year"})}return Ru.y(e,t)},Y:function(e,t,r,a){const s=v_(e,a),n=s>0?s:1-s;if(t==="YY"){const o=n%100;return $a(o,2)}return t==="Yo"?r.ordinalNumber(n,{unit:"year"}):$a(n,t.length)},R:function(e,t){const r=VE(e);return $a(r,t.length)},u:function(e,t){const r=e.getFullYear();return $a(r,t.length)},Q:function(e,t,r){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(a);case"QQ":return $a(a,2);case"Qo":return r.ordinalNumber(a,{unit:"quarter"});case"QQQ":return r.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(a,{width:"narrow",context:"formatting"});default:return r.quarter(a,{width:"wide",context:"formatting"})}},q:function(e,t,r){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(a);case"qq":return $a(a,2);case"qo":return r.ordinalNumber(a,{unit:"quarter"});case"qqq":return r.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(a,{width:"narrow",context:"standalone"});default:return r.quarter(a,{width:"wide",context:"standalone"})}},M:function(e,t,r){const a=e.getMonth();switch(t){case"M":case"MM":return Ru.M(e,t);case"Mo":return r.ordinalNumber(a+1,{unit:"month"});case"MMM":return r.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(a,{width:"narrow",context:"formatting"});default:return r.month(a,{width:"wide",context:"formatting"})}},L:function(e,t,r){const a=e.getMonth();switch(t){case"L":return String(a+1);case"LL":return $a(a+1,2);case"Lo":return r.ordinalNumber(a+1,{unit:"month"});case"LLL":return r.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(a,{width:"narrow",context:"standalone"});default:return r.month(a,{width:"wide",context:"standalone"})}},w:function(e,t,r,a){const s=$E(e,a);return t==="wo"?r.ordinalNumber(s,{unit:"week"}):$a(s,t.length)},I:function(e,t,r){const a=WE(e);return t==="Io"?r.ordinalNumber(a,{unit:"week"}):$a(a,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Ru.d(e,t)},D:function(e,t,r){const a=Oz(e);return t==="Do"?r.ordinalNumber(a,{unit:"dayOfYear"}):$a(a,t.length)},E:function(e,t,r){const a=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(a,{width:"short",context:"formatting"});default:return r.day(a,{width:"wide",context:"formatting"})}},e:function(e,t,r,a){const s=e.getDay(),n=(s-a.weekStartsOn+8)%7||7;switch(t){case"e":return String(n);case"ee":return $a(n,2);case"eo":return r.ordinalNumber(n,{unit:"day"});case"eee":return r.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(s,{width:"short",context:"formatting"});default:return r.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,r,a){const s=e.getDay(),n=(s-a.weekStartsOn+8)%7||7;switch(t){case"c":return String(n);case"cc":return $a(n,t.length);case"co":return r.ordinalNumber(n,{unit:"day"});case"ccc":return r.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(s,{width:"narrow",context:"standalone"});case"cccccc":return r.day(s,{width:"short",context:"standalone"});default:return r.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,r){const a=e.getDay(),s=a===0?7:a;switch(t){case"i":return String(s);case"ii":return $a(s,t.length);case"io":return r.ordinalNumber(s,{unit:"day"});case"iii":return r.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(a,{width:"short",context:"formatting"});default:return r.day(a,{width:"wide",context:"formatting"})}},a:function(e,t,r){const s=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,r){const a=e.getHours();let s;switch(a===12?s=Vd.noon:a===0?s=Vd.midnight:s=a/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,r){const a=e.getHours();let s;switch(a>=17?s=Vd.evening:a>=12?s=Vd.afternoon:a>=4?s=Vd.morning:s=Vd.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let a=e.getHours()%12;return a===0&&(a=12),r.ordinalNumber(a,{unit:"hour"})}return Ru.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Ru.H(e,t)},K:function(e,t,r){const a=e.getHours()%12;return t==="Ko"?r.ordinalNumber(a,{unit:"hour"}):$a(a,t.length)},k:function(e,t,r){let a=e.getHours();return a===0&&(a=24),t==="ko"?r.ordinalNumber(a,{unit:"hour"}):$a(a,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Ru.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Ru.s(e,t)},S:function(e,t){return Ru.S(e,t)},X:function(e,t,r){const a=e.getTimezoneOffset();if(a===0)return"Z";switch(t){case"X":return iB(a);case"XXXX":case"XX":return T0(a);default:return T0(a,":")}},x:function(e,t,r){const a=e.getTimezoneOffset();switch(t){case"x":return iB(a);case"xxxx":case"xx":return T0(a);default:return T0(a,":")}},O:function(e,t,r){const a=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+nB(a,":");default:return"GMT"+T0(a,":")}},z:function(e,t,r){const a=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+nB(a,":");default:return"GMT"+T0(a,":")}},t:function(e,t,r){const a=Math.trunc(+e/1e3);return $a(a,t.length)},T:function(e,t,r){return $a(+e,t.length)}};function nB(e,t=""){const r=e>0?"-":"+",a=Math.abs(e),s=Math.trunc(a/60),n=a%60;return n===0?r+String(s):r+String(s)+t+$a(n,2)}function iB(e,t){return e%60===0?(e>0?"-":"+")+$a(Math.abs(e)/60,2):T0(e,t)}function T0(e,t=""){const r=e>0?"-":"+",a=Math.abs(e),s=$a(Math.trunc(a/60),2),n=$a(a%60,2);return r+s+t+n}const lB=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},XE=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},Mz=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],a=r[1],s=r[2];if(!s)return lB(e,t);let n;switch(a){case"P":n=t.dateTime({width:"short"});break;case"PP":n=t.dateTime({width:"medium"});break;case"PPP":n=t.dateTime({width:"long"});break;default:n=t.dateTime({width:"full"});break}return n.replace("{{date}}",lB(a,t)).replace("{{time}}",XE(s,t))},Lw={p:XE,P:Mz},Hz=/^D+$/,Pz=/^Y+$/,qz=["D","DD","YY","YYYY"];function YE(e){return Hz.test(e)}function JE(e){return Pz.test(e)}function jw(e,t,r){const a=Kz(e,t,r);if(console.warn(a),qz.includes(e))throw new RangeError(a)}function Kz(e,t,r){const a=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${a} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const zz=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Vz=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Gz=/^'([^]*?)'?$/,Wz=/''/g,$z=/[a-zA-Z]/;function hv(e,t,r){const a=Pf(),s=a.locale??GE,n=a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,o=a.weekStartsOn??a.locale?.options?.weekStartsOn??0,c=zn(e,r?.in);if(!Tw(c))throw new RangeError("Invalid time value");let u=t.match(Vz).map(h=>{const g=h[0];if(g==="p"||g==="P"){const x=Lw[g];return x(h,s.formatLong)}return h}).join("").match(zz).map(h=>{if(h==="''")return{isToken:!1,value:"'"};const g=h[0];if(g==="'")return{isToken:!1,value:Xz(h)};if(sB[g])return{isToken:!0,value:h};if(g.match($z))throw new RangeError("Format string contains an unescaped latin alphabet character `"+g+"`");return{isToken:!1,value:h}});s.localize.preprocessor&&(u=s.localize.preprocessor(c,u));const f={firstWeekContainsDate:n,weekStartsOn:o,locale:s};return u.map(h=>{if(!h.isToken)return h.value;const g=h.value;(JE(g)||YE(g))&&jw(g,t,String(e));const x=sB[g[0]];return x(c,g,s.localize,f)}).join("")}function Xz(e){const t=e.match(Gz);return t?t[1].replace(Wz,"'"):e}function Yz(){return Object.assign({},Pf())}function Jz(e,t){const r=zn(e,t?.in).getDay();return r===0?7:r}function Zz(e,t){const r=eV(t)?new t(0):Ci(t,0);return r.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),r.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),r}function eV(e){return typeof e=="function"&&e.prototype?.constructor===e}const tV=10;class ZE{subPriority=0;validate(t,r){return!0}}class rV extends ZE{constructor(t,r,a,s,n){super(),this.value=t,this.validateValue=r,this.setValue=a,this.priority=s,n&&(this.subPriority=n)}validate(t,r){return this.validateValue(t,this.value,r)}set(t,r,a){return this.setValue(t,r,this.value,a)}}class aV extends ZE{priority=tV;subPriority=-1;constructor(t,r){super(),this.context=t||(a=>Ci(r,a))}set(t,r){return r.timestampIsSet?t:Ci(t,Zz(t,this.context))}}let Ha=class{run(t,r,a,s){const n=this.parse(t,r,a,s);return n?{setter:new rV(n.value,this.validate,this.set,this.priority,this.subPriority),rest:n.rest}:null}validate(t,r,a){return!0}};class sV extends Ha{priority=140;parse(t,r,a){switch(r){case"G":case"GG":case"GGG":return a.era(t,{width:"abbreviated"})||a.era(t,{width:"narrow"});case"GGGGG":return a.era(t,{width:"narrow"});default:return a.era(t,{width:"wide"})||a.era(t,{width:"abbreviated"})||a.era(t,{width:"narrow"})}}set(t,r,a){return r.era=a,t.setFullYear(a,0,1),t.setHours(0,0,0,0),t}incompatibleTokens=["R","u","t","T"]}const Sn={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},vc={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function Nn(e,t){return e&&{value:t(e.value),rest:e.rest}}function Ws(e,t){const r=t.match(e);return r?{value:parseInt(r[0],10),rest:t.slice(r[0].length)}:null}function wc(e,t){const r=t.match(e);if(!r)return null;if(r[0]==="Z")return{value:0,rest:t.slice(1)};const a=r[1]==="+"?1:-1,s=r[2]?parseInt(r[2],10):0,n=r[3]?parseInt(r[3],10):0,o=r[5]?parseInt(r[5],10):0;return{value:a*(s*JK+n*YK+o*ZK),rest:t.slice(r[0].length)}}function eF(e){return Ws(Sn.anyDigitsSigned,e)}function dn(e,t){switch(e){case 1:return Ws(Sn.singleDigit,t);case 2:return Ws(Sn.twoDigits,t);case 3:return Ws(Sn.threeDigits,t);case 4:return Ws(Sn.fourDigits,t);default:return Ws(new RegExp("^\\d{1,"+e+"}"),t)}}function Fx(e,t){switch(e){case 1:return Ws(Sn.singleDigitSigned,t);case 2:return Ws(Sn.twoDigitsSigned,t);case 3:return Ws(Sn.threeDigitsSigned,t);case 4:return Ws(Sn.fourDigitsSigned,t);default:return Ws(new RegExp("^-?\\d{1,"+e+"}"),t)}}function w_(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;default:return 0}}function tF(e,t){const r=t>0,a=r?t:1-t;let s;if(a<=50)s=e||100;else{const n=a+50,o=Math.trunc(n/100)*100,c=e>=n%100;s=e+o-(c?100:0)}return r?s:1-s}function rF(e){return e%400===0||e%4===0&&e%100!==0}class nV extends Ha{priority=130;incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"];parse(t,r,a){const s=n=>({year:n,isTwoDigitYear:r==="yy"});switch(r){case"y":return Nn(dn(4,t),s);case"yo":return Nn(a.ordinalNumber(t,{unit:"year"}),s);default:return Nn(dn(r.length,t),s)}}validate(t,r){return r.isTwoDigitYear||r.year>0}set(t,r,a){const s=t.getFullYear();if(a.isTwoDigitYear){const o=tF(a.year,s);return t.setFullYear(o,0,1),t.setHours(0,0,0,0),t}const n=!("era"in r)||r.era===1?a.year:1-a.year;return t.setFullYear(n,0,1),t.setHours(0,0,0,0),t}}class iV extends Ha{priority=130;parse(t,r,a){const s=n=>({year:n,isTwoDigitYear:r==="YY"});switch(r){case"Y":return Nn(dn(4,t),s);case"Yo":return Nn(a.ordinalNumber(t,{unit:"year"}),s);default:return Nn(dn(r.length,t),s)}}validate(t,r){return r.isTwoDigitYear||r.year>0}set(t,r,a,s){const n=v_(t,s);if(a.isTwoDigitYear){const c=tF(a.year,n);return t.setFullYear(c,0,s.firstWeekContainsDate),t.setHours(0,0,0,0),u0(t,s)}const o=!("era"in r)||r.era===1?a.year:1-a.year;return t.setFullYear(o,0,s.firstWeekContainsDate),t.setHours(0,0,0,0),u0(t,s)}incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]}class lV extends Ha{priority=130;parse(t,r){return Fx(r==="R"?4:r.length,t)}set(t,r,a){const s=Ci(t,0);return s.setFullYear(a,0,4),s.setHours(0,0,0,0),Uf(s)}incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]}class oV extends Ha{priority=130;parse(t,r){return Fx(r==="u"?4:r.length,t)}set(t,r,a){return t.setFullYear(a,0,1),t.setHours(0,0,0,0),t}incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]}class AV extends Ha{priority=120;parse(t,r,a){switch(r){case"Q":case"QQ":return dn(r.length,t);case"Qo":return a.ordinalNumber(t,{unit:"quarter"});case"QQQ":return a.quarter(t,{width:"abbreviated",context:"formatting"})||a.quarter(t,{width:"narrow",context:"formatting"});case"QQQQQ":return a.quarter(t,{width:"narrow",context:"formatting"});default:return a.quarter(t,{width:"wide",context:"formatting"})||a.quarter(t,{width:"abbreviated",context:"formatting"})||a.quarter(t,{width:"narrow",context:"formatting"})}}validate(t,r){return r>=1&&r<=4}set(t,r,a){return t.setMonth((a-1)*3,1),t.setHours(0,0,0,0),t}incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]}class cV extends Ha{priority=120;parse(t,r,a){switch(r){case"q":case"qq":return dn(r.length,t);case"qo":return a.ordinalNumber(t,{unit:"quarter"});case"qqq":return a.quarter(t,{width:"abbreviated",context:"standalone"})||a.quarter(t,{width:"narrow",context:"standalone"});case"qqqqq":return a.quarter(t,{width:"narrow",context:"standalone"});default:return a.quarter(t,{width:"wide",context:"standalone"})||a.quarter(t,{width:"abbreviated",context:"standalone"})||a.quarter(t,{width:"narrow",context:"standalone"})}}validate(t,r){return r>=1&&r<=4}set(t,r,a){return t.setMonth((a-1)*3,1),t.setHours(0,0,0,0),t}incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]}class uV extends Ha{incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"];priority=110;parse(t,r,a){const s=n=>n-1;switch(r){case"M":return Nn(Ws(Sn.month,t),s);case"MM":return Nn(dn(2,t),s);case"Mo":return Nn(a.ordinalNumber(t,{unit:"month"}),s);case"MMM":return a.month(t,{width:"abbreviated",context:"formatting"})||a.month(t,{width:"narrow",context:"formatting"});case"MMMMM":return a.month(t,{width:"narrow",context:"formatting"});default:return a.month(t,{width:"wide",context:"formatting"})||a.month(t,{width:"abbreviated",context:"formatting"})||a.month(t,{width:"narrow",context:"formatting"})}}validate(t,r){return r>=0&&r<=11}set(t,r,a){return t.setMonth(a,1),t.setHours(0,0,0,0),t}}class dV extends Ha{priority=110;parse(t,r,a){const s=n=>n-1;switch(r){case"L":return Nn(Ws(Sn.month,t),s);case"LL":return Nn(dn(2,t),s);case"Lo":return Nn(a.ordinalNumber(t,{unit:"month"}),s);case"LLL":return a.month(t,{width:"abbreviated",context:"standalone"})||a.month(t,{width:"narrow",context:"standalone"});case"LLLLL":return a.month(t,{width:"narrow",context:"standalone"});default:return a.month(t,{width:"wide",context:"standalone"})||a.month(t,{width:"abbreviated",context:"standalone"})||a.month(t,{width:"narrow",context:"standalone"})}}validate(t,r){return r>=0&&r<=11}set(t,r,a){return t.setMonth(a,1),t.setHours(0,0,0,0),t}incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]}function fV(e,t,r){const a=zn(e,r?.in),s=$E(a,r)-t;return a.setDate(a.getDate()-s*7),zn(a,r?.in)}class hV extends Ha{priority=100;parse(t,r,a){switch(r){case"w":return Ws(Sn.week,t);case"wo":return a.ordinalNumber(t,{unit:"week"});default:return dn(r.length,t)}}validate(t,r){return r>=1&&r<=53}set(t,r,a,s){return u0(fV(t,a,s),s)}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]}function pV(e,t,r){const a=zn(e,r?.in),s=WE(a,r)-t;return a.setDate(a.getDate()-s*7),a}class gV extends Ha{priority=100;parse(t,r,a){switch(r){case"I":return Ws(Sn.week,t);case"Io":return a.ordinalNumber(t,{unit:"week"});default:return dn(r.length,t)}}validate(t,r){return r>=1&&r<=53}set(t,r,a){return Uf(pV(t,a))}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]}const mV=[31,28,31,30,31,30,31,31,30,31,30,31],xV=[31,29,31,30,31,30,31,31,30,31,30,31];class bV extends Ha{priority=90;subPriority=1;parse(t,r,a){switch(r){case"d":return Ws(Sn.date,t);case"do":return a.ordinalNumber(t,{unit:"date"});default:return dn(r.length,t)}}validate(t,r){const a=t.getFullYear(),s=rF(a),n=t.getMonth();return s?r>=1&&r<=xV[n]:r>=1&&r<=mV[n]}set(t,r,a){return t.setDate(a),t.setHours(0,0,0,0),t}incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]}class vV extends Ha{priority=90;subpriority=1;parse(t,r,a){switch(r){case"D":case"DD":return Ws(Sn.dayOfYear,t);case"Do":return a.ordinalNumber(t,{unit:"date"});default:return dn(r.length,t)}}validate(t,r){const a=t.getFullYear();return rF(a)?r>=1&&r<=366:r>=1&&r<=365}set(t,r,a){return t.setMonth(0,a),t.setHours(0,0,0,0),t}incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]}function __(e,t,r){const a=Pf(),s=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??a.weekStartsOn??a.locale?.options?.weekStartsOn??0,n=zn(e,r?.in),o=n.getDay(),u=(t%7+7)%7,f=7-s,h=t<0||t>6?t-(o+f)%7:(u+f)%7-(o+f)%7;return zE(n,h,r)}class wV extends Ha{priority=90;parse(t,r,a){switch(r){case"E":case"EE":case"EEE":return a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"});case"EEEEE":return a.day(t,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"});default:return a.day(t,{width:"wide",context:"formatting"})||a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"})}}validate(t,r){return r>=0&&r<=6}set(t,r,a,s){return t=__(t,a,s),t.setHours(0,0,0,0),t}incompatibleTokens=["D","i","e","c","t","T"]}class _V extends Ha{priority=90;parse(t,r,a,s){const n=o=>{const c=Math.floor((o-1)/7)*7;return(o+s.weekStartsOn+6)%7+c};switch(r){case"e":case"ee":return Nn(dn(r.length,t),n);case"eo":return Nn(a.ordinalNumber(t,{unit:"day"}),n);case"eee":return a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"});case"eeeee":return a.day(t,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"});default:return a.day(t,{width:"wide",context:"formatting"})||a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"})}}validate(t,r){return r>=0&&r<=6}set(t,r,a,s){return t=__(t,a,s),t.setHours(0,0,0,0),t}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]}class yV extends Ha{priority=90;parse(t,r,a,s){const n=o=>{const c=Math.floor((o-1)/7)*7;return(o+s.weekStartsOn+6)%7+c};switch(r){case"c":case"cc":return Nn(dn(r.length,t),n);case"co":return Nn(a.ordinalNumber(t,{unit:"day"}),n);case"ccc":return a.day(t,{width:"abbreviated",context:"standalone"})||a.day(t,{width:"short",context:"standalone"})||a.day(t,{width:"narrow",context:"standalone"});case"ccccc":return a.day(t,{width:"narrow",context:"standalone"});case"cccccc":return a.day(t,{width:"short",context:"standalone"})||a.day(t,{width:"narrow",context:"standalone"});default:return a.day(t,{width:"wide",context:"standalone"})||a.day(t,{width:"abbreviated",context:"standalone"})||a.day(t,{width:"short",context:"standalone"})||a.day(t,{width:"narrow",context:"standalone"})}}validate(t,r){return r>=0&&r<=6}set(t,r,a,s){return t=__(t,a,s),t.setHours(0,0,0,0),t}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]}function kV(e,t,r){const a=zn(e,r?.in),s=Jz(a,r),n=t-s;return zE(a,n,r)}class BV extends Ha{priority=90;parse(t,r,a){const s=n=>n===0?7:n;switch(r){case"i":case"ii":return dn(r.length,t);case"io":return a.ordinalNumber(t,{unit:"day"});case"iii":return Nn(a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"}),s);case"iiiii":return Nn(a.day(t,{width:"narrow",context:"formatting"}),s);case"iiiiii":return Nn(a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"}),s);default:return Nn(a.day(t,{width:"wide",context:"formatting"})||a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"}),s)}}validate(t,r){return r>=1&&r<=7}set(t,r,a){return t=kV(t,a),t.setHours(0,0,0,0),t}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]}class CV extends Ha{priority=80;parse(t,r,a){switch(r){case"a":case"aa":case"aaa":return a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaaa":return a.dayPeriod(t,{width:"narrow",context:"formatting"});default:return a.dayPeriod(t,{width:"wide",context:"formatting"})||a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,r,a){return t.setHours(w_(a),0,0,0),t}incompatibleTokens=["b","B","H","k","t","T"]}class SV extends Ha{priority=80;parse(t,r,a){switch(r){case"b":case"bb":case"bbb":return a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbbb":return a.dayPeriod(t,{width:"narrow",context:"formatting"});default:return a.dayPeriod(t,{width:"wide",context:"formatting"})||a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,r,a){return t.setHours(w_(a),0,0,0),t}incompatibleTokens=["a","B","H","k","t","T"]}class NV extends Ha{priority=80;parse(t,r,a){switch(r){case"B":case"BB":case"BBB":return a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBBB":return a.dayPeriod(t,{width:"narrow",context:"formatting"});default:return a.dayPeriod(t,{width:"wide",context:"formatting"})||a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,r,a){return t.setHours(w_(a),0,0,0),t}incompatibleTokens=["a","b","t","T"]}class EV extends Ha{priority=70;parse(t,r,a){switch(r){case"h":return Ws(Sn.hour12h,t);case"ho":return a.ordinalNumber(t,{unit:"hour"});default:return dn(r.length,t)}}validate(t,r){return r>=1&&r<=12}set(t,r,a){const s=t.getHours()>=12;return s&&a<12?t.setHours(a+12,0,0,0):!s&&a===12?t.setHours(0,0,0,0):t.setHours(a,0,0,0),t}incompatibleTokens=["H","K","k","t","T"]}class FV extends Ha{priority=70;parse(t,r,a){switch(r){case"H":return Ws(Sn.hour23h,t);case"Ho":return a.ordinalNumber(t,{unit:"hour"});default:return dn(r.length,t)}}validate(t,r){return r>=0&&r<=23}set(t,r,a){return t.setHours(a,0,0,0),t}incompatibleTokens=["a","b","h","K","k","t","T"]}class TV extends Ha{priority=70;parse(t,r,a){switch(r){case"K":return Ws(Sn.hour11h,t);case"Ko":return a.ordinalNumber(t,{unit:"hour"});default:return dn(r.length,t)}}validate(t,r){return r>=0&&r<=11}set(t,r,a){return t.getHours()>=12&&a<12?t.setHours(a+12,0,0,0):t.setHours(a,0,0,0),t}incompatibleTokens=["h","H","k","t","T"]}class LV extends Ha{priority=70;parse(t,r,a){switch(r){case"k":return Ws(Sn.hour24h,t);case"ko":return a.ordinalNumber(t,{unit:"hour"});default:return dn(r.length,t)}}validate(t,r){return r>=1&&r<=24}set(t,r,a){const s=a<=24?a%24:a;return t.setHours(s,0,0,0),t}incompatibleTokens=["a","b","h","H","K","t","T"]}class jV extends Ha{priority=60;parse(t,r,a){switch(r){case"m":return Ws(Sn.minute,t);case"mo":return a.ordinalNumber(t,{unit:"minute"});default:return dn(r.length,t)}}validate(t,r){return r>=0&&r<=59}set(t,r,a){return t.setMinutes(a,0,0),t}incompatibleTokens=["t","T"]}class UV extends Ha{priority=50;parse(t,r,a){switch(r){case"s":return Ws(Sn.second,t);case"so":return a.ordinalNumber(t,{unit:"second"});default:return dn(r.length,t)}}validate(t,r){return r>=0&&r<=59}set(t,r,a){return t.setSeconds(a,0),t}incompatibleTokens=["t","T"]}class DV extends Ha{priority=30;parse(t,r){const a=s=>Math.trunc(s*Math.pow(10,-r.length+3));return Nn(dn(r.length,t),a)}set(t,r,a){return t.setMilliseconds(a),t}incompatibleTokens=["t","T"]}class IV extends Ha{priority=10;parse(t,r){switch(r){case"X":return wc(vc.basicOptionalMinutes,t);case"XX":return wc(vc.basic,t);case"XXXX":return wc(vc.basicOptionalSeconds,t);case"XXXXX":return wc(vc.extendedOptionalSeconds,t);default:return wc(vc.extended,t)}}set(t,r,a){return r.timestampIsSet?t:Ci(t,t.getTime()-Ex(t)-a)}incompatibleTokens=["t","T","x"]}class QV extends Ha{priority=10;parse(t,r){switch(r){case"x":return wc(vc.basicOptionalMinutes,t);case"xx":return wc(vc.basic,t);case"xxxx":return wc(vc.basicOptionalSeconds,t);case"xxxxx":return wc(vc.extendedOptionalSeconds,t);default:return wc(vc.extended,t)}}set(t,r,a){return r.timestampIsSet?t:Ci(t,t.getTime()-Ex(t)-a)}incompatibleTokens=["t","T","X"]}class OV extends Ha{priority=40;parse(t){return eF(t)}set(t,r,a){return[Ci(t,a*1e3),{timestampIsSet:!0}]}incompatibleTokens="*"}class RV extends Ha{priority=20;parse(t){return eF(t)}set(t,r,a){return[Ci(t,a),{timestampIsSet:!0}]}incompatibleTokens="*"}const MV={G:new sV,y:new nV,Y:new iV,R:new lV,u:new oV,Q:new AV,q:new cV,M:new uV,L:new dV,w:new hV,I:new gV,d:new bV,D:new vV,E:new wV,e:new _V,c:new yV,i:new BV,a:new CV,b:new SV,B:new NV,h:new EV,H:new FV,K:new TV,k:new LV,m:new jV,s:new UV,S:new DV,X:new IV,x:new QV,t:new OV,T:new RV},HV=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,PV=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,qV=/^'([^]*?)'?$/,KV=/''/g,zV=/\S/,VV=/[a-zA-Z]/;function oB(e,t,r,a){const s=()=>Ci(r,NaN),n=Yz(),o=n.locale??GE,c=n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,u=n.weekStartsOn??n.locale?.options?.weekStartsOn??0;if(!t)return e?s():zn(r,a?.in);const f={firstWeekContainsDate:c,weekStartsOn:u,locale:o},h=[new aV(a?.in,r)],g=t.match(PV).map(B=>{const k=B[0];if(k in Lw){const E=Lw[k];return E(B,o.formatLong)}return B}).join("").match(HV),x=[];for(let B of g){JE(B)&&jw(B,t,e),YE(B)&&jw(B,t,e);const k=B[0],E=MV[k];if(E){const{incompatibleTokens:S}=E;if(Array.isArray(S)){const P=x.find(R=>S.includes(R.token)||R.token===k);if(P)throw new RangeError(`The format string mustn't contain \`${P.fullToken}\` and \`${B}\` at the same time`)}else if(E.incompatibleTokens==="*"&&x.length>0)throw new RangeError(`The format string mustn't contain \`${B}\` and any other token at the same time`);x.push({token:k,fullToken:B});const L=E.run(e,B,o.match,f);if(!L)return s();h.push(L.setter),e=L.rest}else{if(k.match(VV))throw new RangeError("Format string contains an unescaped latin alphabet character `"+k+"`");if(B==="''"?B="'":k==="'"&&(B=GV(B)),e.indexOf(B)===0)e=e.slice(B.length);else return s()}}if(e.length>0&&zV.test(e))return s();const m=h.map(B=>B.priority).sort((B,k)=>k-B).filter((B,k,E)=>E.indexOf(B)===k).map(B=>h.filter(k=>k.priority===B).sort((k,E)=>E.subPriority-k.subPriority)).map(B=>B[0]);let w=zn(r,a?.in);if(isNaN(+w))return s();const v={};for(const B of m){if(!B.validate(w,f))return s();const k=B.set(w,v,f);Array.isArray(k)?(w=k[0],Object.assign(v,k[1])):w=k}return w}function GV(e){return e.match(qV)[1].replace(KV,"'")}const aF={Period:[{id:"MMM.YYYY",label:"MMM.YYYY (e.g. 001.2025)",description:"Converts 001.2025 to 2025-01",apply:e=>{if(typeof e!="string")return e;const t=e.match(/^(\d{3})\.(\d{4})$/);if(t){const r=parseInt(t[1],10);return`${t[2]}-${r.toString().padStart(2,"0")}`}return e}},{id:"YYYY-MM",label:"YYYY-MM (ISO)",description:"Standard ISO format",apply:e=>e},{id:"MM.YYYY",label:"MM.YYYY / MM-YYYY (e.g. 01.2025)",description:"Converts 01.2025 or 01-2025 to 2025-01",apply:e=>{if(typeof e!="string")return e;const t=String(e).trim().match(/^(\d{1,2})[.-](\d{4})$/);if(t){const r=parseInt(t[1],10);return`${t[2]}-${r.toString().padStart(2,"0")}`}return e}}],PostingDate:[{id:"DD.MM.YYYY",label:"DD.MM.YYYY",description:"German date format",apply:e=>{if(typeof e!="string"||e.match(/^\d{4}-\d{2}-\d{2}$/))return e;const t=oB(e,"dd.MM.yyyy",new Date);return Tw(t)?hv(t,"yyyy-MM-dd"):e}},{id:"MM/DD/YYYY",label:"MM/DD/YYYY",description:"US date format",apply:e=>{if(typeof e!="string")return e;const t=oB(e,"MM/dd/yyyy",new Date);return Tw(t)?hv(t,"yyyy-MM-dd"):e}},{id:"ExcelSerial",label:"Excel Serial Number",description:"Number like 45321",apply:e=>{const t=Number(e);if(!isNaN(t)&&t>2e4){const r=new Date((t-25569)*86400*1e3);return hv(r,"yyyy-MM-dd")}return e}}],...["VendorName","VendorId","DocumentId","CostCenter","Category","SubCategory","Service","System","Description"].reduce((e,t)=>({...e,[t]:[{id:"Trim",label:"Trim Whitespace",description:"Removes leading and trailing spaces",apply:r=>String(r||"").trim()},{id:"UpperCase",label:"UPPER CASE",description:"Converts to uppercase",apply:r=>String(r||"").toUpperCase()},{id:"LowerCase",label:"lower case",description:"Converts to lowercase",apply:r=>String(r||"").toLowerCase()},{id:"TitleCase",label:"Title Case",description:"Capitalize First Letters",apply:r=>String(r||"").replace(/\w\S*/g,a=>a.charAt(0).toUpperCase()+a.substr(1).toLowerCase())}]}),{}),...["Amount","UnitPrice","Quantity"].reduce((e,t)=>({...e,[t]:[{id:"ParseDeCurrency",label:"German Currency (1.234,56)",description:"Parses 1.234,56 to 1234.56",apply:r=>{if(typeof r=="number")return r;if(!r)return 0;const a=String(r).replace(/\./g,"").replace(",","."),s=parseFloat(a);return isNaN(s)?0:s}},{id:"CleanNumber",label:"Clean Number (Remove Symbols)",description:"Keep only digits, dots and minus",apply:r=>{if(typeof r=="number")return r;const a=String(r).replace(/[^0-9.-]/g,""),s=parseFloat(a);return isNaN(s)?0:s}}]}),{})},WV=(e,t,r)=>{const a=aF[r];if(!a)return e;const s=a.find(n=>n.id===t);return s?s.apply(e):e},$V=({sourceColumns:e,targetSchema:t,onConfirm:r,onCancel:a,initialMapping:s})=>{const[n,o]=Z.useState(s||{}),c=t.properties,u=t.required||[],f=Object.keys(c).map(m=>({key:m,description:c[m].description,required:u.includes(m)})),h=Z.useCallback(()=>{const m={};f.forEach(w=>{const v=e.find(B=>B.toLowerCase()===w.key.toLowerCase()||B.toLowerCase().replace(/[^a-z0-9]/g,"")===w.key.toLowerCase().replace(/[^a-z0-9]/g,""));v&&(m[w.key]={sourceColumn:v,operation:"direct"})}),o(w=>({...w,...m}))},[e,f]);Z.useEffect(()=>{if(s&&Object.keys(s).length>0)return;const m=window.setTimeout(()=>{h()},0);return()=>window.clearTimeout(m)},[h,s]);const g=f.filter(m=>m.required).every(m=>{const w=n[m.key];return w?w.sourceColumn==="__CONSTANT__"?!!w.constantValue:w.operation==="concat"&&!w.secondaryColumn?!1:!!w.sourceColumn:!1}),x=()=>f.filter(m=>{if(!m.required)return!1;const w=n[m.key];return w?w.sourceColumn==="__CONSTANT__"?!w.constantValue:w.operation==="concat"&&!w.secondaryColumn?!0:!w.sourceColumn:!0}).length;return l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4 animate-in fade-in duration-200",children:l.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-6xl max-h-[90vh] flex flex-col",children:[l.jsxs("div",{className:"p-4 sm:p-6 border-b border-slate-200 dark:border-slate-700 flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Map Columns & Transforms"}),l.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Match columns and apply necessary format conversions."})]}),l.jsxs("button",{onClick:h,className:"w-full sm:w-auto flex items-center justify-center gap-2 px-3 py-1.5 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors text-sm font-medium",children:[l.jsx(z8,{className:"w-4 h-4"}),"Auto-Map"]})]}),l.jsxs("div",{className:"flex-1 overflow-auto p-4 sm:p-6",children:[l.jsxs("div",{className:"hidden lg:grid grid-cols-[1fr,auto,2fr,1fr] gap-4 items-start mb-2 px-4 text-xs font-bold text-slate-400 uppercase tracking-wider",children:[l.jsx("div",{children:"Required Field"}),l.jsx("div",{className:"w-8"}),l.jsx("div",{children:"Source Configuration"}),l.jsx("div",{children:"Transformation"})]}),l.jsx("div",{className:"space-y-3",children:f.map(m=>{const w=aF[m.key]||[],v=n[m.key],B=v?.operation||"direct";return l.jsxs("div",{className:`
                                    grid grid-cols-1 lg:grid-cols-[1fr,auto,2fr,1fr] gap-3 lg:gap-4 items-start p-4 rounded-xl border transition-colors
                                    ${v?.sourceColumn?"bg-slate-50 dark:bg-slate-900/30 border-slate-200 dark:border-slate-700":m.required?"bg-red-50 dark:bg-red-900/10 border-red-200 dark:border-red-900/30":"bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 opacity-70 hover:opacity-100"}
                                `,children:[l.jsxs("div",{className:"mt-2",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:`font-semibold ${m.required?"text-slate-900 dark:text-white":"text-slate-500 dark:text-slate-400"}`,children:m.key}),m.required&&l.jsx("span",{className:"text-[10px] bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 px-1.5 py-0.5 rounded font-bold uppercase",children:"Required"})]}),l.jsx("div",{className:"text-xs text-slate-500 mt-1 line-clamp-1",title:m.description,children:m.description})]}),l.jsx(k2,{className:`hidden lg:block w-4 h-4 mt-3 ${v?.sourceColumn?"text-blue-500":"text-slate-300"}`}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider lg:hidden",children:"Source Configuration"}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:items-center min-h-10",children:[l.jsxs("select",{value:v?.sourceColumn||"",onChange:k=>{const E=k.target.value;o(S=>{const L={...S};if(E){let P=L[m.key]?.transformId;E==="__CONSTANT__"&&!P&&w.length>0&&(P=w[0].id),L[m.key]={sourceColumn:E,transformId:P,operation:"direct"}}else delete L[m.key];return L})},className:`
                                                    w-full sm:flex-1 h-10 px-3 rounded-lg border text-sm outline-none focus:ring-2 focus:ring-blue-500 transition-all
                                                    ${v?.sourceColumn?"border-blue-200 bg-white dark:bg-slate-900 dark:border-blue-900/50":"border-slate-200 bg-slate-50 dark:bg-slate-800 dark:border-slate-600"}
                                                `,children:[l.jsx("option",{value:"",children:"-- Ignored --"}),l.jsx("option",{value:"__CONSTANT__",className:"font-bold text-blue-600",children:"-- Set Constant Value --"}),l.jsx("optgroup",{label:"Source Columns",children:e.map(k=>l.jsx("option",{value:k,children:k},k))})]}),v?.sourceColumn&&v.sourceColumn!=="__CONSTANT__"&&l.jsxs("div",{className:"flex h-10 sm:h-full w-full sm:w-auto bg-slate-100 dark:bg-slate-700 rounded-lg p-1 border border-slate-200 dark:border-slate-600 items-center flex-wrap sm:flex-nowrap",children:[l.jsx("button",{onClick:()=>o(k=>({...k,[m.key]:{...k[m.key],operation:"direct"}})),className:`h-full px-3 rounded-md text-xs font-bold transition-all flex items-center ${B==="direct"?"bg-white dark:bg-slate-600 shadow-sm text-slate-900 dark:text-white":"text-slate-500 hover:text-slate-700"}`,title:"Direct Mapping",children:"1:1"}),l.jsx("div",{className:"w-px h-4 bg-slate-200 dark:bg-slate-600 mx-0.5"}),l.jsx("button",{onClick:()=>o(k=>({...k,[m.key]:{...k[m.key],operation:"coalesce"}})),className:`h-full px-3 rounded-md text-xs font-bold transition-all flex items-center ${B==="coalesce"?"bg-white dark:bg-slate-600 shadow-sm text-slate-900 dark:text-white":"text-slate-500 hover:text-slate-700"}`,title:"Fallback if empty (Coalesce)",children:"Fallback"}),l.jsx("div",{className:"w-px h-4 bg-slate-200 dark:bg-slate-600 mx-0.5"}),l.jsx("button",{onClick:()=>o(k=>({...k,[m.key]:{...k[m.key],operation:"concat",separator:" "}})),className:`h-full px-3 rounded-md text-xs font-bold transition-all flex items-center ${B==="concat"?"bg-white dark:bg-slate-600 shadow-sm text-slate-900 dark:text-white":"text-slate-500 hover:text-slate-700"}`,title:"Combine Columns (Concat)",children:"Combine"})]})]}),B==="coalesce"&&l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 animate-in slide-in-from-top-2 min-h-10",children:[l.jsx(ok,{className:"w-4 h-4 text-slate-400 rotate-45"}),l.jsx("span",{className:"text-xs font-bold text-slate-400 shrink-0",children:"ELSE USE"}),l.jsxs("select",{value:v?.secondaryColumn||"",onChange:k=>o(E=>({...E,[m.key]:{...E[m.key],secondaryColumn:k.target.value}})),className:"w-full sm:flex-1 h-10 px-3 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 text-sm focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"",children:"-- Select Fallback Column --"}),e.map(k=>l.jsx("option",{value:k,children:k},k))]})]}),B==="concat"&&l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 animate-in slide-in-from-top-2 min-h-10",children:[l.jsx(eA,{className:"w-4 h-4 text-slate-400"}),l.jsx("input",{type:"text",placeholder:"Separator (space)",value:v?.separator??" ",onChange:k=>o(E=>({...E,[m.key]:{...E[m.key],separator:k.target.value}})),className:"w-full sm:w-16 h-10 px-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 text-center text-sm",title:"Separator"}),l.jsx(eA,{className:"w-4 h-4 text-slate-400"}),l.jsxs("select",{value:v?.secondaryColumn||"",onChange:k=>o(E=>({...E,[m.key]:{...E[m.key],secondaryColumn:k.target.value}})),className:"w-full sm:flex-1 h-10 px-3 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 text-sm focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"",children:"-- Select 2nd Column --"}),e.map(k=>l.jsx("option",{value:k,children:k},k))]})]}),v?.sourceColumn==="__CONSTANT__"&&l.jsx("div",{className:"relative animate-in fade-in zoom-in-95 h-10",children:l.jsx("input",{type:"text",placeholder:"Enter constant value...",value:v.constantValue||"",onChange:k=>{const E=k.target.value;o(S=>({...S,[m.key]:{...S[m.key],constantValue:E}}))},className:`
                                                        w-full h-full px-3 rounded-lg border text-sm outline-none focus:ring-2 focus:ring-blue-500 transition-all
                                                        ${v.constantValue?"border-blue-200 bg-white dark:bg-slate-900 dark:border-blue-900/50":"border-red-300 ring-2 ring-red-100 bg-red-50"}
                                                    `})})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider lg:hidden mb-2",children:"Transformation"}),w.length>0&&(v?.sourceColumn||m.key==="Currency")&&l.jsxs("div",{className:"relative h-10",children:[l.jsx(V8,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none"}),l.jsxs("select",{value:v?.transformId||"",onChange:k=>{const E=k.target.value;o(S=>({...S,[m.key]:{...S[m.key],transformId:E||void 0}}))},className:"w-full h-full pl-9 pr-3 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 text-sm focus:ring-2 focus:ring-blue-500 appearance-none",children:[l.jsx("option",{value:"",children:"No Transformation"}),w.map(k=>l.jsx("option",{value:k.id,children:k.label},k.id))]}),l.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none",children:l.jsx(ok,{className:"w-3 h-3 text-slate-400"})})]})]})]},m.key)})})]}),l.jsxs("div",{className:"p-4 sm:p-6 border-t border-slate-200 dark:border-slate-700 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 bg-slate-50 dark:bg-slate-900/50 rounded-b-2xl",children:[l.jsx("button",{onClick:a,className:"px-4 py-2 text-slate-600 hover:text-slate-900 dark:text-slate-400 dark:hover:text-white font-medium transition-colors",children:"Cancel Import"}),l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 sm:gap-4 w-full sm:w-auto",children:[!g&&l.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm font-medium",children:[l.jsx(Cn,{className:"w-4 h-4"}),x()," required fields missing"]}),l.jsxs("button",{onClick:()=>r(n),disabled:!g,className:`
                                w-full sm:w-auto flex items-center justify-center gap-2 px-6 py-2.5 rounded-xl font-semibold shadow-lg transition-all transform
                                ${g?"bg-blue-600 hover:bg-blue-700 text-white shadow-blue-200 dark:shadow-none hover:-translate-y-0.5":"bg-slate-200 dark:bg-slate-700 text-slate-400 cursor-not-allowed"}
                            `,children:[l.jsx(B2,{className:"w-4 h-4"}),"Confirm Mapping"]})]})]})]})})},XV=({config:e,onImportComplete:t})=>{const{t:r}=ds(),[a,s]=Z.useState(!1),[n,o]=Z.useState(!1),[c,u]=Z.useState(null),[f,h]=Z.useState(null),[g]=Jt("import_default_mode","append"),[x]=Jt("import_auto_save_mappings",!0),[m,w]=Z.useState(g),[v,B]=Z.useState(!1),[k,E]=Z.useState(null),[S,L]=Z.useState([]),P=Z.useRef(null),[R,Q]=Jt("excel_mappings_v2",{});Z.useEffect(()=>{w(g)},[g,e?.key]);const V=Z.useCallback(()=>{if(!e?.schema||typeof e.schema!="object")return null;const H=e.schema;return!H.properties||typeof H.properties!="object"?null:{properties:H.properties,required:Array.isArray(H.required)?H.required:[]}},[e]),U=Z.useCallback((H,ee,le)=>{const pe=Object.keys(le.properties),te=Le=>Le==null||Le==="";return H.map(Le=>{const je={};return pe.forEach(F=>{const K=ee[F];if(!K?.sourceColumn)return;let I;if(K.sourceColumn==="__CONSTANT__")I=K.constantValue??"";else{const q=Le[K.sourceColumn],J=K.secondaryColumn?Le[K.secondaryColumn]:void 0;switch(K.operation){case"coalesce":I=te(q)?J:q;break;case"concat":{I=[q,J].filter(de=>!te(de)).map(de=>String(de)).join(K.separator??" ");break}default:I=q;break}}K.transformId&&(I=WV(I,K.transformId,F)),je[F]=I}),je})},[]),M=Z.useCallback(async H=>{if(e){if(H.length===0){u(r("datasource.excel_import.no_valid_data"));return}m==="overwrite"&&e.clearFn&&await e.clearFn(),await e.importFn(H),h(r("datasource.excel_import.success_msg",{count:H.length})),t&&t(),window.dispatchEvent(new Event("db-updated"))}},[e,m,t,r]),T=Z.useCallback(async H=>{if(e){o(!0),u(null),h(null);try{const ee=await H.arrayBuffer(),le=kx(ee),pe=le.SheetNames[0],te=le.Sheets[pe],Le=Ap.sheet_to_json(te);if(Le.length===0){u(r("datasource.excel_import.no_data"));return}const je=Object.keys(Le[0]??{});if(V()){E(Le),L(je),B(!0);return}await M(Le)}catch(ee){const le=ee instanceof Error?ee.message:String(ee);u(r("datasource.excel_import.error_reading",{error:le}))}finally{o(!1)}}},[e,M,V,r]),D=Z.useCallback(async H=>{if(!e||!k)return;const ee=V();if(ee){B(!1),o(!0),u(null),h(null);try{const le=U(k,H,ee);x&&Q(pe=>({...pe,[e.key]:H})),await M(le)}catch(le){const pe=le instanceof Error?le.message:String(le);u(r("datasource.excel_import.import_failed",{error:pe}))}finally{E(null),L([]),o(!1)}}},[U,x,e,M,V,k,Q,r]),G=Z.useCallback(()=>{B(!1),E(null),L([])},[]),ne=Z.useCallback(H=>{H.preventDefault(),s(!1);const ee=H.dataTransfer.files[0];ee&&T(ee)},[T]);return e?l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex bg-slate-100 dark:bg-slate-800 p-1 rounded-lg w-fit",children:[l.jsxs("button",{onClick:()=>w("append"),className:`px-3 py-1.5 text-xs font-bold rounded-md flex items-center gap-2 transition-all ${m==="append"?"bg-white dark:bg-slate-700 shadow text-blue-600 dark:text-blue-300":"text-slate-500 dark:text-slate-400"}`,children:[l.jsx(G8,{className:"w-3.5 h-3.5"})," ",r("datasource.excel_import.append")]}),l.jsxs("button",{onClick:()=>w("overwrite"),className:`px-3 py-1.5 text-xs font-bold rounded-md flex items-center gap-2 transition-all ${m==="overwrite"?"bg-white dark:bg-slate-700 shadow text-red-600 dark:text-red-300":"text-slate-500 dark:text-slate-400"}`,children:[l.jsx(Zc,{className:"w-3.5 h-3.5"})," ",r("datasource.excel_import.overwrite")]})]}),l.jsxs("div",{onDragOver:H=>{H.preventDefault(),s(!0)},onDragLeave:()=>s(!1),onDrop:ne,onClick:()=>P.current?.click(),className:`
                    relative group border-2 border-dashed rounded-2xl p-8 transition-all cursor-pointer text-center
                    ${a?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-slate-200 dark:border-slate-700 hover:border-slate-400 dark:hover:border-slate-600 hover:bg-slate-50 dark:hover:bg-slate-900/40"}
                    ${n?"opacity-50 pointer-events-none":""}
                `,children:[l.jsx("input",{type:"file",ref:P,onChange:H=>H.target.files?.[0]&&T(H.target.files[0]),accept:".xlsx,.xls,.csv",className:"hidden"}),l.jsxs("div",{className:"flex flex-col items-center gap-3",children:[l.jsx("div",{className:`p-3 rounded-xl transition-colors ${a?"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-300":"bg-slate-100 dark:bg-slate-800 text-slate-400 dark:text-slate-500 group-hover:bg-slate-200 dark:group-hover:bg-slate-700 group-hover:text-slate-600 dark:group-hover:text-slate-300"}`,children:l.jsx(C2,{className:"w-8 h-8"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-bold text-slate-700 dark:text-slate-200",children:r("datasource.smart_import.upload_label")}),l.jsx("p",{className:"text-xs text-slate-400 dark:text-slate-500 mt-1",children:r("datasource.excel_import.drop_hint")})]})]}),n&&l.jsx("div",{className:"absolute inset-0 bg-white/60 dark:bg-slate-900/60 flex items-center justify-center rounded-2xl backdrop-blur-[1px]",children:l.jsxs("div",{className:"flex items-center gap-3 text-blue-600 dark:text-blue-300",children:[l.jsx("div",{className:"w-5 h-5 border-2 border-current border-t-transparent rounded-full animate-spin"}),l.jsx("span",{className:"text-xs font-bold",children:r("datasource.excel_import.processing_file")})]})})]}),c&&l.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 border-2 border-red-100 dark:border-red-800/50 rounded-2xl flex items-start gap-3 text-red-600 dark:text-red-300 text-xs animate-in slide-in-from-top-2 relative",children:[l.jsx(Cn,{className:"w-5 h-5 shrink-0 mt-0.5"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"font-black uppercase tracking-widest text-[10px] mb-1",children:r("common.error")}),l.jsx("p",{className:"font-medium leading-relaxed",children:c})]}),l.jsx("button",{onClick:()=>u(null),className:"p-1 hover:bg-red-100 dark:hover:bg-red-900/40 rounded-lg transition-colors",children:l.jsx(vl,{className:"w-4 h-4"})})]}),f&&l.jsxs("div",{className:"p-4 bg-emerald-50 dark:bg-emerald-900/20 border-2 border-emerald-100 dark:border-emerald-800/50 rounded-2xl flex items-start gap-3 text-emerald-600 dark:text-emerald-300 text-xs animate-in slide-in-from-top-2 relative",children:[l.jsx(If,{className:"w-5 h-5 shrink-0 mt-0.5"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"font-black uppercase tracking-widest text-[10px] mb-1",children:r("common.success")}),l.jsx("p",{className:"font-medium leading-relaxed",children:f})]}),l.jsx("button",{onClick:()=>h(null),className:"p-1 hover:bg-emerald-100 dark:hover:bg-emerald-900/40 rounded-lg transition-colors",children:l.jsx(vl,{className:"w-4 h-4"})})]}),v&&e&&V()&&l.jsx($V,{sourceColumns:S,targetSchema:V(),initialMapping:R[e.key],onConfirm:H=>{D(H)},onCancel:G})]}):l.jsx("div",{className:"p-8 text-center bg-slate-50 dark:bg-slate-900/40 border-2 border-dashed border-slate-200 dark:border-slate-700 rounded-2xl",children:l.jsx("p",{className:"text-slate-400 dark:text-slate-500 text-sm",children:r("datasource.excel_import.none_selected")})})};async function YV(e){return new Promise((t,r)=>{const a=new FileReader;a.onload=s=>{try{const n=new Uint8Array(s.target?.result),o=kx(n,{type:"array",cellDates:!0}),c=[];for(const u of o.SheetNames){const f=o.Sheets[u],h=Ap.sheet_to_json(f,{header:1});if(!h||h.length<2)continue;const g=h[0].map(E=>String(E).trim()),x=h.slice(1);let m=u.toLowerCase().replace(/[^a-z0-9_]/g,"_").replace(/^_+|_+$/g,"").replace(/_+/g,"_"),w,v=!0;/^[a-z][a-z0-9_]*$/.test(m)||(/^[0-9]/.test(m)?m="tbl_"+m:m===""&&(m="tbl_unnamed")),m.startsWith("sys_")&&(v=!1,w="Tabellennamen drfen nicht mit 'sys_' beginnen (reserviert).");const B=g.map((E,S)=>{let L=!0,P=!0,R=!1;const Q=Math.min(x.length,100);for(let M=0;M<Q;M++){const T=x[M][S];if(T==null||T==="")continue;R=!0;const D=Number(T);if(isNaN(D)){L=!1,P=!1;break}Number.isInteger(D)||(L=!1)}let V="TEXT";return R&&(L?V="INTEGER":P&&(V="REAL")),{name:E.toLowerCase().replace(/[^a-z0-9_]/g,"_"),type:V}}),k=x.map(E=>{const S={};return B.forEach((L,P)=>{let R=E[P];R instanceof Date?R=R.toISOString():typeof R=="object"&&R!==null&&(R=JSON.stringify(R)),S[L.name]=R}),S});c.push({sheetName:u,suggestedTableName:m,columns:B,rowCount:x.length,data:k,isValid:v,validationError:w})}t(c)}catch(n){r(n)}},a.onerror=s=>r(s),a.readAsArrayBuffer(e)})}const JV=()=>{const{t:e}=ds(),t=UA("SmartImport"),[r,a]=Z.useState(1),[s,n]=Z.useState([]),[o,c]=Z.useState({tables:0,records:0}),[u,f]=Z.useState(!1),[h,g]=Z.useState(!1),x=Z.useRef(null),m=async v=>{const B=v.target.files?.[0];if(B){f(!0);try{const E=(await YV(B)).map(S=>({sheetName:S.sheetName,tableName:S.suggestedTableName.startsWith("usr_")?S.suggestedTableName:`usr_${S.suggestedTableName}`,columns:S.columns,rows:S.data,isValid:S.isValid,error:S.validationError}));n(E),a(2)}catch(k){t.error("Analysis failed",k),await Qt.error(e("datasource.smart_import.error_analyzing"))}finally{f(!1)}}},w=async()=>{g(!0);let v=0,B=0;try{for(const k of s){if(!k.isValid)continue;const E=k.columns.map(L=>`"${L.name}" ${L.type}`).join(", ");await jt.executeRaw(`CREATE TABLE IF NOT EXISTS "${k.tableName}" (${E});`);const S=500;for(let L=0;L<k.rows.length;L+=S)await jt.bulkInsert(k.tableName,k.rows.slice(L,L+S));B++,v+=k.rows.length}c({tables:B,records:v}),a(4),n([]),window.dispatchEvent(new Event("db-updated"))}catch(k){const E=k instanceof Error?k.message:String(k);await Qt.error(e("common.error")+": "+E)}finally{g(!1)}};return l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"flex items-center gap-4 px-2",children:[{s:1,label:e("datasource.smart_import.step_upload")},{s:2,label:e("datasource.smart_import.step_config")},{s:3,label:e("datasource.smart_import.step_import")}].concat(r===4?[{s:4,label:e("datasource.smart_import.step_success")}]:[]).map(({s:v,label:B})=>l.jsxs(Wt.Fragment,{children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-[10px] font-black ${r>=v?"bg-blue-600 text-white":"bg-slate-200 text-slate-500"}`,children:v}),l.jsx("span",{className:`text-[10px] font-bold uppercase tracking-wider ${r>=v?"text-slate-700":"text-slate-400"}`,children:B})]}),v<(r===4?4:3)&&l.jsx(Yl,{className:"w-4 h-4 text-slate-300"})]},v))}),l.jsxs("div",{className:"min-h-[200px]",children:[r===1&&l.jsxs("div",{onClick:()=>x.current?.click(),className:"group relative border-2 border-dashed border-slate-200 hover:border-blue-400 hover:bg-blue-50/50 rounded-2xl p-12 transition-all cursor-pointer text-center",children:[l.jsx("input",{type:"file",ref:x,onChange:m,accept:".xlsx,.xls,.csv",className:"hidden"}),l.jsxs("div",{className:"flex flex-col items-center gap-4",children:[l.jsx("div",{className:"p-4 bg-blue-50 group-hover:bg-blue-100 rounded-2xl text-blue-600 transition-colors",children:l.jsx(yp,{className:"w-8 h-8"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-bold text-slate-700",children:e("datasource.smart_import.upload_label")}),l.jsx("p",{className:"text-xs text-slate-400 mt-1",children:e("datasource.smart_import.upload_hint")})]})]}),u&&l.jsx("div",{className:"absolute inset-0 bg-white/80 flex items-center justify-center rounded-2xl z-10",children:l.jsxs("div",{className:"flex items-center gap-3 text-blue-600",children:[l.jsx("div",{className:"w-5 h-5 border-2 border-current border-t-transparent rounded-full animate-spin"}),l.jsx("span",{className:"text-xs font-bold",children:e("common.loading")})]})})]}),r===2&&l.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-bottom-2 duration-300",children:[l.jsx("div",{className:"flex items-center justify-between mb-2",children:l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-bold text-slate-700",children:e("datasource.smart_import.found_tables")}),l.jsx("p",{className:"text-[10px] text-slate-400",children:e("datasource.smart_import.found_tables_hint")})]})}),l.jsx("div",{className:"space-y-3",children:s.map((v,B)=>l.jsx("div",{className:`p-4 rounded-xl border-2 transition-all ${v.isValid?"bg-white border-slate-100 shadow-sm":"bg-red-50 border-red-100"}`,children:l.jsxs("div",{className:"flex items-start justify-between gap-4",children:[l.jsxs("div",{className:"flex-1 space-y-3",children:[l.jsx("div",{className:"flex items-center gap-4",children:l.jsxs("div",{className:"flex-1",children:[l.jsxs("span",{className:"text-[9px] font-black text-slate-400 uppercase",children:[e("datasource.smart_import.sheet_label")," ",v.sheetName]}),l.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[l.jsx(CA,{className:"w-4 h-4 text-blue-500"}),l.jsx("input",{value:v.tableName,onChange:k=>{const E=[...s];E[B].tableName=k.target.value,E[B].isValid=k.target.value.length>0&&!k.target.value.startsWith("sys_"),n(E)},className:`text-sm font-bold bg-transparent border-b-2 outline-none w-full ${v.isValid?"border-blue-100 focus:border-blue-500":"border-red-300"}`,placeholder:e("datasource.smart_import.table_label")})]}),!v.isValid&&l.jsxs("p",{className:"text-[10px] text-red-500 mt-1 flex items-center gap-1",children:[l.jsx(Cn,{className:"w-3 h-3"})," ",e("datasource.smart_import.invalid_prefix")]})]})}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-bold text-slate-500",children:[l.jsx(wl,{className:"w-3 h-3"}),e("datasource.smart_import.columns_count",{count:v.columns.length})]}),l.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-bold text-slate-500",children:[l.jsx(C2,{className:"w-3 h-3"}),e("datasource.smart_import.rows_count",{count:v.rows.length})]})]}),l.jsxs("div",{className:"flex flex-wrap gap-1",children:[v.columns.slice(0,5).map(k=>l.jsxs("span",{className:"px-2 py-0.5 bg-slate-100 text-slate-600 rounded text-[9px] font-medium",children:[k.name," ",l.jsxs("span",{className:"opacity-50 font-mono",children:["(",k.type,")"]})]},k.name)),v.columns.length>5&&l.jsx("span",{className:"px-2 py-0.5 bg-slate-100 text-slate-400 rounded text-[9px] font-medium",children:e("datasource.smart_import.more_columns",{count:v.columns.length-5})})]})]}),l.jsx("button",{onClick:()=>n(s.filter((k,E)=>E!==B)),className:"p-2 text-slate-300 hover:text-red-500 hover:bg-red-50 rounded-lg transition-all",children:l.jsx(ii,{className:"w-4 h-4"})})]})},B))}),l.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-slate-100",children:[l.jsx("button",{onClick:()=>a(1),className:"px-4 py-2 text-slate-500 font-bold text-xs hover:bg-slate-100 rounded-lg transition-colors",children:e("datasource.smart_import.back_btn")}),l.jsxs("button",{onClick:()=>{a(3),w()},disabled:s.length===0||s.some(v=>!v.isValid)||h,className:"px-6 py-2.5 bg-blue-600 hover:bg-blue-700 disabled:opacity-30 disabled:cursor-not-allowed text-white rounded-xl text-xs font-black shadow-lg shadow-blue-500/20 transition-all flex items-center gap-2",children:[e("datasource.smart_import.start_import")," ",l.jsx(Yl,{className:"w-4 h-4"})]})]})]}),r===3&&l.jsxs("div",{className:"flex flex-col items-center justify-center p-12 text-center space-y-4",children:[l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"w-16 h-16 border-4 border-blue-100 border-t-blue-600 rounded-full animate-spin"}),l.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:l.jsx(wl,{className:"w-6 h-6 text-blue-600"})})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-bold text-slate-700",children:e("datasource.smart_import.import_running")}),l.jsx("p",{className:"text-xs text-slate-400 mt-1",children:e("common.loading")})]})]}),r===4&&l.jsxs("div",{className:"flex flex-col items-center justify-center p-12 text-center space-y-6 animate-in zoom-in-95 duration-500",children:[l.jsx("div",{className:"w-20 h-20 bg-emerald-50 text-emerald-600 rounded-full flex items-center justify-center shadow-inner ring-8 ring-emerald-50/50",children:l.jsx(If,{className:"w-10 h-10"})}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("h4",{className:"text-xl font-black text-slate-800 tracking-tight",children:e("datasource.smart_import.import_success_title")}),l.jsx("p",{className:"text-sm text-slate-500 max-w-[280px] leading-relaxed",children:e("datasource.smart_import.import_success_hint",{count:o.tables})})]}),l.jsxs("div",{className:"flex items-center gap-8 py-4 px-8 bg-slate-50 rounded-2xl border border-slate-100",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1",children:e("datasource.smart_import.found_tables")}),l.jsx("p",{className:"text-lg font-black text-slate-700",children:o.tables})]}),l.jsx("div",{className:"w-px h-8 bg-slate-200"}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1",children:e("datasource.smart_import.rows_count",{count:0}).replace("0","").trim()}),l.jsx("p",{className:"text-lg font-black text-slate-700",children:o.records})]})]}),l.jsx("button",{onClick:()=>a(1),className:"px-8 py-3 bg-slate-900 hover:bg-black text-white rounded-xl text-sm font-bold transition-all transform hover:scale-105 active:scale-95 shadow-xl shadow-slate-900/10",children:e("datasource.smart_import.finish_btn")})]})]})]})},sF=({schema:e})=>{const{t}=ds();if(!e)return null;const r=e.items||e,a=r.properties,s=r.required||[];if(!a)return l.jsx("div",{className:"p-4 text-center text-slate-400 italic text-sm",children:"Keine Feld-Informationen verfgbar."});const n=Object.entries(a),o=e.indexes||[];return l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"overflow-x-auto rounded-xl border border-slate-200 dark:border-slate-700",children:l.jsxs("table",{className:"w-full text-sm text-left border-collapse",children:[l.jsx("thead",{className:"bg-slate-50 dark:bg-slate-900/50 text-slate-500 uppercase text-[11px] font-bold",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 border-b border-slate-200 dark:border-slate-700",children:"Property"}),l.jsx("th",{className:"px-4 py-3 border-b border-slate-200 dark:border-slate-700",children:"Type"}),l.jsx("th",{className:"px-4 py-3 border-b border-slate-200 dark:border-slate-700",children:"Constraints"}),l.jsx("th",{className:"px-4 py-3 border-b border-slate-200 dark:border-slate-700",children:"Description"})]})}),l.jsx("tbody",{children:n.map(([c,u])=>l.jsxs("tr",{className:"hover:bg-slate-50/80 dark:hover:bg-slate-800/50 transition-colors border-b border-slate-100 dark:border-slate-800 last:border-0",children:[l.jsx("td",{className:"px-4 py-4 align-top",children:l.jsxs("div",{className:"font-mono font-bold text-slate-900 dark:text-white flex items-center gap-1.5",children:[c,s.includes(c)&&l.jsx("span",{className:"text-[10px] text-red-500 font-bold px-1.5 py-0.5 bg-red-50 dark:bg-red-900/20 rounded border border-red-100 dark:border-red-900/30",children:"REQ"})]})}),l.jsx("td",{className:"px-4 py-4 align-top",children:l.jsx("code",{className:"text-[11px] px-1.5 py-0.5 bg-slate-100 dark:bg-slate-700 rounded text-slate-600 dark:text-slate-300",children:u.type})}),l.jsx("td",{className:"px-4 py-4 align-top",children:l.jsxs("div",{className:"flex flex-wrap gap-1",children:[u.enum&&l.jsxs("div",{className:"w-full mb-1",children:[l.jsx("span",{className:"text-[10px] text-slate-400 uppercase font-bold block mb-1",children:"Allowed Values:"}),l.jsx("div",{className:"flex flex-wrap gap-1",children:u.enum.map(f=>l.jsx("span",{className:"text-[10px] px-1 bg-amber-50 dark:bg-amber-900/20 text-amber-600 dark:text-amber-400 border border-amber-100 dark:border-amber-900/30 rounded",children:f},f))})]}),u.pattern&&l.jsxs("div",{className:"w-full",children:[l.jsx("span",{className:"text-[10px] text-slate-400 uppercase font-bold block mb-0.5",children:"Regex Pattern:"}),l.jsx("code",{className:"text-[10px] text-indigo-500 font-mono break-all",children:u.pattern})]}),u.format&&l.jsx("span",{className:"text-[10px] px-1 bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 border border-blue-100 dark:border-blue-900/30 rounded uppercase",children:u.format}),u.minimum!==void 0&&l.jsxs("span",{className:"text-[10px] px-1 bg-slate-50 dark:bg-slate-700 text-slate-500 rounded font-mono",children:["min: ",u.minimum]}),u.maximum!==void 0&&l.jsxs("span",{className:"text-[10px] px-1 bg-slate-50 dark:bg-slate-700 text-slate-500 rounded font-mono",children:["max: ",u.maximum]})]})}),l.jsx("td",{className:"px-4 py-4 align-top text-slate-600 dark:text-slate-400 text-xs leading-relaxed",children:u.description||l.jsx("span",{className:"opacity-30 italic",children:"No description available"})})]},c))})]})}),l.jsxs("div",{className:"rounded-xl border border-slate-200 dark:border-slate-700 p-4 bg-white dark:bg-slate-900/30",children:[l.jsx("div",{className:"text-[11px] font-bold uppercase tracking-wider text-slate-500 mb-2",children:t("datasource.indexes_title","Indexes")}),o.length===0?l.jsx("div",{className:"text-xs text-slate-400 italic",children:t("datasource.indexes_empty","No indexes available.")}):l.jsx("div",{className:"space-y-2",children:o.map(c=>l.jsxs("div",{className:"p-2.5 rounded-lg border border-slate-100 dark:border-slate-800 bg-slate-50/70 dark:bg-slate-900/40",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx("span",{className:"font-mono text-xs font-bold text-slate-700 dark:text-slate-200",children:c.name}),c.unique&&l.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-emerald-50 border border-emerald-200 text-emerald-700 dark:bg-emerald-900/20 dark:border-emerald-900/30 dark:text-emerald-300",children:"UNIQUE"}),c.partial&&l.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-amber-50 border border-amber-200 text-amber-700 dark:bg-amber-900/20 dark:border-amber-900/30 dark:text-amber-300",children:"PARTIAL"})]}),l.jsxs("div",{className:"text-[11px] text-slate-500",children:[t("datasource.indexes_columns","Columns"),": ",l.jsx("span",{className:"font-mono text-slate-700 dark:text-slate-300",children:c.columns.join(", ")||"-"}),c.origin?l.jsxs("span",{className:"ml-2 text-slate-400",children:["(",c.origin,")"]}):null]})]},c.name))})]})]})},ZV=({type:e,title:t,message:r,details:a,onClose:s,className:n=""})=>{const c={success:{bg:"bg-emerald-50 dark:bg-emerald-900/20",border:"border-emerald-100 dark:border-emerald-800/50",text:"text-emerald-800 dark:text-emerald-200",icon:l.jsx(If,{className:"w-5 h-5 text-emerald-500"})},error:{bg:"bg-red-50 dark:bg-red-900/20",border:"border-red-100 dark:border-red-800/50",text:"text-red-800 dark:text-red-200",icon:l.jsx(Cn,{className:"w-5 h-5 text-red-500"})},warning:{bg:"bg-amber-50 dark:bg-amber-900/20",border:"border-amber-100 dark:border-amber-800/50",text:"text-amber-800 dark:text-amber-200",icon:l.jsx(t0,{className:"w-5 h-5 text-amber-500"})},info:{bg:"bg-blue-50 dark:bg-blue-900/20",border:"border-blue-100 dark:border-blue-800/50",text:"text-blue-800 dark:text-blue-200",icon:l.jsx(iu,{className:"w-5 h-5 text-blue-500"})}}[e];return l.jsxs("div",{className:`p-4 rounded-2xl border-2 ${c.bg} ${c.border} flex items-start gap-4 animate-in slide-in-from-top-2 duration-300 ${n}`,children:[l.jsx("div",{className:"shrink-0 mt-0.5",children:c.icon}),l.jsxs("div",{className:"flex-1 min-w-0",children:[t&&l.jsx("h5",{className:`text-sm font-black uppercase tracking-wider mb-1 ${c.text}`,children:t}),l.jsx("p",{className:`text-sm font-medium leading-relaxed ${c.text}`,children:r}),a&&l.jsx("div",{className:"mt-3 p-3 bg-white/50 dark:bg-black/20 rounded-xl border border-white/50 dark:border-white/5",children:l.jsx("pre",{className:"text-[10px] font-mono whitespace-pre-wrap break-all opacity-80",children:a})})]}),s&&l.jsx("button",{onClick:s,className:"p-1 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg transition-colors shrink-0",children:l.jsx(vl,{className:"w-4 h-4 opacity-50"})})]})},eG=()=>{const{t:e}=ds(),[t,r]=Jt("excel_mappings_v2",{}),a=Z.useRef(null),[s,n]=Wt.useState(null),[o,c]=Wt.useState(null),u=()=>{try{const x=JSON.stringify(t,null,2),m=new Blob([x],{type:"application/json"}),w=URL.createObjectURL(m),v=document.createElement("a");v.href=w,v.download=`itdashboard_mappings_${new Date().toISOString().split("T")[0]}.json`,v.click(),URL.revokeObjectURL(w),c("success"),n(e("common.success"))}catch(x){const m=x instanceof Error?x.message:String(x);c("error"),n(e("common.error")+": "+m)}},f=x=>{const m=x.target.files?.[0];if(!m)return;const w=new FileReader;w.onload=v=>{try{const B=JSON.parse(v.target?.result);if(typeof B!="object"||B===null)throw new Error("Invalid JSON");r(k=>({...k,...B})),c("success"),n(e("common.success"))}catch(B){const k=B instanceof Error?B.message:String(B);c("error"),n(e("common.error")+": "+k)}},w.readAsText(m),a.current&&(a.current.value="")},h=async()=>{await Qt.confirm(e("datasource.clear_mappings_confirm"))&&(r({}),c("success"),n(e("common.success")))};Wt.useEffect(()=>{if(s){const x=setTimeout(()=>{n(null),c(null)},3e3);return()=>clearTimeout(x)}},[s]);const g=Object.keys(t).length;return l.jsxs("div",{className:"flex items-center gap-3",children:[s&&l.jsxs("div",{className:`text-xs px-2 py-1 rounded flex items-center gap-1.5 animate-in fade-in slide-in-from-right-4 ${o==="success"?"bg-green-50 text-green-700 dark:bg-green-900/20 dark:text-green-300":"bg-red-50 text-red-700 dark:bg-red-900/20 dark:text-red-300"}`,children:[o==="success"?l.jsx(If,{className:"w-3 h-3"}):l.jsx(Cn,{className:"w-3 h-3"}),s]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-xs text-slate-400 mr-2",children:e("datasource.mappings_saved",{count:g})}),l.jsx("button",{onClick:u,disabled:g===0,className:"p-1.5 text-slate-500 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-slate-700 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:e("datasource.export_mappings"),children:l.jsx(Jx,{className:"w-4 h-4"})}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:"file",accept:".json",ref:a,onChange:f,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",title:e("datasource.import_mappings")}),l.jsx("button",{className:"p-1.5 text-slate-500 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-slate-700 rounded transition-colors pointer-events-none",children:l.jsx(yp,{className:"w-4 h-4"})})]}),l.jsx("div",{className:"w-px h-4 bg-slate-200 dark:bg-slate-700 mx-1"}),l.jsx("button",{onClick:h,disabled:g===0,className:"p-1.5 text-slate-500 hover:text-red-600 hover:bg-red-50 dark:hover:bg-slate-700 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:e("datasource.clear_mappings"),children:l.jsx(ii,{className:"w-4 h-4"})})]})]})},nF=()=>{const{lastBackup:e,changeCount:t,markBackupComplete:r}=So();return{lastBackup:e?new Date(e):null,changeCount:t,isBackupRecommended:t>0,markBackupComplete:r}},Po=UA("DatasourceView"),tG=["litebistudio_","data_inspector_","query_builder_","data_table_","ui_table_","notifications_","import_"],rG=new Set(["app_log_level","custom_dashboard_layout","excel_mappings_v2","i18nextLng","visibleComponentIds","visibleSidebarComponentIds","componentOrder","isSidebarCollapsed"]),aG=["litebistudio_","data_inspector_","query_builder_"],Uh=e=>String(e).padStart(2,"0"),sG=(e,t)=>{const r=new Date,a=`${r.getFullYear()}-${Uh(r.getMonth()+1)}-${Uh(r.getDate())}`,s=`${Uh(r.getHours())}${Uh(r.getMinutes())}${Uh(r.getSeconds())}`,n=`${a}_${s}`,o=t?"secure":"standard",f=(e||"backup_{date}_{mode}").trim().replace(/\{date\}/gi,a).replace(/\{time\}/gi,s).replace(/\{datetime\}/gi,n).replace(/\{mode\}/gi,o).replace(/[<>:"/\\|?*]/g,"_"),g=Array.from(f).map(x=>x.charCodeAt(0)<32?"_":x).join("").trim()||`backup_${a}_${o}`;return g.toLowerCase().endsWith(".sqlite3")?g:`${g}.sqlite3`},nG=()=>{const e=Object.keys(window.localStorage);for(const r of e)(rG.has(r)||tG.some(a=>r.startsWith(a)))&&window.localStorage.removeItem(r);const t=Object.keys(window.sessionStorage);for(const r of t)aG.some(a=>r.startsWith(a))&&window.sessionStorage.removeItem(r)},iG=({onImportComplete:e})=>{const{t,i18n:r}=ds(),a=jA(),s=new Date,n=t("settings.last_update",{date:s.toLocaleDateString(r.language==="de"?"de-DE":"en-US"),time:s.toLocaleTimeString(r.language==="de"?"de-DE":"en-US",{hour:"2-digit",minute:"2-digit"})}),{isReadOnly:o,isAdminMode:c}=So(),u=Re=>Re instanceof Error?Re.message:String(Re),[f,h]=Z.useState(()=>{const Re=sessionStorage.getItem("litebistudio_datasource_tab");return Re==="import"||Re==="structure"||Re==="system"?Re:"import"});Z.useEffect(()=>{sessionStorage.setItem("litebistudio_datasource_tab",f)},[f]);const[g,x]=Z.useState(""),[m,w]=Z.useState(null),[v,B]=Z.useState(!1),[k,E]=Z.useState(!1),[S,L]=Z.useState(""),[P,R]=Z.useState(""),[Q,V]=Z.useState([]),[U,M]=Z.useState(!1),[T,D]=Z.useState(""),[G,ne]=Z.useState([]),[H,ee]=Z.useState(!1),[le,pe]=Z.useState(""),[te,Le]=Z.useState(!1),[je,F]=Z.useState(`CREATE TABLE usr_my_table (
    id INTEGER PRIMARY KEY,
    name TEXT,
    amount REAL
);`),[K,I]=Z.useState([{name:"id",type:"INTEGER PRIMARY KEY"}]),{isBackupRecommended:q,changeCount:J,markBackupComplete:Y}=nF(),[de,ue]=Z.useState(!1),[we,Ie]=Z.useState(""),[Ae,oe]=Z.useState(null),[He,se]=Z.useState(!1),[qe,Ye]=Z.useState(!1),[at]=Jt("backup_file_name_pattern","backup_{date}_{mode}"),[Ge]=Jt("backup_use_saved_location",!0),pt=Z.useRef(null),nt=tg(),Dt=async Re=>{const Et=()=>new Date().toLocaleTimeString();Po.debug(`[Restore][${Et()}] File selected:`,Re.name,Re.size,Re.type);try{Po.debug(`[Restore][${Et()}] Calling file.arrayBuffer()...`);const Tt=await Re.arrayBuffer();Po.debug(`[Restore][${Et()}] Buffer received, size:`,Tt.byteLength);const Bt=new Uint8Array(Tt.slice(0,16)),Mr=new TextDecoder().decode(Bt).startsWith("SQLite format 3");Po.debug("[Restore] Header check - isSqlite:",Mr);let Jr=Tt;if(!Mr){const jr=await Qt.prompt(t("datasource.restore_encrypted_prompt"));if(!jr)return;try{Jr=await LK(Tt,jr)}catch{oe({type:"error",title:t("common.error"),message:t("datasource.restore_failed")});return}}if(!await Qt.confirm(t("datasource.restore_confirm")))return;Po.info(`[Restore][${Et()}] User confirmed restore. Starting process...`),oe({type:"warning",title:t("common.loading"),message:"Verarbeite Backup-Datei..."});try{Po.debug(`[Restore][${Et()}] Importing db module...`);const{importDatabase:jr}=await BA(async()=>{const{importDatabase:re}=await Promise.resolve().then(()=>Wu);return{importDatabase:re}},void 0);Po.debug(`[Restore][${Et()}] Calling worker importDatabase...`);const fr=await jr(Jr);Po.debug(`[Restore][${Et()}] Worker report received:`,fr);const{versionInfo:Cr}=fr;if(!fr.headerMatch){oe({type:"error",title:t("datasource.restore_invalid"),message:fr.error||t("datasource.restore_warning_hint")});return}if(fr.error){oe({type:"error",title:fr.isDowngrade?"Incompatible Backup":t("common.error"),message:fr.error,details:Cr?`Backup Version: V${Cr.backup} | App Version: V${Cr.current}`:void 0});return}if(fr.isValid)oe({type:"success",title:t("common.success"),message:t("datasource.restore_success_reload"),details:Cr?`Database Version: V${Cr.backup} (Upgraded to V${Cr.current})`:void 0}),Po.info(`[Restore][${Et()}] Success! Reloading in 2s...`),Y(),setTimeout(()=>window.location.reload(),2e3);else{let re="";if(Cr&&(re+=`Schema: V${Cr.backup} -> V${Cr.current} (Update required)

`),fr.missingTables.length>0&&(re+=t("datasource.restore_missing_tables")+`
- `+fr.missingTables.join(`
- `)+`

`),Object.keys(fr.missingColumns).length>0){re+=t("datasource.restore_missing_columns")+`
`;for(const[ke,me]of Object.entries(fr.missingColumns))re+=`- ${ke}: ${me.join(", ")}
`}oe({type:"warning",title:t("datasource.restore_warning_title"),message:t("datasource.restore_warning_hint"),details:re})}}catch(jr){Po.error(`[Restore][${Et()}] Inner Error:`,jr),oe({type:"error",title:t("common.error"),message:u(jr)})}}catch(Tt){Po.error(`[Restore][${Et()}] Outer Error:`,Tt),oe({type:"error",title:t("common.error"),message:u(Tt)})}},It=async()=>{if(oe(null),Ge&&nt){const Re=await GK();if(Re.cancelled)return;if(Re.file){await Dt(Re.file);return}pt.current&&pt.current.click();return}pt.current&&pt.current.click()},{data:Ot,refresh:sr}=Ai(()=>jt.getTables(),[]),{data:er,refresh:cr}=Ai(()=>jt.getDataSources(),[]),Vt=Re=>Re.startsWith("sys_")||Re==="sqlite_sequence",mt=Ot?.filter(Re=>!Vt(Re))||[],Nt=Ot?.filter(Re=>Vt(Re))||[],gt=(er||[]).filter(Re=>Re.type==="view"&&!Vt(Re.name)),{data:dr}=Ai(async()=>{if(f!=="structure"||mt.length===0)return{};const Re=await Promise.all(mt.map(async Et=>{const[Tt,Bt]=await Promise.all([jt.executeRaw(`SELECT COUNT(*) AS count FROM "${Et}"`),jt.executeRaw("SELECT COUNT(*) AS count FROM sqlite_master WHERE type='index' AND LOWER(tbl_name) = LOWER(?) AND name NOT LIKE 'sqlite_%'",[Et])]);return[Et,{rows:Number(Tt[0]?.count||0),indexes:Number(Bt[0]?.count||0)}]}));return Object.fromEntries(Re)},[f,mt.join("|")],{cacheKey:`datasource-table-meta-${mt.join("|")}`,ttl:15e3}),{data:Ht}=Ai(async()=>{if(f!=="structure"||gt.length===0)return{};const Re=await Promise.all(gt.map(async Et=>{try{const Tt=await jt.executeRaw(`SELECT COUNT(*) AS count FROM "${Et.name}"`);return[Et.name,{valid:!0,rows:Number(Tt[0]?.count||0)}]}catch(Tt){return[Et.name,{valid:!1,error:u(Tt)}]}}));return Object.fromEntries(Re)},[f,gt.map(Re=>Re.name).join("|")],{cacheKey:`datasource-view-meta-${gt.map(Re=>Re.name).join("|")}`,ttl:15e3});Z.useEffect(()=>{(async()=>{if(!g){w(null);return}try{const[Et,Tt]=await Promise.all([jt.getTableSchema(g),jt.getTableIndexes(g)]),Bt={};Et.forEach(Yt=>{Bt[Yt.name]={type:Yt.type.toUpperCase().includes("INT")||Yt.type.toUpperCase().includes("REAL")?"number":"string",description:Yt.type}}),w({title:g,description:t("datasource.records_label",{name:g}),properties:Bt,required:Et.filter(Yt=>Yt.notnull).map(Yt=>Yt.name),indexes:Tt.map(Yt=>({name:Yt.name,unique:Yt.unique,columns:Yt.columns,origin:Yt.origin,partial:Yt.partial}))})}catch(Et){Po.error("Failed to load schema",Et),w(null)}})()},[g,Ot,v,t]);const $t=(()=>{if(!(!g||!m))return{key:`import_${g}`,entityLabel:t("datasource.records_label",{name:g}),schema:m,validate:()=>!0,getValidationErrors:()=>[],importFn:async Re=>{for(let Tt=0;Tt<Re.length;Tt+=500)await jt.bulkInsert(g,Re.slice(Tt,Tt+500))},clearFn:async()=>{await jt.executeRaw(`DELETE FROM ${g}`)}}})(),vr=async()=>{try{if(te)await jt.executeRaw(je);else{const Re=K.map(Tt=>`${Tt.name} ${Tt.type}`).join(", "),Et=`CREATE TABLE ${le} (${Re})`;await jt.executeRaw(Et)}ee(!1),sr(),pe(""),I([{name:"id",type:"INTEGER PRIMARY KEY"}]),await Qt.info(t("datasource.table_created"))}catch(Re){await Qt.error(t("common.error")+": "+u(Re))}},vt=async Re=>{if(!(localStorage.getItem("notifications_confirm_destructive")!=="false"&&!await Qt.confirm(t("datasource.drop_confirm",{name:Re}))))try{await jt.executeRaw(`DROP TABLE ${Re}`),sr(),cr(),g===Re&&x("")}catch(Tt){await Qt.error(t("common.error")+": "+u(Tt))}},kr=async Re=>{if(!(localStorage.getItem("notifications_confirm_destructive")!=="false"&&!await Qt.confirm(t("datasource.drop_view_confirm",`View "${Re}" lschen?`,{name:Re}))))try{await jt.executeRaw(`DROP VIEW ${Re}`),sr(),cr(),g===Re&&x("")}catch(Tt){await Qt.error(t("common.error")+": "+u(Tt))}},tr=async Re=>{if(!(localStorage.getItem("notifications_confirm_destructive")!=="false"&&!await Qt.confirm(t("datasource.clear_confirm",{name:Re}))))try{await jt.executeRaw(`DELETE FROM ${Re}`),sr(),await Qt.info(t("datasource.cleared_success"))}catch(Tt){await Qt.error(t("common.error")+": "+u(Tt))}},rr=async()=>{const Re=t("datasource.sql_manager_reset_confirm","Reset SQL Manager? All saved SQL statements and favorites will be deleted.");if(!await Qt.confirm(Re))return;const Et=await Qt.prompt(t("datasource.sql_manager_reset_prompt",'Please type "RESET" to continue:'));if(Et!=="RESET"){Et!==null&&await Qt.warning(t("datasource.sql_manager_reset_aborted","Canceled: Wrong input."));return}try{Ye(!0),await jt.executeRaw("DELETE FROM sys_sql_statement;"),await Qt.info(t("datasource.sql_manager_reset_success","SQL Manager was reset."))}catch(Tt){await Qt.error(t("common.error")+": "+u(Tt))}finally{Ye(!1)}},Xt=Re=>`"${Re.replace(/"/g,'""')}"`,Kt=async Re=>{try{const Tt=(await jt.getTableSchema(Re)).map(Bt=>Bt.name).filter(Boolean);L(Re),ne(Tt),V([]),M(!1),D(""),R(`idx_${Re}_`),E(!0)}catch(Et){await Qt.error(t("common.error")+": "+u(Et))}},Ft=Re=>{V(Et=>Et.includes(Re)?Et.filter(Tt=>Tt!==Re):[...Et,Re])},Zt=(Re,Et)=>{V(Tt=>{const Bt=Tt.indexOf(Re);if(Bt===-1)return Tt;const Yt=Et==="up"?Bt-1:Bt+1;if(Yt<0||Yt>=Tt.length)return Tt;const Mr=[...Tt];return[Mr[Bt],Mr[Yt]]=[Mr[Yt],Mr[Bt]],Mr})},wr=async()=>{const Re=P.trim();if(!Re){await Qt.warning(t("datasource.index_create_name_required","Bitte einen Indexnamen angeben."));return}if(Q.length===0){await Qt.warning(t("datasource.index_create_columns_required","Bitte mindestens eine Spalte auswhlen."));return}try{const Et=U?"UNIQUE ":"",Tt=Q.map(Xt).join(", "),Bt=T.trim()?` WHERE ${T.trim()}`:"",Yt=`CREATE ${Et}INDEX ${Xt(Re)} ON ${Xt(S)} (${Tt})${Bt};`;await jt.executeRaw(Yt),E(!1),await sr(),await Qt.info(t("datasource.index_create_success","Index erstellt."))}catch(Et){await Qt.error(t("common.error")+": "+u(Et))}};return l.jsxs(x0,{header:{title:t("sidebar.datasource"),subtitle:t("datasource.subtitle"),onBack:()=>a(-1)},footer:n,children:[l.jsxs("div",{className:`max-w-4xl space-y-6 ${o?"opacity-80":""}`,children:[l.jsx("div",{className:"border-b border-slate-200 dark:border-slate-700",children:l.jsxs("div",{className:"flex items-center gap-8 px-1",children:[l.jsxs("button",{onClick:()=>h("import"),className:`relative py-3 text-sm font-bold transition-colors ${f==="import"?"text-blue-600 dark:text-blue-400":"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"}`,children:[t("datasource.tab_import"),f==="import"&&l.jsx("span",{className:"absolute left-0 right-0 -bottom-px h-0.5 bg-blue-600 dark:bg-blue-400"})]}),l.jsxs("button",{onClick:()=>h("structure"),className:`relative py-3 text-sm font-bold transition-colors ${f==="structure"?"text-blue-600 dark:text-blue-400":"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"}`,children:[t("datasource.tab_structure"),f==="structure"&&l.jsx("span",{className:"absolute left-0 right-0 -bottom-px h-0.5 bg-blue-600 dark:bg-blue-400"})]}),l.jsxs("button",{onClick:()=>h("system"),className:`relative py-3 text-sm font-bold transition-colors ${f==="system"?"text-blue-600 dark:text-blue-400":"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"}`,children:[t("datasource.tab_system"),f==="system"&&l.jsx("span",{className:"absolute left-0 right-0 -bottom-px h-0.5 bg-blue-600 dark:bg-blue-400"})]})]})}),f==="import"&&l.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[l.jsxs("div",{className:`bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm ${o?"pointer-events-none opacity-60":""}`,children:[l.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[l.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg text-blue-600",children:l.jsx(eA,{className:"w-5 h-5"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-sm font-bold text-slate-700 dark:text-slate-200 uppercase tracking-widest",children:t("datasource.smart_import_title")}),l.jsx("p",{className:"text-xs text-slate-400",children:t("datasource.smart_import_hint")})]})]}),l.jsx(JV,{})]}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:"h-px bg-slate-200 dark:bg-slate-700 flex-1"}),l.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase",children:t("datasource.or_separator")}),l.jsx("div",{className:"h-px bg-slate-200 dark:bg-slate-700 flex-1"})]}),l.jsxs("div",{className:`bg-slate-50 dark:bg-slate-800/50 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm ${o?"pointer-events-none opacity-60":""}`,children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-2 bg-white dark:bg-slate-700 rounded-lg text-slate-600 dark:text-slate-300 shadow-sm",children:l.jsx(wl,{className:"w-5 h-5"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-sm font-bold text-slate-700 dark:text-slate-200 uppercase tracking-widest",children:t("datasource.append_data_title")}),l.jsx("p",{className:"text-xs text-slate-400",children:t("datasource.append_data_hint")})]})]}),l.jsx(eG,{})]}),l.jsx("div",{className:"mb-6",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("select",{value:g,onChange:Re=>x(Re.target.value),className:"w-full md:w-1/2 p-2.5 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-sm font-medium text-slate-700 dark:text-slate-200 outline-none focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"",disabled:!0,children:t("datasource.select_target_table")}),Ot?.filter(Re=>!Vt(Re)).map(Re=>l.jsx("option",{value:Re,children:Re},Re))]}),l.jsx("button",{onClick:()=>sr(),className:"p-2.5 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 text-slate-400 dark:text-slate-500 hover:text-blue-600 dark:hover:text-blue-400 rounded-lg",children:l.jsx(Zc,{className:"w-5 h-5"})})]})}),g&&l.jsx(XV,{onImportComplete:e,config:$t},g)]})]}),f==="structure"&&l.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[l.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wider flex items-center gap-2",children:[l.jsx(CA,{className:"w-4 h-4"})," ",t("datasource.user_tables")]}),l.jsx("p",{className:"text-xs text-slate-400 mt-1",children:t("datasource.user_tables_hint")})]}),!o&&l.jsxs("button",{onClick:()=>ee(!0),className:"flex items-center gap-2 px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-xs font-bold transition-colors shadow-sm",children:[l.jsx(eA,{className:"w-4 h-4"})," ",t("datasource.new_table")]})]}),mt.length===0?l.jsx("div",{className:"p-8 text-center border-2 border-dashed border-slate-200 dark:border-slate-700 rounded-xl bg-slate-50 dark:bg-slate-900/40",children:l.jsx("p",{className:"text-slate-400 dark:text-slate-500 text-sm",children:t("datasource.no_user_tables")})}):l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:mt.map(Re=>l.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-slate-900/40 border border-slate-200 dark:border-slate-700 rounded-xl flex items-center justify-between group",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-2 bg-white dark:bg-slate-800 rounded-lg shadow-sm text-blue-600 dark:text-blue-400",children:l.jsx(CA,{className:"w-4 h-4"})}),l.jsxs("div",{className:"flex flex-col min-w-0",children:[l.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-200 truncate",children:Re}),l.jsxs("span",{className:"text-[10px] text-slate-400 dark:text-slate-500",children:[t("datasource.table_meta_rows",{count:dr?.[Re]?.rows??0}),"  ",t("datasource.table_meta_indexes",{count:dr?.[Re]?.indexes??0})]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>{x(Re),B(!0)},className:"p-1.5 text-slate-400 dark:text-slate-500 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-colors",title:t("datasource.show_schema"),children:l.jsx(iu,{className:"w-4 h-4"})}),!o&&l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:()=>{Kt(Re)},className:"p-1.5 text-slate-400 dark:text-slate-500 hover:text-indigo-600 dark:hover:text-indigo-400 hover:bg-indigo-50 dark:hover:bg-indigo-900/20 rounded transition-colors",title:t("datasource.create_index_title","Index erstellen"),children:l.jsx(WS,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>{x(Re),h("import")},className:"p-1.5 text-slate-400 dark:text-slate-500 hover:text-green-600 dark:hover:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/20 rounded transition-colors",title:t("datasource.append_data_short"),children:l.jsx(yp,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>vt(Re),className:"p-1.5 text-slate-400 dark:text-slate-500 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors",title:t("common.delete"),children:l.jsx(ii,{className:"w-4 h-4"})})]})]})]},Re))})]}),l.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm",children:[l.jsx("div",{className:"flex items-center justify-between mb-6",children:l.jsxs("div",{children:[l.jsxs("h3",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wider flex items-center gap-2",children:[l.jsx(CA,{className:"w-4 h-4"})," ",t("datasource.user_views","Views")]}),l.jsx("p",{className:"text-xs text-slate-400 mt-1",children:t("datasource.user_views_hint","SQL views available in the local database.")})]})}),gt.length===0?l.jsx("div",{className:"p-8 text-center border-2 border-dashed border-slate-200 dark:border-slate-700 rounded-xl bg-slate-50 dark:bg-slate-900/40",children:l.jsx("p",{className:"text-slate-400 dark:text-slate-500 text-sm",children:t("datasource.no_user_views","No views available.")})}):l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:gt.map(Re=>l.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-slate-900/40 border border-slate-200 dark:border-slate-700 rounded-xl flex items-center justify-between group",children:[l.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[l.jsx("div",{className:"p-2 bg-white dark:bg-slate-800 rounded-lg shadow-sm text-indigo-600 dark:text-indigo-400",children:l.jsx(CA,{className:"w-4 h-4"})}),l.jsxs("div",{className:"min-w-0",children:[l.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-200 block truncate",children:Re.name}),Ht?.[Re.name]?.valid===!1?l.jsx("span",{className:"text-[10px] text-rose-500 block",title:Ht?.[Re.name]?.error,children:t("datasource.view_invalid","Defekter View")}):l.jsx("span",{className:"text-[10px] text-slate-400 dark:text-slate-500 block",children:t("datasource.table_meta_rows",{count:Ht?.[Re.name]?.rows??0})})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>{x(Re.name),B(!0)},disabled:Ht?.[Re.name]?.valid===!1,className:`p-1.5 rounded transition-colors ${Ht?.[Re.name]?.valid===!1?"text-slate-300 dark:text-slate-600 cursor-not-allowed":"text-slate-400 dark:text-slate-500 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20"}`,title:Ht?.[Re.name]?.valid===!1?t("datasource.view_invalid","Defekter View"):t("datasource.show_schema"),children:l.jsx(iu,{className:"w-4 h-4"})}),!o&&l.jsx("button",{onClick:()=>kr(Re.name),className:"p-1.5 text-slate-400 dark:text-slate-500 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors",title:t("datasource.drop_view_title","Delete view"),children:l.jsx(ii,{className:"w-4 h-4"})})]})]},Re.name))})]}),c&&l.jsxs("div",{className:"bg-slate-100 dark:bg-slate-800/50 rounded-2xl p-6",children:[l.jsx("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest mb-4",children:t("datasource.system_tables")}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:Nt.map(Re=>l.jsx("button",{onClick:()=>{x(Re),B(!0)},className:"px-3 py-2 bg-white/50 dark:bg-slate-800/60 border border-slate-200/50 dark:border-slate-700 rounded text-xs font-mono text-slate-500 dark:text-slate-400 hover:bg-white dark:hover:bg-slate-800 hover:text-blue-600 dark:hover:text-blue-400 text-left transition-colors",children:Re},Re))})]})]}),f==="system"&&l.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[l.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm",children:[l.jsx("h3",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wider mb-4",children:t("datasource.backup_restore")}),q&&l.jsxs("div",{className:"mb-4 p-3 bg-amber-50 dark:bg-amber-900/20 text-amber-800 dark:text-amber-200 rounded-lg border border-amber-200 dark:border-amber-800/50 text-xs flex items-center gap-2",children:[l.jsx(t0,{className:"w-4 h-4"}),l.jsx("span",{children:t("datasource.backup_recommended",{count:J})})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"flex items-center gap-2",children:l.jsxs("button",{onClick:()=>ue(!de),className:`flex-1 p-3 rounded-xl border flex items-center gap-3 transition-all ${de?"bg-emerald-50 dark:bg-emerald-900/20 border-emerald-200 dark:border-emerald-800 ring-1 ring-emerald-500/70 dark:ring-emerald-700/70":"bg-slate-50 dark:bg-slate-900/40 border-slate-200 dark:border-slate-700"}`,children:[l.jsx("div",{className:`p-2 rounded-lg ${de?"bg-emerald-100 dark:bg-emerald-900/40 text-emerald-600 dark:text-emerald-300":"bg-slate-200 dark:bg-slate-700 text-slate-500 dark:text-slate-300"}`,children:de?l.jsx(H0,{className:"w-4 h-4"}):l.jsx(zS,{className:"w-4 h-4"})}),l.jsxs("div",{className:"text-left",children:[l.jsx("div",{className:`text-sm font-bold ${de?"text-emerald-900 dark:text-emerald-200":"text-slate-600 dark:text-slate-200"}`,children:t(de?"datasource.encryption_active":"datasource.encryption_standard")}),l.jsx("div",{className:"text-xs text-slate-400 dark:text-slate-500",children:t(de?"datasource.encryption_active_hint":"datasource.encryption_standard_hint")})]})]})}),de&&l.jsx("div",{className:"animate-in fade-in slide-in-from-top-2",children:l.jsx("input",{type:"password",placeholder:t("datasource.backup_password_placeholder"),value:we,onChange:Re=>Ie(Re.target.value),className:"w-full p-3 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-200 rounded-xl outline-none focus:ring-2 focus:ring-emerald-500",autoFocus:!0})}),Ae&&l.jsx("div",{className:"mb-4",children:l.jsx(ZV,{type:Ae.type,title:Ae.title,message:Ae.message,details:Ae.details,onClose:()=>oe(null)})}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 pt-2",children:[l.jsxs("button",{onClick:async()=>{try{if(de&&we.length<4){await Qt.warning(t("datasource.backup_password_error"));return}const{exportDatabase:Re}=await BA(async()=>{const{exportDatabase:fr}=await Promise.resolve().then(()=>Wu);return{exportDatabase:fr}},void 0),Et=await Re(),Tt=new Uint8Array(Et).buffer;let Bt=Tt;de&&(Bt=await TK(Tt,we));const Yt=sG(at,de);let Mr=!1;if(Ge&&nt)try{Mr=await VK(Bt,Yt)}catch{Mr=!1}if(!Mr){const fr=new Blob([Bt],{type:"application/x-sqlite3"}),Cr=URL.createObjectURL(fr),re=document.createElement("a");re.href=Cr,re.download=Yt,re.click()}Y(),de&&Ie("");const Jr=qE(),jr=Mr?Jr?t("datasource.backup_saved_location_named",{folder:Jr}):t("datasource.backup_saved_location_remembered","Remembered backup folder"):t("datasource.backup_saved_location_downloads","Browser download folder");await Qt.info(t("datasource.backup_saved_success_details",{fileName:Yt,location:jr}))}catch(Re){await Qt.error(`${t("datasource.backup_save_failed","Backup could not be created.")}: ${u(Re)}`)}},className:`flex items-center justify-center gap-2 p-3 border rounded-lg text-sm font-bold transition-colors ${de?"bg-emerald-600 border-emerald-700 text-white hover:bg-emerald-700":"bg-slate-50 dark:bg-slate-900/40 border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800"}`,children:[l.jsx(wl,{className:"w-4 h-4"}),t(de?"datasource.save_backup_secure":"datasource.save_backup_standard")]}),l.jsxs("button",{type:"button",onClick:()=>{It()},className:`flex items-center justify-center gap-2 p-3 border rounded-lg text-sm font-bold transition-colors ${de?"bg-emerald-600 border-emerald-700 text-white hover:bg-emerald-700":"bg-slate-50 dark:bg-slate-900/40 border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800"}`,children:[l.jsx(yp,{className:"w-4 h-4 text-amber-500"})," ",t("datasource.restore_backup")]}),l.jsx("input",{ref:pt,type:"file",accept:".sqlite3,.sqlite,.db",className:"hidden",onChange:async Re=>{const Et=Re.target.files?.[0];Et&&(oe(null),await Dt(Et),Re.currentTarget.value="")}})]})]})]}),l.jsxs("div",{className:"bg-red-50/50 dark:bg-red-900/10 rounded-2xl border border-red-200 dark:border-red-900/50 p-6 shadow-sm",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx("div",{className:"p-2 bg-red-100 dark:bg-red-900/30 text-red-600 rounded-lg",children:l.jsx(t0,{className:"w-5 h-5"})}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("h3",{className:"text-sm font-bold text-red-900 dark:text-red-400 uppercase tracking-wider leading-none",children:t("datasource.danger_zone")}),l.jsx("p",{className:"text-xs text-red-700/70 dark:text-red-300/60 mt-1",children:t("datasource.danger_zone_hint")})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-6",children:[l.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-red-100 dark:border-red-900/20 rounded-xl p-4 shadow-sm",children:[l.jsx("h4",{className:"text-xs font-black text-slate-400 uppercase mb-3",children:t("datasource.clear_reset")}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("select",{id:"clear-table-select",className:"flex-1 p-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded text-xs outline-none",defaultValue:"",children:[l.jsx("option",{value:"",disabled:!0,children:t("datasource.select_target_table")}),(c?Ot:mt)?.map(Re=>l.jsx("option",{value:Re,children:Re},Re))]}),l.jsx("button",{onClick:()=>{const Re=document.getElementById("clear-table-select");Re.value&&tr(Re.value)},className:"px-3 py-2 bg-red-600 hover:bg-red-700 text-white rounded font-bold text-xs transition-colors",children:t("datasource.clear_btn")})]}),l.jsx("p",{className:"text-[10px] text-slate-400 italic",children:t("datasource.clear_reset_hint")})]})]}),l.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-red-100 dark:border-red-900/20 rounded-xl p-4 shadow-sm",children:[l.jsx("h4",{className:"text-xs font-black text-slate-400 uppercase mb-3",children:t("datasource.drop_table_title")}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("select",{id:"drop-table-select",className:"flex-1 p-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded text-xs outline-none",defaultValue:"",children:[l.jsx("option",{value:"",disabled:!0,children:t("datasource.select_target_table")}),mt.map(Re=>l.jsx("option",{value:`table:${Re}`,children:Re},`tbl-${Re}`)),gt.map(Re=>l.jsxs("option",{value:`view:${Re.name}`,children:[Re.name," (view)"]},`view-${Re.name}`))]}),l.jsx("button",{onClick:()=>{const Re=document.getElementById("drop-table-select");if(!Re.value)return;const[Et,Tt]=Re.value.split(":");Tt&&(Et==="view"?kr(Tt):vt(Tt))},disabled:mt.length===0&&gt.length===0,className:"px-3 py-2 bg-red-900 hover:bg-black text-white rounded font-bold text-xs transition-colors disabled:opacity-30 disabled:cursor-not-allowed",children:t("datasource.drop_btn")})]}),l.jsx("p",{className:"text-[10px] text-slate-400 italic",children:t("datasource.drop_table_hint")})]})]}),l.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-red-100 dark:border-red-900/20 rounded-xl p-4 shadow-sm",children:[l.jsx("h4",{className:"text-xs font-black text-slate-400 uppercase mb-3",children:t("datasource.sql_manager_reset_title","SQL Manager reset")}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("div",{className:"flex items-center gap-2",children:l.jsxs("button",{disabled:qe,onClick:()=>{rr()},className:"flex items-center gap-2 px-4 py-2 bg-red-700 hover:bg-red-800 text-white rounded font-bold text-xs transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[qe&&l.jsx(nx,{className:"w-4 h-4 animate-spin"}),t("datasource.sql_manager_reset_btn","Reset SQL Manager")]})}),l.jsx("p",{className:"text-[10px] text-slate-400 italic",children:t("datasource.sql_manager_reset_hint","Deletes all saved SQL statements in the SQL Manager, including favorites and usage counters.")})]})]}),l.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-red-100 dark:border-red-900/20 rounded-xl p-4 shadow-sm md:col-span-2",children:[l.jsx("h4",{className:"text-xs font-black text-slate-400 uppercase mb-3",children:t("datasource.factory_reset_title","Werkseinstellungen")}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("div",{className:"flex items-center gap-2",children:l.jsxs("button",{disabled:He,onClick:async()=>{const Re=t("datasource.factory_reset_confirm","Bist du sicher? Alle Daten (inkl. Tabellen, Views und Indizes), Dashboards, Widgets und lokale Einstellungen werden endgueltig geloescht. Dies kann nicht rueckgaengig gemacht werden!");if(await Qt.confirm(Re)){const Et=await Qt.prompt(t("datasource.factory_reset_prompt",'Bitte tippe "RESET" ein, um fortzufahren:'));if(Et==="RESET")try{se(!0);const{factoryResetDatabase:Tt}=await BA(async()=>{const{factoryResetDatabase:Bt}=await Promise.resolve().then(()=>Wu);return{factoryResetDatabase:Bt}},void 0);await Tt(),nG(),await Qt.info(t("datasource.factory_reset_success","Datenbank wurde auf Werkseinstellungen zurckgesetzt! Lade neu...")),Y(),sessionStorage.removeItem("litebistudio_datasource_tab"),a("/"),window.location.reload()}catch(Tt){se(!1),await Qt.error(u(Tt))}else Et!==null&&await Qt.warning(t("datasource.factory_reset_aborted","Abgebrochen: Falsche Eingabe."))}},className:"flex items-center gap-2 px-4 py-2 bg-red-900 hover:bg-black text-white rounded font-bold text-xs transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[He&&l.jsx(nx,{className:"w-4 h-4 animate-spin"}),t("datasource.factory_reset_btn","Komplett zurcksetzen")]})}),l.jsx("p",{className:"text-[10px] text-slate-400 italic",children:t("datasource.factory_reset_hint","Loescht die gesamte Datenbank inklusive Tabellen, Views und Indizes, setzt lokale Einstellungen zurueck und erstellt ein frisches, leeres Schema der neuesten Version.")})]})]})]})]})]})]}),l.jsx(Bo,{isOpen:H,onClose:()=>ee(!1),title:t("datasource.create_table_title"),children:l.jsxs("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto",children:[l.jsxs("div",{className:"flex gap-2 mb-4 bg-slate-100 p-1 rounded-lg w-fit",children:[l.jsx("button",{onClick:()=>Le(!1),className:`px-3 py-1 text-xs font-bold rounded ${te?"text-slate-500":"bg-white shadow text-blue-600"}`,children:t("datasource.assistant")}),l.jsx("button",{onClick:()=>Le(!0),className:`px-3 py-1 text-xs font-bold rounded ${te?"bg-white shadow text-blue-600":"text-slate-500"}`,children:"SQL"})]}),te?l.jsx("textarea",{value:je,onChange:Re=>F(Re.target.value),className:"w-full h-40 font-mono text-sm p-3 bg-slate-900 text-white rounded-lg"}):l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:t("datasource.name_label")}),l.jsx("input",{value:le,onChange:Re=>pe(Re.target.value),className:"w-full p-2 border rounded",placeholder:"usr_tabelle"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:t("datasource.columns_label")}),K.map((Re,Et)=>l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{value:Re.name,onChange:Tt=>{const Bt=[...K];Bt[Et].name=Tt.target.value,I(Bt)},className:"flex-1 p-2 border rounded text-sm",placeholder:t("datasource.name_label")}),l.jsxs("select",{value:Re.type,onChange:Tt=>{const Bt=[...K];Bt[Et].type=Tt.target.value,I(Bt)},className:"w-32 p-2 border rounded text-sm",children:[l.jsx("option",{value:"TEXT",children:"TEXT"}),l.jsx("option",{value:"INTEGER",children:"INTEGER"}),l.jsx("option",{value:"REAL",children:"REAL"}),l.jsx("option",{value:"INTEGER PRIMARY KEY",children:"ID (PK)"})]}),l.jsx("button",{onClick:()=>I(K.filter((Tt,Bt)=>Bt!==Et)),className:"text-red-500",children:l.jsx(ii,{className:"w-4 h-4"})})]},Et)),l.jsx("button",{onClick:()=>I([...K,{name:"",type:"TEXT"}]),className:"text-xs text-blue-600 font-bold flex items-center gap-1",children:t("datasource.add_column")})]})]}),l.jsx("div",{className:"flex justify-end gap-2 pt-4",children:l.jsx("button",{onClick:vr,className:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-bold",children:t("datasource.create_btn")})})]})}),l.jsx(Bo,{isOpen:v,onClose:()=>B(!1),title:m?.title||g,children:m?l.jsx(sF,{schema:m}):l.jsx("div",{className:"p-4 text-center",children:t("datasource.schema_not_available")})}),l.jsx(Bo,{isOpen:k,onClose:()=>E(!1),title:t("datasource.create_index_title","Index erstellen"),children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"text-xs text-slate-500",children:[t("datasource.index_create_for_table","Tabelle"),": ",l.jsx("span",{className:"font-mono font-semibold text-slate-700",children:S})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:t("datasource.index_name","Indexname")}),l.jsx("input",{value:P,onChange:Re=>R(Re.target.value),className:"w-full p-2 border border-slate-200 rounded text-sm",placeholder:`idx_${S}_...`})]}),l.jsxs("label",{className:"flex items-center gap-2 text-sm text-slate-600",children:[l.jsx("input",{type:"checkbox",checked:U,onChange:()=>M(!U),className:"h-4 w-4"}),t("datasource.index_unique","Unique Index")]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:t("datasource.index_columns","Spalten")}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 max-h-48 overflow-auto border border-slate-200 rounded p-2 bg-slate-50",children:G.map(Re=>l.jsxs("label",{className:"flex items-center gap-2 text-sm text-slate-700",children:[l.jsx("input",{type:"checkbox",checked:Q.includes(Re),onChange:()=>Ft(Re),className:"h-4 w-4"}),l.jsx("span",{className:"font-mono",children:Re})]},Re))})]}),Q.length>0&&l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:t("datasource.index_order","Spaltenreihenfolge")}),l.jsx("div",{className:"space-y-1 border border-slate-200 rounded p-2 bg-white",children:Q.map((Re,Et)=>l.jsxs("div",{className:"flex items-center justify-between text-sm",children:[l.jsxs("span",{className:"font-mono text-slate-700",children:[Et+1,". ",Re]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("button",{type:"button",onClick:()=>Zt(Re,"up"),disabled:Et===0,className:"px-2 py-0.5 text-xs border border-slate-200 rounded disabled:opacity-40",children:""}),l.jsx("button",{type:"button",onClick:()=>Zt(Re,"down"),disabled:Et===Q.length-1,className:"px-2 py-0.5 text-xs border border-slate-200 rounded disabled:opacity-40",children:""})]})]},Re))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:t("datasource.index_where_optional","WHERE (optional)")}),l.jsx("input",{value:T,onChange:Re=>D(Re.target.value),className:"w-full p-2 border border-slate-200 rounded text-sm font-mono",placeholder:"status = 'open'"})]}),l.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[l.jsx("button",{onClick:()=>E(!1),className:"px-4 py-2 border border-slate-200 rounded-lg text-sm",children:t("common.cancel")}),l.jsx("button",{onClick:()=>{wr()},className:"px-4 py-2 bg-indigo-600 text-white rounded-lg text-sm font-bold hover:bg-indigo-700",children:t("datasource.create_index_btn","Index erstellen")})]})]})})]})};function Tx({data:e,columns:t,searchTerm:r="",searchFields:a=[],emptyMessage:s="No items found",onRowClick:n,sortConfig:o,onSortConfigChange:c,filters:u,onFiltersChange:f,showFilters:h,onShowFiltersChange:g,columnWidths:x,onColumnWidthsChange:m}){const w=Wt.useRef(null),v=Wt.useRef(null),B=Wt.useRef(null),[k,E]=Wt.useState(null),[S,L]=Wt.useState({}),[P,R]=Wt.useState(!1),[Q,V]=Wt.useState({}),[U]=Jt("ui_table_density","normal"),[M]=Jt("ui_table_wrap_cells",!1),T=o!==void 0?o:k,D=u!==void 0?u:S,G=h!==void 0?h:P,ne=x!==void 0?x:Q,H=ue=>{o===void 0&&E(ue),c?.(ue)},ee=ue=>{u===void 0&&L(ue),f?.(ue)},le=ue=>{h===void 0&&R(ue),g?.(ue)},pe=Wt.useCallback(ue=>{x===void 0&&V(ue),m?.(ue)},[x,m]),te=ue=>typeof ue.accessor=="string"?ue.accessor:ue.header,Le=ue=>{if(!ue)return null;const we=/^(\d+)px$/i.exec(ue.trim());return we?Number(we[1]):null},je=ue=>{const we=te(ue);if(ne[we])return Math.max(90,ne[we]);const Ie=Le(ue.width);return Ie?Math.max(90,Ie):150},F=Z.useCallback((ue,we)=>ue[we],[]),K=Z.useMemo(()=>{let ue=e;if(r){const we=r.toLowerCase();ue=ue.filter(Ie=>a.some(Ae=>{const oe=Ie[Ae];return String(oe??"").toLowerCase().includes(we)}))}return Object.keys(D).length>0&&(ue=ue.filter(we=>Object.entries(D).every(([Ie,Ae])=>{if(!Ae)return!0;const oe=t.find(se=>(typeof se.accessor=="string"?se.accessor:se.header)===Ie);if(!oe)return!0;let He;return typeof oe.accessor=="function"?He=oe.accessor(we):He=F(we,oe.accessor),String(He??"").toLowerCase().includes(Ae.toLowerCase())}))),T&&(ue=[...ue].sort((we,Ie)=>{const Ae=t.find(qe=>qe.accessor===T.key||typeof qe.accessor=="string"&&qe.accessor===T.key);let oe,He;if(Ae&&typeof Ae.accessor=="function"?(oe=Ae.accessor(we),He=Ae.accessor(Ie)):(oe=F(we,T.key),He=F(Ie,T.key)),oe===He)return 0;if(oe==null)return 1;if(He==null)return-1;const se=oe<He?-1:1;return T.direction==="asc"?se:-se})),ue},[e,r,a,T,t,D,F]),I=()=>{w.current&&v.current&&(w.current.scrollLeft=v.current.scrollLeft)},q=(ue,we)=>{ue.preventDefault(),ue.stopPropagation(),B.current={key:te(we),startX:ue.clientX,startWidth:je(we)}};Wt.useEffect(()=>{const ue=Ie=>{const Ae=B.current;if(!Ae)return;const oe=Math.max(90,Math.min(900,Ae.startWidth+(Ie.clientX-Ae.startX)));ne[Ae.key]!==oe&&pe({...ne,[Ae.key]:oe})},we=()=>{B.current=null};return window.addEventListener("mousemove",ue),window.addEventListener("mouseup",we),()=>{window.removeEventListener("mousemove",ue),window.removeEventListener("mouseup",we)}},[ne,pe]);const J=ue=>{const we=te(ue);let Ie="asc";T&&T.key===we&&T.direction==="asc"&&(Ie="desc"),H({key:we,direction:Ie})},Y=(ue,we)=>{ee({...D,[ue]:we})},de=()=>l.jsx("colgroup",{children:t.map((ue,we)=>l.jsx("col",{style:{width:`${je(ue)}px`,minWidth:`${je(ue)}px`}},we))});return l.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden h-full relative border rounded-lg border-slate-300 dark:border-slate-700",children:[l.jsx("div",{ref:w,className:"overflow-hidden flex-none bg-slate-50 dark:bg-slate-900 border-b border-slate-300 dark:border-slate-700",children:l.jsxs("table",{className:"w-full text-sm text-left table-fixed",children:[de(),l.jsxs("thead",{className:"text-[10px] text-slate-400 uppercase font-bold text-left",children:[l.jsx("tr",{children:t.map((ue,we)=>{const Ie=te(ue),Ae=T?.key===Ie;return l.jsxs("th",{className:`relative px-4 ${U==="compact"?"py-2":"py-3"} truncate cursor-pointer select-none hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors ${ue.align==="right"?"text-right":ue.align==="center"?"text-center":"text-left"} ${ue.className||""}`,title:ue.header,onClick:()=>J(ue),children:[l.jsxs("div",{className:`flex items-center gap-1.5 ${ue.align==="right"?"justify-end":ue.align==="center"?"justify-center":"justify-start"}`,children:[we===0&&l.jsx("button",{onClick:oe=>{oe.stopPropagation(),le(!G)},className:`p-1 rounded hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors mr-2 ${G||Object.keys(D).length>0?"text-blue-600 bg-blue-100 dark:bg-blue-900/40":"text-slate-500 hover:text-slate-700"}`,title:"Toggle Column Filters",children:l.jsx(Jh,{className:"w-4 h-4"})}),l.jsx("span",{className:"truncate",children:ue.header}),Ae&&l.jsx("span",{className:"text-blue-500 text-[9px]",children:T?.direction==="asc"?"":""})]}),l.jsx("div",{className:"absolute top-0 right-0 h-full w-2 cursor-col-resize group",onMouseDown:oe=>q(oe,ue),role:"separator","aria-orientation":"vertical","aria-label":`Resize ${ue.header}`,children:l.jsx("div",{className:"mx-auto h-full w-px bg-slate-300 dark:bg-slate-700 opacity-0 group-hover:opacity-100"})})]},we)})}),G&&l.jsx("tr",{className:"bg-slate-100/50 dark:bg-slate-800/50",children:t.map((ue,we)=>{const Ie=typeof ue.accessor=="string"?ue.accessor:ue.header;return l.jsx("th",{className:`px-2 ${U==="compact"?"py-0.5":"py-1"}`,children:l.jsxs("div",{className:"relative flex items-center",children:[l.jsx("input",{type:"text",value:D[Ie]||"",onChange:Ae=>Y(Ie,Ae.target.value),onClick:Ae=>Ae.stopPropagation(),placeholder:`Filter ${ue.header}...`,className:"w-full px-2 py-1 text-[10px] font-normal border border-slate-300 dark:border-slate-600 rounded bg-white dark:bg-slate-900 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-1 focus:ring-blue-500 placeholder:text-slate-300"}),D[Ie]&&l.jsx("button",{onClick:Ae=>{Ae.stopPropagation(),Y(Ie,"")},className:"absolute right-1 text-slate-400 hover:text-slate-600 dark:hover:text-slate-200",children:l.jsx(vl,{className:"w-3 h-3"})})]})},we)})})]})]})}),l.jsx("div",{ref:v,onScroll:I,className:"flex-1 overflow-auto bg-white dark:bg-slate-800",children:l.jsxs("table",{className:"w-full text-sm text-left table-fixed",children:[de(),l.jsxs("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:[K.map((ue,we)=>l.jsx("tr",{onClick:()=>n&&n(ue),className:`transition-colors group ${n?"cursor-pointer hover:bg-blue-50 dark:hover:bg-blue-900/20":"hover:bg-slate-50 dark:hover:bg-slate-700/30"}`,children:t.map((Ie,Ae)=>{const oe=typeof Ie.accessor=="function"?Ie.accessor(ue):F(ue,Ie.accessor),He=Ie.render?Ie.render(ue):typeof oe=="string"||typeof oe=="number"?oe:oe==null?"":String(oe);return l.jsx("td",{className:`px-4 ${U==="compact"?"py-2":"py-3"} ${M?"whitespace-normal break-words":"truncate"} ${Ie.align==="right"?"text-right":Ie.align==="center"?"text-center":"text-left"} ${Ie.className||""}`,title:typeof oe=="string"?oe:void 0,children:He},Ae)})},we)),K.length===0&&l.jsx("tr",{children:l.jsxs("td",{colSpan:t.length,className:"px-6 py-20 text-center text-slate-400",children:[l.jsx(Zo,{className:"w-12 h-12 mx-auto mb-4 opacity-10"}),l.jsx("p",{className:"text-lg",children:s})]})})]})]})})]})}const Gd=UA("RecordDetail"),cb=({isOpen:e,onClose:t,items:r,initialIndex:a=0,title:s,tableName:n,schema:o})=>{const{t:c}=ds(),[u,f]=Z.useState(a),[h,g]=Z.useState(null),[x,m]=Z.useState(null),[w,v]=Z.useState(!1),[B,k]=Z.useState(!1),[E,S]=Z.useState(null),[L,P]=Z.useState(null),[R,Q]=Z.useState(null),[V,U]=Z.useState(!1),[M]=Jt("worklist_default_priority","normal"),[T]=Jt("worklist_default_due_days",0),D=s||c("record_detail.title"),G=n||"unknown",ne=Wt.useRef(!1);Z.useEffect(()=>{if(!e){ne.current=!1;return}if(e&&!ne.current&&r&&r.length>0){const q=Math.max(0,a);f(q),m(q),g(null),v(!1),ne.current=!0}},[e,a,r]),Z.useEffect(()=>{if(e){if(o){Q(o);return}n&&n!=="unknown"?(async()=>{const J=await jt.getTableSchema(n);if(J&&J.length>0){const Y={title:`${c("datasource.tab_structure")}: ${n}`,description:c("datasource.user_tables_hint"),type:"object",properties:J.reduce((de,ue)=>(de[ue.name]={type:ue.type.toLowerCase().includes("int")||ue.type.toLowerCase().includes("real")?"number":"string",description:`${ue.name} (${ue.type})`},de),{})};Q(Y)}else Q(null)})():Q(null)}},[e,n,o,c]);const H=Z.useCallback(async q=>{if(!q)return null;try{const ue=(await jt.getTableSchema(G)).find(we=>we.pk===1)?.name;if(ue&&q[ue]!==void 0&&q[ue]!==null){const we=q[ue];if(typeof we=="string"||typeof we=="number")return we}}catch{}if(q._rowid!==void 0&&q._rowid!==null){const de=q._rowid;if(typeof de=="string"||typeof de=="number")return de}const J=Object.keys(q).find(de=>de.toLowerCase()==="id"||de.toLowerCase()==="entryid"||de.toLowerCase()==="rowid");if(J&&q[J]!==void 0&&q[J]!==null){const de=q[J];if(typeof de=="string"||typeof de=="number")return de}const Y=Object.keys(q).find(de=>de.toLowerCase().endsWith("_id")||de.toLowerCase().endsWith("id"));if(Y&&q[Y]!==void 0&&q[Y]!==null){const de=q[Y];if(typeof de=="string"||typeof de=="number")return de}return null},[G]);Z.useEffect(()=>{e&&(async()=>{const J=r[u];if(J){const Y=await H(J),de=await jt.getRecordMetadata(G,Y??"");k(de.isInWorklist),S(de.worklistItem),P(de.exists)}else P(null),S(null),k(!1)})()},[e,u,r,G,H]);const ee=async()=>{if(V)return;const q=r[u],J=await H(q);if(!J){Gd.warn("Cannot toggle worklist: No unique ID found for record",q);return}U(!0);try{if(B)await jt.executeRaw("DELETE FROM sys_worklist WHERE source_table = ? AND source_id = ?",[G,J]),k(!1),S(null);else{const Y=pt=>{if(pt===null)return null;const nt=pt.trim().toLowerCase();return nt==="low"||nt==="normal"||nt==="high"||nt==="critical"?nt:"normal"},de=pt=>{if(pt===null)return null;const nt=pt.trim();return nt&&/^\d{4}-\d{2}-\d{2}$/.test(nt)?nt:""},ue=()=>{if(T<=0)return"";const pt=new Date;pt.setDate(pt.getDate()+T);const nt=pt.getFullYear(),Dt=String(pt.getMonth()+1).padStart(2,"0"),It=String(pt.getDate()).padStart(2,"0");return`${nt}-${Dt}-${It}`},we=await Qt.prompt(c("worklist.add_priority_prompt","Prioritaet (low, normal, high, critical)"),{title:c("worklist.add_dialog_title","Zum Arbeitsvorrat"),defaultValue:M});if(we===null)return;const Ie=Y(we)??"normal",Ae=await Qt.prompt(c("worklist.add_due_prompt","Faelligkeit optional (YYYY-MM-DD), leer lassen fuer keine"),{title:c("worklist.add_dialog_title","Zum Arbeitsvorrat"),defaultValue:ue()});if(Ae===null)return;const oe=de(Ae),He=oe===""?null:oe,se=["name","title","description","label","display_name","VendorName","Description"];let qe="";for(const pt of se){const nt=Object.keys(q).find(Dt=>Dt.toLowerCase()===pt.toLowerCase());if(nt&&q[nt]){qe=String(q[nt]);break}}qe||(qe=c("worklist.entry_id",{id:J}));const Ye=["period","fiscalyear","category","type","group","Period"];let at=G;for(const pt of Ye){const nt=Object.keys(q).find(Dt=>Dt.toLowerCase()===pt.toLowerCase());if(nt&&q[nt]){at=String(q[nt]);break}}await jt.executeRaw("INSERT INTO sys_worklist (source_table, source_id, display_label, display_context, priority, due_at) VALUES (?, ?, ?, ?, ?, ?)",[G,J,qe,at,Ie,He]);const Ge=await jt.getRecordMetadata(G,J);k(!0),S(Ge.worklistItem)}window.dispatchEvent(new Event("db-changed"))}catch(Y){Gd.error("Failed to toggle worklist status",Y)}finally{U(!1)}},le=()=>{m(x===u?null:u)},pe=q=>{g(u),f(q)};if(!r||r.length===0)return null;const te=r[u],Le=x!==null?r[x]:h!==null&&h>=0&&h<r.length?r[h]:null,je=x!==null,F=x===u;if(!te)return null;const K=q=>{if(q==null)return null;const J=String(q).trim();if(!J)return null;const Y=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,de=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,ue=/^[A-Z]{2}\d{2}[A-Z0-9]{10,30}$/i,we=/^https?:\/\/[^\s/$.?#].[^\s]*$/i,Ie=(()=>{if(!(/^\d{4}-\d{2}-\d{2}/.test(J)||/^\d{2}[./-]\d{2}[./-]\d{2,4}$/.test(J)))return!1;const oe=Date.parse(J.replace(/\./g,"-"));return!Number.isNaN(oe)})();return Y.test(J)?"email":de.test(J)?"uuid":ue.test(J)?"iban":we.test(J)?"url":Ie?"date":null},I=q=>{if(q==null)return!1;const J=String(q);if(!J.trim())return!1;let Y=!1;for(let we=0;we<J.length;we++){const Ie=J.charCodeAt(we);if(Ie<32&&Ie!==9&&Ie!==10&&Ie!==13){Y=!0;break}}const de=J.length>256&&!/\s/.test(J),ue=/<script|javascript:/i.test(J);return Y||de||ue};return l.jsxs(l.Fragment,{children:[l.jsx(Bo,{isOpen:e,onClose:t,title:r.length>1?`${D} (${u+1} / ${r.length})`:D,noScroll:!0,children:l.jsxs("div",{className:"flex flex-col h-full min-h-0 bg-white dark:bg-slate-800",children:[l.jsxs("div",{className:"shrink-0 px-6 py-3 bg-slate-50 dark:bg-slate-900/50 border-b border-slate-200 dark:border-slate-700 flex items-center justify-between z-20",children:[l.jsxs("div",{className:"flex items-center gap-1",children:[R&&l.jsx("button",{onClick:()=>v(!0),className:"p-1.5 rounded-lg border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors text-slate-500",title:c("record_detail.schema_definition"),children:l.jsx(iu,{className:"w-4 h-4"})}),l.jsx("button",{onClick:ee,disabled:V,className:`p-1.5 rounded-lg border transition-colors flex items-center gap-1.5 ${V?"opacity-50 cursor-not-allowed":""} ${B?"bg-amber-50 border-amber-200 text-amber-600 dark:bg-amber-900/20 dark:border-amber-800 dark:text-amber-400":"bg-white border-slate-300 text-slate-500 hover:bg-slate-50 dark:bg-slate-800 dark:border-slate-700 dark:hover:bg-slate-700"}`,title:c(B?"record_detail.remove_worklist":"record_detail.add_worklist"),children:V?l.jsx(Zc,{className:"w-4 h-4 animate-spin"}):l.jsx(W8,{className:`w-4 h-4 ${B?"fill-current":""}`})}),l.jsx("div",{className:"h-4 w-[1px] bg-slate-200 dark:bg-slate-700 mx-1"}),l.jsxs("button",{onClick:le,className:`p-1.5 rounded-lg border transition-colors flex items-center gap-1.5 group relative ${je?"bg-blue-50 border-blue-200 text-blue-600 dark:bg-blue-900/20 dark:border-blue-800 dark:text-blue-400":"bg-white border-slate-300 text-slate-500 hover:bg-slate-50 dark:bg-slate-800 dark:border-slate-700 dark:hover:bg-slate-700"}`,title:c(F?"record_detail.clear_reference":"record_detail.set_reference"),children:[l.jsx(Ak,{className:`w-4 h-4 ${je?"fill-current":""}`}),je&&!F&&l.jsxs("span",{className:"absolute -top-1 -right-1 flex h-2.5 w-2.5",children:[l.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-blue-400 opacity-75"}),l.jsx("span",{className:"relative inline-flex rounded-full h-2.5 w-2.5 bg-blue-500"})]})]}),l.jsx("div",{className:"h-4 w-[1px] bg-slate-200 dark:bg-slate-700 mx-1"}),l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest px-2",children:c("record_detail.navigation")})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[L===!1&&l.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 border border-red-200 dark:border-red-800 rounded-lg text-[10px] font-black animate-pulse",children:[l.jsx(Cn,{className:"w-3.5 h-3.5"})," ",c("record_detail.deleted_badge")]}),l.jsx("button",{disabled:u===0,onClick:()=>pe(u-1),className:"p-1.5 rounded-lg border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-800 disabled:opacity-30 disabled:cursor-not-allowed hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors",children:l.jsx(KS,{className:"w-4 h-4"})}),l.jsxs("div",{className:"text-[11px] font-black text-slate-700 dark:text-slate-200 min-w-[60px] text-center bg-white dark:bg-slate-800 px-2 py-1 rounded-md border border-slate-200 dark:border-slate-800 shadow-sm",children:[u+1," / ",r.length]}),l.jsx("button",{disabled:u===r.length-1,onClick:()=>pe(u+1),className:"p-1.5 rounded-lg border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-800 disabled:opacity-30 disabled:cursor-not-allowed hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors",children:l.jsx(Yl,{className:"w-4 h-4"})})]})]}),B&&l.jsx("div",{className:"shrink-0 px-6 py-4 bg-amber-50/30 dark:bg-amber-900/5 border-b border-slate-200 dark:border-slate-700 space-y-3",children:l.jsxs("div",{className:"flex items-start gap-4 flex-wrap",children:[l.jsxs("div",{className:"w-48 shrink-0",children:[l.jsx("label",{className:"block text-[9px] font-black uppercase text-amber-600 dark:text-amber-400 mb-1.5 px-1",children:c("record_detail.status_label")}),l.jsxs("select",{value:typeof E?.status=="string"?E.status:"open",onChange:async q=>{if(E){const J=q.target.value;S(Y=>Y&&{...Y,status:J});try{await jt.updateWorklistItem(E.id,{status:J})}catch(Y){Gd.error("Failed to update status",Y)}}},className:"w-full p-2 bg-white dark:bg-slate-800 border border-amber-200 dark:border-amber-900/50 rounded-xl text-xs font-bold text-slate-800 dark:text-slate-100 outline-none focus:ring-2 focus:ring-amber-500/20 transition-all cursor-pointer",children:[l.jsx("option",{value:"open",children:c("worklist.status_open","Neu / Offen")}),l.jsx("option",{value:"in_progress",children:c("worklist.status_in_progress","In Bearbeitung")}),l.jsx("option",{value:"done",children:c("worklist.status_done","Erledigt")}),l.jsx("option",{value:"closed",children:c("worklist.status_closed","Geschlossen")})]})]}),l.jsxs("div",{className:"w-48 shrink-0",children:[l.jsx("label",{className:"block text-[9px] font-black uppercase text-amber-600 dark:text-amber-400 mb-1.5 px-1",children:c("worklist.priority_label","Prioritaet")}),l.jsxs("select",{value:typeof E?.priority=="string"?E.priority:"normal",onChange:async q=>{if(E){const J=q.target.value;S(Y=>Y&&{...Y,priority:J});try{await jt.updateWorklistItem(E.id,{priority:J})}catch(Y){Gd.error("Failed to update priority",Y)}}},className:"w-full p-2 bg-white dark:bg-slate-800 border border-amber-200 dark:border-amber-900/50 rounded-xl text-xs font-bold text-slate-800 dark:text-slate-100 outline-none focus:ring-2 focus:ring-amber-500/20 transition-all cursor-pointer",children:[l.jsx("option",{value:"low",children:c("worklist.priority_low","Niedrig")}),l.jsx("option",{value:"normal",children:c("worklist.priority_normal","Normal")}),l.jsx("option",{value:"high",children:c("worklist.priority_high","Hoch")}),l.jsx("option",{value:"critical",children:c("worklist.priority_critical","Kritisch")})]})]}),l.jsxs("div",{className:"w-48 shrink-0",children:[l.jsx("label",{className:"block text-[9px] font-black uppercase text-amber-600 dark:text-amber-400 mb-1.5 px-1",children:c("worklist.due_label","Faellig")}),l.jsx("input",{type:"date",value:typeof E?.due_at=="string"?E.due_at.slice(0,10):"",onChange:async q=>{if(E){const J=q.target.value||null;S(Y=>Y&&{...Y,due_at:J});try{await jt.updateWorklistItem(E.id,{due_at:J})}catch(Y){Gd.error("Failed to update due date",Y)}}},className:"w-full p-2 bg-white dark:bg-slate-800 border border-amber-200 dark:border-amber-900/50 rounded-xl text-xs font-bold text-slate-800 dark:text-slate-100 outline-none focus:ring-2 focus:ring-amber-500/20 transition-all cursor-pointer"})]}),l.jsxs("div",{className:"flex-1 min-w-[320px]",children:[l.jsx("label",{className:"block text-[9px] font-black uppercase text-amber-600 dark:text-amber-400 mb-1.5 px-1",children:c("record_detail.comment_label")}),l.jsx("textarea",{value:typeof E?.comment=="string"?E.comment:"",onChange:q=>S(J=>J&&{...J,comment:q.target.value}),onBlur:async q=>{if(E)try{await jt.updateWorklistItem(E.id,{comment:q.target.value})}catch(J){Gd.error("Failed to update comment",J)}},placeholder:c("record_detail.comment_placeholder"),className:"w-full p-2 h-[88px] bg-white dark:bg-slate-800 border border-amber-200 dark:border-amber-900/50 rounded-xl text-xs font-medium text-slate-800 dark:text-slate-100 placeholder:text-slate-400 dark:placeholder:text-slate-500 outline-none focus:ring-2 focus:ring-amber-500/20 transition-all resize-none"})]})]})}),l.jsxs("div",{className:"flex-1 overflow-auto p-6 pt-4 min-h-0 scrollbar-thin scrollbar-thumb-slate-200 dark:scrollbar-thumb-slate-700",children:[je&&!F&&l.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/10 border border-blue-100 dark:border-blue-900/30 rounded-lg px-3 py-2 text-[10px] text-blue-700 dark:text-blue-300 flex items-center gap-2 mb-6",children:[l.jsx(Ak,{className:"w-3.5 h-3.5"}),l.jsx("span",{className:"font-bold",children:c("record_detail.comparison_active")}),l.jsx("span",{children:c("record_detail.differences_relative",{id:r[x].id||x+1})})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6",children:Object.entries(te).map(([q,J])=>{if(q.startsWith("is")||q==="compositeKey"||q==="status")return null;const Y=Le&&String(J)!==String(Le[q]);return l.jsxs("div",{className:`
                                            border-b border-slate-100 dark:border-slate-700/50 pb-2 transition-colors duration-500
                                            ${Y?"bg-amber-50 dark:bg-amber-900/20 -mx-2 px-2 rounded-lg border-amber-200 dark:border-amber-800 shadow-sm":""}
                                        `,children:[l.jsxs("dt",{className:"text-[10px] font-bold uppercase text-slate-400 mb-1 flex items-center justify-between tracking-wider",children:[q,Y&&l.jsx("span",{className:"text-[9px] bg-amber-200 dark:bg-amber-800 text-amber-800 dark:text-amber-200 px-1.5 rounded-full font-black",children:"DIFF"})]}),l.jsx("dd",{className:`text-sm font-semibold break-all ${Y?"text-amber-900 dark:text-amber-100":"text-slate-900 dark:text-white"}`,children:J==null||J===""?l.jsx("span",{className:"text-slate-300 italic",children:c("record_detail.empty_value")}):l.jsxs("div",{className:"flex flex-wrap items-start gap-2",children:[l.jsx("span",{children:String(J)}),(()=>{const de=K(J);return de?l.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded-full border border-indigo-200 bg-indigo-50 text-indigo-700 text-[10px] font-black uppercase tracking-wide",children:c(`record_detail.pattern_${de}`)}):null})(),I(J)&&l.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded-full border border-amber-200 bg-amber-50 text-amber-700 text-[10px] font-black uppercase tracking-wide",children:c("record_detail.suspicious")})]})})]},q)})})]})]})}),R&&w&&l.jsx(Bo,{isOpen:w,onClose:()=>v(!1),title:R.title||D,children:l.jsxs("div",{className:"space-y-6",children:[l.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 italic",children:R.description}),l.jsx(sF,{schema:R}),l.jsx("button",{onClick:()=>v(!1),className:"w-full py-2.5 bg-slate-900 dark:bg-slate-100 text-white dark:text-slate-900 rounded-xl font-bold text-xs transition-opacity hover:opacity-90 mt-4",children:c("record_detail.close")})]})})]})},Vm="data_inspector_pending_sql",Gm="data_inspector_return_hash",AB="data_inspector_last_select_sql",lG=["SELECT","FROM","WHERE","GROUP BY","ORDER BY","HAVING","LIMIT","OFFSET","JOIN","LEFT JOIN","RIGHT JOIN","INNER JOIN","ON","AND","OR","NOT","IN","LIKE","IS NULL","IS NOT NULL","COUNT(*)","SUM()","AVG()","MIN()","MAX()","DISTINCT"],cB=({onBack:e,fixedMode:t,titleKey:r,breadcrumbKey:a})=>{const{t:s,i18n:n}=ds(),o=jA(),c=MS(),{isAdminMode:u}=So(),f="global",h="data_inspector_sql_library_migrated_v1",g=t==="sql"?"sql_workspace_sql_editor_height":"data_inspector_sql_editor_height",[x,m]=Z.useState(t??"table"),[w,v]=Z.useState(""),[B,k]=Jt("data_inspector_sql_history",[]),[E]=Jt("data_inspector_explain_mode",!1),[S,L]=Jt("data_inspector_sql_assist_open",!0),[P,R]=Jt("data_inspector_autocomplete_enabled",!0),[Q]=Jt("data_inspector_sql_require_limit_confirm",!0),[V]=Jt("data_inspector_sql_max_rows",5e3),[U,M]=Z.useState([]),[T,D]=Z.useState(""),[G,ne]=Jt("data_inspector_last_saved_sql_template_name",""),[H,ee]=Z.useState("manager"),[le,pe]=Jt("data_inspector_table_tools_open",!1),[te,Le]=Jt("data_inspector_table_tools_tab_v1","columns"),[je,F]=Z.useState([]),[K,I]=Z.useState([]),[q,J]=Z.useState(""),[Y,de]=Z.useState(""),[ue,we]=Jt("data_inspector_sql_manager_panels_v1",{templates:!0,manager:!0,recent:!0}),[Ie,Ae]=Jt("data_inspector_sql_assistant_panels_v1",{table:!0,columns:!0,aggregation:!0,grouping:!0,filter:!0,sorting:!0,preview:!0}),[oe,He]=Z.useState(""),[se,qe]=Z.useState([]),[Ye,at]=Z.useState(""),[Ge,pt]=Z.useState("AND"),[nt,Dt]=Z.useState(""),[It,Ot]=Z.useState([{id:"f0",connector:"AND",column:"",operator:"=",value:""}]),[sr,er]=Z.useState([{id:"s0",column:"",direction:"DESC"}]),[cr,Vt]=Z.useState(100),[mt,Nt]=Z.useState("none"),[gt,dr]=Z.useState(""),[Ht,Rt]=Z.useState([]),[$t,vr]=Z.useState("metric_value"),[vt,kr]=Z.useState([]),[tr,rr]=Z.useState(""),[Xt,Kt]=Z.useState(!1),[Ft,Zt]=Z.useState(E?"explain":"result"),[wr,Re]=Z.useState(""),[Et,Tt]=Z.useState(""),[Bt,Yt]=Z.useState(!1),[Mr,Jr]=Z.useState(""),[jr,fr]=Z.useState([]),[Cr,re]=Z.useState(!1),[ke,me]=Z.useState(""),[be,ye]=Z.useState(!1),[O,ce]=Z.useState([]),[Fe,Ne]=Z.useState(!1),[Te,Ue]=Z.useState(""),[tt,_t]=Jt(g,160),[Ct,yt]=Z.useState(tt),Ut=Z.useRef(null),[zt,Gr]=Z.useState(0),[Qr,oa]=Z.useState(!1),[fs,Tn]=Z.useState(0),[Vn,ve]=Z.useState({top:12,left:12,width:320}),[it,St]=Z.useState(""),[st,Hr]=Z.useState(""),[yr,wa]=Z.useState(null),[Na,Gn]=Jt("data_inspector_page_size",100),[Lr,Ia]=Z.useState(1),[hs,ls]=Z.useState(""),no=(Lr-1)*Na,[Ln,io]=Z.useState(null),[Ls,Bl]=Z.useState({}),[iA]=Jt("data_table_default_show_filters",!1),[Si,Wn]=Z.useState(iA),[Tc,Lc]=Jt("data_inspector_column_widths_v1",{}),[lA,OA]=Jt("data_inspector_saved_views",[]),[Ri,fn]=Jt("data_inspector_active_view",""),[cl]=Jt("data_inspector_show_profiling",!0),[Ys,No]=Z.useState(cl?"profiling":"data"),[di,Sr]=Jt("data_inspector_profiling_thresholds",{nullRate:30,cardinalityRate:95}),[RA,MA]=Z.useState(!1),HA=Z.useRef(null),$n=Z.useRef(Ct),hn=Z.useRef(0),[PA,oA]=Z.useState(null),fi=!!t,AA=s(r||"sidebar.data_inspector"),Cl=s(a||r||"sidebar.data_inspector"),Xn=Z.useCallback(X=>{const Ee=X.trim();Ee&&(localStorage.setItem(Vm,Ee),localStorage.setItem(Gm,`#${c.pathname}${c.search||""}`),o("/sql-workspace"))},[c.pathname,c.search,o]);Z.useEffect(()=>{Wn(iA)},[iA,st]),Z.useEffect(()=>{!t||x===t||m(t)},[t,x]),Z.useEffect(()=>{const X=localStorage.getItem(Vm),Ee=localStorage.getItem(Gm);if(Ee){const Ke=Ee.startsWith("#/")?Ee:"#/";oA(Ke),localStorage.removeItem(Gm)}if(X){if(localStorage.removeItem(Vm),t==="table"){Xn(X);return}m("sql"),v(X),Zt("result")}},[t,Xn]),Z.useEffect(()=>{if(t!=="sql"||w.trim())return;const X=localStorage.getItem(AB);!X||!/^\s*SELECT\b/i.test(X)||(v(X),Gr(X.length),Zt("result"))},[t,w]);const bs=Z.useCallback(X=>X.trim().replace(/\s+/g," ").toLowerCase(),[]),Ps=Z.useCallback(async()=>{const X=await jt.listSqlStatements(f);M(X)},[f]);Z.useEffect(()=>{Ps()},[Ps]),Z.useEffect(()=>{(async()=>{if(localStorage.getItem(h)!=="true")try{const Ke=await jt.listSqlStatements(f),ft=new Set(Ke.map(Pr=>bs(Pr.sql_text))),nr=localStorage.getItem("data_inspector_custom_sql_templates"),ir=localStorage.getItem("data_inspector_favorite_queries"),Br=nr?JSON.parse(nr):[],Or=ir?JSON.parse(ir):[];for(const Pr of Br){const Aa=(Pr.sql||"").trim();if(!Aa)continue;const In=bs(Aa);ft.has(In)||(await jt.saveSqlStatement({id:crypto.randomUUID(),name:(Pr.name||s("datainspector.save_template")).trim()||`Template ${ft.size+1}`,sql_text:Aa,scope:f}),ft.add(In))}for(const Pr of Or){const Aa=Pr.trim();if(!Aa)continue;const In=bs(Aa);if(ft.has(In))continue;const Zr=Aa.split(`
`).map(qr=>qr.trim()).find(Boolean)||Aa;await jt.saveSqlStatement({id:crypto.randomUUID(),name:`${s("datainspector.favorite_queries")}: ${Zr.slice(0,36)}`,sql_text:Aa,scope:f,is_favorite:!0}),ft.add(In)}localStorage.setItem(h,"true"),await Ps()}catch{localStorage.setItem(h,"true")}})()},[h,f,Ps,bs,s]);const{data:Sl}=Ai(async()=>{const X=await jt.getDataSources(),Ee=u?X:X.filter(Ke=>!Ke.name.startsWith("sys_"));return Ee.length>0&&(!st||st.startsWith("sys_")&&!u)&&Hr(Ee[0].name),Ee},[u]),Ka=Wt.useMemo(()=>(Sl||[]).map(X=>X.name),[Sl]),qs=Wt.useMemo(()=>Sl?.find(X=>X.name===st)?.type??"table",[Sl,st]),Mi=Wt.useMemo(()=>st?Tc[st]||{}:{},[Tc,st]),lo=Z.useCallback(X=>{st&&Lc(Ee=>({...Ee,[st]:X}))},[st,Lc]),{data:ma,loading:Ni,error:Nl,refresh:js}=Ai(async()=>x==="table"?st?await jt.inspectTable(st,Na,it,no,qs):[]:wr?await jt.executeRaw(wr):[],[x,st,qs,Na,Lr,wr]),{data:Eo}=Ai(async()=>x!=="table"||!st?0:await jt.countTableRows(st,it),[x,st,it]),Fo=Math.max(1,Math.ceil((Eo||0)/Na)),{data:vs}=Ai(async()=>st?await jt.getTableSchema(st):[],[st]),{data:Hi}=Ai(async()=>oe?await jt.getTableSchema(oe):[],[oe]);Z.useEffect(()=>{const X=(vs||[]).map(Ee=>Ee.name);if(X.length===0){J("");return}(!q||!X.includes(q))&&J(X[0])},[vs,q]),Z.useEffect(()=>{const X=(vs||[]).map(Ee=>Ee.name);F(Ee=>Ee.filter(Ke=>X.includes(Ke)))},[vs]);const qA=Wt.useMemo(()=>{const X=ma&&ma.length>0?Object.keys(ma[0]).filter(Ee=>Ee!=="_rowid"):[];return K.length>0?X.filter(Ee=>K.includes(Ee)):X},[ma,K]);Z.useEffect(()=>{x!=="table"||!le||te!=="columns"||qA.length!==0&&F(qA)},[qA,x,le,te]),Z.useEffect(()=>{I([])},[st]),Z.useEffect(()=>{if(x==="table"){const X=setTimeout(()=>{js()},500);return()=>clearTimeout(X)}},[it,x,js]);const pn=Z.useCallback(async X=>{const Ee=X.trim();if(!Ee)return;const Ke=Ee.toUpperCase();if(/^(INSERT|UPDATE|DELETE|DROP|CREATE|ALTER|REPLACE|TRUNCATE|VACUUM|ATTACH|DETACH)\b/.test(Ke)&&!await Qt.confirm(s("datainspector.write_confirm")))return;const nr=/^\s*SELECT\b/i.test(Ee),ir=/\bLIMIT\b/i.test(Ee);if(nr&&!ir&&Q&&!await Qt.confirm(s("datainspector.limit_confirm_prompt",{limit:V})))return;let Br=Ee.replace(/;\s*$/,"");if(nr){const Or=Math.max(1,Math.floor(V||1));Br=`SELECT * FROM (${Br}) AS __litebi_guard LIMIT ${Or}`,Tt(s("datainspector.limit_applied_notice",{limit:Or}))}else Tt("");Zt("result"),Re(Br),js(),k(Or=>[Ee,...Or.filter(Pr=>Pr!==Ee)].slice(0,12)),nr&&localStorage.setItem(AB,Ee)},[js,k,V,Q,s]),du=async()=>{await pn(w)},N=async()=>{await jt.abortActiveQueries()||await Qt.info(s("datainspector.cancel_not_available","No cancellable SQL query is currently running in this tab."))},ae=Z.useCallback(async X=>{const Ee=X.trim();if(!Ee){kr([]),rr("");return}Kt(!0),rr("");try{const Ke=await jt.executeRaw(`EXPLAIN QUERY PLAN ${Ee}`);kr(Ke)}catch(Ke){kr([]),rr(Ke instanceof Error?Ke.message:String(Ke))}finally{Kt(!1)}},[]),Se=async X=>{const Ee=X.trim();if(!Ee)return;const Ke=bs(Ee),ft=U.find(ir=>bs(ir.sql_text)===Ke);if(ft){await jt.setSqlStatementFavorite(ft.id,Number(ft.is_favorite)!==1),await Ps();return}const nr=Ee.split(`
`).map(ir=>ir.trim()).find(Boolean)||Ee;await jt.saveSqlStatement({id:crypto.randomUUID(),name:nr.slice(0,42),sql_text:Ee,scope:f,is_favorite:!0}),await Ps()},Qe=async()=>{const X=w.trim();if(!X)return;const Ee=bs(X),Ke=U.find(Aa=>Aa.scope===f&&bs(Aa.sql_text)===Ee),ft=Ke?.name||G||`${st||"Query"} Template`,nr=Ke?s("datainspector.custom_template_prompt_update","Template name (updates existing):"):s("datainspector.custom_template_prompt"),ir=(await Qt.prompt(nr,{defaultValue:ft}))?.trim();if(!ir)return;const Br=U.find(Aa=>Aa.name.toLowerCase()===ir.toLowerCase()&&Aa.scope===f);if(Br&&Ke&&Br.id!==Ke.id){if(!await Qt.confirm(s("datainspector.custom_template_overwrite_confirm",{name:ir})))return;await jt.deleteSqlStatement(Br.id)}else if(Br&&!Ke&&!await Qt.confirm(s("datainspector.custom_template_overwrite_confirm",{name:ir})))return;const Or=Ke?.id||Br?.id||crypto.randomUUID(),Pr=Ke?Number(Ke.is_favorite)===1:Br?Number(Br.is_favorite)===1:!1;await jt.saveSqlStatement({id:Or,name:ir,sql_text:X,scope:f,is_favorite:Pr}),ne(ir),await Ps()},ze=X=>{Hr(X.table),St(X.searchTerm),io(X.sortConfig),Bl(X.filters||{}),Wn(!!X.showFilters),fi||m("table")},ct=async()=>{const X=lA.find(ft=>ft.id===Ri)?.name||`${st} View`,Ee=(await Qt.prompt(s("datainspector.new_view_prompt"),{defaultValue:X}))?.trim();if(!Ee)return;const Ke={id:Ri||crypto.randomUUID(),name:Ee,table:st,searchTerm:it,sortConfig:Ln,filters:Ls,showFilters:Si};OA(ft=>{const nr=ft.filter(ir=>ir.id!==Ke.id);return[Ke,...nr].slice(0,20)}),fn(Ke.id)},wt=async()=>{Ri&&await Qt.confirm(s("datainspector.delete_view_confirm"))&&(OA(X=>X.filter(Ee=>Ee.id!==Ri)),fn(""))},Gt=Z.useCallback(X=>`"${X.replace(/"/g,'""')}"`,[]),pr=()=>{!st||qs!=="table"||(Jr(`idx_${st}_`),fr([]),re(!1),me(""),Yt(!0))},Ur=X=>{fr(Ee=>Ee.includes(X)?Ee.filter(Ke=>Ke!==X):[...Ee,X])},Wr=(X,Ee)=>{fr(Ke=>{const ft=Ke.indexOf(X);if(ft===-1)return Ke;const nr=Ee==="up"?ft-1:ft+1;if(nr<0||nr>=Ke.length)return Ke;const ir=[...Ke];return[ir[ft],ir[nr]]=[ir[nr],ir[ft]],ir})},da=async()=>{const X=Mr.trim();if(!(!st||qs!=="table")){if(!X){await Qt.warning(s("datasource.index_create_name_required","Please provide an index name."));return}if(jr.length===0){await Qt.warning(s("datasource.index_create_columns_required","Please select at least one column."));return}ye(!0);try{const Ee=Cr?"UNIQUE ":"",Ke=jr.map(Gt).join(", "),ft=ke.trim()?` WHERE ${ke.trim()}`:"",nr=`CREATE ${Ee}INDEX ${Gt(X)} ON ${Gt(st)} (${Ke})${ft};`;await jt.executeRaw(nr),Yt(!1),js(),await Qt.info(s("datasource.index_create_success","Index created."))}catch(Ee){await Qt.error(s("common.error")+": "+(Ee instanceof Error?Ee.message:String(Ee)))}finally{ye(!1)}}},Za=Z.useCallback((X,Ee)=>`idx_${X}_${Ee.join("_")}`.toLowerCase().replace(/[^a-z0-9_]/g,"_").slice(0,60),[]),ps=Z.useCallback(async X=>{const Ee=Gt(X),ft=(await jt.executeRaw(`PRAGMA index_list(${Ee});`)).map(ir=>String(ir.name??"")).filter(Boolean),nr=[];for(const ir of ft){const Or=(await jt.executeRaw(`PRAGMA index_info(${Gt(ir)});`)).map(Pr=>String(Pr.name??"")).filter(Boolean);Or.length>0&&nr.push(Or)}return nr},[Gt]),Pa=Z.useCallback(async()=>{if(!(!st||qs!=="table")){Ne(!0);try{const X=(vs||[]).map(qr=>qr.name);if(X.length===0){ce([]);return}const Ee=await ps(st),Ke=await jt.executeRaw(`SELECT COUNT(*) AS total_rows FROM ${Gt(st)};`),ft=Number(Ke[0]?.total_rows??0),nr=X.slice(0,14),ir=await Promise.all(nr.map(async qr=>{const fa=await jt.executeRaw(`SELECT COUNT(DISTINCT ${Gt(qr)}) AS distinct_count FROM ${Gt(st)};`),gs=Number(fa[0]?.distinct_count??0),es=ft>0?gs/ft:0;return{column:qr,distinctCount:gs,ratio:es}})),Br=[],Or=new Set,Pr=(qr,fa,gs)=>{const es=qr.filter(Boolean);if(es.length===0)return;const Zs=es.join("|").toLowerCase();Or.has(Zs)||(Or.add(Zs),Br.push({columns:es,reason:fa,score:gs}))},Aa=Object.keys(Ls).filter(qr=>X.includes(qr));if(Aa.forEach((qr,fa)=>{Pr([qr],s("datainspector.index_suggestion_reason_filter","Used in active table filter"),95-fa)}),Ln?.key&&X.includes(String(Ln.key))&&Pr([String(Ln.key)],s("datainspector.index_suggestion_reason_sort","Used as active sort column"),92),Aa.length>1)Pr(Aa.slice(0,2),s("datainspector.index_suggestion_reason_composite","Composite index for combined filters"),96);else if(Aa.length===1&&Ln?.key&&X.includes(String(Ln.key))){const qr=String(Ln.key);qr!==Aa[0]&&Pr([Aa[0],qr],s("datainspector.index_suggestion_reason_filter_sort","Composite index for filter + sort"),97)}ir.sort((qr,fa)=>fa.ratio-qr.ratio).slice(0,3).forEach((qr,fa)=>{qr.ratio<.08||Pr([qr.column],s("datainspector.index_suggestion_reason_cardinality","High cardinality column"),86-fa)});const In=qr=>Ee.some(fa=>fa.length>=qr.length&&qr.every((gs,es)=>fa[es]===gs)),Zr=Br.filter(qr=>!In(qr.columns)).sort((qr,fa)=>fa.score-qr.score).slice(0,5).map(qr=>{const fa=Za(st,qr.columns),gs=qr.columns.map(es=>Gt(es)).join(", ");return{id:`${st}:${qr.columns.join("|")}`,indexName:fa,columns:qr.columns,reason:qr.reason,score:qr.score,sql:`CREATE INDEX ${Gt(fa)} ON ${Gt(st)} (${gs});`}});ce(Zr)}catch(X){await Qt.error(s("common.error")+": "+(X instanceof Error?X.message:String(X)))}finally{Ne(!1)}}},[Za,ps,Gt,qs,st,vs,Ls,Ln,s]),Ks=Z.useCallback(async X=>{Ue(X.id);try{await jt.executeRaw(X.sql),await Qt.info(s("datasource.index_create_success","Index created.")),ce(Ee=>Ee.filter(Ke=>Ke.id!==X.id)),js()}catch(Ee){await Qt.error(s("common.error")+": "+(Ee instanceof Error?Ee.message:String(Ee)))}finally{Ue("")}},[js,s]),Us=Wt.useMemo(()=>{if(!ma||ma.length===0)return[];const X=Object.keys(ma[0]).filter(Ke=>Ke!=="_rowid"),Ee=K.length>0?X.filter(Ke=>K.includes(Ke)):X;return Ee.length===0?[]:Ee.map(Ke=>{const ft=Ke.toLowerCase().includes("amount")||Ke.toLowerCase().includes("price"),nr=Ke.toLowerCase().includes("id"),Br=typeof ma[0][Ke]=="number";return{header:Ke,accessor:Ke,align:Br?"right":"left",className:nr?"font-mono text-[10px] text-slate-400":Ke==="Period"||Ke==="PostingDate"?"font-mono":"",render:ft?Or=>l.jsx("span",{className:Number(Or[Ke]??0)<0?"text-red-500":"text-slate-900 dark:text-slate-100",children:new Intl.NumberFormat("de-DE",{style:"currency",currency:Or.Currency||"EUR"}).format(Or[Ke]||0)}):void 0}})},[ma,K]),Js=n.language.startsWith("de")?"de-DE":"en-US",El=new Date,ul=`${s("common.loading").replace("...","")} ${El.toLocaleDateString(Js)}, ${El.toLocaleTimeString(Js,{hour:"2-digit",minute:"2-digit"})}`;Z.useEffect(()=>{x!=="sql"&&(kr([]),rr(""),Kt(!1))},[x]),Z.useEffect(()=>{if(x!=="sql"||Ft!=="explain")return;const X=window.setTimeout(()=>{ae(w)},250);return()=>window.clearTimeout(X)},[x,Ft,w,ae]);const Fl=[{key:"top10",sql:`SELECT * FROM ${st||"table_name"} LIMIT 10`},{key:"count",sql:`SELECT COUNT(*) AS total_rows FROM ${st||"table_name"}`},{key:"nullscan",sql:`SELECT * FROM ${st||"table_name"} WHERE 1=1 LIMIT 50`},{key:"duplicates",sql:`SELECT key_column, COUNT(*) AS cnt FROM ${st||"table_name"} GROUP BY key_column HAVING COUNT(*) > 1 ORDER BY cnt DESC LIMIT 50`},{key:"outliers",sql:`SELECT * FROM ${st||"table_name"} WHERE value_column IS NOT NULL ORDER BY value_column DESC LIMIT 25`}];Z.useEffect(()=>{Ka.length&&(!oe||!Ka.includes(oe))&&He(st&&Ka.includes(st)?st:Ka[0])},[oe,st,Ka]);const ws=Wt.useMemo(()=>(Hi||[]).map(X=>X.name),[Hi]),To=Wt.useMemo(()=>(Hi||[]).filter(X=>/int|real|num|dec|float|double/i.test(X.type||"")).map(X=>X.name),[Hi]),dl=Wt.useMemo(()=>{const X=nt.trim().toLowerCase();return X?ws.filter(Ee=>Ee.toLowerCase().includes(X)):ws},[nt,ws]),Pi=mt!=="none";Z.useEffect(()=>{qe(X=>X.filter(Ee=>ws.includes(Ee))),mt!=="none"&&mt!=="count"&&gt&&!ws.includes(gt)&&dr(""),Rt(X=>X.filter(Ee=>ws.includes(Ee))),Ot(X=>X.map(Ee=>Ee.column&&!ws.includes(Ee.column)?{...Ee,column:""}:Ee)),er(X=>X.map(Ee=>Ee.column&&!ws.includes(Ee.column)&&Ee.column!==$t?{...Ee,column:""}:Ee))},[mt,gt,ws,$t]),Z.useEffect(()=>{mt==="none"||mt==="count"||gt||(To.length>0?dr(To[0]):ws.length>0&&dr(ws[0]))},[mt,gt,ws,To]);const cA=Z.useCallback(()=>{qe([]),Dt(""),Ot([{id:"f0",connector:"AND",column:"",operator:"=",value:""}]),at(""),pt("AND"),er([{id:"s0",column:"",direction:"DESC"}]),Vt(100),Nt("none"),dr(""),Rt([]),vr("metric_value")},[]),oo=Z.useCallback(()=>{const X=`f_${Date.now()}_${Math.random().toString(36).slice(2,7)}`;Ot(Ee=>[...Ee,{id:X,connector:"AND",column:"",operator:"=",value:""}])},[]),_s=Z.useCallback((X,Ee)=>{Ot(Ke=>Ke.map(ft=>ft.id===X?{...ft,...Ee}:ft))},[]),Lo=Z.useCallback(X=>{Ot(Ee=>{const Ke=Ee.filter(ft=>ft.id!==X);return Ke.length>0?Ke:[{id:"f0",connector:"AND",column:"",operator:"=",value:""}]})},[]),Ao=Z.useCallback((X,Ee)=>{Ot(Ke=>{const ft=Ke.findIndex(Or=>Or.id===X);if(ft<0)return Ke;const nr=Ee==="up"?ft-1:ft+1;if(nr<0||nr>=Ke.length)return Ke;const ir=[...Ke],[Br]=ir.splice(ft,1);return ir.splice(nr,0,Br),ir})},[]),KA=Z.useCallback(()=>{const X=`s_${Date.now()}_${Math.random().toString(36).slice(2,7)}`;er(Ee=>[...Ee,{id:X,column:"",direction:"DESC"}])},[]),fl=Z.useCallback((X,Ee)=>{er(Ke=>Ke.map(ft=>ft.id===X?{...ft,...Ee}:ft))},[]),Yn=Z.useCallback(X=>{er(Ee=>{const Ke=Ee.filter(ft=>ft.id!==X);return Ke.length>0?Ke:[{id:"s0",column:"",direction:"DESC"}]})},[]),Tl=Z.useCallback((X,Ee)=>{er(Ke=>{const ft=Ke.findIndex(Or=>Or.id===X);if(ft<0)return Ke;const nr=Ee==="up"?ft-1:ft+1;if(nr<0||nr>=Ke.length)return Ke;const ir=[...Ke],[Br]=ir.splice(ft,1);return ir.splice(nr,0,Br),ir})},[]),uA=Z.useCallback(()=>{if(!oe)return"";const X=La=>`"${La.replace(/"/g,'""')}"`,Ee=La=>{const _a=La.trim();return _a?/^'.*'$|^".*"$/.test(_a)||/^-?\d+(\.\d+)?$/.test(_a)?_a:`'${_a.replace(/'/g,"''")}'`:""},Ke=`FROM ${X(oe)}`,ft=mt.toUpperCase(),nr=mt==="count"?`COUNT(*) AS ${X($t||"metric_value")}`:`${ft}(${X(gt)}) AS ${X($t||"metric_value")}`;let ir="SELECT *";const Br=[];if(mt==="none")ir=`SELECT ${se.length>0?se.map(X).join(", "):"*"}`;else{const La=Ht.map(X);Br.push(...La),ir=`SELECT ${[...La,nr].join(", ")}`}const Or=It.map(_a=>{if(!_a.column.trim()||!_a.operator.trim())return null;const Wi=X(_a.column.trim());if(_a.operator==="IS NULL"||_a.operator==="IS NOT NULL")return{connector:_a.connector,expr:`${Wi} ${_a.operator}`};const Il=Ee(_a.value);return Il?{connector:_a.connector,expr:`${Wi} ${_a.operator} ${Il}`}:null}).filter(_a=>!!_a).reduce((_a,Wi,Il)=>Il===0?Wi.expr:`${_a} ${Wi.connector} ${Wi.expr}`,""),Pr=Ye.trim(),Aa=Or&&Pr?`WHERE (${Or}) ${Ge} (${Pr})`:Or?`WHERE ${Or}`:Pr?`WHERE ${Pr}`:"",In=Br.length>0?`GROUP BY ${Br.join(", ")}`:"",Zr=sr.filter(La=>La.column.trim()).map(La=>`${La.column===$t?X($t||"metric_value"):X(La.column)} ${La.direction}`),qr=mt!=="none"?[`${X($t||"metric_value")} DESC`]:[],fa=Zr.length>0?Zr:qr,gs=fa.length>0?`ORDER BY ${fa.join(", ")}`:"",Zs=`LIMIT ${Math.max(1,Math.min(1e5,Math.floor(Number(cr)||100)))}`;return[ir,Ke,Aa,In,gs,Zs].filter(Boolean).join(`
`)},[mt,gt,It,Ht,cr,$t,sr,se,oe,Ge,Ye])(),hi=Z.useCallback(async X=>{const Ee=uA.trim();if(Ee){if(t==="table"){Xn(Ee);return}m("sql"),v(Ee),Gr(Ee.length),Zt("result"),L(!1),X==="run"&&await pn(Ee)}},[uA,pn,t,Xn,L]),hl=bs(w),Ll=U.find(X=>bs(X.sql_text)===hl),jo=!!(Ll&&Number(Ll.is_favorite)===1),qi=Wt.useMemo(()=>{const X=T.trim().toLowerCase();return X?U.filter(Ee=>Ee.name.toLowerCase().includes(X)||Ee.sql_text.toLowerCase().includes(X)||(Ee.description||"").toLowerCase().includes(X)):U},[T,U]),Uo=Wt.useMemo(()=>U.filter(X=>Number(X.is_favorite)===1).length,[U]),Jn=Z.useCallback(async(X,Ee)=>{if(t==="table"){Xn(X.sql_text);return}m("sql"),v(X.sql_text),Gr(X.sql_text.length),Zt("result"),L(!1),await jt.markSqlStatementUsed(X.id),Ee&&await pn(X.sql_text),await Ps()},[pn,t,Xn,Ps,L]),jn=Z.useCallback(async(X,Ee)=>{if(t==="table"){Xn(X);return}m("sql"),v(X),Gr(X.length),Zt("result"),L(!1),Ee&&await pn(X)},[pn,t,Xn,L]),Ki=Z.useCallback(X=>{we(Ee=>({...Ee,[X]:!Ee[X]}))},[we]),Un=Z.useCallback(X=>{Ae(Ee=>({...Ee,[X]:!Ee[X]}))},[Ae]),co=Z.useCallback(async X=>{await Qt.confirm(s("datainspector.custom_template_delete_confirm"))&&(await jt.deleteSqlStatement(X.id),await Ps())},[Ps,s]),zA=Z.useCallback(async X=>{const Ee=(await Qt.prompt(s("datainspector.rename_template_prompt"),{defaultValue:X.name}))?.trim();if(!Ee||Ee===X.name)return;const Ke=U.find(ft=>ft.id!==X.id&&ft.name.toLowerCase()===Ee.toLowerCase()&&ft.scope===X.scope);Ke&&!await Qt.confirm(s("datainspector.custom_template_overwrite_confirm",{name:Ee}))||(Ke&&await jt.deleteSqlStatement(Ke.id),await jt.saveSqlStatement({id:X.id,name:Ee,sql_text:X.sql_text,description:X.description,scope:X.scope,tags:X.tags,is_favorite:Number(X.is_favorite)===1}),await Ps())},[Ps,U,s]),dA=Z.useCallback(()=>{if(!ma||ma.length===0)return;const X=new Date().toISOString().slice(0,10),Ee=ma.map(Ke=>{const ft={...Ke};return delete ft._rowid,ft});Yq(Ee,`export_${X}`,"Export")},[ma]),ys=Z.useCallback(()=>{const X=q.trim();X&&(Bl(Ee=>({...Ee,[X]:Y})),Wn(!0))},[Wn,q,Y]),fu=Z.useCallback(X=>{Bl(Ee=>{const Ke={...Ee};return delete Ke[X],Ke})},[]),jl=Z.useCallback(()=>{Bl({}),St(""),Wn(!1),de("")},[Wn]),Ul=Z.useCallback(()=>{const Ee=`SELECT * FROM "${st.replace(/"/g,'""')}" LIMIT 100`;if(t==="table"){Xn(Ee);return}m("sql"),v(Ee),Gr(Ee.length),Zt("result"),pe(!1)},[t,Xn,st,pe]),zs=Z.useCallback(X=>{Le(X),pe(!0)},[pe,Le]),Dl=Z.useCallback(X=>{const Ee=st.replace(/"/g,'""'),Ke=nr=>`"${nr.replace(/"/g,'""')}"`;return`SELECT ${X.length>0?X.map(Ke).join(", "):"*"}
FROM "${Ee}"
LIMIT 100`},[st]),VA=Z.useCallback(async X=>{if(je.length===0){await Qt.info(s("datainspector.table_tools_pick_fields_required","Select at least one field."));return}const Ee=Dl(je);if(t==="table"){Xn(Ee);return}m("sql"),v(Ee),Gr(Ee.length),Zt("result"),pe(!1),X&&await pn(Ee)},[Dl,pn,t,Xn,pe,je,s]),GA=Z.useCallback(async()=>{if(je.length===0){await Qt.info(s("datainspector.table_tools_pick_fields_required","Select at least one field."));return}m("table"),I(je),pe(!1)},[pe,je,s]),zi=Z.useCallback((X,Ee)=>{let Ke=Ee,ft=Ee;const nr=Br=>/[A-Za-z0-9_."]/i.test(Br);for(;Ke>0&&nr(X[Ke-1]);)Ke-=1;for(;ft<X.length&&nr(X[ft]);)ft+=1;const ir=X.slice(Ke,Ee);return{start:Ke,end:ft,token:ir}},[]),Ds=Wt.useMemo(()=>{if(x!=="sql"||!P)return[];const X=(vs||[]).map(Zr=>Zr.name),{token:Ee}=zi(w,zt),Ke=Ee.trim().toLowerCase(),ft=w.slice(0,zt).toUpperCase(),nr=/\b(FROM|JOIN|INTO|UPDATE|TABLE)\s+["A-Z0-9_]*$/i.test(ft),ir=/\b(SELECT|WHERE|AND|OR|ON|HAVING|BY|ORDER BY|GROUP BY)\s+["A-Z0-9_.,]*$/i.test(ft),Br=lG.filter(Zr=>Ke.length===0||Zr.toLowerCase().startsWith(Ke)).map(Zr=>({label:Zr,insert:Zr,type:"keyword"})),Or=(Ka||[]).filter(Zr=>Ke.length===0||Zr.toLowerCase().startsWith(Ke)).map(Zr=>({label:Zr,insert:Zr,type:"table"})),Pr=X.filter(Zr=>Ke.length===0||Zr.toLowerCase().startsWith(Ke)).map(Zr=>({label:Zr,insert:Zr,type:"column"}));let Aa=[];return nr?Aa=[...Or,...Br]:ir||Ee.includes(".")?Aa=[...Pr,...Br,...Or]:Aa=[...Br,...Or,...Pr],Aa.filter((Zr,qr,fa)=>fa.findIndex(gs=>gs.label===Zr.label&&gs.type===Zr.type)===qr).slice(0,16)},[x,P,vs,zi,w,zt,Ka]);Z.useEffect(()=>{Tn(0),oa(x==="sql"&&P&&Ds.length>0)},[x,P,Ds]),Z.useEffect(()=>{P||oa(!1)},[P]);const Vi=Z.useCallback(X=>{const{start:Ee,end:Ke}=zi(w,zt),ft=`${w.slice(0,Ee)}${X.insert}${w.slice(Ke)}`,nr=Ee+X.insert.length;v(ft),Gr(nr),oa(!1),Tn(0),window.setTimeout(()=>{Ut.current?.focus(),Ut.current?.setSelectionRange(nr,nr)},0)},[zi,w,zt]),fA=Z.useCallback(X=>{if(P){if(!Qr||Ds.length===0){X.key===" "&&X.ctrlKey&&(X.preventDefault(),oa(!0));return}if(X.key==="ArrowDown"){X.preventDefault(),Tn(Ee=>(Ee+1)%Ds.length);return}if(X.key==="ArrowUp"){X.preventDefault(),Tn(Ee=>(Ee-1+Ds.length)%Ds.length);return}if(X.key==="Enter"||X.key==="Tab"){X.preventDefault(),Vi(Ds[fs]);return}X.key==="Escape"&&(X.preventDefault(),oa(!1))}},[P,Qr,fs,Vi,Ds]),Zn=Z.useCallback(()=>{const X=Ut.current;if(!X)return;const Ee=X.selectionStart??zt,Ke=window.getComputedStyle(X),ft=document.createElement("div"),nr=["boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontFamily","lineHeight","textAlign","textTransform","textIndent","letterSpacing","wordSpacing"];ft.style.position="absolute",ft.style.visibility="hidden",ft.style.whiteSpace="pre-wrap",ft.style.wordWrap="break-word",ft.style.top="0",ft.style.left="-9999px";for(const fa of nr)ft.style[fa]=Ke[fa];ft.style.width=`${X.clientWidth}px`,ft.textContent=X.value.slice(0,Ee);const ir=document.createElement("span");ir.textContent=X.value.slice(Ee)||".",ft.appendChild(ir),document.body.appendChild(ft);const Br=Number.parseFloat(Ke.lineHeight),Or=Number.isFinite(Br)?Br:18,Pr=ir.offsetTop-X.scrollTop+Or+6,Aa=ir.offsetLeft-X.scrollLeft+8;document.body.removeChild(ft);const In=Math.max(8,Math.min(Pr,X.clientHeight-44)),Zr=Math.max(8,Math.min(Aa,X.clientWidth-180)),qr=Math.max(180,X.clientWidth-Zr-10);ve({top:In,left:Zr,width:Math.min(420,qr)})},[zt]);Z.useEffect(()=>{!Qr||Ds.length===0||Zn()},[Qr,Ds.length,zt,w,Zn]),Z.useEffect(()=>{yt(tt)},[tt]),Z.useEffect(()=>{if(Ct===tt)return;const X=window.setTimeout(()=>{_t(Ct)},180);return()=>window.clearTimeout(X)},[Ct,tt,_t]);const pi=Wt.useMemo(()=>{if(x!=="table"||!ma||ma.length===0)return[];const X=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,Ee=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,Ke=/^[A-Z]{2}\d{2}[A-Z0-9]{10,30}$/i,ft=/^https?:\/\/[^\s/$.?#].[^\s]*$/i,nr=Br=>{if(!(/^\d{4}-\d{2}-\d{2}/.test(Br)||/^\d{2}[./-]\d{2}[./-]\d{2,4}$/.test(Br)))return!1;const Pr=Date.parse(Br.replace(/\./g,"-"));return!Number.isNaN(Pr)};return Object.keys(ma[0]).filter(Br=>Br!=="_rowid").map(Br=>{const Or=ma.map(xr=>xr[Br]),Pr=Or.filter(xr=>xr!=null&&String(xr).trim()!==""),Aa=Or.length-Pr.length,In=Or.length>0?Aa/Or.length*100:0,Zr=Pr.map(xr=>String(xr).trim()),qr=new Set(Zr).size,fa=Pr.map(xr=>typeof xr=="number"?xr:Number(xr)).filter(xr=>!Number.isNaN(xr)),gs=fa.length,es=Pr.filter(xr=>xr instanceof Date||nr(String(xr).trim())).length;let Zs="unknown";if(Pr.length===0)Zs="unknown";else{const xr=gs/Pr.length,pl=es/Pr.length;xr>.9?Zs="number":pl>.9?Zs="date":xr>.1||pl>.1?Zs="mixed":Zs="text"}const La=fa.length>0?Math.min(...fa):null,_a=fa.length>0?Math.max(...fa):null,Wi={email:Zr.filter(xr=>X.test(xr)).length,uuid:Zr.filter(xr=>Ee.test(xr)).length,iban:Zr.filter(xr=>Ke.test(xr)).length,url:Zr.filter(xr=>ft.test(xr)).length,date:Zr.filter(xr=>nr(xr)).length},Il=Object.entries(Wi).filter(([,xr])=>xr>=2&&xr/Math.max(1,Zr.length)>=.2).sort((xr,pl)=>pl[1]-xr[1]).map(([xr])=>xr),uo=Object.entries(Wi).sort((xr,pl)=>pl[1]-xr[1])[0],hu=uo?uo[1]/Math.max(1,Zr.length):0;let Ei=0;Zs==="number"?Ei=Math.max(0,Pr.length-gs):Zs==="date"?Ei=Math.max(0,Pr.length-es):uo&&uo[1]>=3&&hu>=.6&&(Ei=Math.max(0,Pr.length-uo[1]));const hA=new Map;Zr.forEach(xr=>{hA.set(xr,(hA.get(xr)||0)+1)});const Qn=Array.from(hA.entries()).sort((xr,pl)=>pl[1]-xr[1]).slice(0,3),gn=Pr.length>0?qr/Pr.length*100>di.cardinalityRate:!1,Do=[];return In>=di.nullRate&&Do.push("high_null"),Zs==="mixed"&&Do.push("mixed_types"),gn&&Do.push("high_cardinality"),Ei>0&&Do.push("suspicious_values"),{key:Br,distinctCount:qr,nullRate:In,min:La,max:_a,topValues:Qn,detectedType:Zs,patterns:Il,suspiciousCount:Ei,issues:Do}})},[x,ma,di]),Dn=Wt.useMemo(()=>pi.reduce((X,Ee)=>X+Ee.issues.length,0),[pi]),Gi=X=>{X.preventDefault(),X.stopPropagation(),HA.current={startY:X.clientY,startHeight:Ct},$n.current=Ct,MA(!0)};return Z.useEffect(()=>{if(!RA)return;const X=Ke=>{const ft=HA.current;if(!ft)return;const nr=Ke.clientY-ft.startY,ir=120,Br=Math.max(260,Math.floor(window.innerHeight*.62)),Or=Math.max(ir,Math.min(Br,ft.startHeight+nr));$n.current=Or,Ut.current&&(Ut.current.style.height=`${Or}px`)},Ee=()=>{const Ke=Math.round($n.current);hn.current=Date.now(),yt(Ke),MA(!1),HA.current=null};return document.body.style.cursor="row-resize",document.body.style.userSelect="none",document.body.style.overflowAnchor="none",window.addEventListener("mousemove",X),window.addEventListener("mouseup",Ee),()=>{document.body.style.cursor="",document.body.style.userSelect="",document.body.style.overflowAnchor="",window.removeEventListener("mousemove",X),window.removeEventListener("mouseup",Ee)}},[RA,yt]),l.jsxs(x0,{header:{title:AA,subtitle:s("datainspector.subtitle",{count:x==="sql"&&Ft==="explain"?vt.length:x==="table"&&Ys==="profiling"?pi.length:ma?.length||0,mode:x==="table"?st:s("datainspector.sql_mode")}),onBack:e,actions:l.jsxs(l.Fragment,{children:[PA&&l.jsxs("button",{onClick:()=>{o(PA.replace(/^#/,""))},className:"h-10 flex items-center gap-2 px-3 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-sm font-semibold rounded-lg border border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-700 transition-all",title:s("datainspector.back_to_dashboard"),children:[l.jsx(Y8,{className:"w-4 h-4"}),l.jsx("span",{className:"hidden sm:inline",children:s("datainspector.back_to_dashboard")})]}),!fi&&l.jsxs("div",{className:"flex items-center bg-slate-100 dark:bg-slate-800 p-1 rounded-lg",children:[l.jsxs("button",{onClick:()=>{m("table"),js()},className:`px-3 py-1.5 rounded-md text-sm font-medium transition-all flex items-center gap-2 ${x==="table"?"bg-white dark:bg-slate-700 shadow text-blue-600 dark:text-blue-400":"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"}`,children:[l.jsx(CA,{className:"w-4 h-4"}),s("datainspector.table_mode")]}),l.jsxs("button",{onClick:()=>{m("sql"),Zt(E?"explain":"result"),w||v(`SELECT * FROM ${st} LIMIT 10`)},className:`px-3 py-1.5 rounded-md text-sm font-medium transition-all flex items-center gap-2 ${x==="sql"?"bg-white dark:bg-slate-700 shadow text-blue-600 dark:text-blue-400":"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"}`,children:[l.jsx(J8,{className:"w-4 h-4"}),s("datainspector.sql_mode")]})]}),l.jsx("button",{onClick:js,className:"h-10 w-10 flex items-center justify-center bg-white dark:bg-slate-800 text-slate-500 dark:text-slate-400 rounded-lg border border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-700 hover:text-slate-700 dark:hover:text-slate-200 transition-all",title:s("datainspector.refresh_title"),children:l.jsx(Zc,{className:`w-4 h-4 ${Ni?"animate-spin":""}`})}),l.jsxs("button",{onClick:dA,className:"h-10 flex items-center gap-2 px-4 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-sm font-semibold rounded-lg border border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-700 transition-all",children:[l.jsx(Jx,{className:"w-4 h-4"}),l.jsx("span",{className:"hidden sm:inline",children:s("datainspector.export_excel")})]})]})},rightPanel:{title:x==="table"?s("datainspector.table_tools","Table Tools"):s("datainspector.sql_assist","SQL Workspace"),enabled:x==="sql"||x==="table",triggerTitle:x==="table"?s("datainspector.table_tools","Table Tools"):s("datainspector.sql_assist","SQL Workspace"),width:"sm",isOpen:x==="table"?le:S,onOpenChange:x==="table"?pe:L,content:x==="table"?l.jsxs("div",{className:"h-full min-h-0 flex flex-col gap-4",children:[l.jsxs("div",{className:"inline-flex items-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 p-1 flex-shrink-0",children:[l.jsx("button",{type:"button",onClick:()=>Le("columns"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${te==="columns"?"bg-blue-600 text-white":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:s("datainspector.table_tools_tab_columns","Columns")}),l.jsx("button",{type:"button",onClick:()=>Le("filters"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${te==="filters"?"bg-blue-600 text-white":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:s("datainspector.table_tools_tab_filters","Filters")}),l.jsx("button",{type:"button",onClick:()=>Le("actions"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${te==="actions"?"bg-blue-600 text-white":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:s("datainspector.table_tools_tab_actions","Actions")})]}),te==="columns"&&l.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-2",children:[l.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:s("datainspector.table_tools_columns_hint","Inspect schema and set sorting per column.")}),l.jsxs("div",{className:"rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900/40 p-2 space-y-2",children:[l.jsxs("div",{className:"flex items-center justify-between gap-2",children:[l.jsx("span",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:s("datainspector.table_tools_field_picker","Field Picker")}),l.jsx("span",{className:"text-[11px] text-slate-500 dark:text-slate-400",children:s("datainspector.table_tools_selected_count",{count:je.length,defaultValue:"{{count}} selected"})})]}),l.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[l.jsx("button",{type:"button",onClick:()=>F((vs||[]).map(X=>X.name)),className:"h-7 w-7 inline-flex items-center justify-center rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:s("datainspector.table_tools_select_all_fields","Select all"),"aria-label":s("datainspector.table_tools_select_all_fields","Select all"),children:l.jsx($8,{className:"w-3.5 h-3.5"})}),l.jsx("button",{type:"button",onClick:()=>F([]),className:"h-7 w-7 inline-flex items-center justify-center rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:s("datainspector.table_tools_clear_field_selection","Clear"),"aria-label":s("datainspector.table_tools_clear_field_selection","Clear"),children:l.jsx(Jg,{className:"w-3.5 h-3.5"})}),l.jsxs("button",{type:"button",onClick:()=>{VA(!1)},className:"h-7 px-2 inline-flex items-center gap-1 text-[11px] rounded border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/30 text-blue-700 dark:text-blue-300",children:[l.jsx(k2,{className:"w-3.5 h-3.5"}),s("datainspector.sql_assist","SQL Workspace")]}),l.jsx("button",{type:"button",onClick:()=>{GA()},className:"h-7 w-7 inline-flex items-center justify-center text-[11px] rounded border border-blue-200 bg-blue-600 hover:bg-blue-700 text-white",title:s("datainspector.table_tools_apply_to_table","Apply to Table"),"aria-label":s("datainspector.table_tools_apply_to_table","Apply to Table"),children:l.jsx(Q0,{className:"w-3.5 h-3.5 fill-current"})})]})]}),l.jsx("div",{className:"flex-1 min-h-0 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg divide-y divide-slate-100 dark:divide-slate-700",children:(vs||[]).length===0?l.jsx("div",{className:"p-3 text-xs text-slate-400 dark:text-slate-500",children:s("common.no_data")}):(vs||[]).map(X=>{const Ee=Ln?.key===X.name,Ke=Ee?Ln?.direction:null,ft=je.includes(X.name);return l.jsx("div",{className:`p-3 space-y-2 ${Ee?"bg-blue-50/60 dark:bg-blue-900/20":""} ${ft?"ring-1 ring-inset ring-blue-200 dark:ring-blue-700/60":""}`,children:l.jsxs("div",{className:"flex items-center justify-between gap-2",children:[l.jsxs("div",{className:"min-w-0",children:[l.jsxs("label",{className:"flex items-center gap-2 min-w-0",children:[l.jsx("input",{type:"checkbox",checked:ft,onChange:()=>{F(nr=>nr.includes(X.name)?nr.filter(ir=>ir!==X.name):[...nr,X.name])}}),l.jsxs("div",{className:"text-xs font-semibold text-slate-700 dark:text-slate-200 truncate flex items-center gap-2",children:[l.jsx("span",{className:"truncate",children:X.name}),Ee&&l.jsx("span",{className:"px-1.5 py-0.5 rounded bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 text-[10px] font-bold",children:Ke==="asc"?"ASC":"DESC"})]})]}),l.jsx("div",{className:"text-[10px] text-slate-400 dark:text-slate-500",children:X.type||"-"})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("button",{type:"button",onClick:()=>io({key:X.name,direction:"asc"}),className:`h-7 px-2 text-[11px] rounded border ${Ee&&Ke==="asc"?"border-blue-300 dark:border-blue-800 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300":"border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300"}`,title:s("datainspector.table_tools_sort_asc","Sort ascending"),children:"ASC"}),l.jsx("button",{type:"button",onClick:()=>io({key:X.name,direction:"desc"}),className:`h-7 px-2 text-[11px] rounded border ${Ee&&Ke==="desc"?"border-blue-300 dark:border-blue-800 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300":"border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300"}`,title:s("datainspector.table_tools_sort_desc","Sort descending"),children:"DESC"})]})]})},X.name)})})]}),te==="filters"&&l.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-3",children:[l.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:s("datainspector.table_tools_filters_hint","Manage global search and column filters.")}),l.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:s("datainspector.table_tools_global_search","Global Search")}),l.jsx("input",{type:"text",value:it,onChange:X=>St(X.target.value),placeholder:s("datainspector.search_placeholder"),className:"w-full h-9 px-3 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none focus:ring-2 focus:ring-blue-500"}),l.jsxs("div",{className:"grid grid-cols-[1fr_1fr_auto] gap-2 items-end",children:[l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:s("datainspector.table_tools_column","Column")}),l.jsx("select",{value:q,onChange:X=>J(X.target.value),className:"w-full h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none",children:(vs||[]).map(X=>l.jsx("option",{value:X.name,children:X.name},X.name))})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:s("datainspector.table_tools_filter_value","Filter")}),l.jsx("input",{type:"text",value:Y,onChange:X=>de(X.target.value),className:"w-full h-9 px-3 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none focus:ring-2 focus:ring-blue-500"})]}),l.jsx("button",{type:"button",onClick:ys,className:"h-9 px-3 rounded-lg border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 text-xs font-semibold hover:bg-blue-100 dark:hover:bg-blue-900/30",children:s("datainspector.table_tools_filter_apply","Apply")})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("label",{className:"inline-flex items-center gap-2 text-xs text-slate-600 dark:text-slate-300",children:[l.jsx("input",{type:"checkbox",checked:Si,onChange:X=>Wn(X.target.checked)}),s("datainspector.table_tools_toggle_filter_row","Show filter row in table")]}),l.jsx("button",{type:"button",onClick:jl,className:"text-[11px] text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200",children:s("datainspector.table_tools_clear_all","Clear all")})]}),l.jsx("div",{className:"flex-1 min-h-0 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg divide-y divide-slate-100 dark:divide-slate-700",children:Object.keys(Ls).length===0?l.jsx("div",{className:"p-3 text-xs text-slate-400 dark:text-slate-500",children:s("datainspector.table_tools_no_filters","No active column filters")}):Object.entries(Ls).map(([X,Ee])=>l.jsxs("div",{className:"p-3 flex items-center justify-between gap-2",children:[l.jsxs("div",{className:"min-w-0",children:[l.jsx("div",{className:"text-xs font-semibold text-slate-700 dark:text-slate-200 truncate",children:X}),l.jsx("div",{className:"text-[11px] text-slate-500 dark:text-slate-400 truncate",children:Ee||"-"})]}),l.jsx("button",{type:"button",onClick:()=>fu(X),className:"h-7 px-2 text-[11px] rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",children:s("common.remove","Remove")})]},X))})]}),te==="actions"&&l.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-3",children:[l.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:s("datainspector.table_tools_actions_hint","Quick actions for current table context.")}),l.jsx("button",{type:"button",onClick:()=>js(),className:"h-9 px-3 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-xs font-semibold hover:bg-slate-50 dark:hover:bg-slate-700 text-left",children:s("common.refresh","Refresh")}),l.jsx("button",{type:"button",onClick:dA,className:"h-9 px-3 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-xs font-semibold hover:bg-slate-50 dark:hover:bg-slate-700 text-left",children:s("datainspector.table_tools_export_rows","Export current rows")}),l.jsx("button",{type:"button",onClick:Ul,className:"h-9 px-3 rounded-lg border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 text-xs font-semibold hover:bg-blue-100 dark:hover:bg-blue-900/30 text-left",children:s("datainspector.table_tools_open_sql","Open as SQL")}),l.jsx("button",{type:"button",onClick:ct,className:"h-9 px-3 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-xs font-semibold hover:bg-slate-50 dark:hover:bg-slate-700 text-left",children:s(Ri?"datainspector.update_view":"datainspector.save_view")}),l.jsx("button",{type:"button",onClick:()=>{wt()},disabled:!Ri,className:"h-9 px-3 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-xs font-semibold hover:bg-slate-50 dark:hover:bg-slate-700 text-left disabled:opacity-40",children:s("datainspector.delete_view")}),qs==="table"&&l.jsx("button",{type:"button",onClick:pr,className:"h-9 px-3 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-xs font-semibold hover:bg-slate-50 dark:hover:bg-slate-700 text-left",children:s("datainspector.table_tools_create_index","Create index")}),qs==="table"&&l.jsxs("div",{className:"mt-1 pt-3 border-t border-slate-200 dark:border-slate-700 min-h-0 flex-1 flex flex-col gap-2",children:[l.jsxs("div",{className:"flex items-center justify-between gap-2",children:[l.jsx("div",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:s("datainspector.index_suggestions_title","Index Suggestions")}),l.jsx("button",{type:"button",onClick:()=>{Pa()},disabled:Fe,className:"h-7 px-2 rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300 text-[11px] disabled:opacity-40",children:Fe?s("common.loading","Loading..."):s("datainspector.index_suggestions_generate","Generate")})]}),l.jsx("div",{className:"text-[11px] text-slate-500 dark:text-slate-400",children:s("datainspector.index_suggestions_hint","Based on active filters, sorting, cardinality and existing indexes.")}),l.jsx("div",{className:"min-h-0 flex-1 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg divide-y divide-slate-100 dark:divide-slate-700",children:O.length===0?l.jsx("div",{className:"p-3 text-xs text-slate-400 dark:text-slate-500",children:s("datainspector.index_suggestions_empty","No suggestions yet. Generate to analyze this table.")}):O.map(X=>l.jsxs("div",{className:"p-3 space-y-2",children:[l.jsx("div",{className:"text-xs font-semibold text-slate-700 dark:text-slate-200",children:X.indexName}),l.jsx("div",{className:"text-[11px] text-slate-500 dark:text-slate-400",children:X.reason}),l.jsxs("div",{className:"text-[11px] text-slate-500 dark:text-slate-400",children:[s("datainspector.index_suggestions_columns","Columns"),": ",l.jsx("span",{className:"font-mono",children:X.columns.join(", ")})]}),l.jsx("div",{className:"font-mono text-[10px] text-slate-400 dark:text-slate-500 break-all",children:X.sql}),l.jsx("button",{type:"button",onClick:()=>{Ks(X)},disabled:Te===X.id,className:"h-7 px-2 rounded border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/30 text-blue-700 dark:text-blue-300 text-[11px] disabled:opacity-40",children:Te===X.id?s("common.saving","Saving..."):s("datainspector.index_suggestions_apply","Create")})]},X.id))})]})]})]}):l.jsxs("div",{className:"h-full min-h-0 flex flex-col gap-4",children:[l.jsxs("div",{className:"inline-flex items-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 p-1 flex-shrink-0",children:[l.jsx("button",{type:"button",onClick:()=>ee("manager"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${H==="manager"?"bg-blue-600 text-white":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:s("datainspector.sql_manager_tab","SQL Manager")}),l.jsx("button",{type:"button",onClick:()=>ee("assistant"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${H==="assistant"?"bg-blue-600 text-white":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:s("datainspector.assistant_tab","SQL Builder")})]}),H==="manager"?l.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-3 overflow-hidden",children:[l.jsxs("div",{className:ue.templates?"min-h-0 flex-[0.9] flex flex-col gap-2":"flex-shrink-0",children:[l.jsxs("button",{type:"button",onClick:()=>Ki("templates"),className:"flex items-center justify-between text-left",children:[l.jsx("span",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:s("datainspector.templates")}),l.jsx(oc,{className:`w-4 h-4 text-slate-400 dark:text-slate-500 transition-transform ${ue.templates?"rotate-180":""}`})]}),ue.templates&&l.jsx("div",{className:"flex-1 min-h-0 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg divide-y divide-slate-100 dark:divide-slate-700",children:Fl.map(X=>l.jsxs("div",{className:"p-3 space-y-2",children:[l.jsx("div",{className:"text-xs font-semibold text-slate-700 dark:text-slate-200",children:s(`datainspector.template_${X.key}`)}),l.jsx("div",{className:"font-mono text-[10px] text-slate-400 dark:text-slate-500 truncate",children:X.sql}),l.jsxs("div",{className:"flex flex-wrap gap-1",children:[l.jsx("button",{type:"button",onClick:()=>{jn(X.sql,!1)},className:"h-7 w-7 inline-flex items-center justify-center rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:s("common.open","Open"),"aria-label":s("common.open","Open"),children:l.jsx(M1,{className:"w-3.5 h-3.5"})}),l.jsx("button",{type:"button",onClick:()=>{jn(X.sql,!0)},className:"h-7 w-7 inline-flex items-center justify-center rounded border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/30 text-blue-700 dark:text-blue-300",title:s("datainspector.run_sql"),"aria-label":s("datainspector.run_sql"),children:l.jsx(Q0,{className:"w-3.5 h-3.5"})})]})]},X.key))})]}),l.jsxs("div",{className:ue.manager?"min-h-0 flex-[1.3] flex flex-col gap-2":"flex-shrink-0",children:[l.jsxs("button",{type:"button",onClick:()=>Ki("manager"),className:"flex items-center justify-between text-left",children:[l.jsxs("span",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:[s("datainspector.sql_manager_tab","SQL Manager")," (",U.length,")"]}),l.jsx(oc,{className:`w-4 h-4 text-slate-400 dark:text-slate-500 transition-transform ${ue.manager?"rotate-180":""}`})]}),ue.manager&&l.jsxs(l.Fragment,{children:[l.jsx("input",{type:"text",value:T,onChange:X=>D(X.target.value),placeholder:s("datainspector.sql_manager_search_placeholder","Search patterns..."),className:"w-full h-9 px-3 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none focus:ring-2 focus:ring-blue-500 flex-shrink-0"}),l.jsx("div",{className:"flex-1 min-h-0 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg divide-y divide-slate-100 dark:divide-slate-700",children:qi.length===0?l.jsx("div",{className:"p-4 text-xs text-slate-400 dark:text-slate-500",children:s("datainspector.sql_manager_no_results","No matches")}):qi.map(X=>l.jsxs("div",{className:"p-3 space-y-2",children:[l.jsx("div",{className:"flex items-start justify-between gap-2",children:l.jsxs("div",{children:[l.jsxs("div",{className:"text-xs font-semibold text-slate-700 dark:text-slate-200 flex items-center gap-2",children:[X.name,Number(X.is_favorite)===1&&l.jsx(Km,{className:"w-3.5 h-3.5 text-amber-500 fill-current"})]}),l.jsx("div",{className:"font-mono text-[10px] text-slate-400 dark:text-slate-500 truncate",children:X.sql_text})]})}),l.jsxs("div",{className:"flex flex-wrap gap-1",children:[l.jsx("button",{type:"button",onClick:()=>{Jn(X,!1)},className:"h-7 w-7 inline-flex items-center justify-center rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:s("common.open","Open"),"aria-label":s("common.open","Open"),children:l.jsx(M1,{className:"w-3.5 h-3.5"})}),l.jsx("button",{type:"button",onClick:()=>{Jn(X,!0)},className:"h-7 w-7 inline-flex items-center justify-center rounded border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/30 text-blue-700 dark:text-blue-300",title:s("datainspector.run_sql"),"aria-label":s("datainspector.run_sql"),children:l.jsx(Q0,{className:"w-3.5 h-3.5"})}),l.jsx("button",{type:"button",onClick:()=>{jt.setSqlStatementFavorite(X.id,Number(X.is_favorite)!==1).then(Ps)},className:"h-7 w-7 inline-flex items-center justify-center rounded border border-amber-200 dark:border-amber-800 bg-amber-50 dark:bg-amber-900/20 hover:bg-amber-100 dark:hover:bg-amber-900/30 text-amber-700 dark:text-amber-300",title:Number(X.is_favorite)===1?s("datainspector.unpin"):s("datainspector.pin"),"aria-label":Number(X.is_favorite)===1?s("datainspector.unpin"):s("datainspector.pin"),children:l.jsx(Km,{className:`w-3.5 h-3.5 ${Number(X.is_favorite)===1?"fill-current":""}`})}),l.jsx("button",{type:"button",onClick:()=>{zA(X)},className:"px-2 py-1 text-[11px] rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:s("datainspector.rename_template"),children:l.jsx(X8,{className:"w-3 h-3"})}),l.jsx("button",{type:"button",onClick:()=>{co(X)},className:"px-2 py-1 text-[11px] rounded border border-rose-200 dark:border-rose-800 bg-rose-50 dark:bg-rose-900/20 hover:bg-rose-100 dark:hover:bg-rose-900/30 text-rose-700 dark:text-rose-300",title:s("datainspector.delete_template"),children:l.jsx(ii,{className:"w-3 h-3"})})]})]},X.id))})]})]}),l.jsxs("div",{className:ue.recent?"min-h-0 flex-[0.8] flex flex-col gap-2":"flex-shrink-0",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("button",{type:"button",onClick:()=>Ki("recent"),className:"flex items-center justify-between gap-2 text-left flex-1",children:[l.jsx("span",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:s("datainspector.recent_queries")}),l.jsx(oc,{className:`w-4 h-4 text-slate-400 dark:text-slate-500 transition-transform ${ue.recent?"rotate-180":""}`})]}),ue.recent&&l.jsx("button",{type:"button",onClick:()=>k([]),className:"text-[11px] text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200",children:s("datainspector.clear_history")})]}),ue.recent&&l.jsx("div",{className:"flex-1 min-h-0 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg divide-y divide-slate-100 dark:divide-slate-700",children:B.length===0?l.jsx("div",{className:"p-3 text-xs text-slate-400 dark:text-slate-500",children:s("common.no_data")}):B.map((X,Ee)=>l.jsx("button",{type:"button",onClick:()=>v(X),className:"w-full text-left p-3 hover:bg-slate-50 dark:hover:bg-slate-700/60",children:l.jsx("div",{className:"font-mono text-[11px] text-slate-600 dark:text-slate-300 truncate",children:X})},`${Ee}-${X.slice(0,16)}`))})]})]}):l.jsxs("div",{className:"h-full min-h-0 flex flex-col",children:[l.jsxs("div",{className:"flex-1 min-h-0 overflow-auto pr-1 space-y-3",children:[l.jsxs("div",{className:"flex items-center justify-between gap-2",children:[l.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:s("datainspector.assistant_hint","Build SQL by selecting table, columns and optional aggregation.")}),l.jsxs("button",{type:"button",onClick:cA,className:"inline-flex items-center gap-1 px-2 py-1 rounded-md border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-[11px] hover:bg-slate-50 dark:hover:bg-slate-700",children:[l.jsx(Jg,{className:"w-3 h-3"}),s("datainspector.assistant_reset","Reset")]})]}),l.jsxs("div",{className:"space-y-1 rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50/40 dark:bg-slate-900/40 px-2 py-2",children:[l.jsxs("button",{type:"button",onClick:()=>Un("table"),className:"w-full flex items-center justify-between text-left rounded-md px-1 py-1 hover:bg-slate-100/70 dark:hover:bg-slate-800/70",children:[l.jsx("span",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:s("datainspector.assistant_table","Table")}),l.jsx(oc,{className:`w-4 h-4 text-slate-400 dark:text-slate-500 transition-transform ${Ie.table?"rotate-180":""}`})]}),Ie.table&&l.jsx("select",{value:oe,onChange:X=>He(X.target.value),className:"w-full h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none focus:ring-2 focus:ring-blue-500",children:Ka.map(X=>l.jsx("option",{value:X,children:X},X))})]}),l.jsxs("div",{className:"space-y-1 rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50/40 dark:bg-slate-900/40 px-2 py-2",children:[l.jsxs("button",{type:"button",onClick:()=>Un("columns"),className:"w-full flex items-center justify-between text-left rounded-md px-1 py-1 hover:bg-slate-100/70 dark:hover:bg-slate-800/70",children:[l.jsx("span",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:s("datainspector.assistant_columns","Columns")}),l.jsx(oc,{className:`w-4 h-4 text-slate-400 dark:text-slate-500 transition-transform ${Ie.columns?"rotate-180":""}`})]}),Ie.columns&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex items-center justify-end gap-2",children:[l.jsx("button",{type:"button",onClick:()=>qe(ws),className:"text-[11px] text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200",children:s("datainspector.assistant_select_all","Select all")}),l.jsx("button",{type:"button",onClick:()=>qe([]),className:"text-[11px] text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200",children:s("datainspector.assistant_clear_all","Clear")})]}),l.jsx("input",{type:"text",value:nt,onChange:X=>Dt(X.target.value),placeholder:s("datainspector.assistant_column_search_placeholder","Search columns..."),className:"w-full h-8 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-xs text-slate-700 dark:text-slate-200 outline-none"}),l.jsxs("div",{className:"max-h-28 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg p-2 space-y-1",children:[dl.map(X=>l.jsxs("label",{className:"flex items-center gap-2 text-xs text-slate-600 dark:text-slate-300",children:[l.jsx("input",{type:"checkbox",checked:se.includes(X),onChange:()=>{qe(Ee=>Ee.includes(X)?Ee.filter(Ke=>Ke!==X):[...Ee,X])},className:"h-4 w-4 rounded border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-900 text-blue-600 dark:text-blue-400 accent-blue-600 dark:accent-blue-500 focus:ring-blue-500/50"}),l.jsx("span",{className:"font-mono",children:X})]},X)),dl.length===0&&l.jsx("p",{className:"text-[11px] text-slate-400 dark:text-slate-500 px-1 py-0.5",children:s("datainspector.sql_manager_no_results","No matches")})]})]})]}),l.jsxs("div",{className:"space-y-1 rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50/40 dark:bg-slate-900/40 px-2 py-2",children:[l.jsxs("button",{type:"button",onClick:()=>Un("aggregation"),className:"w-full flex items-center justify-between text-left rounded-md px-1 py-1 hover:bg-slate-100/70 dark:hover:bg-slate-800/70",children:[l.jsx("span",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:s("datainspector.assistant_aggregation","Aggregation")}),l.jsx(oc,{className:`w-4 h-4 text-slate-400 dark:text-slate-500 transition-transform ${Ie.aggregation?"rotate-180":""}`})]}),Ie.aggregation&&l.jsx(l.Fragment,{children:l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:s("datainspector.assistant_aggregation_function","Function")}),l.jsxs("select",{value:mt,onChange:X=>Nt(X.target.value),className:"w-full h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none",children:[l.jsx("option",{value:"none",children:s("datainspector.assistant_none","None")}),l.jsx("option",{value:"count",children:"COUNT"}),l.jsx("option",{value:"sum",children:"SUM"}),l.jsx("option",{value:"avg",children:"AVG"}),l.jsx("option",{value:"min",children:"MIN"}),l.jsx("option",{value:"max",children:"MAX"})]})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:s("datainspector.assistant_aggregation_field","Aggregation Field")}),l.jsxs("select",{value:gt,disabled:mt==="none"||mt==="count",onChange:X=>dr(X.target.value),className:"w-full h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none disabled:opacity-40",children:[l.jsx("option",{value:"",children:"-"}),ws.map(X=>l.jsx("option",{value:X,children:X},X))]})]})]})})]}),l.jsxs("div",{className:"space-y-1 rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50/40 dark:bg-slate-900/40 px-2 py-2",children:[l.jsxs("button",{type:"button",onClick:()=>Un("grouping"),disabled:!Pi,className:"w-full flex items-center justify-between text-left rounded-md px-1 py-1 hover:bg-slate-100/70 dark:hover:bg-slate-800/70 disabled:opacity-50 disabled:cursor-not-allowed",children:[l.jsx("span",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:s("datainspector.assistant_group_by","Group by")}),l.jsx(oc,{className:`w-4 h-4 text-slate-400 dark:text-slate-500 transition-transform ${Ie.grouping?"rotate-180":""}`})]}),Pi?Ie.grouping&&l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:s("datainspector.assistant_grouping_columns","Grouping Columns")}),l.jsx("div",{className:"max-h-20 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg p-2 space-y-1",children:ws.map(X=>l.jsxs("label",{className:"flex items-center gap-2 text-xs text-slate-600 dark:text-slate-300",children:[l.jsx("input",{type:"checkbox",checked:Ht.includes(X),onChange:()=>{Rt(Ee=>Ee.includes(X)?Ee.filter(Ke=>Ke!==X):[...Ee,X])},className:"h-4 w-4 rounded border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-900 text-blue-600 dark:text-blue-400 accent-blue-600 dark:accent-blue-500 focus:ring-blue-500/50"}),l.jsx("span",{className:"font-mono",children:X})]},X))})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:s("datainspector.assistant_metric_alias","Metric Alias")}),l.jsx("input",{type:"text",value:$t,onChange:X=>vr(X.target.value),className:"w-full h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none"})]})]}):l.jsx("p",{className:"text-[11px] text-slate-400 dark:text-slate-500 px-1 py-1",children:s("datainspector.assistant_grouping_requires_aggregation","Enable aggregation to configure grouping.")})]}),l.jsxs("div",{className:"space-y-1 rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50/40 dark:bg-slate-900/40 px-2 py-2",children:[l.jsxs("button",{type:"button",onClick:()=>Un("filter"),className:"w-full flex items-center justify-between text-left rounded-md px-1 py-1 hover:bg-slate-100/70 dark:hover:bg-slate-800/70",children:[l.jsx("span",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:s("datainspector.assistant_filter","Filter")}),l.jsx(oc,{className:`w-4 h-4 text-slate-400 dark:text-slate-500 transition-transform ${Ie.filter?"rotate-180":""}`})]}),Ie.filter&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"flex items-center justify-end",children:l.jsxs("button",{type:"button",onClick:oo,className:"h-7 px-2 inline-flex items-center gap-1 rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-[11px] hover:bg-slate-50 dark:hover:bg-slate-700",children:[l.jsx(eA,{className:"w-3 h-3"}),s("datainspector.assistant_add_filter","Add filter")]})}),l.jsx("div",{className:"space-y-2",children:It.map((X,Ee)=>l.jsxs("div",{className:"rounded-lg border border-slate-200 dark:border-slate-700 p-2 bg-white/60 dark:bg-slate-900/40 space-y-2",children:[l.jsxs("div",{className:"grid grid-cols-[70px_minmax(0,1fr)] gap-2",children:[Ee>0?l.jsxs("select",{value:X.connector,onChange:Ke=>_s(X.id,{connector:Ke.target.value}),className:"h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-xs text-slate-700 dark:text-slate-200 outline-none",children:[l.jsx("option",{value:"AND",children:"AND"}),l.jsx("option",{value:"OR",children:"OR"})]}):l.jsx("div",{className:"h-9 flex items-center text-[11px] font-semibold text-slate-400 dark:text-slate-500 px-1",children:"WHERE"}),l.jsxs("select",{value:X.column,onChange:Ke=>_s(X.id,{column:Ke.target.value}),className:"h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none",children:[l.jsx("option",{value:"",children:s("datainspector.assistant_sort_field","Field")}),ws.map(Ke=>l.jsx("option",{value:Ke,children:Ke},Ke))]})]}),l.jsxs("div",{className:"grid grid-cols-[110px_minmax(0,1fr)_auto] gap-2",children:[l.jsxs("select",{value:X.operator,onChange:Ke=>_s(X.id,{operator:Ke.target.value}),className:"h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none",children:[l.jsx("option",{value:"=",children:"="}),l.jsx("option",{value:"!=",children:"!="}),l.jsx("option",{value:">",children:">"}),l.jsx("option",{value:">=",children:">="}),l.jsx("option",{value:"<",children:"<"}),l.jsx("option",{value:"<=",children:"<="}),l.jsx("option",{value:"LIKE",children:"LIKE"}),l.jsx("option",{value:"NOT LIKE",children:"NOT LIKE"}),l.jsx("option",{value:"IS NULL",children:"IS NULL"}),l.jsx("option",{value:"IS NOT NULL",children:"IS NOT NULL"})]}),l.jsx("input",{type:"text",value:X.value,onChange:Ke=>_s(X.id,{value:Ke.target.value}),placeholder:s("datainspector.assistant_filter_value","Value"),disabled:X.operator==="IS NULL"||X.operator==="IS NOT NULL",className:"h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none disabled:opacity-40"}),l.jsxs("div",{className:"h-9 flex items-center gap-1",children:[l.jsx("button",{type:"button",onClick:()=>Ao(X.id,"up"),disabled:Ee===0,className:"h-9 w-7 inline-flex items-center justify-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700 disabled:opacity-40",title:s("common.move_up","Move up"),children:l.jsx(Aw,{className:"w-3.5 h-3.5"})}),l.jsx("button",{type:"button",onClick:()=>Ao(X.id,"down"),disabled:Ee===It.length-1,className:"h-9 w-7 inline-flex items-center justify-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700 disabled:opacity-40",title:s("common.move_down","Move down"),children:l.jsx(cw,{className:"w-3.5 h-3.5"})}),l.jsx("button",{type:"button",onClick:()=>Lo(X.id),className:"h-9 w-7 inline-flex items-center justify-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700",title:s("datainspector.assistant_clear_all","Clear"),children:l.jsx(Jg,{className:"w-3.5 h-3.5"})})]})]})]},X.id))}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex items-center justify-between gap-2",children:[l.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:s("datainspector.assistant_where","WHERE")}),l.jsxs("select",{value:Ge,onChange:X=>pt(X.target.value),className:"h-7 px-2 border border-slate-200 dark:border-slate-700 rounded bg-white dark:bg-slate-900 text-[11px] text-slate-700 dark:text-slate-200 outline-none",title:s("datainspector.assistant_where_connector","Join with filters"),children:[l.jsx("option",{value:"AND",children:"AND"}),l.jsx("option",{value:"OR",children:"OR"})]})]}),l.jsx("input",{type:"text",value:Ye,onChange:X=>at(X.target.value),placeholder:s("datainspector.assistant_where_placeholder","status = 'active'"),className:"w-full h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none"})]})]})]}),l.jsxs("div",{className:"space-y-1 rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50/40 dark:bg-slate-900/40 px-2 py-2",children:[l.jsxs("button",{type:"button",onClick:()=>Un("sorting"),className:"w-full flex items-center justify-between text-left rounded-md px-1 py-1 hover:bg-slate-100/70 dark:hover:bg-slate-800/70",children:[l.jsx("span",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:s("datainspector.assistant_order_by","Order by")}),l.jsx(oc,{className:`w-4 h-4 text-slate-400 dark:text-slate-500 transition-transform ${Ie.sorting?"rotate-180":""}`})]}),Ie.sorting&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"flex items-center justify-end",children:l.jsxs("button",{type:"button",onClick:KA,className:"h-7 px-2 inline-flex items-center gap-1 rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-[11px] hover:bg-slate-50 dark:hover:bg-slate-700",children:[l.jsx(eA,{className:"w-3 h-3"}),s("datainspector.assistant_add_sort","Add sort")]})}),l.jsx("div",{className:"space-y-2",children:sr.map((X,Ee)=>l.jsxs("div",{className:"grid grid-cols-[minmax(0,1fr)_110px_auto] gap-2",children:[l.jsxs("select",{value:X.column,onChange:Ke=>fl(X.id,{column:Ke.target.value}),className:"h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none",children:[l.jsx("option",{value:"",children:s("datainspector.assistant_auto","Auto")}),mt!=="none"&&l.jsx("option",{value:$t||"metric_value",children:$t||"metric_value"}),ws.map(Ke=>l.jsx("option",{value:Ke,children:Ke},Ke))]}),l.jsxs("select",{value:X.direction,onChange:Ke=>fl(X.id,{direction:Ke.target.value}),className:"h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none",children:[l.jsx("option",{value:"DESC",children:"DESC"}),l.jsx("option",{value:"ASC",children:"ASC"})]}),l.jsxs("div",{className:"h-9 flex items-center gap-1",children:[l.jsx("button",{type:"button",onClick:()=>Tl(X.id,"up"),disabled:Ee===0,className:"h-9 w-7 inline-flex items-center justify-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700 disabled:opacity-40",title:s("common.move_up","Move up"),children:l.jsx(Aw,{className:"w-3.5 h-3.5"})}),l.jsx("button",{type:"button",onClick:()=>Tl(X.id,"down"),disabled:Ee===sr.length-1,className:"h-9 w-7 inline-flex items-center justify-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700 disabled:opacity-40",title:s("common.move_down","Move down"),children:l.jsx(cw,{className:"w-3.5 h-3.5"})}),l.jsx("button",{type:"button",onClick:()=>Yn(X.id),className:"h-9 w-7 inline-flex items-center justify-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700",title:s("datainspector.assistant_clear_all","Clear"),children:l.jsx(Jg,{className:"w-3.5 h-3.5"})})]})]},X.id))}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:s("datainspector.assistant_limit","Limit")}),l.jsx("input",{type:"number",min:1,max:1e5,value:cr,onChange:X=>Vt(Number(X.target.value)),className:"w-full h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none"})]})]})]}),l.jsxs("div",{className:"space-y-1 rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50/40 dark:bg-slate-900/40 px-2 py-2",children:[l.jsxs("button",{type:"button",onClick:()=>Un("preview"),className:"w-full flex items-center justify-between text-left rounded-md px-1 py-1 hover:bg-slate-100/70 dark:hover:bg-slate-800/70",children:[l.jsx("span",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:s("datainspector.assistant_generated_sql","Generated SQL")}),l.jsx(oc,{className:`w-4 h-4 text-slate-400 dark:text-slate-500 transition-transform ${Ie.preview?"rotate-180":""}`})]}),Ie.preview&&l.jsx("textarea",{readOnly:!0,value:uA,className:"w-full h-32 p-2 font-mono text-xs border border-slate-200 dark:border-slate-700 rounded-lg bg-slate-50 dark:bg-slate-900 text-slate-700 dark:text-slate-200"})]})]}),l.jsx("div",{className:"mt-3 -mx-5 -mb-5 px-5 py-3 border-t border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-950/90",children:l.jsxs("div",{className:"flex flex-wrap justify-center gap-2",children:[l.jsx("button",{type:"button",onClick:()=>{hi("replace")},className:"px-3 py-1.5 rounded-md border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-xs hover:bg-slate-50 dark:hover:bg-slate-700",children:s("datainspector.assistant_replace_editor","Replace Editor")}),l.jsx("button",{type:"button",onClick:()=>{hi("run")},className:"px-3 py-1.5 rounded-md border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 text-xs hover:bg-blue-100 dark:hover:bg-blue-900/30",children:s("datainspector.run_sql")})]})})]})]})},footer:ul,breadcrumbs:[{label:Cl}],fillHeight:!0,children:[l.jsx("div",{className:"fixed top-0 left-0 w-full h-[3px] bg-blue-100 dark:bg-blue-900/30 z-[100] overflow-hidden",children:Ni&&l.jsx("div",{className:"h-full bg-blue-600 dark:bg-blue-400 animate-pulse",style:{width:"40%"}})}),x==="table"?l.jsx("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm flex-shrink-0",children:l.jsx("div",{className:"grid grid-cols-1 gap-3",children:l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[minmax(220px,320px)_minmax(280px,1fr)_auto] gap-3",children:[l.jsxs("div",{className:"relative min-w-0",children:[l.jsx("select",{value:st,onChange:X=>{Hr(X.target.value),St(""),io(null),Bl({}),Wn(!1),fn(""),Ia(1)},className:"w-full h-10 appearance-none pl-10 pr-10 border border-slate-200 dark:border-slate-700 rounded-lg bg-slate-50 dark:bg-slate-900 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 cursor-pointer text-sm font-medium",children:Sl?.map(X=>l.jsx("option",{value:X.name,children:X.type==="view"?`${X.name} (view)`:X.name},X.name))}),l.jsx(wl,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none"}),l.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 w-2 h-2 border-r-2 border-b-2 border-slate-400 rotate-45 pointer-events-none"})]}),l.jsxs("div",{className:"relative min-w-0",children:[l.jsx("input",{type:"text",placeholder:s("datainspector.search_placeholder"),value:it,onChange:X=>{St(X.target.value),Ia(1)},className:"w-full h-10 pl-10 pr-4 border border-slate-200 dark:border-slate-700 rounded-lg bg-slate-50 dark:bg-slate-900 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),l.jsx(Zo,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"})]}),l.jsxs("button",{onClick:()=>js(),className:"h-10 px-3 flex items-center justify-center gap-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300 text-sm font-medium",title:s("datainspector.refresh_title"),children:[l.jsx(Zc,{className:`w-4 h-4 ${Ni?"animate-spin":""}`}),l.jsx("span",{children:s("common.refresh","Refresh")})]})]})})}):l.jsxs("div",{className:"flex flex-col gap-2 bg-white dark:bg-slate-800 p-4 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm ring-1 ring-slate-900/5 flex-shrink-0",children:[l.jsxs("div",{className:"relative",children:[l.jsx("textarea",{ref:Ut,value:w,onChange:X=>{v(X.target.value),Zt("explain"),Gr(X.target.selectionStart??X.target.value.length)},onClick:X=>Gr(X.currentTarget.selectionStart??0),onKeyUp:X=>Gr(X.currentTarget.selectionStart??0),onSelect:X=>Gr(X.currentTarget.selectionStart??0),onScroll:()=>{P&&Qr&&Zn()},onKeyDown:fA,placeholder:s("datainspector.sql_placeholder"),className:"w-full p-4 font-mono text-sm bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none text-slate-800 dark:text-slate-200 min-h-[120px] max-h-[520px]",style:{height:`${Ct}px`}}),P&&Qr&&Ds.length>0&&l.jsx("div",{className:"absolute z-20 border border-slate-200 dark:border-slate-700 rounded-lg bg-white/95 dark:bg-slate-900/95 backdrop-blur shadow-lg max-h-40 overflow-auto",style:{top:Vn.top,left:Vn.left,width:Vn.width},children:Ds.slice(0,10).map((X,Ee)=>l.jsxs("button",{type:"button",onClick:()=>Vi(X),className:`w-full text-left px-3 py-1.5 text-xs font-mono border-b last:border-b-0 border-slate-100 dark:border-slate-800 transition-colors ${Ee===fs?"bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300":"hover:bg-slate-50 dark:hover:bg-slate-800 text-slate-700 dark:text-slate-300"}`,children:[l.jsx("span",{className:"font-bold",children:X.label}),l.jsx("span",{className:"ml-2 hidden sm:inline text-[10px] uppercase tracking-wide text-slate-400",children:X.type})]},`${X.type}-${X.label}`))}),l.jsxs("div",{className:"absolute bottom-4 right-4 flex gap-2",children:[l.jsx("button",{onClick:()=>v(""),className:"px-3 py-1 text-xs text-slate-500 hover:text-slate-700 dark:hover:text-slate-300",children:s("datainspector.clear_sql")}),l.jsxs("button",{onClick:()=>{du()},className:"flex items-center gap-2 px-4 py-1.5 bg-blue-600 hover:bg-blue-700 text-white rounded-md text-sm font-medium shadow-sm transition-colors",children:[Ni?l.jsx(Zc,{className:"w-3 h-3 animate-spin"}):l.jsx(Q0,{className:"w-3 h-3 fill-current"}),s("datainspector.run_sql")]}),Ni&&l.jsx("button",{onClick:()=>{N()},className:"px-3 py-1.5 rounded-md text-sm font-medium border bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 text-slate-500 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700",children:s("datainspector.stop_sql","Stop")}),l.jsx("button",{onClick:()=>R(!P),className:`px-3 py-1.5 rounded-md text-sm font-medium border transition-colors ${P?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800 text-blue-700 dark:text-blue-300":"bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 text-slate-500 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700"}`,title:s("datainspector.autocomplete_toggle_title","Toggle SQL autocomplete"),children:P?s("datainspector.autocomplete_on","Autocomplete on"):s("datainspector.autocomplete_off","Autocomplete off")}),l.jsx("button",{onClick:()=>L(!0),className:"h-9 w-9 flex items-center justify-center rounded-md border bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 text-slate-500 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700",title:s("datainspector.sql_assist","SQL Workspace"),"aria-label":s("datainspector.sql_assist","SQL Workspace"),children:l.jsx(M1,{className:"w-4 h-4"})}),l.jsxs("button",{onClick:Qe,className:"flex items-center gap-1 px-3 py-1.5 rounded-md text-sm font-medium border bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 text-slate-500 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700",title:s("common.save","Save"),children:[l.jsx(B2,{className:"w-3.5 h-3.5"}),s("common.save","Save")]}),l.jsxs("button",{onClick:()=>{Se(w)},className:`flex items-center gap-1 px-3 py-1.5 rounded-md text-sm font-medium border transition-colors ${jo?"bg-amber-50 dark:bg-amber-900/20 border-amber-200 dark:border-amber-800 text-amber-700 dark:text-amber-300":"bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 text-slate-500 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700"}`,title:s(jo?"datainspector.unpin_query":"datainspector.pin_query"),children:[l.jsx(Km,{className:`w-3.5 h-3.5 ${jo?"fill-current":""}`}),s(jo?"datainspector.unpin":"datainspector.pin")]})]})]}),Et&&l.jsx("div",{className:"mt-2 px-3 py-2 text-xs rounded-md border border-amber-200 dark:border-amber-800/60 bg-amber-50 dark:bg-amber-900/20 text-amber-800 dark:text-amber-200",children:Et}),l.jsxs("div",{className:"px-3 py-2 text-[11px] rounded-md border border-slate-200 dark:border-slate-700 bg-slate-50/70 dark:bg-slate-900/40 text-slate-500 dark:text-slate-400",children:[s("datainspector.sql_assist","SQL Workspace"),":"," ",Fl.length," ",s("datainspector.templates")," ","|"," ",Uo," ",s("datainspector.favorite_queries")," ","|"," ",U.length," ",s("datainspector.custom_templates")]})]}),x==="sql"&&l.jsx("div",{onMouseDown:Gi,className:`h-3 -mt-2 -mb-1 flex items-center justify-center cursor-row-resize ${RA?"opacity-100":"opacity-70 hover:opacity-100"}`,title:s("datainspector.resize_sql_split","Resize SQL and results panes"),children:l.jsx("div",{className:"h-1 w-12 rounded-full bg-slate-300 dark:bg-slate-600"})}),l.jsxs("div",{className:"flex-1 bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 shadow-sm overflow-hidden flex flex-col min-h-0 relative",children:[Ni&&ma&&ma.length>0&&!(x==="sql"&&Ft==="explain")&&l.jsx("div",{className:"absolute inset-0 bg-white/40 dark:bg-slate-800/40 z-10 flex items-center justify-center backdrop-blur-[1px]",children:l.jsx("div",{className:"bg-white dark:bg-slate-900 p-4 rounded-full shadow-xl border border-slate-100 dark:border-slate-700",children:l.jsx(Zc,{className:"w-8 h-8 text-blue-600 dark:text-blue-400 animate-spin"})})}),x==="sql"&&l.jsxs("div",{className:"px-4 py-2 border-b border-slate-100 dark:border-slate-700 bg-slate-50/60 dark:bg-slate-900/30 flex items-center justify-between gap-3",children:[l.jsxs("div",{className:"inline-flex items-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 p-1",children:[l.jsx("button",{onClick:()=>Zt("result"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${Ft==="result"?"bg-blue-600 text-white":"text-slate-500 hover:text-slate-700 dark:text-slate-300 dark:hover:text-slate-100"}`,children:s("datainspector.output_results","Results")}),l.jsx("button",{onClick:()=>{Zt("explain")},className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${Ft==="explain"?"bg-indigo-600 text-white":"text-slate-500 hover:text-slate-700 dark:text-slate-300 dark:hover:text-slate-100"}`,children:s("datainspector.output_explain","Explain")})]}),l.jsx("span",{className:"text-[11px] text-slate-400",children:s("datainspector.explain_hint")})]}),x==="table"&&l.jsxs("div",{className:"px-4 py-2 border-b border-slate-100 dark:border-slate-700 bg-slate-50/60 dark:bg-slate-900/30 flex items-center justify-between gap-3",children:[l.jsxs("div",{className:"inline-flex items-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 p-1",children:[l.jsx("button",{onClick:()=>No("data"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${Ys==="data"?"bg-blue-600 text-white":"text-slate-500 hover:text-slate-700 dark:text-slate-300 dark:hover:text-slate-100"}`,children:s("datainspector.result_tab_data","Data")}),l.jsx("button",{onClick:()=>No("profiling"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${Ys==="profiling"?"bg-indigo-600 text-white":"text-slate-500 hover:text-slate-700 dark:text-slate-300 dark:hover:text-slate-100"}`,children:s("datainspector.result_tab_profile","Profiling")})]}),l.jsx("span",{className:"text-[11px] text-slate-400",children:Ys==="profiling"?s("datainspector.profiling_issues",{count:Dn}):s("datainspector.auto_limit",{limit:Na})})]}),x==="table"&&Ys==="profiling"&&l.jsxs("div",{className:"px-4 py-2 border-b border-slate-100 dark:border-slate-700 bg-white dark:bg-slate-800 flex items-center justify-between gap-3 text-[11px]",children:[l.jsx("div",{className:"font-semibold uppercase tracking-wider text-slate-500",children:s("datainspector.profiling_settings","Profiling Settings")}),l.jsxs("div",{className:"flex items-center gap-2 text-slate-500 dark:text-slate-400",children:[l.jsxs("label",{className:"flex items-center gap-1",children:[l.jsx("span",{children:s("datainspector.null_threshold")}),l.jsx("input",{type:"number",min:0,max:100,value:di.nullRate,onChange:X=>{const Ee=Number(X.target.value);Number.isNaN(Ee)||Sr({...di,nullRate:Math.max(0,Math.min(100,Ee))})},className:"w-14 px-1.5 py-0.5 border border-slate-200 dark:border-slate-700 rounded bg-white dark:bg-slate-900 text-slate-700 dark:text-slate-200"}),l.jsx("span",{children:"%"})]}),l.jsxs("label",{className:"flex items-center gap-1",children:[l.jsx("span",{children:s("datainspector.cardinality_threshold")}),l.jsx("input",{type:"number",min:0,max:100,value:di.cardinalityRate,onChange:X=>{const Ee=Number(X.target.value);Number.isNaN(Ee)||Sr({...di,cardinalityRate:Math.max(0,Math.min(100,Ee))})},className:"w-14 px-1.5 py-0.5 border border-slate-200 dark:border-slate-700 rounded bg-white dark:bg-slate-900 text-slate-700 dark:text-slate-200"}),l.jsx("span",{children:"%"})]}),l.jsx("button",{onClick:()=>Sr({nullRate:30,cardinalityRate:95}),className:"px-2 py-0.5 rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-500 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-700",children:s("datainspector.reset_thresholds")})]})]}),x==="table"&&Ys==="data"&&l.jsxs("div",{className:"px-4 py-2 border-b border-slate-100 dark:border-slate-700 bg-white dark:bg-slate-800 flex items-center justify-between gap-3 text-[11px]",children:[l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx("button",{onClick:()=>zs("columns"),className:"h-7 w-7 inline-flex items-center justify-center rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:s("datainspector.table_tools_tab_columns","Columns"),"aria-label":s("datainspector.table_tools_tab_columns","Columns"),children:l.jsx(GS,{className:"w-3.5 h-3.5"})}),l.jsx("button",{onClick:()=>zs("filters"),className:"h-7 w-7 inline-flex items-center justify-center rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:s("datainspector.table_tools_tab_filters","Filters"),"aria-label":s("datainspector.table_tools_tab_filters","Filters"),children:l.jsx(Jh,{className:"w-3.5 h-3.5"})}),l.jsx("button",{onClick:()=>zs("actions"),className:"h-7 w-7 inline-flex items-center justify-center rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:s("datainspector.table_tools_tab_actions","Actions"),"aria-label":s("datainspector.table_tools_tab_actions","Actions"),children:l.jsx(nf,{className:"w-3.5 h-3.5"})}),l.jsxs("button",{onClick:pr,disabled:qs!=="table",className:"h-7 px-2 text-[11px] rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300 disabled:opacity-40 flex items-center gap-1",title:qs!=="table"?s("datasource.view_type","VIEW"):s("datasource.create_index_title","Create index"),children:[l.jsx(WS,{className:"w-3.5 h-3.5"}),s("datasource.create_index_btn","Create index")]})]}),l.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[l.jsx("span",{className:"text-slate-500 dark:text-slate-400 font-semibold uppercase tracking-wider",children:s("datainspector.saved_views","Saved Views")}),l.jsxs("select",{value:Ri,onChange:X=>{const Ee=X.target.value;if(fn(Ee),!Ee)return;const Ke=lA.find(ft=>ft.id===Ee);Ke&&ze(Ke)},className:"h-7 px-2 border border-slate-200 dark:border-slate-700 rounded bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-[11px] outline-none min-w-[180px]",children:[l.jsx("option",{value:"",children:s("datainspector.select_view")}),lA.map(X=>l.jsx("option",{value:X.id,children:X.name},X.id))]}),l.jsx("button",{onClick:ct,className:"h-7 px-2 text-[11px] rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",children:s(Ri?"datainspector.update_view":"datainspector.save_view")}),l.jsx("button",{onClick:wt,disabled:!Ri,className:"h-7 px-2 text-[11px] rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-500 dark:text-slate-300 disabled:opacity-40",children:s("datainspector.delete_view")})]})]}),l.jsx("div",{className:"flex-1 overflow-hidden flex flex-col relative min-h-0",children:x==="sql"&&Ft==="explain"?Xt?l.jsxs("div",{className:"flex-1 flex items-center justify-center p-6 text-xs text-slate-400 gap-2",children:[l.jsx(Zc,{className:"w-3.5 h-3.5 animate-spin"}),s("common.loading")]}):tr?l.jsx("div",{className:"flex-1 p-4 text-xs text-rose-600",children:tr}):vt.length===0?l.jsx("div",{className:"flex-1 p-4 text-xs text-slate-400",children:s("datainspector.explain_empty")}):l.jsx("div",{className:"flex-1 overflow-auto custom-scrollbar",children:l.jsxs("table",{className:"w-full text-xs min-w-[520px]",children:[l.jsx("thead",{className:"sticky top-0 bg-slate-50 dark:bg-slate-900 text-slate-400 uppercase text-[10px] z-[1]",children:l.jsx("tr",{children:Object.keys(vt[0]).map(X=>l.jsx("th",{className:"text-left px-2 py-1.5",children:X},X))})}),l.jsx("tbody",{children:vt.map((X,Ee)=>l.jsx("tr",{className:"border-t border-slate-100 dark:border-slate-700",children:Object.keys(vt[0]).map(Ke=>l.jsx("td",{className:"px-2 py-1.5 text-slate-600 dark:text-slate-300",children:String(X[Ke]??"")},Ke))},Ee))})]})}):x==="table"&&Ys==="profiling"?pi.length===0?l.jsx("div",{className:"flex-1 p-4 text-xs text-slate-400",children:s("datainspector.no_profile")}):l.jsx("div",{className:"flex-1 overflow-auto custom-scrollbar",children:l.jsxs("table",{className:"w-full text-xs min-w-[760px]",children:[l.jsx("thead",{className:"text-slate-400 uppercase text-[10px] sticky top-0 bg-slate-50 dark:bg-slate-900 z-[1]",children:l.jsxs("tr",{children:[l.jsx("th",{className:"text-left py-1.5 px-2",children:s("querybuilder.value")}),l.jsx("th",{className:"text-left py-1.5 px-2",children:s("datainspector.type")}),l.jsx("th",{className:"text-left py-1.5 px-2",children:s("datainspector.distinct_values")}),l.jsx("th",{className:"text-left py-1.5 px-2",children:s("datainspector.null_rate")}),l.jsx("th",{className:"text-left py-1.5 px-2",children:s("datainspector.min")}),l.jsx("th",{className:"text-left py-1.5 px-2",children:s("datainspector.max")}),l.jsx("th",{className:"text-left py-1.5 px-2",children:s("datainspector.top_values")}),l.jsx("th",{className:"text-left py-1.5 px-2",children:s("datainspector.patterns")}),l.jsx("th",{className:"text-left py-1.5 px-2",children:s("datainspector.suspicious_values")}),l.jsx("th",{className:"text-left py-1.5 px-2",children:s("datainspector.issues")})]})}),l.jsx("tbody",{children:pi.map(X=>l.jsxs("tr",{className:"border-t border-slate-100 dark:border-slate-700",children:[l.jsx("td",{className:"py-1.5 px-2 font-semibold text-slate-700 dark:text-slate-200",children:X.key}),l.jsx("td",{className:"py-1.5 px-2 text-slate-600 dark:text-slate-300",children:s(`datainspector.type_${X.detectedType}`)}),l.jsx("td",{className:"py-1.5 px-2 text-slate-600 dark:text-slate-300",children:X.distinctCount}),l.jsxs("td",{className:"py-1.5 px-2 text-slate-600 dark:text-slate-300",children:[X.nullRate.toFixed(1),"%"]}),l.jsx("td",{className:"py-1.5 px-2 text-slate-600 dark:text-slate-300",children:X.min??"-"}),l.jsx("td",{className:"py-1.5 px-2 text-slate-600 dark:text-slate-300",children:X.max??"-"}),l.jsx("td",{className:"py-1.5 px-2 text-slate-600 dark:text-slate-300 truncate max-w-[260px]",title:X.topValues.map(Ee=>`${Ee[0]} (${Ee[1]})`).join(", "),children:X.topValues.length>0?X.topValues.map(Ee=>`${Ee[0]} (${Ee[1]})`).join(", "):"-"}),l.jsx("td",{className:"py-1.5 px-2",children:X.patterns.length>0?l.jsx("div",{className:"flex flex-wrap gap-1",children:X.patterns.map(Ee=>l.jsx("span",{className:"px-1.5 py-0.5 rounded bg-indigo-50 text-indigo-700 border border-indigo-200 text-[10px] font-semibold",children:s(`datainspector.pattern_${Ee}`)},Ee))}):l.jsx("span",{className:"text-slate-400",children:"-"})}),l.jsx("td",{className:"py-1.5 px-2 text-slate-600 dark:text-slate-300",children:X.suspiciousCount}),l.jsx("td",{className:"py-1.5 px-2",children:X.issues.length>0?l.jsx("div",{className:"flex flex-wrap gap-1",children:X.issues.map(Ee=>l.jsx("span",{className:"px-1.5 py-0.5 rounded bg-amber-50 text-amber-700 border border-amber-200 text-[10px] font-semibold",children:s(`datainspector.issue_${Ee}`)},Ee))}):l.jsx("span",{className:"text-slate-400",children:"-"})})]},X.key))})]})}):Ni&&!ma?l.jsx("div",{className:"flex-1 flex items-center justify-center p-12 text-center text-slate-400 animate-pulse",children:l.jsxs("div",{className:"flex flex-col items-center gap-4",children:[l.jsx(Zo,{className:"w-12 h-12 opacity-20"}),l.jsx("p",{className:"text-lg",children:s("common.loading")})]})}):l.jsx(Tx,{data:ma||[],columns:Us,searchTerm:"",emptyMessage:s(x==="sql"&&!w?"datainspector.empty_sql":"common.no_data"),onRowClick:X=>wa(X),sortConfig:x==="table"?Ln:void 0,onSortConfigChange:x==="table"?io:void 0,filters:x==="table"?Ls:void 0,onFiltersChange:x==="table"?Bl:void 0,showFilters:x==="table"?Si:void 0,onShowFiltersChange:x==="table"?Wn:void 0,columnWidths:x==="table"?Mi:void 0,onColumnWidthsChange:x==="table"?lo:void 0})}),l.jsxs("div",{className:"px-4 py-2 border-t border-slate-100 dark:border-slate-700 text-[10px] flex justify-between items-center text-slate-400 bg-slate-50/50 dark:bg-slate-900/50",children:[l.jsx("div",{className:"font-medium",children:x==="table"?Ys==="profiling"?s("datainspector.result_tab_profile","Profiling"):l.jsx("select",{value:String(Na),onChange:X=>{Gn(Number(X.target.value)),Ia(1)},className:"h-7 px-2 border border-slate-200 dark:border-slate-700 rounded bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-[10px] outline-none",title:s("datainspector.page_size"),children:[50,100,250,500].map(X=>l.jsx("option",{value:X,children:s("datainspector.page_size_value",{size:X})},X))}):Ft==="explain"?s("datainspector.output_explain","Explain"):s("datainspector.sql_mode")}),l.jsxs("div",{className:"flex items-center gap-4",children:[x==="table"&&Ys==="data"&&l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx("button",{onClick:()=>Ia(X=>Math.max(1,X-1)),disabled:Lr<=1,className:"px-2 py-1 rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-500 dark:text-slate-300 disabled:opacity-40",children:s("datainspector.prev_page")}),l.jsx("span",{className:"text-[10px] font-semibold text-slate-500 dark:text-slate-300",children:s("datainspector.page_info",{page:Lr,pages:Fo,total:Eo||0})}),l.jsx("button",{onClick:()=>Ia(X=>X+1),disabled:Lr>=Fo,className:"px-2 py-1 rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-500 dark:text-slate-300 disabled:opacity-40",children:s("datainspector.next_page")}),l.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[l.jsx("input",{type:"number",min:1,max:Fo,value:hs,onChange:X=>ls(X.target.value),placeholder:s("datainspector.page_number_placeholder"),className:"w-16 px-2 py-1 rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-[10px] outline-none"}),l.jsx("button",{onClick:()=>{const X=Number(hs);if(Number.isNaN(X))return;const Ee=Math.max(1,Math.min(Fo,Math.floor(X)));Ia(Ee),ls("")},className:"px-2 py-1 rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-500 dark:text-slate-300 text-[10px]",children:s("datainspector.go")})]})]}),l.jsxs("span",{className:"flex items-center gap-1",children:[l.jsx(wl,{className:"w-3 h-3"})," LiteBI Studio DB"]}),l.jsx("span",{className:"font-medium",children:s("common.results_count",{count:x==="sql"&&Ft==="explain"?vt.length:x==="table"&&Ys==="profiling"?pi.length:ma?.length||0})})]})]})]}),l.jsx(cb,{isOpen:!!yr,onClose:()=>wa(null),items:ma||[],initialIndex:ma&&yr?Math.max(0,ma.indexOf(yr)):0,title:s("common.details"),tableName:st,schema:void 0}),l.jsx(Bo,{isOpen:Bt,onClose:()=>{be||Yt(!1)},title:s("datasource.create_index_title","Create index"),children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"text-xs text-slate-500",children:[s("datasource.index_create_for_table","Table"),": ",l.jsx("span",{className:"font-mono font-semibold text-slate-700",children:st})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:s("datasource.index_name","Index name")}),l.jsx("input",{type:"text",value:Mr,onChange:X=>Jr(X.target.value),className:"w-full p-2 border border-slate-200 rounded-lg bg-white outline-none focus:ring-2 focus:ring-blue-500 text-sm",placeholder:`idx_${st}_...`})]}),l.jsxs("label",{className:"flex items-center gap-2 text-sm text-slate-600",children:[l.jsx("input",{type:"checkbox",checked:Cr,onChange:()=>re(!Cr),className:"h-4 w-4"}),s("datasource.index_unique","Unique index")]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase",children:s("datasource.index_columns","Columns")}),l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-40 overflow-auto border border-slate-200 rounded p-2 bg-slate-50",children:(vs||[]).map(X=>l.jsxs("label",{className:"flex items-center gap-2 text-sm text-slate-700",children:[l.jsx("input",{type:"checkbox",checked:jr.includes(X.name),onChange:()=>Ur(X.name),className:"h-4 w-4"}),l.jsx("span",{className:"font-mono",children:X.name})]},X.name))})]}),jr.length>0&&l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase",children:s("datasource.index_order","Column order")}),l.jsx("div",{className:"space-y-1 border border-slate-200 rounded p-2 bg-white",children:jr.map((X,Ee)=>l.jsxs("div",{className:"flex items-center justify-between text-sm",children:[l.jsxs("span",{className:"font-mono text-slate-700",children:[Ee+1,". ",X]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("button",{type:"button",onClick:()=>Wr(X,"up"),disabled:Ee===0,className:"px-2 py-0.5 text-xs border border-slate-200 rounded disabled:opacity-40",children:""}),l.jsx("button",{type:"button",onClick:()=>Wr(X,"down"),disabled:Ee===jr.length-1,className:"px-2 py-0.5 text-xs border border-slate-200 rounded disabled:opacity-40",children:""})]})]},X))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:s("datasource.index_where_optional","WHERE (optional)")}),l.jsx("input",{type:"text",value:ke,onChange:X=>me(X.target.value),className:"w-full p-2 border border-slate-200 rounded-lg bg-white outline-none focus:ring-2 focus:ring-blue-500 text-sm font-mono",placeholder:"status = 'open'"})]}),l.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2",children:[l.jsx("button",{onClick:()=>Yt(!1),disabled:be,className:"px-3 py-1.5 rounded border border-slate-200 text-slate-600 text-sm hover:bg-slate-50 disabled:opacity-40",children:s("common.cancel","Cancel")}),l.jsx("button",{onClick:()=>{da()},disabled:be,className:"px-4 py-1.5 rounded bg-indigo-600 text-white text-sm font-semibold hover:bg-indigo-700 disabled:opacity-40",children:be?s("common.saving","Saving..."):s("datasource.create_index_btn","Create index")})]})]})}),Nl&&l.jsxs("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 bg-red-100 dark:bg-red-900/50 border border-red-200 dark:border-red-800 text-red-700 dark:text-red-200 px-4 py-3 rounded-lg shadow-lg flex items-center gap-3 animate-in slide-in-from-bottom-2 fade-in",children:[l.jsx(Cn,{className:"w-5 h-5 shrink-0"}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("p",{className:"text-sm font-bold",children:s("datainspector.sql_error")}),l.jsx("p",{className:"text-xs opacity-90",children:String(Nl)})]}),l.jsx("button",{onClick:js,className:"ml-auto p-1.5 hover:bg-red-200 dark:hover:bg-red-800 rounded-md transition-colors",children:l.jsx(Zc,{className:"w-4 h-4"})})]})]})};var Uw=function(e,t){return Uw=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(r[s]=a[s])},Uw(e,t)};function DA(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Uw(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Dw=function(){return Dw=Object.assign||function(t){for(var r,a=1,s=arguments.length;a<s;a++){r=arguments[a];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Dw.apply(this,arguments)};function ml(e,t,r,a){function s(n){return n instanceof r?n:new r(function(o){o(n)})}return new(r||(r=Promise))(function(n,o){function c(h){try{f(a.next(h))}catch(g){o(g)}}function u(h){try{f(a.throw(h))}catch(g){o(g)}}function f(h){h.done?n(h.value):s(h.value).then(c,u)}f((a=a.apply(e,[])).next())})}function tl(e,t){var r={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},a,s,n,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(f){return function(h){return u([f,h])}}function u(f){if(a)throw new TypeError("Generator is already executing.");for(;r;)try{if(a=1,s&&(n=f[0]&2?s.return:f[0]?s.throw||((n=s.return)&&n.call(s),0):s.next)&&!(n=n.call(s,f[1])).done)return n;switch(s=0,n&&(f=[f[0]&2,n.value]),f[0]){case 0:case 1:n=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,s=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(n=r.trys,!(n=n.length>0&&n[n.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!n||f[1]>n[0]&&f[1]<n[3])){r.label=f[1];break}if(f[0]===6&&r.label<n[1]){r.label=n[1],n=f;break}if(n&&r.label<n[2]){r.label=n[2],r.ops.push(f);break}n[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(h){f=[6,h],s=0}finally{a=n=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function dm(e,t,r){if(arguments.length===2)for(var a=0,s=t.length,n;a<s;a++)(n||!(a in t))&&(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||t)}var ou=(function(){function e(t,r,a,s){this.left=t,this.top=r,this.width=a,this.height=s}return e.prototype.add=function(t,r,a,s){return new e(this.left+t,this.top+r,this.width+a,this.height+s)},e.fromClientRect=function(t,r){return new e(r.left+t.windowBounds.left,r.top+t.windowBounds.top,r.width,r.height)},e.fromDOMRectList=function(t,r){var a=Array.from(r).find(function(s){return s.width!==0});return a?new e(a.left+t.windowBounds.left,a.top+t.windowBounds.top,a.width,a.height):e.EMPTY},e.EMPTY=new e(0,0,0,0),e})(),ub=function(e,t){return ou.fromClientRect(e,t.getBoundingClientRect())},oG=function(e){var t=e.body,r=e.documentElement;if(!t||!r)throw new Error("Unable to get document size");var a=Math.max(Math.max(t.scrollWidth,r.scrollWidth),Math.max(t.offsetWidth,r.offsetWidth),Math.max(t.clientWidth,r.clientWidth)),s=Math.max(Math.max(t.scrollHeight,r.scrollHeight),Math.max(t.offsetHeight,r.offsetHeight),Math.max(t.clientHeight,r.clientHeight));return new ou(0,0,a,s)},db=function(e){for(var t=[],r=0,a=e.length;r<a;){var s=e.charCodeAt(r++);if(s>=55296&&s<=56319&&r<a){var n=e.charCodeAt(r++);(n&64512)===56320?t.push(((s&1023)<<10)+(n&1023)+65536):(t.push(s),r--)}else t.push(s)}return t},_n=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var a=[],s=-1,n="";++s<r;){var o=e[s];o<=65535?a.push(o):(o-=65536,a.push((o>>10)+55296,o%1024+56320)),(s+1===r||a.length>16384)&&(n+=String.fromCharCode.apply(String,a),a.length=0)}return n},uB="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",AG=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var fm=0;fm<uB.length;fm++)AG[uB.charCodeAt(fm)]=fm;var dB="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",zh=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var hm=0;hm<dB.length;hm++)zh[dB.charCodeAt(hm)]=hm;var cG=function(e){var t=e.length*.75,r=e.length,a,s=0,n,o,c,u;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var f=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),h=Array.isArray(f)?f:new Uint8Array(f);for(a=0;a<r;a+=4)n=zh[e.charCodeAt(a)],o=zh[e.charCodeAt(a+1)],c=zh[e.charCodeAt(a+2)],u=zh[e.charCodeAt(a+3)],h[s++]=n<<2|o>>4,h[s++]=(o&15)<<4|c>>2,h[s++]=(c&3)<<6|u&63;return f},uG=function(e){for(var t=e.length,r=[],a=0;a<t;a+=2)r.push(e[a+1]<<8|e[a]);return r},dG=function(e){for(var t=e.length,r=[],a=0;a<t;a+=4)r.push(e[a+3]<<24|e[a+2]<<16|e[a+1]<<8|e[a]);return r},V0=5,y_=11,pv=2,fG=y_-V0,iF=65536>>V0,hG=1<<V0,gv=hG-1,pG=1024>>V0,gG=iF+pG,mG=gG,xG=32,bG=mG+xG,vG=65536>>y_,wG=1<<fG,_G=wG-1,fB=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},yG=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},kG=function(e,t){var r=cG(e),a=Array.isArray(r)?dG(r):new Uint32Array(r),s=Array.isArray(r)?uG(r):new Uint16Array(r),n=24,o=fB(s,n/2,a[4]/2),c=a[5]===2?fB(s,(n+a[4])/2):yG(a,Math.ceil((n+a[4])/4));return new BG(a[0],a[1],a[2],a[3],o,c)},BG=(function(){function e(t,r,a,s,n,o){this.initialValue=t,this.errorValue=r,this.highStart=a,this.highValueIndex=s,this.index=n,this.data=o}return e.prototype.get=function(t){var r;if(t>=0){if(t<55296||t>56319&&t<=65535)return r=this.index[t>>V0],r=(r<<pv)+(t&gv),this.data[r];if(t<=65535)return r=this.index[iF+(t-55296>>V0)],r=(r<<pv)+(t&gv),this.data[r];if(t<this.highStart)return r=bG-vG+(t>>y_),r=this.index[r],r+=t>>V0&_G,r=this.index[r],r=(r<<pv)+(t&gv),this.data[r];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e})(),hB="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",CG=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var pm=0;pm<hB.length;pm++)CG[hB.charCodeAt(pm)]=pm;var SG="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",pB=50,NG=1,lF=2,oF=3,EG=4,FG=5,gB=7,AF=8,mB=9,Yu=10,Iw=11,xB=12,Qw=13,TG=14,Vh=15,Ow=16,gm=17,Dh=18,LG=19,bB=20,Rw=21,Ih=22,mv=23,Wd=24,xo=25,Gh=26,Wh=27,$d=28,jG=29,U0=30,UG=31,mm=32,xm=33,Mw=34,Hw=35,Pw=36,Rp=37,qw=38,Wm=39,$m=40,xv=41,cF=42,DG=43,IG=[9001,65288],uF="!",va="",bm="",Kw=kG(SG),$c=[U0,Pw],zw=[NG,lF,oF,FG],dF=[Yu,AF],vB=[Wh,Gh],QG=zw.concat(dF),wB=[qw,Wm,$m,Mw,Hw],OG=[Vh,Qw],RG=function(e,t){t===void 0&&(t="strict");var r=[],a=[],s=[];return e.forEach(function(n,o){var c=Kw.get(n);if(c>pB?(s.push(!0),c-=pB):s.push(!1),["normal","auto","loose"].indexOf(t)!==-1&&[8208,8211,12316,12448].indexOf(n)!==-1)return a.push(o),r.push(Ow);if(c===EG||c===Iw){if(o===0)return a.push(o),r.push(U0);var u=r[o-1];return QG.indexOf(u)===-1?(a.push(a[o-1]),r.push(u)):(a.push(o),r.push(U0))}if(a.push(o),c===UG)return r.push(t==="strict"?Rw:Rp);if(c===cF||c===jG)return r.push(U0);if(c===DG)return n>=131072&&n<=196605||n>=196608&&n<=262141?r.push(Rp):r.push(U0);r.push(c)}),[a,r,s]},bv=function(e,t,r,a){var s=a[r];if(Array.isArray(e)?e.indexOf(s)!==-1:e===s)for(var n=r;n<=a.length;){n++;var o=a[n];if(o===t)return!0;if(o!==Yu)break}if(s===Yu)for(var n=r;n>0;){n--;var c=a[n];if(Array.isArray(e)?e.indexOf(c)!==-1:e===c)for(var u=r;u<=a.length;){u++;var o=a[u];if(o===t)return!0;if(o!==Yu)break}if(c!==Yu)break}return!1},_B=function(e,t){for(var r=e;r>=0;){var a=t[r];if(a===Yu)r--;else return a}return 0},MG=function(e,t,r,a,s){if(r[a]===0)return va;var n=a-1;if(Array.isArray(s)&&s[n]===!0)return va;var o=n-1,c=n+1,u=t[n],f=o>=0?t[o]:0,h=t[c];if(u===lF&&h===oF)return va;if(zw.indexOf(u)!==-1)return uF;if(zw.indexOf(h)!==-1||dF.indexOf(h)!==-1)return va;if(_B(n,t)===AF)return bm;if(Kw.get(e[n])===Iw||(u===mm||u===xm)&&Kw.get(e[c])===Iw||u===gB||h===gB||u===mB||[Yu,Qw,Vh].indexOf(u)===-1&&h===mB||[gm,Dh,LG,Wd,$d].indexOf(h)!==-1||_B(n,t)===Ih||bv(mv,Ih,n,t)||bv([gm,Dh],Rw,n,t)||bv(xB,xB,n,t))return va;if(u===Yu)return bm;if(u===mv||h===mv)return va;if(h===Ow||u===Ow)return bm;if([Qw,Vh,Rw].indexOf(h)!==-1||u===TG||f===Pw&&OG.indexOf(u)!==-1||u===$d&&h===Pw||h===bB||$c.indexOf(h)!==-1&&u===xo||$c.indexOf(u)!==-1&&h===xo||u===Wh&&[Rp,mm,xm].indexOf(h)!==-1||[Rp,mm,xm].indexOf(u)!==-1&&h===Gh||$c.indexOf(u)!==-1&&vB.indexOf(h)!==-1||vB.indexOf(u)!==-1&&$c.indexOf(h)!==-1||[Wh,Gh].indexOf(u)!==-1&&(h===xo||[Ih,Vh].indexOf(h)!==-1&&t[c+1]===xo)||[Ih,Vh].indexOf(u)!==-1&&h===xo||u===xo&&[xo,$d,Wd].indexOf(h)!==-1)return va;if([xo,$d,Wd,gm,Dh].indexOf(h)!==-1)for(var g=n;g>=0;){var x=t[g];if(x===xo)return va;if([$d,Wd].indexOf(x)!==-1)g--;else break}if([Wh,Gh].indexOf(h)!==-1)for(var g=[gm,Dh].indexOf(u)!==-1?o:n;g>=0;){var x=t[g];if(x===xo)return va;if([$d,Wd].indexOf(x)!==-1)g--;else break}if(qw===u&&[qw,Wm,Mw,Hw].indexOf(h)!==-1||[Wm,Mw].indexOf(u)!==-1&&[Wm,$m].indexOf(h)!==-1||[$m,Hw].indexOf(u)!==-1&&h===$m||wB.indexOf(u)!==-1&&[bB,Gh].indexOf(h)!==-1||wB.indexOf(h)!==-1&&u===Wh||$c.indexOf(u)!==-1&&$c.indexOf(h)!==-1||u===Wd&&$c.indexOf(h)!==-1||$c.concat(xo).indexOf(u)!==-1&&h===Ih&&IG.indexOf(e[c])===-1||$c.concat(xo).indexOf(h)!==-1&&u===Dh)return va;if(u===xv&&h===xv){for(var m=r[n],w=1;m>0&&(m--,t[m]===xv);)w++;if(w%2!==0)return va}return u===mm&&h===xm?va:bm},HG=function(e,t){t||(t={lineBreak:"normal",wordBreak:"normal"});var r=RG(e,t.lineBreak),a=r[0],s=r[1],n=r[2];(t.wordBreak==="break-all"||t.wordBreak==="break-word")&&(s=s.map(function(c){return[xo,U0,cF].indexOf(c)!==-1?Rp:c}));var o=t.wordBreak==="keep-all"?n.map(function(c,u){return c&&e[u]>=19968&&e[u]<=40959}):void 0;return[a,s,o]},PG=(function(){function e(t,r,a,s){this.codePoints=t,this.required=r===uF,this.start=a,this.end=s}return e.prototype.slice=function(){return _n.apply(void 0,this.codePoints.slice(this.start,this.end))},e})(),qG=function(e,t){var r=db(e),a=HG(r,t),s=a[0],n=a[1],o=a[2],c=r.length,u=0,f=0;return{next:function(){if(f>=c)return{done:!0,value:null};for(var h=va;f<c&&(h=MG(r,n,s,++f,o))===va;);if(h!==va||f===c){var g=new PG(r,h,u,f);return u=f,{value:g,done:!1}}return{done:!0,value:null}}}},KG=1,zG=2,rg=4,yB=8,Lx=10,kB=47,up=92,VG=9,GG=32,vm=34,Qh=61,WG=35,$G=36,XG=37,wm=39,_m=40,Oh=41,YG=95,eo=45,JG=33,ZG=60,eW=62,tW=64,rW=91,aW=93,sW=61,nW=123,ym=63,iW=125,BB=124,lW=126,oW=128,CB=65533,vv=42,M0=43,AW=44,cW=58,uW=59,Mp=46,dW=0,fW=8,hW=11,pW=14,gW=31,mW=127,cc=-1,fF=48,hF=97,pF=101,xW=102,bW=117,vW=122,gF=65,mF=69,xF=70,wW=85,_W=90,sl=function(e){return e>=fF&&e<=57},yW=function(e){return e>=55296&&e<=57343},Xd=function(e){return sl(e)||e>=gF&&e<=xF||e>=hF&&e<=xW},kW=function(e){return e>=hF&&e<=vW},BW=function(e){return e>=gF&&e<=_W},CW=function(e){return kW(e)||BW(e)},SW=function(e){return e>=oW},km=function(e){return e===Lx||e===VG||e===GG},jx=function(e){return CW(e)||SW(e)||e===YG},SB=function(e){return jx(e)||sl(e)||e===eo},NW=function(e){return e>=dW&&e<=fW||e===hW||e>=pW&&e<=gW||e===mW},Ku=function(e,t){return e!==up?!1:t!==Lx},Bm=function(e,t,r){return e===eo?jx(t)||Ku(t,r):jx(e)?!0:!!(e===up&&Ku(e,t))},wv=function(e,t,r){return e===M0||e===eo?sl(t)?!0:t===Mp&&sl(r):sl(e===Mp?t:e)},EW=function(e){var t=0,r=1;(e[t]===M0||e[t]===eo)&&(e[t]===eo&&(r=-1),t++);for(var a=[];sl(e[t]);)a.push(e[t++]);var s=a.length?parseInt(_n.apply(void 0,a),10):0;e[t]===Mp&&t++;for(var n=[];sl(e[t]);)n.push(e[t++]);var o=n.length,c=o?parseInt(_n.apply(void 0,n),10):0;(e[t]===mF||e[t]===pF)&&t++;var u=1;(e[t]===M0||e[t]===eo)&&(e[t]===eo&&(u=-1),t++);for(var f=[];sl(e[t]);)f.push(e[t++]);var h=f.length?parseInt(_n.apply(void 0,f),10):0;return r*(s+c*Math.pow(10,-o))*Math.pow(10,u*h)},FW={type:2},TW={type:3},LW={type:4},jW={type:13},UW={type:8},DW={type:21},IW={type:9},QW={type:10},OW={type:11},RW={type:12},MW={type:14},Cm={type:23},HW={type:1},PW={type:25},qW={type:24},KW={type:26},zW={type:27},VW={type:28},GW={type:29},WW={type:31},Vw={type:32},bF=(function(){function e(){this._value=[]}return e.prototype.write=function(t){this._value=this._value.concat(db(t))},e.prototype.read=function(){for(var t=[],r=this.consumeToken();r!==Vw;)t.push(r),r=this.consumeToken();return t},e.prototype.consumeToken=function(){var t=this.consumeCodePoint();switch(t){case vm:return this.consumeStringToken(vm);case WG:var r=this.peekCodePoint(0),a=this.peekCodePoint(1),s=this.peekCodePoint(2);if(SB(r)||Ku(a,s)){var n=Bm(r,a,s)?zG:KG,o=this.consumeName();return{type:5,value:o,flags:n}}break;case $G:if(this.peekCodePoint(0)===Qh)return this.consumeCodePoint(),jW;break;case wm:return this.consumeStringToken(wm);case _m:return FW;case Oh:return TW;case vv:if(this.peekCodePoint(0)===Qh)return this.consumeCodePoint(),MW;break;case M0:if(wv(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case AW:return LW;case eo:var c=t,u=this.peekCodePoint(0),f=this.peekCodePoint(1);if(wv(c,u,f))return this.reconsumeCodePoint(t),this.consumeNumericToken();if(Bm(c,u,f))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();if(u===eo&&f===eW)return this.consumeCodePoint(),this.consumeCodePoint(),qW;break;case Mp:if(wv(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case kB:if(this.peekCodePoint(0)===vv)for(this.consumeCodePoint();;){var h=this.consumeCodePoint();if(h===vv&&(h=this.consumeCodePoint(),h===kB))return this.consumeToken();if(h===cc)return this.consumeToken()}break;case cW:return KW;case uW:return zW;case ZG:if(this.peekCodePoint(0)===JG&&this.peekCodePoint(1)===eo&&this.peekCodePoint(2)===eo)return this.consumeCodePoint(),this.consumeCodePoint(),PW;break;case tW:var g=this.peekCodePoint(0),x=this.peekCodePoint(1),m=this.peekCodePoint(2);if(Bm(g,x,m)){var o=this.consumeName();return{type:7,value:o}}break;case rW:return VW;case up:if(Ku(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();break;case aW:return GW;case sW:if(this.peekCodePoint(0)===Qh)return this.consumeCodePoint(),UW;break;case nW:return OW;case iW:return RW;case bW:case wW:var w=this.peekCodePoint(0),v=this.peekCodePoint(1);return w===M0&&(Xd(v)||v===ym)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(t),this.consumeIdentLikeToken();case BB:if(this.peekCodePoint(0)===Qh)return this.consumeCodePoint(),IW;if(this.peekCodePoint(0)===BB)return this.consumeCodePoint(),DW;break;case lW:if(this.peekCodePoint(0)===Qh)return this.consumeCodePoint(),QW;break;case cc:return Vw}return km(t)?(this.consumeWhiteSpace(),WW):sl(t)?(this.reconsumeCodePoint(t),this.consumeNumericToken()):jx(t)?(this.reconsumeCodePoint(t),this.consumeIdentLikeToken()):{type:6,value:_n(t)}},e.prototype.consumeCodePoint=function(){var t=this._value.shift();return typeof t>"u"?-1:t},e.prototype.reconsumeCodePoint=function(t){this._value.unshift(t)},e.prototype.peekCodePoint=function(t){return t>=this._value.length?-1:this._value[t]},e.prototype.consumeUnicodeRangeToken=function(){for(var t=[],r=this.consumeCodePoint();Xd(r)&&t.length<6;)t.push(r),r=this.consumeCodePoint();for(var a=!1;r===ym&&t.length<6;)t.push(r),r=this.consumeCodePoint(),a=!0;if(a){var s=parseInt(_n.apply(void 0,t.map(function(u){return u===ym?fF:u})),16),n=parseInt(_n.apply(void 0,t.map(function(u){return u===ym?xF:u})),16);return{type:30,start:s,end:n}}var o=parseInt(_n.apply(void 0,t),16);if(this.peekCodePoint(0)===eo&&Xd(this.peekCodePoint(1))){this.consumeCodePoint(),r=this.consumeCodePoint();for(var c=[];Xd(r)&&c.length<6;)c.push(r),r=this.consumeCodePoint();var n=parseInt(_n.apply(void 0,c),16);return{type:30,start:o,end:n}}else return{type:30,start:o,end:o}},e.prototype.consumeIdentLikeToken=function(){var t=this.consumeName();return t.toLowerCase()==="url"&&this.peekCodePoint(0)===_m?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===_m?(this.consumeCodePoint(),{type:19,value:t}):{type:20,value:t}},e.prototype.consumeUrlToken=function(){var t=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===cc)return{type:22,value:""};var r=this.peekCodePoint(0);if(r===wm||r===vm){var a=this.consumeStringToken(this.consumeCodePoint());return a.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===cc||this.peekCodePoint(0)===Oh)?(this.consumeCodePoint(),{type:22,value:a.value}):(this.consumeBadUrlRemnants(),Cm)}for(;;){var s=this.consumeCodePoint();if(s===cc||s===Oh)return{type:22,value:_n.apply(void 0,t)};if(km(s))return this.consumeWhiteSpace(),this.peekCodePoint(0)===cc||this.peekCodePoint(0)===Oh?(this.consumeCodePoint(),{type:22,value:_n.apply(void 0,t)}):(this.consumeBadUrlRemnants(),Cm);if(s===vm||s===wm||s===_m||NW(s))return this.consumeBadUrlRemnants(),Cm;if(s===up)if(Ku(s,this.peekCodePoint(0)))t.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),Cm;else t.push(s)}},e.prototype.consumeWhiteSpace=function(){for(;km(this.peekCodePoint(0));)this.consumeCodePoint()},e.prototype.consumeBadUrlRemnants=function(){for(;;){var t=this.consumeCodePoint();if(t===Oh||t===cc)return;Ku(t,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},e.prototype.consumeStringSlice=function(t){for(var r=5e4,a="";t>0;){var s=Math.min(r,t);a+=_n.apply(void 0,this._value.splice(0,s)),t-=s}return this._value.shift(),a},e.prototype.consumeStringToken=function(t){var r="",a=0;do{var s=this._value[a];if(s===cc||s===void 0||s===t)return r+=this.consumeStringSlice(a),{type:0,value:r};if(s===Lx)return this._value.splice(0,a),HW;if(s===up){var n=this._value[a+1];n!==cc&&n!==void 0&&(n===Lx?(r+=this.consumeStringSlice(a),a=-1,this._value.shift()):Ku(s,n)&&(r+=this.consumeStringSlice(a),r+=_n(this.consumeEscapedCodePoint()),a=-1))}a++}while(!0)},e.prototype.consumeNumber=function(){var t=[],r=rg,a=this.peekCodePoint(0);for((a===M0||a===eo)&&t.push(this.consumeCodePoint());sl(this.peekCodePoint(0));)t.push(this.consumeCodePoint());a=this.peekCodePoint(0);var s=this.peekCodePoint(1);if(a===Mp&&sl(s))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),r=yB;sl(this.peekCodePoint(0));)t.push(this.consumeCodePoint());a=this.peekCodePoint(0),s=this.peekCodePoint(1);var n=this.peekCodePoint(2);if((a===mF||a===pF)&&((s===M0||s===eo)&&sl(n)||sl(s)))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),r=yB;sl(this.peekCodePoint(0));)t.push(this.consumeCodePoint());return[EW(t),r]},e.prototype.consumeNumericToken=function(){var t=this.consumeNumber(),r=t[0],a=t[1],s=this.peekCodePoint(0),n=this.peekCodePoint(1),o=this.peekCodePoint(2);if(Bm(s,n,o)){var c=this.consumeName();return{type:15,number:r,flags:a,unit:c}}return s===XG?(this.consumeCodePoint(),{type:16,number:r,flags:a}):{type:17,number:r,flags:a}},e.prototype.consumeEscapedCodePoint=function(){var t=this.consumeCodePoint();if(Xd(t)){for(var r=_n(t);Xd(this.peekCodePoint(0))&&r.length<6;)r+=_n(this.consumeCodePoint());km(this.peekCodePoint(0))&&this.consumeCodePoint();var a=parseInt(r,16);return a===0||yW(a)||a>1114111?CB:a}return t===cc?CB:t},e.prototype.consumeName=function(){for(var t="";;){var r=this.consumeCodePoint();if(SB(r))t+=_n(r);else if(Ku(r,this.peekCodePoint(0)))t+=_n(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(r),t}},e})(),vF=(function(){function e(t){this._tokens=t}return e.create=function(t){var r=new bF;return r.write(t),new e(r.read())},e.parseValue=function(t){return e.create(t).parseComponentValue()},e.parseValues=function(t){return e.create(t).parseComponentValues()},e.prototype.parseComponentValue=function(){for(var t=this.consumeToken();t.type===31;)t=this.consumeToken();if(t.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(t);var r=this.consumeComponentValue();do t=this.consumeToken();while(t.type===31);if(t.type===32)return r;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},e.prototype.parseComponentValues=function(){for(var t=[];;){var r=this.consumeComponentValue();if(r.type===32)return t;t.push(r),t.push()}},e.prototype.consumeComponentValue=function(){var t=this.consumeToken();switch(t.type){case 11:case 28:case 2:return this.consumeSimpleBlock(t.type);case 19:return this.consumeFunction(t)}return t},e.prototype.consumeSimpleBlock=function(t){for(var r={type:t,values:[]},a=this.consumeToken();;){if(a.type===32||XW(a,t))return r;this.reconsumeToken(a),r.values.push(this.consumeComponentValue()),a=this.consumeToken()}},e.prototype.consumeFunction=function(t){for(var r={name:t.value,values:[],type:18};;){var a=this.consumeToken();if(a.type===32||a.type===3)return r;this.reconsumeToken(a),r.values.push(this.consumeComponentValue())}},e.prototype.consumeToken=function(){var t=this._tokens.shift();return typeof t>"u"?Vw:t},e.prototype.reconsumeToken=function(t){this._tokens.unshift(t)},e})(),ag=function(e){return e.type===15},qf=function(e){return e.type===17},ns=function(e){return e.type===20},$W=function(e){return e.type===0},Gw=function(e,t){return ns(e)&&e.value===t},wF=function(e){return e.type!==31},Df=function(e){return e.type!==31&&e.type!==4},Nc=function(e){var t=[],r=[];return e.forEach(function(a){if(a.type===4){if(r.length===0)throw new Error("Error parsing function args, zero tokens for arg");t.push(r),r=[];return}a.type!==31&&r.push(a)}),r.length&&t.push(r),t},XW=function(e,t){return t===11&&e.type===12||t===28&&e.type===29?!0:t===2&&e.type===3},d0=function(e){return e.type===17||e.type===15},Kn=function(e){return e.type===16||d0(e)},_F=function(e){return e.length>1?[e[0],e[1]]:[e[0]]},Oi={type:17,number:0,flags:rg},k_={type:16,number:50,flags:rg},Ju={type:16,number:100,flags:rg},$h=function(e,t,r){var a=e[0],s=e[1];return[xs(a,t),xs(typeof s<"u"?s:a,r)]},xs=function(e,t){if(e.type===16)return e.number/100*t;if(ag(e))switch(e.unit){case"rem":case"em":return 16*e.number;default:return e.number}return e.number},yF="deg",kF="grad",BF="rad",CF="turn",fb={name:"angle",parse:function(e,t){if(t.type===15)switch(t.unit){case yF:return Math.PI*t.number/180;case kF:return Math.PI/200*t.number;case BF:return t.number;case CF:return Math.PI*2*t.number}throw new Error("Unsupported angle type")}},SF=function(e){return e.type===15&&(e.unit===yF||e.unit===kF||e.unit===BF||e.unit===CF)},NF=function(e){var t=e.filter(ns).map(function(r){return r.value}).join(" ");switch(t){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Oi,Oi];case"to top":case"bottom":return Yo(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Oi,Ju];case"to right":case"left":return Yo(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[Ju,Ju];case"to bottom":case"top":return Yo(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[Ju,Oi];case"to left":case"right":return Yo(270)}return 0},Yo=function(e){return Math.PI*e/180},s0={name:"color",parse:function(e,t){if(t.type===18){var r=YW[t.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported color function "'+t.name+'"');return r(e,t.values)}if(t.type===5){if(t.value.length===3){var a=t.value.substring(0,1),s=t.value.substring(1,2),n=t.value.substring(2,3);return Zu(parseInt(a+a,16),parseInt(s+s,16),parseInt(n+n,16),1)}if(t.value.length===4){var a=t.value.substring(0,1),s=t.value.substring(1,2),n=t.value.substring(2,3),o=t.value.substring(3,4);return Zu(parseInt(a+a,16),parseInt(s+s,16),parseInt(n+n,16),parseInt(o+o,16)/255)}if(t.value.length===6){var a=t.value.substring(0,2),s=t.value.substring(2,4),n=t.value.substring(4,6);return Zu(parseInt(a,16),parseInt(s,16),parseInt(n,16),1)}if(t.value.length===8){var a=t.value.substring(0,2),s=t.value.substring(2,4),n=t.value.substring(4,6),o=t.value.substring(6,8);return Zu(parseInt(a,16),parseInt(s,16),parseInt(n,16),parseInt(o,16)/255)}}if(t.type===20){var c=nu[t.value.toUpperCase()];if(typeof c<"u")return c}return nu.TRANSPARENT}},n0=function(e){return(255&e)===0},bi=function(e){var t=255&e,r=255&e>>8,a=255&e>>16,s=255&e>>24;return t<255?"rgba("+s+","+a+","+r+","+t/255+")":"rgb("+s+","+a+","+r+")"},Zu=function(e,t,r,a){return(e<<24|t<<16|r<<8|Math.round(a*255)<<0)>>>0},NB=function(e,t){if(e.type===17)return e.number;if(e.type===16){var r=t===3?1:255;return t===3?e.number/100*r:Math.round(e.number/100*r)}return 0},EB=function(e,t){var r=t.filter(Df);if(r.length===3){var a=r.map(NB),s=a[0],n=a[1],o=a[2];return Zu(s,n,o,1)}if(r.length===4){var c=r.map(NB),s=c[0],n=c[1],o=c[2],u=c[3];return Zu(s,n,o,u)}return 0};function _v(e,t,r){return r<0&&(r+=1),r>=1&&(r-=1),r<1/6?(t-e)*r*6+e:r<1/2?t:r<2/3?(t-e)*6*(2/3-r)+e:e}var FB=function(e,t){var r=t.filter(Df),a=r[0],s=r[1],n=r[2],o=r[3],c=(a.type===17?Yo(a.number):fb.parse(e,a))/(Math.PI*2),u=Kn(s)?s.number/100:0,f=Kn(n)?n.number/100:0,h=typeof o<"u"&&Kn(o)?xs(o,1):1;if(u===0)return Zu(f*255,f*255,f*255,1);var g=f<=.5?f*(u+1):f+u-f*u,x=f*2-g,m=_v(x,g,c+1/3),w=_v(x,g,c),v=_v(x,g,c-1/3);return Zu(m*255,w*255,v*255,h)},YW={hsl:FB,hsla:FB,rgb:EB,rgba:EB},dp=function(e,t){return s0.parse(e,vF.create(t).parseComponentValue())},nu={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},JW={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map(function(r){if(ns(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},ZW={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},hb=function(e,t){var r=s0.parse(e,t[0]),a=t[1];return a&&Kn(a)?{color:r,stop:a}:{color:r,stop:null}},TB=function(e,t){var r=e[0],a=e[e.length-1];r.stop===null&&(r.stop=Oi),a.stop===null&&(a.stop=Ju);for(var s=[],n=0,o=0;o<e.length;o++){var c=e[o].stop;if(c!==null){var u=xs(c,t);u>n?s.push(u):s.push(n),n=u}else s.push(null)}for(var f=null,o=0;o<s.length;o++){var h=s[o];if(h===null)f===null&&(f=o);else if(f!==null){for(var g=o-f,x=s[f-1],m=(h-x)/(g+1),w=1;w<=g;w++)s[f+w-1]=m*w;f=null}}return e.map(function(v,B){var k=v.color;return{color:k,stop:Math.max(Math.min(1,s[B]/t),0)}})},e$=function(e,t,r){var a=t/2,s=r/2,n=xs(e[0],t)-a,o=s-xs(e[1],r);return(Math.atan2(o,n)+Math.PI*2)%(Math.PI*2)},t$=function(e,t,r){var a=typeof e=="number"?e:e$(e,t,r),s=Math.abs(t*Math.sin(a))+Math.abs(r*Math.cos(a)),n=t/2,o=r/2,c=s/2,u=Math.sin(a-Math.PI/2)*c,f=Math.cos(a-Math.PI/2)*c;return[s,n-f,n+f,o-u,o+u]},kA=function(e,t){return Math.sqrt(e*e+t*t)},LB=function(e,t,r,a,s){var n=[[0,0],[0,t],[e,0],[e,t]];return n.reduce(function(o,c){var u=c[0],f=c[1],h=kA(r-u,a-f);return(s?h<o.optimumDistance:h>o.optimumDistance)?{optimumCorner:c,optimumDistance:h}:o},{optimumDistance:s?1/0:-1/0,optimumCorner:null}).optimumCorner},r$=function(e,t,r,a,s){var n=0,o=0;switch(e.size){case 0:e.shape===0?n=o=Math.min(Math.abs(t),Math.abs(t-a),Math.abs(r),Math.abs(r-s)):e.shape===1&&(n=Math.min(Math.abs(t),Math.abs(t-a)),o=Math.min(Math.abs(r),Math.abs(r-s)));break;case 2:if(e.shape===0)n=o=Math.min(kA(t,r),kA(t,r-s),kA(t-a,r),kA(t-a,r-s));else if(e.shape===1){var c=Math.min(Math.abs(r),Math.abs(r-s))/Math.min(Math.abs(t),Math.abs(t-a)),u=LB(a,s,t,r,!0),f=u[0],h=u[1];n=kA(f-t,(h-r)/c),o=c*n}break;case 1:e.shape===0?n=o=Math.max(Math.abs(t),Math.abs(t-a),Math.abs(r),Math.abs(r-s)):e.shape===1&&(n=Math.max(Math.abs(t),Math.abs(t-a)),o=Math.max(Math.abs(r),Math.abs(r-s)));break;case 3:if(e.shape===0)n=o=Math.max(kA(t,r),kA(t,r-s),kA(t-a,r),kA(t-a,r-s));else if(e.shape===1){var c=Math.max(Math.abs(r),Math.abs(r-s))/Math.max(Math.abs(t),Math.abs(t-a)),g=LB(a,s,t,r,!1),f=g[0],h=g[1];n=kA(f-t,(h-r)/c),o=c*n}break}return Array.isArray(e.size)&&(n=xs(e.size[0],a),o=e.size.length===2?xs(e.size[1],s):n),[n,o]},a$=function(e,t){var r=Yo(180),a=[];return Nc(t).forEach(function(s,n){if(n===0){var o=s[0];if(o.type===20&&o.value==="to"){r=NF(s);return}else if(SF(o)){r=fb.parse(e,o);return}}var c=hb(e,s);a.push(c)}),{angle:r,stops:a,type:1}},Sm=function(e,t){var r=Yo(180),a=[];return Nc(t).forEach(function(s,n){if(n===0){var o=s[0];if(o.type===20&&["top","left","right","bottom"].indexOf(o.value)!==-1){r=NF(s);return}else if(SF(o)){r=(fb.parse(e,o)+Yo(270))%Yo(360);return}}var c=hb(e,s);a.push(c)}),{angle:r,stops:a,type:1}},s$=function(e,t){var r=Yo(180),a=[],s=1,n=0,o=3,c=[];return Nc(t).forEach(function(u,f){var h=u[0];if(f===0){if(ns(h)&&h.value==="linear"){s=1;return}else if(ns(h)&&h.value==="radial"){s=2;return}}if(h.type===18){if(h.name==="from"){var g=s0.parse(e,h.values[0]);a.push({stop:Oi,color:g})}else if(h.name==="to"){var g=s0.parse(e,h.values[0]);a.push({stop:Ju,color:g})}else if(h.name==="color-stop"){var x=h.values.filter(Df);if(x.length===2){var g=s0.parse(e,x[1]),m=x[0];qf(m)&&a.push({stop:{type:16,number:m.number*100,flags:m.flags},color:g})}}}}),s===1?{angle:(r+Yo(180))%Yo(360),stops:a,type:s}:{size:o,shape:n,stops:a,position:c,type:s}},EF="closest-side",FF="farthest-side",TF="closest-corner",LF="farthest-corner",jF="circle",UF="ellipse",DF="cover",IF="contain",n$=function(e,t){var r=0,a=3,s=[],n=[];return Nc(t).forEach(function(o,c){var u=!0;if(c===0){var f=!1;u=o.reduce(function(g,x){if(f)if(ns(x))switch(x.value){case"center":return n.push(k_),g;case"top":case"left":return n.push(Oi),g;case"right":case"bottom":return n.push(Ju),g}else(Kn(x)||d0(x))&&n.push(x);else if(ns(x))switch(x.value){case jF:return r=0,!1;case UF:return r=1,!1;case"at":return f=!0,!1;case EF:return a=0,!1;case DF:case FF:return a=1,!1;case IF:case TF:return a=2,!1;case LF:return a=3,!1}else if(d0(x)||Kn(x))return Array.isArray(a)||(a=[]),a.push(x),!1;return g},u)}if(u){var h=hb(e,o);s.push(h)}}),{size:a,shape:r,stops:s,position:n,type:2}},Nm=function(e,t){var r=0,a=3,s=[],n=[];return Nc(t).forEach(function(o,c){var u=!0;if(c===0?u=o.reduce(function(h,g){if(ns(g))switch(g.value){case"center":return n.push(k_),!1;case"top":case"left":return n.push(Oi),!1;case"right":case"bottom":return n.push(Ju),!1}else if(Kn(g)||d0(g))return n.push(g),!1;return h},u):c===1&&(u=o.reduce(function(h,g){if(ns(g))switch(g.value){case jF:return r=0,!1;case UF:return r=1,!1;case IF:case EF:return a=0,!1;case FF:return a=1,!1;case TF:return a=2,!1;case DF:case LF:return a=3,!1}else if(d0(g)||Kn(g))return Array.isArray(a)||(a=[]),a.push(g),!1;return h},u)),u){var f=hb(e,o);s.push(f)}}),{size:a,shape:r,stops:s,position:n,type:2}},i$=function(e){return e.type===1},l$=function(e){return e.type===2},B_={name:"image",parse:function(e,t){if(t.type===22){var r={url:t.value,type:0};return e.cache.addImage(t.value),r}if(t.type===18){var a=QF[t.name];if(typeof a>"u")throw new Error('Attempting to parse an unsupported image function "'+t.name+'"');return a(e,t.values)}throw new Error("Unsupported image type "+t.type)}};function o$(e){return!(e.type===20&&e.value==="none")&&(e.type!==18||!!QF[e.name])}var QF={"linear-gradient":a$,"-moz-linear-gradient":Sm,"-ms-linear-gradient":Sm,"-o-linear-gradient":Sm,"-webkit-linear-gradient":Sm,"radial-gradient":n$,"-moz-radial-gradient":Nm,"-ms-radial-gradient":Nm,"-o-radial-gradient":Nm,"-webkit-radial-gradient":Nm,"-webkit-gradient":s$},A$={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(t.length===0)return[];var r=t[0];return r.type===20&&r.value==="none"?[]:t.filter(function(a){return Df(a)&&o$(a)}).map(function(a){return B_.parse(e,a)})}},c$={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map(function(r){if(ns(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},u$={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(e,t){return Nc(t).map(function(r){return r.filter(Kn)}).map(_F)}},d$={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(e,t){return Nc(t).map(function(r){return r.filter(ns).map(function(a){return a.value}).join(" ")}).map(f$)}},f$=function(e){switch(e){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;default:return 0}},kf;(function(e){e.AUTO="auto",e.CONTAIN="contain",e.COVER="cover"})(kf||(kf={}));var h$={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(e,t){return Nc(t).map(function(r){return r.filter(p$)})}},p$=function(e){return ns(e)||Kn(e)},pb=function(e){return{name:"border-"+e+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},g$=pb("top"),m$=pb("right"),x$=pb("bottom"),b$=pb("left"),gb=function(e){return{name:"border-radius-"+e,initialValue:"0 0",prefix:!1,type:1,parse:function(t,r){return _F(r.filter(Kn))}}},v$=gb("top-left"),w$=gb("top-right"),_$=gb("bottom-right"),y$=gb("bottom-left"),mb=function(e){return{name:"border-"+e+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(t,r){switch(r){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},k$=mb("top"),B$=mb("right"),C$=mb("bottom"),S$=mb("left"),xb=function(e){return{name:"border-"+e+"-width",initialValue:"0",type:0,prefix:!1,parse:function(t,r){return ag(r)?r.number:0}}},N$=xb("top"),E$=xb("right"),F$=xb("bottom"),T$=xb("left"),L$={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},j$={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(e,t){return t==="rtl"?1:0}},U$={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(e,t){return t.filter(ns).reduce(function(r,a){return r|D$(a.value)},0)}},D$=function(e){switch(e){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},I$={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},Q$={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(e,t){return t.type===20&&t.value==="normal"?0:t.type===17||t.type===15?t.number:0}},Ux;(function(e){e.NORMAL="normal",e.STRICT="strict"})(Ux||(Ux={}));var O$={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){return t==="strict"?Ux.STRICT:Ux.NORMAL}},R$={name:"line-height",initialValue:"normal",prefix:!1,type:4},jB=function(e,t){return ns(e)&&e.value==="normal"?1.2*t:e.type===17?t*e.number:Kn(e)?xs(e,t):t},M$={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(e,t){return t.type===20&&t.value==="none"?null:B_.parse(e,t)}},H$={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(e,t){return t==="inside"?0:1}},Ww={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;default:return-1}}},bb=function(e){return{name:"margin-"+e,initialValue:"0",prefix:!1,type:4}},P$=bb("top"),q$=bb("right"),K$=bb("bottom"),z$=bb("left"),V$={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(e,t){return t.filter(ns).map(function(r){switch(r.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;default:return 0}})}},G$={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){return t==="break-word"?"break-word":"normal"}},vb=function(e){return{name:"padding-"+e,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},W$=vb("top"),$$=vb("right"),X$=vb("bottom"),Y$=vb("left"),J$={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(e,t){switch(t){case"right":return 2;case"center":case"justify":return 1;default:return 0}}},Z$={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(e,t){switch(t){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},eX={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.length===1&&Gw(t[0],"none")?[]:Nc(t).map(function(r){for(var a={color:nu.TRANSPARENT,offsetX:Oi,offsetY:Oi,blur:Oi},s=0,n=0;n<r.length;n++){var o=r[n];d0(o)?(s===0?a.offsetX=o:s===1?a.offsetY=o:a.blur=o,s++):a.color=s0.parse(e,o)}return a})}},tX={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},rX={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(e,t){if(t.type===20&&t.value==="none")return null;if(t.type===18){var r=nX[t.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported transform function "'+t.name+'"');return r(t.values)}return null}},aX=function(e){var t=e.filter(function(r){return r.type===17}).map(function(r){return r.number});return t.length===6?t:null},sX=function(e){var t=e.filter(function(u){return u.type===17}).map(function(u){return u.number}),r=t[0],a=t[1];t[2],t[3];var s=t[4],n=t[5];t[6],t[7],t[8],t[9],t[10],t[11];var o=t[12],c=t[13];return t[14],t[15],t.length===16?[r,a,s,n,o,c]:null},nX={matrix:aX,matrix3d:sX},UB={type:16,number:50,flags:rg},iX=[UB,UB],lX={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(e,t){var r=t.filter(Kn);return r.length!==2?iX:[r[0],r[1]]}},oX={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"hidden":return 1;case"collapse":return 2;default:return 0}}},fp;(function(e){e.NORMAL="normal",e.BREAK_ALL="break-all",e.KEEP_ALL="keep-all"})(fp||(fp={}));var AX={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"break-all":return fp.BREAK_ALL;case"keep-all":return fp.KEEP_ALL;default:return fp.NORMAL}}},cX={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(e,t){if(t.type===20)return{auto:!0,order:0};if(qf(t))return{auto:!1,order:t.number};throw new Error("Invalid z-index number parsed")}},OF={name:"time",parse:function(e,t){if(t.type===15)switch(t.unit.toLowerCase()){case"s":return 1e3*t.number;case"ms":return t.number}throw new Error("Unsupported time type")}},uX={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(e,t){return qf(t)?t.number:1}},dX={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},fX={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(e,t){return t.filter(ns).map(function(r){switch(r.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(r){return r!==0})}},hX={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(e,t){var r=[],a=[];return t.forEach(function(s){switch(s.type){case 20:case 0:r.push(s.value);break;case 17:r.push(s.number.toString());break;case 4:a.push(r.join(" ")),r.length=0;break}}),r.length&&a.push(r.join(" ")),a.map(function(s){return s.indexOf(" ")===-1?s:"'"+s+"'"})}},pX={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},gX={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(e,t){return qf(t)?t.number:ns(t)&&t.value==="bold"?700:400}},mX={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.filter(ns).map(function(r){return r.value})}},xX={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"oblique":return"oblique";case"italic":return"italic";default:return"normal"}}},oi=function(e,t){return(e&t)!==0},bX={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(t.length===0)return[];var r=t[0];return r.type===20&&r.value==="none"?[]:t}},vX={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return null;var r=t[0];if(r.type===20&&r.value==="none")return null;for(var a=[],s=t.filter(wF),n=0;n<s.length;n++){var o=s[n],c=s[n+1];if(o.type===20){var u=c&&qf(c)?c.number:1;a.push({counter:o.value,increment:u})}}return a}},wX={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return[];for(var r=[],a=t.filter(wF),s=0;s<a.length;s++){var n=a[s],o=a[s+1];if(ns(n)&&n.value!=="none"){var c=o&&qf(o)?o.number:0;r.push({counter:n.value,reset:c})}}return r}},_X={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(e,t){return t.filter(ag).map(function(r){return OF.parse(e,r)})}},yX={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return null;var r=t[0];if(r.type===20&&r.value==="none")return null;var a=[],s=t.filter($W);if(s.length%2!==0)return null;for(var n=0;n<s.length;n+=2){var o=s[n].value,c=s[n+1].value;a.push({open:o,close:c})}return a}},DB=function(e,t,r){if(!e)return"";var a=e[Math.min(t,e.length-1)];return a?r?a.open:a.close:""},kX={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.length===1&&Gw(t[0],"none")?[]:Nc(t).map(function(r){for(var a={color:255,offsetX:Oi,offsetY:Oi,blur:Oi,spread:Oi,inset:!1},s=0,n=0;n<r.length;n++){var o=r[n];Gw(o,"inset")?a.inset=!0:d0(o)?(s===0?a.offsetX=o:s===1?a.offsetY=o:s===2?a.blur=o:a.spread=o,s++):a.color=s0.parse(e,o)}return a})}},BX={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(e,t){var r=[0,1,2],a=[];return t.filter(ns).forEach(function(s){switch(s.value){case"stroke":a.push(1);break;case"fill":a.push(0);break;case"markers":a.push(2);break}}),r.forEach(function(s){a.indexOf(s)===-1&&a.push(s)}),a}},CX={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},SX={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(e,t){return ag(t)?t.number:0}},NX=(function(){function e(t,r){var a,s;this.animationDuration=Ar(t,_X,r.animationDuration),this.backgroundClip=Ar(t,JW,r.backgroundClip),this.backgroundColor=Ar(t,ZW,r.backgroundColor),this.backgroundImage=Ar(t,A$,r.backgroundImage),this.backgroundOrigin=Ar(t,c$,r.backgroundOrigin),this.backgroundPosition=Ar(t,u$,r.backgroundPosition),this.backgroundRepeat=Ar(t,d$,r.backgroundRepeat),this.backgroundSize=Ar(t,h$,r.backgroundSize),this.borderTopColor=Ar(t,g$,r.borderTopColor),this.borderRightColor=Ar(t,m$,r.borderRightColor),this.borderBottomColor=Ar(t,x$,r.borderBottomColor),this.borderLeftColor=Ar(t,b$,r.borderLeftColor),this.borderTopLeftRadius=Ar(t,v$,r.borderTopLeftRadius),this.borderTopRightRadius=Ar(t,w$,r.borderTopRightRadius),this.borderBottomRightRadius=Ar(t,_$,r.borderBottomRightRadius),this.borderBottomLeftRadius=Ar(t,y$,r.borderBottomLeftRadius),this.borderTopStyle=Ar(t,k$,r.borderTopStyle),this.borderRightStyle=Ar(t,B$,r.borderRightStyle),this.borderBottomStyle=Ar(t,C$,r.borderBottomStyle),this.borderLeftStyle=Ar(t,S$,r.borderLeftStyle),this.borderTopWidth=Ar(t,N$,r.borderTopWidth),this.borderRightWidth=Ar(t,E$,r.borderRightWidth),this.borderBottomWidth=Ar(t,F$,r.borderBottomWidth),this.borderLeftWidth=Ar(t,T$,r.borderLeftWidth),this.boxShadow=Ar(t,kX,r.boxShadow),this.color=Ar(t,L$,r.color),this.direction=Ar(t,j$,r.direction),this.display=Ar(t,U$,r.display),this.float=Ar(t,I$,r.cssFloat),this.fontFamily=Ar(t,hX,r.fontFamily),this.fontSize=Ar(t,pX,r.fontSize),this.fontStyle=Ar(t,xX,r.fontStyle),this.fontVariant=Ar(t,mX,r.fontVariant),this.fontWeight=Ar(t,gX,r.fontWeight),this.letterSpacing=Ar(t,Q$,r.letterSpacing),this.lineBreak=Ar(t,O$,r.lineBreak),this.lineHeight=Ar(t,R$,r.lineHeight),this.listStyleImage=Ar(t,M$,r.listStyleImage),this.listStylePosition=Ar(t,H$,r.listStylePosition),this.listStyleType=Ar(t,Ww,r.listStyleType),this.marginTop=Ar(t,P$,r.marginTop),this.marginRight=Ar(t,q$,r.marginRight),this.marginBottom=Ar(t,K$,r.marginBottom),this.marginLeft=Ar(t,z$,r.marginLeft),this.opacity=Ar(t,uX,r.opacity);var n=Ar(t,V$,r.overflow);this.overflowX=n[0],this.overflowY=n[n.length>1?1:0],this.overflowWrap=Ar(t,G$,r.overflowWrap),this.paddingTop=Ar(t,W$,r.paddingTop),this.paddingRight=Ar(t,$$,r.paddingRight),this.paddingBottom=Ar(t,X$,r.paddingBottom),this.paddingLeft=Ar(t,Y$,r.paddingLeft),this.paintOrder=Ar(t,BX,r.paintOrder),this.position=Ar(t,Z$,r.position),this.textAlign=Ar(t,J$,r.textAlign),this.textDecorationColor=Ar(t,dX,(a=r.textDecorationColor)!==null&&a!==void 0?a:r.color),this.textDecorationLine=Ar(t,fX,(s=r.textDecorationLine)!==null&&s!==void 0?s:r.textDecoration),this.textShadow=Ar(t,eX,r.textShadow),this.textTransform=Ar(t,tX,r.textTransform),this.transform=Ar(t,rX,r.transform),this.transformOrigin=Ar(t,lX,r.transformOrigin),this.visibility=Ar(t,oX,r.visibility),this.webkitTextStrokeColor=Ar(t,CX,r.webkitTextStrokeColor),this.webkitTextStrokeWidth=Ar(t,SX,r.webkitTextStrokeWidth),this.wordBreak=Ar(t,AX,r.wordBreak),this.zIndex=Ar(t,cX,r.zIndex)}return e.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},e.prototype.isTransparent=function(){return n0(this.backgroundColor)},e.prototype.isTransformed=function(){return this.transform!==null},e.prototype.isPositioned=function(){return this.position!==0},e.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},e.prototype.isFloating=function(){return this.float!==0},e.prototype.isInlineLevel=function(){return oi(this.display,4)||oi(this.display,33554432)||oi(this.display,268435456)||oi(this.display,536870912)||oi(this.display,67108864)||oi(this.display,134217728)},e})(),EX=(function(){function e(t,r){this.content=Ar(t,bX,r.content),this.quotes=Ar(t,yX,r.quotes)}return e})(),IB=(function(){function e(t,r){this.counterIncrement=Ar(t,vX,r.counterIncrement),this.counterReset=Ar(t,wX,r.counterReset)}return e})(),Ar=function(e,t,r){var a=new bF,s=r!==null&&typeof r<"u"?r.toString():t.initialValue;a.write(s);var n=new vF(a.read());switch(t.type){case 2:var o=n.parseComponentValue();return t.parse(e,ns(o)?o.value:t.initialValue);case 0:return t.parse(e,n.parseComponentValue());case 1:return t.parse(e,n.parseComponentValues());case 4:return n.parseComponentValue();case 3:switch(t.format){case"angle":return fb.parse(e,n.parseComponentValue());case"color":return s0.parse(e,n.parseComponentValue());case"image":return B_.parse(e,n.parseComponentValue());case"length":var c=n.parseComponentValue();return d0(c)?c:Oi;case"length-percentage":var u=n.parseComponentValue();return Kn(u)?u:Oi;case"time":return OF.parse(e,n.parseComponentValue())}break}},FX="data-html2canvas-debug",TX=function(e){var t=e.getAttribute(FX);switch(t){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},$w=function(e,t){var r=TX(e);return r===1||t===r},Ec=(function(){function e(t,r){if(this.context=t,this.textNodes=[],this.elements=[],this.flags=0,$w(r,3))debugger;this.styles=new NX(t,window.getComputedStyle(r,null)),Jw(r)&&(this.styles.animationDuration.some(function(a){return a>0})&&(r.style.animationDuration="0s"),this.styles.transform!==null&&(r.style.transform="none")),this.bounds=ub(this.context,r),$w(r,4)&&(this.flags|=16)}return e})(),LX="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",QB="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Xh=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Em=0;Em<QB.length;Em++)Xh[QB.charCodeAt(Em)]=Em;var jX=function(e){var t=e.length*.75,r=e.length,a,s=0,n,o,c,u;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var f=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),h=Array.isArray(f)?f:new Uint8Array(f);for(a=0;a<r;a+=4)n=Xh[e.charCodeAt(a)],o=Xh[e.charCodeAt(a+1)],c=Xh[e.charCodeAt(a+2)],u=Xh[e.charCodeAt(a+3)],h[s++]=n<<2|o>>4,h[s++]=(o&15)<<4|c>>2,h[s++]=(c&3)<<6|u&63;return f},UX=function(e){for(var t=e.length,r=[],a=0;a<t;a+=2)r.push(e[a+1]<<8|e[a]);return r},DX=function(e){for(var t=e.length,r=[],a=0;a<t;a+=4)r.push(e[a+3]<<24|e[a+2]<<16|e[a+1]<<8|e[a]);return r},G0=5,C_=11,yv=2,IX=C_-G0,RF=65536>>G0,QX=1<<G0,kv=QX-1,OX=1024>>G0,RX=RF+OX,MX=RX,HX=32,PX=MX+HX,qX=65536>>C_,KX=1<<IX,zX=KX-1,OB=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},VX=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},GX=function(e,t){var r=jX(e),a=Array.isArray(r)?DX(r):new Uint32Array(r),s=Array.isArray(r)?UX(r):new Uint16Array(r),n=24,o=OB(s,n/2,a[4]/2),c=a[5]===2?OB(s,(n+a[4])/2):VX(a,Math.ceil((n+a[4])/4));return new WX(a[0],a[1],a[2],a[3],o,c)},WX=(function(){function e(t,r,a,s,n,o){this.initialValue=t,this.errorValue=r,this.highStart=a,this.highValueIndex=s,this.index=n,this.data=o}return e.prototype.get=function(t){var r;if(t>=0){if(t<55296||t>56319&&t<=65535)return r=this.index[t>>G0],r=(r<<yv)+(t&kv),this.data[r];if(t<=65535)return r=this.index[RF+(t-55296>>G0)],r=(r<<yv)+(t&kv),this.data[r];if(t<this.highStart)return r=PX-qX+(t>>C_),r=this.index[r],r+=t>>G0&zX,r=this.index[r],r=(r<<yv)+(t&kv),this.data[r];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e})(),RB="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$X=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Fm=0;Fm<RB.length;Fm++)$X[RB.charCodeAt(Fm)]=Fm;var XX=1,Bv=2,Cv=3,MB=4,HB=5,YX=7,PB=8,Sv=9,Nv=10,qB=11,KB=12,zB=13,VB=14,Ev=15,JX=function(e){for(var t=[],r=0,a=e.length;r<a;){var s=e.charCodeAt(r++);if(s>=55296&&s<=56319&&r<a){var n=e.charCodeAt(r++);(n&64512)===56320?t.push(((s&1023)<<10)+(n&1023)+65536):(t.push(s),r--)}else t.push(s)}return t},ZX=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var a=[],s=-1,n="";++s<r;){var o=e[s];o<=65535?a.push(o):(o-=65536,a.push((o>>10)+55296,o%1024+56320)),(s+1===r||a.length>16384)&&(n+=String.fromCharCode.apply(String,a),a.length=0)}return n},eY=GX(LX),Go="",Fv="",tY=function(e){return eY.get(e)},rY=function(e,t,r){var a=r-2,s=t[a],n=t[r-1],o=t[r];if(n===Bv&&o===Cv)return Go;if(n===Bv||n===Cv||n===MB||o===Bv||o===Cv||o===MB)return Fv;if(n===PB&&[PB,Sv,qB,KB].indexOf(o)!==-1||(n===qB||n===Sv)&&(o===Sv||o===Nv)||(n===KB||n===Nv)&&o===Nv||o===zB||o===HB||o===YX||n===XX)return Go;if(n===zB&&o===VB){for(;s===HB;)s=t[--a];if(s===VB)return Go}if(n===Ev&&o===Ev){for(var c=0;s===Ev;)c++,s=t[--a];if(c%2===0)return Go}return Fv},aY=function(e){var t=JX(e),r=t.length,a=0,s=0,n=t.map(tY);return{next:function(){if(a>=r)return{done:!0,value:null};for(var o=Go;a<r&&(o=rY(t,n,++a))===Go;);if(o!==Go||a===r){var c=ZX.apply(null,t.slice(s,a));return s=a,{value:c,done:!1}}return{done:!0,value:null}}}},sY=function(e){for(var t=aY(e),r=[],a;!(a=t.next()).done;)a.value&&r.push(a.value.slice());return r},nY=function(e){var t=123;if(e.createRange){var r=e.createRange();if(r.getBoundingClientRect){var a=e.createElement("boundtest");a.style.height=t+"px",a.style.display="block",e.body.appendChild(a),r.selectNode(a);var s=r.getBoundingClientRect(),n=Math.round(s.height);if(e.body.removeChild(a),n===t)return!0}}return!1},iY=function(e){var t=e.createElement("boundtest");t.style.width="50px",t.style.display="block",t.style.fontSize="12px",t.style.letterSpacing="0px",t.style.wordSpacing="0px",e.body.appendChild(t);var r=e.createRange();t.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var a=t.firstChild,s=db(a.data).map(function(u){return _n(u)}),n=0,o={},c=s.every(function(u,f){r.setStart(a,n),r.setEnd(a,n+u.length);var h=r.getBoundingClientRect();n+=u.length;var g=h.x>o.x||h.y>o.y;return o=h,f===0?!0:g});return e.body.removeChild(t),c},lY=function(){return typeof new Image().crossOrigin<"u"},oY=function(){return typeof new XMLHttpRequest().responseType=="string"},AY=function(e){var t=new Image,r=e.createElement("canvas"),a=r.getContext("2d");if(!a)return!1;t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{a.drawImage(t,0,0),r.toDataURL()}catch{return!1}return!0},GB=function(e){return e[0]===0&&e[1]===255&&e[2]===0&&e[3]===255},cY=function(e){var t=e.createElement("canvas"),r=100;t.width=r,t.height=r;var a=t.getContext("2d");if(!a)return Promise.reject(!1);a.fillStyle="rgb(0, 255, 0)",a.fillRect(0,0,r,r);var s=new Image,n=t.toDataURL();s.src=n;var o=Xw(r,r,0,0,s);return a.fillStyle="red",a.fillRect(0,0,r,r),WB(o).then(function(c){a.drawImage(c,0,0);var u=a.getImageData(0,0,r,r).data;a.fillStyle="red",a.fillRect(0,0,r,r);var f=e.createElement("div");return f.style.backgroundImage="url("+n+")",f.style.height=r+"px",GB(u)?WB(Xw(r,r,0,0,f)):Promise.reject(!1)}).then(function(c){return a.drawImage(c,0,0),GB(a.getImageData(0,0,r,r).data)}).catch(function(){return!1})},Xw=function(e,t,r,a,s){var n="http://www.w3.org/2000/svg",o=document.createElementNS(n,"svg"),c=document.createElementNS(n,"foreignObject");return o.setAttributeNS(null,"width",e.toString()),o.setAttributeNS(null,"height",t.toString()),c.setAttributeNS(null,"width","100%"),c.setAttributeNS(null,"height","100%"),c.setAttributeNS(null,"x",r.toString()),c.setAttributeNS(null,"y",a.toString()),c.setAttributeNS(null,"externalResourcesRequired","true"),o.appendChild(c),c.appendChild(s),o},WB=function(e){return new Promise(function(t,r){var a=new Image;a.onload=function(){return t(a)},a.onerror=r,a.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(e))})},Di={get SUPPORT_RANGE_BOUNDS(){var e=nY(document);return Object.defineProperty(Di,"SUPPORT_RANGE_BOUNDS",{value:e}),e},get SUPPORT_WORD_BREAKING(){var e=Di.SUPPORT_RANGE_BOUNDS&&iY(document);return Object.defineProperty(Di,"SUPPORT_WORD_BREAKING",{value:e}),e},get SUPPORT_SVG_DRAWING(){var e=AY(document);return Object.defineProperty(Di,"SUPPORT_SVG_DRAWING",{value:e}),e},get SUPPORT_FOREIGNOBJECT_DRAWING(){var e=typeof Array.from=="function"&&typeof window.fetch=="function"?cY(document):Promise.resolve(!1);return Object.defineProperty(Di,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:e}),e},get SUPPORT_CORS_IMAGES(){var e=lY();return Object.defineProperty(Di,"SUPPORT_CORS_IMAGES",{value:e}),e},get SUPPORT_RESPONSE_TYPE(){var e=oY();return Object.defineProperty(Di,"SUPPORT_RESPONSE_TYPE",{value:e}),e},get SUPPORT_CORS_XHR(){var e="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Di,"SUPPORT_CORS_XHR",{value:e}),e},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var e=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(Di,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:e}),e}},hp=(function(){function e(t,r){this.text=t,this.bounds=r}return e})(),uY=function(e,t,r,a){var s=hY(t,r),n=[],o=0;return s.forEach(function(c){if(r.textDecorationLine.length||c.trim().length>0)if(Di.SUPPORT_RANGE_BOUNDS){var u=$B(a,o,c.length).getClientRects();if(u.length>1){var f=S_(c),h=0;f.forEach(function(x){n.push(new hp(x,ou.fromDOMRectList(e,$B(a,h+o,x.length).getClientRects()))),h+=x.length})}else n.push(new hp(c,ou.fromDOMRectList(e,u)))}else{var g=a.splitText(c.length);n.push(new hp(c,dY(e,a))),a=g}else Di.SUPPORT_RANGE_BOUNDS||(a=a.splitText(c.length));o+=c.length}),n},dY=function(e,t){var r=t.ownerDocument;if(r){var a=r.createElement("html2canvaswrapper");a.appendChild(t.cloneNode(!0));var s=t.parentNode;if(s){s.replaceChild(a,t);var n=ub(e,a);return a.firstChild&&s.replaceChild(a.firstChild,a),n}}return ou.EMPTY},$B=function(e,t,r){var a=e.ownerDocument;if(!a)throw new Error("Node has no owner document");var s=a.createRange();return s.setStart(e,t),s.setEnd(e,t+r),s},S_=function(e){if(Di.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(t.segment(e)).map(function(r){return r.segment})}return sY(e)},fY=function(e,t){if(Di.SUPPORT_NATIVE_TEXT_SEGMENTATION){var r=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(r.segment(e)).map(function(a){return a.segment})}return gY(e,t)},hY=function(e,t){return t.letterSpacing!==0?S_(e):fY(e,t)},pY=[32,160,4961,65792,65793,4153,4241],gY=function(e,t){for(var r=qG(e,{lineBreak:t.lineBreak,wordBreak:t.overflowWrap==="break-word"?"break-word":t.wordBreak}),a=[],s,n=function(){if(s.value){var o=s.value.slice(),c=db(o),u="";c.forEach(function(f){pY.indexOf(f)===-1?u+=_n(f):(u.length&&a.push(u),a.push(_n(f)),u="")}),u.length&&a.push(u)}};!(s=r.next()).done;)n();return a},mY=(function(){function e(t,r,a){this.text=xY(r.data,a.textTransform),this.textBounds=uY(t,this.text,a,r)}return e})(),xY=function(e,t){switch(t){case 1:return e.toLowerCase();case 3:return e.replace(bY,vY);case 2:return e.toUpperCase();default:return e}},bY=/(^|\s|:|-|\(|\))([a-z])/g,vY=function(e,t,r){return e.length>0?t+r.toUpperCase():e},MF=(function(e){DA(t,e);function t(r,a){var s=e.call(this,r,a)||this;return s.src=a.currentSrc||a.src,s.intrinsicWidth=a.naturalWidth,s.intrinsicHeight=a.naturalHeight,s.context.cache.addImage(s.src),s}return t})(Ec),HF=(function(e){DA(t,e);function t(r,a){var s=e.call(this,r,a)||this;return s.canvas=a,s.intrinsicWidth=a.width,s.intrinsicHeight=a.height,s}return t})(Ec),PF=(function(e){DA(t,e);function t(r,a){var s=e.call(this,r,a)||this,n=new XMLSerializer,o=ub(r,a);return a.setAttribute("width",o.width+"px"),a.setAttribute("height",o.height+"px"),s.svg="data:image/svg+xml,"+encodeURIComponent(n.serializeToString(a)),s.intrinsicWidth=a.width.baseVal.value,s.intrinsicHeight=a.height.baseVal.value,s.context.cache.addImage(s.svg),s}return t})(Ec),qF=(function(e){DA(t,e);function t(r,a){var s=e.call(this,r,a)||this;return s.value=a.value,s}return t})(Ec),Yw=(function(e){DA(t,e);function t(r,a){var s=e.call(this,r,a)||this;return s.start=a.start,s.reversed=typeof a.reversed=="boolean"&&a.reversed===!0,s}return t})(Ec),wY=[{type:15,flags:0,unit:"px",number:3}],_Y=[{type:16,flags:0,number:50}],yY=function(e){return e.width>e.height?new ou(e.left+(e.width-e.height)/2,e.top,e.height,e.height):e.width<e.height?new ou(e.left,e.top+(e.height-e.width)/2,e.width,e.width):e},kY=function(e){var t=e.type===BY?new Array(e.value.length+1).join(""):e.value;return t.length===0?e.placeholder||"":t},Dx="checkbox",Ix="radio",BY="password",XB=707406591,N_=(function(e){DA(t,e);function t(r,a){var s=e.call(this,r,a)||this;switch(s.type=a.type.toLowerCase(),s.checked=a.checked,s.value=kY(a),(s.type===Dx||s.type===Ix)&&(s.styles.backgroundColor=3739148031,s.styles.borderTopColor=s.styles.borderRightColor=s.styles.borderBottomColor=s.styles.borderLeftColor=2779096575,s.styles.borderTopWidth=s.styles.borderRightWidth=s.styles.borderBottomWidth=s.styles.borderLeftWidth=1,s.styles.borderTopStyle=s.styles.borderRightStyle=s.styles.borderBottomStyle=s.styles.borderLeftStyle=1,s.styles.backgroundClip=[0],s.styles.backgroundOrigin=[0],s.bounds=yY(s.bounds)),s.type){case Dx:s.styles.borderTopRightRadius=s.styles.borderTopLeftRadius=s.styles.borderBottomRightRadius=s.styles.borderBottomLeftRadius=wY;break;case Ix:s.styles.borderTopRightRadius=s.styles.borderTopLeftRadius=s.styles.borderBottomRightRadius=s.styles.borderBottomLeftRadius=_Y;break}return s}return t})(Ec),KF=(function(e){DA(t,e);function t(r,a){var s=e.call(this,r,a)||this,n=a.options[a.selectedIndex||0];return s.value=n&&n.text||"",s}return t})(Ec),zF=(function(e){DA(t,e);function t(r,a){var s=e.call(this,r,a)||this;return s.value=a.value,s}return t})(Ec),VF=(function(e){DA(t,e);function t(r,a){var s=e.call(this,r,a)||this;s.src=a.src,s.width=parseInt(a.width,10)||0,s.height=parseInt(a.height,10)||0,s.backgroundColor=s.styles.backgroundColor;try{if(a.contentWindow&&a.contentWindow.document&&a.contentWindow.document.documentElement){s.tree=WF(r,a.contentWindow.document.documentElement);var n=a.contentWindow.document.documentElement?dp(r,getComputedStyle(a.contentWindow.document.documentElement).backgroundColor):nu.TRANSPARENT,o=a.contentWindow.document.body?dp(r,getComputedStyle(a.contentWindow.document.body).backgroundColor):nu.TRANSPARENT;s.backgroundColor=n0(n)?n0(o)?s.styles.backgroundColor:o:n}}catch{}return s}return t})(Ec),CY=["OL","UL","MENU"],Xm=function(e,t,r,a){for(var s=t.firstChild,n=void 0;s;s=n)if(n=s.nextSibling,$F(s)&&s.data.trim().length>0)r.textNodes.push(new mY(e,s,r.styles));else if(gf(s))if(ZF(s)&&s.assignedNodes)s.assignedNodes().forEach(function(c){return Xm(e,c,r,a)});else{var o=GF(e,s);o.styles.isVisible()&&(SY(s,o,a)?o.flags|=4:NY(o.styles)&&(o.flags|=2),CY.indexOf(s.tagName)!==-1&&(o.flags|=8),r.elements.push(o),s.slot,s.shadowRoot?Xm(e,s.shadowRoot,o,a):!Qx(s)&&!XF(s)&&!Ox(s)&&Xm(e,s,o,a))}},GF=function(e,t){return Zw(t)?new MF(e,t):YF(t)?new HF(e,t):XF(t)?new PF(e,t):EY(t)?new qF(e,t):FY(t)?new Yw(e,t):TY(t)?new N_(e,t):Ox(t)?new KF(e,t):Qx(t)?new zF(e,t):JF(t)?new VF(e,t):new Ec(e,t)},WF=function(e,t){var r=GF(e,t);return r.flags|=4,Xm(e,t,r,r),r},SY=function(e,t,r){return t.styles.isPositionedWithZIndex()||t.styles.opacity<1||t.styles.isTransformed()||E_(e)&&r.styles.isTransparent()},NY=function(e){return e.isPositioned()||e.isFloating()},$F=function(e){return e.nodeType===Node.TEXT_NODE},gf=function(e){return e.nodeType===Node.ELEMENT_NODE},Jw=function(e){return gf(e)&&typeof e.style<"u"&&!Ym(e)},Ym=function(e){return typeof e.className=="object"},EY=function(e){return e.tagName==="LI"},FY=function(e){return e.tagName==="OL"},TY=function(e){return e.tagName==="INPUT"},LY=function(e){return e.tagName==="HTML"},XF=function(e){return e.tagName==="svg"},E_=function(e){return e.tagName==="BODY"},YF=function(e){return e.tagName==="CANVAS"},YB=function(e){return e.tagName==="VIDEO"},Zw=function(e){return e.tagName==="IMG"},JF=function(e){return e.tagName==="IFRAME"},JB=function(e){return e.tagName==="STYLE"},jY=function(e){return e.tagName==="SCRIPT"},Qx=function(e){return e.tagName==="TEXTAREA"},Ox=function(e){return e.tagName==="SELECT"},ZF=function(e){return e.tagName==="SLOT"},ZB=function(e){return e.tagName.indexOf("-")>0},UY=(function(){function e(){this.counters={}}return e.prototype.getCounterValue=function(t){var r=this.counters[t];return r&&r.length?r[r.length-1]:1},e.prototype.getCounterValues=function(t){var r=this.counters[t];return r||[]},e.prototype.pop=function(t){var r=this;t.forEach(function(a){return r.counters[a].pop()})},e.prototype.parse=function(t){var r=this,a=t.counterIncrement,s=t.counterReset,n=!0;a!==null&&a.forEach(function(c){var u=r.counters[c.counter];u&&c.increment!==0&&(n=!1,u.length||u.push(1),u[Math.max(0,u.length-1)]+=c.increment)});var o=[];return n&&s.forEach(function(c){var u=r.counters[c.counter];o.push(c.counter),u||(u=r.counters[c.counter]=[]),u.push(c.reset)}),o},e})(),eC={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},tC={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},DY={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},IY={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Yd=function(e,t,r,a,s,n){return e<t||e>r?Hp(e,s,n.length>0):a.integers.reduce(function(o,c,u){for(;e>=c;)e-=c,o+=a.values[u];return o},"")+n},eT=function(e,t,r,a){var s="";do r||e--,s=a(e)+s,e/=t;while(e*t>=t);return s},bn=function(e,t,r,a,s){var n=r-t+1;return(e<0?"-":"")+(eT(Math.abs(e),n,a,function(o){return _n(Math.floor(o%n)+t)})+s)},F0=function(e,t,r){r===void 0&&(r=". ");var a=t.length;return eT(Math.abs(e),a,!1,function(s){return t[Math.floor(s%a)]})+r},Af=1,Pu=2,qu=4,Yh=8,Xc=function(e,t,r,a,s,n){if(e<-9999||e>9999)return Hp(e,4,s.length>0);var o=Math.abs(e),c=s;if(o===0)return t[0]+c;for(var u=0;o>0&&u<=4;u++){var f=o%10;f===0&&oi(n,Af)&&c!==""?c=t[f]+c:f>1||f===1&&u===0||f===1&&u===1&&oi(n,Pu)||f===1&&u===1&&oi(n,qu)&&e>100||f===1&&u>1&&oi(n,Yh)?c=t[f]+(u>0?r[u-1]:"")+c:f===1&&u>0&&(c=r[u-1]+c),o=Math.floor(o/10)}return(e<0?a:"")+c},rC="",aC="",sC="",Tv="",Hp=function(e,t,r){var a=r?". ":"",s=r?"":"",n=r?", ":"",o=r?" ":"";switch(t){case 0:return""+o;case 1:return""+o;case 2:return""+o;case 5:var c=bn(e,48,57,!0,a);return c.length<4?"0"+c:c;case 4:return F0(e,"",s);case 6:return Yd(e,1,3999,eC,3,a).toLowerCase();case 7:return Yd(e,1,3999,eC,3,a);case 8:return bn(e,945,969,!1,a);case 9:return bn(e,97,122,!1,a);case 10:return bn(e,65,90,!1,a);case 11:return bn(e,1632,1641,!0,a);case 12:case 49:return Yd(e,1,9999,tC,3,a);case 35:return Yd(e,1,9999,tC,3,a).toLowerCase();case 13:return bn(e,2534,2543,!0,a);case 14:case 30:return bn(e,6112,6121,!0,a);case 15:return F0(e,"",s);case 16:return F0(e,"",s);case 17:case 48:return Xc(e,"",rC,"",s,Pu|qu|Yh);case 47:return Xc(e,"",aC,"",s,Af|Pu|qu|Yh);case 42:return Xc(e,"",rC,"",s,Pu|qu|Yh);case 41:return Xc(e,"",aC,"",s,Af|Pu|qu|Yh);case 26:return Xc(e,"","",sC,s,0);case 25:return Xc(e,"","",sC,s,Af|Pu|qu);case 31:return Xc(e,"","",Tv,n,Af|Pu|qu);case 33:return Xc(e,"","",Tv,n,0);case 32:return Xc(e,"","",Tv,n,Af|Pu|qu);case 18:return bn(e,2406,2415,!0,a);case 20:return Yd(e,1,19999,IY,3,a);case 21:return bn(e,2790,2799,!0,a);case 22:return bn(e,2662,2671,!0,a);case 22:return Yd(e,1,10999,DY,3,a);case 23:return F0(e,"");case 24:return F0(e,"");case 27:return bn(e,3302,3311,!0,a);case 28:return F0(e,"",s);case 29:return F0(e,"",s);case 34:return bn(e,3792,3801,!0,a);case 37:return bn(e,6160,6169,!0,a);case 38:return bn(e,4160,4169,!0,a);case 39:return bn(e,2918,2927,!0,a);case 40:return bn(e,1776,1785,!0,a);case 43:return bn(e,3046,3055,!0,a);case 44:return bn(e,3174,3183,!0,a);case 45:return bn(e,3664,3673,!0,a);case 46:return bn(e,3872,3881,!0,a);default:return bn(e,48,57,!0,a)}},tT="data-html2canvas-ignore",nC=(function(){function e(t,r,a){if(this.context=t,this.options=a,this.scrolledElements=[],this.referenceElement=r,this.counters=new UY,this.quoteDepth=0,!r.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(r.ownerDocument.documentElement,!1)}return e.prototype.toIFrame=function(t,r){var a=this,s=QY(t,r);if(!s.contentWindow)return Promise.reject("Unable to find iframe window");var n=t.defaultView.pageXOffset,o=t.defaultView.pageYOffset,c=s.contentWindow,u=c.document,f=MY(s).then(function(){return ml(a,void 0,void 0,function(){var h,g;return tl(this,function(x){switch(x.label){case 0:return this.scrolledElements.forEach(KY),c&&(c.scrollTo(r.left,r.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(c.scrollY!==r.top||c.scrollX!==r.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(c.scrollX-r.left,c.scrollY-r.top,0,0))),h=this.options.onclone,g=this.clonedReferenceElement,typeof g>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:u.fonts&&u.fonts.ready?[4,u.fonts.ready]:[3,2];case 1:x.sent(),x.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,RY(u)]:[3,4];case 3:x.sent(),x.label=4;case 4:return typeof h=="function"?[2,Promise.resolve().then(function(){return h(u,g)}).then(function(){return s})]:[2,s]}})})});return u.open(),u.write(PY(document.doctype)+"<html></html>"),qY(this.referenceElement.ownerDocument,n,o),u.replaceChild(u.adoptNode(this.documentElement),u.documentElement),u.close(),f},e.prototype.createElementClone=function(t){if($w(t,2))debugger;if(YF(t))return this.createCanvasClone(t);if(YB(t))return this.createVideoClone(t);if(JB(t))return this.createStyleClone(t);var r=t.cloneNode(!1);return Zw(r)&&(Zw(t)&&t.currentSrc&&t.currentSrc!==t.src&&(r.src=t.currentSrc,r.srcset=""),r.loading==="lazy"&&(r.loading="eager")),ZB(r)?this.createCustomElementClone(r):r},e.prototype.createCustomElementClone=function(t){var r=document.createElement("html2canvascustomelement");return Lv(t.style,r),r},e.prototype.createStyleClone=function(t){try{var r=t.sheet;if(r&&r.cssRules){var a=[].slice.call(r.cssRules,0).reduce(function(n,o){return o&&typeof o.cssText=="string"?n+o.cssText:n},""),s=t.cloneNode(!1);return s.textContent=a,s}}catch(n){if(this.context.logger.error("Unable to access cssRules property",n),n.name!=="SecurityError")throw n}return t.cloneNode(!1)},e.prototype.createCanvasClone=function(t){var r;if(this.options.inlineImages&&t.ownerDocument){var a=t.ownerDocument.createElement("img");try{return a.src=t.toDataURL(),a}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",t)}}var s=t.cloneNode(!1);try{s.width=t.width,s.height=t.height;var n=t.getContext("2d"),o=s.getContext("2d");if(o)if(!this.options.allowTaint&&n)o.putImageData(n.getImageData(0,0,t.width,t.height),0,0);else{var c=(r=t.getContext("webgl2"))!==null&&r!==void 0?r:t.getContext("webgl");if(c){var u=c.getContextAttributes();u?.preserveDrawingBuffer===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",t)}o.drawImage(t,0,0)}return s}catch{this.context.logger.info("Unable to clone canvas as it is tainted",t)}return s},e.prototype.createVideoClone=function(t){var r=t.ownerDocument.createElement("canvas");r.width=t.offsetWidth,r.height=t.offsetHeight;var a=r.getContext("2d");try{return a&&(a.drawImage(t,0,0,r.width,r.height),this.options.allowTaint||a.getImageData(0,0,r.width,r.height)),r}catch{this.context.logger.info("Unable to clone video as it is tainted",t)}var s=t.ownerDocument.createElement("canvas");return s.width=t.offsetWidth,s.height=t.offsetHeight,s},e.prototype.appendChildNode=function(t,r,a){(!gf(r)||!jY(r)&&!r.hasAttribute(tT)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(r)))&&(!this.options.copyStyles||!gf(r)||!JB(r))&&t.appendChild(this.cloneNode(r,a))},e.prototype.cloneChildNodes=function(t,r,a){for(var s=this,n=t.shadowRoot?t.shadowRoot.firstChild:t.firstChild;n;n=n.nextSibling)if(gf(n)&&ZF(n)&&typeof n.assignedNodes=="function"){var o=n.assignedNodes();o.length&&o.forEach(function(c){return s.appendChildNode(r,c,a)})}else this.appendChildNode(r,n,a)},e.prototype.cloneNode=function(t,r){if($F(t))return document.createTextNode(t.data);if(!t.ownerDocument)return t.cloneNode(!1);var a=t.ownerDocument.defaultView;if(a&&gf(t)&&(Jw(t)||Ym(t))){var s=this.createElementClone(t);s.style.transitionProperty="none";var n=a.getComputedStyle(t),o=a.getComputedStyle(t,":before"),c=a.getComputedStyle(t,":after");this.referenceElement===t&&Jw(s)&&(this.clonedReferenceElement=s),E_(s)&&GY(s);var u=this.counters.parse(new IB(this.context,n)),f=this.resolvePseudoContent(t,s,o,pp.BEFORE);ZB(t)&&(r=!0),YB(t)||this.cloneChildNodes(t,s,r),f&&s.insertBefore(f,s.firstChild);var h=this.resolvePseudoContent(t,s,c,pp.AFTER);return h&&s.appendChild(h),this.counters.pop(u),(n&&(this.options.copyStyles||Ym(t))&&!JF(t)||r)&&Lv(n,s),(t.scrollTop!==0||t.scrollLeft!==0)&&this.scrolledElements.push([s,t.scrollLeft,t.scrollTop]),(Qx(t)||Ox(t))&&(Qx(s)||Ox(s))&&(s.value=t.value),s}return t.cloneNode(!1)},e.prototype.resolvePseudoContent=function(t,r,a,s){var n=this;if(a){var o=a.content,c=r.ownerDocument;if(!(!c||!o||o==="none"||o==="-moz-alt-content"||a.display==="none")){this.counters.parse(new IB(this.context,a));var u=new EX(this.context,a),f=c.createElement("html2canvaspseudoelement");Lv(a,f),u.content.forEach(function(g){if(g.type===0)f.appendChild(c.createTextNode(g.value));else if(g.type===22){var x=c.createElement("img");x.src=g.value,x.style.opacity="1",f.appendChild(x)}else if(g.type===18){if(g.name==="attr"){var m=g.values.filter(ns);m.length&&f.appendChild(c.createTextNode(t.getAttribute(m[0].value)||""))}else if(g.name==="counter"){var w=g.values.filter(Df),v=w[0],B=w[1];if(v&&ns(v)){var k=n.counters.getCounterValue(v.value),E=B&&ns(B)?Ww.parse(n.context,B.value):3;f.appendChild(c.createTextNode(Hp(k,E,!1)))}}else if(g.name==="counters"){var S=g.values.filter(Df),v=S[0],L=S[1],B=S[2];if(v&&ns(v)){var P=n.counters.getCounterValues(v.value),R=B&&ns(B)?Ww.parse(n.context,B.value):3,Q=L&&L.type===0?L.value:"",V=P.map(function(T){return Hp(T,R,!1)}).join(Q);f.appendChild(c.createTextNode(V))}}}else if(g.type===20)switch(g.value){case"open-quote":f.appendChild(c.createTextNode(DB(u.quotes,n.quoteDepth++,!0)));break;case"close-quote":f.appendChild(c.createTextNode(DB(u.quotes,--n.quoteDepth,!1)));break;default:f.appendChild(c.createTextNode(g.value))}}),f.className=e2+" "+t2;var h=s===pp.BEFORE?" "+e2:" "+t2;return Ym(r)?r.className.baseValue+=h:r.className+=h,f}}},e.destroy=function(t){return t.parentNode?(t.parentNode.removeChild(t),!0):!1},e})(),pp;(function(e){e[e.BEFORE=0]="BEFORE",e[e.AFTER=1]="AFTER"})(pp||(pp={}));var QY=function(e,t){var r=e.createElement("iframe");return r.className="html2canvas-container",r.style.visibility="hidden",r.style.position="fixed",r.style.left="-10000px",r.style.top="0px",r.style.border="0",r.width=t.width.toString(),r.height=t.height.toString(),r.scrolling="no",r.setAttribute(tT,"true"),e.body.appendChild(r),r},OY=function(e){return new Promise(function(t){if(e.complete){t();return}if(!e.src){t();return}e.onload=t,e.onerror=t})},RY=function(e){return Promise.all([].slice.call(e.images,0).map(OY))},MY=function(e){return new Promise(function(t,r){var a=e.contentWindow;if(!a)return r("No window assigned for iframe");var s=a.document;a.onload=e.onload=function(){a.onload=e.onload=null;var n=setInterval(function(){s.body.childNodes.length>0&&s.readyState==="complete"&&(clearInterval(n),t(e))},50)}})},HY=["all","d","content"],Lv=function(e,t){for(var r=e.length-1;r>=0;r--){var a=e.item(r);HY.indexOf(a)===-1&&t.style.setProperty(a,e.getPropertyValue(a))}return t},PY=function(e){var t="";return e&&(t+="<!DOCTYPE ",e.name&&(t+=e.name),e.internalSubset&&(t+=e.internalSubset),e.publicId&&(t+='"'+e.publicId+'"'),e.systemId&&(t+='"'+e.systemId+'"'),t+=">"),t},qY=function(e,t,r){e&&e.defaultView&&(t!==e.defaultView.pageXOffset||r!==e.defaultView.pageYOffset)&&e.defaultView.scrollTo(t,r)},KY=function(e){var t=e[0],r=e[1],a=e[2];t.scrollLeft=r,t.scrollTop=a},zY=":before",VY=":after",e2="___html2canvas___pseudoelement_before",t2="___html2canvas___pseudoelement_after",iC=`{
    content: "" !important;
    display: none !important;
}`,GY=function(e){WY(e,"."+e2+zY+iC+`
         .`+t2+VY+iC)},WY=function(e,t){var r=e.ownerDocument;if(r){var a=r.createElement("style");a.textContent=t,e.appendChild(a)}},rT=(function(){function e(){}return e.getOrigin=function(t){var r=e._link;return r?(r.href=t,r.href=r.href,r.protocol+r.hostname+r.port):"about:blank"},e.isSameOrigin=function(t){return e.getOrigin(t)===e._origin},e.setContext=function(t){e._link=t.document.createElement("a"),e._origin=e.getOrigin(t.location.href)},e._origin="about:blank",e})(),$Y=(function(){function e(t,r){this.context=t,this._options=r,this._cache={}}return e.prototype.addImage=function(t){var r=Promise.resolve();return this.has(t)||(Uv(t)||ZY(t))&&(this._cache[t]=this.loadImage(t)).catch(function(){}),r},e.prototype.match=function(t){return this._cache[t]},e.prototype.loadImage=function(t){return ml(this,void 0,void 0,function(){var r,a,s,n,o=this;return tl(this,function(c){switch(c.label){case 0:return r=rT.isSameOrigin(t),a=!jv(t)&&this._options.useCORS===!0&&Di.SUPPORT_CORS_IMAGES&&!r,s=!jv(t)&&!r&&!Uv(t)&&typeof this._options.proxy=="string"&&Di.SUPPORT_CORS_XHR&&!a,!r&&this._options.allowTaint===!1&&!jv(t)&&!Uv(t)&&!s&&!a?[2]:(n=t,s?[4,this.proxy(n)]:[3,2]);case 1:n=c.sent(),c.label=2;case 2:return this.context.logger.debug("Added image "+t.substring(0,256)),[4,new Promise(function(u,f){var h=new Image;h.onload=function(){return u(h)},h.onerror=f,(eJ(n)||a)&&(h.crossOrigin="anonymous"),h.src=n,h.complete===!0&&setTimeout(function(){return u(h)},500),o._options.imageTimeout>0&&setTimeout(function(){return f("Timed out ("+o._options.imageTimeout+"ms) loading image")},o._options.imageTimeout)})];case 3:return[2,c.sent()]}})})},e.prototype.has=function(t){return typeof this._cache[t]<"u"},e.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},e.prototype.proxy=function(t){var r=this,a=this._options.proxy;if(!a)throw new Error("No proxy defined");var s=t.substring(0,256);return new Promise(function(n,o){var c=Di.SUPPORT_RESPONSE_TYPE?"blob":"text",u=new XMLHttpRequest;u.onload=function(){if(u.status===200)if(c==="text")n(u.response);else{var g=new FileReader;g.addEventListener("load",function(){return n(g.result)},!1),g.addEventListener("error",function(x){return o(x)},!1),g.readAsDataURL(u.response)}else o("Failed to proxy resource "+s+" with status code "+u.status)},u.onerror=o;var f=a.indexOf("?")>-1?"&":"?";if(u.open("GET",""+a+f+"url="+encodeURIComponent(t)+"&responseType="+c),c!=="text"&&u instanceof XMLHttpRequest&&(u.responseType=c),r._options.imageTimeout){var h=r._options.imageTimeout;u.timeout=h,u.ontimeout=function(){return o("Timed out ("+h+"ms) proxying "+s)}}u.send()})},e})(),XY=/^data:image\/svg\+xml/i,YY=/^data:image\/.*;base64,/i,JY=/^data:image\/.*/i,ZY=function(e){return Di.SUPPORT_SVG_DRAWING||!tJ(e)},jv=function(e){return JY.test(e)},eJ=function(e){return YY.test(e)},Uv=function(e){return e.substr(0,4)==="blob"},tJ=function(e){return e.substr(-3).toLowerCase()==="svg"||XY.test(e)},ar=(function(){function e(t,r){this.type=0,this.x=t,this.y=r}return e.prototype.add=function(t,r){return new e(this.x+t,this.y+r)},e})(),Jd=function(e,t,r){return new ar(e.x+(t.x-e.x)*r,e.y+(t.y-e.y)*r)},Tm=(function(){function e(t,r,a,s){this.type=1,this.start=t,this.startControl=r,this.endControl=a,this.end=s}return e.prototype.subdivide=function(t,r){var a=Jd(this.start,this.startControl,t),s=Jd(this.startControl,this.endControl,t),n=Jd(this.endControl,this.end,t),o=Jd(a,s,t),c=Jd(s,n,t),u=Jd(o,c,t);return r?new e(this.start,a,o,u):new e(u,c,n,this.end)},e.prototype.add=function(t,r){return new e(this.start.add(t,r),this.startControl.add(t,r),this.endControl.add(t,r),this.end.add(t,r))},e.prototype.reverse=function(){return new e(this.end,this.endControl,this.startControl,this.start)},e})(),Xo=function(e){return e.type===1},rJ=(function(){function e(t){var r=t.styles,a=t.bounds,s=$h(r.borderTopLeftRadius,a.width,a.height),n=s[0],o=s[1],c=$h(r.borderTopRightRadius,a.width,a.height),u=c[0],f=c[1],h=$h(r.borderBottomRightRadius,a.width,a.height),g=h[0],x=h[1],m=$h(r.borderBottomLeftRadius,a.width,a.height),w=m[0],v=m[1],B=[];B.push((n+u)/a.width),B.push((w+g)/a.width),B.push((o+v)/a.height),B.push((f+x)/a.height);var k=Math.max.apply(Math,B);k>1&&(n/=k,o/=k,u/=k,f/=k,g/=k,x/=k,w/=k,v/=k);var E=a.width-u,S=a.height-x,L=a.width-g,P=a.height-v,R=r.borderTopWidth,Q=r.borderRightWidth,V=r.borderBottomWidth,U=r.borderLeftWidth,M=xs(r.paddingTop,t.bounds.width),T=xs(r.paddingRight,t.bounds.width),D=xs(r.paddingBottom,t.bounds.width),G=xs(r.paddingLeft,t.bounds.width);this.topLeftBorderDoubleOuterBox=n>0||o>0?Ms(a.left+U/3,a.top+R/3,n-U/3,o-R/3,qa.TOP_LEFT):new ar(a.left+U/3,a.top+R/3),this.topRightBorderDoubleOuterBox=n>0||o>0?Ms(a.left+E,a.top+R/3,u-Q/3,f-R/3,qa.TOP_RIGHT):new ar(a.left+a.width-Q/3,a.top+R/3),this.bottomRightBorderDoubleOuterBox=g>0||x>0?Ms(a.left+L,a.top+S,g-Q/3,x-V/3,qa.BOTTOM_RIGHT):new ar(a.left+a.width-Q/3,a.top+a.height-V/3),this.bottomLeftBorderDoubleOuterBox=w>0||v>0?Ms(a.left+U/3,a.top+P,w-U/3,v-V/3,qa.BOTTOM_LEFT):new ar(a.left+U/3,a.top+a.height-V/3),this.topLeftBorderDoubleInnerBox=n>0||o>0?Ms(a.left+U*2/3,a.top+R*2/3,n-U*2/3,o-R*2/3,qa.TOP_LEFT):new ar(a.left+U*2/3,a.top+R*2/3),this.topRightBorderDoubleInnerBox=n>0||o>0?Ms(a.left+E,a.top+R*2/3,u-Q*2/3,f-R*2/3,qa.TOP_RIGHT):new ar(a.left+a.width-Q*2/3,a.top+R*2/3),this.bottomRightBorderDoubleInnerBox=g>0||x>0?Ms(a.left+L,a.top+S,g-Q*2/3,x-V*2/3,qa.BOTTOM_RIGHT):new ar(a.left+a.width-Q*2/3,a.top+a.height-V*2/3),this.bottomLeftBorderDoubleInnerBox=w>0||v>0?Ms(a.left+U*2/3,a.top+P,w-U*2/3,v-V*2/3,qa.BOTTOM_LEFT):new ar(a.left+U*2/3,a.top+a.height-V*2/3),this.topLeftBorderStroke=n>0||o>0?Ms(a.left+U/2,a.top+R/2,n-U/2,o-R/2,qa.TOP_LEFT):new ar(a.left+U/2,a.top+R/2),this.topRightBorderStroke=n>0||o>0?Ms(a.left+E,a.top+R/2,u-Q/2,f-R/2,qa.TOP_RIGHT):new ar(a.left+a.width-Q/2,a.top+R/2),this.bottomRightBorderStroke=g>0||x>0?Ms(a.left+L,a.top+S,g-Q/2,x-V/2,qa.BOTTOM_RIGHT):new ar(a.left+a.width-Q/2,a.top+a.height-V/2),this.bottomLeftBorderStroke=w>0||v>0?Ms(a.left+U/2,a.top+P,w-U/2,v-V/2,qa.BOTTOM_LEFT):new ar(a.left+U/2,a.top+a.height-V/2),this.topLeftBorderBox=n>0||o>0?Ms(a.left,a.top,n,o,qa.TOP_LEFT):new ar(a.left,a.top),this.topRightBorderBox=u>0||f>0?Ms(a.left+E,a.top,u,f,qa.TOP_RIGHT):new ar(a.left+a.width,a.top),this.bottomRightBorderBox=g>0||x>0?Ms(a.left+L,a.top+S,g,x,qa.BOTTOM_RIGHT):new ar(a.left+a.width,a.top+a.height),this.bottomLeftBorderBox=w>0||v>0?Ms(a.left,a.top+P,w,v,qa.BOTTOM_LEFT):new ar(a.left,a.top+a.height),this.topLeftPaddingBox=n>0||o>0?Ms(a.left+U,a.top+R,Math.max(0,n-U),Math.max(0,o-R),qa.TOP_LEFT):new ar(a.left+U,a.top+R),this.topRightPaddingBox=u>0||f>0?Ms(a.left+Math.min(E,a.width-Q),a.top+R,E>a.width+Q?0:Math.max(0,u-Q),Math.max(0,f-R),qa.TOP_RIGHT):new ar(a.left+a.width-Q,a.top+R),this.bottomRightPaddingBox=g>0||x>0?Ms(a.left+Math.min(L,a.width-U),a.top+Math.min(S,a.height-V),Math.max(0,g-Q),Math.max(0,x-V),qa.BOTTOM_RIGHT):new ar(a.left+a.width-Q,a.top+a.height-V),this.bottomLeftPaddingBox=w>0||v>0?Ms(a.left+U,a.top+Math.min(P,a.height-V),Math.max(0,w-U),Math.max(0,v-V),qa.BOTTOM_LEFT):new ar(a.left+U,a.top+a.height-V),this.topLeftContentBox=n>0||o>0?Ms(a.left+U+G,a.top+R+M,Math.max(0,n-(U+G)),Math.max(0,o-(R+M)),qa.TOP_LEFT):new ar(a.left+U+G,a.top+R+M),this.topRightContentBox=u>0||f>0?Ms(a.left+Math.min(E,a.width+U+G),a.top+R+M,E>a.width+U+G?0:u-U+G,f-(R+M),qa.TOP_RIGHT):new ar(a.left+a.width-(Q+T),a.top+R+M),this.bottomRightContentBox=g>0||x>0?Ms(a.left+Math.min(L,a.width-(U+G)),a.top+Math.min(S,a.height+R+M),Math.max(0,g-(Q+T)),x-(V+D),qa.BOTTOM_RIGHT):new ar(a.left+a.width-(Q+T),a.top+a.height-(V+D)),this.bottomLeftContentBox=w>0||v>0?Ms(a.left+U+G,a.top+P,Math.max(0,w-(U+G)),v-(V+D),qa.BOTTOM_LEFT):new ar(a.left+U+G,a.top+a.height-(V+D))}return e})(),qa;(function(e){e[e.TOP_LEFT=0]="TOP_LEFT",e[e.TOP_RIGHT=1]="TOP_RIGHT",e[e.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",e[e.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(qa||(qa={}));var Ms=function(e,t,r,a,s){var n=4*((Math.sqrt(2)-1)/3),o=r*n,c=a*n,u=e+r,f=t+a;switch(s){case qa.TOP_LEFT:return new Tm(new ar(e,f),new ar(e,f-c),new ar(u-o,t),new ar(u,t));case qa.TOP_RIGHT:return new Tm(new ar(e,t),new ar(e+o,t),new ar(u,f-c),new ar(u,f));case qa.BOTTOM_RIGHT:return new Tm(new ar(u,t),new ar(u,t+c),new ar(e+o,f),new ar(e,f));case qa.BOTTOM_LEFT:default:return new Tm(new ar(u,f),new ar(u-o,f),new ar(e,t+c),new ar(e,t))}},Rx=function(e){return[e.topLeftBorderBox,e.topRightBorderBox,e.bottomRightBorderBox,e.bottomLeftBorderBox]},aJ=function(e){return[e.topLeftContentBox,e.topRightContentBox,e.bottomRightContentBox,e.bottomLeftContentBox]},Mx=function(e){return[e.topLeftPaddingBox,e.topRightPaddingBox,e.bottomRightPaddingBox,e.bottomLeftPaddingBox]},sJ=(function(){function e(t,r,a){this.offsetX=t,this.offsetY=r,this.matrix=a,this.type=0,this.target=6}return e})(),Lm=(function(){function e(t,r){this.path=t,this.target=r,this.type=1}return e})(),nJ=(function(){function e(t){this.opacity=t,this.type=2,this.target=6}return e})(),iJ=function(e){return e.type===0},aT=function(e){return e.type===1},lJ=function(e){return e.type===2},lC=function(e,t){return e.length===t.length?e.some(function(r,a){return r===t[a]}):!1},oJ=function(e,t,r,a,s){return e.map(function(n,o){switch(o){case 0:return n.add(t,r);case 1:return n.add(t+a,r);case 2:return n.add(t+a,r+s);case 3:return n.add(t,r+s)}return n})},sT=(function(){function e(t){this.element=t,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return e})(),nT=(function(){function e(t,r){if(this.container=t,this.parent=r,this.effects=[],this.curves=new rJ(this.container),this.container.styles.opacity<1&&this.effects.push(new nJ(this.container.styles.opacity)),this.container.styles.transform!==null){var a=this.container.bounds.left+this.container.styles.transformOrigin[0].number,s=this.container.bounds.top+this.container.styles.transformOrigin[1].number,n=this.container.styles.transform;this.effects.push(new sJ(a,s,n))}if(this.container.styles.overflowX!==0){var o=Rx(this.curves),c=Mx(this.curves);lC(o,c)?this.effects.push(new Lm(o,6)):(this.effects.push(new Lm(o,2)),this.effects.push(new Lm(c,4)))}}return e.prototype.getEffects=function(t){for(var r=[2,3].indexOf(this.container.styles.position)===-1,a=this.parent,s=this.effects.slice(0);a;){var n=a.effects.filter(function(u){return!aT(u)});if(r||a.container.styles.position!==0||!a.parent){if(s.unshift.apply(s,n),r=[2,3].indexOf(a.container.styles.position)===-1,a.container.styles.overflowX!==0){var o=Rx(a.curves),c=Mx(a.curves);lC(o,c)||s.unshift(new Lm(c,6))}}else s.unshift.apply(s,n);a=a.parent}return s.filter(function(u){return oi(u.target,t)})},e})(),r2=function(e,t,r,a){e.container.elements.forEach(function(s){var n=oi(s.flags,4),o=oi(s.flags,2),c=new nT(s,e);oi(s.styles.display,2048)&&a.push(c);var u=oi(s.flags,8)?[]:a;if(n||o){var f=n||s.styles.isPositioned()?r:t,h=new sT(c);if(s.styles.isPositioned()||s.styles.opacity<1||s.styles.isTransformed()){var g=s.styles.zIndex.order;if(g<0){var x=0;f.negativeZIndex.some(function(w,v){return g>w.element.container.styles.zIndex.order?(x=v,!1):x>0}),f.negativeZIndex.splice(x,0,h)}else if(g>0){var m=0;f.positiveZIndex.some(function(w,v){return g>=w.element.container.styles.zIndex.order?(m=v+1,!1):m>0}),f.positiveZIndex.splice(m,0,h)}else f.zeroOrAutoZIndexOrTransformedOrOpacity.push(h)}else s.styles.isFloating()?f.nonPositionedFloats.push(h):f.nonPositionedInlineLevel.push(h);r2(c,h,n?h:r,u)}else s.styles.isInlineLevel()?t.inlineLevel.push(c):t.nonInlineLevel.push(c),r2(c,t,r,u);oi(s.flags,8)&&iT(s,u)})},iT=function(e,t){for(var r=e instanceof Yw?e.start:1,a=e instanceof Yw?e.reversed:!1,s=0;s<t.length;s++){var n=t[s];n.container instanceof qF&&typeof n.container.value=="number"&&n.container.value!==0&&(r=n.container.value),n.listValue=Hp(r,n.container.styles.listStyleType,!0),r+=a?-1:1}},AJ=function(e){var t=new nT(e,null),r=new sT(t),a=[];return r2(t,r,r,a),iT(t.container,a),r},oC=function(e,t){switch(t){case 0:return Jo(e.topLeftBorderBox,e.topLeftPaddingBox,e.topRightBorderBox,e.topRightPaddingBox);case 1:return Jo(e.topRightBorderBox,e.topRightPaddingBox,e.bottomRightBorderBox,e.bottomRightPaddingBox);case 2:return Jo(e.bottomRightBorderBox,e.bottomRightPaddingBox,e.bottomLeftBorderBox,e.bottomLeftPaddingBox);default:return Jo(e.bottomLeftBorderBox,e.bottomLeftPaddingBox,e.topLeftBorderBox,e.topLeftPaddingBox)}},cJ=function(e,t){switch(t){case 0:return Jo(e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox,e.topRightBorderBox,e.topRightBorderDoubleOuterBox);case 1:return Jo(e.topRightBorderBox,e.topRightBorderDoubleOuterBox,e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox);case 2:return Jo(e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox,e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox);default:return Jo(e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox,e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox)}},uJ=function(e,t){switch(t){case 0:return Jo(e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox,e.topRightBorderDoubleInnerBox,e.topRightPaddingBox);case 1:return Jo(e.topRightBorderDoubleInnerBox,e.topRightPaddingBox,e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox);case 2:return Jo(e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox,e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox);default:return Jo(e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox,e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox)}},dJ=function(e,t){switch(t){case 0:return jm(e.topLeftBorderStroke,e.topRightBorderStroke);case 1:return jm(e.topRightBorderStroke,e.bottomRightBorderStroke);case 2:return jm(e.bottomRightBorderStroke,e.bottomLeftBorderStroke);default:return jm(e.bottomLeftBorderStroke,e.topLeftBorderStroke)}},jm=function(e,t){var r=[];return Xo(e)?r.push(e.subdivide(.5,!1)):r.push(e),Xo(t)?r.push(t.subdivide(.5,!0)):r.push(t),r},Jo=function(e,t,r,a){var s=[];return Xo(e)?s.push(e.subdivide(.5,!1)):s.push(e),Xo(r)?s.push(r.subdivide(.5,!0)):s.push(r),Xo(a)?s.push(a.subdivide(.5,!0).reverse()):s.push(a),Xo(t)?s.push(t.subdivide(.5,!1).reverse()):s.push(t),s},lT=function(e){var t=e.bounds,r=e.styles;return t.add(r.borderLeftWidth,r.borderTopWidth,-(r.borderRightWidth+r.borderLeftWidth),-(r.borderTopWidth+r.borderBottomWidth))},Hx=function(e){var t=e.styles,r=e.bounds,a=xs(t.paddingLeft,r.width),s=xs(t.paddingRight,r.width),n=xs(t.paddingTop,r.width),o=xs(t.paddingBottom,r.width);return r.add(a+t.borderLeftWidth,n+t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth+a+s),-(t.borderTopWidth+t.borderBottomWidth+n+o))},fJ=function(e,t){return e===0?t.bounds:e===2?Hx(t):lT(t)},hJ=function(e,t){return e===0?t.bounds:e===2?Hx(t):lT(t)},Dv=function(e,t,r){var a=fJ(cf(e.styles.backgroundOrigin,t),e),s=hJ(cf(e.styles.backgroundClip,t),e),n=pJ(cf(e.styles.backgroundSize,t),r,a),o=n[0],c=n[1],u=$h(cf(e.styles.backgroundPosition,t),a.width-o,a.height-c),f=gJ(cf(e.styles.backgroundRepeat,t),u,n,a,s),h=Math.round(a.left+u[0]),g=Math.round(a.top+u[1]);return[f,h,g,o,c]},Zd=function(e){return ns(e)&&e.value===kf.AUTO},Um=function(e){return typeof e=="number"},pJ=function(e,t,r){var a=t[0],s=t[1],n=t[2],o=e[0],c=e[1];if(!o)return[0,0];if(Kn(o)&&c&&Kn(c))return[xs(o,r.width),xs(c,r.height)];var u=Um(n);if(ns(o)&&(o.value===kf.CONTAIN||o.value===kf.COVER)){if(Um(n)){var f=r.width/r.height;return f<n!=(o.value===kf.COVER)?[r.width,r.width/n]:[r.height*n,r.height]}return[r.width,r.height]}var h=Um(a),g=Um(s),x=h||g;if(Zd(o)&&(!c||Zd(c))){if(h&&g)return[a,s];if(!u&&!x)return[r.width,r.height];if(x&&u){var m=h?a:s*n,w=g?s:a/n;return[m,w]}var v=h?a:r.width,B=g?s:r.height;return[v,B]}if(u){var k=0,E=0;return Kn(o)?k=xs(o,r.width):Kn(c)&&(E=xs(c,r.height)),Zd(o)?k=E*n:(!c||Zd(c))&&(E=k/n),[k,E]}var S=null,L=null;if(Kn(o)?S=xs(o,r.width):c&&Kn(c)&&(L=xs(c,r.height)),S!==null&&(!c||Zd(c))&&(L=h&&g?S/a*s:r.height),L!==null&&Zd(o)&&(S=h&&g?L/s*a:r.width),S!==null&&L!==null)return[S,L];throw new Error("Unable to calculate background-size for element")},cf=function(e,t){var r=e[t];return typeof r>"u"?e[0]:r},gJ=function(e,t,r,a,s){var n=t[0],o=t[1],c=r[0],u=r[1];switch(e){case 2:return[new ar(Math.round(a.left),Math.round(a.top+o)),new ar(Math.round(a.left+a.width),Math.round(a.top+o)),new ar(Math.round(a.left+a.width),Math.round(u+a.top+o)),new ar(Math.round(a.left),Math.round(u+a.top+o))];case 3:return[new ar(Math.round(a.left+n),Math.round(a.top)),new ar(Math.round(a.left+n+c),Math.round(a.top)),new ar(Math.round(a.left+n+c),Math.round(a.height+a.top)),new ar(Math.round(a.left+n),Math.round(a.height+a.top))];case 1:return[new ar(Math.round(a.left+n),Math.round(a.top+o)),new ar(Math.round(a.left+n+c),Math.round(a.top+o)),new ar(Math.round(a.left+n+c),Math.round(a.top+o+u)),new ar(Math.round(a.left+n),Math.round(a.top+o+u))];default:return[new ar(Math.round(s.left),Math.round(s.top)),new ar(Math.round(s.left+s.width),Math.round(s.top)),new ar(Math.round(s.left+s.width),Math.round(s.height+s.top)),new ar(Math.round(s.left),Math.round(s.height+s.top))]}},mJ="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",AC="Hidden Text",xJ=(function(){function e(t){this._data={},this._document=t}return e.prototype.parseMetrics=function(t,r){var a=this._document.createElement("div"),s=this._document.createElement("img"),n=this._document.createElement("span"),o=this._document.body;a.style.visibility="hidden",a.style.fontFamily=t,a.style.fontSize=r,a.style.margin="0",a.style.padding="0",a.style.whiteSpace="nowrap",o.appendChild(a),s.src=mJ,s.width=1,s.height=1,s.style.margin="0",s.style.padding="0",s.style.verticalAlign="baseline",n.style.fontFamily=t,n.style.fontSize=r,n.style.margin="0",n.style.padding="0",n.appendChild(this._document.createTextNode(AC)),a.appendChild(n),a.appendChild(s);var c=s.offsetTop-n.offsetTop+2;a.removeChild(n),a.appendChild(this._document.createTextNode(AC)),a.style.lineHeight="normal",s.style.verticalAlign="super";var u=s.offsetTop-a.offsetTop+2;return o.removeChild(a),{baseline:c,middle:u}},e.prototype.getMetrics=function(t,r){var a=t+" "+r;return typeof this._data[a]>"u"&&(this._data[a]=this.parseMetrics(t,r)),this._data[a]},e})(),oT=(function(){function e(t,r){this.context=t,this.options=r}return e})(),bJ=1e4,vJ=(function(e){DA(t,e);function t(r,a){var s=e.call(this,r,a)||this;return s._activeEffects=[],s.canvas=a.canvas?a.canvas:document.createElement("canvas"),s.ctx=s.canvas.getContext("2d"),a.canvas||(s.canvas.width=Math.floor(a.width*a.scale),s.canvas.height=Math.floor(a.height*a.scale),s.canvas.style.width=a.width+"px",s.canvas.style.height=a.height+"px"),s.fontMetrics=new xJ(document),s.ctx.scale(s.options.scale,s.options.scale),s.ctx.translate(-a.x,-a.y),s.ctx.textBaseline="bottom",s._activeEffects=[],s.context.logger.debug("Canvas renderer initialized ("+a.width+"x"+a.height+") with scale "+a.scale),s}return t.prototype.applyEffects=function(r){for(var a=this;this._activeEffects.length;)this.popEffect();r.forEach(function(s){return a.applyEffect(s)})},t.prototype.applyEffect=function(r){this.ctx.save(),lJ(r)&&(this.ctx.globalAlpha=r.opacity),iJ(r)&&(this.ctx.translate(r.offsetX,r.offsetY),this.ctx.transform(r.matrix[0],r.matrix[1],r.matrix[2],r.matrix[3],r.matrix[4],r.matrix[5]),this.ctx.translate(-r.offsetX,-r.offsetY)),aT(r)&&(this.path(r.path),this.ctx.clip()),this._activeEffects.push(r)},t.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},t.prototype.renderStack=function(r){return ml(this,void 0,void 0,function(){var a;return tl(this,function(s){switch(s.label){case 0:return a=r.element.container.styles,a.isVisible()?[4,this.renderStackContent(r)]:[3,2];case 1:s.sent(),s.label=2;case 2:return[2]}})})},t.prototype.renderNode=function(r){return ml(this,void 0,void 0,function(){return tl(this,function(a){switch(a.label){case 0:if(oi(r.container.flags,16))debugger;return r.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(r)]:[3,3];case 1:return a.sent(),[4,this.renderNodeContent(r)];case 2:a.sent(),a.label=3;case 3:return[2]}})})},t.prototype.renderTextWithLetterSpacing=function(r,a,s){var n=this;if(a===0)this.ctx.fillText(r.text,r.bounds.left,r.bounds.top+s);else{var o=S_(r.text);o.reduce(function(c,u){return n.ctx.fillText(u,c,r.bounds.top+s),c+n.ctx.measureText(u).width},r.bounds.left)}},t.prototype.createFontStyle=function(r){var a=r.fontVariant.filter(function(o){return o==="normal"||o==="small-caps"}).join(""),s=BJ(r.fontFamily).join(", "),n=ag(r.fontSize)?""+r.fontSize.number+r.fontSize.unit:r.fontSize.number+"px";return[[r.fontStyle,a,r.fontWeight,n,s].join(" "),s,n]},t.prototype.renderTextNode=function(r,a){return ml(this,void 0,void 0,function(){var s,n,o,c,u,f,h,g,x=this;return tl(this,function(m){return s=this.createFontStyle(a),n=s[0],o=s[1],c=s[2],this.ctx.font=n,this.ctx.direction=a.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",u=this.fontMetrics.getMetrics(o,c),f=u.baseline,h=u.middle,g=a.paintOrder,r.textBounds.forEach(function(w){g.forEach(function(v){switch(v){case 0:x.ctx.fillStyle=bi(a.color),x.renderTextWithLetterSpacing(w,a.letterSpacing,f);var B=a.textShadow;B.length&&w.text.trim().length&&(B.slice(0).reverse().forEach(function(k){x.ctx.shadowColor=bi(k.color),x.ctx.shadowOffsetX=k.offsetX.number*x.options.scale,x.ctx.shadowOffsetY=k.offsetY.number*x.options.scale,x.ctx.shadowBlur=k.blur.number,x.renderTextWithLetterSpacing(w,a.letterSpacing,f)}),x.ctx.shadowColor="",x.ctx.shadowOffsetX=0,x.ctx.shadowOffsetY=0,x.ctx.shadowBlur=0),a.textDecorationLine.length&&(x.ctx.fillStyle=bi(a.textDecorationColor||a.color),a.textDecorationLine.forEach(function(k){switch(k){case 1:x.ctx.fillRect(w.bounds.left,Math.round(w.bounds.top+f),w.bounds.width,1);break;case 2:x.ctx.fillRect(w.bounds.left,Math.round(w.bounds.top),w.bounds.width,1);break;case 3:x.ctx.fillRect(w.bounds.left,Math.ceil(w.bounds.top+h),w.bounds.width,1);break}}));break;case 1:a.webkitTextStrokeWidth&&w.text.trim().length&&(x.ctx.strokeStyle=bi(a.webkitTextStrokeColor),x.ctx.lineWidth=a.webkitTextStrokeWidth,x.ctx.lineJoin=window.chrome?"miter":"round",x.ctx.strokeText(w.text,w.bounds.left,w.bounds.top+f)),x.ctx.strokeStyle="",x.ctx.lineWidth=0,x.ctx.lineJoin="miter";break}})}),[2]})})},t.prototype.renderReplacedElement=function(r,a,s){if(s&&r.intrinsicWidth>0&&r.intrinsicHeight>0){var n=Hx(r),o=Mx(a);this.path(o),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(s,0,0,r.intrinsicWidth,r.intrinsicHeight,n.left,n.top,n.width,n.height),this.ctx.restore()}},t.prototype.renderNodeContent=function(r){return ml(this,void 0,void 0,function(){var a,s,n,o,c,u,E,E,f,h,g,x,L,m,w,P,v,B,k,E,S,L,P;return tl(this,function(R){switch(R.label){case 0:this.applyEffects(r.getEffects(4)),a=r.container,s=r.curves,n=a.styles,o=0,c=a.textNodes,R.label=1;case 1:return o<c.length?(u=c[o],[4,this.renderTextNode(u,n)]):[3,4];case 2:R.sent(),R.label=3;case 3:return o++,[3,1];case 4:if(!(a instanceof MF))return[3,8];R.label=5;case 5:return R.trys.push([5,7,,8]),[4,this.context.cache.match(a.src)];case 6:return E=R.sent(),this.renderReplacedElement(a,s,E),[3,8];case 7:return R.sent(),this.context.logger.error("Error loading image "+a.src),[3,8];case 8:if(a instanceof HF&&this.renderReplacedElement(a,s,a.canvas),!(a instanceof PF))return[3,12];R.label=9;case 9:return R.trys.push([9,11,,12]),[4,this.context.cache.match(a.svg)];case 10:return E=R.sent(),this.renderReplacedElement(a,s,E),[3,12];case 11:return R.sent(),this.context.logger.error("Error loading svg "+a.svg.substring(0,255)),[3,12];case 12:return a instanceof VF&&a.tree?(f=new t(this.context,{scale:this.options.scale,backgroundColor:a.backgroundColor,x:0,y:0,width:a.width,height:a.height}),[4,f.render(a.tree)]):[3,14];case 13:h=R.sent(),a.width&&a.height&&this.ctx.drawImage(h,0,0,a.width,a.height,a.bounds.left,a.bounds.top,a.bounds.width,a.bounds.height),R.label=14;case 14:if(a instanceof N_&&(g=Math.min(a.bounds.width,a.bounds.height),a.type===Dx?a.checked&&(this.ctx.save(),this.path([new ar(a.bounds.left+g*.39363,a.bounds.top+g*.79),new ar(a.bounds.left+g*.16,a.bounds.top+g*.5549),new ar(a.bounds.left+g*.27347,a.bounds.top+g*.44071),new ar(a.bounds.left+g*.39694,a.bounds.top+g*.5649),new ar(a.bounds.left+g*.72983,a.bounds.top+g*.23),new ar(a.bounds.left+g*.84,a.bounds.top+g*.34085),new ar(a.bounds.left+g*.39363,a.bounds.top+g*.79)]),this.ctx.fillStyle=bi(XB),this.ctx.fill(),this.ctx.restore()):a.type===Ix&&a.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(a.bounds.left+g/2,a.bounds.top+g/2,g/4,0,Math.PI*2,!0),this.ctx.fillStyle=bi(XB),this.ctx.fill(),this.ctx.restore())),wJ(a)&&a.value.length){switch(x=this.createFontStyle(n),L=x[0],m=x[1],w=this.fontMetrics.getMetrics(L,m).baseline,this.ctx.font=L,this.ctx.fillStyle=bi(n.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=yJ(a.styles.textAlign),P=Hx(a),v=0,a.styles.textAlign){case 1:v+=P.width/2;break;case 2:v+=P.width;break}B=P.add(v,0,0,-P.height/2+1),this.ctx.save(),this.path([new ar(P.left,P.top),new ar(P.left+P.width,P.top),new ar(P.left+P.width,P.top+P.height),new ar(P.left,P.top+P.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new hp(a.value,B),n.letterSpacing,w),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!oi(a.styles.display,2048))return[3,20];if(a.styles.listStyleImage===null)return[3,19];if(k=a.styles.listStyleImage,k.type!==0)return[3,18];E=void 0,S=k.url,R.label=15;case 15:return R.trys.push([15,17,,18]),[4,this.context.cache.match(S)];case 16:return E=R.sent(),this.ctx.drawImage(E,a.bounds.left-(E.width+10),a.bounds.top),[3,18];case 17:return R.sent(),this.context.logger.error("Error loading list-style-image "+S),[3,18];case 18:return[3,20];case 19:r.listValue&&a.styles.listStyleType!==-1&&(L=this.createFontStyle(n)[0],this.ctx.font=L,this.ctx.fillStyle=bi(n.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",P=new ou(a.bounds.left,a.bounds.top+xs(a.styles.paddingTop,a.bounds.width),a.bounds.width,jB(n.lineHeight,n.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new hp(r.listValue,P),n.letterSpacing,jB(n.lineHeight,n.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),R.label=20;case 20:return[2]}})})},t.prototype.renderStackContent=function(r){return ml(this,void 0,void 0,function(){var a,s,k,n,o,k,c,u,k,f,h,k,g,x,k,m,w,k,v,B,k;return tl(this,function(E){switch(E.label){case 0:if(oi(r.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(r.element)];case 1:E.sent(),a=0,s=r.negativeZIndex,E.label=2;case 2:return a<s.length?(k=s[a],[4,this.renderStack(k)]):[3,5];case 3:E.sent(),E.label=4;case 4:return a++,[3,2];case 5:return[4,this.renderNodeContent(r.element)];case 6:E.sent(),n=0,o=r.nonInlineLevel,E.label=7;case 7:return n<o.length?(k=o[n],[4,this.renderNode(k)]):[3,10];case 8:E.sent(),E.label=9;case 9:return n++,[3,7];case 10:c=0,u=r.nonPositionedFloats,E.label=11;case 11:return c<u.length?(k=u[c],[4,this.renderStack(k)]):[3,14];case 12:E.sent(),E.label=13;case 13:return c++,[3,11];case 14:f=0,h=r.nonPositionedInlineLevel,E.label=15;case 15:return f<h.length?(k=h[f],[4,this.renderStack(k)]):[3,18];case 16:E.sent(),E.label=17;case 17:return f++,[3,15];case 18:g=0,x=r.inlineLevel,E.label=19;case 19:return g<x.length?(k=x[g],[4,this.renderNode(k)]):[3,22];case 20:E.sent(),E.label=21;case 21:return g++,[3,19];case 22:m=0,w=r.zeroOrAutoZIndexOrTransformedOrOpacity,E.label=23;case 23:return m<w.length?(k=w[m],[4,this.renderStack(k)]):[3,26];case 24:E.sent(),E.label=25;case 25:return m++,[3,23];case 26:v=0,B=r.positiveZIndex,E.label=27;case 27:return v<B.length?(k=B[v],[4,this.renderStack(k)]):[3,30];case 28:E.sent(),E.label=29;case 29:return v++,[3,27];case 30:return[2]}})})},t.prototype.mask=function(r){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(r.slice(0).reverse()),this.ctx.closePath()},t.prototype.path=function(r){this.ctx.beginPath(),this.formatPath(r),this.ctx.closePath()},t.prototype.formatPath=function(r){var a=this;r.forEach(function(s,n){var o=Xo(s)?s.start:s;n===0?a.ctx.moveTo(o.x,o.y):a.ctx.lineTo(o.x,o.y),Xo(s)&&a.ctx.bezierCurveTo(s.startControl.x,s.startControl.y,s.endControl.x,s.endControl.y,s.end.x,s.end.y)})},t.prototype.renderRepeat=function(r,a,s,n){this.path(r),this.ctx.fillStyle=a,this.ctx.translate(s,n),this.ctx.fill(),this.ctx.translate(-s,-n)},t.prototype.resizeImage=function(r,a,s){var n;if(r.width===a&&r.height===s)return r;var o=(n=this.canvas.ownerDocument)!==null&&n!==void 0?n:document,c=o.createElement("canvas");c.width=Math.max(1,a),c.height=Math.max(1,s);var u=c.getContext("2d");return u.drawImage(r,0,0,r.width,r.height,0,0,a,s),c},t.prototype.renderBackgroundImage=function(r){return ml(this,void 0,void 0,function(){var a,s,n,o,c,u;return tl(this,function(f){switch(f.label){case 0:a=r.styles.backgroundImage.length-1,s=function(h){var g,x,m,M,ee,le,G,ne,V,w,M,ee,le,G,ne,v,B,k,E,S,L,P,R,Q,V,U,M,T,D,G,ne,H,ee,le,pe,te,Le,je,F,K,I,q;return tl(this,function(J){switch(J.label){case 0:if(h.type!==0)return[3,5];g=void 0,x=h.url,J.label=1;case 1:return J.trys.push([1,3,,4]),[4,n.context.cache.match(x)];case 2:return g=J.sent(),[3,4];case 3:return J.sent(),n.context.logger.error("Error loading background-image "+x),[3,4];case 4:return g&&(m=Dv(r,a,[g.width,g.height,g.width/g.height]),M=m[0],ee=m[1],le=m[2],G=m[3],ne=m[4],V=n.ctx.createPattern(n.resizeImage(g,G,ne),"repeat"),n.renderRepeat(M,V,ee,le)),[3,6];case 5:i$(h)?(w=Dv(r,a,[null,null,null]),M=w[0],ee=w[1],le=w[2],G=w[3],ne=w[4],v=t$(h.angle,G,ne),B=v[0],k=v[1],E=v[2],S=v[3],L=v[4],P=document.createElement("canvas"),P.width=G,P.height=ne,R=P.getContext("2d"),Q=R.createLinearGradient(k,S,E,L),TB(h.stops,B).forEach(function(Y){return Q.addColorStop(Y.stop,bi(Y.color))}),R.fillStyle=Q,R.fillRect(0,0,G,ne),G>0&&ne>0&&(V=n.ctx.createPattern(P,"repeat"),n.renderRepeat(M,V,ee,le))):l$(h)&&(U=Dv(r,a,[null,null,null]),M=U[0],T=U[1],D=U[2],G=U[3],ne=U[4],H=h.position.length===0?[k_]:h.position,ee=xs(H[0],G),le=xs(H[H.length-1],ne),pe=r$(h,ee,le,G,ne),te=pe[0],Le=pe[1],te>0&&Le>0&&(je=n.ctx.createRadialGradient(T+ee,D+le,0,T+ee,D+le,te),TB(h.stops,te*2).forEach(function(Y){return je.addColorStop(Y.stop,bi(Y.color))}),n.path(M),n.ctx.fillStyle=je,te!==Le?(F=r.bounds.left+.5*r.bounds.width,K=r.bounds.top+.5*r.bounds.height,I=Le/te,q=1/I,n.ctx.save(),n.ctx.translate(F,K),n.ctx.transform(1,0,0,I,0,0),n.ctx.translate(-F,-K),n.ctx.fillRect(T,q*(D-K)+K,G,ne*q),n.ctx.restore()):n.ctx.fill())),J.label=6;case 6:return a--,[2]}})},n=this,o=0,c=r.styles.backgroundImage.slice(0).reverse(),f.label=1;case 1:return o<c.length?(u=c[o],[5,s(u)]):[3,4];case 2:f.sent(),f.label=3;case 3:return o++,[3,1];case 4:return[2]}})})},t.prototype.renderSolidBorder=function(r,a,s){return ml(this,void 0,void 0,function(){return tl(this,function(n){return this.path(oC(s,a)),this.ctx.fillStyle=bi(r),this.ctx.fill(),[2]})})},t.prototype.renderDoubleBorder=function(r,a,s,n){return ml(this,void 0,void 0,function(){var o,c;return tl(this,function(u){switch(u.label){case 0:return a<3?[4,this.renderSolidBorder(r,s,n)]:[3,2];case 1:return u.sent(),[2];case 2:return o=cJ(n,s),this.path(o),this.ctx.fillStyle=bi(r),this.ctx.fill(),c=uJ(n,s),this.path(c),this.ctx.fill(),[2]}})})},t.prototype.renderNodeBackgroundAndBorders=function(r){return ml(this,void 0,void 0,function(){var a,s,n,o,c,u,f,h,g=this;return tl(this,function(x){switch(x.label){case 0:return this.applyEffects(r.getEffects(2)),a=r.container.styles,s=!n0(a.backgroundColor)||a.backgroundImage.length,n=[{style:a.borderTopStyle,color:a.borderTopColor,width:a.borderTopWidth},{style:a.borderRightStyle,color:a.borderRightColor,width:a.borderRightWidth},{style:a.borderBottomStyle,color:a.borderBottomColor,width:a.borderBottomWidth},{style:a.borderLeftStyle,color:a.borderLeftColor,width:a.borderLeftWidth}],o=_J(cf(a.backgroundClip,0),r.curves),s||a.boxShadow.length?(this.ctx.save(),this.path(o),this.ctx.clip(),n0(a.backgroundColor)||(this.ctx.fillStyle=bi(a.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(r.container)]):[3,2];case 1:x.sent(),this.ctx.restore(),a.boxShadow.slice(0).reverse().forEach(function(m){g.ctx.save();var w=Rx(r.curves),v=m.inset?0:bJ,B=oJ(w,-v+(m.inset?1:-1)*m.spread.number,(m.inset?1:-1)*m.spread.number,m.spread.number*(m.inset?-2:2),m.spread.number*(m.inset?-2:2));m.inset?(g.path(w),g.ctx.clip(),g.mask(B)):(g.mask(w),g.ctx.clip(),g.path(B)),g.ctx.shadowOffsetX=m.offsetX.number+v,g.ctx.shadowOffsetY=m.offsetY.number,g.ctx.shadowColor=bi(m.color),g.ctx.shadowBlur=m.blur.number,g.ctx.fillStyle=m.inset?bi(m.color):"rgba(0,0,0,1)",g.ctx.fill(),g.ctx.restore()}),x.label=2;case 2:c=0,u=0,f=n,x.label=3;case 3:return u<f.length?(h=f[u],h.style!==0&&!n0(h.color)&&h.width>0?h.style!==2?[3,5]:[4,this.renderDashedDottedBorder(h.color,h.width,c,r.curves,2)]:[3,11]):[3,13];case 4:return x.sent(),[3,11];case 5:return h.style!==3?[3,7]:[4,this.renderDashedDottedBorder(h.color,h.width,c,r.curves,3)];case 6:return x.sent(),[3,11];case 7:return h.style!==4?[3,9]:[4,this.renderDoubleBorder(h.color,h.width,c,r.curves)];case 8:return x.sent(),[3,11];case 9:return[4,this.renderSolidBorder(h.color,c,r.curves)];case 10:x.sent(),x.label=11;case 11:c++,x.label=12;case 12:return u++,[3,3];case 13:return[2]}})})},t.prototype.renderDashedDottedBorder=function(r,a,s,n,o){return ml(this,void 0,void 0,function(){var c,u,f,h,g,x,m,w,v,B,k,E,S,L,P,R,P,R;return tl(this,function(Q){return this.ctx.save(),c=dJ(n,s),u=oC(n,s),o===2&&(this.path(u),this.ctx.clip()),Xo(u[0])?(f=u[0].start.x,h=u[0].start.y):(f=u[0].x,h=u[0].y),Xo(u[1])?(g=u[1].end.x,x=u[1].end.y):(g=u[1].x,x=u[1].y),s===0||s===2?m=Math.abs(f-g):m=Math.abs(h-x),this.ctx.beginPath(),o===3?this.formatPath(c):this.formatPath(u.slice(0,2)),w=a<3?a*3:a*2,v=a<3?a*2:a,o===3&&(w=a,v=a),B=!0,m<=w*2?B=!1:m<=w*2+v?(k=m/(2*w+v),w*=k,v*=k):(E=Math.floor((m+v)/(w+v)),S=(m-E*w)/(E-1),L=(m-(E+1)*w)/E,v=L<=0||Math.abs(v-S)<Math.abs(v-L)?S:L),B&&(o===3?this.ctx.setLineDash([0,w+v]):this.ctx.setLineDash([w,v])),o===3?(this.ctx.lineCap="round",this.ctx.lineWidth=a):this.ctx.lineWidth=a*2+1.1,this.ctx.strokeStyle=bi(r),this.ctx.stroke(),this.ctx.setLineDash([]),o===2&&(Xo(u[0])&&(P=u[3],R=u[0],this.ctx.beginPath(),this.formatPath([new ar(P.end.x,P.end.y),new ar(R.start.x,R.start.y)]),this.ctx.stroke()),Xo(u[1])&&(P=u[1],R=u[2],this.ctx.beginPath(),this.formatPath([new ar(P.end.x,P.end.y),new ar(R.start.x,R.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},t.prototype.render=function(r){return ml(this,void 0,void 0,function(){var a;return tl(this,function(s){switch(s.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=bi(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),a=AJ(r),[4,this.renderStack(a)];case 1:return s.sent(),this.applyEffects([]),[2,this.canvas]}})})},t})(oT),wJ=function(e){return e instanceof zF||e instanceof KF?!0:e instanceof N_&&e.type!==Ix&&e.type!==Dx},_J=function(e,t){switch(e){case 0:return Rx(t);case 2:return aJ(t);default:return Mx(t)}},yJ=function(e){switch(e){case 1:return"center";case 2:return"right";default:return"left"}},kJ=["-apple-system","system-ui"],BJ=function(e){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?e.filter(function(t){return kJ.indexOf(t)===-1}):e},CJ=(function(e){DA(t,e);function t(r,a){var s=e.call(this,r,a)||this;return s.canvas=a.canvas?a.canvas:document.createElement("canvas"),s.ctx=s.canvas.getContext("2d"),s.options=a,s.canvas.width=Math.floor(a.width*a.scale),s.canvas.height=Math.floor(a.height*a.scale),s.canvas.style.width=a.width+"px",s.canvas.style.height=a.height+"px",s.ctx.scale(s.options.scale,s.options.scale),s.ctx.translate(-a.x,-a.y),s.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+a.width+"x"+a.height+" at "+a.x+","+a.y+") with scale "+a.scale),s}return t.prototype.render=function(r){return ml(this,void 0,void 0,function(){var a,s;return tl(this,function(n){switch(n.label){case 0:return a=Xw(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,r),[4,SJ(a)];case 1:return s=n.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=bi(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(s,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},t})(oT),SJ=function(e){return new Promise(function(t,r){var a=new Image;a.onload=function(){t(a)},a.onerror=r,a.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(e))})},NJ=(function(){function e(t){var r=t.id,a=t.enabled;this.id=r,this.enabled=a,this.start=Date.now()}return e.prototype.debug=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,dm([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.prototype.getTime=function(){return Date.now()-this.start},e.prototype.info=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,dm([this.id,this.getTime()+"ms"],t))},e.prototype.warn=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,dm([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.prototype.error=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,dm([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.instances={},e})(),EJ=(function(){function e(t,r){var a;this.windowBounds=r,this.instanceName="#"+e.instanceCount++,this.logger=new NJ({id:this.instanceName,enabled:t.logging}),this.cache=(a=t.cache)!==null&&a!==void 0?a:new $Y(this,t)}return e.instanceCount=1,e})(),a2=function(e,t){return t===void 0&&(t={}),FJ(e,t)};typeof window<"u"&&rT.setContext(window);var FJ=function(e,t){return ml(void 0,void 0,void 0,function(){var r,a,s,n,o,c,u,f,h,g,x,m,w,v,B,k,E,S,L,P,Q,R,Q,V,U,M,T,D,G,ne,H,ee,le,pe,te,Le,je,F,K,I;return tl(this,function(q){switch(q.label){case 0:if(!e||typeof e!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(r=e.ownerDocument,!r)throw new Error("Element is not attached to a Document");if(a=r.defaultView,!a)throw new Error("Document is not attached to a Window");return s={allowTaint:(V=t.allowTaint)!==null&&V!==void 0?V:!1,imageTimeout:(U=t.imageTimeout)!==null&&U!==void 0?U:15e3,proxy:t.proxy,useCORS:(M=t.useCORS)!==null&&M!==void 0?M:!1},n=Dw({logging:(T=t.logging)!==null&&T!==void 0?T:!0,cache:t.cache},s),o={windowWidth:(D=t.windowWidth)!==null&&D!==void 0?D:a.innerWidth,windowHeight:(G=t.windowHeight)!==null&&G!==void 0?G:a.innerHeight,scrollX:(ne=t.scrollX)!==null&&ne!==void 0?ne:a.pageXOffset,scrollY:(H=t.scrollY)!==null&&H!==void 0?H:a.pageYOffset},c=new ou(o.scrollX,o.scrollY,o.windowWidth,o.windowHeight),u=new EJ(n,c),f=(ee=t.foreignObjectRendering)!==null&&ee!==void 0?ee:!1,h={allowTaint:(le=t.allowTaint)!==null&&le!==void 0?le:!1,onclone:t.onclone,ignoreElements:t.ignoreElements,inlineImages:f,copyStyles:f},u.logger.debug("Starting document clone with size "+c.width+"x"+c.height+" scrolled to "+-c.left+","+-c.top),g=new nC(u,e,h),x=g.clonedReferenceElement,x?[4,g.toIFrame(r,c)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return m=q.sent(),w=E_(x)||LY(x)?oG(x.ownerDocument):ub(u,x),v=w.width,B=w.height,k=w.left,E=w.top,S=TJ(u,x,t.backgroundColor),L={canvas:t.canvas,backgroundColor:S,scale:(te=(pe=t.scale)!==null&&pe!==void 0?pe:a.devicePixelRatio)!==null&&te!==void 0?te:1,x:((Le=t.x)!==null&&Le!==void 0?Le:0)+k,y:((je=t.y)!==null&&je!==void 0?je:0)+E,width:(F=t.width)!==null&&F!==void 0?F:Math.ceil(v),height:(K=t.height)!==null&&K!==void 0?K:Math.ceil(B)},f?(u.logger.debug("Document cloned, using foreign object rendering"),Q=new CJ(u,L),[4,Q.render(x)]):[3,3];case 2:return P=q.sent(),[3,5];case 3:return u.logger.debug("Document cloned, element located at "+k+","+E+" with size "+v+"x"+B+" using computed rendering"),u.logger.debug("Starting DOM parsing"),R=WF(u,x),S===R.styles.backgroundColor&&(R.styles.backgroundColor=nu.TRANSPARENT),u.logger.debug("Starting renderer for element at "+L.x+","+L.y+" with size "+L.width+"x"+L.height),Q=new vJ(u,L),[4,Q.render(R)];case 4:P=q.sent(),q.label=5;case 5:return(!((I=t.removeContainer)!==null&&I!==void 0)||I)&&(nC.destroy(m)||u.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),u.logger.debug("Finished rendering"),[2,P]}})})},TJ=function(e,t,r){var a=t.ownerDocument,s=a.documentElement?dp(e,getComputedStyle(a.documentElement).backgroundColor):nu.TRANSPARENT,n=a.body?dp(e,getComputedStyle(a.body).backgroundColor):nu.TRANSPARENT,o=typeof r=="string"?dp(e,r):r===null?nu.TRANSPARENT:4294967295;return t===a.documentElement?n0(s)?n0(n)?o:n:s:o};const LJ=Object.freeze(Object.defineProperty({__proto__:null,default:a2},Symbol.toStringTag,{value:"Module"}));function Ya(e){"@babel/helpers - typeof";return Ya=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ya(e)}var TA=Uint8Array,ko=Uint16Array,F_=Int32Array,T_=new TA([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),L_=new TA([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),cC=new TA([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),AT=function(e,t){for(var r=new ko(31),a=0;a<31;++a)r[a]=t+=1<<e[a-1];for(var s=new F_(r[30]),a=1;a<30;++a)for(var n=r[a];n<r[a+1];++n)s[n]=n-r[a]<<5|a;return{b:r,r:s}},cT=AT(T_,2),jJ=cT.b,s2=cT.r;jJ[28]=258,s2[258]=28;var UJ=AT(L_,0),uC=UJ.r,n2=new ko(32768);for(var Es=0;Es<32768;++Es){var Mu=(Es&43690)>>1|(Es&21845)<<1;Mu=(Mu&52428)>>2|(Mu&13107)<<2,Mu=(Mu&61680)>>4|(Mu&3855)<<4,n2[Es]=((Mu&65280)>>8|(Mu&255)<<8)>>1}var gp=(function(e,t,r){for(var a=e.length,s=0,n=new ko(t);s<a;++s)e[s]&&++n[e[s]-1];var o=new ko(t);for(s=1;s<t;++s)o[s]=o[s-1]+n[s-1]<<1;var c;if(r){c=new ko(1<<t);var u=15-t;for(s=0;s<a;++s)if(e[s])for(var f=s<<4|e[s],h=t-e[s],g=o[e[s]-1]++<<h,x=g|(1<<h)-1;g<=x;++g)c[n2[g]>>u]=f}else for(c=new ko(a),s=0;s<a;++s)e[s]&&(c[s]=n2[o[e[s]-1]++]>>15-e[s]);return c}),rd=new TA(288);for(var Es=0;Es<144;++Es)rd[Es]=8;for(var Es=144;Es<256;++Es)rd[Es]=9;for(var Es=256;Es<280;++Es)rd[Es]=7;for(var Es=280;Es<288;++Es)rd[Es]=8;var Px=new TA(32);for(var Es=0;Es<32;++Es)Px[Es]=5;var DJ=gp(rd,9,0),IJ=gp(Px,5,0),uT=function(e){return(e+7)/8|0},QJ=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new TA(e.subarray(t,r))},Yc=function(e,t,r){r<<=t&7;var a=t/8|0;e[a]|=r,e[a+1]|=r>>8},Rh=function(e,t,r){r<<=t&7;var a=t/8|0;e[a]|=r,e[a+1]|=r>>8,e[a+2]|=r>>16},Iv=function(e,t){for(var r=[],a=0;a<e.length;++a)e[a]&&r.push({s:a,f:e[a]});var s=r.length,n=r.slice();if(!s)return{t:fT,l:0};if(s==1){var o=new TA(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(P,R){return P.f-R.f}),r.push({s:-1,f:25001});var c=r[0],u=r[1],f=0,h=1,g=2;for(r[0]={s:-1,f:c.f+u.f,l:c,r:u};h!=s-1;)c=r[r[f].f<r[g].f?f++:g++],u=r[f!=h&&r[f].f<r[g].f?f++:g++],r[h++]={s:-1,f:c.f+u.f,l:c,r:u};for(var x=n[0].s,a=1;a<s;++a)n[a].s>x&&(x=n[a].s);var m=new ko(x+1),w=i2(r[h-1],m,0);if(w>t){var a=0,v=0,B=w-t,k=1<<B;for(n.sort(function(R,Q){return m[Q.s]-m[R.s]||R.f-Q.f});a<s;++a){var E=n[a].s;if(m[E]>t)v+=k-(1<<w-m[E]),m[E]=t;else break}for(v>>=B;v>0;){var S=n[a].s;m[S]<t?v-=1<<t-m[S]++-1:++a}for(;a>=0&&v;--a){var L=n[a].s;m[L]==t&&(--m[L],++v)}w=t}return{t:new TA(m),l:w}},i2=function(e,t,r){return e.s==-1?Math.max(i2(e.l,t,r+1),i2(e.r,t,r+1)):t[e.s]=r},dC=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new ko(++t),a=0,s=e[0],n=1,o=function(u){r[a++]=u},c=1;c<=t;++c)if(e[c]==s&&c!=t)++n;else{if(!s&&n>2){for(;n>138;n-=138)o(32754);n>2&&(o(n>10?n-11<<5|28690:n-3<<5|12305),n=0)}else if(n>3){for(o(s),--n;n>6;n-=6)o(8304);n>2&&(o(n-3<<5|8208),n=0)}for(;n--;)o(s);n=1,s=e[c]}return{c:r.subarray(0,a),n:t}},Mh=function(e,t){for(var r=0,a=0;a<t.length;++a)r+=e[a]*t[a];return r},dT=function(e,t,r){var a=r.length,s=uT(t+2);e[s]=a&255,e[s+1]=a>>8,e[s+2]=e[s]^255,e[s+3]=e[s+1]^255;for(var n=0;n<a;++n)e[s+n+4]=r[n];return(s+4+a)*8},fC=function(e,t,r,a,s,n,o,c,u,f,h){Yc(t,h++,r),++s[256];for(var g=Iv(s,15),x=g.t,m=g.l,w=Iv(n,15),v=w.t,B=w.l,k=dC(x),E=k.c,S=k.n,L=dC(v),P=L.c,R=L.n,Q=new ko(19),V=0;V<E.length;++V)++Q[E[V]&31];for(var V=0;V<P.length;++V)++Q[P[V]&31];for(var U=Iv(Q,7),M=U.t,T=U.l,D=19;D>4&&!M[cC[D-1]];--D);var G=f+5<<3,ne=Mh(s,rd)+Mh(n,Px)+o,H=Mh(s,x)+Mh(n,v)+o+14+3*D+Mh(Q,M)+2*Q[16]+3*Q[17]+7*Q[18];if(u>=0&&G<=ne&&G<=H)return dT(t,h,e.subarray(u,u+f));var ee,le,pe,te;if(Yc(t,h,1+(H<ne)),h+=2,H<ne){ee=gp(x,m,0),le=x,pe=gp(v,B,0),te=v;var Le=gp(M,T,0);Yc(t,h,S-257),Yc(t,h+5,R-1),Yc(t,h+10,D-4),h+=14;for(var V=0;V<D;++V)Yc(t,h+3*V,M[cC[V]]);h+=3*D;for(var je=[E,P],F=0;F<2;++F)for(var K=je[F],V=0;V<K.length;++V){var I=K[V]&31;Yc(t,h,Le[I]),h+=M[I],I>15&&(Yc(t,h,K[V]>>5&127),h+=K[V]>>12)}}else ee=DJ,le=rd,pe=IJ,te=Px;for(var V=0;V<c;++V){var q=a[V];if(q>255){var I=q>>18&31;Rh(t,h,ee[I+257]),h+=le[I+257],I>7&&(Yc(t,h,q>>23&31),h+=T_[I]);var J=q&31;Rh(t,h,pe[J]),h+=te[J],J>3&&(Rh(t,h,q>>5&8191),h+=L_[J])}else Rh(t,h,ee[q]),h+=le[q]}return Rh(t,h,ee[256]),h+le[256]},OJ=new F_([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),fT=new TA(0),RJ=function(e,t,r,a,s,n){var o=n.z||e.length,c=new TA(a+o+5*(1+Math.ceil(o/7e3))+s),u=c.subarray(a,c.length-s),f=n.l,h=(n.r||0)&7;if(t){h&&(u[0]=n.r>>3);for(var g=OJ[t-1],x=g>>13,m=g&8191,w=(1<<r)-1,v=n.p||new ko(32768),B=n.h||new ko(w+1),k=Math.ceil(r/3),E=2*k,S=function(He){return(e[He]^e[He+1]<<k^e[He+2]<<E)&w},L=new F_(25e3),P=new ko(288),R=new ko(32),Q=0,V=0,U=n.i||0,M=0,T=n.w||0,D=0;U+2<o;++U){var G=S(U),ne=U&32767,H=B[G];if(v[ne]=H,B[G]=ne,T<=U){var ee=o-U;if((Q>7e3||M>24576)&&(ee>423||!f)){h=fC(e,u,0,L,P,R,V,M,D,U-D,h),M=Q=V=0,D=U;for(var le=0;le<286;++le)P[le]=0;for(var le=0;le<30;++le)R[le]=0}var pe=2,te=0,Le=m,je=ne-H&32767;if(ee>2&&G==S(U-je))for(var F=Math.min(x,ee)-1,K=Math.min(32767,U),I=Math.min(258,ee);je<=K&&--Le&&ne!=H;){if(e[U+pe]==e[U+pe-je]){for(var q=0;q<I&&e[U+q]==e[U+q-je];++q);if(q>pe){if(pe=q,te=je,q>F)break;for(var J=Math.min(je,q-2),Y=0,le=0;le<J;++le){var de=U-je+le&32767,ue=v[de],we=de-ue&32767;we>Y&&(Y=we,H=de)}}}ne=H,H=v[ne],je+=ne-H&32767}if(te){L[M++]=268435456|s2[pe]<<18|uC[te];var Ie=s2[pe]&31,Ae=uC[te]&31;V+=T_[Ie]+L_[Ae],++P[257+Ie],++R[Ae],T=U+pe,++Q}else L[M++]=e[U],++P[e[U]]}}for(U=Math.max(U,T);U<o;++U)L[M++]=e[U],++P[e[U]];h=fC(e,u,f,L,P,R,V,M,D,U-D,h),f||(n.r=h&7|u[h/8|0]<<3,h-=7,n.h=B,n.p=v,n.i=U,n.w=T)}else{for(var U=n.w||0;U<o+f;U+=65535){var oe=U+65535;oe>=o&&(u[h/8|0]=f,oe=o),h=dT(u,h+1,e.subarray(U,oe))}n.i=o}return QJ(c,0,a+uT(h)+s)},hT=function(){var e=1,t=0;return{p:function(r){for(var a=e,s=t,n=r.length|0,o=0;o!=n;){for(var c=Math.min(o+2655,n);o<c;++o)s+=a+=r[o];a=(a&65535)+15*(a>>16),s=(s&65535)+15*(s>>16)}e=a,t=s},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},MJ=function(e,t,r,a,s){if(!s&&(s={l:1},t.dictionary)){var n=t.dictionary.subarray(-32768),o=new TA(n.length+e.length);o.set(n),o.set(e,n.length),e=o,s.w=n.length}return RJ(e,t.level==null?6:t.level,t.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,a,s)},pT=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},HJ=function(e,t){var r=t.level,a=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=a<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var s=hT();s.p(t.dictionary),pT(e,2,s.d())}};function l2(e,t){t||(t={});var r=hT();r.p(e);var a=MJ(e,t,t.dictionary?6:2,4);return HJ(a,t),pT(a,a.length-4,r.d()),a}var PJ=typeof TextDecoder<"u"&&new TextDecoder,qJ=0;try{PJ.decode(fT,{stream:!0}),qJ=1}catch{}function KJ(e){if(Array.isArray(e))return e}function zJ(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,n,o,c=[],u=!0,f=!1;try{if(n=(r=r.call(e)).next,t!==0)for(;!(u=(a=n.call(r)).done)&&(c.push(a.value),c.length!==t);u=!0);}catch(h){f=!0,s=h}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(f)throw s}}return c}}function hC(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=Array(t);r<t;r++)a[r]=e[r];return a}function VJ(e,t){if(e){if(typeof e=="string")return hC(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?hC(e,t):void 0}}function GJ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pC(e,t){return KJ(e)||zJ(e,t)||VJ(e,t)||GJ()}function gC(e,t="utf8"){return new TextDecoder(t).decode(e)}const WJ=new TextEncoder;function $J(e){return WJ.encode(e)}const XJ=1024*8,YJ=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),Qv={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class j_{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(t=XJ,r={}){let a=!1;typeof t=="number"?t=new ArrayBuffer(t):(a=!0,this.lastWrittenByte=t.byteLength);const s=r.offset?r.offset>>>0:0,n=t.byteLength-s;let o=s;(ArrayBuffer.isView(t)||t instanceof j_)&&(t.byteLength!==t.buffer.byteLength&&(o=t.byteOffset+s),t=t.buffer),a?this.lastWrittenByte=n:this.lastWrittenByte=0,this.buffer=t,this.length=n,this.byteLength=n,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,n),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const a=(this.offset+t)*2,s=new Uint8Array(a);s.set(new Uint8Array(this.buffer)),this.buffer=s.buffer,this.length=a,this.byteLength=a,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const a=Qv[r].BYTES_PER_ELEMENT*t,s=this.byteOffset+this.offset,n=this.buffer.slice(s,s+a);if(this.littleEndian===YJ&&r!=="uint8"&&r!=="int8"){const c=new Uint8Array(this.buffer.slice(s,s+a));c.reverse();const u=new Qv[r](c.buffer);return this.offset+=a,u.reverse(),u}const o=new Qv[r](n);return this.offset+=a,o}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let a=0;a<t;a++)r+=this.readChar();return r}readUtf8(t=1){return gC(this.readBytes(t))}decodeText(t=1,r="utf8"){return gC(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes($J(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Kf(e){let t=e.length;for(;--t>=0;)e[t]=0}const JJ=3,ZJ=258,gT=29,eZ=256,tZ=eZ+1+gT,mT=30,rZ=512,aZ=new Array((tZ+2)*2);Kf(aZ);const sZ=new Array(mT*2);Kf(sZ);const nZ=new Array(rZ);Kf(nZ);const iZ=new Array(ZJ-JJ+1);Kf(iZ);const lZ=new Array(gT);Kf(lZ);const oZ=new Array(mT);Kf(oZ);const AZ=(e,t,r,a)=>{let s=e&65535|0,n=e>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do s=s+t[a++]|0,n=n+s|0;while(--o);s%=65521,n%=65521}return s|n<<16|0};var o2=AZ;const cZ=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var a=0;a<8;a++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},uZ=new Uint32Array(cZ()),dZ=(e,t,r,a)=>{const s=uZ,n=a+r;e^=-1;for(let o=a;o<n;o++)e=e>>>8^s[(e^t[o])&255];return e^-1};var uc=dZ,A2={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},xT={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const fZ=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var hZ=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const a in r)fZ(r,a)&&(e[a]=r[a])}}return e},pZ=e=>{let t=0;for(let a=0,s=e.length;a<s;a++)t+=e[a].length;const r=new Uint8Array(t);for(let a=0,s=0,n=e.length;a<n;a++){let o=e[a];r.set(o,s),s+=o.length}return r},bT={assign:hZ,flattenChunks:pZ};let vT=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{vT=!1}const Pp=new Uint8Array(256);for(let e=0;e<256;e++)Pp[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Pp[254]=Pp[254]=1;var gZ=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,a,s,n,o=e.length,c=0;for(s=0;s<o;s++)r=e.charCodeAt(s),(r&64512)===55296&&s+1<o&&(a=e.charCodeAt(s+1),(a&64512)===56320&&(r=65536+(r-55296<<10)+(a-56320),s++)),c+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(c),n=0,s=0;n<c;s++)r=e.charCodeAt(s),(r&64512)===55296&&s+1<o&&(a=e.charCodeAt(s+1),(a&64512)===56320&&(r=65536+(r-55296<<10)+(a-56320),s++)),r<128?t[n++]=r:r<2048?(t[n++]=192|r>>>6,t[n++]=128|r&63):r<65536?(t[n++]=224|r>>>12,t[n++]=128|r>>>6&63,t[n++]=128|r&63):(t[n++]=240|r>>>18,t[n++]=128|r>>>12&63,t[n++]=128|r>>>6&63,t[n++]=128|r&63);return t};const mZ=(e,t)=>{if(t<65534&&e.subarray&&vT)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let a=0;a<t;a++)r+=String.fromCharCode(e[a]);return r};var xZ=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let a,s;const n=new Array(r*2);for(s=0,a=0;a<r;){let o=e[a++];if(o<128){n[s++]=o;continue}let c=Pp[o];if(c>4){n[s++]=65533,a+=c-1;continue}for(o&=c===2?31:c===3?15:7;c>1&&a<r;)o=o<<6|e[a++]&63,c--;if(c>1){n[s++]=65533;continue}o<65536?n[s++]=o:(o-=65536,n[s++]=55296|o>>10&1023,n[s++]=56320|o&1023)}return mZ(n,s)},bZ=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+Pp[e[r]]>t?r:t},c2={string2buf:gZ,buf2string:xZ,utf8border:bZ};function vZ(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var wZ=vZ;const Dm=16209,_Z=16191;var yZ=function(t,r){let a,s,n,o,c,u,f,h,g,x,m,w,v,B,k,E,S,L,P,R,Q,V,U,M;const T=t.state;a=t.next_in,U=t.input,s=a+(t.avail_in-5),n=t.next_out,M=t.output,o=n-(r-t.avail_out),c=n+(t.avail_out-257),u=T.dmax,f=T.wsize,h=T.whave,g=T.wnext,x=T.window,m=T.hold,w=T.bits,v=T.lencode,B=T.distcode,k=(1<<T.lenbits)-1,E=(1<<T.distbits)-1;e:do{w<15&&(m+=U[a++]<<w,w+=8,m+=U[a++]<<w,w+=8),S=v[m&k];t:for(;;){if(L=S>>>24,m>>>=L,w-=L,L=S>>>16&255,L===0)M[n++]=S&65535;else if(L&16){P=S&65535,L&=15,L&&(w<L&&(m+=U[a++]<<w,w+=8),P+=m&(1<<L)-1,m>>>=L,w-=L),w<15&&(m+=U[a++]<<w,w+=8,m+=U[a++]<<w,w+=8),S=B[m&E];r:for(;;){if(L=S>>>24,m>>>=L,w-=L,L=S>>>16&255,L&16){if(R=S&65535,L&=15,w<L&&(m+=U[a++]<<w,w+=8,w<L&&(m+=U[a++]<<w,w+=8)),R+=m&(1<<L)-1,R>u){t.msg="invalid distance too far back",T.mode=Dm;break e}if(m>>>=L,w-=L,L=n-o,R>L){if(L=R-L,L>h&&T.sane){t.msg="invalid distance too far back",T.mode=Dm;break e}if(Q=0,V=x,g===0){if(Q+=f-L,L<P){P-=L;do M[n++]=x[Q++];while(--L);Q=n-R,V=M}}else if(g<L){if(Q+=f+g-L,L-=g,L<P){P-=L;do M[n++]=x[Q++];while(--L);if(Q=0,g<P){L=g,P-=L;do M[n++]=x[Q++];while(--L);Q=n-R,V=M}}}else if(Q+=g-L,L<P){P-=L;do M[n++]=x[Q++];while(--L);Q=n-R,V=M}for(;P>2;)M[n++]=V[Q++],M[n++]=V[Q++],M[n++]=V[Q++],P-=3;P&&(M[n++]=V[Q++],P>1&&(M[n++]=V[Q++]))}else{Q=n-R;do M[n++]=M[Q++],M[n++]=M[Q++],M[n++]=M[Q++],P-=3;while(P>2);P&&(M[n++]=M[Q++],P>1&&(M[n++]=M[Q++]))}}else if((L&64)===0){S=B[(S&65535)+(m&(1<<L)-1)];continue r}else{t.msg="invalid distance code",T.mode=Dm;break e}break}}else if((L&64)===0){S=v[(S&65535)+(m&(1<<L)-1)];continue t}else if(L&32){T.mode=_Z;break e}else{t.msg="invalid literal/length code",T.mode=Dm;break e}break}}while(a<s&&n<c);P=w>>3,a-=P,w-=P<<3,m&=(1<<w)-1,t.next_in=a,t.next_out=n,t.avail_in=a<s?5+(s-a):5-(a-s),t.avail_out=n<c?257+(c-n):257-(n-c),T.hold=m,T.bits=w};const ef=15,mC=852,xC=592,bC=0,Ov=1,vC=2,kZ=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),BZ=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),CZ=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),SZ=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),NZ=(e,t,r,a,s,n,o,c)=>{const u=c.bits;let f=0,h=0,g=0,x=0,m=0,w=0,v=0,B=0,k=0,E=0,S,L,P,R,Q,V=null,U;const M=new Uint16Array(ef+1),T=new Uint16Array(ef+1);let D=null,G,ne,H;for(f=0;f<=ef;f++)M[f]=0;for(h=0;h<a;h++)M[t[r+h]]++;for(m=u,x=ef;x>=1&&M[x]===0;x--);if(m>x&&(m=x),x===0)return s[n++]=1<<24|64<<16|0,s[n++]=1<<24|64<<16|0,c.bits=1,0;for(g=1;g<x&&M[g]===0;g++);for(m<g&&(m=g),B=1,f=1;f<=ef;f++)if(B<<=1,B-=M[f],B<0)return-1;if(B>0&&(e===bC||x!==1))return-1;for(T[1]=0,f=1;f<ef;f++)T[f+1]=T[f]+M[f];for(h=0;h<a;h++)t[r+h]!==0&&(o[T[t[r+h]]++]=h);if(e===bC?(V=D=o,U=20):e===Ov?(V=kZ,D=BZ,U=257):(V=CZ,D=SZ,U=0),E=0,h=0,f=g,Q=n,w=m,v=0,P=-1,k=1<<m,R=k-1,e===Ov&&k>mC||e===vC&&k>xC)return 1;for(;;){G=f-v,o[h]+1<U?(ne=0,H=o[h]):o[h]>=U?(ne=D[o[h]-U],H=V[o[h]-U]):(ne=96,H=0),S=1<<f-v,L=1<<w,g=L;do L-=S,s[Q+(E>>v)+L]=G<<24|ne<<16|H|0;while(L!==0);for(S=1<<f-1;E&S;)S>>=1;if(S!==0?(E&=S-1,E+=S):E=0,h++,--M[f]===0){if(f===x)break;f=t[r+o[h]]}if(f>m&&(E&R)!==P){for(v===0&&(v=m),Q+=g,w=f-v,B=1<<w;w+v<x&&(B-=M[w+v],!(B<=0));)w++,B<<=1;if(k+=1<<w,e===Ov&&k>mC||e===vC&&k>xC)return 1;P=E&R,s[P]=m<<24|w<<16|Q-n|0}}return E!==0&&(s[Q+E]=f-v<<24|64<<16|0),c.bits=m,0};var mp=NZ;const EZ=0,wT=1,_T=2,{Z_FINISH:wC,Z_BLOCK:FZ,Z_TREES:Im,Z_OK:ad,Z_STREAM_END:TZ,Z_NEED_DICT:LZ,Z_STREAM_ERROR:aA,Z_DATA_ERROR:yT,Z_MEM_ERROR:kT,Z_BUF_ERROR:jZ,Z_DEFLATED:_C}=xT,wb=16180,yC=16181,kC=16182,BC=16183,CC=16184,SC=16185,NC=16186,EC=16187,FC=16188,TC=16189,qx=16190,Jc=16191,Rv=16192,LC=16193,Mv=16194,jC=16195,UC=16196,DC=16197,IC=16198,Qm=16199,Om=16200,QC=16201,OC=16202,RC=16203,MC=16204,HC=16205,Hv=16206,PC=16207,qC=16208,Hs=16209,BT=16210,CT=16211,UZ=852,DZ=592,IZ=15,QZ=IZ,KC=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function OZ(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const cd=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<wb||t.mode>CT?1:0},ST=e=>{if(cd(e))return aA;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=wb,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(UZ),t.distcode=t.distdyn=new Int32Array(DZ),t.sane=1,t.back=-1,ad},NT=e=>{if(cd(e))return aA;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,ST(e)},ET=(e,t)=>{let r;if(cd(e))return aA;const a=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?aA:(a.window!==null&&a.wbits!==t&&(a.window=null),a.wrap=r,a.wbits=t,NT(e))},FT=(e,t)=>{if(!e)return aA;const r=new OZ;e.state=r,r.strm=e,r.window=null,r.mode=wb;const a=ET(e,t);return a!==ad&&(e.state=null),a},RZ=e=>FT(e,QZ);let zC=!0,Pv,qv;const MZ=e=>{if(zC){Pv=new Int32Array(512),qv=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(mp(wT,e.lens,0,288,Pv,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;mp(_T,e.lens,0,32,qv,0,e.work,{bits:5}),zC=!1}e.lencode=Pv,e.lenbits=9,e.distcode=qv,e.distbits=5},TT=(e,t,r,a)=>{let s;const n=e.state;return n.window===null&&(n.wsize=1<<n.wbits,n.wnext=0,n.whave=0,n.window=new Uint8Array(n.wsize)),a>=n.wsize?(n.window.set(t.subarray(r-n.wsize,r),0),n.wnext=0,n.whave=n.wsize):(s=n.wsize-n.wnext,s>a&&(s=a),n.window.set(t.subarray(r-a,r-a+s),n.wnext),a-=s,a?(n.window.set(t.subarray(r-a,r),0),n.wnext=a,n.whave=n.wsize):(n.wnext+=s,n.wnext===n.wsize&&(n.wnext=0),n.whave<n.wsize&&(n.whave+=s))),0},HZ=(e,t)=>{let r,a,s,n,o,c,u,f,h,g,x,m,w,v,B=0,k,E,S,L,P,R,Q,V;const U=new Uint8Array(4);let M,T;const D=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(cd(e)||!e.output||!e.input&&e.avail_in!==0)return aA;r=e.state,r.mode===Jc&&(r.mode=Rv),o=e.next_out,s=e.output,u=e.avail_out,n=e.next_in,a=e.input,c=e.avail_in,f=r.hold,h=r.bits,g=c,x=u,V=ad;e:for(;;)switch(r.mode){case wb:if(r.wrap===0){r.mode=Rv;break}for(;h<16;){if(c===0)break e;c--,f+=a[n++]<<h,h+=8}if(r.wrap&2&&f===35615){r.wbits===0&&(r.wbits=15),r.check=0,U[0]=f&255,U[1]=f>>>8&255,r.check=uc(r.check,U,2,0),f=0,h=0,r.mode=yC;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((f&255)<<8)+(f>>8))%31){e.msg="incorrect header check",r.mode=Hs;break}if((f&15)!==_C){e.msg="unknown compression method",r.mode=Hs;break}if(f>>>=4,h-=4,Q=(f&15)+8,r.wbits===0&&(r.wbits=Q),Q>15||Q>r.wbits){e.msg="invalid window size",r.mode=Hs;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=f&512?TC:Jc,f=0,h=0;break;case yC:for(;h<16;){if(c===0)break e;c--,f+=a[n++]<<h,h+=8}if(r.flags=f,(r.flags&255)!==_C){e.msg="unknown compression method",r.mode=Hs;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=Hs;break}r.head&&(r.head.text=f>>8&1),r.flags&512&&r.wrap&4&&(U[0]=f&255,U[1]=f>>>8&255,r.check=uc(r.check,U,2,0)),f=0,h=0,r.mode=kC;case kC:for(;h<32;){if(c===0)break e;c--,f+=a[n++]<<h,h+=8}r.head&&(r.head.time=f),r.flags&512&&r.wrap&4&&(U[0]=f&255,U[1]=f>>>8&255,U[2]=f>>>16&255,U[3]=f>>>24&255,r.check=uc(r.check,U,4,0)),f=0,h=0,r.mode=BC;case BC:for(;h<16;){if(c===0)break e;c--,f+=a[n++]<<h,h+=8}r.head&&(r.head.xflags=f&255,r.head.os=f>>8),r.flags&512&&r.wrap&4&&(U[0]=f&255,U[1]=f>>>8&255,r.check=uc(r.check,U,2,0)),f=0,h=0,r.mode=CC;case CC:if(r.flags&1024){for(;h<16;){if(c===0)break e;c--,f+=a[n++]<<h,h+=8}r.length=f,r.head&&(r.head.extra_len=f),r.flags&512&&r.wrap&4&&(U[0]=f&255,U[1]=f>>>8&255,r.check=uc(r.check,U,2,0)),f=0,h=0}else r.head&&(r.head.extra=null);r.mode=SC;case SC:if(r.flags&1024&&(m=r.length,m>c&&(m=c),m&&(r.head&&(Q=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(a.subarray(n,n+m),Q)),r.flags&512&&r.wrap&4&&(r.check=uc(r.check,a,m,n)),c-=m,n+=m,r.length-=m),r.length))break e;r.length=0,r.mode=NC;case NC:if(r.flags&2048){if(c===0)break e;m=0;do Q=a[n+m++],r.head&&Q&&r.length<65536&&(r.head.name+=String.fromCharCode(Q));while(Q&&m<c);if(r.flags&512&&r.wrap&4&&(r.check=uc(r.check,a,m,n)),c-=m,n+=m,Q)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=EC;case EC:if(r.flags&4096){if(c===0)break e;m=0;do Q=a[n+m++],r.head&&Q&&r.length<65536&&(r.head.comment+=String.fromCharCode(Q));while(Q&&m<c);if(r.flags&512&&r.wrap&4&&(r.check=uc(r.check,a,m,n)),c-=m,n+=m,Q)break e}else r.head&&(r.head.comment=null);r.mode=FC;case FC:if(r.flags&512){for(;h<16;){if(c===0)break e;c--,f+=a[n++]<<h,h+=8}if(r.wrap&4&&f!==(r.check&65535)){e.msg="header crc mismatch",r.mode=Hs;break}f=0,h=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=Jc;break;case TC:for(;h<32;){if(c===0)break e;c--,f+=a[n++]<<h,h+=8}e.adler=r.check=KC(f),f=0,h=0,r.mode=qx;case qx:if(r.havedict===0)return e.next_out=o,e.avail_out=u,e.next_in=n,e.avail_in=c,r.hold=f,r.bits=h,LZ;e.adler=r.check=1,r.mode=Jc;case Jc:if(t===FZ||t===Im)break e;case Rv:if(r.last){f>>>=h&7,h-=h&7,r.mode=Hv;break}for(;h<3;){if(c===0)break e;c--,f+=a[n++]<<h,h+=8}switch(r.last=f&1,f>>>=1,h-=1,f&3){case 0:r.mode=LC;break;case 1:if(MZ(r),r.mode=Qm,t===Im){f>>>=2,h-=2;break e}break;case 2:r.mode=UC;break;case 3:e.msg="invalid block type",r.mode=Hs}f>>>=2,h-=2;break;case LC:for(f>>>=h&7,h-=h&7;h<32;){if(c===0)break e;c--,f+=a[n++]<<h,h+=8}if((f&65535)!==(f>>>16^65535)){e.msg="invalid stored block lengths",r.mode=Hs;break}if(r.length=f&65535,f=0,h=0,r.mode=Mv,t===Im)break e;case Mv:r.mode=jC;case jC:if(m=r.length,m){if(m>c&&(m=c),m>u&&(m=u),m===0)break e;s.set(a.subarray(n,n+m),o),c-=m,n+=m,u-=m,o+=m,r.length-=m;break}r.mode=Jc;break;case UC:for(;h<14;){if(c===0)break e;c--,f+=a[n++]<<h,h+=8}if(r.nlen=(f&31)+257,f>>>=5,h-=5,r.ndist=(f&31)+1,f>>>=5,h-=5,r.ncode=(f&15)+4,f>>>=4,h-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=Hs;break}r.have=0,r.mode=DC;case DC:for(;r.have<r.ncode;){for(;h<3;){if(c===0)break e;c--,f+=a[n++]<<h,h+=8}r.lens[D[r.have++]]=f&7,f>>>=3,h-=3}for(;r.have<19;)r.lens[D[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,M={bits:r.lenbits},V=mp(EZ,r.lens,0,19,r.lencode,0,r.work,M),r.lenbits=M.bits,V){e.msg="invalid code lengths set",r.mode=Hs;break}r.have=0,r.mode=IC;case IC:for(;r.have<r.nlen+r.ndist;){for(;B=r.lencode[f&(1<<r.lenbits)-1],k=B>>>24,E=B>>>16&255,S=B&65535,!(k<=h);){if(c===0)break e;c--,f+=a[n++]<<h,h+=8}if(S<16)f>>>=k,h-=k,r.lens[r.have++]=S;else{if(S===16){for(T=k+2;h<T;){if(c===0)break e;c--,f+=a[n++]<<h,h+=8}if(f>>>=k,h-=k,r.have===0){e.msg="invalid bit length repeat",r.mode=Hs;break}Q=r.lens[r.have-1],m=3+(f&3),f>>>=2,h-=2}else if(S===17){for(T=k+3;h<T;){if(c===0)break e;c--,f+=a[n++]<<h,h+=8}f>>>=k,h-=k,Q=0,m=3+(f&7),f>>>=3,h-=3}else{for(T=k+7;h<T;){if(c===0)break e;c--,f+=a[n++]<<h,h+=8}f>>>=k,h-=k,Q=0,m=11+(f&127),f>>>=7,h-=7}if(r.have+m>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=Hs;break}for(;m--;)r.lens[r.have++]=Q}}if(r.mode===Hs)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=Hs;break}if(r.lenbits=9,M={bits:r.lenbits},V=mp(wT,r.lens,0,r.nlen,r.lencode,0,r.work,M),r.lenbits=M.bits,V){e.msg="invalid literal/lengths set",r.mode=Hs;break}if(r.distbits=6,r.distcode=r.distdyn,M={bits:r.distbits},V=mp(_T,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,M),r.distbits=M.bits,V){e.msg="invalid distances set",r.mode=Hs;break}if(r.mode=Qm,t===Im)break e;case Qm:r.mode=Om;case Om:if(c>=6&&u>=258){e.next_out=o,e.avail_out=u,e.next_in=n,e.avail_in=c,r.hold=f,r.bits=h,yZ(e,x),o=e.next_out,s=e.output,u=e.avail_out,n=e.next_in,a=e.input,c=e.avail_in,f=r.hold,h=r.bits,r.mode===Jc&&(r.back=-1);break}for(r.back=0;B=r.lencode[f&(1<<r.lenbits)-1],k=B>>>24,E=B>>>16&255,S=B&65535,!(k<=h);){if(c===0)break e;c--,f+=a[n++]<<h,h+=8}if(E&&(E&240)===0){for(L=k,P=E,R=S;B=r.lencode[R+((f&(1<<L+P)-1)>>L)],k=B>>>24,E=B>>>16&255,S=B&65535,!(L+k<=h);){if(c===0)break e;c--,f+=a[n++]<<h,h+=8}f>>>=L,h-=L,r.back+=L}if(f>>>=k,h-=k,r.back+=k,r.length=S,E===0){r.mode=HC;break}if(E&32){r.back=-1,r.mode=Jc;break}if(E&64){e.msg="invalid literal/length code",r.mode=Hs;break}r.extra=E&15,r.mode=QC;case QC:if(r.extra){for(T=r.extra;h<T;){if(c===0)break e;c--,f+=a[n++]<<h,h+=8}r.length+=f&(1<<r.extra)-1,f>>>=r.extra,h-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=OC;case OC:for(;B=r.distcode[f&(1<<r.distbits)-1],k=B>>>24,E=B>>>16&255,S=B&65535,!(k<=h);){if(c===0)break e;c--,f+=a[n++]<<h,h+=8}if((E&240)===0){for(L=k,P=E,R=S;B=r.distcode[R+((f&(1<<L+P)-1)>>L)],k=B>>>24,E=B>>>16&255,S=B&65535,!(L+k<=h);){if(c===0)break e;c--,f+=a[n++]<<h,h+=8}f>>>=L,h-=L,r.back+=L}if(f>>>=k,h-=k,r.back+=k,E&64){e.msg="invalid distance code",r.mode=Hs;break}r.offset=S,r.extra=E&15,r.mode=RC;case RC:if(r.extra){for(T=r.extra;h<T;){if(c===0)break e;c--,f+=a[n++]<<h,h+=8}r.offset+=f&(1<<r.extra)-1,f>>>=r.extra,h-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=Hs;break}r.mode=MC;case MC:if(u===0)break e;if(m=x-u,r.offset>m){if(m=r.offset-m,m>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=Hs;break}m>r.wnext?(m-=r.wnext,w=r.wsize-m):w=r.wnext-m,m>r.length&&(m=r.length),v=r.window}else v=s,w=o-r.offset,m=r.length;m>u&&(m=u),u-=m,r.length-=m;do s[o++]=v[w++];while(--m);r.length===0&&(r.mode=Om);break;case HC:if(u===0)break e;s[o++]=r.length,u--,r.mode=Om;break;case Hv:if(r.wrap){for(;h<32;){if(c===0)break e;c--,f|=a[n++]<<h,h+=8}if(x-=u,e.total_out+=x,r.total+=x,r.wrap&4&&x&&(e.adler=r.check=r.flags?uc(r.check,s,x,o-x):o2(r.check,s,x,o-x)),x=u,r.wrap&4&&(r.flags?f:KC(f))!==r.check){e.msg="incorrect data check",r.mode=Hs;break}f=0,h=0}r.mode=PC;case PC:if(r.wrap&&r.flags){for(;h<32;){if(c===0)break e;c--,f+=a[n++]<<h,h+=8}if(r.wrap&4&&f!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=Hs;break}f=0,h=0}r.mode=qC;case qC:V=TZ;break e;case Hs:V=yT;break e;case BT:return kT;case CT:default:return aA}return e.next_out=o,e.avail_out=u,e.next_in=n,e.avail_in=c,r.hold=f,r.bits=h,(r.wsize||x!==e.avail_out&&r.mode<Hs&&(r.mode<Hv||t!==wC))&&TT(e,e.output,e.next_out,x-e.avail_out),g-=e.avail_in,x-=e.avail_out,e.total_in+=g,e.total_out+=x,r.total+=x,r.wrap&4&&x&&(e.adler=r.check=r.flags?uc(r.check,s,x,e.next_out-x):o2(r.check,s,x,e.next_out-x)),e.data_type=r.bits+(r.last?64:0)+(r.mode===Jc?128:0)+(r.mode===Qm||r.mode===Mv?256:0),(g===0&&x===0||t===wC)&&V===ad&&(V=jZ),V},PZ=e=>{if(cd(e))return aA;let t=e.state;return t.window&&(t.window=null),e.state=null,ad},qZ=(e,t)=>{if(cd(e))return aA;const r=e.state;return(r.wrap&2)===0?aA:(r.head=t,t.done=!1,ad)},KZ=(e,t)=>{const r=t.length;let a,s,n;return cd(e)||(a=e.state,a.wrap!==0&&a.mode!==qx)?aA:a.mode===qx&&(s=1,s=o2(s,t,r,0),s!==a.check)?yT:(n=TT(e,t,r,r),n?(a.mode=BT,kT):(a.havedict=1,ad))};var zZ=NT,VZ=ET,GZ=ST,WZ=RZ,$Z=FT,XZ=HZ,YZ=PZ,JZ=qZ,ZZ=KZ,eee="pako inflate (from Nodeca project)",eu={inflateReset:zZ,inflateReset2:VZ,inflateResetKeep:GZ,inflateInit:WZ,inflateInit2:$Z,inflate:XZ,inflateEnd:YZ,inflateGetHeader:JZ,inflateSetDictionary:ZZ,inflateInfo:eee};function tee(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var ree=tee;const LT=Object.prototype.toString,{Z_NO_FLUSH:aee,Z_FINISH:see,Z_OK:qp,Z_STREAM_END:Kv,Z_NEED_DICT:zv,Z_STREAM_ERROR:nee,Z_DATA_ERROR:VC,Z_MEM_ERROR:iee}=xT;function sg(e){this.options=bT.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15)===0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new wZ,this.strm.avail_out=0;let r=eu.inflateInit2(this.strm,t.windowBits);if(r!==qp)throw new Error(A2[r]);if(this.header=new ree,eu.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=c2.string2buf(t.dictionary):LT.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=eu.inflateSetDictionary(this.strm,t.dictionary),r!==qp)))throw new Error(A2[r])}sg.prototype.push=function(e,t){const r=this.strm,a=this.options.chunkSize,s=this.options.dictionary;let n,o,c;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?see:aee,LT.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(a),r.next_out=0,r.avail_out=a),n=eu.inflate(r,o),n===zv&&s&&(n=eu.inflateSetDictionary(r,s),n===qp?n=eu.inflate(r,o):n===VC&&(n=zv));r.avail_in>0&&n===Kv&&r.state.wrap>0&&e[r.next_in]!==0;)eu.inflateReset(r),n=eu.inflate(r,o);switch(n){case nee:case VC:case zv:case iee:return this.onEnd(n),this.ended=!0,!1}if(c=r.avail_out,r.next_out&&(r.avail_out===0||n===Kv))if(this.options.to==="string"){let u=c2.utf8border(r.output,r.next_out),f=r.next_out-u,h=c2.buf2string(r.output,u);r.next_out=f,r.avail_out=a-f,f&&r.output.set(r.output.subarray(u,u+f),0),this.onData(h)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(n===qp&&c===0)){if(n===Kv)return n=eu.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};sg.prototype.onData=function(e){this.chunks.push(e)};sg.prototype.onEnd=function(e){e===qp&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=bT.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function lee(e,t){const r=new sg(t);if(r.push(e),r.err)throw r.msg||A2[r.err];return r.result}var oee=sg,Aee=lee,cee={Inflate:oee,inflate:Aee};const{Inflate:uee,inflate:dee}=cee;var GC=uee,fee=dee;const jT=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;jT[e]=t}const WC=4294967295;function hee(e,t,r){let a=e;for(let s=0;s<r;s++)a=jT[(a^t[s])&255]^a>>>8;return a}function pee(e,t){return(hee(WC,e,t)^WC)>>>0}function $C(e,t,r){const a=e.readUint32(),s=pee(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(s!==a)throw new Error(`CRC mismatch for chunk ${r}. Expected ${a}, found ${s}`)}function UT(e,t,r){for(let a=0;a<r;a++)t[a]=e[a]}function DT(e,t,r,a){let s=0;for(;s<a;s++)t[s]=e[s];for(;s<r;s++)t[s]=e[s]+t[s-a]&255}function IT(e,t,r,a){let s=0;if(r.length===0)for(;s<a;s++)t[s]=e[s];else for(;s<a;s++)t[s]=e[s]+r[s]&255}function QT(e,t,r,a,s){let n=0;if(r.length===0){for(;n<s;n++)t[n]=e[n];for(;n<a;n++)t[n]=e[n]+(t[n-s]>>1)&255}else{for(;n<s;n++)t[n]=e[n]+(r[n]>>1)&255;for(;n<a;n++)t[n]=e[n]+(t[n-s]+r[n]>>1)&255}}function OT(e,t,r,a,s){let n=0;if(r.length===0){for(;n<s;n++)t[n]=e[n];for(;n<a;n++)t[n]=e[n]+t[n-s]&255}else{for(;n<s;n++)t[n]=e[n]+r[n]&255;for(;n<a;n++)t[n]=e[n]+gee(t[n-s],r[n],r[n-s])&255}}function gee(e,t,r){const a=e+t-r,s=Math.abs(a-e),n=Math.abs(a-t),o=Math.abs(a-r);return s<=n&&s<=o?e:n<=o?t:r}function mee(e,t,r,a,s,n){switch(e){case 0:UT(t,r,s);break;case 1:DT(t,r,s,n);break;case 2:IT(t,r,a,s);break;case 3:QT(t,r,a,s,n);break;case 4:OT(t,r,a,s,n);break;default:throw new Error(`Unsupported filter: ${e}`)}}const xee=new Uint16Array([255]),bee=new Uint8Array(xee.buffer),vee=bee[0]===255;function wee(e){const{data:t,width:r,height:a,channels:s,depth:n}=e,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],c=Math.ceil(n/8)*s,u=new Uint8Array(a*r*c);let f=0;for(let h=0;h<7;h++){const g=o[h],x=Math.ceil((r-g.x)/g.xStep),m=Math.ceil((a-g.y)/g.yStep);if(x<=0||m<=0)continue;const w=x*c,v=new Uint8Array(w);for(let B=0;B<m;B++){const k=t[f++],E=t.subarray(f,f+w);f+=w;const S=new Uint8Array(w);mee(k,E,S,v,w,c),v.set(S);for(let L=0;L<x;L++){const P=g.x+L*g.xStep,R=g.y+B*g.yStep;if(!(P>=r||R>=a))for(let Q=0;Q<c;Q++)u[(R*r+P)*c+Q]=S[L*c+Q]}}}if(n===16){const h=new Uint16Array(u.buffer);if(vee)for(let g=0;g<h.length;g++)h[g]=_ee(h[g]);return h}else return u}function _ee(e){return(e&255)<<8|e>>8&255}const yee=new Uint16Array([255]),kee=new Uint8Array(yee.buffer),Bee=kee[0]===255,Cee=new Uint8Array(0);function XC(e){const{data:t,width:r,height:a,channels:s,depth:n}=e,o=Math.ceil(n/8)*s,c=Math.ceil(n/8*s*r),u=new Uint8Array(a*c);let f=Cee,h=0,g,x;for(let m=0;m<a;m++){switch(g=t.subarray(h+1,h+1+c),x=u.subarray(m*c,(m+1)*c),t[h]){case 0:UT(g,x,c);break;case 1:DT(g,x,c,o);break;case 2:IT(g,x,f,c);break;case 3:QT(g,x,f,c,o);break;case 4:OT(g,x,f,c,o);break;default:throw new Error(`Unsupported filter: ${t[h]}`)}f=x,h+=c+1}if(n===16){const m=new Uint16Array(u.buffer);if(Bee)for(let w=0;w<m.length;w++)m[w]=See(m[w]);return m}else return u}function See(e){return(e&255)<<8|e>>8&255}const Jm=Uint8Array.of(137,80,78,71,13,10,26,10);function YC(e){if(!Nee(e.readBytes(Jm.length)))throw new Error("wrong PNG signature")}function Nee(e){if(e.length<Jm.length)return!1;for(let t=0;t<Jm.length;t++)if(e[t]!==Jm[t])return!1;return!0}const Eee="tEXt",Fee=0,RT=new TextDecoder("latin1");function Tee(e){if(jee(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const Lee=/^[\u0000-\u00FF]*$/;function jee(e){if(!Lee.test(e))throw new Error("invalid latin1 text")}function Uee(e,t,r){const a=MT(t);e[a]=Dee(t,r-a.length-1)}function MT(e){for(e.mark();e.readByte()!==Fee;);const t=e.offset;e.reset();const r=RT.decode(e.readBytes(t-e.offset-1));return e.skip(1),Tee(r),r}function Dee(e,t){return RT.decode(e.readBytes(t))}const mo={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},Vv={UNKNOWN:-1,DEFLATE:0},JC={UNKNOWN:-1,ADAPTIVE:0},Gv={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Rm={NONE:0,BACKGROUND:1,PREVIOUS:2},Wv={SOURCE:0,OVER:1};class Iee extends j_{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(t,r={}){super(t);const{checkCrc:a=!1}=r;this._checkCrc=a,this._inflator=new GC,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Vv.UNKNOWN,this._filterMethod=JC.UNKNOWN,this._interlaceMethod=Gv.UNKNOWN,this._colorType=mo.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(YC(this);!this._end;){const t=this.readUint32(),r=this.readChars(4);this.decodeChunk(t,r)}return this.decodeImage(),this._png}decodeApng(){for(YC(this);!this._end;){const t=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(t,r)}return this.decodeApngImage(),this._apng}decodeChunk(t,r){const a=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(t);break;case"IDAT":this.decodeIDAT(t);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(t);break;case"iCCP":this.decodeiCCP(t);break;case Eee:Uee(this._png.text,this,t);break;case"pHYs":this.decodepHYs();break;default:this.skip(t);break}if(this.offset-a!==t)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?$C(this,t+4,r):this.skip(4)}decodeApngChunk(t,r){const a=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(t);break;default:this.decodeChunk(t,r),this.offset=a+t;break}if(this.offset-a!==t)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?$C(this,t+4,r):this.skip(4)}decodeIHDR(){const t=this._png;t.width=this.readUint32(),t.height=this.readUint32(),t.depth=Qee(this.readUint8());const r=this.readUint8();this._colorType=r;let a;switch(r){case mo.GREYSCALE:a=1;break;case mo.TRUECOLOUR:a=3;break;case mo.INDEXED_COLOUR:a=1;break;case mo.GREYSCALE_ALPHA:a=2;break;case mo.TRUECOLOUR_ALPHA:a=4;break;case mo.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=a,this._compressionMethod=this.readUint8(),this._compressionMethod!==Vv.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const t={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(t)}decodePLTE(t){if(t%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${t}`);const r=t/3;this._hasPalette=!0;const a=[];this._palette=a;for(let s=0;s<r;s++)a.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(t){this._writingDataChunks=!0;const r=t,a=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,a,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodeFDAT(t){this._writingDataChunks=!0;let r=t,a=this.offset+this.byteOffset;if(a+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,a,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodetRNS(t){switch(this._colorType){case mo.GREYSCALE:case mo.TRUECOLOUR:{if(t%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${t}`);if(t/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${t/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(t/2);for(let r=0;r<t/2;r++)this._transparency[r]=this.readUint16();break}case mo.INDEXED_COLOUR:{if(t>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${t} vs ${this._palette.length})`);let r=0;for(;r<t;r++){const a=this.readByte();this._palette[r].push(a)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case mo.UNKNOWN:case mo.GREYSCALE_ALPHA:case mo.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(t){const r=MT(this),a=this.readUint8();if(a!==Vv.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${a}`);const s=this.readBytes(t-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:fee(s)}}decodepHYs(){const t=this.readUint32(),r=this.readUint32(),a=this.readByte();this._png.resolution={x:t,y:r,unit:a}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let t=0;t<this._numberOfFrames;t++){const r={sequenceNumber:this._frames[t].sequenceNumber,delayNumber:this._frames[t].delayNumber,delayDenominator:this._frames[t].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},a=this._frames.at(t);if(a){if(a.data=XC({data:a.data,width:a.width,height:a.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),t===0||a.xOffset===0&&a.yOffset===0&&a.width===this._png.width&&a.height===this._png.height)r.data=a.data;else{const s=this._apng.frames.at(t-1);this.disposeFrame(a,s,r),this.addFrameDataToCanvas(r,a)}this._apng.frames.push(r)}}return this._apng}disposeFrame(t,r,a){switch(t.disposeOp){case Rm.NONE:break;case Rm.BACKGROUND:for(let s=0;s<this._png.height;s++)for(let n=0;n<this._png.width;n++){const o=(s*t.width+n)*this._png.channels;for(let c=0;c<this._png.channels;c++)a.data[o+c]=0}break;case Rm.PREVIOUS:a.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(t,r){const a=1<<this._png.depth,s=(n,o)=>{const c=((n+r.yOffset)*this._png.width+r.xOffset+o)*this._png.channels,u=(n*r.width+o)*this._png.channels;return{index:c,frameIndex:u}};switch(r.blendOp){case Wv.SOURCE:for(let n=0;n<r.height;n++)for(let o=0;o<r.width;o++){const{index:c,frameIndex:u}=s(n,o);for(let f=0;f<this._png.channels;f++)t.data[c+f]=r.data[u+f]}break;case Wv.OVER:for(let n=0;n<r.height;n++)for(let o=0;o<r.width;o++){const{index:c,frameIndex:u}=s(n,o);for(let f=0;f<this._png.channels;f++){const h=r.data[u+this._png.channels-1]/a,g=f%(this._png.channels-1)===0?1:r.data[u+f],x=Math.floor(h*g+(1-h)*t.data[c+f]);t.data[c+f]+=x}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const t=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==JC.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Gv.NO_INTERLACE)this._png.data=XC({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Gv.ADAM7)this._png.data=wee({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const t=this._inflator.result,r=this._frames.at(-1);r?r.data=t:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Rm.NONE,blendOp:Wv.SOURCE,data:t}),this._inflator=new GC,this._writingDataChunks=!1}}function Qee(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var ZC;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(ZC||(ZC={}));function Oee(e,t){return new Iee(e,t).decode()}var Xr=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function $v(){Xr.console&&typeof Xr.console.log=="function"&&Xr.console.log.apply(Xr.console,arguments)}var us={log:$v,warn:function(e){Xr.console&&(typeof Xr.console.warn=="function"?Xr.console.warn.apply(Xr.console,arguments):$v.call(null,arguments))},error:function(e){Xr.console&&(typeof Xr.console.error=="function"?Xr.console.error.apply(Xr.console,arguments):$v(e))}};function Xv(e,t,r){var a=new XMLHttpRequest;a.open("GET",e),a.responseType="blob",a.onload=function(){L0(a.response,t,r)},a.onerror=function(){us.error("could not download file")},a.send()}function eS(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function Mm(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var L0=Xr.saveAs||((typeof window>"u"?"undefined":Ya(window))!=="object"||window!==Xr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var a=Xr.URL||Xr.webkitURL,s=document.createElement("a");t=t||e.name||"download",s.download=t,s.rel="noopener",typeof e=="string"?(s.href=e,s.origin!==location.origin?eS(s.href)?Xv(e,t,r):Mm(s,s.target="_blank"):Mm(s)):(s.href=a.createObjectURL(e),setTimeout(function(){a.revokeObjectURL(s.href)},4e4),setTimeout(function(){Mm(s)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(eS(e))Xv(e,t,r);else{var a=document.createElement("a");a.href=e,a.target="_blank",setTimeout(function(){Mm(a)})}else navigator.msSaveOrOpenBlob((function(s,n){return n===void 0?n={autoBom:!1}:Ya(n)!=="object"&&(us.warn("Deprecated: Expected third argument to be a object"),n={autoBom:!n}),n.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s})(e,r),t)}:function(e,t,r,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),typeof e=="string")return Xv(e,t,r);var s=e.type==="application/octet-stream",n=/constructor/i.test(Xr.HTMLElement)||Xr.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||s&&n)&&(typeof FileReader>"u"?"undefined":Ya(FileReader))==="object"){var c=new FileReader;c.onloadend=function(){var h=c.result;h=o?h:h.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=h:location=h,a=null},c.readAsDataURL(e)}else{var u=Xr.URL||Xr.webkitURL,f=u.createObjectURL(e);a?a.location=f:location.href=f,a=null,setTimeout(function(){u.revokeObjectURL(f)},4e4)}});function HT(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(c){return[parseInt(c[1]),parseInt(c[2]),parseInt(c[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(c){return[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(c){return[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)]}}],a=0;a<r.length;a++){var s=r[a].re,n=r[a].process,o=s.exec(e);o&&(t=n(o),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var c=this.r.toString(16),u=this.g.toString(16),f=this.b.toString(16);return c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),f.length==1&&(f="0"+f),"#"+c+u+f}}var Zm=Xr.atob.bind(Xr),tS=Xr.btoa.bind(Xr);function Yv(e,t){var r=e[0],a=e[1],s=e[2],n=e[3];r=Yi(r,a,s,n,t[0],7,-680876936),n=Yi(n,r,a,s,t[1],12,-389564586),s=Yi(s,n,r,a,t[2],17,606105819),a=Yi(a,s,n,r,t[3],22,-1044525330),r=Yi(r,a,s,n,t[4],7,-176418897),n=Yi(n,r,a,s,t[5],12,1200080426),s=Yi(s,n,r,a,t[6],17,-1473231341),a=Yi(a,s,n,r,t[7],22,-45705983),r=Yi(r,a,s,n,t[8],7,1770035416),n=Yi(n,r,a,s,t[9],12,-1958414417),s=Yi(s,n,r,a,t[10],17,-42063),a=Yi(a,s,n,r,t[11],22,-1990404162),r=Yi(r,a,s,n,t[12],7,1804603682),n=Yi(n,r,a,s,t[13],12,-40341101),s=Yi(s,n,r,a,t[14],17,-1502002290),r=Ji(r,a=Yi(a,s,n,r,t[15],22,1236535329),s,n,t[1],5,-165796510),n=Ji(n,r,a,s,t[6],9,-1069501632),s=Ji(s,n,r,a,t[11],14,643717713),a=Ji(a,s,n,r,t[0],20,-373897302),r=Ji(r,a,s,n,t[5],5,-701558691),n=Ji(n,r,a,s,t[10],9,38016083),s=Ji(s,n,r,a,t[15],14,-660478335),a=Ji(a,s,n,r,t[4],20,-405537848),r=Ji(r,a,s,n,t[9],5,568446438),n=Ji(n,r,a,s,t[14],9,-1019803690),s=Ji(s,n,r,a,t[3],14,-187363961),a=Ji(a,s,n,r,t[8],20,1163531501),r=Ji(r,a,s,n,t[13],5,-1444681467),n=Ji(n,r,a,s,t[2],9,-51403784),s=Ji(s,n,r,a,t[7],14,1735328473),r=Zi(r,a=Ji(a,s,n,r,t[12],20,-1926607734),s,n,t[5],4,-378558),n=Zi(n,r,a,s,t[8],11,-2022574463),s=Zi(s,n,r,a,t[11],16,1839030562),a=Zi(a,s,n,r,t[14],23,-35309556),r=Zi(r,a,s,n,t[1],4,-1530992060),n=Zi(n,r,a,s,t[4],11,1272893353),s=Zi(s,n,r,a,t[7],16,-155497632),a=Zi(a,s,n,r,t[10],23,-1094730640),r=Zi(r,a,s,n,t[13],4,681279174),n=Zi(n,r,a,s,t[0],11,-358537222),s=Zi(s,n,r,a,t[3],16,-722521979),a=Zi(a,s,n,r,t[6],23,76029189),r=Zi(r,a,s,n,t[9],4,-640364487),n=Zi(n,r,a,s,t[12],11,-421815835),s=Zi(s,n,r,a,t[15],16,530742520),r=el(r,a=Zi(a,s,n,r,t[2],23,-995338651),s,n,t[0],6,-198630844),n=el(n,r,a,s,t[7],10,1126891415),s=el(s,n,r,a,t[14],15,-1416354905),a=el(a,s,n,r,t[5],21,-57434055),r=el(r,a,s,n,t[12],6,1700485571),n=el(n,r,a,s,t[3],10,-1894986606),s=el(s,n,r,a,t[10],15,-1051523),a=el(a,s,n,r,t[1],21,-2054922799),r=el(r,a,s,n,t[8],6,1873313359),n=el(n,r,a,s,t[15],10,-30611744),s=el(s,n,r,a,t[6],15,-1560198380),a=el(a,s,n,r,t[13],21,1309151649),r=el(r,a,s,n,t[4],6,-145523070),n=el(n,r,a,s,t[11],10,-1120210379),s=el(s,n,r,a,t[2],15,718787259),a=el(a,s,n,r,t[9],21,-343485551),e[0]=e0(r,e[0]),e[1]=e0(a,e[1]),e[2]=e0(s,e[2]),e[3]=e0(n,e[3])}function _b(e,t,r,a,s,n){return t=e0(e0(t,e),e0(a,n)),e0(t<<s|t>>>32-s,r)}function Yi(e,t,r,a,s,n,o){return _b(t&r|~t&a,e,t,s,n,o)}function Ji(e,t,r,a,s,n,o){return _b(t&a|r&~a,e,t,s,n,o)}function Zi(e,t,r,a,s,n,o){return _b(t^r^a,e,t,s,n,o)}function el(e,t,r,a,s,n,o){return _b(r^(t|~a),e,t,s,n,o)}function PT(e){var t,r=e.length,a=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)Yv(a,Ree(e.substring(t-64,t)));e=e.substring(t-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)s[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(s[t>>2]|=128<<(t%4<<3),t>55)for(Yv(a,s),t=0;t<16;t++)s[t]=0;return s[14]=8*r,Yv(a,s),a}function Ree(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var rS="0123456789abcdef".split("");function Mee(e){for(var t="",r=0;r<4;r++)t+=rS[e>>8*r+4&15]+rS[e>>8*r&15];return t}function Hee(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function u2(e){return PT(e).map(Hee).join("")}var Pee=(function(e){for(var t=0;t<e.length;t++)e[t]=Mee(e[t]);return e.join("")})(PT("hello"))!="5d41402abc4b2a76b9719d911017c592";function e0(e,t){if(Pee){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}function d2(e,t){var r,a,s,n;if(e!==r){for(var o=(s=e,n=1+(256/e.length|0),new Array(n+1).join(s)),c=[],u=0;u<256;u++)c[u]=u;var f=0;for(u=0;u<256;u++){var h=c[u];f=(f+h+o.charCodeAt(u))%256,c[u]=c[f],c[f]=h}r=e,a=c}else c=a;var g=t.length,x=0,m=0,w="";for(u=0;u<g;u++)m=(m+(h=c[x=(x+1)%256]))%256,c[x]=c[m],c[m]=h,o=c[(c[x]+c[m])%256],w+=String.fromCharCode(t.charCodeAt(u)^o);return w}var aS={print:4,modify:8,copy:16,"annot-forms":32};function uf(e,t,r,a){this.v=1,this.r=2;var s=192;e.forEach(function(c){if(aS.perm!==void 0)throw new Error("Invalid permission: "+c);s+=aS[c]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var n=(t+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(n,o),this.P=-(1+(255^s)),this.encryptionKey=u2(n+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(a)).substr(0,5),this.U=d2(this.encryptionKey,this.padding)}function df(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,a=0;a<r;a++){var s=e.charCodeAt(a);t+=s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?"#"+("0"+s.toString(16)).slice(-2):e[a]}return t}function sS(e){if(Ya(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,a,s){if(s=s||!1,typeof r!="string"||typeof a!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var n=Math.random().toString(35);return t[r][n]=[a,!!s],n},this.unsubscribe=function(r){for(var a in t)if(t[a][r])return delete t[a][r],Object.keys(t[a]).length===0&&delete t[a],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var a=Array.prototype.slice.call(arguments,1),s=[];for(var n in t[r]){var o=t[r][n];try{o[0].apply(e,a)}catch(c){Xr.console&&us.error("jsPDF PubSub Error",c.message,c)}o[1]&&s.push(n)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Kx(e){if(!(this instanceof Kx))return new Kx(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function qT(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function D0(e,t,r,a,s){if(!(this instanceof D0))return new D0(e,t,r,a,s);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,qT.call(this,a,s)}function mf(e,t,r,a,s){if(!(this instanceof mf))return new mf(e,t,r,a,s);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,qT.call(this,a,s)}function _r(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",a=arguments[1],s=arguments[2],n=arguments[3],o=[],c=1,u=16,f="S",h=null;Ya(e=e||{})==="object"&&(r=e.orientation,a=e.unit||a,s=e.format||s,n=e.compress||e.compressPdf||n,(h=e.encryption||null)!==null&&(h.userPassword=h.userPassword||"",h.ownerPassword=h.ownerPassword||"",h.userPermissions=h.userPermissions||[]),c=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(u=e.floatPrecision),f=e.defaultPathOperation||"S"),o=e.filters||(n===!0?["FlateEncode"]:o),a=a||"mm",r=(""+(r||"P")).toLowerCase();var g=e.putOnlyUsedFonts||!1,x={},m={internal:{},__private__:{}};m.__private__.PubSub=sS;var w="1.3",v=m.__private__.getPdfVersion=function(){return w};m.__private__.setPdfVersion=function(N){w=N};var B={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};m.__private__.getPageFormats=function(){return B};var k=m.__private__.getPageFormat=function(N){return B[N]};s=s||"a4";var E="compat",S="advanced",L=E;function P(){this.saveGraphicsState(),se(new Bt(Nt,0,0,-Nt,0,pn()*Nt).toString()+" cm"),this.setFontSize(this.getFontSize()/Nt),f="n",L=S}function R(){this.restoreGraphicsState(),f="S",L=E}var Q=m.__private__.combineFontStyleAndFontWeight=function(N,ae){if(N=="bold"&&ae=="normal"||N=="bold"&&ae==400||N=="normal"&&ae=="italic"||N=="bold"&&ae=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return ae&&(N=ae==400||ae==="normal"?N==="italic"?"italic":"normal":ae!=700&&ae!=="bold"||N!=="normal"?(ae==700?"bold":ae)+""+N:"bold"),N};m.advancedAPI=function(N){var ae=L===E;return ae&&P.call(this),typeof N!="function"||(N(this),ae&&R.call(this)),this},m.compatAPI=function(N){var ae=L===S;return ae&&R.call(this),typeof N!="function"||(N(this),ae&&P.call(this)),this},m.isAdvancedAPI=function(){return L===S};var V,U=function(N){if(L!==S)throw new Error(N+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},M=m.roundToPrecision=m.__private__.roundToPrecision=function(N,ae){var Se=t||ae;if(isNaN(N)||isNaN(Se))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return N.toFixed(Se).replace(/0+$/,"")};V=m.hpf=m.__private__.hpf=typeof u=="number"?function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.hpf");return M(N,u)}:u==="smart"?function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.hpf");return M(N,N>-1&&N<1?16:5)}:function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.hpf");return M(N,16)};var T=m.f2=m.__private__.f2=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.f2");return M(N,2)},D=m.__private__.f3=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.f3");return M(N,3)},G=m.scale=m.__private__.scale=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.scale");return L===E?N*Nt:L===S?N:void 0},ne=function(N){return G((function(ae){return L===E?pn()-ae:L===S?ae:void 0})(N))};m.__private__.setPrecision=m.setPrecision=function(N){typeof parseInt(N,10)=="number"&&(t=parseInt(N,10))};var H,ee="00000000000000000000000000000000",le=m.__private__.getFileId=function(){return ee},pe=m.__private__.setFileId=function(N){return ee=N!==void 0&&/^[a-fA-F0-9]{32}$/.test(N)?N.toUpperCase():ee.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),h!==null&&(hs=new uf(h.userPermissions,h.userPassword,h.ownerPassword,ee)),ee};m.setFileId=function(N){return pe(N),this},m.getFileId=function(){return le()};var te=m.__private__.convertDateToPDFDate=function(N){var ae=N.getTimezoneOffset(),Se=ae<0?"+":"-",Qe=Math.floor(Math.abs(ae/60)),ze=Math.abs(ae%60),ct=[Se,I(Qe),"'",I(ze),"'"].join("");return["D:",N.getFullYear(),I(N.getMonth()+1),I(N.getDate()),I(N.getHours()),I(N.getMinutes()),I(N.getSeconds()),ct].join("")},Le=m.__private__.convertPDFDateToDate=function(N){var ae=parseInt(N.substr(2,4),10),Se=parseInt(N.substr(6,2),10)-1,Qe=parseInt(N.substr(8,2),10),ze=parseInt(N.substr(10,2),10),ct=parseInt(N.substr(12,2),10),wt=parseInt(N.substr(14,2),10);return new Date(ae,Se,Qe,ze,ct,wt,0)},je=m.__private__.setCreationDate=function(N){var ae;if(N===void 0&&(N=new Date),N instanceof Date)ae=te(N);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(N))throw new Error("Invalid argument passed to jsPDF.setCreationDate");ae=N}return H=ae},F=m.__private__.getCreationDate=function(N){var ae=H;return N==="jsDate"&&(ae=Le(H)),ae};m.setCreationDate=function(N){return je(N),this},m.getCreationDate=function(N){return F(N)};var K,I=m.__private__.padd2=function(N){return("0"+parseInt(N)).slice(-2)},q=m.__private__.padd2Hex=function(N){return("00"+(N=N.toString())).substr(N.length)},J=0,Y=[],de=[],ue=0,we=[],Ie=[],Ae=!1,oe=de;m.__private__.setCustomOutputDestination=function(N){Ae=!0,oe=N};var He=function(N){Ae||(oe=N)};m.__private__.resetCustomOutputDestination=function(){Ae=!1,oe=de};var se=m.__private__.out=function(N){return N=N.toString(),ue+=N.length+1,oe.push(N),oe},qe=m.__private__.write=function(N){return se(arguments.length===1?N.toString():Array.prototype.join.call(arguments," "))},Ye=m.__private__.getArrayBuffer=function(N){for(var ae=N.length,Se=new ArrayBuffer(ae),Qe=new Uint8Array(Se);ae--;)Qe[ae]=N.charCodeAt(ae);return Se},at=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];m.__private__.getStandardFonts=function(){return at};var Ge=e.fontSize||16;m.__private__.setFontSize=m.setFontSize=function(N){return Ge=L===S?N/Nt:N,this};var pt,nt=m.__private__.getFontSize=m.getFontSize=function(){return L===E?Ge:Ge*Nt},Dt=e.R2L||!1;m.__private__.setR2L=m.setR2L=function(N){return Dt=N,this},m.__private__.getR2L=m.getR2L=function(){return Dt};var It,Ot=m.__private__.setZoomMode=function(N){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(N))pt=N;else if(isNaN(N)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(N)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+N+'" is not recognized.');pt=N}else pt=parseInt(N,10)};m.__private__.getZoomMode=function(){return pt};var sr,er=m.__private__.setPageMode=function(N){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(N)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+N+'" is not recognized.');It=N};m.__private__.getPageMode=function(){return It};var cr=m.__private__.setLayoutMode=function(N){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(N)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+N+'" is not recognized.');sr=N};m.__private__.getLayoutMode=function(){return sr},m.__private__.setDisplayMode=m.setDisplayMode=function(N,ae,Se){return Ot(N),cr(ae),er(Se),this};var Vt={title:"",subject:"",author:"",keywords:"",creator:""};m.__private__.getDocumentProperty=function(N){if(Object.keys(Vt).indexOf(N)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Vt[N]},m.__private__.getDocumentProperties=function(){return Vt},m.__private__.setDocumentProperties=m.setProperties=m.setDocumentProperties=function(N){for(var ae in Vt)Vt.hasOwnProperty(ae)&&N[ae]&&(Vt[ae]=N[ae]);return this},m.__private__.setDocumentProperty=function(N,ae){if(Object.keys(Vt).indexOf(N)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Vt[N]=ae};var mt,Nt,gt,dr,Ht,Rt={},$t={},vr=[],vt={},kr={},tr={},rr={},Xt=null,Kt=0,Ft=[],Zt=new sS(m),wr=e.hotfixes||[],Re={},Et={},Tt=[],Bt=function N(ae,Se,Qe,ze,ct,wt){if(!(this instanceof N))return new N(ae,Se,Qe,ze,ct,wt);isNaN(ae)&&(ae=1),isNaN(Se)&&(Se=0),isNaN(Qe)&&(Qe=0),isNaN(ze)&&(ze=1),isNaN(ct)&&(ct=0),isNaN(wt)&&(wt=0),this._matrix=[ae,Se,Qe,ze,ct,wt]};Object.defineProperty(Bt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(N){this._matrix[0]=N}}),Object.defineProperty(Bt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(N){this._matrix[1]=N}}),Object.defineProperty(Bt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(N){this._matrix[2]=N}}),Object.defineProperty(Bt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(N){this._matrix[3]=N}}),Object.defineProperty(Bt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(N){this._matrix[4]=N}}),Object.defineProperty(Bt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(N){this._matrix[5]=N}}),Object.defineProperty(Bt.prototype,"a",{get:function(){return this._matrix[0]},set:function(N){this._matrix[0]=N}}),Object.defineProperty(Bt.prototype,"b",{get:function(){return this._matrix[1]},set:function(N){this._matrix[1]=N}}),Object.defineProperty(Bt.prototype,"c",{get:function(){return this._matrix[2]},set:function(N){this._matrix[2]=N}}),Object.defineProperty(Bt.prototype,"d",{get:function(){return this._matrix[3]},set:function(N){this._matrix[3]=N}}),Object.defineProperty(Bt.prototype,"e",{get:function(){return this._matrix[4]},set:function(N){this._matrix[4]=N}}),Object.defineProperty(Bt.prototype,"f",{get:function(){return this._matrix[5]},set:function(N){this._matrix[5]=N}}),Object.defineProperty(Bt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Bt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Bt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Bt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Bt.prototype.join=function(N){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(V).join(N)},Bt.prototype.multiply=function(N){var ae=N.sx*this.sx+N.shy*this.shx,Se=N.sx*this.shy+N.shy*this.sy,Qe=N.shx*this.sx+N.sy*this.shx,ze=N.shx*this.shy+N.sy*this.sy,ct=N.tx*this.sx+N.ty*this.shx+this.tx,wt=N.tx*this.shy+N.ty*this.sy+this.ty;return new Bt(ae,Se,Qe,ze,ct,wt)},Bt.prototype.decompose=function(){var N=this.sx,ae=this.shy,Se=this.shx,Qe=this.sy,ze=this.tx,ct=this.ty,wt=Math.sqrt(N*N+ae*ae),Gt=(N/=wt)*Se+(ae/=wt)*Qe;Se-=N*Gt,Qe-=ae*Gt;var pr=Math.sqrt(Se*Se+Qe*Qe);return Gt/=pr,N*(Qe/=pr)<ae*(Se/=pr)&&(N=-N,ae=-ae,Gt=-Gt,wt=-wt),{scale:new Bt(wt,0,0,pr,0,0),translate:new Bt(1,0,0,1,ze,ct),rotate:new Bt(N,ae,-ae,N,0,0),skew:new Bt(1,0,Gt,1,0,0)}},Bt.prototype.toString=function(N){return this.join(" ")},Bt.prototype.inversed=function(){var N=this.sx,ae=this.shy,Se=this.shx,Qe=this.sy,ze=this.tx,ct=this.ty,wt=1/(N*Qe-ae*Se),Gt=Qe*wt,pr=-ae*wt,Ur=-Se*wt,Wr=N*wt;return new Bt(Gt,pr,Ur,Wr,-Gt*ze-Ur*ct,-pr*ze-Wr*ct)},Bt.prototype.applyToPoint=function(N){var ae=N.x*this.sx+N.y*this.shx+this.tx,Se=N.x*this.shy+N.y*this.sy+this.ty;return new Mi(ae,Se)},Bt.prototype.applyToRectangle=function(N){var ae=this.applyToPoint(N),Se=this.applyToPoint(new Mi(N.x+N.w,N.y+N.h));return new lo(ae.x,ae.y,Se.x-ae.x,Se.y-ae.y)},Bt.prototype.clone=function(){var N=this.sx,ae=this.shy,Se=this.shx,Qe=this.sy,ze=this.tx,ct=this.ty;return new Bt(N,ae,Se,Qe,ze,ct)},m.Matrix=Bt;var Yt=m.matrixMult=function(N,ae){return ae.multiply(N)},Mr=new Bt(1,0,0,1,0,0);m.unitMatrix=m.identityMatrix=Mr;var Jr=function(N,ae){if(!kr[N]){var Se=(ae instanceof D0?"Sh":"P")+(Object.keys(vt).length+1).toString(10);ae.id=Se,kr[N]=Se,vt[Se]=ae,Zt.publish("addPattern",ae)}};m.ShadingPattern=D0,m.TilingPattern=mf,m.addShadingPattern=function(N,ae){return U("addShadingPattern()"),Jr(N,ae),this},m.beginTilingPattern=function(N){U("beginTilingPattern()"),Ni(N.boundingBox[0],N.boundingBox[1],N.boundingBox[2]-N.boundingBox[0],N.boundingBox[3]-N.boundingBox[1],N.matrix)},m.endTilingPattern=function(N,ae){U("endTilingPattern()"),ae.stream=Ie[K].join(`
`),Jr(N,ae),Zt.publish("endTilingPattern",ae),Tt.pop().restore()};var jr,fr=m.__private__.newObject=function(){var N=Cr();return re(N,!0),N},Cr=m.__private__.newObjectDeferred=function(){return J++,Y[J]=function(){return ue},J},re=function(N,ae){return ae=typeof ae=="boolean"&&ae,Y[N]=ue,ae&&se(N+" 0 obj"),N},ke=m.__private__.newAdditionalObject=function(){var N={objId:Cr(),content:""};return we.push(N),N},me=Cr(),be=Cr(),ye=m.__private__.decodeColorString=function(N){var ae=N.split(" ");if(ae.length!==2||ae[1]!=="g"&&ae[1]!=="G")ae.length!==5||ae[4]!=="k"&&ae[4]!=="K"||(ae=[(1-ae[0])*(1-ae[3]),(1-ae[1])*(1-ae[3]),(1-ae[2])*(1-ae[3]),"r"]);else{var Se=parseFloat(ae[0]);ae=[Se,Se,Se,"r"]}for(var Qe="#",ze=0;ze<3;ze++)Qe+=("0"+Math.floor(255*parseFloat(ae[ze])).toString(16)).slice(-2);return Qe},O=m.__private__.encodeColorString=function(N){var ae;typeof N=="string"&&(N={ch1:N});var Se=N.ch1,Qe=N.ch2,ze=N.ch3,ct=N.ch4,wt=N.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Se=="string"&&Se.charAt(0)!=="#"){var Gt=new HT(Se);if(Gt.ok)Se=Gt.toHex();else if(!/^\d*\.?\d*$/.test(Se))throw new Error('Invalid color "'+Se+'" passed to jsPDF.encodeColorString.')}if(typeof Se=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Se)&&(Se="#"+Se[1]+Se[1]+Se[2]+Se[2]+Se[3]+Se[3]),typeof Se=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Se)){var pr=parseInt(Se.substr(1),16);Se=pr>>16&255,Qe=pr>>8&255,ze=255&pr}if(Qe===void 0||ct===void 0&&Se===Qe&&Qe===ze)ae=typeof Se=="string"?Se+" "+wt[0]:N.precision===2?T(Se/255)+" "+wt[0]:D(Se/255)+" "+wt[0];else if(ct===void 0||Ya(ct)==="object"){if(ct&&!isNaN(ct.a)&&ct.a===0)return["1.","1.","1.",wt[1]].join(" ");ae=typeof Se=="string"?[Se,Qe,ze,wt[1]].join(" "):N.precision===2?[T(Se/255),T(Qe/255),T(ze/255),wt[1]].join(" "):[D(Se/255),D(Qe/255),D(ze/255),wt[1]].join(" ")}else ae=typeof Se=="string"?[Se,Qe,ze,ct,wt[2]].join(" "):N.precision===2?[T(Se),T(Qe),T(ze),T(ct),wt[2]].join(" "):[D(Se),D(Qe),D(ze),D(ct),wt[2]].join(" ");return ae},ce=m.__private__.getFilters=function(){return o},Fe=m.__private__.putStream=function(N){var ae=(N=N||{}).data||"",Se=N.filters||ce(),Qe=N.alreadyAppliedFilters||[],ze=N.addLength1||!1,ct=ae.length,wt=N.objectId,Gt=function(Ks){return Ks};if(h!==null&&wt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");h!==null&&(Gt=hs.encryptor(wt,0));var pr={};Se===!0&&(Se=["FlateEncode"]);var Ur=N.additionalKeyValues||[],Wr=(pr=_r.API.processDataByFilters!==void 0?_r.API.processDataByFilters(ae,Se):{data:ae,reverseChain:[]}).reverseChain+(Array.isArray(Qe)?Qe.join(" "):Qe.toString());if(pr.data.length!==0&&(Ur.push({key:"Length",value:pr.data.length}),ze===!0&&Ur.push({key:"Length1",value:ct})),Wr.length!=0)if(Wr.split("/").length-1==1)Ur.push({key:"Filter",value:Wr});else{Ur.push({key:"Filter",value:"["+Wr+"]"});for(var da=0;da<Ur.length;da+=1)if(Ur[da].key==="DecodeParms"){for(var Za=[],ps=0;ps<pr.reverseChain.split("/").length-1;ps+=1)Za.push("null");Za.push(Ur[da].value),Ur[da].value="["+Za.join(" ")+"]"}}se("<<");for(var Pa=0;Pa<Ur.length;Pa++)se("/"+Ur[Pa].key+" "+Ur[Pa].value);se(">>"),pr.data.length!==0&&(se("stream"),se(Gt(pr.data)),se("endstream"))},Ne=m.__private__.putPage=function(N){var ae=N.number,Se=N.data,Qe=N.objId,ze=N.contentsObjId;re(Qe,!0),se("<</Type /Page"),se("/Parent "+N.rootDictionaryObjId+" 0 R"),se("/Resources "+N.resourceDictionaryObjId+" 0 R"),se("/MediaBox ["+parseFloat(V(N.mediaBox.bottomLeftX))+" "+parseFloat(V(N.mediaBox.bottomLeftY))+" "+V(N.mediaBox.topRightX)+" "+V(N.mediaBox.topRightY)+"]"),N.cropBox!==null&&se("/CropBox ["+V(N.cropBox.bottomLeftX)+" "+V(N.cropBox.bottomLeftY)+" "+V(N.cropBox.topRightX)+" "+V(N.cropBox.topRightY)+"]"),N.bleedBox!==null&&se("/BleedBox ["+V(N.bleedBox.bottomLeftX)+" "+V(N.bleedBox.bottomLeftY)+" "+V(N.bleedBox.topRightX)+" "+V(N.bleedBox.topRightY)+"]"),N.trimBox!==null&&se("/TrimBox ["+V(N.trimBox.bottomLeftX)+" "+V(N.trimBox.bottomLeftY)+" "+V(N.trimBox.topRightX)+" "+V(N.trimBox.topRightY)+"]"),N.artBox!==null&&se("/ArtBox ["+V(N.artBox.bottomLeftX)+" "+V(N.artBox.bottomLeftY)+" "+V(N.artBox.topRightX)+" "+V(N.artBox.topRightY)+"]"),typeof N.userUnit=="number"&&N.userUnit!==1&&se("/UserUnit "+N.userUnit),Zt.publish("putPage",{objId:Qe,pageContext:Ft[ae],pageNumber:ae,page:Se}),se("/Contents "+ze+" 0 R"),se(">>"),se("endobj");var ct=Se.join(`
`);return L===S&&(ct+=`
Q`),re(ze,!0),Fe({data:ct,filters:ce(),objectId:ze}),se("endobj"),Qe},Te=m.__private__.putPages=function(){var N,ae,Se=[];for(N=1;N<=Kt;N++)Ft[N].objId=Cr(),Ft[N].contentsObjId=Cr();for(N=1;N<=Kt;N++)Se.push(Ne({number:N,data:Ie[N],objId:Ft[N].objId,contentsObjId:Ft[N].contentsObjId,mediaBox:Ft[N].mediaBox,cropBox:Ft[N].cropBox,bleedBox:Ft[N].bleedBox,trimBox:Ft[N].trimBox,artBox:Ft[N].artBox,userUnit:Ft[N].userUnit,rootDictionaryObjId:me,resourceDictionaryObjId:be}));re(me,!0),se("<</Type /Pages");var Qe="/Kids [";for(ae=0;ae<Kt;ae++)Qe+=Se[ae]+" 0 R ";se(Qe+"]"),se("/Count "+Kt),se(">>"),se("endobj"),Zt.publish("postPutPages")},Ue=function(N){Zt.publish("putFont",{font:N,out:se,newObject:fr,putStream:Fe}),N.isAlreadyPutted!==!0&&(N.objectNumber=fr(),se("<<"),se("/Type /Font"),se("/BaseFont /"+df(N.postScriptName)),se("/Subtype /Type1"),typeof N.encoding=="string"&&se("/Encoding /"+N.encoding),se("/FirstChar 32"),se("/LastChar 255"),se(">>"),se("endobj"))},tt=function(N){N.objectNumber=fr();var ae=[];ae.push({key:"Type",value:"/XObject"}),ae.push({key:"Subtype",value:"/Form"}),ae.push({key:"BBox",value:"["+[V(N.x),V(N.y),V(N.x+N.width),V(N.y+N.height)].join(" ")+"]"}),ae.push({key:"Matrix",value:"["+N.matrix.toString()+"]"});var Se=N.pages[1].join(`
`);Fe({data:Se,additionalKeyValues:ae,objectId:N.objectNumber}),se("endobj")},_t=function(N,ae){ae||(ae=21);var Se=fr(),Qe=(function(wt,Gt){var pr,Ur=[],Wr=1/(Gt-1);for(pr=0;pr<1;pr+=Wr)Ur.push(pr);if(Ur.push(1),wt[0].offset!=0){var da={offset:0,color:wt[0].color};wt.unshift(da)}if(wt[wt.length-1].offset!=1){var Za={offset:1,color:wt[wt.length-1].color};wt.push(Za)}for(var ps="",Pa=0,Ks=0;Ks<Ur.length;Ks++){for(pr=Ur[Ks];pr>wt[Pa+1].offset;)Pa++;var Us=wt[Pa].offset,Js=(pr-Us)/(wt[Pa+1].offset-Us),El=wt[Pa].color,ul=wt[Pa+1].color;ps+=q(Math.round((1-Js)*El[0]+Js*ul[0]).toString(16))+q(Math.round((1-Js)*El[1]+Js*ul[1]).toString(16))+q(Math.round((1-Js)*El[2]+Js*ul[2]).toString(16))}return ps.trim()})(N.colors,ae),ze=[];ze.push({key:"FunctionType",value:"0"}),ze.push({key:"Domain",value:"[0.0 1.0]"}),ze.push({key:"Size",value:"["+ae+"]"}),ze.push({key:"BitsPerSample",value:"8"}),ze.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ze.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Fe({data:Qe,additionalKeyValues:ze,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Se}),se("endobj"),N.objectNumber=fr(),se("<< /ShadingType "+N.type),se("/ColorSpace /DeviceRGB");var ct="/Coords ["+V(parseFloat(N.coords[0]))+" "+V(parseFloat(N.coords[1]))+" ";N.type===2?ct+=V(parseFloat(N.coords[2]))+" "+V(parseFloat(N.coords[3])):ct+=V(parseFloat(N.coords[2]))+" "+V(parseFloat(N.coords[3]))+" "+V(parseFloat(N.coords[4]))+" "+V(parseFloat(N.coords[5])),se(ct+="]"),N.matrix&&se("/Matrix ["+N.matrix.toString()+"]"),se("/Function "+Se+" 0 R"),se("/Extend [true true]"),se(">>"),se("endobj")},Ct=function(N,ae){var Se=Cr(),Qe=fr();ae.push({resourcesOid:Se,objectOid:Qe}),N.objectNumber=Qe;var ze=[];ze.push({key:"Type",value:"/Pattern"}),ze.push({key:"PatternType",value:"1"}),ze.push({key:"PaintType",value:"1"}),ze.push({key:"TilingType",value:"1"}),ze.push({key:"BBox",value:"["+N.boundingBox.map(V).join(" ")+"]"}),ze.push({key:"XStep",value:V(N.xStep)}),ze.push({key:"YStep",value:V(N.yStep)}),ze.push({key:"Resources",value:Se+" 0 R"}),N.matrix&&ze.push({key:"Matrix",value:"["+N.matrix.toString()+"]"}),Fe({data:N.stream,additionalKeyValues:ze,objectId:N.objectNumber}),se("endobj")},yt=function(N){for(var ae in N.objectNumber=fr(),se("<<"),N)switch(ae){case"opacity":se("/ca "+T(N[ae]));break;case"stroke-opacity":se("/CA "+T(N[ae]))}se(">>"),se("endobj")},Ut=function(N){re(N.resourcesOid,!0),se("<<"),se("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var ae in se("/Font <<"),Rt)Rt.hasOwnProperty(ae)&&(g===!1||g===!0&&x.hasOwnProperty(ae))&&se("/"+ae+" "+Rt[ae].objectNumber+" 0 R");se(">>")})(),(function(){if(Object.keys(vt).length>0){for(var ae in se("/Shading <<"),vt)vt.hasOwnProperty(ae)&&vt[ae]instanceof D0&&vt[ae].objectNumber>=0&&se("/"+ae+" "+vt[ae].objectNumber+" 0 R");Zt.publish("putShadingPatternDict"),se(">>")}})(),(function(ae){if(Object.keys(vt).length>0){for(var Se in se("/Pattern <<"),vt)vt.hasOwnProperty(Se)&&vt[Se]instanceof m.TilingPattern&&vt[Se].objectNumber>=0&&vt[Se].objectNumber<ae&&se("/"+Se+" "+vt[Se].objectNumber+" 0 R");Zt.publish("putTilingPatternDict"),se(">>")}})(N.objectOid),(function(){if(Object.keys(tr).length>0){var ae;for(ae in se("/ExtGState <<"),tr)tr.hasOwnProperty(ae)&&tr[ae].objectNumber>=0&&se("/"+ae+" "+tr[ae].objectNumber+" 0 R");Zt.publish("putGStateDict"),se(">>")}})(),(function(){for(var ae in se("/XObject <<"),Re)Re.hasOwnProperty(ae)&&Re[ae].objectNumber>=0&&se("/"+ae+" "+Re[ae].objectNumber+" 0 R");Zt.publish("putXobjectDict"),se(">>")})(),se(">>"),se("endobj")},zt=function(N){$t[N.fontName]=$t[N.fontName]||{},$t[N.fontName][N.fontStyle]=N.id},Gr=function(N,ae,Se,Qe,ze){var ct={id:"F"+(Object.keys(Rt).length+1).toString(10),postScriptName:N,fontName:ae,fontStyle:Se,encoding:Qe,isStandardFont:ze||!1,metadata:{}};return Zt.publish("addFont",{font:ct,instance:this}),Rt[ct.id]=ct,zt(ct),ct.id},Qr=m.__private__.pdfEscape=m.pdfEscape=function(N,ae){return(function(Se,Qe){var ze,ct,wt,Gt,pr,Ur,Wr,da,Za;if(wt=(Qe=Qe||{}).sourceEncoding||"Unicode",pr=Qe.outputEncoding,(Qe.autoencode||pr)&&Rt[mt].metadata&&Rt[mt].metadata[wt]&&Rt[mt].metadata[wt].encoding&&(Gt=Rt[mt].metadata[wt].encoding,!pr&&Rt[mt].encoding&&(pr=Rt[mt].encoding),!pr&&Gt.codePages&&(pr=Gt.codePages[0]),typeof pr=="string"&&(pr=Gt[pr]),pr)){for(Wr=!1,Ur=[],ze=0,ct=Se.length;ze<ct;ze++)(da=pr[Se.charCodeAt(ze)])?Ur.push(String.fromCharCode(da)):Ur.push(Se[ze]),Ur[ze].charCodeAt(0)>>8&&(Wr=!0);Se=Ur.join("")}for(ze=Se.length;Wr===void 0&&ze!==0;)Se.charCodeAt(ze-1)>>8&&(Wr=!0),ze--;if(!Wr)return Se;for(Ur=Qe.noBOM?[]:[254,255],ze=0,ct=Se.length;ze<ct;ze++){if((Za=(da=Se.charCodeAt(ze))>>8)>>8)throw new Error("Character at position "+ze+" of string '"+Se+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Ur.push(Za),Ur.push(da-(Za<<8))}return String.fromCharCode.apply(void 0,Ur)})(N,ae).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},oa=m.__private__.beginPage=function(N){Ie[++Kt]=[],Ft[Kt]={objId:0,contentsObjId:0,userUnit:Number(c),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(N[0]),topRightY:Number(N[1])}},Vn(Kt),He(Ie[K])},fs=function(N,ae){var Se,Qe,ze;switch(r=ae||r,typeof N=="string"&&(Se=k(N.toLowerCase()),Array.isArray(Se)&&(Qe=Se[0],ze=Se[1])),Array.isArray(N)&&(Qe=N[0]*Nt,ze=N[1]*Nt),isNaN(Qe)&&(Qe=s[0],ze=s[1]),(Qe>14400||ze>14400)&&(us.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Qe=Math.min(14400,Qe),ze=Math.min(14400,ze)),s=[Qe,ze],r.substr(0,1)){case"l":ze>Qe&&(s=[ze,Qe]);break;case"p":Qe>ze&&(s=[ze,Qe])}oa(s),Sr(No),se(fi),Sl!==0&&se(Sl+" J"),Ka!==0&&se(Ka+" j"),Zt.publish("addPage",{pageNumber:Kt})},Tn=function(N){N>0&&N<=Kt&&(Ie.splice(N,1),Ft.splice(N,1),Kt--,K>Kt&&(K=Kt),this.setPage(K))},Vn=function(N){N>0&&N<=Kt&&(K=N)},ve=m.__private__.getNumberOfPages=m.getNumberOfPages=function(){return Ie.length-1},it=function(N,ae,Se){var Qe,ze=void 0;return Se=Se||{},N=N!==void 0?N:Rt[mt].fontName,ae=ae!==void 0?ae:Rt[mt].fontStyle,Qe=N.toLowerCase(),$t[Qe]!==void 0&&$t[Qe][ae]!==void 0?ze=$t[Qe][ae]:$t[N]!==void 0&&$t[N][ae]!==void 0?ze=$t[N][ae]:Se.disableWarning===!1&&us.warn("Unable to look up font label for font '"+N+"', '"+ae+"'. Refer to getFontList() for available fonts."),ze||Se.noFallback||(ze=$t.times[ae])==null&&(ze=$t.times.normal),ze},St=m.__private__.putInfo=function(){var N=fr(),ae=function(Qe){return Qe};for(var Se in h!==null&&(ae=hs.encryptor(N,0)),se("<<"),se("/Producer ("+Qr(ae("jsPDF "+_r.version))+")"),Vt)Vt.hasOwnProperty(Se)&&Vt[Se]&&se("/"+Se.substr(0,1).toUpperCase()+Se.substr(1)+" ("+Qr(ae(Vt[Se]))+")");se("/CreationDate ("+Qr(ae(H))+")"),se(">>"),se("endobj")},st=m.__private__.putCatalog=function(N){var ae=(N=N||{}).rootDictionaryObjId||me;switch(fr(),se("<<"),se("/Type /Catalog"),se("/Pages "+ae+" 0 R"),pt||(pt="fullwidth"),pt){case"fullwidth":se("/OpenAction [3 0 R /FitH null]");break;case"fullheight":se("/OpenAction [3 0 R /FitV null]");break;case"fullpage":se("/OpenAction [3 0 R /Fit]");break;case"original":se("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Se=""+pt;Se.substr(Se.length-1)==="%"&&(pt=parseInt(pt)/100),typeof pt=="number"&&se("/OpenAction [3 0 R /XYZ null null "+T(pt)+"]")}switch(sr||(sr="continuous"),sr){case"continuous":se("/PageLayout /OneColumn");break;case"single":se("/PageLayout /SinglePage");break;case"two":case"twoleft":se("/PageLayout /TwoColumnLeft");break;case"tworight":se("/PageLayout /TwoColumnRight")}It&&se("/PageMode /"+It),Zt.publish("putCatalog"),se(">>"),se("endobj")},Hr=m.__private__.putTrailer=function(){se("trailer"),se("<<"),se("/Size "+(J+1)),se("/Root "+J+" 0 R"),se("/Info "+(J-1)+" 0 R"),h!==null&&se("/Encrypt "+hs.oid+" 0 R"),se("/ID [ <"+ee+"> <"+ee+"> ]"),se(">>")},yr=m.__private__.putHeader=function(){se("%PDF-"+w),se("%")},wa=m.__private__.putXRef=function(){var N="0000000000";se("xref"),se("0 "+(J+1)),se("0000000000 65535 f ");for(var ae=1;ae<=J;ae++)typeof Y[ae]=="function"?se((N+Y[ae]()).slice(-10)+" 00000 n "):Y[ae]!==void 0?se((N+Y[ae]).slice(-10)+" 00000 n "):se("0000000000 00000 n ")},Na=m.__private__.buildDocument=function(){var N;J=0,ue=0,de=[],Y=[],we=[],me=Cr(),be=Cr(),He(de),Zt.publish("buildDocument"),yr(),Te(),(function(){Zt.publish("putAdditionalObjects");for(var Se=0;Se<we.length;Se++){var Qe=we[Se];re(Qe.objId,!0),se(Qe.content),se("endobj")}Zt.publish("postPutAdditionalObjects")})(),N=[],(function(){for(var Se in Rt)Rt.hasOwnProperty(Se)&&(g===!1||g===!0&&x.hasOwnProperty(Se))&&Ue(Rt[Se])})(),(function(){var Se;for(Se in tr)tr.hasOwnProperty(Se)&&yt(tr[Se])})(),(function(){for(var Se in Re)Re.hasOwnProperty(Se)&&tt(Re[Se])})(),(function(Se){var Qe;for(Qe in vt)vt.hasOwnProperty(Qe)&&(vt[Qe]instanceof D0?_t(vt[Qe]):vt[Qe]instanceof mf&&Ct(vt[Qe],Se))})(N),Zt.publish("putResources"),N.forEach(Ut),Ut({resourcesOid:be,objectOid:Number.MAX_SAFE_INTEGER}),Zt.publish("postPutResources"),h!==null&&(hs.oid=fr(),se("<<"),se("/Filter /Standard"),se("/V "+hs.v),se("/R "+hs.r),se("/U <"+hs.toHexString(hs.U)+">"),se("/O <"+hs.toHexString(hs.O)+">"),se("/P "+hs.P),se(">>"),se("endobj")),St(),st();var ae=ue;return wa(),Hr(),se("startxref"),se(""+ae),se("%%EOF"),He(Ie[K]),de.join(`
`)},Gn=m.__private__.getBlob=function(N){return new Blob([Ye(N)],{type:"application/pdf"})},Lr=m.output=m.__private__.output=(jr=function(N,ae){switch(typeof(ae=ae||{})=="string"?ae={filename:ae}:ae.filename=ae.filename||"generated.pdf",N){case void 0:return Na();case"save":m.save(ae.filename);break;case"arraybuffer":return Ye(Na());case"blob":return Gn(Na());case"bloburi":case"bloburl":if(Xr.URL!==void 0&&typeof Xr.URL.createObjectURL=="function")return Xr.URL&&Xr.URL.createObjectURL(Gn(Na()))||void 0;us.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Se="",Qe=Na();try{Se=tS(Qe)}catch{Se=tS(unescape(encodeURIComponent(Qe)))}return"data:application/pdf;filename="+ae.filename+";base64,"+Se;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Xr)==="[object Window]"){var ze="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",ct=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';ae.pdfObjectUrl&&(ze=ae.pdfObjectUrl,ct="");var wt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ze+'"'+ct+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(ae)+");<\/script></body></html>",Gt=Xr.open();return Gt!==null&&Gt.document.write(wt),Gt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Xr)==="[object Window]"){var pr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(ae.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+ae.filename+'" width="500px" height="400px" /></body></html>',Ur=Xr.open();if(Ur!==null){Ur.document.write(pr);var Wr=this;Ur.document.documentElement.querySelector("#pdfViewer").onload=function(){Ur.document.title=ae.filename,Ur.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Wr.output("bloburl"))}}return Ur}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Xr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var da='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",ae)+'"></iframe></body></html>',Za=Xr.open();if(Za!==null&&(Za.document.write(da),Za.document.title=ae.filename),Za||typeof safari>"u")return Za;break;case"datauri":case"dataurl":return Xr.document.location.href=this.output("datauristring",ae);default:return null}},jr.foo=function(){try{return jr.apply(this,arguments)}catch(Se){var N=Se.stack||"";~N.indexOf(" at ")&&(N=N.split(" at ")[1]);var ae="Error in function "+N.split(`
`)[0].split("<")[0]+": "+Se.message;if(!Xr.console)throw new Error(ae);Xr.console.error(ae,Se),Xr.alert&&alert(ae)}},jr.foo.bar=jr,jr.foo),Ia=function(N){return Array.isArray(wr)===!0&&wr.indexOf(N)>-1};switch(a){case"pt":Nt=1;break;case"mm":Nt=72/25.4;break;case"cm":Nt=72/2.54;break;case"in":Nt=72;break;case"px":Nt=Ia("px_scaling")==1?.75:96/72;break;case"pc":case"em":Nt=12;break;case"ex":Nt=6;break;default:if(typeof a!="number")throw new Error("Invalid unit: "+a);Nt=a}var hs=null;je(),pe();var ls=m.__private__.getPageInfo=m.getPageInfo=function(N){if(isNaN(N)||N%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Ft[N].objId,pageNumber:N,pageContext:Ft[N]}},no=m.__private__.getPageInfoByObjId=function(N){if(isNaN(N)||N%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var ae in Ft)if(Ft[ae].objId===N)break;return ls(ae)},Ln=m.__private__.getCurrentPageInfo=m.getCurrentPageInfo=function(){return{objId:Ft[K].objId,pageNumber:K,pageContext:Ft[K]}};m.addPage=function(){return fs.apply(this,arguments),this},m.setPage=function(){return Vn.apply(this,arguments),He.call(this,Ie[K]),this},m.insertPage=function(N){return this.addPage(),this.movePage(K,N),this},m.movePage=function(N,ae){var Se,Qe;if(N>ae){Se=Ie[N],Qe=Ft[N];for(var ze=N;ze>ae;ze--)Ie[ze]=Ie[ze-1],Ft[ze]=Ft[ze-1];Ie[ae]=Se,Ft[ae]=Qe,this.setPage(ae)}else if(N<ae){Se=Ie[N],Qe=Ft[N];for(var ct=N;ct<ae;ct++)Ie[ct]=Ie[ct+1],Ft[ct]=Ft[ct+1];Ie[ae]=Se,Ft[ae]=Qe,this.setPage(ae)}return this},m.deletePage=function(){return Tn.apply(this,arguments),this},m.__private__.text=m.text=function(N,ae,Se,Qe,ze){var ct,wt,Gt,pr,Ur,Wr,da,Za,ps,Pa=(Qe=Qe||{}).scope||this;if(typeof N=="number"&&typeof ae=="number"&&(typeof Se=="string"||Array.isArray(Se))){var Ks=Se;Se=ae,ae=N,N=Ks}if(arguments[3]instanceof Bt==0?(Gt=arguments[4],pr=arguments[5],Ya(da=arguments[3])==="object"&&da!==null||(typeof Gt=="string"&&(pr=Gt,Gt=null),typeof da=="string"&&(pr=da,da=null),typeof da=="number"&&(Gt=da,da=null),Qe={flags:da,angle:Gt,align:pr})):(U("The transform parameter of text() with a Matrix value"),ps=ze),isNaN(ae)||isNaN(Se)||N==null)throw new Error("Invalid arguments passed to jsPDF.text");if(N.length===0)return Pa;var Us,Js="",El=typeof Qe.lineHeightFactor=="number"?Qe.lineHeightFactor:Ys,ul=Pa.internal.scaleFactor;function Fl(X){return X=X.split("	").join(Array(Qe.TabLen||9).join(" ")),Qr(X,da)}function ws(X){for(var Ee,Ke=X.concat(),ft=[],nr=Ke.length;nr--;)typeof(Ee=Ke.shift())=="string"?ft.push(Ee):Array.isArray(X)&&(Ee.length===1||Ee[1]===void 0&&Ee[2]===void 0)?ft.push(Ee[0]):ft.push([Ee[0],Ee[1],Ee[2]]);return ft}function To(X,Ee){var Ke;if(typeof X=="string")Ke=Ee(X)[0];else if(Array.isArray(X)){for(var ft,nr,ir=X.concat(),Br=[],Or=ir.length;Or--;)typeof(ft=ir.shift())=="string"?Br.push(Ee(ft)[0]):Array.isArray(ft)&&typeof ft[0]=="string"&&(nr=Ee(ft[0],ft[1],ft[2]),Br.push([nr[0],nr[1],nr[2]]));Ke=Br}return Ke}var dl=!1,Pi=!0;if(typeof N=="string")dl=!0;else if(Array.isArray(N)){var cA=N.concat();wt=[];for(var oo,_s=cA.length;_s--;)(typeof(oo=cA.shift())!="string"||Array.isArray(oo)&&typeof oo[0]!="string")&&(Pi=!1);dl=Pi}if(dl===!1)throw new Error('Type of text must be string or Array. "'+N+'" is not recognized.');typeof N=="string"&&(N=N.match(/[\r?\n]/)?N.split(/\r\n|\r|\n/g):[N]);var Lo=Ge/Pa.internal.scaleFactor,Ao=Lo*(El-1);switch(Qe.baseline){case"bottom":Se-=Ao;break;case"top":Se+=Lo-Ao;break;case"hanging":Se+=Lo-2*Ao;break;case"middle":Se+=Lo/2-Ao}if((Wr=Qe.maxWidth||0)>0&&(typeof N=="string"?N=Pa.splitTextToSize(N,Wr):Object.prototype.toString.call(N)==="[object Array]"&&(N=N.reduce(function(X,Ee){return X.concat(Pa.splitTextToSize(Ee,Wr))},[]))),ct={text:N,x:ae,y:Se,options:Qe,mutex:{pdfEscape:Qr,activeFontKey:mt,fonts:Rt,activeFontSize:Ge}},Zt.publish("preProcessText",ct),N=ct.text,Gt=(Qe=ct.options).angle,ps instanceof Bt==0&&Gt&&typeof Gt=="number"){Gt*=Math.PI/180,Qe.rotationDirection===0&&(Gt=-Gt),L===S&&(Gt=-Gt);var KA=Math.cos(Gt),fl=Math.sin(Gt);ps=new Bt(KA,fl,-fl,KA,0,0)}else Gt&&Gt instanceof Bt&&(ps=Gt);L!==S||ps||(ps=Mr),(Ur=Qe.charSpace||bs)!==void 0&&(Js+=V(G(Ur))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Za=Qe.horizontalScale)!==void 0&&(Js+=V(100*Za)+` Tz
`),Qe.lang;var Yn=-1,Tl=Qe.renderingMode!==void 0?Qe.renderingMode:Qe.stroke,jc=Pa.internal.getCurrentPageInfo().pageContext;switch(Tl){case 0:case!1:case"fill":Yn=0;break;case 1:case!0:case"stroke":Yn=1;break;case 2:case"fillThenStroke":Yn=2;break;case 3:case"invisible":Yn=3;break;case 4:case"fillAndAddForClipping":Yn=4;break;case 5:case"strokeAndAddPathForClipping":Yn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Yn=6;break;case 7:case"addToPathForClipping":Yn=7}var uA=jc.usedRenderingMode!==void 0?jc.usedRenderingMode:-1;Yn!==-1?Js+=Yn+` Tr
`:uA!==-1&&(Js+=`0 Tr
`),Yn!==-1&&(jc.usedRenderingMode=Yn),pr=Qe.align||"left";var hi,hl=Ge*El,Ll=Pa.internal.pageSize.getWidth(),jo=Rt[mt];Ur=Qe.charSpace||bs,Wr=Qe.maxWidth||0,da=Object.assign({autoencode:!0,noBOM:!0},Qe.flags);var qi=[],Uo=function(X){return Pa.getStringUnitWidth(X,{font:jo,charSpace:Ur,fontSize:Ge,doKerning:!1})*Ge/ul};if(Object.prototype.toString.call(N)==="[object Array]"){var Jn;wt=ws(N),pr!=="left"&&(hi=wt.map(Uo));var jn,Ki=0;if(pr==="right"){ae-=hi[0],N=[],_s=wt.length;for(var Un=0;Un<_s;Un++)Un===0?(jn=$n(ae),Jn=hn(Se)):(jn=G(Ki-hi[Un]),Jn=-hl),N.push([wt[Un],jn,Jn]),Ki=hi[Un]}else if(pr==="center"){ae-=hi[0]/2,N=[],_s=wt.length;for(var co=0;co<_s;co++)co===0?(jn=$n(ae),Jn=hn(Se)):(jn=G((Ki-hi[co])/2),Jn=-hl),N.push([wt[co],jn,Jn]),Ki=hi[co]}else if(pr==="left"){N=[],_s=wt.length;for(var zA=0;zA<_s;zA++)N.push(wt[zA])}else if(pr==="justify"&&jo.encoding==="Identity-H"){N=[],_s=wt.length,Wr=Wr!==0?Wr:Ll;for(var dA=0,ys=0;ys<_s;ys++)if(Jn=ys===0?hn(Se):-hl,jn=ys===0?$n(ae):dA,ys<_s-1){var fu=G((Wr-hi[ys])/(wt[ys].split(" ").length-1)),jl=wt[ys].split(" ");N.push([jl[0]+" ",jn,Jn]),dA=0;for(var Ul=1;Ul<jl.length;Ul++){var zs=(Uo(jl[Ul-1]+" "+jl[Ul])-Uo(jl[Ul]))*ul+fu;Ul==jl.length-1?N.push([jl[Ul],zs,0]):N.push([jl[Ul]+" ",zs,0]),dA-=zs}}else N.push([wt[ys],jn,Jn]);N.push(["",dA,0])}else{if(pr!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(N=[],_s=wt.length,Wr=Wr!==0?Wr:Ll,ys=0;ys<_s;ys++){Jn=ys===0?hn(Se):-hl,jn=ys===0?$n(ae):0;var Dl=wt[ys].split(" ").length-1,VA=Dl>0?(Wr-hi[ys])/Dl:0;ys<_s-1?qi.push(V(G(VA))):qi.push(0),N.push([wt[ys],jn,Jn])}}}(typeof Qe.R2L=="boolean"?Qe.R2L:Dt)===!0&&(N=To(N,function(X,Ee,Ke){return[X.split("").reverse().join(""),Ee,Ke]})),ct={text:N,x:ae,y:Se,options:Qe,mutex:{pdfEscape:Qr,activeFontKey:mt,fonts:Rt,activeFontSize:Ge}},Zt.publish("postProcessText",ct),N=ct.text,Us=ct.mutex.isHex||!1;var GA=Rt[mt].encoding;GA!=="WinAnsiEncoding"&&GA!=="StandardEncoding"||(N=To(N,function(X,Ee,Ke){return[Fl(X),Ee,Ke]})),wt=ws(N),N=[];for(var zi,Ds,Vi,fA=Array.isArray(wt[0])?1:0,Zn="",pi=function(X,Ee,Ke){var ft="";return Ke instanceof Bt?(Ke=typeof Qe.angle=="number"?Yt(Ke,new Bt(1,0,0,1,X,Ee)):Yt(new Bt(1,0,0,1,X,Ee),Ke),L===S&&(Ke=Yt(new Bt(1,0,0,-1,0,0),Ke)),ft=Ke.join(" ")+` Tm
`):ft=V(X)+" "+V(Ee)+` Td
`,ft},Dn=0;Dn<wt.length;Dn++){switch(Zn="",fA){case 1:Vi=(Us?"<":"(")+wt[Dn][0]+(Us?">":")"),zi=parseFloat(wt[Dn][1]),Ds=parseFloat(wt[Dn][2]);break;case 0:Vi=(Us?"<":"(")+wt[Dn]+(Us?">":")"),zi=$n(ae),Ds=hn(Se)}qi!==void 0&&qi[Dn]!==void 0&&(Zn=qi[Dn]+` Tw
`),Dn===0?N.push(Zn+pi(zi,Ds,ps)+Vi):fA===0?N.push(Zn+Vi):fA===1&&N.push(Zn+pi(zi,Ds,ps)+Vi)}N=fA===0?N.join(` Tj
T* `):N.join(` Tj
`),N+=` Tj
`;var Gi=`BT
/`;return Gi+=mt+" "+Ge+` Tf
`,Gi+=V(Ge*El)+` TL
`,Gi+=Cl+`
`,Gi+=Js,Gi+=N,se(Gi+="ET"),x[mt]=!0,Pa};var io=m.__private__.clip=m.clip=function(N){return se(N==="evenodd"?"W*":"W"),this};m.clipEvenOdd=function(){return io("evenodd")},m.__private__.discardPath=m.discardPath=function(){return se("n"),this};var Ls=m.__private__.isValidStyle=function(N){var ae=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(N)!==-1&&(ae=!0),ae};m.__private__.setDefaultPathOperation=m.setDefaultPathOperation=function(N){return Ls(N)&&(f=N),this};var Bl=m.__private__.getStyle=m.getStyle=function(N){var ae=f;switch(N){case"D":case"S":ae="S";break;case"F":ae="f";break;case"FD":case"DF":ae="B";break;case"f":case"f*":case"B":case"B*":ae=N}return ae},iA=m.close=function(){return se("h"),this};m.stroke=function(){return se("S"),this},m.fill=function(N){return Si("f",N),this},m.fillEvenOdd=function(N){return Si("f*",N),this},m.fillStroke=function(N){return Si("B",N),this},m.fillStrokeEvenOdd=function(N){return Si("B*",N),this};var Si=function(N,ae){Ya(ae)==="object"?Lc(ae,N):se(N)},Wn=function(N){N===null||L===S&&N===void 0||(N=Bl(N),se(N))};function Tc(N,ae,Se,Qe,ze){var ct=new mf(ae||this.boundingBox,Se||this.xStep,Qe||this.yStep,this.gState,ze||this.matrix);ct.stream=this.stream;var wt=N+"$$"+this.cloneIndex+++"$$";return Jr(wt,ct),ct}var Lc=function(N,ae){var Se=kr[N.key],Qe=vt[Se];if(Qe instanceof D0)se("q"),se(lA(ae)),Qe.gState&&m.setGState(Qe.gState),se(N.matrix.toString()+" cm"),se("/"+Se+" sh"),se("Q");else if(Qe instanceof mf){var ze=new Bt(1,0,0,-1,0,pn());N.matrix&&(ze=ze.multiply(N.matrix||Mr),Se=Tc.call(Qe,N.key,N.boundingBox,N.xStep,N.yStep,ze).id),se("q"),se("/Pattern cs"),se("/"+Se+" scn"),Qe.gState&&m.setGState(Qe.gState),se(ae),se("Q")}},lA=function(N){switch(N){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},OA=m.moveTo=function(N,ae){return se(V(G(N))+" "+V(ne(ae))+" m"),this},Ri=m.lineTo=function(N,ae){return se(V(G(N))+" "+V(ne(ae))+" l"),this},fn=m.curveTo=function(N,ae,Se,Qe,ze,ct){return se([V(G(N)),V(ne(ae)),V(G(Se)),V(ne(Qe)),V(G(ze)),V(ne(ct)),"c"].join(" ")),this};m.__private__.line=m.line=function(N,ae,Se,Qe,ze){if(isNaN(N)||isNaN(ae)||isNaN(Se)||isNaN(Qe)||!Ls(ze))throw new Error("Invalid arguments passed to jsPDF.line");return L===E?this.lines([[Se-N,Qe-ae]],N,ae,[1,1],ze||"S"):this.lines([[Se-N,Qe-ae]],N,ae,[1,1]).stroke()},m.__private__.lines=m.lines=function(N,ae,Se,Qe,ze,ct){var wt,Gt,pr,Ur,Wr,da,Za,ps,Pa,Ks,Us,Js;if(typeof N=="number"&&(Js=Se,Se=ae,ae=N,N=Js),Qe=Qe||[1,1],ct=ct||!1,isNaN(ae)||isNaN(Se)||!Array.isArray(N)||!Array.isArray(Qe)||!Ls(ze)||typeof ct!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(OA(ae,Se),wt=Qe[0],Gt=Qe[1],Ur=N.length,Ks=ae,Us=Se,pr=0;pr<Ur;pr++)(Wr=N[pr]).length===2?(Ks=Wr[0]*wt+Ks,Us=Wr[1]*Gt+Us,Ri(Ks,Us)):(da=Wr[0]*wt+Ks,Za=Wr[1]*Gt+Us,ps=Wr[2]*wt+Ks,Pa=Wr[3]*Gt+Us,Ks=Wr[4]*wt+Ks,Us=Wr[5]*Gt+Us,fn(da,Za,ps,Pa,Ks,Us));return ct&&iA(),Wn(ze),this},m.path=function(N){for(var ae=0;ae<N.length;ae++){var Se=N[ae],Qe=Se.c;switch(Se.op){case"m":OA(Qe[0],Qe[1]);break;case"l":Ri(Qe[0],Qe[1]);break;case"c":fn.apply(this,Qe);break;case"h":iA()}}return this},m.__private__.rect=m.rect=function(N,ae,Se,Qe,ze){if(isNaN(N)||isNaN(ae)||isNaN(Se)||isNaN(Qe)||!Ls(ze))throw new Error("Invalid arguments passed to jsPDF.rect");return L===E&&(Qe=-Qe),se([V(G(N)),V(ne(ae)),V(G(Se)),V(G(Qe)),"re"].join(" ")),Wn(ze),this},m.__private__.triangle=m.triangle=function(N,ae,Se,Qe,ze,ct,wt){if(isNaN(N)||isNaN(ae)||isNaN(Se)||isNaN(Qe)||isNaN(ze)||isNaN(ct)||!Ls(wt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Se-N,Qe-ae],[ze-Se,ct-Qe],[N-ze,ae-ct]],N,ae,[1,1],wt,!0),this},m.__private__.roundedRect=m.roundedRect=function(N,ae,Se,Qe,ze,ct,wt){if(isNaN(N)||isNaN(ae)||isNaN(Se)||isNaN(Qe)||isNaN(ze)||isNaN(ct)||!Ls(wt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Gt=4/3*(Math.SQRT2-1);return ze=Math.min(ze,.5*Se),ct=Math.min(ct,.5*Qe),this.lines([[Se-2*ze,0],[ze*Gt,0,ze,ct-ct*Gt,ze,ct],[0,Qe-2*ct],[0,ct*Gt,-ze*Gt,ct,-ze,ct],[2*ze-Se,0],[-ze*Gt,0,-ze,-ct*Gt,-ze,-ct],[0,2*ct-Qe],[0,-ct*Gt,ze*Gt,-ct,ze,-ct]],N+ze,ae,[1,1],wt,!0),this},m.__private__.ellipse=m.ellipse=function(N,ae,Se,Qe,ze){if(isNaN(N)||isNaN(ae)||isNaN(Se)||isNaN(Qe)||!Ls(ze))throw new Error("Invalid arguments passed to jsPDF.ellipse");var ct=4/3*(Math.SQRT2-1)*Se,wt=4/3*(Math.SQRT2-1)*Qe;return OA(N+Se,ae),fn(N+Se,ae-wt,N+ct,ae-Qe,N,ae-Qe),fn(N-ct,ae-Qe,N-Se,ae-wt,N-Se,ae),fn(N-Se,ae+wt,N-ct,ae+Qe,N,ae+Qe),fn(N+ct,ae+Qe,N+Se,ae+wt,N+Se,ae),Wn(ze),this},m.__private__.circle=m.circle=function(N,ae,Se,Qe){if(isNaN(N)||isNaN(ae)||isNaN(Se)||!Ls(Qe))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(N,ae,Se,Se,Qe)},m.setFont=function(N,ae,Se){return Se&&(ae=Q(ae,Se)),mt=it(N,ae,{disableWarning:!1}),this};var cl=m.__private__.getFont=m.getFont=function(){return Rt[it.apply(m,arguments)]};m.__private__.getFontList=m.getFontList=function(){var N,ae,Se={};for(N in $t)if($t.hasOwnProperty(N))for(ae in Se[N]=[],$t[N])$t[N].hasOwnProperty(ae)&&Se[N].push(ae);return Se},m.addFont=function(N,ae,Se,Qe,ze){var ct=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&ct.indexOf(arguments[3])!==-1?ze=arguments[3]:arguments[3]&&ct.indexOf(arguments[3])==-1&&(Se=Q(Se,Qe)),Gr.call(this,N,ae,Se,ze=ze||"Identity-H")};var Ys,No=e.lineWidth||.200025,di=m.__private__.getLineWidth=m.getLineWidth=function(){return No},Sr=m.__private__.setLineWidth=m.setLineWidth=function(N){return No=N,se(V(G(N))+" w"),this};m.__private__.setLineDash=_r.API.setLineDash=_r.API.setLineDashPattern=function(N,ae){if(N=N||[],ae=ae||0,isNaN(ae)||!Array.isArray(N))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return N=N.map(function(Se){return V(G(Se))}).join(" "),ae=V(G(ae)),se("["+N+"] "+ae+" d"),this};var RA=m.__private__.getLineHeight=m.getLineHeight=function(){return Ge*Ys};m.__private__.getLineHeight=m.getLineHeight=function(){return Ge*Ys};var MA=m.__private__.setLineHeightFactor=m.setLineHeightFactor=function(N){return typeof(N=N||1.15)=="number"&&(Ys=N),this},HA=m.__private__.getLineHeightFactor=m.getLineHeightFactor=function(){return Ys};MA(e.lineHeight);var $n=m.__private__.getHorizontalCoordinate=function(N){return G(N)},hn=m.__private__.getVerticalCoordinate=function(N){return L===S?N:Ft[K].mediaBox.topRightY-Ft[K].mediaBox.bottomLeftY-G(N)},PA=m.__private__.getHorizontalCoordinateString=m.getHorizontalCoordinateString=function(N){return V($n(N))},oA=m.__private__.getVerticalCoordinateString=m.getVerticalCoordinateString=function(N){return V(hn(N))},fi=e.strokeColor||"0 G";m.__private__.getStrokeColor=m.getDrawColor=function(){return ye(fi)},m.__private__.setStrokeColor=m.setDrawColor=function(N,ae,Se,Qe){return fi=O({ch1:N,ch2:ae,ch3:Se,ch4:Qe,pdfColorType:"draw",precision:2}),se(fi),this};var AA=e.fillColor||"0 g";m.__private__.getFillColor=m.getFillColor=function(){return ye(AA)},m.__private__.setFillColor=m.setFillColor=function(N,ae,Se,Qe){return AA=O({ch1:N,ch2:ae,ch3:Se,ch4:Qe,pdfColorType:"fill",precision:2}),se(AA),this};var Cl=e.textColor||"0 g",Xn=m.__private__.getTextColor=m.getTextColor=function(){return ye(Cl)};m.__private__.setTextColor=m.setTextColor=function(N,ae,Se,Qe){return Cl=O({ch1:N,ch2:ae,ch3:Se,ch4:Qe,pdfColorType:"text",precision:3}),this};var bs=e.charSpace,Ps=m.__private__.getCharSpace=m.getCharSpace=function(){return parseFloat(bs||0)};m.__private__.setCharSpace=m.setCharSpace=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return bs=N,this};var Sl=0;m.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},m.__private__.setLineCap=m.setLineCap=function(N){var ae=m.CapJoinStyles[N];if(ae===void 0)throw new Error("Line cap style of '"+N+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Sl=ae,se(ae+" J"),this};var Ka=0;m.__private__.setLineJoin=m.setLineJoin=function(N){var ae=m.CapJoinStyles[N];if(ae===void 0)throw new Error("Line join style of '"+N+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ka=ae,se(ae+" j"),this},m.__private__.setLineMiterLimit=m.__private__.setMiterLimit=m.setLineMiterLimit=m.setMiterLimit=function(N){if(N=N||0,isNaN(N))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return se(V(G(N))+" M"),this},m.GState=Kx,m.setGState=function(N){(N=typeof N=="string"?tr[rr[N]]:qs(null,N)).equals(Xt)||(se("/"+N.id+" gs"),Xt=N)};var qs=function(N,ae){if(!N||!rr[N]){var Se=!1;for(var Qe in tr)if(tr.hasOwnProperty(Qe)&&tr[Qe].equals(ae)){Se=!0;break}if(Se)ae=tr[Qe];else{var ze="GS"+(Object.keys(tr).length+1).toString(10);tr[ze]=ae,ae.id=ze}return N&&(rr[N]=ae.id),Zt.publish("addGState",ae),ae}};m.addGState=function(N,ae){return qs(N,ae),this},m.saveGraphicsState=function(){return se("q"),vr.push({key:mt,size:Ge,color:Cl}),this},m.restoreGraphicsState=function(){se("Q");var N=vr.pop();return mt=N.key,Ge=N.size,Cl=N.color,Xt=null,this},m.setCurrentTransformationMatrix=function(N){return se(N.toString()+" cm"),this},m.comment=function(N){return se("#"+N),this};var Mi=function(N,ae){var Se=N||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Se},set:function(ct){isNaN(ct)||(Se=parseFloat(ct))}});var Qe=ae||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Qe},set:function(ct){isNaN(ct)||(Qe=parseFloat(ct))}});var ze="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ze},set:function(ct){ze=ct.toString()}}),this},lo=function(N,ae,Se,Qe){Mi.call(this,N,ae),this.type="rect";var ze=Se||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ze},set:function(wt){isNaN(wt)||(ze=parseFloat(wt))}});var ct=Qe||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return ct},set:function(wt){isNaN(wt)||(ct=parseFloat(wt))}}),this},ma=function(){this.page=Kt,this.currentPage=K,this.pages=Ie.slice(0),this.pagesContext=Ft.slice(0),this.x=gt,this.y=dr,this.matrix=Ht,this.width=js(K),this.height=Fo(K),this.outputDestination=oe,this.id="",this.objectNumber=-1};ma.prototype.restore=function(){Kt=this.page,K=this.currentPage,Ft=this.pagesContext,Ie=this.pages,gt=this.x,dr=this.y,Ht=this.matrix,Eo(K,this.width),vs(K,this.height),oe=this.outputDestination};var Ni=function(N,ae,Se,Qe,ze){Tt.push(new ma),Kt=K=0,Ie=[],gt=N,dr=ae,Ht=ze,oa([Se,Qe])};for(var Nl in m.beginFormObject=function(N,ae,Se,Qe,ze){return Ni(N,ae,Se,Qe,ze),this},m.endFormObject=function(N){return(function(ae){if(Et[ae])Tt.pop().restore();else{var Se=new ma,Qe="Xo"+(Object.keys(Re).length+1).toString(10);Se.id=Qe,Et[ae]=Qe,Re[Qe]=Se,Zt.publish("addFormObject",Se),Tt.pop().restore()}})(N),this},m.doFormObject=function(N,ae){var Se=Re[Et[N]];return se("q"),se(ae.toString()+" cm"),se("/"+Se.id+" Do"),se("Q"),this},m.getFormObject=function(N){var ae=Re[Et[N]];return{x:ae.x,y:ae.y,width:ae.width,height:ae.height,matrix:ae.matrix}},m.save=function(N,ae){return N=N||"generated.pdf",(ae=ae||{}).returnPromise=ae.returnPromise||!1,ae.returnPromise===!1?(L0(Gn(Na()),N),typeof L0.unload=="function"&&Xr.setTimeout&&setTimeout(L0.unload,911),this):new Promise(function(Se,Qe){try{var ze=L0(Gn(Na()),N);typeof L0.unload=="function"&&Xr.setTimeout&&setTimeout(L0.unload,911),Se(ze)}catch(ct){Qe(ct.message)}})},_r.API)_r.API.hasOwnProperty(Nl)&&(Nl==="events"&&_r.API.events.length?(function(N,ae){var Se,Qe,ze;for(ze=ae.length-1;ze!==-1;ze--)Se=ae[ze][0],Qe=ae[ze][1],N.subscribe.apply(N,[Se].concat(typeof Qe=="function"?[Qe]:Qe))})(Zt,_r.API.events):m[Nl]=_r.API[Nl]);function js(N){return Ft[N].mediaBox.topRightX-Ft[N].mediaBox.bottomLeftX}function Eo(N,ae){Ft[N].mediaBox.topRightX=ae+Ft[N].mediaBox.bottomLeftX}function Fo(N){return Ft[N].mediaBox.topRightY-Ft[N].mediaBox.bottomLeftY}function vs(N,ae){Ft[N].mediaBox.topRightY=ae+Ft[N].mediaBox.bottomLeftY}var Hi=m.getPageWidth=function(N){return js(N=N||K)/Nt},qA=m.setPageWidth=function(N,ae){Eo(N,ae*Nt)},pn=m.getPageHeight=function(N){return Fo(N=N||K)/Nt},du=m.setPageHeight=function(N,ae){vs(N,ae*Nt)};return m.internal={pdfEscape:Qr,getStyle:Bl,getFont:cl,getFontSize:nt,getCharSpace:Ps,getTextColor:Xn,getLineHeight:RA,getLineHeightFactor:HA,getLineWidth:di,write:qe,getHorizontalCoordinate:$n,getVerticalCoordinate:hn,getCoordinateString:PA,getVerticalCoordinateString:oA,collections:{},newObject:fr,newAdditionalObject:ke,newObjectDeferred:Cr,newObjectDeferredBegin:re,getFilters:ce,putStream:Fe,events:Zt,scaleFactor:Nt,pageSize:{getWidth:function(){return Hi(K)},setWidth:function(N){qA(K,N)},getHeight:function(){return pn(K)},setHeight:function(N){du(K,N)}},encryptionOptions:h,encryption:hs,getEncryptor:function(N){return h!==null?hs.encryptor(N,0):function(ae){return ae}},output:Lr,getNumberOfPages:ve,get pages(){return Ie},out:se,f2:T,f3:D,getPageInfo:ls,getPageInfoByObjId:no,getCurrentPageInfo:Ln,getPDFVersion:v,Point:Mi,Rectangle:lo,Matrix:Bt,hasHotfix:Ia},Object.defineProperty(m.internal.pageSize,"width",{get:function(){return Hi(K)},set:function(N){qA(K,N)},enumerable:!0,configurable:!0}),Object.defineProperty(m.internal.pageSize,"height",{get:function(){return pn(K)},set:function(N){du(K,N)},enumerable:!0,configurable:!0}),(function(N){for(var ae=0,Se=at.length;ae<Se;ae++){var Qe=Gr.call(this,N[ae][0],N[ae][1],N[ae][2],at[ae][3],!0);g===!1&&(x[Qe]=!0);var ze=N[ae][0].split("-");zt({id:Qe,fontName:ze[0],fontStyle:ze[1]||""})}Zt.publish("addFonts",{fonts:Rt,dictionary:$t})}).call(m,at),mt="F1",fs(s,r),Zt.publish("initialized"),m}uf.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},uf.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},uf.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},uf.prototype.processOwnerPassword=function(e,t){return d2(u2(t).substr(0,5),e)},uf.prototype.encryptor=function(e,t){var r=u2(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(a){return d2(r,a)}},Kx.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||Ya(e)!==Ya(this))return!1;var a=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;a++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&a--;return a===0},_r.API={events:[]},_r.version="4.1.0";var on=_r.API,U_=1,ud=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},tf=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},zx=function(e){return e.toString().replace(/#/g,"#23").replace(/[\s\n\r()<>[\]{}\/%]/g,function(t){var r=t.charCodeAt(0).toString(16).toUpperCase();return"#"+(r.length===1?"0"+r:r)})},ta=function(e){return e.toFixed(2)},Hu=function(e){return e.toFixed(5)};on.__acroform__={};var ao=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},nS=function(e){return e*U_},hc=function(e){var t=new zT,r=mr.internal.getHeight(e)||0,a=mr.internal.getWidth(e)||0;return t.BBox=[0,0,Number(ta(a)),Number(ta(r))],t},qee=on.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},Kee=on.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},zee=on.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},yn=on.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return zee(e,t-1)},kn=on.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return qee(e,t-1)},Bn=on.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Kee(e,t-1)},Vee=on.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,a=t.internal.getVerticalCoordinate,s=e[0],n=e[1],o=e[2],c=e[3],u={};return u.lowerLeft_X=r(s)||0,u.lowerLeft_Y=a(n+c)||0,u.upperRight_X=r(s+o)||0,u.upperRight_Y=a(n)||0,[Number(ta(u.lowerLeft_X)),Number(ta(u.lowerLeft_Y)),Number(ta(u.upperRight_X)),Number(ta(u.upperRight_Y))]},Gee=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,a=f2(e,r),s=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+s+" "+ta(a.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(a.text),t.push("ET"),t.push("Q"),t.push("EMC");var n=hc(e);return n.scope=e.scope,n.stream=t.join(`
`),n}},f2=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,a={text:"",fontSize:""},s=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");s=e.multiline?s.map(function(T){return T.split(`
`)}):s.map(function(T){return[T]});var n=r,o=mr.internal.getHeight(e)||0;o=o<0?-o:o;var c=mr.internal.getWidth(e)||0;c=c<0?-c:c;var u=function(T,D,G){if(T+1<s.length){var ne=D+" "+s[T+1][0];return Hm(ne,e,G).width<=c-4}return!1};n++;e:for(;n>0;){t="",n--;var f,h,g=Hm("3",e,n).height,x=e.multiline?o-n:(o-g)/2,m=x+=2,w=0,v=0,B=0;if(n<=0){t=`(...) Tj
`,t+="% Width of Text: "+Hm(t,e,n=12).width+", FieldWidth:"+c+`
`;break}for(var k="",E=0,S=0;S<s.length;S++)if(s.hasOwnProperty(S)){var L=!1;if(s[S].length!==1&&B!==s[S].length-1){if((g+2)*(E+2)+2>o)continue e;k+=s[S][B],L=!0,v=S,S--}else{k=(k+=s[S][B]+" ").substr(k.length-1)==" "?k.substr(0,k.length-1):k;var P=parseInt(S),R=u(P,k,n),Q=S>=s.length-1;if(R&&!Q){k+=" ",B=0;continue}if(R||Q){if(Q)v=P;else if(e.multiline&&(g+2)*(E+2)+2>o)continue e}else{if(!e.multiline||(g+2)*(E+2)+2>o)continue e;v=P}}for(var V="",U=w;U<=v;U++){var M=s[U];if(e.multiline){if(U===v){V+=M[B]+" ",B=(B+1)%M.length;continue}if(U===w){V+=M[M.length-1]+" ";continue}}V+=M[0]+" "}switch(V=V.substr(V.length-1)==" "?V.substr(0,V.length-1):V,h=Hm(V,e,n).width,e.textAlign){case"right":f=c-h-2;break;case"center":f=(c-h)/2;break;default:f=2}t+=ta(f)+" "+ta(m)+` Td
`,t+="("+ud(V)+`) Tj
`,t+=-ta(f)+` 0 Td
`,m=-(n+2),h=0,w=L?v:v+1,E++,k=""}break}return a.text=t,a.fontSize=n,a},Hm=function(e,t,r){var a=t.scope.internal.getFont(t.fontName,t.fontStyle),s=t.scope.getStringUnitWidth(e,{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:s}},Wee={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},$ee=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(a){return a.type===r.type&&a.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},Xee=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(IA.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(Wee)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");U_=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new VT,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var a=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in a)if(a.hasOwnProperty(s)){var n=a[s];n.objId=void 0,n.hasAnnotation&&$ee(n,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(a,s){var n=!a;for(var o in a||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),a=a||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(a.hasOwnProperty(o)){var c=a[o],u=[],f=c.Rect;if(c.Rect&&(c.Rect=Vee(c.Rect,s)),s.internal.newObjectDeferredBegin(c.objId,!0),c.DA=mr.createDefaultAppearanceStream(c),Ya(c)==="object"&&typeof c.getKeyValueListForStream=="function"&&(u=c.getKeyValueListForStream()),c.Rect=f,c.hasAppearanceStream&&!c.appearanceStreamContent){var h=Gee(c);u.push({key:"AP",value:"<</N "+h+">>"}),s.internal.acroformPlugin.xForms.push(h)}if(c.appearanceStreamContent){var g="";for(var x in c.appearanceStreamContent)if(c.appearanceStreamContent.hasOwnProperty(x)){var m=c.appearanceStreamContent[x];if(g+="/"+x+" ",g+="<<",Object.keys(m).length>=1||Array.isArray(m)){for(var o in m)if(m.hasOwnProperty(o)){var w=m[o];typeof w=="function"&&(w=w.call(s,c)),g+="/"+o+" "+w+" ",s.internal.acroformPlugin.xForms.indexOf(w)>=0||s.internal.acroformPlugin.xForms.push(w)}}else typeof(w=m)=="function"&&(w=w.call(s,c)),g+="/"+o+" "+w,s.internal.acroformPlugin.xForms.indexOf(w)>=0||s.internal.acroformPlugin.xForms.push(w);g+=">>"}u.push({key:"AP",value:`<<
`+g+">>"})}s.internal.putStream({additionalKeyValues:u,objectId:c.objId}),s.internal.out("endobj")}n&&(function(v,B){for(var k in v)if(v.hasOwnProperty(k)){var E=k,S=v[k];B.internal.newObjectDeferredBegin(S.objId,!0),Ya(S)==="object"&&typeof S.putStream=="function"&&S.putStream(),delete v[E]}})(s.internal.acroformPlugin.xForms,s)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},KT=on.__acroform__.arrayToPdfArray=function(e,t,r){var a=function(o){return o};if(Array.isArray(e)){for(var s="[",n=0;n<e.length;n++)switch(n!==0&&(s+=" "),Ya(e[n])){case"boolean":case"number":case"object":s+=e[n].toString();break;case"string":e[n].substr(0,1)==="/"?s+="/"+zx(e[n].substr(1)):(t!==void 0&&r&&(a=r.internal.getEncryptor(t)),s+="("+ud(a(e[n].toString()))+")")}return s+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Jv=function(e,t,r){var a=function(s){return s};return t!==void 0&&r&&(a=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+ud(a(e))+")"},kc=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};kc.prototype.toString=function(){return this.objId+" 0 R"},kc.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},kc.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(n){return n!="content"&&n!="appearanceStreamContent"&&n!="scope"&&n!="objId"&&n.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var a=t[r],s=this[a];s&&(Array.isArray(s)?e.push({key:a,value:KT(s,this.objId,this.scope)}):s instanceof kc?(s.scope=this.scope,e.push({key:a,value:s.objId+" 0 R"})):typeof s!="function"&&e.push({key:a,value:s}))}return e};var zT=function(){kc.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};ao(zT,kc);var VT=function(){kc.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(a){return a};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+ud(r(e))+")"}},set:function(r){e=r}})};ao(VT,kc);var IA=function e(){kc.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(k){if(isNaN(k))throw new Error('Invalid value "'+k+'" for attribute F supplied.');t=k}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!yn(t,3)},set:function(k){k?this.F=kn(t,3):this.F=Bn(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(k){if(isNaN(k))throw new Error('Invalid value "'+k+'" for attribute Ff supplied.');r=k}});var a=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(a.length!==0)return a},set:function(k){a=k!==void 0?k:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[0])?0:a[0]},set:function(k){a[0]=k}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[1])?0:a[1]},set:function(k){a[1]=k}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[2])?0:a[2]},set:function(k){a[2]=k}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[3])?0:a[3]},set:function(k){a[3]=k}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(k){switch(k){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=k;break;default:throw new Error('Invalid value "'+k+'" for attribute FT supplied.')}}});var n=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!n||n.length<1){if(this instanceof Vx)return;n="FieldObject"+e.FieldNum++}var k=function(E){return E};return this.scope&&(k=this.scope.internal.getEncryptor(this.objId)),"("+ud(k(n))+")"},set:function(k){n=k.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return n},set:function(k){n=k}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(k){o=k}});var c="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return c},set:function(k){c=k}});var u=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return u},set:function(k){u=k}});var f=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return f===void 0?50/U_:f},set:function(k){f=k}});var h="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return h},set:function(k){h=k}});var g="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!g||this instanceof Vx||this instanceof W0))return Jv(g,this.objId,this.scope)},set:function(k){k=k.toString(),g=k}});var x=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(x)return this instanceof wi==0?Jv(x,this.objId,this.scope):x},set:function(k){k=k.toString(),x=this instanceof wi==0?k.substr(0,1)==="("?tf(k.substr(1,k.length-2)):tf(k):k}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof wi==1?tf(x.substr(1,x.length-1)):x},set:function(k){k=k.toString(),x=this instanceof wi==1?"/"+zx(k):k}});var m=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(m)return m},set:function(k){this.V=k}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof wi==0?Jv(m,this.objId,this.scope):m},set:function(k){k=k.toString(),m=this instanceof wi==0?k.substr(0,1)==="("?tf(k.substr(1,k.length-2)):tf(k):k}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof wi==1?tf(m.substr(1,m.length-1)):m},set:function(k){k=k.toString(),m=this instanceof wi==1?"/"+zx(k):k}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var w,v=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return v},set:function(k){k=!!k,v=k}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(w)return w},set:function(k){w=k}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,1)},set:function(k){k?this.Ff=kn(this.Ff,1):this.Ff=Bn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,2)},set:function(k){k?this.Ff=kn(this.Ff,2):this.Ff=Bn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,3)},set:function(k){k?this.Ff=kn(this.Ff,3):this.Ff=Bn(this.Ff,3)}});var B=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(B!==null)return B},set:function(k){if([0,1,2].indexOf(k)===-1)throw new Error('Invalid value "'+k+'" for attribute Q supplied.');B=k}}),Object.defineProperty(this,"textAlign",{get:function(){var k;switch(B){case 0:default:k="left";break;case 1:k="center";break;case 2:k="right"}return k},configurable:!0,enumerable:!0,set:function(k){switch(k){case"right":case 2:B=2;break;case"center":case 1:B=1;break;default:B=0}}})};ao(IA,kc);var Bf=function(){IA.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return KT(t,this.objId,this.scope)},set:function(r){var a,s;s=[],typeof(a=r)=="string"&&(s=(function(n,o,c){c||(c=1);for(var u,f=[];u=o.exec(n);)f.push(u[c]);return f})(a,/\((.*?)\)/g)),t=s}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,a){for(a=a||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),a!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,18)},set:function(r){r?this.Ff=kn(this.Ff,18):this.Ff=Bn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=kn(this.Ff,19):this.Ff=Bn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,20)},set:function(r){r?(this.Ff=kn(this.Ff,20),t.sort()):this.Ff=Bn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,22)},set:function(r){r?this.Ff=kn(this.Ff,22):this.Ff=Bn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,23)},set:function(r){r?this.Ff=kn(this.Ff,23):this.Ff=Bn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,27)},set:function(r){r?this.Ff=kn(this.Ff,27):this.Ff=Bn(this.Ff,27)}}),this.hasAppearanceStream=!1};ao(Bf,IA);var Cf=function(){Bf.call(this),this.fontName="helvetica",this.combo=!1};ao(Cf,Bf);var Sf=function(){Cf.call(this),this.combo=!0};ao(Sf,Cf);var ex=function(){Sf.call(this),this.edit=!0};ao(ex,Sf);var wi=function(){IA.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,15)},set:function(r){r?this.Ff=kn(this.Ff,15):this.Ff=Bn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,16)},set:function(r){r?this.Ff=kn(this.Ff,16):this.Ff=Bn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,17)},set:function(r){r?this.Ff=kn(this.Ff,17):this.Ff=Bn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,26)},set:function(r){r?this.Ff=kn(this.Ff,26):this.Ff=Bn(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(n){return n};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var a,s=[];for(a in s.push("<<"),t)s.push("/"+a+" ("+ud(r(t[a]))+")");return s.push(">>"),s.join(`
`)}},set:function(r){Ya(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+zx(r)}})};ao(wi,IA);var tx=function(){wi.call(this),this.pushButton=!0};ao(tx,wi);var Nf=function(){wi.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};ao(Nf,wi);var Vx=function(){var e,t;IA.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(s){e=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(s){t=s}});var r,a={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(c){return c};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var n,o=[];for(n in o.push("<<"),a)o.push("/"+n+" ("+ud(s(a[n]))+")");return o.push(">>"),o.join(`
`)},set:function(s){Ya(s)==="object"&&(a=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return a.CA||""},set:function(s){typeof s=="string"&&(a.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(s){r=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(s){r="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=mr.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};ao(Vx,IA),Nf.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},Nf.prototype.createOption=function(e){var t=new Vx;return t.Parent=this,t.optionName=e,this.Kids.push(t),Yee.call(this.scope,t),t};var rx=function(){wi.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=mr.CheckBox.createAppearanceStream()};ao(rx,wi);var W0=function(){IA.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,13)},set:function(t){t?this.Ff=kn(this.Ff,13):this.Ff=Bn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,21)},set:function(t){t?this.Ff=kn(this.Ff,21):this.Ff=Bn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,23)},set:function(t){t?this.Ff=kn(this.Ff,23):this.Ff=Bn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,24)},set:function(t){t?this.Ff=kn(this.Ff,24):this.Ff=Bn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,25)},set:function(t){t?this.Ff=kn(this.Ff,25):this.Ff=Bn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,26)},set:function(t){t?this.Ff=kn(this.Ff,26):this.Ff=Bn(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};ao(W0,IA);var ax=function(){W0.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!yn(this.Ff,14)},set:function(e){e?this.Ff=kn(this.Ff,14):this.Ff=Bn(this.Ff,14)}}),this.password=!0};ao(ax,W0);var mr={CheckBox:{createAppearanceStream:function(){return{N:{On:mr.CheckBox.YesNormal},D:{On:mr.CheckBox.YesPushDown,Off:mr.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=hc(e);t.scope=e.scope;var r=[],a=e.scope.internal.getFont(e.fontName,e.fontStyle).id,s=e.scope.__private__.encodeColorString(e.color),n=f2(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+ta(mr.internal.getWidth(e))+" "+ta(mr.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+a+" "+ta(n.fontSize)+" Tf "+s),r.push("BT"),r.push(n.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=hc(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),s=[],n=mr.internal.getHeight(e),o=mr.internal.getWidth(e),c=f2(e,e.caption);return s.push("1 g"),s.push("0 0 "+ta(o)+" "+ta(n)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+ta(o-1)+" "+ta(n-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+r+" "+ta(c.fontSize)+" Tf "+a),s.push(c.text),s.push("ET"),s.push("Q"),t.stream=s.join(`
`),t},OffPushDown:function(e){var t=hc(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+ta(mr.internal.getWidth(e))+" "+ta(mr.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:mr.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=mr.RadioButton.Circle.YesNormal,t.D[e]=mr.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=hc(e);t.scope=e.scope;var r=[],a=mr.internal.getWidth(e)<=mr.internal.getHeight(e)?mr.internal.getWidth(e)/4:mr.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var s=mr.internal.Bezier_C,n=Number((a*s).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Hu(mr.internal.getWidth(e)/2)+" "+Hu(mr.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+n+" "+n+" "+a+" 0 "+a+" c"),r.push("-"+n+" "+a+" -"+a+" "+n+" -"+a+" 0 c"),r.push("-"+a+" -"+n+" -"+n+" -"+a+" 0 -"+a+" c"),r.push(n+" -"+a+" "+a+" -"+n+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=hc(e);t.scope=e.scope;var r=[],a=mr.internal.getWidth(e)<=mr.internal.getHeight(e)?mr.internal.getWidth(e)/4:mr.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var s=Number((2*a).toFixed(5)),n=Number((s*mr.internal.Bezier_C).toFixed(5)),o=Number((a*mr.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Hu(mr.internal.getWidth(e)/2)+" "+Hu(mr.internal.getHeight(e)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+n+" "+n+" "+s+" 0 "+s+" c"),r.push("-"+n+" "+s+" -"+s+" "+n+" -"+s+" 0 c"),r.push("-"+s+" -"+n+" -"+n+" -"+s+" 0 -"+s+" c"),r.push(n+" -"+s+" "+s+" -"+n+" "+s+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Hu(mr.internal.getWidth(e)/2)+" "+Hu(mr.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+o+" "+o+" "+a+" 0 "+a+" c"),r.push("-"+o+" "+a+" -"+a+" "+o+" -"+a+" 0 c"),r.push("-"+a+" -"+o+" -"+o+" -"+a+" 0 -"+a+" c"),r.push(o+" -"+a+" "+a+" -"+o+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=hc(e);t.scope=e.scope;var r=[],a=mr.internal.getWidth(e)<=mr.internal.getHeight(e)?mr.internal.getWidth(e)/4:mr.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var s=Number((2*a).toFixed(5)),n=Number((s*mr.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Hu(mr.internal.getWidth(e)/2)+" "+Hu(mr.internal.getHeight(e)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+n+" "+n+" "+s+" 0 "+s+" c"),r.push("-"+n+" "+s+" -"+s+" "+n+" -"+s+" 0 c"),r.push("-"+s+" -"+n+" -"+n+" -"+s+" 0 -"+s+" c"),r.push(n+" -"+s+" "+s+" -"+n+" "+s+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:mr.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=mr.RadioButton.Cross.YesNormal,t.D[e]=mr.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=hc(e);t.scope=e.scope;var r=[],a=mr.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+ta(mr.internal.getWidth(e)-2)+" "+ta(mr.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(ta(a.x1.x)+" "+ta(a.x1.y)+" m"),r.push(ta(a.x2.x)+" "+ta(a.x2.y)+" l"),r.push(ta(a.x4.x)+" "+ta(a.x4.y)+" m"),r.push(ta(a.x3.x)+" "+ta(a.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=hc(e);t.scope=e.scope;var r=mr.internal.calculateCross(e),a=[];return a.push("0.749023 g"),a.push("0 0 "+ta(mr.internal.getWidth(e))+" "+ta(mr.internal.getHeight(e))+" re"),a.push("f"),a.push("q"),a.push("1 1 "+ta(mr.internal.getWidth(e)-2)+" "+ta(mr.internal.getHeight(e)-2)+" re"),a.push("W"),a.push("n"),a.push(ta(r.x1.x)+" "+ta(r.x1.y)+" m"),a.push(ta(r.x2.x)+" "+ta(r.x2.y)+" l"),a.push(ta(r.x4.x)+" "+ta(r.x4.y)+" m"),a.push(ta(r.x3.x)+" "+ta(r.x3.y)+" l"),a.push("s"),a.push("Q"),t.stream=a.join(`
`),t},OffPushDown:function(e){var t=hc(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+ta(mr.internal.getWidth(e))+" "+ta(mr.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};mr.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=mr.internal.getWidth(e),r=mr.internal.getHeight(e),a=Math.min(t,r);return{x1:{x:(t-a)/2,y:(r-a)/2+a},x2:{x:(t-a)/2+a,y:(r-a)/2},x3:{x:(t-a)/2,y:(r-a)/2},x4:{x:(t-a)/2+a,y:(r-a)/2+a}}}},mr.internal.getWidth=function(e){var t=0;return Ya(e)==="object"&&(t=nS(e.Rect[2])),t},mr.internal.getHeight=function(e){var t=0;return Ya(e)==="object"&&(t=nS(e.Rect[3])),t};var Yee=on.addField=function(e){if(Xee(this,e),!(e instanceof IA))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};on.AcroFormChoiceField=Bf,on.AcroFormListBox=Cf,on.AcroFormComboBox=Sf,on.AcroFormEditBox=ex,on.AcroFormButton=wi,on.AcroFormPushButton=tx,on.AcroFormRadioButton=Nf,on.AcroFormCheckBox=rx,on.AcroFormTextField=W0,on.AcroFormPasswordField=ax,on.AcroFormAppearance=mr,on.AcroForm={ChoiceField:Bf,ListBox:Cf,ComboBox:Sf,EditBox:ex,Button:wi,PushButton:tx,RadioButton:Nf,CheckBox:rx,TextField:W0,PasswordField:ax,Appearance:mr},_r.AcroForm={ChoiceField:Bf,ListBox:Cf,ComboBox:Sf,EditBox:ex,Button:wi,PushButton:tx,RadioButton:Nf,CheckBox:rx,TextField:W0,PasswordField:ax,Appearance:mr};_r.AcroForm;function GT(e){return e.reduce(function(t,r,a){return t[r]=a,t},{})}(function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",a={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=e.__addimage__.getImageFileTypeByImageData=function(T,D){var G,ne,H,ee,le,pe=r;if((D=D||r)==="RGBA"||T.data!==void 0&&T.data instanceof Uint8ClampedArray&&"height"in T&&"width"in T)return"RGBA";if(R(T))for(le in a)for(H=a[le],G=0;G<H.length;G+=1){for(ee=!0,ne=0;ne<H[G].length;ne+=1)if(H[G][ne]!==void 0&&H[G][ne]!==T[ne]){ee=!1;break}if(ee===!0){pe=le;break}}else for(le in a)for(H=a[le],G=0;G<H.length;G+=1){for(ee=!0,ne=0;ne<H[G].length;ne+=1)if(H[G][ne]!==void 0&&H[G][ne]!==T.charCodeAt(ne)){ee=!1;break}if(ee===!0){pe=le;break}}return pe===r&&D!==r&&(pe=D),pe},n=function T(D){for(var G=this.internal.write,ne=this.internal.putStream,H=(0,this.internal.getFilters)();H.indexOf("FlateEncode")!==-1;)H.splice(H.indexOf("FlateEncode"),1);D.objectId=this.internal.newObject();var ee=[];if(ee.push({key:"Type",value:"/XObject"}),ee.push({key:"Subtype",value:"/Image"}),ee.push({key:"Width",value:D.width}),ee.push({key:"Height",value:D.height}),D.colorSpace===k.INDEXED?ee.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(D.palette.length/3-1)+" "+("sMask"in D&&D.sMask!==void 0?D.objectId+2:D.objectId+1)+" 0 R]"}):(ee.push({key:"ColorSpace",value:"/"+D.colorSpace}),D.colorSpace===k.DEVICE_CMYK&&ee.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ee.push({key:"BitsPerComponent",value:D.bitsPerComponent}),"decodeParameters"in D&&D.decodeParameters!==void 0&&ee.push({key:"DecodeParms",value:"<<"+D.decodeParameters+">>"}),"transparency"in D&&Array.isArray(D.transparency)&&D.transparency.length>0){for(var le="",pe=0,te=D.transparency.length;pe<te;pe++)le+=D.transparency[pe]+" "+D.transparency[pe]+" ";ee.push({key:"Mask",value:"["+le+"]"})}D.sMask!==void 0&&ee.push({key:"SMask",value:D.objectId+1+" 0 R"});var Le=D.filter!==void 0?["/"+D.filter]:void 0;if(ne({data:D.data,additionalKeyValues:ee,alreadyAppliedFilters:Le,objectId:D.objectId}),G("endobj"),"sMask"in D&&D.sMask!==void 0){var je,F=(je=D.sMaskBitsPerComponent)!==null&&je!==void 0?je:D.bitsPerComponent,K={width:D.width,height:D.height,colorSpace:"DeviceGray",bitsPerComponent:F,data:D.sMask};"filter"in D&&(K.decodeParameters="/Predictor ".concat(D.predictor," /Colors 1 /BitsPerComponent ").concat(F," /Columns ").concat(D.width),K.filter=D.filter),T.call(this,K)}if(D.colorSpace===k.INDEXED){var I=this.internal.newObject();ne({data:V(new Uint8Array(D.palette)),objectId:I}),G("endobj")}},o=function(){var T=this.internal.collections[t+"images"];for(var D in T)n.call(this,T[D])},c=function(){var T,D=this.internal.collections[t+"images"],G=this.internal.write;for(var ne in D)G("/I"+(T=D[ne]).index,T.objectId,"0","R")},u=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",c))},f=function(){var T=this.internal.collections[t+"images"];return u.call(this),T},h=function(){return Object.keys(this.internal.collections[t+"images"]).length},g=function(T){return typeof e["process"+T.toUpperCase()]=="function"},x=function(T){return Ya(T)==="object"&&T.nodeType===1},m=function(T,D){if(T.nodeName==="IMG"&&T.hasAttribute("src")){var G=""+T.getAttribute("src");if(G.indexOf("data:image/")===0)return Zm(unescape(G).split("base64,").pop());var ne=e.loadFile(G,!0);if(ne!==void 0)return ne}if(T.nodeName==="CANVAS"){if(T.width===0||T.height===0)throw new Error("Given canvas must have data. Canvas width: "+T.width+", height: "+T.height);var H;switch(D){case"PNG":H="image/png";break;case"WEBP":H="image/webp";break;default:H="image/jpeg"}return Zm(T.toDataURL(H,1).split("base64,").pop())}},w=function(T){var D=this.internal.collections[t+"images"];if(D){for(var G in D)if(T===D[G].alias)return D[G]}},v=function(T,D,G){return T||D||(T=-96,D=-96),T<0&&(T=-1*G.width*72/T/this.internal.scaleFactor),D<0&&(D=-1*G.height*72/D/this.internal.scaleFactor),T===0&&(T=D*G.width/G.height),D===0&&(D=T*G.height/G.width),[T,D]},B=function(T,D,G,ne,H,ee){var le=v.call(this,G,ne,H),pe=this.internal.getCoordinateString,te=this.internal.getVerticalCoordinateString,Le=f.call(this);if(G=le[0],ne=le[1],Le[H.index]=H,ee){ee*=Math.PI/180;var je=Math.cos(ee),F=Math.sin(ee),K=function(q){return q.toFixed(4)},I=[K(je),K(F),K(-1*F),K(je),0,0,"cm"]}this.internal.write("q"),ee?(this.internal.write([1,"0","0",1,pe(T),te(D+ne),"cm"].join(" ")),this.internal.write(I.join(" ")),this.internal.write([pe(G),"0","0",pe(ne),"0","0","cm"].join(" "))):this.internal.write([pe(G),"0","0",pe(ne),pe(T),te(D+ne),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+H.index+" Do"),this.internal.write("Q")},k=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var E=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},S=e.__addimage__.sHashCode=function(T){var D,G,ne=0;if(typeof T=="string")for(G=T.length,D=0;D<G;D++)ne=(ne<<5)-ne+T.charCodeAt(D),ne|=0;else if(R(T))for(G=T.byteLength/2,D=0;D<G;D++)ne=(ne<<5)-ne+T[D],ne|=0;return ne},L=e.__addimage__.validateStringAsBase64=function(T){(T=T||"").toString().trim();var D=!0;return T.length===0&&(D=!1),T.length%4!=0&&(D=!1),/^[A-Za-z0-9+/]+$/.test(T.substr(0,T.length-2))===!1&&(D=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(T.substr(-2))===!1&&(D=!1),D},P=e.__addimage__.extractImageFromDataUrl=function(T){if(T==null||!(T=T.trim()).startsWith("data:"))return null;var D=T.indexOf(",");return D<0?null:T.substring(0,D).trim().endsWith("base64")?T.substring(D+1):null};e.__addimage__.isArrayBuffer=function(T){return T instanceof ArrayBuffer};var R=e.__addimage__.isArrayBufferView=function(T){return T instanceof Int8Array||T instanceof Uint8Array||T instanceof Uint8ClampedArray||T instanceof Int16Array||T instanceof Uint16Array||T instanceof Int32Array||T instanceof Uint32Array||T instanceof Float32Array||T instanceof Float64Array},Q=e.__addimage__.binaryStringToUint8Array=function(T){for(var D=T.length,G=new Uint8Array(D),ne=0;ne<D;ne++)G[ne]=T.charCodeAt(ne);return G},V=e.__addimage__.arrayBufferToBinaryString=function(T){for(var D="",G=R(T)?T:new Uint8Array(T),ne=0;ne<G.length;ne+=8192)D+=String.fromCharCode.apply(null,G.subarray(ne,ne+8192));return D};e.addImage=function(){var T,D,G,ne,H,ee,le,pe,te;if(typeof arguments[1]=="number"?(D=r,G=arguments[1],ne=arguments[2],H=arguments[3],ee=arguments[4],le=arguments[5],pe=arguments[6],te=arguments[7]):(D=arguments[1],G=arguments[2],ne=arguments[3],H=arguments[4],ee=arguments[5],le=arguments[6],pe=arguments[7],te=arguments[8]),Ya(T=arguments[0])==="object"&&!x(T)&&"imageData"in T){var Le=T;T=Le.imageData,D=Le.format||D||r,G=Le.x||G||0,ne=Le.y||ne||0,H=Le.w||Le.width||H,ee=Le.h||Le.height||ee,le=Le.alias||le,pe=Le.compression||pe,te=Le.rotation||Le.angle||te}var je=this.internal.getFilters();if(pe===void 0&&je.indexOf("FlateEncode")!==-1&&(pe="SLOW"),isNaN(G)||isNaN(ne))throw new Error("Invalid coordinates passed to jsPDF.addImage");u.call(this);var F=U.call(this,T,D,le,pe);return B.call(this,G,ne,H,ee,F,te),this};var U=function(T,D,G,ne){var H,ee,le;if(typeof T=="string"&&s(T)===r){T=unescape(T);var pe=M(T,!1);(pe!==""||(pe=e.loadFile(T,!0))!==void 0)&&(T=pe)}if(x(T)&&(T=m(T,D)),D=s(T,D),!g(D))throw new Error("addImage does not support files of type '"+D+"', please ensure that a plugin for '"+D+"' support is added.");if(((le=G)==null||le.length===0)&&(G=(function(te){return typeof te=="string"||R(te)?S(te):R(te.data)?S(te.data):null})(T)),(H=w.call(this,G))||(T instanceof Uint8Array||D==="RGBA"||(ee=T,T=Q(T)),H=this["process"+D.toUpperCase()](T,h.call(this),G,(function(te){return te&&typeof te=="string"&&(te=te.toUpperCase()),te in e.image_compression?te:E.NONE})(ne),ee)),!H)throw new Error("An unknown error occurred whilst processing the image.");return H},M=e.__addimage__.convertBase64ToBinaryString=function(T,D){D=typeof D!="boolean"||D;var G,ne="";if(typeof T=="string"){var H;G=(H=P(T))!==null&&H!==void 0?H:T;try{ne=Zm(G)}catch(ee){if(D)throw L(G)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ee.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return ne};e.getImageProperties=function(T){var D,G,ne="";if(x(T)&&(T=m(T)),typeof T=="string"&&s(T)===r&&((ne=M(T,!1))===""&&(ne=e.loadFile(T)||""),T=ne),G=s(T),!g(G))throw new Error("addImage does not support files of type '"+G+"', please ensure that a plugin for '"+G+"' support is added.");if(T instanceof Uint8Array||(T=Q(T)),!(D=this["process"+G.toUpperCase()](T)))throw new Error("An unknown error occurred whilst processing the image");return D.fileType=G,D}})(_r.API),(function(e){var t=function(r){if(r!==void 0&&r!="")return!0};_r.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var a,s,n,o=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString,u=this.internal.getPageInfoByObjId(r.objId),f=r.pageContext.annotations,h=!1,g=0;g<f.length&&!h;g++)switch((a=f[g]).type){case"link":(t(a.options.url)||t(a.options.pageNumber))&&(h=!0);break;case"reference":case"text":case"freetext":h=!0}if(h!=0){this.internal.write("/Annots [");for(var x=0;x<f.length;x++){a=f[x];var m=this.internal.pdfEscape,w=this.internal.getEncryptor(r.objId);switch(a.type){case"reference":this.internal.write(" "+a.object.objId+" 0 R ");break;case"text":var v=this.internal.newAdditionalObject(),B=this.internal.newAdditionalObject(),k=this.internal.getEncryptor(v.objId),E=a.title||"Note";n="<</Type /Annot /Subtype /Text "+(s="/Rect ["+o(a.bounds.x)+" "+c(a.bounds.y+a.bounds.h)+" "+o(a.bounds.x+a.bounds.w)+" "+c(a.bounds.y)+"] ")+"/Contents ("+m(k(a.contents))+")",n+=" /Popup "+B.objId+" 0 R",n+=" /P "+u.objId+" 0 R",n+=" /T ("+m(k(E))+") >>",v.content=n;var S=v.objId+" 0 R";n="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+o(a.bounds.x+30)+" "+c(a.bounds.y+a.bounds.h)+" "+o(a.bounds.x+a.bounds.w+30)+" "+c(a.bounds.y)+"] ")+" /Parent "+S,a.open&&(n+=" /Open true"),n+=" >>",B.content=n,this.internal.write(v.objId,"0 R",B.objId,"0 R");break;case"freetext":s="/Rect ["+o(a.bounds.x)+" "+c(a.bounds.y)+" "+o(a.bounds.x+a.bounds.w)+" "+c(a.bounds.y+a.bounds.h)+"] ";var L=a.color||"#000000";n="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+m(w(a.contents))+")",n+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+L+")",n+=" /Border [0 0 0]",n+=" >>",this.internal.write(n);break;case"link":if(a.options.name){var P=this.annotations._nameMap[a.options.name];a.options.pageNumber=P.page,a.options.top=P.y}else a.options.top||(a.options.top=0);if(s="/Rect ["+a.finalBounds.x+" "+a.finalBounds.y+" "+a.finalBounds.w+" "+a.finalBounds.h+"] ",n="",a.options.url)n="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+m(w(a.options.url))+") >>";else if(a.options.pageNumber)switch(n="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(a.options.pageNumber).objId+" 0 R",a.options.magFactor=a.options.magFactor||"XYZ",a.options.magFactor){case"Fit":n+=" /Fit]";break;case"FitH":n+=" /FitH "+a.options.top+"]";break;case"FitV":a.options.left=a.options.left||0,n+=" /FitV "+a.options.left+"]";break;default:var R=c(a.options.top);a.options.left=a.options.left||0,a.options.zoom===void 0&&(a.options.zoom=0),n+=" /XYZ "+a.options.left+" "+R+" "+a.options.zoom+"]"}n!=""&&(n+=" >>",this.internal.write(n))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var a=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":a.pageContext.annotations.push(r)}},e.link=function(r,a,s,n,o){var c=this.internal.getCurrentPageInfo(),u=this.internal.getCoordinateString,f=this.internal.getVerticalCoordinateString;c.pageContext.annotations.push({finalBounds:{x:u(r),y:f(a),w:u(r+s),h:f(a+n)},options:o,type:"link"})},e.textWithLink=function(r,a,s,n){var o,c,u=this.getTextWidth(r),f=this.internal.getLineHeight()/this.internal.scaleFactor;if(n.maxWidth!==void 0){c=n.maxWidth;var h=this.splitTextToSize(r,c).length;o=Math.ceil(f*h)}else c=u,o=f;return this.text(r,a,s,n),s+=.2*f,n.align==="center"&&(a-=u/2),n.align==="right"&&(a-=u),this.link(a,s-f,c,o,n),u},e.getTextWidth=function(r){var a=this.internal.getFontSize();return this.getStringUnitWidth(r)*a/this.internal.scaleFactor}})(_r.API),(function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},a={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];e.__arabicParser__={};var n=e.__arabicParser__.isInArabicSubstitutionA=function(v){return t[v.charCodeAt(0)]!==void 0},o=e.__arabicParser__.isArabicLetter=function(v){return typeof v=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(v)},c=e.__arabicParser__.isArabicEndLetter=function(v){return o(v)&&n(v)&&t[v.charCodeAt(0)].length<=2},u=e.__arabicParser__.isArabicAlfLetter=function(v){return o(v)&&s.indexOf(v.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(v){return o(v)&&n(v)&&t[v.charCodeAt(0)].length>=1};var f=e.__arabicParser__.arabicLetterHasFinalForm=function(v){return o(v)&&n(v)&&t[v.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(v){return o(v)&&n(v)&&t[v.charCodeAt(0)].length>=3};var h=e.__arabicParser__.arabicLetterHasMedialForm=function(v){return o(v)&&n(v)&&t[v.charCodeAt(0)].length==4},g=e.__arabicParser__.resolveLigatures=function(v){var B=0,k=r,E="",S=0;for(B=0;B<v.length;B+=1)k[v.charCodeAt(B)]!==void 0?(S++,typeof(k=k[v.charCodeAt(B)])=="number"&&(E+=String.fromCharCode(k),k=r,S=0),B===v.length-1&&(k=r,E+=v.charAt(B-(S-1)),B-=S-1,S=0)):(k=r,E+=v.charAt(B-S),B-=S,S=0);return E};e.__arabicParser__.isArabicDiacritic=function(v){return v!==void 0&&a[v.charCodeAt(0)]!==void 0};var x=e.__arabicParser__.getCorrectForm=function(v,B,k){return o(v)?n(v)===!1?-1:!f(v)||!o(B)&&!o(k)||!o(k)&&c(B)||c(v)&&!o(B)||c(v)&&u(B)||c(v)&&c(B)?0:h(v)&&o(B)&&!c(B)&&o(k)&&f(k)?3:c(v)||!o(k)?1:2:-1},m=function(v){var B=0,k=0,E=0,S="",L="",P="",R=(v=v||"").split("\\s+"),Q=[];for(B=0;B<R.length;B+=1){for(Q.push(""),k=0;k<R[B].length;k+=1)S=R[B][k],L=R[B][k-1],P=R[B][k+1],o(S)?(E=x(S,L,P),Q[B]+=E!==-1?String.fromCharCode(t[S.charCodeAt(0)][E]):S):Q[B]+=S;Q[B]=g(Q[B])}return Q.join(" ")},w=e.__arabicParser__.processArabic=e.processArabic=function(){var v,B=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,k=[];if(Array.isArray(B)){var E=0;for(k=[],E=0;E<B.length;E+=1)Array.isArray(B[E])?k.push([m(B[E][0]),B[E][1],B[E][2]]):k.push([m(B[E])]);v=k}else v=m(B);return typeof arguments[0]=="string"?v:(arguments[0].text=v,arguments[0])};e.events.push(["preProcessText",w])})(_r.API),_r.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},(function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(c){r=c}});var a=150;Object.defineProperty(this,"width",{get:function(){return a},set:function(c){a=isNaN(c)||Number.isInteger(c)===!1||c<0?150:c,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=a+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(c){s=isNaN(c)||Number.isInteger(c)===!1||c<0?300:c,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var n=[];Object.defineProperty(this,"childNodes",{get:function(){return n},set:function(c){n=c}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(c){o=c}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,a){var s;if((r=r||"2d")!=="2d")return null;for(s in a)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=a[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])})(_r.API),(function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,a=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new n,this.internal.__cell__.pages=1},n=function(){var u=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return u},set:function(v){u=v}});var f=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return f},set:function(v){f=v}});var h=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return h},set:function(v){h=v}});var g=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return g},set:function(v){g=v}});var x=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return x},set:function(v){x=v}});var m=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return m},set:function(v){m=v}});var w=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return w},set:function(v){w=v}}),this};n.prototype.clone=function(){return new n(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},n.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(u){return a.call(this),this.internal.__cell__.headerFunction=typeof u=="function"?u:void 0,this},e.getTextDimensions=function(u,f){a.call(this);var h=(f=f||{}).fontSize||this.getFontSize(),g=f.font||this.getFont(),x=f.scaleFactor||this.internal.scaleFactor,m=0,w=0,v=0,B=this;if(!Array.isArray(u)&&typeof u!="string"){if(typeof u!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");u=String(u)}var k=f.maxWidth;k>0?typeof u=="string"?u=this.splitTextToSize(u,k):Object.prototype.toString.call(u)==="[object Array]"&&(u=u.reduce(function(S,L){return S.concat(B.splitTextToSize(L,k))},[])):u=Array.isArray(u)?u:[u];for(var E=0;E<u.length;E++)m<(v=this.getStringUnitWidth(u[E],{font:g})*h)&&(m=v);return m!==0&&(w=u.length),{w:m/=x,h:Math.max((w*h*this.getLineHeightFactor()-h*(this.getLineHeightFactor()-1))/x,0)}},e.cellAddPage=function(){a.call(this),this.addPage();var u=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new n(u.left,u.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=e.cell=function(){var u;u=arguments[0]instanceof n?arguments[0]:new n(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),a.call(this);var f=this.internal.__cell__.lastCell,h=this.internal.__cell__.padding,g=this.internal.__cell__.margins||t,x=this.internal.__cell__.tableHeaderRow,m=this.internal.__cell__.printHeaders;return f.lineNumber!==void 0&&(f.lineNumber===u.lineNumber?(u.x=(f.x||0)+(f.width||0),u.y=f.y||0):f.y+f.height+u.height+g.bottom>this.getPageHeight()?(this.cellAddPage(),u.y=g.top,m&&x&&(this.printHeaderRow(u.lineNumber,!0),u.y+=x[0].height)):u.y=f.y+f.height||u.y),u.text[0]!==void 0&&(this.rect(u.x,u.y,u.width,u.height,r===!0?"FD":void 0),u.align==="right"?this.text(u.text,u.x+u.width-h,u.y+h,{align:"right",baseline:"top"}):u.align==="center"?this.text(u.text,u.x+u.width/2,u.y+h,{align:"center",baseline:"top",maxWidth:u.width-h-h}):this.text(u.text,u.x+h,u.y+h,{align:"left",baseline:"top",maxWidth:u.width-h-h})),this.internal.__cell__.lastCell=u,this};e.table=function(u,f,h,g,x){if(a.call(this),!h)throw new Error("No data for PDF table.");var m,w,v,B,k=[],E=[],S=[],L={},P={},R=[],Q=[],V=(x=x||{}).autoSize||!1,U=x.printHeaders!==!1,M=x.css&&x.css["font-size"]!==void 0?16*x.css["font-size"]:x.fontSize||12,T=x.margins||Object.assign({width:this.getPageWidth()},t),D=typeof x.padding=="number"?x.padding:3,G=x.headerBackgroundColor||"#c8c8c8",ne=x.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=U,this.internal.__cell__.margins=T,this.internal.__cell__.table_font_size=M,this.internal.__cell__.padding=D,this.internal.__cell__.headerBackgroundColor=G,this.internal.__cell__.headerTextColor=ne,this.setFontSize(M),g==null)E=k=Object.keys(h[0]),S=k.map(function(){return"left"});else if(Array.isArray(g)&&Ya(g[0])==="object")for(k=g.map(function(Le){return Le.name}),E=g.map(function(Le){return Le.prompt||Le.name||""}),S=g.map(function(Le){return Le.align||"left"}),m=0;m<g.length;m+=1)P[g[m].name]=.7499990551181103*g[m].width;else Array.isArray(g)&&typeof g[0]=="string"&&(E=k=g,S=k.map(function(){return"left"}));if(V||Array.isArray(g)&&typeof g[0]=="string")for(m=0;m<k.length;m+=1){for(L[B=k[m]]=h.map(function(Le){return Le[B]}),this.setFont(void 0,"bold"),R.push(this.getTextDimensions(E[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),w=L[B],this.setFont(void 0,"normal"),v=0;v<w.length;v+=1)R.push(this.getTextDimensions(w[v],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);P[B]=Math.max.apply(null,R)+D+D,R=[]}if(U){var H={};for(m=0;m<k.length;m+=1)H[k[m]]={},H[k[m]].text=E[m],H[k[m]].align=S[m];var ee=c.call(this,H,P);Q=k.map(function(Le){return new n(u,f,P[Le],ee,H[Le].text,void 0,H[Le].align)}),this.setTableHeaderRow(Q),this.printHeaderRow(1,!1)}var le=g.reduce(function(Le,je){return Le[je.name]=je.align,Le},{});for(m=0;m<h.length;m+=1){"rowStart"in x&&x.rowStart instanceof Function&&x.rowStart({row:m,data:h[m]},this);var pe=c.call(this,h[m],P);for(v=0;v<k.length;v+=1){var te=h[m][k[v]];"cellStart"in x&&x.cellStart instanceof Function&&x.cellStart({row:m,col:v,data:te},this),o.call(this,new n(u,f,P[k[v]],pe,te,m+2,le[k[v]]))}}return this.internal.__cell__.table_x=u,this.internal.__cell__.table_y=f,this};var c=function(u,f){var h=this.internal.__cell__.padding,g=this.internal.__cell__.table_font_size,x=this.internal.scaleFactor;return Object.keys(u).map(function(m){var w=u[m];return this.splitTextToSize(w.hasOwnProperty("text")?w.text:w,f[m]-h-h)},this).map(function(m){return this.getLineHeightFactor()*m.length*g/x+h+h},this).reduce(function(m,w){return Math.max(m,w)},0)};e.setTableHeaderRow=function(u){a.call(this),this.internal.__cell__.tableHeaderRow=u},e.printHeaderRow=function(u,f){if(a.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var h;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var g=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new n(g[0],g[1],g[2],g[3],void 0,-1)}this.setFont(void 0,"bold");for(var x=[],m=0;m<this.internal.__cell__.tableHeaderRow.length;m+=1){h=this.internal.__cell__.tableHeaderRow[m].clone(),f&&(h.y=this.internal.__cell__.margins.top||0,x.push(h)),h.lineNumber=u;var w=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,h),this.setTextColor(w)}x.length>0&&this.setTableHeaderRow(x),this.setFont(void 0,"normal"),r=!1}})(_r.API);var WT={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},$T=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],h2=GT($T),XT=[100,200,300,400,500,600,700,800,900],Jee=GT(XT);function Zv(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=(function(n){return WT[n=n||"normal"]?n:"normal"})(e.style),a=(function(n){return n?typeof n=="number"?n>=100&&n<=900&&n%100==0?n:400:/^\d00$/.test(n)?parseInt(n):n==="bold"?700:400:400})(e.weight),s=(function(n){return typeof h2[n=n||"normal"]=="number"?n:"normal"})(e.stretch);return{family:t,style:r,weight:a,stretch:s,src:e.src||[],ref:e.ref||{name:t,style:[s,r,a].join(" ")}}}function iS(e,t,r,a){var s;for(s=r;s>=0&&s<t.length;s+=a)if(e[t[s]])return e[t[s]];for(s=r;s>=0&&s<t.length;s-=a)if(e[t[s]])return e[t[s]]}var Zee={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},lS={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function oS(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function AS(e){return e.trimLeft()}function ete(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function tte(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var rf,Pm,cS,uS,dS,ew=["times"];function fS(e,t,r,a,s){var n=4,o=pS;switch(s){case _r.API.image_compression.FAST:n=1,o=hS;break;case _r.API.image_compression.MEDIUM:n=6,o=gS;break;case _r.API.image_compression.SLOW:n=9,o=mS}e=(function(u,f,h,g){for(var x,m=u.length/f,w=new Uint8Array(u.length+m),v=[rte,hS,pS,gS,mS],B=0;B<m;B+=1){var k=B*f,E=u.subarray(k,k+f);if(g)w.set(g(E,h,x),k+B);else{for(var S=v.length,L=[],P=0;P<S;P+=1)L[P]=v[P](E,h,x);var R=ste(L.concat());w.set(L[R],k+B)}x=E}return w})(e,t,Math.ceil(r*a/8),o);var c=l2(e,{level:n});return _r.API.__addimage__.arrayBufferToBinaryString(c)}function rte(e){var t=Array.apply([],e);return t.unshift(0),t}function hS(e,t){var r=e.length,a=[];a[0]=1;for(var s=0;s<r;s+=1){var n=e[s-t]||0;a[s+1]=e[s]-n+256&255}return a}function pS(e,t,r){var a=e.length,s=[];s[0]=2;for(var n=0;n<a;n+=1){var o=r&&r[n]||0;s[n+1]=e[n]-o+256&255}return s}function gS(e,t,r){var a=e.length,s=[];s[0]=3;for(var n=0;n<a;n+=1){var o=e[n-t]||0,c=r&&r[n]||0;s[n+1]=e[n]+256-(o+c>>>1)&255}return s}function mS(e,t,r){var a=e.length,s=[];s[0]=4;for(var n=0;n<a;n+=1){var o=ate(e[n-t]||0,r&&r[n]||0,r&&r[n-t]||0);s[n+1]=e[n]-o+256&255}return s}function ate(e,t,r){if(e===t&&t===r)return e;var a=Math.abs(t-r),s=Math.abs(e-r),n=Math.abs(e+t-r-r);return a<=s&&a<=n?e:s<=n?t:r}function ste(e){var t=e.map(function(r){return r.reduce(function(a,s){return a+Math.abs(s)},0)});return t.indexOf(Math.min.apply(null,t))}function tw(e,t,r){var a=t*r,s=Math.floor(a/8),n=16-(a-8*s+r),o=(1<<r)-1;return YT(e,s)>>n&o}function xS(e,t,r,a){var s=r*a,n=Math.floor(s/8),o=16-(s-8*n+a),c=(1<<a)-1,u=(t&c)<<o;(function(f,h,g){if(h+1<f.byteLength)f.setUint16(h,g,!1);else{var x=g>>8&255;f.setUint8(h,x)}})(e,n,YT(e,n)&~(c<<o)&65535|u)}function YT(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function nte(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,a=e[t++]|e[t++]<<8,s=e[t++],n=s>>7,o=1<<1+(7&s);e[t++],e[t++];var c=null,u=null;n&&(c=t,u=o,t+=3*o);var f=!0,h=[],g=0,x=null,m=0,w=null;for(this.width=r,this.height=a;f&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,w=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((T=e[t++])>=0))throw Error("Invalid block size");if(T===0)break;t+=T}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var v=e[t++];g=e[t++]|e[t++]<<8,x=e[t++],1&v||(x=null),m=v>>2&7,t++;break;case 254:for(;;){if(!((T=e[t++])>=0))throw Error("Invalid block size");if(T===0)break;t+=T}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var B=e[t++]|e[t++]<<8,k=e[t++]|e[t++]<<8,E=e[t++]|e[t++]<<8,S=e[t++]|e[t++]<<8,L=e[t++],P=L>>6&1,R=1<<1+(7&L),Q=c,V=u,U=!1;L>>7&&(U=!0,Q=t,V=R,t+=3*R);var M=t;for(t++;;){var T;if(!((T=e[t++])>=0))throw Error("Invalid block size");if(T===0)break;t+=T}h.push({x:B,y:k,width:E,height:S,has_local_palette:U,palette_offset:Q,palette_size:V,data_offset:M,data_length:t-M,transparent_index:x,interlaced:!!P,delay:g,disposal:m});break;case 59:f=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return h.length},this.loopCount=function(){return w},this.frameInfo=function(D){if(D<0||D>=h.length)throw new Error("Frame index out of range.");return h[D]},this.decodeAndBlitFrameBGRA=function(D,G){var ne=this.frameInfo(D),H=ne.width*ne.height,ee=new Uint8Array(H);bS(e,ne.data_offset,ee,H);var le=ne.palette_offset,pe=ne.transparent_index;pe===null&&(pe=256);var te=ne.width,Le=r-te,je=te,F=4*(ne.y*r+ne.x),K=4*((ne.y+ne.height)*r+ne.x),I=F,q=4*Le;ne.interlaced===!0&&(q+=4*r*7);for(var J=8,Y=0,de=ee.length;Y<de;++Y){var ue=ee[Y];if(je===0&&(je=te,(I+=q)>=K&&(q=4*Le+4*r*(J-1),I=F+(te+Le)*(J<<1),J>>=1)),ue===pe)I+=4;else{var we=e[le+3*ue],Ie=e[le+3*ue+1],Ae=e[le+3*ue+2];G[I++]=Ae,G[I++]=Ie,G[I++]=we,G[I++]=255}--je}},this.decodeAndBlitFrameRGBA=function(D,G){var ne=this.frameInfo(D),H=ne.width*ne.height,ee=new Uint8Array(H);bS(e,ne.data_offset,ee,H);var le=ne.palette_offset,pe=ne.transparent_index;pe===null&&(pe=256);var te=ne.width,Le=r-te,je=te,F=4*(ne.y*r+ne.x),K=4*((ne.y+ne.height)*r+ne.x),I=F,q=4*Le;ne.interlaced===!0&&(q+=4*r*7);for(var J=8,Y=0,de=ee.length;Y<de;++Y){var ue=ee[Y];if(je===0&&(je=te,(I+=q)>=K&&(q=4*Le+4*r*(J-1),I=F+(te+Le)*(J<<1),J>>=1)),ue===pe)I+=4;else{var we=e[le+3*ue],Ie=e[le+3*ue+1],Ae=e[le+3*ue+2];G[I++]=we,G[I++]=Ie,G[I++]=Ae,G[I++]=255}--je}}}function bS(e,t,r,a){for(var s=e[t++],n=1<<s,o=n+1,c=o+1,u=s+1,f=(1<<u)-1,h=0,g=0,x=0,m=e[t++],w=new Int32Array(4096),v=null;;){for(;h<16&&m!==0;)g|=e[t++]<<h,h+=8,m===1?m=e[t++]:--m;if(h<u)break;var B=g&f;if(g>>=u,h-=u,B!==n){if(B===o)break;for(var k=B<c?B:v,E=0,S=k;S>n;)S=w[S]>>8,++E;var L=S;if(x+E+(k!==B?1:0)>a)return void us.log("Warning, gif stream longer than expected.");r[x++]=L;var P=x+=E;for(k!==B&&(r[x++]=L),S=k;E--;)S=w[S],r[--P]=255&S,S>>=8;v!==null&&c<4096&&(w[c++]=v<<8|L,c>=f+1&&u<12&&(++u,f=f<<1|1)),v=B}else c=o+1,f=(1<<(u=s+1))-1,v=null}return x!==a&&us.log("Warning, gif stream shorter than expected."),r}function rw(e){var t,r,a,s,n,o=Math.floor,c=new Array(64),u=new Array(64),f=new Array(64),h=new Array(64),g=new Array(65535),x=new Array(65535),m=new Array(64),w=new Array(64),v=[],B=0,k=7,E=new Array(64),S=new Array(64),L=new Array(64),P=new Array(256),R=new Array(2048),Q=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],V=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],U=[0,1,2,3,4,5,6,7,8,9,10,11],M=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],T=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],D=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],G=[0,1,2,3,4,5,6,7,8,9,10,11],ne=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],H=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ee(F,K){for(var I=0,q=0,J=new Array,Y=1;Y<=16;Y++){for(var de=1;de<=F[Y];de++)J[K[q]]=[],J[K[q]][0]=I,J[K[q]][1]=Y,q++,I++;I*=2}return J}function le(F){for(var K=F[0],I=F[1]-1;I>=0;)K&1<<I&&(B|=1<<k),I--,--k<0&&(B==255?(pe(255),pe(0)):pe(B),k=7,B=0)}function pe(F){v.push(F)}function te(F){pe(F>>8&255),pe(255&F)}function Le(F,K,I,q,J){for(var Y,de=J[0],ue=J[240],we=(function(Ge,pt){var nt,Dt,It,Ot,sr,er,cr,Vt,mt,Nt,gt=0;for(mt=0;mt<8;++mt){nt=Ge[gt],Dt=Ge[gt+1],It=Ge[gt+2],Ot=Ge[gt+3],sr=Ge[gt+4],er=Ge[gt+5],cr=Ge[gt+6];var dr=nt+(Vt=Ge[gt+7]),Ht=nt-Vt,Rt=Dt+cr,$t=Dt-cr,vr=It+er,vt=It-er,kr=Ot+sr,tr=Ot-sr,rr=dr+kr,Xt=dr-kr,Kt=Rt+vr,Ft=Rt-vr;Ge[gt]=rr+Kt,Ge[gt+4]=rr-Kt;var Zt=.707106781*(Ft+Xt);Ge[gt+2]=Xt+Zt,Ge[gt+6]=Xt-Zt;var wr=.382683433*((rr=tr+vt)-(Ft=$t+Ht)),Re=.5411961*rr+wr,Et=1.306562965*Ft+wr,Tt=.707106781*(Kt=vt+$t),Bt=Ht+Tt,Yt=Ht-Tt;Ge[gt+5]=Yt+Re,Ge[gt+3]=Yt-Re,Ge[gt+1]=Bt+Et,Ge[gt+7]=Bt-Et,gt+=8}for(gt=0,mt=0;mt<8;++mt){nt=Ge[gt],Dt=Ge[gt+8],It=Ge[gt+16],Ot=Ge[gt+24],sr=Ge[gt+32],er=Ge[gt+40],cr=Ge[gt+48];var Mr=nt+(Vt=Ge[gt+56]),Jr=nt-Vt,jr=Dt+cr,fr=Dt-cr,Cr=It+er,re=It-er,ke=Ot+sr,me=Ot-sr,be=Mr+ke,ye=Mr-ke,O=jr+Cr,ce=jr-Cr;Ge[gt]=be+O,Ge[gt+32]=be-O;var Fe=.707106781*(ce+ye);Ge[gt+16]=ye+Fe,Ge[gt+48]=ye-Fe;var Ne=.382683433*((be=me+re)-(ce=fr+Jr)),Te=.5411961*be+Ne,Ue=1.306562965*ce+Ne,tt=.707106781*(O=re+fr),_t=Jr+tt,Ct=Jr-tt;Ge[gt+40]=Ct+Te,Ge[gt+24]=Ct-Te,Ge[gt+8]=_t+Ue,Ge[gt+56]=_t-Ue,gt++}for(mt=0;mt<64;++mt)Nt=Ge[mt]*pt[mt],m[mt]=Nt>0?Nt+.5|0:Nt-.5|0;return m})(F,K),Ie=0;Ie<64;++Ie)w[Q[Ie]]=we[Ie];var Ae=w[0]-I;I=w[0],Ae==0?le(q[0]):(le(q[x[Y=32767+Ae]]),le(g[Y]));for(var oe=63;oe>0&&w[oe]==0;)oe--;if(oe==0)return le(de),I;for(var He,se=1;se<=oe;){for(var qe=se;w[se]==0&&se<=oe;)++se;var Ye=se-qe;if(Ye>=16){He=Ye>>4;for(var at=1;at<=He;++at)le(ue);Ye&=15}Y=32767+w[se],le(J[(Ye<<4)+x[Y]]),le(g[Y]),se++}return oe!=63&&le(de),I}function je(F){F=Math.min(Math.max(F,1),100),n!=F&&((function(K){for(var I=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],q=0;q<64;q++){var J=o((I[q]*K+50)/100);J=Math.min(Math.max(J,1),255),c[Q[q]]=J}for(var Y=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],de=0;de<64;de++){var ue=o((Y[de]*K+50)/100);ue=Math.min(Math.max(ue,1),255),u[Q[de]]=ue}for(var we=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ie=0,Ae=0;Ae<8;Ae++)for(var oe=0;oe<8;oe++)f[Ie]=1/(c[Q[Ie]]*we[Ae]*we[oe]*8),h[Ie]=1/(u[Q[Ie]]*we[Ae]*we[oe]*8),Ie++})(F<50?Math.floor(5e3/F):Math.floor(200-2*F)),n=F)}this.encode=function(F,K){K&&je(K),v=new Array,B=0,k=7,te(65496),te(65504),te(16),pe(74),pe(70),pe(73),pe(70),pe(0),pe(1),pe(1),pe(0),te(1),te(1),pe(0),pe(0),(function(){te(65499),te(132),pe(0);for(var Dt=0;Dt<64;Dt++)pe(c[Dt]);pe(1);for(var It=0;It<64;It++)pe(u[It])})(),(function(Dt,It){te(65472),te(17),pe(8),te(It),te(Dt),pe(3),pe(1),pe(17),pe(0),pe(2),pe(17),pe(1),pe(3),pe(17),pe(1)})(F.width,F.height),(function(){te(65476),te(418),pe(0);for(var Dt=0;Dt<16;Dt++)pe(V[Dt+1]);for(var It=0;It<=11;It++)pe(U[It]);pe(16);for(var Ot=0;Ot<16;Ot++)pe(M[Ot+1]);for(var sr=0;sr<=161;sr++)pe(T[sr]);pe(1);for(var er=0;er<16;er++)pe(D[er+1]);for(var cr=0;cr<=11;cr++)pe(G[cr]);pe(17);for(var Vt=0;Vt<16;Vt++)pe(ne[Vt+1]);for(var mt=0;mt<=161;mt++)pe(H[mt])})(),te(65498),te(12),pe(3),pe(1),pe(0),pe(2),pe(17),pe(3),pe(17),pe(0),pe(63),pe(0);var I=0,q=0,J=0;B=0,k=7,this.encode.displayName="_encode_";for(var Y,de,ue,we,Ie,Ae,oe,He,se,qe=F.data,Ye=F.width,at=F.height,Ge=4*Ye,pt=0;pt<at;){for(Y=0;Y<Ge;){for(Ie=Ge*pt+Y,oe=-1,He=0,se=0;se<64;se++)Ae=Ie+(He=se>>3)*Ge+(oe=4*(7&se)),pt+He>=at&&(Ae-=Ge*(pt+1+He-at)),Y+oe>=Ge&&(Ae-=Y+oe-Ge+4),de=qe[Ae++],ue=qe[Ae++],we=qe[Ae++],E[se]=(R[de]+R[ue+256|0]+R[we+512|0]>>16)-128,S[se]=(R[de+768|0]+R[ue+1024|0]+R[we+1280|0]>>16)-128,L[se]=(R[de+1280|0]+R[ue+1536|0]+R[we+1792|0]>>16)-128;I=Le(E,f,I,t,a),q=Le(S,h,q,r,s),J=Le(L,h,J,r,s),Y+=32}pt+=8}if(k>=0){var nt=[];nt[1]=k+1,nt[0]=(1<<k+1)-1,le(nt)}return te(65497),new Uint8Array(v)},e=e||50,(function(){for(var F=String.fromCharCode,K=0;K<256;K++)P[K]=F(K)})(),t=ee(V,U),r=ee(D,G),a=ee(M,T),s=ee(ne,H),(function(){for(var F=1,K=2,I=1;I<=15;I++){for(var q=F;q<K;q++)x[32767+q]=I,g[32767+q]=[],g[32767+q][1]=I,g[32767+q][0]=q;for(var J=-(K-1);J<=-F;J++)x[32767+J]=I,g[32767+J]=[],g[32767+J][1]=I,g[32767+J][0]=K-1+J;F<<=1,K<<=1}})(),(function(){for(var F=0;F<256;F++)R[F]=19595*F,R[F+256|0]=38470*F,R[F+512|0]=7471*F+32768,R[F+768|0]=-11059*F,R[F+1024|0]=-21709*F,R[F+1280|0]=32768*F+8421375,R[F+1536|0]=-27439*F,R[F+1792|0]=-5329*F})(),je(e)}function yA(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function vS(e){function t(U){if(!U)throw Error("assert :P")}function r(U,M,T){for(var D=0;4>D;D++)if(U[M+D]!=T.charCodeAt(D))return!0;return!1}function a(U,M,T,D,G){for(var ne=0;ne<G;ne++)U[M+ne]=T[D+ne]}function s(U,M,T,D){for(var G=0;G<D;G++)U[M+G]=T}function n(U){return new Int32Array(U)}function o(U,M){for(var T=[],D=0;D<U;D++)T.push(new M);return T}function c(U,M){var T=[];return(function D(G,ne,H){for(var ee=H[ne],le=0;le<ee&&(G.push(H.length>ne+1?[]:new M),!(H.length<ne+1));le++)D(G[le],ne+1,H)})(T,0,U),T}var u=function(){var U=this;function M(b,y){for(var j=1<<y-1>>>0;b&j;)j>>>=1;return j?(b&j-1)+j:b}function T(b,y,j,z,ie){t(!(z%j));do b[y+(z-=j)]=ie;while(0<z)}function D(b,y,j,z,ie){if(t(2328>=ie),512>=ie)var fe=n(512);else if((fe=n(ie))==null)return 0;return(function(he,xe,_e,Ce,Oe,Xe){var Be,Pe,We=xe,ot=1<<_e,$e=n(16),lt=n(16);for(t(Oe!=0),t(Ce!=null),t(he!=null),t(0<_e),Pe=0;Pe<Oe;++Pe){if(15<Ce[Pe])return 0;++$e[Ce[Pe]]}if($e[0]==Oe)return 0;for(lt[1]=0,Be=1;15>Be;++Be){if($e[Be]>1<<Be)return 0;lt[Be+1]=lt[Be]+$e[Be]}for(Pe=0;Pe<Oe;++Pe)Be=Ce[Pe],0<Ce[Pe]&&(Xe[lt[Be]++]=Pe);if(lt[15]==1)return(Ce=new G).g=0,Ce.value=Xe[0],T(he,We,1,ot,Ce),ot;var dt,Lt=-1,bt=ot-1,gr=0,lr=1,$r=1,ur=1<<_e;for(Pe=0,Be=1,Oe=2;Be<=_e;++Be,Oe<<=1){if(lr+=$r<<=1,0>($r-=$e[Be]))return 0;for(;0<$e[Be];--$e[Be])(Ce=new G).g=Be,Ce.value=Xe[Pe++],T(he,We+gr,Oe,ur,Ce),gr=M(gr,Be)}for(Be=_e+1,Oe=2;15>=Be;++Be,Oe<<=1){if(lr+=$r<<=1,0>($r-=$e[Be]))return 0;for(;0<$e[Be];--$e[Be]){if(Ce=new G,(gr&bt)!=Lt){for(We+=ur,dt=1<<(Lt=Be)-_e;15>Lt&&!(0>=(dt-=$e[Lt]));)++Lt,dt<<=1;ot+=ur=1<<(dt=Lt-_e),he[xe+(Lt=gr&bt)].g=dt+_e,he[xe+Lt].value=We-xe-Lt}Ce.g=Be-_e,Ce.value=Xe[Pe++],T(he,We+(gr>>_e),Oe,ur,Ce),gr=M(gr,Be)}}return lr!=2*lt[15]-1?0:ot})(b,y,j,z,ie,fe)}function G(){this.value=this.g=0}function ne(){this.value=this.g=0}function H(){this.G=o(5,G),this.H=n(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Uo,ne)}function ee(b,y,j,z){t(b!=null),t(y!=null),t(2147483648>z),b.Ca=254,b.I=0,b.b=-8,b.Ka=0,b.oa=y,b.pa=j,b.Jd=y,b.Yc=j+z,b.Zc=4<=z?j+z-4+1:j,de(b)}function le(b,y){for(var j=0;0<y--;)j|=we(b,128)<<y;return j}function pe(b,y){var j=le(b,y);return ue(b)?-j:j}function te(b,y,j,z){var ie,fe=0;for(t(b!=null),t(y!=null),t(4294967288>z),b.Sb=z,b.Ra=0,b.u=0,b.h=0,4<z&&(z=4),ie=0;ie<z;++ie)fe+=y[j+ie]<<8*ie;b.Ra=fe,b.bb=z,b.oa=y,b.pa=j}function Le(b){for(;8<=b.u&&b.bb<b.Sb;)b.Ra>>>=8,b.Ra+=b.oa[b.pa+b.bb]<<Ki-8>>>0,++b.bb,b.u-=8;q(b)&&(b.h=1,b.u=0)}function je(b,y){if(t(0<=y),!b.h&&y<=jn){var j=I(b)&Jn[y];return b.u+=y,Le(b),j}return b.h=1,b.u=0}function F(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function K(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function I(b){return b.Ra>>>(b.u&Ki-1)>>>0}function q(b){return t(b.bb<=b.Sb),b.h||b.bb==b.Sb&&b.u>Ki}function J(b,y){b.u=y,b.h=q(b)}function Y(b){b.u>=Un&&(t(b.u>=Un),Le(b))}function de(b){t(b!=null&&b.oa!=null),b.pa<b.Zc?(b.I=(b.oa[b.pa++]|b.I<<8)>>>0,b.b+=8):(t(b!=null&&b.oa!=null),b.pa<b.Yc?(b.b+=8,b.I=b.oa[b.pa++]|b.I<<8):b.Ka?b.b=0:(b.I<<=8,b.b+=8,b.Ka=1))}function ue(b){return le(b,1)}function we(b,y){var j=b.Ca;0>b.b&&de(b);var z=b.b,ie=j*y>>>8,fe=(b.I>>>z>ie)+0;for(fe?(j-=ie,b.I-=ie+1<<z>>>0):j=ie+1,z=j,ie=0;256<=z;)ie+=8,z>>=8;return z=7^ie+co[z],b.b-=z,b.Ca=(j<<z)-1,fe}function Ie(b,y,j){b[y+0]=j>>24&255,b[y+1]=j>>16&255,b[y+2]=j>>8&255,b[y+3]=255&j}function Ae(b,y){return b[y+0]|b[y+1]<<8}function oe(b,y){return Ae(b,y)|b[y+2]<<16}function He(b,y){return Ae(b,y)|Ae(b,y+2)<<16}function se(b,y){var j=1<<y;return t(b!=null),t(0<y),b.X=n(j),b.X==null?0:(b.Mb=32-y,b.Xa=y,1)}function qe(b,y){t(b!=null),t(y!=null),t(b.Xa==y.Xa),a(y.X,0,b.X,0,1<<y.Xa)}function Ye(){this.X=[],this.Xa=this.Mb=0}function at(b,y,j,z){t(j!=null),t(z!=null);var ie=j[0],fe=z[0];return ie==0&&(ie=(b*fe+y/2)/y),fe==0&&(fe=(y*ie+b/2)/b),0>=ie||0>=fe?0:(j[0]=ie,z[0]=fe,1)}function Ge(b,y){return b+(1<<y)-1>>>y}function pt(b,y){return((4278255360&b)+(4278255360&y)>>>0&4278255360)+((16711935&b)+(16711935&y)>>>0&16711935)>>>0}function nt(b,y){U[y]=function(j,z,ie,fe,he,xe,_e){var Ce;for(Ce=0;Ce<he;++Ce){var Oe=U[b](xe[_e+Ce-1],ie,fe+Ce);xe[_e+Ce]=pt(j[z+Ce],Oe)}}}function Dt(){this.ud=this.hd=this.jd=0}function It(b,y){return((4278124286&(b^y))>>>1)+(b&y)>>>0}function Ot(b){return 0<=b&&256>b?b:0>b?0:255<b?255:void 0}function sr(b,y){return Ot(b+(b-y+.5>>1))}function er(b,y,j){return Math.abs(y-j)-Math.abs(b-j)}function cr(b,y,j,z,ie,fe,he){for(z=fe[he-1],j=0;j<ie;++j)fe[he+j]=z=pt(b[y+j],z)}function Vt(b,y,j,z,ie){var fe;for(fe=0;fe<j;++fe){var he=b[y+fe],xe=he>>8&255,_e=16711935&(_e=(_e=16711935&he)+((xe<<16)+xe));z[ie+fe]=(4278255360&he)+_e>>>0}}function mt(b,y){y.jd=255&b,y.hd=b>>8&255,y.ud=b>>16&255}function Nt(b,y,j,z,ie,fe){var he;for(he=0;he<z;++he){var xe=y[j+he],_e=xe>>>8,Ce=xe,Oe=255&(Oe=(Oe=xe>>>16)+((b.jd<<24>>24)*(_e<<24>>24)>>>5));Ce=255&(Ce=(Ce+=(b.hd<<24>>24)*(_e<<24>>24)>>>5)+((b.ud<<24>>24)*(Oe<<24>>24)>>>5)),ie[fe+he]=(4278255360&xe)+(Oe<<16)+Ce}}function gt(b,y,j,z,ie){U[y]=function(fe,he,xe,_e,Ce,Oe,Xe,Be,Pe){for(_e=Xe;_e<Be;++_e)for(Xe=0;Xe<Pe;++Xe)Ce[Oe++]=ie(xe[z(fe[he++])])},U[b]=function(fe,he,xe,_e,Ce,Oe,Xe){var Be=8>>fe.b,Pe=fe.Ea,We=fe.K[0],ot=fe.w;if(8>Be)for(fe=(1<<fe.b)-1,ot=(1<<Be)-1;he<xe;++he){var $e,lt=0;for($e=0;$e<Pe;++$e)$e&fe||(lt=z(_e[Ce++])),Oe[Xe++]=ie(We[lt&ot]),lt>>=Be}else U["VP8LMapColor"+j](_e,Ce,We,ot,Oe,Xe,he,xe,Pe)}}function dr(b,y,j,z,ie){for(j=y+j;y<j;){var fe=b[y++];z[ie++]=fe>>16&255,z[ie++]=fe>>8&255,z[ie++]=255&fe}}function Ht(b,y,j,z,ie){for(j=y+j;y<j;){var fe=b[y++];z[ie++]=fe>>16&255,z[ie++]=fe>>8&255,z[ie++]=255&fe,z[ie++]=fe>>24&255}}function Rt(b,y,j,z,ie){for(j=y+j;y<j;){var fe=(he=b[y++])>>16&240|he>>12&15,he=240&he|he>>28&15;z[ie++]=fe,z[ie++]=he}}function $t(b,y,j,z,ie){for(j=y+j;y<j;){var fe=(he=b[y++])>>16&248|he>>13&7,he=he>>5&224|he>>3&31;z[ie++]=fe,z[ie++]=he}}function vr(b,y,j,z,ie){for(j=y+j;y<j;){var fe=b[y++];z[ie++]=255&fe,z[ie++]=fe>>8&255,z[ie++]=fe>>16&255}}function vt(b,y,j,z,ie,fe){if(fe==0)for(j=y+j;y<j;)Ie(z,((fe=b[y++])[0]>>24|fe[1]>>8&65280|fe[2]<<8&16711680|fe[3]<<24)>>>0),ie+=32;else a(z,ie,b,y,j)}function kr(b,y){U[y][0]=U[b+"0"],U[y][1]=U[b+"1"],U[y][2]=U[b+"2"],U[y][3]=U[b+"3"],U[y][4]=U[b+"4"],U[y][5]=U[b+"5"],U[y][6]=U[b+"6"],U[y][7]=U[b+"7"],U[y][8]=U[b+"8"],U[y][9]=U[b+"9"],U[y][10]=U[b+"10"],U[y][11]=U[b+"11"],U[y][12]=U[b+"12"],U[y][13]=U[b+"13"],U[y][14]=U[b+"0"],U[y][15]=U[b+"0"]}function tr(b){return b==v0||b==dd||b==gu||b==fd}function rr(){this.eb=[],this.size=this.A=this.fb=0}function Xt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Kt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new rr,this.f.kb=new Xt,this.sd=null}function Ft(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Zt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function wr(b){return alert("todo:WebPSamplerProcessPlane"),b.T}function Re(b,y){var j=b.T,z=y.ba.f.RGBA,ie=z.eb,fe=z.fb+b.ka*z.A,he=ti[y.ba.S],xe=b.y,_e=b.O,Ce=b.f,Oe=b.N,Xe=b.ea,Be=b.W,Pe=y.cc,We=y.dc,ot=y.Mc,$e=y.Nc,lt=b.ka,dt=b.ka+b.T,Lt=b.U,bt=Lt+1>>1;for(lt==0?he(xe,_e,null,null,Ce,Oe,Xe,Be,Ce,Oe,Xe,Be,ie,fe,null,null,Lt):(he(y.ec,y.fc,xe,_e,Pe,We,ot,$e,Ce,Oe,Xe,Be,ie,fe-z.A,ie,fe,Lt),++j);lt+2<dt;lt+=2)Pe=Ce,We=Oe,ot=Xe,$e=Be,Oe+=b.Rc,Be+=b.Rc,fe+=2*z.A,he(xe,(_e+=2*b.fa)-b.fa,xe,_e,Pe,We,ot,$e,Ce,Oe,Xe,Be,ie,fe-z.A,ie,fe,Lt);return _e+=b.fa,b.j+dt<b.o?(a(y.ec,y.fc,xe,_e,Lt),a(y.cc,y.dc,Ce,Oe,bt),a(y.Mc,y.Nc,Xe,Be,bt),j--):1&dt||he(xe,_e,null,null,Ce,Oe,Xe,Be,Ce,Oe,Xe,Be,ie,fe+z.A,null,null,Lt),j}function Et(b,y,j){var z=b.F,ie=[b.J];if(z!=null){var fe=b.U,he=y.ba.S,xe=he==b0||he==gu;y=y.ba.f.RGBA;var _e=[0],Ce=b.ka;_e[0]=b.T,b.Kb&&(Ce==0?--_e[0]:(--Ce,ie[0]-=b.width),b.j+b.ka+b.T==b.o&&(_e[0]=b.o-b.j-Ce));var Oe=y.eb;Ce=y.fb+Ce*y.A,b=Zs(z,ie[0],b.width,fe,_e,Oe,Ce+(xe?0:3),y.A),t(j==_e),b&&tr(he)&&gs(Oe,Ce,xe,fe,_e,y.A)}return 0}function Tt(b){var y=b.ma,j=y.ba.S,z=11>j,ie=j==xr||j==Ql||j==b0||j==pu||j==12||tr(j);if(y.memory=null,y.Ib=null,y.Jb=null,y.Nd=null,!Ll(y.Oa,b,ie?11:12))return 0;if(ie&&tr(j)&&ws(),b.da)alert("todo:use_scaling");else{if(z){if(y.Ib=wr,b.Kb){if(j=b.U+1>>1,y.memory=n(b.U+2*j),y.memory==null)return 0;y.ec=y.memory,y.fc=0,y.cc=y.ec,y.dc=y.fc+b.U,y.Mc=y.cc,y.Nc=y.dc+j,y.Ib=Re,ws()}}else alert("todo:EmitYUV");ie&&(y.Jb=Et,z&&ul())}if(z&&!ec){for(b=0;256>b;++b)ri[b]=89858*(b-128)+bu>>ql,Nb[b]=-22014*(b-128)+bu,ug[b]=-45773*(b-128),xd[b]=113618*(b-128)+bu>>ql;for(b=Ic;b<ZA;++b)y=76283*(b-16)+bu>>ql,Eb[b-Ic]=St(y,255),Fb[b-Ic]=St(y+8>>4,15);ec=1}return 1}function Bt(b){var y=b.ma,j=b.U,z=b.T;return t(!(1&b.ka)),0>=j||0>=z?0:(j=y.Ib(b,y),y.Jb!=null&&y.Jb(b,y,j),y.Dc+=j,1)}function Yt(b){b.ma.memory=null}function Mr(b,y,j,z){return je(b,8)!=47?0:(y[0]=je(b,14)+1,j[0]=je(b,14)+1,z[0]=je(b,1),je(b,3)!=0?0:!b.h)}function Jr(b,y){if(4>b)return b+1;var j=b-2>>1;return(2+(1&b)<<j)+je(y,j)+1}function jr(b,y){return 120<y?y-120:1<=(j=((j=Rl[y-1])>>4)*b+(8-(15&j)))?j:1;var j}function fr(b,y,j){var z=I(j),ie=b[y+=255&z].g-8;return 0<ie&&(J(j,j.u+8),z=I(j),y+=b[y].value,y+=z&(1<<ie)-1),J(j,j.u+b[y].g),b[y].value}function Cr(b,y,j){return j.g+=b.g,j.value+=b.value<<y>>>0,t(8>=j.g),b.g}function re(b,y,j){var z=b.xc;return t((y=z==0?0:b.vc[b.md*(j>>z)+(y>>z)])<b.Wb),b.Ya[y]}function ke(b,y,j,z){var ie=b.ab,fe=b.c*y,he=b.C;y=he+y;var xe=j,_e=z;for(z=b.Ta,j=b.Ua;0<ie--;){var Ce=b.gc[ie],Oe=he,Xe=y,Be=xe,Pe=_e,We=(_e=z,xe=j,Ce.Ea);switch(t(Oe<Xe),t(Xe<=Ce.nc),Ce.hc){case 2:ys(Be,Pe,(Xe-Oe)*We,_e,xe);break;case 0:var ot=Oe,$e=Xe,lt=_e,dt=xe,Lt=(ur=Ce).Ea;ot==0&&(zA(Be,Pe,null,null,1,lt,dt),cr(Be,Pe+1,0,0,Lt-1,lt,dt+1),Pe+=Lt,dt+=Lt,++ot);for(var bt=1<<ur.b,gr=bt-1,lr=Ge(Lt,ur.b),$r=ur.K,ur=ur.w+(ot>>ur.b)*lr;ot<$e;){var ca=$r,As=ur,ea=1;for(dA(Be,Pe,lt,dt-Lt,1,lt,dt);ea<Lt;){var or=(ea&~gr)+bt;or>Lt&&(or=Lt),(0,Dl[ca[As++]>>8&15])(Be,Pe+ +ea,lt,dt+ea-Lt,or-ea,lt,dt+ea),ea=or}Pe+=Lt,dt+=Lt,++ot&gr||(ur+=lr)}Xe!=Ce.nc&&a(_e,xe-We,_e,xe+(Xe-Oe-1)*We,We);break;case 1:for(We=Be,$e=Pe,Lt=(Be=Ce.Ea)-(dt=Be&~(lt=(Pe=1<<Ce.b)-1)),ot=Ge(Be,Ce.b),bt=Ce.K,Ce=Ce.w+(Oe>>Ce.b)*ot;Oe<Xe;){for(gr=bt,lr=Ce,$r=new Dt,ur=$e+dt,ca=$e+Be;$e<ur;)mt(gr[lr++],$r),VA($r,We,$e,Pe,_e,xe),$e+=Pe,xe+=Pe;$e<ca&&(mt(gr[lr++],$r),VA($r,We,$e,Lt,_e,xe),$e+=Lt,xe+=Lt),++Oe&lt||(Ce+=ot)}break;case 3:if(Be==_e&&Pe==xe&&0<Ce.b){for($e=_e,Be=We=xe+(Xe-Oe)*We-(dt=(Xe-Oe)*Ge(Ce.Ea,Ce.b)),Pe=_e,lt=xe,ot=[],dt=(Lt=dt)-1;0<=dt;--dt)ot[dt]=Pe[lt+dt];for(dt=Lt-1;0<=dt;--dt)$e[Be+dt]=ot[dt];fu(Ce,Oe,Xe,_e,We,_e,xe)}else fu(Ce,Oe,Xe,Be,Pe,_e,xe)}xe=z,_e=j}_e!=j&&a(z,j,xe,_e,fe)}function me(b,y){var j=b.V,z=b.Ba+b.c*b.C,ie=y-b.C;if(t(y<=b.l.o),t(16>=ie),0<ie){var fe=b.l,he=b.Ta,xe=b.Ua,_e=fe.width;if(ke(b,ie,j,z),ie=xe=[xe],t((j=b.C)<(z=y)),t(fe.v<fe.va),z>fe.o&&(z=fe.o),j<fe.j){var Ce=fe.j-j;j=fe.j,ie[0]+=Ce*_e}if(j>=z?j=0:(ie[0]+=4*fe.v,fe.ka=j-fe.j,fe.U=fe.va-fe.v,fe.T=z-j,j=1),j){if(xe=xe[0],11>(j=b.ca).S){var Oe=j.f.RGBA,Xe=(z=j.S,ie=fe.U,fe=fe.T,Ce=Oe.eb,Oe.A),Be=fe;for(Oe=Oe.fb+b.Ma*Oe.A;0<Be--;){var Pe=he,We=xe,ot=ie,$e=Ce,lt=Oe;switch(z){case Do:GA(Pe,We,ot,$e,lt);break;case xr:zi(Pe,We,ot,$e,lt);break;case v0:zi(Pe,We,ot,$e,lt),gs($e,lt,0,ot,1,0);break;case pl:fA(Pe,We,ot,$e,lt);break;case Ql:vt(Pe,We,ot,$e,lt,1);break;case dd:vt(Pe,We,ot,$e,lt,1),gs($e,lt,0,ot,1,0);break;case b0:vt(Pe,We,ot,$e,lt,0);break;case gu:vt(Pe,We,ot,$e,lt,0),gs($e,lt,1,ot,1,0);break;case pu:Ds(Pe,We,ot,$e,lt);break;case fd:Ds(Pe,We,ot,$e,lt),es($e,lt,ot,1,0);break;case WA:Vi(Pe,We,ot,$e,lt);break;default:t(0)}xe+=_e,Oe+=Xe}b.Ma+=fe}else alert("todo:EmitRescaledRowsYUVA");t(b.Ma<=j.height)}}b.C=y,t(b.C<=b.i)}function be(b){var y;if(0<b.ua)return 0;for(y=0;y<b.Wb;++y){var j=b.Ya[y].G,z=b.Ya[y].H;if(0<j[1][z[1]+0].g||0<j[2][z[2]+0].g||0<j[3][z[3]+0].g)return 0}return 1}function ye(b,y,j,z,ie,fe){if(b.Z!=0){var he=b.qd,xe=b.rd;for(t(pA[b.Z]!=null);y<j;++y)pA[b.Z](he,xe,z,ie,z,ie,fe),he=z,xe=ie,ie+=fe;b.qd=he,b.rd=xe}}function O(b,y){var j=b.l.ma,z=j.Z==0||j.Z==1?b.l.j:b.C;if(z=b.C<z?z:b.C,t(y<=b.l.o),y>z){var ie=b.l.width,fe=j.ca,he=j.tb+ie*z,xe=b.V,_e=b.Ba+b.c*z,Ce=b.gc;t(b.ab==1),t(Ce[0].hc==3),Ul(Ce[0],z,y,xe,_e,fe,he),ye(j,z,y,fe,he,ie)}b.C=b.Ma=y}function ce(b,y,j,z,ie,fe,he){var xe=b.$/z,_e=b.$%z,Ce=b.m,Oe=b.s,Xe=j+b.$,Be=Xe;ie=j+z*ie;var Pe=j+z*fe,We=280+Oe.ua,ot=b.Pb?xe:16777216,$e=0<Oe.ua?Oe.Wa:null,lt=Oe.wc,dt=Xe<Pe?re(Oe,_e,xe):null;t(b.C<fe),t(Pe<=ie);var Lt=!1;e:for(;;){for(;Lt||Xe<Pe;){var bt=0;if(xe>=ot){var gr=Xe-j;t((ot=b).Pb),ot.wd=ot.m,ot.xd=gr,0<ot.s.ua&&qe(ot.s.Wa,ot.s.vb),ot=xe+$A}if(_e&lt||(dt=re(Oe,_e,xe)),t(dt!=null),dt.Qb&&(y[Xe]=dt.qb,Lt=!0),!Lt)if(Y(Ce),dt.jc){bt=Ce,gr=y;var lr=Xe,$r=dt.pd[I(bt)&Uo-1];t(dt.jc),256>$r.g?(J(bt,bt.u+$r.g),gr[lr]=$r.value,bt=0):(J(bt,bt.u+$r.g-256),t(256<=$r.value),bt=$r.value),bt==0&&(Lt=!0)}else bt=fr(dt.G[0],dt.H[0],Ce);if(Ce.h)break;if(Lt||256>bt){if(!Lt)if(dt.nd)y[Xe]=(dt.qb|bt<<8)>>>0;else{if(Y(Ce),Lt=fr(dt.G[1],dt.H[1],Ce),Y(Ce),gr=fr(dt.G[2],dt.H[2],Ce),lr=fr(dt.G[3],dt.H[3],Ce),Ce.h)break;y[Xe]=(lr<<24|Lt<<16|bt<<8|gr)>>>0}if(Lt=!1,++Xe,++_e>=z&&(_e=0,++xe,he!=null&&xe<=fe&&!(xe%16)&&he(b,xe),$e!=null))for(;Be<Xe;)bt=y[Be++],$e.X[(506832829*bt&4294967295)>>>$e.Mb]=bt}else if(280>bt){if(bt=Jr(bt-256,Ce),gr=fr(dt.G[4],dt.H[4],Ce),Y(Ce),gr=jr(z,gr=Jr(gr,Ce)),Ce.h)break;if(Xe-j<gr||ie-Xe<bt)break e;for(lr=0;lr<bt;++lr)y[Xe+lr]=y[Xe+lr-gr];for(Xe+=bt,_e+=bt;_e>=z;)_e-=z,++xe,he!=null&&xe<=fe&&!(xe%16)&&he(b,xe);if(t(Xe<=ie),_e&lt&&(dt=re(Oe,_e,xe)),$e!=null)for(;Be<Xe;)bt=y[Be++],$e.X[(506832829*bt&4294967295)>>>$e.Mb]=bt}else{if(!(bt<We))break e;for(Lt=bt-280,t($e!=null);Be<Xe;)bt=y[Be++],$e.X[(506832829*bt&4294967295)>>>$e.Mb]=bt;bt=Xe,t(!(Lt>>>(gr=$e).Xa)),y[bt]=gr.X[Lt],Lt=!0}Lt||t(Ce.h==q(Ce))}if(b.Pb&&Ce.h&&Xe<ie)t(b.m.h),b.a=5,b.m=b.wd,b.$=b.xd,0<b.s.ua&&qe(b.s.vb,b.s.Wa);else{if(Ce.h)break e;he?.(b,xe>fe?fe:xe),b.a=0,b.$=Xe-j}return 1}return b.a=3,0}function Fe(b){t(b!=null),b.vc=null,b.yc=null,b.Ya=null;var y=b.Wa;y!=null&&(y.X=null),b.vb=null,t(b!=null)}function Ne(){var b=new Ur;return b==null?null:(b.a=0,b.xb=Wf,kr("Predictor","VP8LPredictors"),kr("Predictor","VP8LPredictors_C"),kr("PredictorAdd","VP8LPredictorsAdd"),kr("PredictorAdd","VP8LPredictorsAdd_C"),ys=Vt,VA=Nt,GA=dr,zi=Ht,Ds=Rt,Vi=$t,fA=vr,U.VP8LMapColor32b=jl,U.VP8LMapColor8b=zs,b)}function Te(b,y,j,z,ie){var fe=1,he=[b],xe=[y],_e=z.m,Ce=z.s,Oe=null,Xe=0;e:for(;;){if(j)for(;fe&&je(_e,1);){var Be=he,Pe=xe,We=z,ot=1,$e=We.m,lt=We.gc[We.ab],dt=je($e,2);if(We.Oc&1<<dt)fe=0;else{switch(We.Oc|=1<<dt,lt.hc=dt,lt.Ea=Be[0],lt.nc=Pe[0],lt.K=[null],++We.ab,t(4>=We.ab),dt){case 0:case 1:lt.b=je($e,3)+2,ot=Te(Ge(lt.Ea,lt.b),Ge(lt.nc,lt.b),0,We,lt.K),lt.K=lt.K[0];break;case 3:var Lt,bt=je($e,8)+1,gr=16<bt?0:4<bt?1:2<bt?2:3;if(Be[0]=Ge(lt.Ea,gr),lt.b=gr,Lt=ot=Te(bt,1,0,We,lt.K)){var lr,$r=bt,ur=lt,ca=1<<(8>>ur.b),As=n(ca);if(As==null)Lt=0;else{var ea=ur.K[0],or=ur.w;for(As[0]=ur.K[0][0],lr=1;lr<1*$r;++lr)As[lr]=pt(ea[or+lr],As[lr-1]);for(;lr<4*ca;++lr)As[lr]=0;ur.K[0]=null,ur.K[0]=As,Lt=1}}ot=Lt;break;case 2:break;default:t(0)}fe=ot}}if(he=he[0],xe=xe[0],fe&&je(_e,1)&&!(fe=1<=(Xe=je(_e,4))&&11>=Xe)){z.a=3;break e}var qt;if(qt=fe)t:{var ks,Dr,ra,Qa=z,mn=he,ai=xe,ts=Xe,en=j,gi=Qa.m,tn=Qa.s,ia=[null],Ba=1,Bs=0,Ea=Ml[ts];r:for(;;){if(en&&je(gi,1)){var xn=je(gi,3)+2,Cs=Ge(mn,xn),Ca=Ge(ai,xn),Gs=Cs*Ca;if(!Te(Cs,Ca,0,Qa,ia))break r;for(ia=ia[0],tn.xc=xn,ks=0;ks<Gs;++ks){var Oa=ia[ks]>>8&65535;ia[ks]=Oa,Oa>=Ba&&(Ba=Oa+1)}}if(gi.h)break r;for(Dr=0;5>Dr;++Dr){var rn=Uc[Dr];!Dr&&0<ts&&(rn+=1<<ts),Bs<rn&&(Bs=rn)}var an=o(Ba*Ea,G),za=Ba,ya=o(za,H);if(ya==null)var mi=null;else t(65536>=za),mi=ya;var Qs=n(Bs);if(mi==null||Qs==null||an==null){Qa.a=1;break r}var Nr=an;for(ks=ra=0;ks<Ba;++ks){var Er=mi[ks],Sa=Er.G,$i=Er.H,Kl=0,Ti=1,sn=0;for(Dr=0;5>Dr;++Dr){rn=Uc[Dr],Sa[Dr]=Nr,$i[Dr]=ra,!Dr&&0<ts&&(rn+=1<<ts);s:{var tc,rc=rn,vd=Qa,rs=Qs,Xf=Nr,Yf=ra,wd=0,gA=vd.m,Tb=je(gA,1);if(s(rs,0,0,rc),Tb){var Jf=je(gA,1)+1,Zf=je(gA,1),_d=je(gA,Zf==0?1:8);rs[_d]=1,Jf==2&&(rs[_d=je(gA,8)]=1);var On=1}else{var Os=n(19),k0=je(gA,4)+4;if(19<k0){vd.a=3;var ac=0;break s}for(tc=0;tc<k0;++tc)Os[w0[tc]]=je(gA,3);var wu=void 0,Qc=void 0,Qo=vd,yd=Os,_u=rc,kd=rs,Bd=0,mA=Qo.m,eh=8,th=o(128,G);a:for(;D(th,0,7,yd,19);){if(je(mA,1)){var dg=2+2*je(mA,3);if((wu=2+je(mA,dg))>_u)break a}else wu=_u;for(Qc=0;Qc<_u&&wu--;){Y(mA);var rh=th[0+(127&I(mA))];J(mA,mA.u+rh.g);var sc=rh.value;if(16>sc)kd[Qc++]=sc,sc!=0&&(eh=sc);else{var fg=sc==16,hg=sc-16,pg=mu[hg],ah=je(mA,Ol[hg])+pg;if(Qc+ah>_u)break a;for(var gg=fg?eh:0;0<ah--;)kd[Qc++]=gg}}Bd=1;break a}Bd||(Qo.a=3),On=Bd}(On=On&&!gA.h)&&(wd=D(Xf,Yf,8,rs,rc)),On&&wd!=0?ac=wd:(vd.a=3,ac=0)}if(ac==0)break r;if(Ti&&hd[Dr]==1&&(Ti=Nr[ra].g==0),Kl+=Nr[ra].g,ra+=ac,3>=Dr){var Oc,Cd=Qs[0];for(Oc=1;Oc<rn;++Oc)Qs[Oc]>Cd&&(Cd=Qs[Oc]);sn+=Cd}}if(Er.nd=Ti,Er.Qb=0,Ti&&(Er.qb=(Sa[3][$i[3]+0].value<<24|Sa[1][$i[1]+0].value<<16|Sa[2][$i[2]+0].value)>>>0,Kl==0&&256>Sa[0][$i[0]+0].value&&(Er.Qb=1,Er.qb+=Sa[0][$i[0]+0].value<<8)),Er.jc=!Er.Qb&&6>sn,Er.jc){var B0,Oo=Er;for(B0=0;B0<Uo;++B0){var xA=B0,bA=Oo.pd[xA],Sd=Oo.G[0][Oo.H[0]+xA];256<=Sd.value?(bA.g=Sd.g+256,bA.value=Sd.value):(bA.g=0,bA.value=0,xA>>=Cr(Sd,8,bA),xA>>=Cr(Oo.G[1][Oo.H[1]+xA],16,bA),xA>>=Cr(Oo.G[2][Oo.H[2]+xA],0,bA),Cr(Oo.G[3][Oo.H[3]+xA],24,bA))}}}tn.vc=ia,tn.Wb=Ba,tn.Ya=mi,tn.yc=an,qt=1;break t}qt=0}if(!(fe=qt)){z.a=3;break e}if(0<Xe){if(Ce.ua=1<<Xe,!se(Ce.Wa,Xe)){z.a=1,fe=0;break e}}else Ce.ua=0;var Nd=z,Rc=he,mg=xe,yu=Nd.s,ku=yu.xc;if(Nd.c=Rc,Nd.i=mg,yu.md=Ge(Rc,ku),yu.wc=ku==0?-1:(1<<ku)-1,j){z.xb=XA;break e}if((Oe=n(he*xe))==null){z.a=1,fe=0;break e}fe=(fe=ce(z,Oe,0,he,xe,xe,null))&&!_e.h;break e}return fe?(ie!=null?ie[0]=Oe:(t(Oe==null),t(j)),z.$=0,j||Fe(Ce)):Fe(Ce),fe}function Ue(b,y){var j=b.c*b.i,z=j+y+16*y;return t(b.c<=y),b.V=n(z),b.V==null?(b.Ta=null,b.Ua=0,b.a=1,0):(b.Ta=b.V,b.Ua=b.Ba+j+y,1)}function tt(b,y){var j=b.C,z=y-j,ie=b.V,fe=b.Ba+b.c*j;for(t(y<=b.l.o);0<z;){var he=16<z?16:z,xe=b.l.ma,_e=b.l.width,Ce=_e*he,Oe=xe.ca,Xe=xe.tb+_e*j,Be=b.Ta,Pe=b.Ua;ke(b,he,ie,fe),La(Be,Pe,Oe,Xe,Ce),ye(xe,j,j+he,Oe,Xe,_e),z-=he,ie+=he*b.c,j+=he}t(j==y),b.C=b.Ma=y}function _t(){this.ub=this.yd=this.td=this.Rb=0}function Ct(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function yt(){this.Fb=this.Bb=this.Cb=0,this.Zb=n(4),this.Lb=n(4)}function Ut(){this.Yb=(function(){var b=[];return(function y(j,z,ie){for(var fe=ie[z],he=0;he<fe&&(j.push(ie.length>z+1?[]:0),!(ie.length<z+1));he++)y(j[he],z+1,ie)})(b,0,[3,11]),b})()}function zt(){this.jb=n(3),this.Wc=c([4,8],Ut),this.Xc=c([4,17],Ut)}function Gr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new n(4),this.od=new n(4)}function Qr(){this.ld=this.La=this.dd=this.tc=0}function oa(){this.Na=this.la=0}function fs(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Tn(){this.ad=n(384),this.Za=0,this.Ob=n(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Vn(){this.uc=this.M=this.Nb=0,this.wa=Array(new Qr),this.Y=0,this.ya=Array(new Tn),this.aa=0,this.l=new st}function ve(){this.y=n(16),this.f=n(8),this.ea=n(8)}function it(){this.cb=this.a=0,this.sc="",this.m=new F,this.Od=new _t,this.Kc=new Ct,this.ed=new Gr,this.Qa=new yt,this.Ic=this.$c=this.Aa=0,this.D=new Vn,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,F),this.ia=0,this.pb=o(4,fs),this.Pa=new zt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new ve),this.Hd=0,this.rb=Array(new oa),this.sb=0,this.wa=Array(new Qr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Tn),this.L=this.aa=0,this.gd=c([4,2],Qr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function St(b,y){return 0>b?0:b>y?y:b}function st(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Hr(){var b=new it;return b!=null&&(b.a=0,b.sc="OK",b.cb=0,b.Xb=0,gl||(gl=Gn)),b}function yr(b,y,j){return b.a==0&&(b.a=y,b.sc=j,b.cb=0),0}function wa(b,y,j){return 3<=j&&b[y+0]==157&&b[y+1]==1&&b[y+2]==42}function Na(b,y){if(b==null)return 0;if(b.a=0,b.sc="OK",y==null)return yr(b,2,"null VP8Io passed to VP8GetHeaders()");var j=y.data,z=y.w,ie=y.ha;if(4>ie)return yr(b,7,"Truncated header.");var fe=j[z+0]|j[z+1]<<8|j[z+2]<<16,he=b.Od;if(he.Rb=!(1&fe),he.td=fe>>1&7,he.yd=fe>>4&1,he.ub=fe>>5,3<he.td)return yr(b,3,"Incorrect keyframe parameters.");if(!he.yd)return yr(b,4,"Frame not displayable.");z+=3,ie-=3;var xe=b.Kc;if(he.Rb){if(7>ie)return yr(b,7,"cannot parse picture header");if(!wa(j,z,ie))return yr(b,3,"Bad code word");xe.c=16383&(j[z+4]<<8|j[z+3]),xe.Td=j[z+4]>>6,xe.i=16383&(j[z+6]<<8|j[z+5]),xe.Ud=j[z+6]>>6,z+=7,ie-=7,b.za=xe.c+15>>4,b.Ub=xe.i+15>>4,y.width=xe.c,y.height=xe.i,y.Da=0,y.j=0,y.v=0,y.va=y.width,y.o=y.height,y.da=0,y.ib=y.width,y.hb=y.height,y.U=y.width,y.T=y.height,s((fe=b.Pa).jb,0,255,fe.jb.length),t((fe=b.Qa)!=null),fe.Cb=0,fe.Bb=0,fe.Fb=1,s(fe.Zb,0,0,fe.Zb.length),s(fe.Lb,0,0,fe.Lb)}if(he.ub>ie)return yr(b,7,"bad partition length");ee(fe=b.m,j,z,he.ub),z+=he.ub,ie-=he.ub,he.Rb&&(xe.Ld=ue(fe),xe.Kd=ue(fe)),xe=b.Qa;var _e,Ce=b.Pa;if(t(fe!=null),t(xe!=null),xe.Cb=ue(fe),xe.Cb){if(xe.Bb=ue(fe),ue(fe)){for(xe.Fb=ue(fe),_e=0;4>_e;++_e)xe.Zb[_e]=ue(fe)?pe(fe,7):0;for(_e=0;4>_e;++_e)xe.Lb[_e]=ue(fe)?pe(fe,6):0}if(xe.Bb)for(_e=0;3>_e;++_e)Ce.jb[_e]=ue(fe)?le(fe,8):255}else xe.Bb=0;if(fe.Ka)return yr(b,3,"cannot parse segment header");if((xe=b.ed).zd=ue(fe),xe.Tb=le(fe,6),xe.wb=le(fe,3),xe.Pc=ue(fe),xe.Pc&&ue(fe)){for(Ce=0;4>Ce;++Ce)ue(fe)&&(xe.vd[Ce]=pe(fe,6));for(Ce=0;4>Ce;++Ce)ue(fe)&&(xe.od[Ce]=pe(fe,6))}if(b.L=xe.Tb==0?0:xe.zd?1:2,fe.Ka)return yr(b,3,"cannot parse filter header");var Oe=ie;if(ie=_e=z,z=_e+Oe,xe=Oe,b.Xb=(1<<le(b.m,2))-1,Oe<3*(Ce=b.Xb))j=7;else{for(_e+=3*Ce,xe-=3*Ce,Oe=0;Oe<Ce;++Oe){var Xe=j[ie+0]|j[ie+1]<<8|j[ie+2]<<16;Xe>xe&&(Xe=xe),ee(b.Jc[+Oe],j,_e,Xe),_e+=Xe,xe-=Xe,ie+=3}ee(b.Jc[+Ce],j,_e,xe),j=_e<z?0:5}if(j!=0)return yr(b,j,"cannot parse partitions");for(j=le(_e=b.m,7),ie=ue(_e)?pe(_e,4):0,z=ue(_e)?pe(_e,4):0,xe=ue(_e)?pe(_e,4):0,Ce=ue(_e)?pe(_e,4):0,_e=ue(_e)?pe(_e,4):0,Oe=b.Qa,Xe=0;4>Xe;++Xe){if(Oe.Cb){var Be=Oe.Zb[Xe];Oe.Fb||(Be+=j)}else{if(0<Xe){b.pb[Xe]=b.pb[0];continue}Be=j}var Pe=b.pb[Xe];Pe.Sc[0]=Hl[St(Be+ie,127)],Pe.Sc[1]=Pl[St(Be+0,127)],Pe.Eb[0]=2*Hl[St(Be+z,127)],Pe.Eb[1]=101581*Pl[St(Be+xe,127)]>>16,8>Pe.Eb[1]&&(Pe.Eb[1]=8),Pe.Qc[0]=Hl[St(Be+Ce,117)],Pe.Qc[1]=Pl[St(Be+_e,127)],Pe.lc=Be+_e}if(!he.Rb)return yr(b,4,"Not a key frame.");for(ue(fe),he=b.Pa,j=0;4>j;++j){for(ie=0;8>ie;++ie)for(z=0;3>z;++z)for(xe=0;11>xe;++xe)Ce=we(fe,os[j][ie][z][xe])?le(fe,8):cg[j][ie][z][xe],he.Wc[j][ie].Yb[z][xe]=Ce;for(ie=0;17>ie;++ie)he.Xc[j][ie]=he.Wc[j][ha[ie]]}return b.kc=ue(fe),b.kc&&(b.Bd=le(fe,8)),b.cb=1}function Gn(b,y,j,z,ie,fe,he){var xe=y[ie].Yb[j];for(j=0;16>ie;++ie){if(!we(b,xe[j+0]))return ie;for(;!we(b,xe[j+1]);)if(xe=y[++ie].Yb[0],j=0,ie==16)return 16;var _e=y[ie+1].Yb;if(we(b,xe[j+2])){var Ce=b,Oe=0;if(we(Ce,(Be=xe)[(Xe=j)+3]))if(we(Ce,Be[Xe+6])){for(xe=0,Xe=2*(Oe=we(Ce,Be[Xe+8]))+(Be=we(Ce,Be[Xe+9+Oe])),Oe=0,Be=Ag[Xe];Be[xe];++xe)Oe+=Oe+we(Ce,Be[xe]);Oe+=3+(8<<Xe)}else we(Ce,Be[Xe+7])?(Oe=7+2*we(Ce,165),Oe+=we(Ce,145)):Oe=5+we(Ce,159);else Oe=we(Ce,Be[Xe+4])?3+we(Ce,Be[Xe+5]):2;xe=_e[2]}else Oe=1,xe=_e[1];_e=he+Gf[ie],0>(Ce=b).b&&de(Ce);var Xe,Be=Ce.b,Pe=(Xe=Ce.Ca>>1)-(Ce.I>>Be)>>31;--Ce.b,Ce.Ca+=Pe,Ce.Ca|=1,Ce.I-=(Xe+1&Pe)<<Be,fe[_e]=((Oe^Pe)-Pe)*z[(0<ie)+0]}return 16}function Lr(b){var y=b.rb[b.sb-1];y.la=0,y.Na=0,s(b.zc,0,0,b.zc.length),b.ja=0}function Ia(b,y,j,z,ie){ie=b[y+j+32*z]+(ie>>3),b[y+j+32*z]=-256&ie?0>ie?0:255:ie}function hs(b,y,j,z,ie,fe){Ia(b,y,0,j,z+ie),Ia(b,y,1,j,z+fe),Ia(b,y,2,j,z-fe),Ia(b,y,3,j,z-ie)}function ls(b){return(20091*b>>16)+b}function no(b,y,j,z){var ie,fe=0,he=n(16);for(ie=0;4>ie;++ie){var xe=b[y+0]+b[y+8],_e=b[y+0]-b[y+8],Ce=(35468*b[y+4]>>16)-ls(b[y+12]),Oe=ls(b[y+4])+(35468*b[y+12]>>16);he[fe+0]=xe+Oe,he[fe+1]=_e+Ce,he[fe+2]=_e-Ce,he[fe+3]=xe-Oe,fe+=4,y++}for(ie=fe=0;4>ie;++ie)xe=(b=he[fe+0]+4)+he[fe+8],_e=b-he[fe+8],Ce=(35468*he[fe+4]>>16)-ls(he[fe+12]),Ia(j,z,0,0,xe+(Oe=ls(he[fe+4])+(35468*he[fe+12]>>16))),Ia(j,z,1,0,_e+Ce),Ia(j,z,2,0,_e-Ce),Ia(j,z,3,0,xe-Oe),fe++,z+=32}function Ln(b,y,j,z){var ie=b[y+0]+4,fe=35468*b[y+4]>>16,he=ls(b[y+4]),xe=35468*b[y+1]>>16;hs(j,z,0,ie+he,b=ls(b[y+1]),xe),hs(j,z,1,ie+fe,b,xe),hs(j,z,2,ie-fe,b,xe),hs(j,z,3,ie-he,b,xe)}function io(b,y,j,z,ie){no(b,y,j,z),ie&&no(b,y+16,j,z+4)}function Ls(b,y,j,z){pi(b,y+0,j,z,1),pi(b,y+32,j,z+128,1)}function Bl(b,y,j,z){var ie;for(b=b[y+0]+4,ie=0;4>ie;++ie)for(y=0;4>y;++y)Ia(j,z,y,ie,b)}function iA(b,y,j,z){b[y+0]&&X(b,y+0,j,z),b[y+16]&&X(b,y+16,j,z+4),b[y+32]&&X(b,y+32,j,z+128),b[y+48]&&X(b,y+48,j,z+128+4)}function Si(b,y,j,z){var ie,fe=n(16);for(ie=0;4>ie;++ie){var he=b[y+0+ie]+b[y+12+ie],xe=b[y+4+ie]+b[y+8+ie],_e=b[y+4+ie]-b[y+8+ie],Ce=b[y+0+ie]-b[y+12+ie];fe[0+ie]=he+xe,fe[8+ie]=he-xe,fe[4+ie]=Ce+_e,fe[12+ie]=Ce-_e}for(ie=0;4>ie;++ie)he=(b=fe[0+4*ie]+3)+fe[3+4*ie],xe=fe[1+4*ie]+fe[2+4*ie],_e=fe[1+4*ie]-fe[2+4*ie],Ce=b-fe[3+4*ie],j[z+0]=he+xe>>3,j[z+16]=Ce+_e>>3,j[z+32]=he-xe>>3,j[z+48]=Ce-_e>>3,z+=64}function Wn(b,y,j){var z,ie=y-32,fe=Qn,he=255-b[ie-1];for(z=0;z<j;++z){var xe,_e=fe,Ce=he+b[y-1];for(xe=0;xe<j;++xe)b[y+xe]=_e[Ce+b[ie+xe]];y+=32}}function Tc(b,y){Wn(b,y,4)}function Lc(b,y){Wn(b,y,8)}function lA(b,y){Wn(b,y,16)}function OA(b,y){var j;for(j=0;16>j;++j)a(b,y+32*j,b,y-32,16)}function Ri(b,y){var j;for(j=16;0<j;--j)s(b,y,b[y-1],16),y+=32}function fn(b,y,j){var z;for(z=0;16>z;++z)s(y,j+32*z,b,16)}function cl(b,y){var j,z=16;for(j=0;16>j;++j)z+=b[y-1+32*j]+b[y+j-32];fn(z>>5,b,y)}function Ys(b,y){var j,z=8;for(j=0;16>j;++j)z+=b[y-1+32*j];fn(z>>4,b,y)}function No(b,y){var j,z=8;for(j=0;16>j;++j)z+=b[y+j-32];fn(z>>4,b,y)}function di(b,y){fn(128,b,y)}function Sr(b,y,j){return b+2*y+j+2>>2}function RA(b,y){var j,z=y-32;for(z=new Uint8Array([Sr(b[z-1],b[z+0],b[z+1]),Sr(b[z+0],b[z+1],b[z+2]),Sr(b[z+1],b[z+2],b[z+3]),Sr(b[z+2],b[z+3],b[z+4])]),j=0;4>j;++j)a(b,y+32*j,z,0,z.length)}function MA(b,y){var j=b[y-1],z=b[y-1+32],ie=b[y-1+64],fe=b[y-1+96];Ie(b,y+0,16843009*Sr(b[y-1-32],j,z)),Ie(b,y+32,16843009*Sr(j,z,ie)),Ie(b,y+64,16843009*Sr(z,ie,fe)),Ie(b,y+96,16843009*Sr(ie,fe,fe))}function HA(b,y){var j,z=4;for(j=0;4>j;++j)z+=b[y+j-32]+b[y-1+32*j];for(z>>=3,j=0;4>j;++j)s(b,y+32*j,z,4)}function $n(b,y){var j=b[y-1+0],z=b[y-1+32],ie=b[y-1+64],fe=b[y-1-32],he=b[y+0-32],xe=b[y+1-32],_e=b[y+2-32],Ce=b[y+3-32];b[y+0+96]=Sr(z,ie,b[y-1+96]),b[y+1+96]=b[y+0+64]=Sr(j,z,ie),b[y+2+96]=b[y+1+64]=b[y+0+32]=Sr(fe,j,z),b[y+3+96]=b[y+2+64]=b[y+1+32]=b[y+0+0]=Sr(he,fe,j),b[y+3+64]=b[y+2+32]=b[y+1+0]=Sr(xe,he,fe),b[y+3+32]=b[y+2+0]=Sr(_e,xe,he),b[y+3+0]=Sr(Ce,_e,xe)}function hn(b,y){var j=b[y+1-32],z=b[y+2-32],ie=b[y+3-32],fe=b[y+4-32],he=b[y+5-32],xe=b[y+6-32],_e=b[y+7-32];b[y+0+0]=Sr(b[y+0-32],j,z),b[y+1+0]=b[y+0+32]=Sr(j,z,ie),b[y+2+0]=b[y+1+32]=b[y+0+64]=Sr(z,ie,fe),b[y+3+0]=b[y+2+32]=b[y+1+64]=b[y+0+96]=Sr(ie,fe,he),b[y+3+32]=b[y+2+64]=b[y+1+96]=Sr(fe,he,xe),b[y+3+64]=b[y+2+96]=Sr(he,xe,_e),b[y+3+96]=Sr(xe,_e,_e)}function PA(b,y){var j=b[y-1+0],z=b[y-1+32],ie=b[y-1+64],fe=b[y-1-32],he=b[y+0-32],xe=b[y+1-32],_e=b[y+2-32],Ce=b[y+3-32];b[y+0+0]=b[y+1+64]=fe+he+1>>1,b[y+1+0]=b[y+2+64]=he+xe+1>>1,b[y+2+0]=b[y+3+64]=xe+_e+1>>1,b[y+3+0]=_e+Ce+1>>1,b[y+0+96]=Sr(ie,z,j),b[y+0+64]=Sr(z,j,fe),b[y+0+32]=b[y+1+96]=Sr(j,fe,he),b[y+1+32]=b[y+2+96]=Sr(fe,he,xe),b[y+2+32]=b[y+3+96]=Sr(he,xe,_e),b[y+3+32]=Sr(xe,_e,Ce)}function oA(b,y){var j=b[y+0-32],z=b[y+1-32],ie=b[y+2-32],fe=b[y+3-32],he=b[y+4-32],xe=b[y+5-32],_e=b[y+6-32],Ce=b[y+7-32];b[y+0+0]=j+z+1>>1,b[y+1+0]=b[y+0+64]=z+ie+1>>1,b[y+2+0]=b[y+1+64]=ie+fe+1>>1,b[y+3+0]=b[y+2+64]=fe+he+1>>1,b[y+0+32]=Sr(j,z,ie),b[y+1+32]=b[y+0+96]=Sr(z,ie,fe),b[y+2+32]=b[y+1+96]=Sr(ie,fe,he),b[y+3+32]=b[y+2+96]=Sr(fe,he,xe),b[y+3+64]=Sr(he,xe,_e),b[y+3+96]=Sr(xe,_e,Ce)}function fi(b,y){var j=b[y-1+0],z=b[y-1+32],ie=b[y-1+64],fe=b[y-1+96];b[y+0+0]=j+z+1>>1,b[y+2+0]=b[y+0+32]=z+ie+1>>1,b[y+2+32]=b[y+0+64]=ie+fe+1>>1,b[y+1+0]=Sr(j,z,ie),b[y+3+0]=b[y+1+32]=Sr(z,ie,fe),b[y+3+32]=b[y+1+64]=Sr(ie,fe,fe),b[y+3+64]=b[y+2+64]=b[y+0+96]=b[y+1+96]=b[y+2+96]=b[y+3+96]=fe}function AA(b,y){var j=b[y-1+0],z=b[y-1+32],ie=b[y-1+64],fe=b[y-1+96],he=b[y-1-32],xe=b[y+0-32],_e=b[y+1-32],Ce=b[y+2-32];b[y+0+0]=b[y+2+32]=j+he+1>>1,b[y+0+32]=b[y+2+64]=z+j+1>>1,b[y+0+64]=b[y+2+96]=ie+z+1>>1,b[y+0+96]=fe+ie+1>>1,b[y+3+0]=Sr(xe,_e,Ce),b[y+2+0]=Sr(he,xe,_e),b[y+1+0]=b[y+3+32]=Sr(j,he,xe),b[y+1+32]=b[y+3+64]=Sr(z,j,he),b[y+1+64]=b[y+3+96]=Sr(ie,z,j),b[y+1+96]=Sr(fe,ie,z)}function Cl(b,y){var j;for(j=0;8>j;++j)a(b,y+32*j,b,y-32,8)}function Xn(b,y){var j;for(j=0;8>j;++j)s(b,y,b[y-1],8),y+=32}function bs(b,y,j){var z;for(z=0;8>z;++z)s(y,j+32*z,b,8)}function Ps(b,y){var j,z=8;for(j=0;8>j;++j)z+=b[y+j-32]+b[y-1+32*j];bs(z>>4,b,y)}function Sl(b,y){var j,z=4;for(j=0;8>j;++j)z+=b[y+j-32];bs(z>>3,b,y)}function Ka(b,y){var j,z=4;for(j=0;8>j;++j)z+=b[y-1+32*j];bs(z>>3,b,y)}function qs(b,y){bs(128,b,y)}function Mi(b,y,j){var z=b[y-j],ie=b[y+0],fe=3*(ie-z)+Ei[1020+b[y-2*j]-b[y+j]],he=hA[112+(fe+4>>3)];b[y-j]=Qn[255+z+hA[112+(fe+3>>3)]],b[y+0]=Qn[255+ie-he]}function lo(b,y,j,z){var ie=b[y+0],fe=b[y+j];return gn[255+b[y-2*j]-b[y-j]]>z||gn[255+fe-ie]>z}function ma(b,y,j,z){return 4*gn[255+b[y-j]-b[y+0]]+gn[255+b[y-2*j]-b[y+j]]<=z}function Ni(b,y,j,z,ie){var fe=b[y-3*j],he=b[y-2*j],xe=b[y-j],_e=b[y+0],Ce=b[y+j],Oe=b[y+2*j],Xe=b[y+3*j];return 4*gn[255+xe-_e]+gn[255+he-Ce]>z?0:gn[255+b[y-4*j]-fe]<=ie&&gn[255+fe-he]<=ie&&gn[255+he-xe]<=ie&&gn[255+Xe-Oe]<=ie&&gn[255+Oe-Ce]<=ie&&gn[255+Ce-_e]<=ie}function Nl(b,y,j,z){var ie=2*z+1;for(z=0;16>z;++z)ma(b,y+z,j,ie)&&Mi(b,y+z,j)}function js(b,y,j,z){var ie=2*z+1;for(z=0;16>z;++z)ma(b,y+z*j,1,ie)&&Mi(b,y+z*j,1)}function Eo(b,y,j,z){var ie;for(ie=3;0<ie;--ie)Nl(b,y+=4*j,j,z)}function Fo(b,y,j,z){var ie;for(ie=3;0<ie;--ie)js(b,y+=4,j,z)}function vs(b,y,j,z,ie,fe,he,xe){for(fe=2*fe+1;0<ie--;){if(Ni(b,y,j,fe,he))if(lo(b,y,j,xe))Mi(b,y,j);else{var _e=b,Ce=y,Oe=j,Xe=_e[Ce-2*Oe],Be=_e[Ce-Oe],Pe=_e[Ce+0],We=_e[Ce+Oe],ot=_e[Ce+2*Oe],$e=27*(dt=Ei[1020+3*(Pe-Be)+Ei[1020+Xe-We]])+63>>7,lt=18*dt+63>>7,dt=9*dt+63>>7;_e[Ce-3*Oe]=Qn[255+_e[Ce-3*Oe]+dt],_e[Ce-2*Oe]=Qn[255+Xe+lt],_e[Ce-Oe]=Qn[255+Be+$e],_e[Ce+0]=Qn[255+Pe-$e],_e[Ce+Oe]=Qn[255+We-lt],_e[Ce+2*Oe]=Qn[255+ot-dt]}y+=z}}function Hi(b,y,j,z,ie,fe,he,xe){for(fe=2*fe+1;0<ie--;){if(Ni(b,y,j,fe,he))if(lo(b,y,j,xe))Mi(b,y,j);else{var _e=b,Ce=y,Oe=j,Xe=_e[Ce-Oe],Be=_e[Ce+0],Pe=_e[Ce+Oe],We=hA[112+(4+(ot=3*(Be-Xe))>>3)],ot=hA[112+(ot+3>>3)],$e=We+1>>1;_e[Ce-2*Oe]=Qn[255+_e[Ce-2*Oe]+$e],_e[Ce-Oe]=Qn[255+Xe+ot],_e[Ce+0]=Qn[255+Be-We],_e[Ce+Oe]=Qn[255+Pe-$e]}y+=z}}function qA(b,y,j,z,ie,fe){vs(b,y,j,1,16,z,ie,fe)}function pn(b,y,j,z,ie,fe){vs(b,y,1,j,16,z,ie,fe)}function du(b,y,j,z,ie,fe){var he;for(he=3;0<he;--he)Hi(b,y+=4*j,j,1,16,z,ie,fe)}function N(b,y,j,z,ie,fe){var he;for(he=3;0<he;--he)Hi(b,y+=4,1,j,16,z,ie,fe)}function ae(b,y,j,z,ie,fe,he,xe){vs(b,y,ie,1,8,fe,he,xe),vs(j,z,ie,1,8,fe,he,xe)}function Se(b,y,j,z,ie,fe,he,xe){vs(b,y,1,ie,8,fe,he,xe),vs(j,z,1,ie,8,fe,he,xe)}function Qe(b,y,j,z,ie,fe,he,xe){Hi(b,y+4*ie,ie,1,8,fe,he,xe),Hi(j,z+4*ie,ie,1,8,fe,he,xe)}function ze(b,y,j,z,ie,fe,he,xe){Hi(b,y+4,1,ie,8,fe,he,xe),Hi(j,z+4,1,ie,8,fe,he,xe)}function ct(){this.ba=new Kt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Zt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function wt(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Gt(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function pr(){this.ua=0,this.Wa=new Ye,this.vb=new Ye,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new H,this.yc=new G}function Ur(){this.xb=this.a=0,this.l=new st,this.ca=new Kt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new K,this.Pb=0,this.wd=new K,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new pr,this.ab=0,this.gc=o(4,Gt),this.Oc=0}function Wr(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new st,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function da(b,y,j,z,ie,fe,he){for(b=b==null?0:b[y+0],y=0;y<he;++y)ie[fe+y]=b+j[z+y]&255,b=ie[fe+y]}function Za(b,y,j,z,ie,fe,he){var xe;if(b==null)da(null,null,j,z,ie,fe,he);else for(xe=0;xe<he;++xe)ie[fe+xe]=b[y+xe]+j[z+xe]&255}function ps(b,y,j,z,ie,fe,he){if(b==null)da(null,null,j,z,ie,fe,he);else{var xe,_e=b[y+0],Ce=_e,Oe=_e;for(xe=0;xe<he;++xe)Ce=Oe+(_e=b[y+xe])-Ce,Oe=j[z+xe]+(-256&Ce?0>Ce?0:255:Ce)&255,Ce=_e,ie[fe+xe]=Oe}}function Pa(b,y,j,z){var ie=y.width,fe=y.o;if(t(b!=null&&y!=null),0>j||0>=z||j+z>fe)return null;if(!b.Cc){if(b.ga==null){var he;if(b.ga=new Wr,(he=b.ga==null)||(he=y.width*y.o,t(b.Gb.length==0),b.Gb=n(he),b.Uc=0,b.Gb==null?he=0:(b.mb=b.Gb,b.nb=b.Uc,b.rc=null,he=1),he=!he),!he){he=b.ga;var xe=b.Fa,_e=b.P,Ce=b.qc,Oe=b.mb,Xe=b.nb,Be=_e+1,Pe=Ce-1,We=he.l;if(t(xe!=null&&Oe!=null&&y!=null),pA[0]=null,pA[1]=da,pA[2]=Za,pA[3]=ps,he.ca=Oe,he.tb=Xe,he.c=y.width,he.i=y.height,t(0<he.c&&0<he.i),1>=Ce)y=0;else if(he.$a=3&xe[_e+0],he.Z=xe[_e+0]>>2&3,he.Lc=xe[_e+0]>>4&3,_e=xe[_e+0]>>6&3,0>he.$a||1<he.$a||4<=he.Z||1<he.Lc||_e)y=0;else if(We.put=Bt,We.ac=Tt,We.bc=Yt,We.ma=he,We.width=y.width,We.height=y.height,We.Da=y.Da,We.v=y.v,We.va=y.va,We.j=y.j,We.o=y.o,he.$a)e:{t(he.$a==1),y=Ne();t:for(;;){if(y==null){y=0;break e}if(t(he!=null),he.mc=y,y.c=he.c,y.i=he.i,y.l=he.l,y.l.ma=he,y.l.width=he.c,y.l.height=he.i,y.a=0,te(y.m,xe,Be,Pe),!Te(he.c,he.i,1,y,null)||(y.ab==1&&y.gc[0].hc==3&&be(y.s)?(he.ic=1,xe=y.c*y.i,y.Ta=null,y.Ua=0,y.V=n(xe),y.Ba=0,y.V==null?(y.a=1,y=0):y=1):(he.ic=0,y=Ue(y,he.c)),!y))break t;y=1;break e}he.mc=null,y=0}else y=Pe>=he.c*he.i;he=!y}if(he)return null;b.ga.Lc!=1?b.Ga=0:z=fe-j}t(b.ga!=null),t(j+z<=fe);e:{if(y=(xe=b.ga).c,fe=xe.l.o,xe.$a==0){if(Be=b.rc,Pe=b.Vc,We=b.Fa,_e=b.P+1+j*y,Ce=b.mb,Oe=b.nb+j*y,t(_e<=b.P+b.qc),xe.Z!=0)for(t(pA[xe.Z]!=null),he=0;he<z;++he)pA[xe.Z](Be,Pe,We,_e,Ce,Oe,y),Be=Ce,Pe=Oe,Oe+=y,_e+=y;else for(he=0;he<z;++he)a(Ce,Oe,We,_e,y),Be=Ce,Pe=Oe,Oe+=y,_e+=y;b.rc=Be,b.Vc=Pe}else{if(t(xe.mc!=null),y=j+z,t((he=xe.mc)!=null),t(y<=he.i),he.C>=y)y=1;else if(xe.ic||ul(),xe.ic){xe=he.V,Be=he.Ba,Pe=he.c;var ot=he.i,$e=(We=1,_e=he.$/Pe,Ce=he.$%Pe,Oe=he.m,Xe=he.s,he.$),lt=Pe*ot,dt=Pe*y,Lt=Xe.wc,bt=$e<dt?re(Xe,Ce,_e):null;t($e<=lt),t(y<=ot),t(be(Xe));t:for(;;){for(;!Oe.h&&$e<dt;){if(Ce&Lt||(bt=re(Xe,Ce,_e)),t(bt!=null),Y(Oe),256>(ot=fr(bt.G[0],bt.H[0],Oe)))xe[Be+$e]=ot,++$e,++Ce>=Pe&&(Ce=0,++_e<=y&&!(_e%16)&&O(he,_e));else{if(!(280>ot)){We=0;break t}ot=Jr(ot-256,Oe);var gr,lr=fr(bt.G[4],bt.H[4],Oe);if(Y(Oe),!($e>=(lr=jr(Pe,lr=Jr(lr,Oe)))&&lt-$e>=ot)){We=0;break t}for(gr=0;gr<ot;++gr)xe[Be+$e+gr]=xe[Be+$e+gr-lr];for($e+=ot,Ce+=ot;Ce>=Pe;)Ce-=Pe,++_e<=y&&!(_e%16)&&O(he,_e);$e<dt&&Ce&Lt&&(bt=re(Xe,Ce,_e))}t(Oe.h==q(Oe))}O(he,_e>y?y:_e);break t}!We||Oe.h&&$e<lt?(We=0,he.a=Oe.h?5:3):he.$=$e,y=We}else y=ce(he,he.V,he.Ba,he.c,he.i,y,tt);if(!y){z=0;break e}}j+z>=fe&&(b.Cc=1),z=1}if(!z)return null;if(b.Cc&&((z=b.ga)!=null&&(z.mc=null),b.ga=null,0<b.Ga))return alert("todo:WebPDequantizeLevels"),null}return b.nb+j*ie}function Ks(b,y,j,z,ie,fe){for(;0<ie--;){var he,xe=b,_e=y+(j?1:0),Ce=b,Oe=y+(j?0:3);for(he=0;he<z;++he){var Xe=Ce[Oe+4*he];Xe!=255&&(Xe*=32897,xe[_e+4*he+0]=xe[_e+4*he+0]*Xe>>23,xe[_e+4*he+1]=xe[_e+4*he+1]*Xe>>23,xe[_e+4*he+2]=xe[_e+4*he+2]*Xe>>23)}y+=fe}}function Us(b,y,j,z,ie){for(;0<z--;){var fe;for(fe=0;fe<j;++fe){var he=b[y+2*fe+0],xe=15&(Ce=b[y+2*fe+1]),_e=4369*xe,Ce=(240&Ce|Ce>>4)*_e>>16;b[y+2*fe+0]=(240&he|he>>4)*_e>>16&240|(15&he|he<<4)*_e>>16>>4&15,b[y+2*fe+1]=240&Ce|xe}y+=ie}}function Js(b,y,j,z,ie,fe,he,xe){var _e,Ce,Oe=255;for(Ce=0;Ce<ie;++Ce){for(_e=0;_e<z;++_e){var Xe=b[y+_e];fe[he+4*_e]=Xe,Oe&=Xe}y+=j,he+=xe}return Oe!=255}function El(b,y,j,z,ie){var fe;for(fe=0;fe<ie;++fe)j[z+fe]=b[y+fe]>>8}function ul(){gs=Ks,es=Us,Zs=Js,La=El}function Fl(b,y,j){U[b]=function(z,ie,fe,he,xe,_e,Ce,Oe,Xe,Be,Pe,We,ot,$e,lt,dt,Lt){var bt,gr=Lt-1>>1,lr=xe[_e+0]|Ce[Oe+0]<<16,$r=Xe[Be+0]|Pe[We+0]<<16;t(z!=null);var ur=3*lr+$r+131074>>2;for(y(z[ie+0],255&ur,ur>>16,ot,$e),fe!=null&&(ur=3*$r+lr+131074>>2,y(fe[he+0],255&ur,ur>>16,lt,dt)),bt=1;bt<=gr;++bt){var ca=xe[_e+bt]|Ce[Oe+bt]<<16,As=Xe[Be+bt]|Pe[We+bt]<<16,ea=lr+ca+$r+As+524296,or=ea+2*(ca+$r)>>3;ur=or+lr>>1,lr=(ea=ea+2*(lr+As)>>3)+ca>>1,y(z[ie+2*bt-1],255&ur,ur>>16,ot,$e+(2*bt-1)*j),y(z[ie+2*bt-0],255&lr,lr>>16,ot,$e+(2*bt-0)*j),fe!=null&&(ur=ea+$r>>1,lr=or+As>>1,y(fe[he+2*bt-1],255&ur,ur>>16,lt,dt+(2*bt-1)*j),y(fe[he+2*bt+0],255&lr,lr>>16,lt,dt+(2*bt+0)*j)),lr=ca,$r=As}1&Lt||(ur=3*lr+$r+131074>>2,y(z[ie+Lt-1],255&ur,ur>>16,ot,$e+(Lt-1)*j),fe!=null&&(ur=3*$r+lr+131074>>2,y(fe[he+Lt-1],255&ur,ur>>16,lt,dt+(Lt-1)*j)))}}function ws(){ti[Do]=Dc,ti[xr]=xu,ti[pl]=$f,ti[Ql]=gd,ti[b0]=YA,ti[pu]=Io,ti[WA]=JA,ti[v0]=xu,ti[dd]=gd,ti[gu]=YA,ti[fd]=Io}function To(b){return b&-16384?0>b?0:255:b>>md}function dl(b,y){return To((19077*b>>8)+(26149*y>>8)-14234)}function Pi(b,y,j){return To((19077*b>>8)-(6419*y>>8)-(13320*j>>8)+8708)}function cA(b,y){return To((19077*b>>8)+(33050*y>>8)-17685)}function oo(b,y,j,z,ie){z[ie+0]=dl(b,j),z[ie+1]=Pi(b,y,j),z[ie+2]=cA(b,y)}function _s(b,y,j,z,ie){z[ie+0]=cA(b,y),z[ie+1]=Pi(b,y,j),z[ie+2]=dl(b,j)}function Lo(b,y,j,z,ie){var fe=Pi(b,y,j);y=fe<<3&224|cA(b,y)>>3,z[ie+0]=248&dl(b,j)|fe>>5,z[ie+1]=y}function Ao(b,y,j,z,ie){var fe=240&cA(b,y)|15;z[ie+0]=240&dl(b,j)|Pi(b,y,j)>>4,z[ie+1]=fe}function KA(b,y,j,z,ie){z[ie+0]=255,oo(b,y,j,z,ie+1)}function fl(b,y,j,z,ie){_s(b,y,j,z,ie),z[ie+3]=255}function Yn(b,y,j,z,ie){oo(b,y,j,z,ie),z[ie+3]=255}function Tl(b,y,j){U[b]=function(z,ie,fe,he,xe,_e,Ce,Oe,Xe){for(var Be=Oe+(-2&Xe)*j;Oe!=Be;)y(z[ie+0],fe[he+0],xe[_e+0],Ce,Oe),y(z[ie+1],fe[he+0],xe[_e+0],Ce,Oe+j),ie+=2,++he,++_e,Oe+=2*j;1&Xe&&y(z[ie+0],fe[he+0],xe[_e+0],Ce,Oe)}}function jc(b,y,j){return j==0?b==0?y==0?6:5:y==0?4:0:j}function uA(b,y,j,z,ie){switch(b>>>30){case 3:pi(y,j,z,ie,0);break;case 2:Dn(y,j,z,ie);break;case 1:X(y,j,z,ie)}}function hi(b,y){var j,z,ie=y.M,fe=y.Nb,he=b.oc,xe=b.pc+40,_e=b.oc,Ce=b.pc+584,Oe=b.oc,Xe=b.pc+600;for(j=0;16>j;++j)he[xe+32*j-1]=129;for(j=0;8>j;++j)_e[Ce+32*j-1]=129,Oe[Xe+32*j-1]=129;for(0<ie?he[xe-1-32]=_e[Ce-1-32]=Oe[Xe-1-32]=129:(s(he,xe-32-1,127,21),s(_e,Ce-32-1,127,9),s(Oe,Xe-32-1,127,9)),z=0;z<b.za;++z){var Be=y.ya[y.aa+z];if(0<z){for(j=-1;16>j;++j)a(he,xe+32*j-4,he,xe+32*j+12,4);for(j=-1;8>j;++j)a(_e,Ce+32*j-4,_e,Ce+32*j+4,4),a(Oe,Xe+32*j-4,Oe,Xe+32*j+4,4)}var Pe=b.Gd,We=b.Hd+z,ot=Be.ad,$e=Be.Hc;if(0<ie&&(a(he,xe-32,Pe[We].y,0,16),a(_e,Ce-32,Pe[We].f,0,8),a(Oe,Xe-32,Pe[We].ea,0,8)),Be.Za){var lt=he,dt=xe-32+16;for(0<ie&&(z>=b.za-1?s(lt,dt,Pe[We].y[15],4):a(lt,dt,Pe[We+1].y,0,4)),j=0;4>j;j++)lt[dt+128+j]=lt[dt+256+j]=lt[dt+384+j]=lt[dt+0+j];for(j=0;16>j;++j,$e<<=2)lt=he,dt=xe+Vs[j],Is[Be.Ob[j]](lt,dt),uA($e,ot,16*+j,lt,dt)}else if(lt=jc(z,ie,Be.Ob[0]),Fi[lt](he,xe),$e!=0)for(j=0;16>j;++j,$e<<=2)uA($e,ot,16*+j,he,xe+Vs[j]);for(j=Be.Gc,lt=jc(z,ie,Be.Dd),fo[lt](_e,Ce),fo[lt](Oe,Xe),$e=ot,lt=_e,dt=Ce,255&(Be=0|j)&&(170&Be?Gi($e,256,lt,dt):Ee($e,256,lt,dt)),Be=Oe,$e=Xe,255&(j>>=8)&&(170&j?Gi(ot,320,Be,$e):Ee(ot,320,Be,$e)),ie<b.Ub-1&&(a(Pe[We].y,0,he,xe+480,16),a(Pe[We].f,0,_e,Ce+224,8),a(Pe[We].ea,0,Oe,Xe+224,8)),j=8*fe*b.B,Pe=b.sa,We=b.ta+16*z+16*fe*b.R,ot=b.qa,Be=b.ra+8*z+j,$e=b.Ha,lt=b.Ia+8*z+j,j=0;16>j;++j)a(Pe,We+j*b.R,he,xe+32*j,16);for(j=0;8>j;++j)a(ot,Be+j*b.B,_e,Ce+32*j,8),a($e,lt+j*b.B,Oe,Xe+32*j,8)}}function hl(b,y,j,z,ie,fe,he,xe,_e){var Ce=[0],Oe=[0],Xe=0,Be=_e!=null?_e.kd:0,Pe=_e??new wt;if(b==null||12>j)return 7;Pe.data=b,Pe.w=y,Pe.ha=j,y=[y],j=[j],Pe.gb=[Pe.gb];e:{var We=y,ot=j,$e=Pe.gb;if(t(b!=null),t(ot!=null),t($e!=null),$e[0]=0,12<=ot[0]&&!r(b,We[0],"RIFF")){if(r(b,We[0]+8,"WEBP")){$e=3;break e}var lt=He(b,We[0]+4);if(12>lt||4294967286<lt){$e=3;break e}if(Be&&lt>ot[0]-8){$e=7;break e}$e[0]=lt,We[0]+=12,ot[0]-=12}$e=0}if($e!=0)return $e;for(lt=0<Pe.gb[0],j=j[0];;){e:{var dt=b;ot=y,$e=j;var Lt=Ce,bt=Oe,gr=We=[0];if((ur=Xe=[Xe])[0]=0,8>$e[0])$e=7;else{if(!r(dt,ot[0],"VP8X")){if(He(dt,ot[0]+4)!=10){$e=3;break e}if(18>$e[0]){$e=7;break e}var lr=He(dt,ot[0]+8),$r=1+oe(dt,ot[0]+12);if(2147483648<=$r*(dt=1+oe(dt,ot[0]+15))){$e=3;break e}gr!=null&&(gr[0]=lr),Lt!=null&&(Lt[0]=$r),bt!=null&&(bt[0]=dt),ot[0]+=18,$e[0]-=18,ur[0]=1}$e=0}}if(Xe=Xe[0],We=We[0],$e!=0)return $e;if(ot=!!(2&We),!lt&&Xe)return 3;if(fe!=null&&(fe[0]=!!(16&We)),he!=null&&(he[0]=ot),xe!=null&&(xe[0]=0),he=Ce[0],We=Oe[0],Xe&&ot&&_e==null){$e=0;break}if(4>j){$e=7;break}if(lt&&Xe||!lt&&!Xe&&!r(b,y[0],"ALPH")){j=[j],Pe.na=[Pe.na],Pe.P=[Pe.P],Pe.Sa=[Pe.Sa];e:{lr=b,$e=y,lt=j;var ur=Pe.gb;Lt=Pe.na,bt=Pe.P,gr=Pe.Sa,$r=22,t(lr!=null),t(lt!=null),dt=$e[0];var ca=lt[0];for(t(Lt!=null),t(gr!=null),Lt[0]=null,bt[0]=null,gr[0]=0;;){if($e[0]=dt,lt[0]=ca,8>ca){$e=7;break e}var As=He(lr,dt+4);if(4294967286<As){$e=3;break e}var ea=8+As+1&-2;if($r+=ea,0<ur&&$r>ur){$e=3;break e}if(!r(lr,dt,"VP8 ")||!r(lr,dt,"VP8L")){$e=0;break e}if(ca[0]<ea){$e=7;break e}r(lr,dt,"ALPH")||(Lt[0]=lr,bt[0]=dt+8,gr[0]=As),dt+=ea,ca-=ea}}if(j=j[0],Pe.na=Pe.na[0],Pe.P=Pe.P[0],Pe.Sa=Pe.Sa[0],$e!=0)break}j=[j],Pe.Ja=[Pe.Ja],Pe.xa=[Pe.xa];e:if(ur=b,$e=y,lt=j,Lt=Pe.gb[0],bt=Pe.Ja,gr=Pe.xa,lr=$e[0],dt=!r(ur,lr,"VP8 "),$r=!r(ur,lr,"VP8L"),t(ur!=null),t(lt!=null),t(bt!=null),t(gr!=null),8>lt[0])$e=7;else{if(dt||$r){if(ur=He(ur,lr+4),12<=Lt&&ur>Lt-12){$e=3;break e}if(Be&&ur>lt[0]-8){$e=7;break e}bt[0]=ur,$e[0]+=8,lt[0]-=8,gr[0]=$r}else gr[0]=5<=lt[0]&&ur[lr+0]==47&&!(ur[lr+4]>>5),bt[0]=lt[0];$e=0}if(j=j[0],Pe.Ja=Pe.Ja[0],Pe.xa=Pe.xa[0],y=y[0],$e!=0)break;if(4294967286<Pe.Ja)return 3;if(xe==null||ot||(xe[0]=Pe.xa?2:1),he=[he],We=[We],Pe.xa){if(5>j){$e=7;break}xe=he,Be=We,ot=fe,b==null||5>j?b=0:5<=j&&b[y+0]==47&&!(b[y+4]>>5)?(lt=[0],ur=[0],Lt=[0],te(bt=new K,b,y,j),Mr(bt,lt,ur,Lt)?(xe!=null&&(xe[0]=lt[0]),Be!=null&&(Be[0]=ur[0]),ot!=null&&(ot[0]=Lt[0]),b=1):b=0):b=0}else{if(10>j){$e=7;break}xe=We,b==null||10>j||!wa(b,y+3,j-3)?b=0:(Be=b[y+0]|b[y+1]<<8|b[y+2]<<16,ot=16383&(b[y+7]<<8|b[y+6]),b=16383&(b[y+9]<<8|b[y+8]),1&Be||3<(Be>>1&7)||!(Be>>4&1)||Be>>5>=Pe.Ja||!ot||!b?b=0:(he&&(he[0]=ot),xe&&(xe[0]=b),b=1))}if(!b||(he=he[0],We=We[0],Xe&&(Ce[0]!=he||Oe[0]!=We)))return 3;_e!=null&&(_e[0]=Pe,_e.offset=y-_e.w,t(4294967286>y-_e.w),t(_e.offset==_e.ha-j));break}return $e==0||$e==7&&Xe&&_e==null?(fe!=null&&(fe[0]|=Pe.na!=null&&0<Pe.na.length),z!=null&&(z[0]=he),ie!=null&&(ie[0]=We),0):$e}function Ll(b,y,j){var z=y.width,ie=y.height,fe=0,he=0,xe=z,_e=ie;if(y.Da=b!=null&&0<b.Da,y.Da&&(xe=b.cd,_e=b.bd,fe=b.v,he=b.j,11>j||(fe&=-2,he&=-2),0>fe||0>he||0>=xe||0>=_e||fe+xe>z||he+_e>ie))return 0;if(y.v=fe,y.j=he,y.va=fe+xe,y.o=he+_e,y.U=xe,y.T=_e,y.da=b!=null&&0<b.da,y.da){if(!at(xe,_e,j=[b.ib],fe=[b.hb]))return 0;y.ib=j[0],y.hb=fe[0]}return y.ob=b!=null&&b.ob,y.Kb=b==null||!b.Sd,y.da&&(y.ob=y.ib<3*z/4&&y.hb<3*ie/4,y.Kb=0),1}function jo(b){if(b==null)return 2;if(11>b.S){var y=b.f.RGBA;y.fb+=(b.height-1)*y.A,y.A=-y.A}else y=b.f.kb,b=b.height,y.O+=(b-1)*y.fa,y.fa=-y.fa,y.N+=(b-1>>1)*y.Ab,y.Ab=-y.Ab,y.W+=(b-1>>1)*y.Db,y.Db=-y.Db,y.F!=null&&(y.J+=(b-1)*y.lb,y.lb=-y.lb);return 0}function qi(b,y,j,z){if(z==null||0>=b||0>=y)return 2;if(j!=null){if(j.Da){var ie=j.cd,fe=j.bd,he=-2&j.v,xe=-2&j.j;if(0>he||0>xe||0>=ie||0>=fe||he+ie>b||xe+fe>y)return 2;b=ie,y=fe}if(j.da){if(!at(b,y,ie=[j.ib],fe=[j.hb]))return 2;b=ie[0],y=fe[0]}}z.width=b,z.height=y;e:{var _e=z.width,Ce=z.height;if(b=z.S,0>=_e||0>=Ce||!(b>=Do&&13>b))b=2;else{if(0>=z.Rd&&z.sd==null){he=fe=ie=y=0;var Oe=(xe=_e*bd[b])*Ce;if(11>b||(fe=(Ce+1)/2*(y=(_e+1)/2),b==12&&(he=(ie=_e)*Ce)),(Ce=n(Oe+2*fe+he))==null){b=1;break e}z.sd=Ce,11>b?((_e=z.f.RGBA).eb=Ce,_e.fb=0,_e.A=xe,_e.size=Oe):((_e=z.f.kb).y=Ce,_e.O=0,_e.fa=xe,_e.Fd=Oe,_e.f=Ce,_e.N=0+Oe,_e.Ab=y,_e.Cd=fe,_e.ea=Ce,_e.W=0+Oe+fe,_e.Db=y,_e.Ed=fe,b==12&&(_e.F=Ce,_e.J=0+Oe+2*fe),_e.Tc=he,_e.lb=ie)}if(y=1,ie=z.S,fe=z.width,he=z.height,ie>=Do&&13>ie)if(11>ie)b=z.f.RGBA,y&=(xe=Math.abs(b.A))*(he-1)+fe<=b.size,y&=xe>=fe*bd[ie],y&=b.eb!=null;else{b=z.f.kb,xe=(fe+1)/2,Oe=(he+1)/2,_e=Math.abs(b.fa),Ce=Math.abs(b.Ab);var Xe=Math.abs(b.Db),Be=Math.abs(b.lb),Pe=Be*(he-1)+fe;y&=_e*(he-1)+fe<=b.Fd,y&=Ce*(Oe-1)+xe<=b.Cd,y=(y&=Xe*(Oe-1)+xe<=b.Ed)&_e>=fe&Ce>=xe&Xe>=xe,y&=b.y!=null,y&=b.f!=null,y&=b.ea!=null,ie==12&&(y&=Be>=fe,y&=Pe<=b.Tc,y&=b.F!=null)}else y=0;b=y?0:2}}return b!=0||j!=null&&j.fd&&(b=jo(z)),b}var Uo=64,Jn=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],jn=24,Ki=32,Un=8,co=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];nt("Predictor0","PredictorAdd0"),U.Predictor0=function(){return 4278190080},U.Predictor1=function(b){return b},U.Predictor2=function(b,y,j){return y[j+0]},U.Predictor3=function(b,y,j){return y[j+1]},U.Predictor4=function(b,y,j){return y[j-1]},U.Predictor5=function(b,y,j){return It(It(b,y[j+1]),y[j+0])},U.Predictor6=function(b,y,j){return It(b,y[j-1])},U.Predictor7=function(b,y,j){return It(b,y[j+0])},U.Predictor8=function(b,y,j){return It(y[j-1],y[j+0])},U.Predictor9=function(b,y,j){return It(y[j+0],y[j+1])},U.Predictor10=function(b,y,j){return It(It(b,y[j-1]),It(y[j+0],y[j+1]))},U.Predictor11=function(b,y,j){var z=y[j+0];return 0>=er(z>>24&255,b>>24&255,(y=y[j-1])>>24&255)+er(z>>16&255,b>>16&255,y>>16&255)+er(z>>8&255,b>>8&255,y>>8&255)+er(255&z,255&b,255&y)?z:b},U.Predictor12=function(b,y,j){var z=y[j+0];return(Ot((b>>24&255)+(z>>24&255)-((y=y[j-1])>>24&255))<<24|Ot((b>>16&255)+(z>>16&255)-(y>>16&255))<<16|Ot((b>>8&255)+(z>>8&255)-(y>>8&255))<<8|Ot((255&b)+(255&z)-(255&y)))>>>0},U.Predictor13=function(b,y,j){var z=y[j-1];return(sr((b=It(b,y[j+0]))>>24&255,z>>24&255)<<24|sr(b>>16&255,z>>16&255)<<16|sr(b>>8&255,z>>8&255)<<8|sr(255&b,255&z))>>>0};var zA=U.PredictorAdd0;U.PredictorAdd1=cr,nt("Predictor2","PredictorAdd2"),nt("Predictor3","PredictorAdd3"),nt("Predictor4","PredictorAdd4"),nt("Predictor5","PredictorAdd5"),nt("Predictor6","PredictorAdd6"),nt("Predictor7","PredictorAdd7"),nt("Predictor8","PredictorAdd8"),nt("Predictor9","PredictorAdd9"),nt("Predictor10","PredictorAdd10"),nt("Predictor11","PredictorAdd11"),nt("Predictor12","PredictorAdd12"),nt("Predictor13","PredictorAdd13");var dA=U.PredictorAdd2;gt("ColorIndexInverseTransform","MapARGB","32b",function(b){return b>>8&255},function(b){return b}),gt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(b){return b},function(b){return b>>8&255});var ys,fu=U.ColorIndexInverseTransform,jl=U.MapARGB,Ul=U.VP8LColorIndexInverseTransformAlpha,zs=U.MapAlpha,Dl=U.VP8LPredictorsAdd=[];Dl.length=16,(U.VP8LPredictors=[]).length=16,(U.VP8LPredictorsAdd_C=[]).length=16,(U.VP8LPredictors_C=[]).length=16;var VA,GA,zi,Ds,Vi,fA,Zn,pi,Dn,Gi,X,Ee,Ke,ft,nr,ir,Br,Or,Pr,Aa,In,Zr,qr,fa,gs,es,Zs,La,_a=n(511),Wi=n(2041),Il=n(225),uo=n(767),hu=0,Ei=Wi,hA=Il,Qn=uo,gn=_a,Do=0,xr=1,pl=2,Ql=3,b0=4,pu=5,WA=6,v0=7,dd=8,gu=9,fd=10,Ol=[2,3,7],mu=[3,3,11],Uc=[280,256,256,256,40],hd=[0,1,1,1,0],w0=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Rl=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Ml=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],$A=8,Hl=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Pl=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],gl=null,Ag=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Gf=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],pd=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],cg=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],ei=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],os=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],ha=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Fi=[],Is=[],fo=[],XA=1,Wf=2,pA=[],ti=[];Fl("UpsampleRgbLinePair",oo,3),Fl("UpsampleBgrLinePair",_s,3),Fl("UpsampleRgbaLinePair",Yn,4),Fl("UpsampleBgraLinePair",fl,4),Fl("UpsampleArgbLinePair",KA,4),Fl("UpsampleRgba4444LinePair",Ao,2),Fl("UpsampleRgb565LinePair",Lo,2);var Dc=U.UpsampleRgbLinePair,$f=U.UpsampleBgrLinePair,xu=U.UpsampleRgbaLinePair,gd=U.UpsampleBgraLinePair,YA=U.UpsampleArgbLinePair,Io=U.UpsampleRgba4444LinePair,JA=U.UpsampleRgb565LinePair,ql=16,bu=1<<ql-1,Ic=-227,ZA=482,md=6,ec=0,ri=n(256),xd=n(256),ug=n(256),Nb=n(256),Eb=n(ZA-Ic),Fb=n(ZA-Ic);Tl("YuvToRgbRow",oo,3),Tl("YuvToBgrRow",_s,3),Tl("YuvToRgbaRow",Yn,4),Tl("YuvToBgraRow",fl,4),Tl("YuvToArgbRow",KA,4),Tl("YuvToRgba4444Row",Ao,2),Tl("YuvToRgb565Row",Lo,2);var Vs=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],vu=[0,2,8],_0=[8,7,6,4,4,2,2,2,1,1,1,1],y0=1;this.WebPDecodeRGBA=function(b,y,j,z,ie){var fe=xr,he=new ct,xe=new Kt;he.ba=xe,xe.S=fe,xe.width=[xe.width],xe.height=[xe.height];var _e=xe.width,Ce=xe.height,Oe=new Ft;if(Oe==null||b==null)var Xe=2;else t(Oe!=null),Xe=hl(b,y,j,Oe.width,Oe.height,Oe.Pd,Oe.Qd,Oe.format,null);if(Xe!=0?_e=0:(_e!=null&&(_e[0]=Oe.width[0]),Ce!=null&&(Ce[0]=Oe.height[0]),_e=1),_e){xe.width=xe.width[0],xe.height=xe.height[0],z!=null&&(z[0]=xe.width),ie!=null&&(ie[0]=xe.height);e:{if(z=new st,(ie=new wt).data=b,ie.w=y,ie.ha=j,ie.kd=1,y=[0],t(ie!=null),((b=hl(ie.data,ie.w,ie.ha,null,null,null,y,null,ie))==0||b==7)&&y[0]&&(b=4),(y=b)==0){if(t(he!=null),z.data=ie.data,z.w=ie.w+ie.offset,z.ha=ie.ha-ie.offset,z.put=Bt,z.ac=Tt,z.bc=Yt,z.ma=he,ie.xa){if((b=Ne())==null){he=1;break e}if((function(Be,Pe){var We=[0],ot=[0],$e=[0];t:for(;;){if(Be==null)return 0;if(Pe==null)return Be.a=2,0;if(Be.l=Pe,Be.a=0,te(Be.m,Pe.data,Pe.w,Pe.ha),!Mr(Be.m,We,ot,$e)){Be.a=3;break t}if(Be.xb=Wf,Pe.width=We[0],Pe.height=ot[0],!Te(We[0],ot[0],1,Be,null))break t;return 1}return t(Be.a!=0),0})(b,z)){if(z=(y=qi(z.width,z.height,he.Oa,he.ba))==0){t:{z=b;r:for(;;){if(z==null){z=0;break t}if(t(z.s.yc!=null),t(z.s.Ya!=null),t(0<z.s.Wb),t((j=z.l)!=null),t((ie=j.ma)!=null),z.xb!=0){if(z.ca=ie.ba,z.tb=ie.tb,t(z.ca!=null),!Ll(ie.Oa,j,Ql)){z.a=2;break r}if(!Ue(z,j.width)||j.da)break r;if((j.da||tr(z.ca.S))&&ul(),11>z.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),z.ca.f.kb.F!=null&&ul()),z.Pb&&0<z.s.ua&&z.s.vb.X==null&&!se(z.s.vb,z.s.Wa.Xa)){z.a=1;break r}z.xb=0}if(!ce(z,z.V,z.Ba,z.c,z.i,j.o,me))break r;ie.Dc=z.Ma,z=1;break t}t(z.a!=0),z=0}z=!z}z&&(y=b.a)}else y=b.a}else{if((b=new Hr)==null){he=1;break e}if(b.Fa=ie.na,b.P=ie.P,b.qc=ie.Sa,Na(b,z)){if((y=qi(z.width,z.height,he.Oa,he.ba))==0){if(b.Aa=0,j=he.Oa,t((ie=b)!=null),j!=null){if(0<(_e=0>(_e=j.Md)?0:100<_e?255:255*_e/100)){for(Ce=Oe=0;4>Ce;++Ce)12>(Xe=ie.pb[Ce]).lc&&(Xe.ia=_e*_0[0>Xe.lc?0:Xe.lc]>>3),Oe|=Xe.ia;Oe&&(alert("todo:VP8InitRandom"),ie.ia=1)}ie.Ga=j.Id,100<ie.Ga?ie.Ga=100:0>ie.Ga&&(ie.Ga=0)}(function(Be,Pe){if(Be==null)return 0;if(Pe==null)return yr(Be,2,"NULL VP8Io parameter in VP8Decode().");if(!Be.cb&&!Na(Be,Pe))return 0;if(t(Be.cb),Pe.ac==null||Pe.ac(Pe)){Pe.ob&&(Be.L=0);var We=vu[Be.L];if(Be.L==2?(Be.yb=0,Be.zb=0):(Be.yb=Pe.v-We>>4,Be.zb=Pe.j-We>>4,0>Be.yb&&(Be.yb=0),0>Be.zb&&(Be.zb=0)),Be.Va=Pe.o+15+We>>4,Be.Hb=Pe.va+15+We>>4,Be.Hb>Be.za&&(Be.Hb=Be.za),Be.Va>Be.Ub&&(Be.Va=Be.Ub),0<Be.L){var ot=Be.ed;for(We=0;4>We;++We){var $e;if(Be.Qa.Cb){var lt=Be.Qa.Lb[We];Be.Qa.Fb||(lt+=ot.Tb)}else lt=ot.Tb;for($e=0;1>=$e;++$e){var dt=Be.gd[We][$e],Lt=lt;if(ot.Pc&&(Lt+=ot.vd[0],$e&&(Lt+=ot.od[0])),0<(Lt=0>Lt?0:63<Lt?63:Lt)){var bt=Lt;0<ot.wb&&(bt=4<ot.wb?bt>>2:bt>>1)>9-ot.wb&&(bt=9-ot.wb),1>bt&&(bt=1),dt.dd=bt,dt.tc=2*Lt+bt,dt.ld=40<=Lt?2:15<=Lt?1:0}else dt.tc=0;dt.La=$e}}}We=0}else yr(Be,6,"Frame setup failed"),We=Be.a;if(We=We==0){if(We){Be.$c=0,0<Be.Aa||(Be.Ic=y0);t:{We=Be.Ic,ot=4*(bt=Be.za);var gr=32*bt,lr=bt+1,$r=0<Be.L?bt*(0<Be.Aa?2:1):0,ur=(Be.Aa==2?2:1)*bt;if((dt=ot+832+($e=3*(16*We+vu[Be.L])/2*gr)+(lt=Be.Fa!=null&&0<Be.Fa.length?Be.Kc.c*Be.Kc.i:0))!=dt)We=0;else{if(dt>Be.Vb){if(Be.Vb=0,Be.Ec=n(dt),Be.Fc=0,Be.Ec==null){We=yr(Be,1,"no memory during frame initialization.");break t}Be.Vb=dt}dt=Be.Ec,Lt=Be.Fc,Be.Ac=dt,Be.Bc=Lt,Lt+=ot,Be.Gd=o(gr,ve),Be.Hd=0,Be.rb=o(lr+1,oa),Be.sb=1,Be.wa=$r?o($r,Qr):null,Be.Y=0,Be.D.Nb=0,Be.D.wa=Be.wa,Be.D.Y=Be.Y,0<Be.Aa&&(Be.D.Y+=bt),t(!0),Be.oc=dt,Be.pc=Lt,Lt+=832,Be.ya=o(ur,Tn),Be.aa=0,Be.D.ya=Be.ya,Be.D.aa=Be.aa,Be.Aa==2&&(Be.D.aa+=bt),Be.R=16*bt,Be.B=8*bt,bt=(gr=vu[Be.L])*Be.R,gr=gr/2*Be.B,Be.sa=dt,Be.ta=Lt+bt,Be.qa=Be.sa,Be.ra=Be.ta+16*We*Be.R+gr,Be.Ha=Be.qa,Be.Ia=Be.ra+8*We*Be.B+gr,Be.$c=0,Lt+=$e,Be.mb=lt?dt:null,Be.nb=lt?Lt:null,t(Lt+lt<=Be.Fc+Be.Vb),Lr(Be),s(Be.Ac,Be.Bc,0,ot),We=1}}if(We){if(Pe.ka=0,Pe.y=Be.sa,Pe.O=Be.ta,Pe.f=Be.qa,Pe.N=Be.ra,Pe.ea=Be.Ha,Pe.Vd=Be.Ia,Pe.fa=Be.R,Pe.Rc=Be.B,Pe.F=null,Pe.J=0,!hu){for(We=-255;255>=We;++We)_a[255+We]=0>We?-We:We;for(We=-1020;1020>=We;++We)Wi[1020+We]=-128>We?-128:127<We?127:We;for(We=-112;112>=We;++We)Il[112+We]=-16>We?-16:15<We?15:We;for(We=-255;510>=We;++We)uo[255+We]=0>We?0:255<We?255:We;hu=1}Zn=Si,pi=io,Gi=Ls,X=Bl,Ee=iA,Dn=Ln,Ke=qA,ft=pn,nr=ae,ir=Se,Br=du,Or=N,Pr=Qe,Aa=ze,In=Nl,Zr=js,qr=Eo,fa=Fo,Is[0]=HA,Is[1]=Tc,Is[2]=RA,Is[3]=MA,Is[4]=$n,Is[5]=PA,Is[6]=hn,Is[7]=oA,Is[8]=AA,Is[9]=fi,Fi[0]=cl,Fi[1]=lA,Fi[2]=OA,Fi[3]=Ri,Fi[4]=Ys,Fi[5]=No,Fi[6]=di,fo[0]=Ps,fo[1]=Lc,fo[2]=Cl,fo[3]=Xn,fo[4]=Ka,fo[5]=Sl,fo[6]=qs,We=1}else We=0}We&&(We=(function(ca,As){for(ca.M=0;ca.M<ca.Va;++ca.M){var ea,or=ca.Jc[ca.M&ca.Xb],qt=ca.m,ks=ca;for(ea=0;ea<ks.za;++ea){var Dr=qt,ra=ks,Qa=ra.Ac,mn=ra.Bc+4*ea,ai=ra.zc,ts=ra.ya[ra.aa+ea];if(ra.Qa.Bb?ts.$b=we(Dr,ra.Pa.jb[0])?2+we(Dr,ra.Pa.jb[2]):we(Dr,ra.Pa.jb[1]):ts.$b=0,ra.kc&&(ts.Ad=we(Dr,ra.Bd)),ts.Za=!we(Dr,145)+0,ts.Za){var en=ts.Ob,gi=0;for(ra=0;4>ra;++ra){var tn,ia=ai[0+ra];for(tn=0;4>tn;++tn){ia=ei[Qa[mn+tn]][ia];for(var Ba=pd[we(Dr,ia[0])];0<Ba;)Ba=pd[2*Ba+we(Dr,ia[Ba])];ia=-Ba,Qa[mn+tn]=ia}a(en,gi,Qa,mn,4),gi+=4,ai[0+ra]=ia}}else ia=we(Dr,156)?we(Dr,128)?1:3:we(Dr,163)?2:0,ts.Ob[0]=ia,s(Qa,mn,ia,4),s(ai,0,ia,4);ts.Dd=we(Dr,142)?we(Dr,114)?we(Dr,183)?1:3:2:0}if(ks.m.Ka)return yr(ca,7,"Premature end-of-partition0 encountered.");for(;ca.ja<ca.za;++ca.ja){if(ks=or,Dr=(qt=ca).rb[qt.sb-1],Qa=qt.rb[qt.sb+qt.ja],ea=qt.ya[qt.aa+qt.ja],mn=qt.kc?ea.Ad:0)Dr.la=Qa.la=0,ea.Za||(Dr.Na=Qa.Na=0),ea.Hc=0,ea.Gc=0,ea.ia=0;else{var Bs,Ea;if(Dr=Qa,Qa=ks,mn=qt.Pa.Xc,ai=qt.ya[qt.aa+qt.ja],ts=qt.pb[ai.$b],ra=ai.ad,en=0,gi=qt.rb[qt.sb-1],ia=tn=0,s(ra,en,0,384),ai.Za)var xn=0,Cs=mn[3];else{Ba=n(16);var Ca=Dr.Na+gi.Na;if(Ca=gl(Qa,mn[1],Ca,ts.Eb,0,Ba,0),Dr.Na=gi.Na=(0<Ca)+0,1<Ca)Zn(Ba,0,ra,en);else{var Gs=Ba[0]+3>>3;for(Ba=0;256>Ba;Ba+=16)ra[en+Ba]=Gs}xn=1,Cs=mn[0]}var Oa=15&Dr.la,rn=15&gi.la;for(Ba=0;4>Ba;++Ba){var an=1&rn;for(Gs=Ea=0;4>Gs;++Gs)Oa=Oa>>1|(an=(Ca=gl(Qa,Cs,Ca=an+(1&Oa),ts.Sc,xn,ra,en))>xn)<<7,Ea=Ea<<2|(3<Ca?3:1<Ca?2:ra[en+0]!=0),en+=16;Oa>>=4,rn=rn>>1|an<<7,tn=(tn<<8|Ea)>>>0}for(Cs=Oa,xn=rn>>4,Bs=0;4>Bs;Bs+=2){for(Ea=0,Oa=Dr.la>>4+Bs,rn=gi.la>>4+Bs,Ba=0;2>Ba;++Ba){for(an=1&rn,Gs=0;2>Gs;++Gs)Ca=an+(1&Oa),Oa=Oa>>1|(an=0<(Ca=gl(Qa,mn[2],Ca,ts.Qc,0,ra,en)))<<3,Ea=Ea<<2|(3<Ca?3:1<Ca?2:ra[en+0]!=0),en+=16;Oa>>=2,rn=rn>>1|an<<5}ia|=Ea<<4*Bs,Cs|=Oa<<4<<Bs,xn|=(240&rn)<<Bs}Dr.la=Cs,gi.la=xn,ai.Hc=tn,ai.Gc=ia,ai.ia=43690&ia?0:ts.ia,mn=!(tn|ia)}if(0<qt.L&&(qt.wa[qt.Y+qt.ja]=qt.gd[ea.$b][ea.Za],qt.wa[qt.Y+qt.ja].La|=!mn),ks.Ka)return yr(ca,7,"Premature end-of-file encountered.")}if(Lr(ca),qt=As,ks=1,ea=(or=ca).D,Dr=0<or.L&&or.M>=or.zb&&or.M<=or.Va,or.Aa==0)t:{if(ea.M=or.M,ea.uc=Dr,hi(or,ea),ks=1,ea=(Ea=or.D).Nb,Dr=(ia=vu[or.L])*or.R,Qa=ia/2*or.B,Ba=16*ea*or.R,Gs=8*ea*or.B,mn=or.sa,ai=or.ta-Dr+Ba,ts=or.qa,ra=or.ra-Qa+Gs,en=or.Ha,gi=or.Ia-Qa+Gs,rn=(Oa=Ea.M)==0,tn=Oa>=or.Va-1,or.Aa==2&&hi(or,Ea),Ea.uc)for(an=(Ca=or).D.M,t(Ca.D.uc),Ea=Ca.yb;Ea<Ca.Hb;++Ea){xn=Ea,Cs=an;var za=(ya=(sn=Ca).D).Nb;Bs=sn.R;var ya=ya.wa[ya.Y+xn],mi=sn.sa,Qs=sn.ta+16*za*Bs+16*xn,Nr=ya.dd,Er=ya.tc;if(Er!=0)if(t(3<=Er),sn.L==1)0<xn&&Zr(mi,Qs,Bs,Er+4),ya.La&&fa(mi,Qs,Bs,Er),0<Cs&&In(mi,Qs,Bs,Er+4),ya.La&&qr(mi,Qs,Bs,Er);else{var Sa=sn.B,$i=sn.qa,Kl=sn.ra+8*za*Sa+8*xn,Ti=sn.Ha,sn=sn.Ia+8*za*Sa+8*xn;za=ya.ld,0<xn&&(ft(mi,Qs,Bs,Er+4,Nr,za),ir($i,Kl,Ti,sn,Sa,Er+4,Nr,za)),ya.La&&(Or(mi,Qs,Bs,Er,Nr,za),Aa($i,Kl,Ti,sn,Sa,Er,Nr,za)),0<Cs&&(Ke(mi,Qs,Bs,Er+4,Nr,za),nr($i,Kl,Ti,sn,Sa,Er+4,Nr,za)),ya.La&&(Br(mi,Qs,Bs,Er,Nr,za),Pr($i,Kl,Ti,sn,Sa,Er,Nr,za))}}if(or.ia&&alert("todo:DitherRow"),qt.put!=null){if(Ea=16*Oa,Oa=16*(Oa+1),rn?(qt.y=or.sa,qt.O=or.ta+Ba,qt.f=or.qa,qt.N=or.ra+Gs,qt.ea=or.Ha,qt.W=or.Ia+Gs):(Ea-=ia,qt.y=mn,qt.O=ai,qt.f=ts,qt.N=ra,qt.ea=en,qt.W=gi),tn||(Oa-=ia),Oa>qt.o&&(Oa=qt.o),qt.F=null,qt.J=null,or.Fa!=null&&0<or.Fa.length&&Ea<Oa&&(qt.J=Pa(or,qt,Ea,Oa-Ea),qt.F=or.mb,qt.F==null&&qt.F.length==0)){ks=yr(or,3,"Could not decode alpha data.");break t}Ea<qt.j&&(ia=qt.j-Ea,Ea=qt.j,t(!(1&ia)),qt.O+=or.R*ia,qt.N+=or.B*(ia>>1),qt.W+=or.B*(ia>>1),qt.F!=null&&(qt.J+=qt.width*ia)),Ea<Oa&&(qt.O+=qt.v,qt.N+=qt.v>>1,qt.W+=qt.v>>1,qt.F!=null&&(qt.J+=qt.v),qt.ka=Ea-qt.j,qt.U=qt.va-qt.v,qt.T=Oa-Ea,ks=qt.put(qt))}ea+1!=or.Ic||tn||(a(or.sa,or.ta-Dr,mn,ai+16*or.R,Dr),a(or.qa,or.ra-Qa,ts,ra+8*or.B,Qa),a(or.Ha,or.Ia-Qa,en,gi+8*or.B,Qa))}if(!ks)return yr(ca,6,"Output aborted.")}return 1})(Be,Pe)),Pe.bc!=null&&Pe.bc(Pe),We&=1}return We?(Be.cb=0,We):0})(b,z)||(y=b.a)}}else y=b.a}y==0&&he.Oa!=null&&he.Oa.fd&&(y=jo(he.ba))}he=y}fe=he!=0?null:11>fe?xe.f.RGBA.eb:xe.f.kb.y}else fe=null;return fe};var bd=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function f(U,M){for(var T="",D=0;D<4;D++)T+=String.fromCharCode(U[M++]);return T}function h(U,M){return U[M+0]|U[M+1]<<8}function g(U,M){return(U[M+0]|U[M+1]<<8|U[M+2]<<16)>>>0}function x(U,M){return(U[M+0]|U[M+1]<<8|U[M+2]<<16|U[M+3]<<24)>>>0}new u;var m=[0],w=[0],v=[],B=new u,k=e,E=(function(U,M){var T={},D=0,G=!1,ne=0,H=0;if(T.frames=[],!(function(F,K){for(var I=0;I<4;I++)if(F[K+I]!="RIFF".charCodeAt(I))return!0;return!1})(U,M)){for(x(U,M+=4),M+=8;M<U.length;){var ee=f(U,M),le=x(U,M+=4);M+=4;var pe=le+(1&le);switch(ee){case"VP8 ":case"VP8L":T.frames[D]===void 0&&(T.frames[D]={}),(je=T.frames[D]).src_off=G?H:M-8,je.src_size=ne+le+8,D++,G&&(G=!1,ne=0,H=0);break;case"VP8X":(je=T.header={}).feature_flags=U[M];var te=M+4;je.canvas_width=1+g(U,te),te+=3,je.canvas_height=1+g(U,te),te+=3;break;case"ALPH":G=!0,ne=pe+8,H=M-8;break;case"ANIM":(je=T.header).bgcolor=x(U,M),te=M+4,je.loop_count=h(U,te),te+=2;break;case"ANMF":var Le,je;(je=T.frames[D]={}).offset_x=2*g(U,M),M+=3,je.offset_y=2*g(U,M),M+=3,je.width=1+g(U,M),M+=3,je.height=1+g(U,M),M+=3,je.duration=g(U,M),M+=3,Le=U[M++],je.dispose=1&Le,je.blend=Le>>1&1}ee!="ANMF"&&(M+=pe)}return T}})(k,0);E.response=k,E.rgbaoutput=!0,E.dataurl=!1;var S=E.header?E.header:null,L=E.frames?E.frames:null;if(S){S.loop_counter=S.loop_count,m=[S.canvas_height],w=[S.canvas_width];for(var P=0;P<L.length&&L[P].blend!=0;P++);}var R=L[0],Q=B.WebPDecodeRGBA(k,R.src_off,R.src_size,w,m);R.rgba=Q,R.imgwidth=w[0],R.imgheight=m[0];for(var V=0;V<w[0]*m[0]*4;V++)v[V]=Q[V];return this.width=w,this.height=m,this.data=v,this}function ite(){var e,t=this.internal.__metadata__.metadata,r=unescape(encodeURIComponent(t));e=this.internal.__metadata__.rawXml?r:'<x:xmpmeta xmlns:x="adobe:ns:meta/"><rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceUri+'"><jspdf:metadata>'+r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")+"</jspdf:metadata></rdf:Description></rdf:RDF></x:xmpmeta>",this.internal.__metadata__.metadataObjectNumber=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+e.length+" >>"),this.internal.write("stream"),this.internal.write(e),this.internal.write("endstream"),this.internal.write("endobj")}function lte(){this.internal.__metadata__.metadataObjectNumber&&this.internal.write("/Metadata "+this.internal.__metadata__.metadataObjectNumber+" 0 R")}(function(e){var t,r,a,s,n,o,c,u,f,h=function(F){return F=F||{},this.isStrokeTransparent=F.isStrokeTransparent||!1,this.strokeOpacity=F.strokeOpacity||1,this.strokeStyle=F.strokeStyle||"#000000",this.fillStyle=F.fillStyle||"#000000",this.isFillTransparent=F.isFillTransparent||!1,this.fillOpacity=F.fillOpacity||1,this.font=F.font||"10px sans-serif",this.textBaseline=F.textBaseline||"alphabetic",this.textAlign=F.textAlign||"left",this.lineWidth=F.lineWidth||1,this.lineJoin=F.lineJoin||"miter",this.lineCap=F.lineCap||"butt",this.path=F.path||[],this.transform=F.transform!==void 0?F.transform.clone():new u,this.globalCompositeOperation=F.globalCompositeOperation||"normal",this.globalAlpha=F.globalAlpha||1,this.clip_path=F.clip_path||[],this.currentPoint=F.currentPoint||new o,this.miterLimit=F.miterLimit||10,this.lastPoint=F.lastPoint||new o,this.lineDashOffset=F.lineDashOffset||0,this.lineDash=F.lineDash||[],this.margin=F.margin||[0,0,0,0],this.prevPageLastElemOffset=F.prevPageLastElemOffset||0,this.ignoreClearRect=typeof F.ignoreClearRect!="boolean"||F.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new g(this),t=this.internal.f2,r=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,n=this.internal.getVerticalCoordinate,o=this.internal.Point,c=this.internal.Rectangle,u=this.internal.Matrix,f=new h}]);var g=function(F){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var K=F;Object.defineProperty(this,"pdf",{get:function(){return K}});var I=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return I},set:function(se){I=!!se}});var q=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return q},set:function(se){q=!!se}});var J=0;Object.defineProperty(this,"posX",{get:function(){return J},set:function(se){isNaN(se)||(J=se)}});var Y=0;Object.defineProperty(this,"posY",{get:function(){return Y},set:function(se){isNaN(se)||(Y=se)}}),Object.defineProperty(this,"margin",{get:function(){return f.margin},set:function(se){var qe;typeof se=="number"?qe=[se,se,se,se]:((qe=new Array(4))[0]=se[0],qe[1]=se.length>=2?se[1]:qe[0],qe[2]=se.length>=3?se[2]:qe[0],qe[3]=se.length>=4?se[3]:qe[1]),f.margin=qe}});var de=!1;Object.defineProperty(this,"autoPaging",{get:function(){return de},set:function(se){de=se}});var ue=0;Object.defineProperty(this,"lastBreak",{get:function(){return ue},set:function(se){ue=se}});var we=[];Object.defineProperty(this,"pageBreaks",{get:function(){return we},set:function(se){we=se}}),Object.defineProperty(this,"ctx",{get:function(){return f},set:function(se){se instanceof h&&(f=se)}}),Object.defineProperty(this,"path",{get:function(){return f.path},set:function(se){f.path=se}});var Ie=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ie},set:function(se){Ie=se}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(se){var qe;qe=x(se),this.ctx.fillStyle=qe.style,this.ctx.isFillTransparent=qe.a===0,this.ctx.fillOpacity=qe.a,this.pdf.setFillColor(qe.r,qe.g,qe.b,{a:qe.a}),this.pdf.setTextColor(qe.r,qe.g,qe.b,{a:qe.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(se){var qe=x(se);this.ctx.strokeStyle=qe.style,this.ctx.isStrokeTransparent=qe.a===0,this.ctx.strokeOpacity=qe.a,qe.a===0?this.pdf.setDrawColor(255,255,255):(qe.a,this.pdf.setDrawColor(qe.r,qe.g,qe.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(se){["butt","round","square"].indexOf(se)!==-1&&(this.ctx.lineCap=se,this.pdf.setLineCap(se))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(se){isNaN(se)||(this.ctx.lineWidth=se,this.pdf.setLineWidth(se))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(se){["bevel","round","miter"].indexOf(se)!==-1&&(this.ctx.lineJoin=se,this.pdf.setLineJoin(se))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(se){isNaN(se)||(this.ctx.miterLimit=se,this.pdf.setMiterLimit(se))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(se){this.ctx.textBaseline=se}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(se){["right","end","center","left","start"].indexOf(se)!==-1&&(this.ctx.textAlign=se)}});var Ae=null,oe=null,He=null;Object.defineProperty(this,"fontFaces",{get:function(){return He},set:function(se){Ae=null,oe=null,He=se}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(se){var qe;if(this.ctx.font=se,(qe=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(se))!==null){var Ye=qe[1];qe[2];var at=qe[3],Ge=qe[4];qe[5];var pt=qe[6],nt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ge)[2];Ge=Math.floor(nt==="px"?parseFloat(Ge)*this.pdf.internal.scaleFactor:nt==="em"?parseFloat(Ge)*this.pdf.getFontSize():parseFloat(Ge)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ge);var Dt=(function(gt){var dr,Ht,Rt=[],$t=gt.trim();if($t==="")return ew;if($t in lS)return[lS[$t]];for(;$t!=="";){switch(Ht=null,dr=($t=AS($t)).charAt(0)){case'"':case"'":Ht=ete($t.substring(1),dr);break;default:Ht=tte($t)}if(Ht===null||(Rt.push(Ht[0]),($t=AS(Ht[1]))!==""&&$t.charAt(0)!==","))return ew;$t=$t.replace(/^,/,"")}return Rt})(pt);if(this.fontFaces){var It=(function(gt,dr){var Ht=gt.getFontList(),Rt=JSON.stringify(Ht);if(Ae===null||oe!==Rt){var $t=(function(vr){var vt=[];return Object.keys(vr).forEach(function(kr){vr[kr].forEach(function(tr){var rr=null;switch(tr){case"bold":rr={family:kr,weight:"bold"};break;case"italic":rr={family:kr,style:"italic"};break;case"bolditalic":rr={family:kr,weight:"bold",style:"italic"};break;case"":case"normal":rr={family:kr}}rr!==null&&(rr.ref={name:kr,style:tr},vt.push(rr))})}),vt})(Ht);Ae=(function(vr){for(var vt={},kr=0;kr<vr.length;++kr){var tr=Zv(vr[kr]),rr=tr.family,Xt=tr.stretch,Kt=tr.style,Ft=tr.weight;vt[rr]=vt[rr]||{},vt[rr][Xt]=vt[rr][Xt]||{},vt[rr][Xt][Kt]=vt[rr][Xt][Kt]||{},vt[rr][Xt][Kt][Ft]=tr}return vt})($t.concat(dr)),oe=Rt}return Ae})(this.pdf,this.fontFaces),Ot=Dt.map(function(gt){return{family:gt,stretch:"normal",weight:at,style:Ye}}),sr=(function(gt,dr,Ht){for(var Rt=(Ht=Ht||{}).defaultFontFamily||"times",$t=Object.assign({},Zee,Ht.genericFontFamilies||{}),vr=null,vt=null,kr=0;kr<dr.length;++kr)if($t[(vr=Zv(dr[kr])).family]&&(vr.family=$t[vr.family]),gt.hasOwnProperty(vr.family)){vt=gt[vr.family];break}if(!(vt=vt||gt[Rt]))throw new Error("Could not find a font-family for the rule '"+oS(vr)+"' and default family '"+Rt+"'.");if(vt=(function(tr,rr){if(rr[tr])return rr[tr];var Xt=h2[tr],Kt=Xt<=h2.normal?-1:1,Ft=iS(rr,$T,Xt,Kt);if(!Ft)throw new Error("Could not find a matching font-stretch value for "+tr);return Ft})(vr.stretch,vt),vt=(function(tr,rr){if(rr[tr])return rr[tr];for(var Xt=WT[tr],Kt=0;Kt<Xt.length;++Kt)if(rr[Xt[Kt]])return rr[Xt[Kt]];throw new Error("Could not find a matching font-style for "+tr)})(vr.style,vt),!(vt=(function(tr,rr){if(rr[tr])return rr[tr];if(tr===400&&rr[500])return rr[500];if(tr===500&&rr[400])return rr[400];var Xt=Jee[tr],Kt=iS(rr,XT,Xt,tr<400?-1:1);if(!Kt)throw new Error("Could not find a matching font-weight for value "+tr);return Kt})(vr.weight,vt)))throw new Error("Failed to resolve a font for the rule '"+oS(vr)+"'.");return vt})(It,Ot);this.pdf.setFont(sr.ref.name,sr.ref.style)}else{var er="";(at==="bold"||parseInt(at,10)>=700||Ye==="bold")&&(er="bold"),Ye==="italic"&&(er+="italic"),er.length===0&&(er="normal");for(var cr="",Vt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},mt=0;mt<Dt.length;mt++){if(this.pdf.internal.getFont(Dt[mt],er,{noFallback:!0,disableWarning:!0})!==void 0){cr=Dt[mt];break}if(er==="bolditalic"&&this.pdf.internal.getFont(Dt[mt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)cr=Dt[mt],er="bold";else if(this.pdf.internal.getFont(Dt[mt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){cr=Dt[mt],er="normal";break}}if(cr===""){for(var Nt=0;Nt<Dt.length;Nt++)if(Vt[Dt[Nt]]){cr=Vt[Dt[Nt]];break}}cr=cr===""?"Times":cr,this.pdf.setFont(cr,er)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(se){this.ctx.globalCompositeOperation=se}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(se){this.ctx.globalAlpha=se}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(se){this.ctx.lineDashOffset=se,je.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(se){this.ctx.lineDash=se,je.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(se){this.ctx.ignoreClearRect=!!se}})};g.prototype.setLineDash=function(F){this.lineDash=F},g.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},g.prototype.fill=function(){L.call(this,"fill",!1)},g.prototype.stroke=function(){L.call(this,"stroke",!1)},g.prototype.beginPath=function(){this.path=[{type:"begin"}]},g.prototype.moveTo=function(F,K){if(isNaN(F)||isNaN(K))throw us.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var I=this.ctx.transform.applyToPoint(new o(F,K));this.path.push({type:"mt",x:I.x,y:I.y}),this.ctx.lastPoint=new o(F,K)},g.prototype.closePath=function(){var F=new o(0,0),K=0;for(K=this.path.length-1;K!==-1;K--)if(this.path[K].type==="begin"&&Ya(this.path[K+1])==="object"&&typeof this.path[K+1].x=="number"){F=new o(this.path[K+1].x,this.path[K+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(F.x,F.y)},g.prototype.lineTo=function(F,K){if(isNaN(F)||isNaN(K))throw us.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var I=this.ctx.transform.applyToPoint(new o(F,K));this.path.push({type:"lt",x:I.x,y:I.y}),this.ctx.lastPoint=new o(I.x,I.y)},g.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),L.call(this,null,!0)},g.prototype.quadraticCurveTo=function(F,K,I,q){if(isNaN(I)||isNaN(q)||isNaN(F)||isNaN(K))throw us.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var J=this.ctx.transform.applyToPoint(new o(I,q)),Y=this.ctx.transform.applyToPoint(new o(F,K));this.path.push({type:"qct",x1:Y.x,y1:Y.y,x:J.x,y:J.y}),this.ctx.lastPoint=new o(J.x,J.y)},g.prototype.bezierCurveTo=function(F,K,I,q,J,Y){if(isNaN(J)||isNaN(Y)||isNaN(F)||isNaN(K)||isNaN(I)||isNaN(q))throw us.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var de=this.ctx.transform.applyToPoint(new o(J,Y)),ue=this.ctx.transform.applyToPoint(new o(F,K)),we=this.ctx.transform.applyToPoint(new o(I,q));this.path.push({type:"bct",x1:ue.x,y1:ue.y,x2:we.x,y2:we.y,x:de.x,y:de.y}),this.ctx.lastPoint=new o(de.x,de.y)},g.prototype.arc=function(F,K,I,q,J,Y){if(isNaN(F)||isNaN(K)||isNaN(I)||isNaN(q)||isNaN(J))throw us.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(Y=!!Y,!this.ctx.transform.isIdentity){var de=this.ctx.transform.applyToPoint(new o(F,K));F=de.x,K=de.y;var ue=this.ctx.transform.applyToPoint(new o(0,I)),we=this.ctx.transform.applyToPoint(new o(0,0));I=Math.sqrt(Math.pow(ue.x-we.x,2)+Math.pow(ue.y-we.y,2))}Math.abs(J-q)>=2*Math.PI&&(q=0,J=2*Math.PI),this.path.push({type:"arc",x:F,y:K,radius:I,startAngle:q,endAngle:J,counterclockwise:Y})},g.prototype.arcTo=function(F,K,I,q,J){throw new Error("arcTo not implemented.")},g.prototype.rect=function(F,K,I,q){if(isNaN(F)||isNaN(K)||isNaN(I)||isNaN(q))throw us.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(F,K),this.lineTo(F+I,K),this.lineTo(F+I,K+q),this.lineTo(F,K+q),this.lineTo(F,K),this.lineTo(F+I,K),this.lineTo(F,K)},g.prototype.fillRect=function(F,K,I,q){if(isNaN(F)||isNaN(K)||isNaN(I)||isNaN(q))throw us.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!m.call(this)){var J={};this.lineCap!=="butt"&&(J.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(J.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(F,K,I,q),this.fill(),J.hasOwnProperty("lineCap")&&(this.lineCap=J.lineCap),J.hasOwnProperty("lineJoin")&&(this.lineJoin=J.lineJoin)}},g.prototype.strokeRect=function(F,K,I,q){if(isNaN(F)||isNaN(K)||isNaN(I)||isNaN(q))throw us.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");w.call(this)||(this.beginPath(),this.rect(F,K,I,q),this.stroke())},g.prototype.clearRect=function(F,K,I,q){if(isNaN(F)||isNaN(K)||isNaN(I)||isNaN(q))throw us.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(F,K,I,q))},g.prototype.save=function(F){F=typeof F!="boolean"||F;for(var K=this.pdf.internal.getCurrentPageInfo().pageNumber,I=0;I<this.pdf.internal.getNumberOfPages();I++)this.pdf.setPage(I+1),this.pdf.internal.out("q");if(this.pdf.setPage(K),F){this.ctx.fontSize=this.pdf.internal.getFontSize();var q=new h(this.ctx);this.ctxStack.push(this.ctx),this.ctx=q}},g.prototype.restore=function(F){F=typeof F!="boolean"||F;for(var K=this.pdf.internal.getCurrentPageInfo().pageNumber,I=0;I<this.pdf.internal.getNumberOfPages();I++)this.pdf.setPage(I+1),this.pdf.internal.out("Q");this.pdf.setPage(K),F&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},g.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var x=function(F){var K,I,q,J;if(F.isCanvasGradient===!0&&(F=F.getColor()),!F)return{r:0,g:0,b:0,a:0,style:F};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(F))K=0,I=0,q=0,J=0;else{var Y=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(F);if(Y!==null)K=parseInt(Y[1]),I=parseInt(Y[2]),q=parseInt(Y[3]),J=1;else if((Y=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(F))!==null)K=parseInt(Y[1]),I=parseInt(Y[2]),q=parseInt(Y[3]),J=parseFloat(Y[4]);else{if(J=1,typeof F=="string"&&F.charAt(0)!=="#"){var de=new HT(F);F=de.ok?de.toHex():"#000000"}F.length===4?(K=F.substring(1,2),K+=K,I=F.substring(2,3),I+=I,q=F.substring(3,4),q+=q):(K=F.substring(1,3),I=F.substring(3,5),q=F.substring(5,7)),K=parseInt(K,16),I=parseInt(I,16),q=parseInt(q,16)}}return{r:K,g:I,b:q,a:J,style:F}},m=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},w=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};g.prototype.fillText=function(F,K,I,q){if(isNaN(K)||isNaN(I)||typeof F!="string")throw us.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(q=isNaN(q)?void 0:q,!m.call(this)){var J=pe(this.ctx.transform.rotation),Y=this.ctx.transform.scaleX;D.call(this,{text:F,x:K,y:I,scale:Y,angle:J,align:this.textAlign,maxWidth:q})}},g.prototype.strokeText=function(F,K,I,q){if(isNaN(K)||isNaN(I)||typeof F!="string")throw us.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!w.call(this)){q=isNaN(q)?void 0:q;var J=pe(this.ctx.transform.rotation),Y=this.ctx.transform.scaleX;D.call(this,{text:F,x:K,y:I,scale:Y,renderingMode:"stroke",angle:J,align:this.textAlign,maxWidth:q})}},g.prototype.measureText=function(F){if(typeof F!="string")throw us.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var K=this.pdf,I=this.pdf.internal.scaleFactor,q=K.internal.getFontSize(),J=K.getStringUnitWidth(F)*q/K.internal.scaleFactor;return new function(Y){var de=(Y=Y||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return de}}),this}({width:J*=Math.round(96*I/72*1e4)/1e4})},g.prototype.scale=function(F,K){if(isNaN(F)||isNaN(K))throw us.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var I=new u(F,0,0,K,0,0);this.ctx.transform=this.ctx.transform.multiply(I)},g.prototype.rotate=function(F){if(isNaN(F))throw us.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var K=new u(Math.cos(F),Math.sin(F),-Math.sin(F),Math.cos(F),0,0);this.ctx.transform=this.ctx.transform.multiply(K)},g.prototype.translate=function(F,K){if(isNaN(F)||isNaN(K))throw us.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var I=new u(1,0,0,1,F,K);this.ctx.transform=this.ctx.transform.multiply(I)},g.prototype.transform=function(F,K,I,q,J,Y){if(isNaN(F)||isNaN(K)||isNaN(I)||isNaN(q)||isNaN(J)||isNaN(Y))throw us.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var de=new u(F,K,I,q,J,Y);this.ctx.transform=this.ctx.transform.multiply(de)},g.prototype.setTransform=function(F,K,I,q,J,Y){F=isNaN(F)?1:F,K=isNaN(K)?0:K,I=isNaN(I)?0:I,q=isNaN(q)?1:q,J=isNaN(J)?0:J,Y=isNaN(Y)?0:Y,this.ctx.transform=new u(F,K,I,q,J,Y)};var v=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};g.prototype.drawImage=function(F,K,I,q,J,Y,de,ue,we){var Ie=this.pdf.getImageProperties(F),Ae=1,oe=1,He=1,se=1;q!==void 0&&ue!==void 0&&(He=ue/q,se=we/J,Ae=Ie.width/q*ue/q,oe=Ie.height/J*we/J),Y===void 0&&(Y=K,de=I,K=0,I=0),q!==void 0&&ue===void 0&&(ue=q,we=J),q===void 0&&ue===void 0&&(ue=Ie.width,we=Ie.height);var qe=this.ctx.transform.decompose(),Ye=pe(qe.rotate.shx),at=new u,Ge=(at=(at=(at=at.multiply(qe.translate)).multiply(qe.skew)).multiply(qe.scale)).applyToRectangle(new c(Y-K*He,de-I*se,q*Ae,J*oe));if(this.autoPaging){for(var pt,nt=B.call(this,Ge),Dt=[],It=0;It<nt.length;It+=1)Dt.indexOf(nt[It])===-1&&Dt.push(nt[It]);S(Dt);for(var Ot=Dt[0],sr=Dt[Dt.length-1],er=Ot;er<sr+1;er++){this.pdf.setPage(er);var cr=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Vt=er===1?this.posY+this.margin[0]:this.margin[0],mt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Nt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],gt=er===1?0:mt+(er-2)*Nt;if(this.ctx.clip_path.length!==0){var dr=this.path;pt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=E(pt,this.posX+this.margin[3],-gt+Vt+this.ctx.prevPageLastElemOffset),P.call(this,"fill",!0),this.path=dr}var Ht=JSON.parse(JSON.stringify(Ge));Ht=E([Ht],this.posX+this.margin[3],-gt+Vt+this.ctx.prevPageLastElemOffset)[0];var Rt=(er>Ot||er<sr)&&v.call(this);Rt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],cr,Nt,null).clip().discardPath()),this.pdf.addImage(F,"JPEG",Ht.x,Ht.y,Ht.w,Ht.h,null,null,Ye),Rt&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(F,"JPEG",Ge.x,Ge.y,Ge.w,Ge.h,null,null,Ye)};var B=function(F,K,I){var q=[];K=K||this.pdf.internal.pageSize.width,I=I||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var J=this.posY+this.ctx.prevPageLastElemOffset;switch(F.type){default:case"mt":case"lt":q.push(Math.floor((F.y+J)/I)+1);break;case"arc":q.push(Math.floor((F.y+J-F.radius)/I)+1),q.push(Math.floor((F.y+J+F.radius)/I)+1);break;case"qct":var Y=te(this.ctx.lastPoint.x,this.ctx.lastPoint.y,F.x1,F.y1,F.x,F.y);q.push(Math.floor((Y.y+J)/I)+1),q.push(Math.floor((Y.y+Y.h+J)/I)+1);break;case"bct":var de=Le(this.ctx.lastPoint.x,this.ctx.lastPoint.y,F.x1,F.y1,F.x2,F.y2,F.x,F.y);q.push(Math.floor((de.y+J)/I)+1),q.push(Math.floor((de.y+de.h+J)/I)+1);break;case"rect":q.push(Math.floor((F.y+J)/I)+1),q.push(Math.floor((F.y+F.h+J)/I)+1)}for(var ue=0;ue<q.length;ue+=1)for(;this.pdf.internal.getNumberOfPages()<q[ue];)k.call(this);return q},k=function(){var F=this.fillStyle,K=this.strokeStyle,I=this.font,q=this.lineCap,J=this.lineWidth,Y=this.lineJoin;this.pdf.addPage(),this.fillStyle=F,this.strokeStyle=K,this.font=I,this.lineCap=q,this.lineWidth=J,this.lineJoin=Y},E=function(F,K,I){for(var q=0;q<F.length;q++)switch(F[q].type){case"bct":F[q].x2+=K,F[q].y2+=I;case"qct":F[q].x1+=K,F[q].y1+=I;default:F[q].x+=K,F[q].y+=I}return F},S=function(F){return F.sort(function(K,I){return K-I})},L=function(F,K){var I=this.fillStyle,q=this.strokeStyle,J=this.lineCap,Y=this.lineWidth,de=Math.abs(Y*this.ctx.transform.scaleX),ue=this.lineJoin;if(this.autoPaging){for(var we,Ie,Ae=JSON.parse(JSON.stringify(this.path)),oe=JSON.parse(JSON.stringify(this.path)),He=[],se=0;se<oe.length;se++)if(oe[se].x!==void 0)for(var qe=B.call(this,oe[se]),Ye=0;Ye<qe.length;Ye+=1)He.indexOf(qe[Ye])===-1&&He.push(qe[Ye]);for(var at=0;at<He.length;at++)for(;this.pdf.internal.getNumberOfPages()<He[at];)k.call(this);S(He);for(var Ge=He[0],pt=He[He.length-1],nt=Ge;nt<pt+1;nt++){this.pdf.setPage(nt),this.fillStyle=I,this.strokeStyle=q,this.lineCap=J,this.lineWidth=de,this.lineJoin=ue;var Dt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],It=nt===1?this.posY+this.margin[0]:this.margin[0],Ot=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],sr=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],er=nt===1?0:Ot+(nt-2)*sr;if(this.ctx.clip_path.length!==0){var cr=this.path;we=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=E(we,this.posX+this.margin[3],-er+It+this.ctx.prevPageLastElemOffset),P.call(this,F,!0),this.path=cr}if(Ie=JSON.parse(JSON.stringify(Ae)),this.path=E(Ie,this.posX+this.margin[3],-er+It+this.ctx.prevPageLastElemOffset),K===!1||nt===0){var Vt=(nt>Ge||nt<pt)&&v.call(this);Vt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Dt,sr,null).clip().discardPath()),P.call(this,F,K),Vt&&this.pdf.restoreGraphicsState()}this.lineWidth=Y}this.path=Ae}else this.lineWidth=de,P.call(this,F,K),this.lineWidth=Y},P=function(F,K){if((F!=="stroke"||K||!w.call(this))&&(F==="stroke"||K||!m.call(this))){for(var I,q,J=[],Y=this.path,de=0;de<Y.length;de++){var ue=Y[de];switch(ue.type){case"begin":J.push({begin:!0});break;case"close":J.push({close:!0});break;case"mt":J.push({start:ue,deltas:[],abs:[]});break;case"lt":var we=J.length;if(Y[de-1]&&!isNaN(Y[de-1].x)&&(I=[ue.x-Y[de-1].x,ue.y-Y[de-1].y],we>0)){for(;we>=0;we--)if(J[we-1].close!==!0&&J[we-1].begin!==!0){J[we-1].deltas.push(I),J[we-1].abs.push(ue);break}}break;case"bct":I=[ue.x1-Y[de-1].x,ue.y1-Y[de-1].y,ue.x2-Y[de-1].x,ue.y2-Y[de-1].y,ue.x-Y[de-1].x,ue.y-Y[de-1].y],J[J.length-1].deltas.push(I);break;case"qct":var Ie=Y[de-1].x+2/3*(ue.x1-Y[de-1].x),Ae=Y[de-1].y+2/3*(ue.y1-Y[de-1].y),oe=ue.x+2/3*(ue.x1-ue.x),He=ue.y+2/3*(ue.y1-ue.y),se=ue.x,qe=ue.y;I=[Ie-Y[de-1].x,Ae-Y[de-1].y,oe-Y[de-1].x,He-Y[de-1].y,se-Y[de-1].x,qe-Y[de-1].y],J[J.length-1].deltas.push(I);break;case"arc":J.push({deltas:[],abs:[],arc:!0}),Array.isArray(J[J.length-1].abs)&&J[J.length-1].abs.push(ue)}}q=K?null:F==="stroke"?"stroke":"fill";for(var Ye=!1,at=0;at<J.length;at++)if(J[at].arc)for(var Ge=J[at].abs,pt=0;pt<Ge.length;pt++){var nt=Ge[pt];nt.type==="arc"?V.call(this,nt.x,nt.y,nt.radius,nt.startAngle,nt.endAngle,nt.counterclockwise,void 0,K,!Ye):G.call(this,nt.x,nt.y),Ye=!0}else if(J[at].close===!0)this.pdf.internal.out("h"),Ye=!1;else if(J[at].begin!==!0){var Dt=J[at].start.x,It=J[at].start.y;ne.call(this,J[at].deltas,Dt,It),Ye=!0}q&&U.call(this,q),K&&M.call(this)}},R=function(F){var K=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,I=K*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return F-I;case"top":return F+K-I;case"hanging":return F+K-2*I;case"middle":return F+K/2-I;default:return F}},Q=function(F){return F+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};g.prototype.createLinearGradient=function(){var F=function(){};return F.colorStops=[],F.addColorStop=function(K,I){this.colorStops.push([K,I])},F.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},F.isCanvasGradient=!0,F},g.prototype.createPattern=function(){return this.createLinearGradient()},g.prototype.createRadialGradient=function(){return this.createLinearGradient()};var V=function(F,K,I,q,J,Y,de,ue,we){for(var Ie=ee.call(this,I,q,J,Y),Ae=0;Ae<Ie.length;Ae++){var oe=Ie[Ae];Ae===0&&(we?T.call(this,oe.x1+F,oe.y1+K):G.call(this,oe.x1+F,oe.y1+K)),H.call(this,F,K,oe.x2,oe.y2,oe.x3,oe.y3,oe.x4,oe.y4)}ue?M.call(this):U.call(this,de)},U=function(F){switch(F){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},M=function(){this.pdf.clip(),this.pdf.discardPath()},T=function(F,K){this.pdf.internal.out(r(F)+" "+a(K)+" m")},D=function(F){var K;switch(F.align){case"right":case"end":K="right";break;case"center":K="center";break;default:K="left"}var I,q,J,Y=this.pdf.getTextDimensions(F.text),de=R.call(this,F.y),ue=Q.call(this,de)-Y.h,we=this.ctx.transform.applyToPoint(new o(F.x,de));if(this.autoPaging){var Ie=this.ctx.transform.decompose(),Ae=new u;Ae=(Ae=(Ae=Ae.multiply(Ie.translate)).multiply(Ie.skew)).multiply(Ie.scale);for(var oe=this.ctx.transform.applyToRectangle(new c(F.x,de,Y.w,Y.h)),He=Ae.applyToRectangle(new c(F.x,ue,Y.w,Y.h)),se=B.call(this,He),qe=[],Ye=0;Ye<se.length;Ye+=1)qe.indexOf(se[Ye])===-1&&qe.push(se[Ye]);S(qe);for(var at=qe[0],Ge=qe[qe.length-1],pt=at;pt<Ge+1;pt++){this.pdf.setPage(pt);var nt=pt===1?this.posY+this.margin[0]:this.margin[0],Dt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],It=this.pdf.internal.pageSize.height-this.margin[2],Ot=It-this.margin[0],sr=this.pdf.internal.pageSize.width-this.margin[1],er=sr-this.margin[3],cr=pt===1?0:Dt+(pt-2)*Ot;if(this.ctx.clip_path.length!==0){var Vt=this.path;I=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=E(I,this.posX+this.margin[3],-1*cr+nt),P.call(this,"fill",!0),this.path=Vt}var mt=E([JSON.parse(JSON.stringify(He))],this.posX+this.margin[3],-cr+nt+this.ctx.prevPageLastElemOffset)[0];F.scale>=.01&&(q=this.pdf.internal.getFontSize(),this.pdf.setFontSize(q*F.scale),J=this.lineWidth,this.lineWidth=J*F.scale);var Nt=this.autoPaging!=="text";if(Nt||mt.y+mt.h<=It){if(Nt||mt.y>=nt&&mt.x<=sr){var gt=Nt?F.text:this.pdf.splitTextToSize(F.text,F.maxWidth||sr-mt.x)[0],dr=E([JSON.parse(JSON.stringify(oe))],this.posX+this.margin[3],-cr+nt+this.ctx.prevPageLastElemOffset)[0],Ht=Nt&&(pt>at||pt<Ge)&&v.call(this);Ht&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],er,Ot,null).clip().discardPath()),this.pdf.text(gt,dr.x,dr.y,{angle:F.angle,align:K,renderingMode:F.renderingMode}),Ht&&this.pdf.restoreGraphicsState()}}else mt.y<It&&(this.ctx.prevPageLastElemOffset+=It-mt.y);F.scale>=.01&&(this.pdf.setFontSize(q),this.lineWidth=J)}}else F.scale>=.01&&(q=this.pdf.internal.getFontSize(),this.pdf.setFontSize(q*F.scale),J=this.lineWidth,this.lineWidth=J*F.scale),this.pdf.text(F.text,we.x+this.posX,we.y+this.posY,{angle:F.angle,align:K,renderingMode:F.renderingMode,maxWidth:F.maxWidth}),F.scale>=.01&&(this.pdf.setFontSize(q),this.lineWidth=J)},G=function(F,K,I,q){I=I||0,q=q||0,this.pdf.internal.out(r(F+I)+" "+a(K+q)+" l")},ne=function(F,K,I){return this.pdf.lines(F,K,I,null,null)},H=function(F,K,I,q,J,Y,de,ue){this.pdf.internal.out([t(s(I+F)),t(n(q+K)),t(s(J+F)),t(n(Y+K)),t(s(de+F)),t(n(ue+K)),"c"].join(" "))},ee=function(F,K,I,q){for(var J=2*Math.PI,Y=Math.PI/2;K>I;)K-=J;var de=Math.abs(I-K);de<J&&q&&(de=J-de);for(var ue=[],we=q?-1:1,Ie=K;de>1e-5;){var Ae=Ie+we*Math.min(de,Y);ue.push(le.call(this,F,Ie,Ae)),de-=Math.abs(Ae-Ie),Ie=Ae}return ue},le=function(F,K,I){var q=(I-K)/2,J=F*Math.cos(q),Y=F*Math.sin(q),de=J,ue=-Y,we=de*de+ue*ue,Ie=we+de*J+ue*Y,Ae=4/3*(Math.sqrt(2*we*Ie)-Ie)/(de*Y-ue*J),oe=de-Ae*ue,He=ue+Ae*de,se=oe,qe=-He,Ye=q+K,at=Math.cos(Ye),Ge=Math.sin(Ye);return{x1:F*Math.cos(K),y1:F*Math.sin(K),x2:oe*at-He*Ge,y2:oe*Ge+He*at,x3:se*at-qe*Ge,y3:se*Ge+qe*at,x4:F*Math.cos(I),y4:F*Math.sin(I)}},pe=function(F){return 180*F/Math.PI},te=function(F,K,I,q,J,Y){var de=F+.5*(I-F),ue=K+.5*(q-K),we=J+.5*(I-J),Ie=Y+.5*(q-Y),Ae=Math.min(F,J,de,we),oe=Math.max(F,J,de,we),He=Math.min(K,Y,ue,Ie),se=Math.max(K,Y,ue,Ie);return new c(Ae,He,oe-Ae,se-He)},Le=function(F,K,I,q,J,Y,de,ue){var we,Ie,Ae,oe,He,se,qe,Ye,at,Ge,pt,nt,Dt,It,Ot=I-F,sr=q-K,er=J-I,cr=Y-q,Vt=de-J,mt=ue-Y;for(Ie=0;Ie<41;Ie++)at=(qe=(Ae=F+(we=Ie/40)*Ot)+we*((He=I+we*er)-Ae))+we*(He+we*(J+we*Vt-He)-qe),Ge=(Ye=(oe=K+we*sr)+we*((se=q+we*cr)-oe))+we*(se+we*(Y+we*mt-se)-Ye),Ie==0?(pt=at,nt=Ge,Dt=at,It=Ge):(pt=Math.min(pt,at),nt=Math.min(nt,Ge),Dt=Math.max(Dt,at),It=Math.max(It,Ge));return new c(Math.round(pt),Math.round(nt),Math.round(Dt-pt),Math.round(It-nt))},je=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var F,K,I=(F=this.ctx.lineDash,K=this.ctx.lineDashOffset,JSON.stringify({lineDash:F,lineDashOffset:K}));this.prevLineDash!==I&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=I)}}})(_r.API),(function(e){var t=function(o){var c,u,f,h,g,x,m,w,v,B;for(u=[],f=0,h=(o+=c="\0\0\0\0".slice(o.length%4||4)).length;h>f;f+=4)(g=(o.charCodeAt(f)<<24)+(o.charCodeAt(f+1)<<16)+(o.charCodeAt(f+2)<<8)+o.charCodeAt(f+3))!==0?(x=(g=((g=((g=((g=(g-(B=g%85))/85)-(v=g%85))/85)-(w=g%85))/85)-(m=g%85))/85)%85,u.push(x+33,m+33,w+33,v+33,B+33)):u.push(122);return(function(k,E){for(var S=E;S>0;S--)k.pop()})(u,c.length),String.fromCharCode.apply(String,u)+"~>"},r=function(o){var c,u,f,h,g,x=String,m="length",w=255,v="charCodeAt",B="slice",k="replace";for(o[B](-2),o=o[B](0,-2)[k](/\s/g,"")[k]("z","!!!!!"),f=[],h=0,g=(o+=c="uuuuu"[B](o[m]%5||5))[m];g>h;h+=5)u=52200625*(o[v](h)-33)+614125*(o[v](h+1)-33)+7225*(o[v](h+2)-33)+85*(o[v](h+3)-33)+(o[v](h+4)-33),f.push(w&u>>24,w&u>>16,w&u>>8,w&u);return(function(E,S){for(var L=S;L>0;L--)E.pop()})(f,c[m]),x.fromCharCode.apply(x,f)},a=function(o){return o.split("").map(function(c){return("0"+c.charCodeAt().toString(16)).slice(-2)}).join("")+">"},s=function(o){var c=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),c.test(o)===!1)return"";for(var u="",f=0;f<o.length;f+=2)u+=String.fromCharCode("0x"+(o[f]+o[f+1]));return u},n=function(o){for(var c=new Uint8Array(o.length),u=o.length;u--;)c[u]=o.charCodeAt(u);return(c=l2(c)).reduce(function(f,h){return f+String.fromCharCode(h)},"")};e.processDataByFilters=function(o,c){var u=0,f=o||"",h=[];for(typeof(c=c||[])=="string"&&(c=[c]),u=0;u<c.length;u+=1)switch(c[u]){case"ASCII85Decode":case"/ASCII85Decode":f=r(f),h.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":f=t(f),h.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":f=s(f),h.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":f=a(f),h.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":f=n(f),h.push("/FlateDecode");break;default:throw new Error('The filter: "'+c[u]+'" is not implemented')}return{data:f,reverseChain:h.reverse().join(" ")}}})(_r.API),(function(e){e.loadFile=function(t,r,a){return(function(s,n,o){n=n!==!1,o=typeof o=="function"?o:function(){};var c=void 0;try{c=(function(u,f,h){var g=new XMLHttpRequest,x=0,m=function(w){var v=w.length,B=[],k=String.fromCharCode;for(x=0;x<v;x+=1)B.push(k(255&w.charCodeAt(x)));return B.join("")};if(g.open("GET",u,!f),g.overrideMimeType("text/plain; charset=x-user-defined"),f===!1&&(g.onload=function(){g.status===200?h(m(this.responseText)):h(void 0)}),g.send(null),f&&g.status===200)return m(g.responseText)})(s,n,o)}catch{}return c})(t,r,a)},e.allowFsRead=void 0,e.loadImageFile=e.loadFile})(_r.API),(function(e){function t(){return(Xr.html2canvas?Promise.resolve(Xr.html2canvas):BA(()=>Promise.resolve().then(()=>LJ),void 0)).catch(function(c){return Promise.reject(new Error("Could not load html2canvas: "+c))}).then(function(c){return c.default?c.default:c})}function r(){return(Xr.DOMPurify?Promise.resolve(Xr.DOMPurify):BA(()=>import("./purify.es-Bzr520pe.js"),[])).catch(function(c){return Promise.reject(new Error("Could not load dompurify: "+c))}).then(function(c){return c.default?c.default:c})}var a=function(c){var u=Ya(c);return u==="undefined"?"undefined":u==="string"||c instanceof String?"string":u==="number"||c instanceof Number?"number":u==="function"||c instanceof Function?"function":c&&c.constructor===Array?"array":c&&c.nodeType===1?"element":u==="object"?"object":"unknown"},s=function(c,u){var f=document.createElement(c);for(var h in u.className&&(f.className=u.className),u.innerHTML&&u.dompurify&&(f.innerHTML=u.dompurify.sanitize(u.innerHTML)),u.style)f.style[h]=u.style[h];return f},n=function c(u,f){for(var h=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),g=u.firstChild;g;g=g.nextSibling)f!==!0&&g.nodeType===1&&g.nodeName==="SCRIPT"||h.appendChild(c(g,f));return u.nodeType===1&&(u.nodeName==="CANVAS"?(h.width=u.width,h.height=u.height,h.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(h.value=u.value),h.addEventListener("load",function(){h.scrollTop=u.scrollTop,h.scrollLeft=u.scrollLeft},!0)),h},o=function c(u){var f=Object.assign(c.convert(Promise.resolve()),JSON.parse(JSON.stringify(c.template))),h=c.convert(Promise.resolve(),f);return(h=h.setProgress(1,c,1,[c])).set(u)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(c,u){return c.__proto__=u||o.prototype,c},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(c,u){return this.then(function(){switch(u=u||(function(f){switch(a(f)){case"string":return"string";case"element":return f.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(c),u){case"string":return this.then(r).then(function(f){return this.set({src:s("div",{innerHTML:c,dompurify:f})})});case"element":return this.set({src:c});case"canvas":return this.set({canvas:c});case"img":return this.set({img:c});default:return this.error("Unknown source type.")}})},o.prototype.to=function(c){switch(c){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var c={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},u=n(this.prop.src,this.opt.html2canvas.javascriptEnabled);u.tagName==="BODY"&&(c.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:c}),this.prop.container.appendChild(u),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var c=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(c).then(t).then(function(u){var f=Object.assign({},this.opt.html2canvas);return delete f.onrendered,u(this.prop.container,f)}).then(function(u){(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var c=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(c).then(t).then(function(u){var f=this.opt.jsPDF,h=this.opt.fontFaces,g=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,x=Object.assign({async:!0,allowTaint:!0,scale:g,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete x.onrendered,f.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,f.context2d.posX=this.opt.x,f.context2d.posY=this.opt.y,f.context2d.margin=this.opt.margin,f.context2d.fontFaces=h,h)for(var m=0;m<h.length;++m){var w=h[m],v=w.src.find(function(B){return B.format==="truetype"});v&&f.addFont(v.url,w.ref.name,w.ref.style)}return x.windowHeight=x.windowHeight||0,x.windowHeight=x.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):x.windowHeight,f.context2d.save(!0),u(this.prop.container,x)}).then(function(u){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var c=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=c})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(c,u,f){return(f=f||"pdf").toLowerCase()==="img"||f.toLowerCase()==="image"?this.outputImg(c,u):this.outputPdf(c,u)},o.prototype.outputPdf=function(c,u){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(c,u)})},o.prototype.outputImg=function(c){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(c){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+c+'" is not supported.'}})},o.prototype.save=function(c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(c?{filename:c}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(c){if(a(c)!=="object")return this;var u=Object.keys(c||{}).map(function(f){if(f in o.template.prop)return function(){this.prop[f]=c[f]};switch(f){case"margin":return this.setMargin.bind(this,c.margin);case"jsPDF":return function(){return this.opt.jsPDF=c.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,c.pageSize);default:return function(){this.opt[f]=c[f]}}},this);return this.then(function(){return this.thenList(u)})},o.prototype.get=function(c,u){return this.then(function(){var f=c in o.template.prop?this.prop[c]:this.opt[c];return u?u(f):f})},o.prototype.setMargin=function(c){return this.then(function(){switch(a(c)){case"number":c=[c,c,c,c];case"array":if(c.length===2&&(c=[c[0],c[1],c[0],c[1]]),c.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=c}).then(this.setPageSize)},o.prototype.setPageSize=function(c){function u(f,h){return Math.floor(f*h/72*96)}return this.then(function(){(c=c||_r.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(c.inner={width:c.width-this.opt.margin[1]-this.opt.margin[3],height:c.height-this.opt.margin[0]-this.opt.margin[2]},c.inner.px={width:u(c.inner.width,c.k),height:u(c.inner.height,c.k)},c.inner.ratio=c.inner.height/c.inner.width),this.prop.pageSize=c})},o.prototype.setProgress=function(c,u,f,h){return c!=null&&(this.progress.val=c),u!=null&&(this.progress.state=u),f!=null&&(this.progress.n=f),h!=null&&(this.progress.stack=h),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(c,u,f,h){return this.setProgress(c?this.progress.val+c:null,u||null,f?this.progress.n+f:null,h?this.progress.stack.concat(h):null)},o.prototype.then=function(c,u){var f=this;return this.thenCore(c,u,function(h,g){return f.updateProgress(null,null,1,[h]),Promise.prototype.then.call(this,function(x){return f.updateProgress(null,h),x}).then(h,g).then(function(x){return f.updateProgress(1),x})})},o.prototype.thenCore=function(c,u,f){f=f||Promise.prototype.then;var h=this;c&&(c=c.bind(h)),u&&(u=u.bind(h));var g=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?h:o.convert(Object.assign({},h),Promise.prototype),x=f.call(g,c,u);return o.convert(x,h.__proto__)},o.prototype.thenExternal=function(c,u){return Promise.prototype.then.call(this,c,u)},o.prototype.thenList=function(c){var u=this;return c.forEach(function(f){u=u.thenCore(f)}),u},o.prototype.catch=function(c){c&&(c=c.bind(this));var u=Promise.prototype.catch.call(this,c);return o.convert(u,this)},o.prototype.catchExternal=function(c){return Promise.prototype.catch.call(this,c)},o.prototype.error=function(c){return this.then(function(){throw new Error(c)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,_r.getPageSize=function(c,u,f){if(Ya(c)==="object"){var h=c;c=h.orientation,u=h.unit||u,f=h.format||f}u=u||"mm",f=f||"a4",c=(""+(c||"P")).toLowerCase();var g,x=(""+f).toLowerCase(),m={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(u){case"pt":g=1;break;case"mm":g=72/25.4;break;case"cm":g=72/2.54;break;case"in":g=72;break;case"px":g=.75;break;case"pc":case"em":g=12;break;case"ex":g=6;break;default:throw"Invalid unit: "+u}var w,v=0,B=0;if(m.hasOwnProperty(x))v=m[x][1]/g,B=m[x][0]/g;else try{v=f[1],B=f[0]}catch{throw new Error("Invalid format: "+f)}if(c==="p"||c==="portrait")c="p",B>v&&(w=B,B=v,v=w);else{if(c!=="l"&&c!=="landscape")throw"Invalid orientation: "+c;c="l",v>B&&(w=B,B=v,v=w)}return{width:B,height:v,unit:u,k:g,orientation:c}},e.html=function(c,u){(u=u||{}).callback=u.callback||function(){},u.html2canvas=u.html2canvas||{},u.html2canvas.canvas=u.html2canvas.canvas||this.canvas,u.jsPDF=u.jsPDF||this,u.fontFaces=u.fontFaces?u.fontFaces.map(Zv):null;var f=new o(u);return u.worker?f:f.from(c).doCallback()}})(_r.API),_r.API.addJS=function(e){var t,r,a=e;return this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(t+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),r=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+a+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){t!==void 0&&r!==void 0&&this.internal.out("/Names <</JavaScript "+t+" 0 R>>")}),this},(function(e){var t;e.events.push(["postPutResources",function(){var r=this,a=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=r.outline.render().split(/\r\n/),n=0;n<s.length;n++){var o=s[n],c=a.exec(o);if(c!=null){var u=c[1];r.internal.newObjectDeferredBegin(u,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var f=this.internal.pages.length,h=[];for(n=0;n<f;n++){var g=r.internal.newObject();h.push(g);var x=r.internal.getPageInfo(n+1);r.internal.write("<< /D["+x.objId+" 0 R /XYZ null null null]>> endobj")}var m=r.internal.newObject();for(r.internal.write("<< /Names [ "),n=0;n<h.length;n++)r.internal.write("(page_"+(n+1)+")"+h[n]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+m+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(a,s,n){var o={title:s,options:n,children:[]};return a==null&&(a=this.root),a.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(a){a.id=r.internal.newObjectDeferred();for(var s=0;s<a.children.length;s++)this.genIds_r(a.children[s])},r.outline.renderRoot=function(a){this.objStart(a),this.line("/Type /Outlines"),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1]))),this.line("/Count "+this.count_r({count:0},a)),this.objEnd()},r.outline.renderItems=function(a){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,n=0;n<a.children.length;n++){var o=a.children[n];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(a)),n>0&&this.line("/Prev "+this.makeRef(a.children[n-1])),n<a.children.length-1&&this.line("/Next "+this.makeRef(a.children[n+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var c=this.count=this.count_r({count:0},o);if(c>0&&this.line("/Count "+c),o.options&&o.options.pageNumber){var u=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+u.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var f=0;f<a.children.length;f++)this.renderItems(a.children[f])},r.outline.line=function(a){this.ctx.val+=a+`\r
`},r.outline.makeRef=function(a){return a.id+" 0 R"},r.outline.makeString=function(a){return"("+r.internal.pdfEscape(a)+")"},r.outline.objStart=function(a){this.ctx.val+=`\r
`+a.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(a,s){for(var n=0;n<s.children.length;n++)a.count++,this.count_r(a,s.children[n]);return a.count}}])})(_r.API),(function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,a,s,n,o,c){var u,f=this.decode.DCT_DECODE,h=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,u=(function(g){for(var x,m=256*g.charCodeAt(4)+g.charCodeAt(5),w=g.length,v={width:0,height:0,numcomponents:1},B=4;B<w;B+=2){if(B+=m,t.indexOf(g.charCodeAt(B+1))!==-1){x=256*g.charCodeAt(B+5)+g.charCodeAt(B+6),v={width:256*g.charCodeAt(B+7)+g.charCodeAt(B+8),height:x,numcomponents:g.charCodeAt(B+9)};break}m=256*g.charCodeAt(B+2)+g.charCodeAt(B+3)}return v})(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),u.numcomponents){case 1:c=this.color_spaces.DEVICE_GRAY;break;case 4:c=this.color_spaces.DEVICE_CMYK;break;case 3:c=this.color_spaces.DEVICE_RGB}h={data:r,width:u.width,height:u.height,colorSpace:c,bitsPerComponent:8,filter:f,index:a,alias:s}}return h}})(_r.API),_r.API.processPNG=function(e,t,r,a){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var s,n=Oee(e,{checkCrc:!0}),o=n.width,c=n.height,u=n.channels,f=n.palette,h=n.depth;s=f&&u===1?(function(V){for(var U=V.width,M=V.height,T=V.data,D=V.palette,G=V.depth,ne=!1,H=[],ee=[],le=void 0,pe=!1,te=0,Le=0;Le<D.length;Le++){var je=pC(D[Le],4),F=je[0],K=je[1],I=je[2],q=je[3];H.push(F,K,I),q!=null&&(q===0?(te++,ee.length<1&&ee.push(Le)):q<255&&(pe=!0))}if(pe||te>1){ne=!0,ee=void 0;var J=U*M;le=new Uint8Array(J);for(var Y=new DataView(T.buffer),de=0;de<J;de++){var ue=tw(Y,de,G),we=pC(D[ue],4)[3];le[de]=we}}else te===0&&(ee=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:ne?8:void 0,colorBytes:T,alphaBytes:le,needSMask:ne,palette:H,mask:ee}})(n):u===2||u===4?(function(V){for(var U=V.data,M=V.width,T=V.height,D=V.channels,G=V.depth,ne=D===2?"DeviceGray":"DeviceRGB",H=D-1,ee=M*T,le=H,pe=ee*le,te=1*ee,Le=Math.ceil(pe*G/8),je=Math.ceil(te*G/8),F=new Uint8Array(Le),K=new Uint8Array(je),I=new DataView(U.buffer),q=new DataView(F.buffer),J=new DataView(K.buffer),Y=!1,de=0;de<ee;de++){for(var ue=de*D,we=0;we<le;we++)xS(q,tw(I,ue+we,G),de*le+we,G);var Ie=tw(I,ue+le,G);Ie<(1<<G)-1&&(Y=!0),xS(J,Ie,1*de,G)}return{colorSpace:ne,colorsPerPixel:H,sMaskBitsPerComponent:Y?G:void 0,colorBytes:F,alphaBytes:K,needSMask:Y}})(n):(function(V){var U=V.data,M=V.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:M,colorsPerPixel:M==="DeviceGray"?1:3,colorBytes:U instanceof Uint16Array?(function(T){for(var D=T.length,G=new Uint8Array(2*D),ne=new DataView(G.buffer,G.byteOffset,G.byteLength),H=0;H<D;H++)ne.setUint16(2*H,T[H],!1);return G})(U):U,needSMask:!1}})(n);var g,x,m,w=s,v=w.colorSpace,B=w.colorsPerPixel,k=w.sMaskBitsPerComponent,E=w.colorBytes,S=w.alphaBytes,L=w.needSMask,P=w.palette,R=w.mask,Q=null;return a!==_r.API.image_compression.NONE&&typeof l2=="function"?(Q=(function(V){var U;switch(V){case _r.API.image_compression.FAST:U=11;break;case _r.API.image_compression.MEDIUM:U=13;break;case _r.API.image_compression.SLOW:U=14;break;default:U=12}return U})(a),g=this.decode.FLATE_DECODE,x="/Predictor ".concat(Q," /Colors ").concat(B," /BitsPerComponent ").concat(h," /Columns ").concat(o),e=fS(E,Math.ceil(o*B*h/8),B,h,a),L&&(m=fS(S,Math.ceil(o*k/8),1,k,a))):(g=void 0,x=void 0,e=E,L&&(m=S)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(m&&this.__addimage__.isArrayBuffer(m)||this.__addimage__.isArrayBufferView(m))&&(m=this.__addimage__.arrayBufferToBinaryString(m)),{alias:r,data:e,index:t,filter:g,decodeParameters:x,transparency:R,palette:P,sMask:m,predictor:Q,width:o,height:c,bitsPerComponent:h,sMaskBitsPerComponent:k,colorSpace:v}}},(function(e){e.processGIF89A=function(t,r,a,s){var n=new nte(t),o=n.width,c=n.height,u=[];n.decodeAndBlitFrameRGBA(0,u);var f={data:u,width:o,height:c},h=new rw(100).encode(f,100);return e.processJPEG.call(this,h,r,a,s)},e.processGIF87A=e.processGIF89A})(_r.API),yA.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:s,green:a,blue:r,quad:n}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},yA.prototype.parseBGR=function(){this.pos=this.offset;var e="bit"+this.bitPP,t=this.width*this.height*4;if(t>536870912)throw new Error("Image dimensions exceed 512MB, which is too large.");this.data=new Uint8Array(t);try{this[e]()}catch(r){us.log("bit decode error:"+r)}},yA.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var a=this.bottom_up?e:this.height-1-e,s=0;s<t;s++)for(var n=this.datav.getUint8(this.pos++,!0),o=a*this.width*4+8*s*4,c=0;c<8&&8*s+c<this.width;c++){var u=this.palette[n>>7-c&1];this.data[o+4*c]=u.blue,this.data[o+4*c+1]=u.green,this.data[o+4*c+2]=u.red,this.data[o+4*c+3]=255}r!==0&&(this.pos+=4-r)}},yA.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,s=0;s<e;s++){var n=this.datav.getUint8(this.pos++,!0),o=a*this.width*4+2*s*4,c=n>>4,u=15&n,f=this.palette[c];if(this.data[o]=f.blue,this.data[o+1]=f.green,this.data[o+2]=f.red,this.data[o+3]=255,2*s+1>=this.width)break;f=this.palette[u],this.data[o+4]=f.blue,this.data[o+4+1]=f.green,this.data[o+4+2]=f.red,this.data[o+4+3]=255}t!==0&&(this.pos+=4-t)}},yA.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,a=0;a<this.width;a++){var s=this.datav.getUint8(this.pos++,!0),n=r*this.width*4+4*a;if(s<this.palette.length){var o=this.palette[s];this.data[n]=o.red,this.data[n+1]=o.green,this.data[n+2]=o.blue,this.data[n+3]=255}else this.data[n]=255,this.data[n+1]=255,this.data[n+2]=255,this.data[n+3]=255}e!==0&&(this.pos+=4-e)}},yA.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var n=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(n&t)/t*255|0,c=(n>>5&t)/t*255|0,u=(n>>10&t)/t*255|0,f=n>>15?255:0,h=a*this.width*4+4*s;this.data[h]=u,this.data[h+1]=c,this.data[h+2]=o,this.data[h+3]=f}this.pos+=e}},yA.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),a=this.height-1;a>=0;a--){for(var s=this.bottom_up?a:this.height-1-a,n=0;n<this.width;n++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var c=(o&t)/t*255|0,u=(o>>5&r)/r*255|0,f=(o>>11)/t*255|0,h=s*this.width*4+4*n;this.data[h]=f,this.data[h+1]=u,this.data[h+2]=c,this.data[h+3]=255}this.pos+=e}},yA.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=n,this.data[o+1]=s,this.data[o+2]=a,this.data[o+3]=255}this.pos+=this.width%4}},yA.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),c=t*this.width*4+4*r;this.data[c]=n,this.data[c+1]=s,this.data[c+2]=a,this.data[c+3]=o}},yA.prototype.getData=function(){return this.data},(function(e){e.processBMP=function(t,r,a,s){var n=new yA(t,!1),o=n.width,c=n.height,u={data:n.getData(),width:o,height:c},f=new rw(100).encode(u,100);return e.processJPEG.call(this,f,r,a,s)}})(_r.API),vS.prototype.getData=function(){return this.data},(function(e){e.processWEBP=function(t,r,a,s){var n=new vS(t),o=n.width,c=n.height,u={data:n.getData(),width:o,height:c},f=new rw(100).encode(u,100);return e.processJPEG.call(this,f,r,a,s)}})(_r.API),_r.API.processRGBA=function(e,t,r){for(var a=e.data,s=a.length,n=new Uint8Array(s/4*3),o=new Uint8Array(s/4),c=0,u=0,f=0;f<s;f+=4){var h=a[f],g=a[f+1],x=a[f+2],m=a[f+3];n[c++]=h,n[c++]=g,n[c++]=x,o[u++]=m}var w=this.__addimage__.arrayBufferToBinaryString(n);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:w,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},_r.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},rf=_r.API,Pm=rf.getCharWidthsArray=function(e,t){var r,a,s=(t=t||{}).font||this.internal.getFont(),n=t.fontSize||this.internal.getFontSize(),o=t.charSpace||this.internal.getCharSpace(),c=t.widths?t.widths:s.metadata.Unicode.widths,u=c.fof?c.fof:1,f=t.kerning?t.kerning:s.metadata.Unicode.kerning,h=f.fof?f.fof:1,g=t.doKerning!==!1,x=0,m=e.length,w=0,v=c[0]||u,B=[];for(r=0;r<m;r++)a=e.charCodeAt(r),typeof s.metadata.widthOfString=="function"?B.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(a))+o*(1e3/n)||0)/1e3):(x=g&&Ya(f[a])==="object"&&!isNaN(parseInt(f[a][w],10))?f[a][w]/h:0,B.push((c[a]||v)/u+x)),w=a;return B},cS=rf.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),a=t.font||this.internal.getFont(),s=t.charSpace||this.internal.getCharSpace();return rf.processArabic&&(e=rf.processArabic(e)),typeof a.metadata.widthOfString=="function"?a.metadata.widthOfString(e,r,s)/r:Pm.apply(this,arguments).reduce(function(n,o){return n+o},0)},uS=function(e,t,r,a){for(var s=[],n=0,o=e.length,c=0;n!==o&&c+t[n]<r;)c+=t[n],n++;s.push(e.slice(0,n));var u=n;for(c=0;n!==o;)c+t[n]>a&&(s.push(e.slice(u,n)),c=0,u=n),c+=t[n],n++;return u!==n&&s.push(e.slice(u,n)),s},dS=function(e,t,r){r||(r={});var a,s,n,o,c,u,f,h=[],g=[h],x=r.textIndent||0,m=0,w=0,v=e.split(" "),B=Pm.apply(this,[" ",r])[0];if(u=r.lineIndent===-1?v[0].length+2:r.lineIndent||0){var k=Array(u).join(" "),E=[];v.map(function(L){(L=L.split(/\s*\n/)).length>1?E=E.concat(L.map(function(P,R){return(R&&P.length?`
`:"")+P})):E.push(L[0])}),v=E,u=cS.apply(this,[k,r])}for(n=0,o=v.length;n<o;n++){var S=0;if(a=v[n],u&&a[0]==`
`&&(a=a.substr(1),S=1),x+m+(w=(s=Pm.apply(this,[a,r])).reduce(function(L,P){return L+P},0))>t||S){if(w>t){for(c=uS.apply(this,[a,s,t-(x+m),t]),h.push(c.shift()),h=[c.pop()];c.length;)g.push([c.shift()]);w=s.slice(a.length-(h[0]?h[0].length:0)).reduce(function(L,P){return L+P},0)}else h=[a];g.push(h),x=w+u,m=B}else h.push(a),x+=m+w,m=B}return f=u?function(L,P){return(P?k:"")+L.join(" ")}:function(L){return L.join(" ")},g.map(f)},rf.splitTextToSize=function(e,t,r){var a,s=(r=r||{}).fontSize||this.internal.getFontSize(),n=(function(h){if(h.widths&&h.kerning)return{widths:h.widths,kerning:h.kerning};var g=this.internal.getFont(h.fontName,h.fontStyle),x="Unicode";return g.metadata[x]?{widths:g.metadata[x].widths||{0:1},kerning:g.metadata[x].kerning||{}}:{font:g.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);a=Array.isArray(e)?e:String(e).split(/\r?\n/);var o=1*this.internal.scaleFactor*t/s;n.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/s:0,n.lineIndent=r.lineIndent;var c,u,f=[];for(c=0,u=a.length;c<u;c++)f=f.concat(dS.apply(this,[a[c],o,n]));return f},(function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",a={},s={},n=0;n<16;n++)a[r[n]]=t[n],s[t[n]]=r[n];var o=function(x){return"0x"+parseInt(x,10).toString(16)},c=e.__fontmetrics__.compress=function(x){var m,w,v,B,k=["{"];for(var E in x){if(m=x[E],isNaN(parseInt(E,10))?w="'"+E+"'":(E=parseInt(E,10),w=(w=o(E).slice(2)).slice(0,-1)+s[w.slice(-1)]),typeof m=="number")m<0?(v=o(m).slice(3),B="-"):(v=o(m).slice(2),B=""),v=B+v.slice(0,-1)+s[v.slice(-1)];else{if(Ya(m)!=="object")throw new Error("Don't know what to do with value type "+Ya(m)+".");v=c(m)}k.push(w+v)}return k.push("}"),k.join("")},u=e.__fontmetrics__.uncompress=function(x){if(typeof x!="string")throw new Error("Invalid argument passed to uncompress.");for(var m,w,v,B,k={},E=1,S=k,L=[],P="",R="",Q=x.length-1,V=1;V<Q;V+=1)(B=x[V])=="'"?m?(v=m.join(""),m=void 0):m=[]:m?m.push(B):B=="{"?(L.push([S,v]),S={},v=void 0):B=="}"?((w=L.pop())[0][w[1]]=S,v=void 0,S=w[0]):B=="-"?E=-1:v===void 0?a.hasOwnProperty(B)?(P+=a[B],v=parseInt(P,16)*E,E=1,P=""):P+=B:a.hasOwnProperty(B)?(R+=a[B],S[v]=parseInt(R,16)*E,E=1,v=void 0,R=""):R+=B;return k},f={codePages:["WinAnsiEncoding"],WinAnsiEncoding:u("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},h={Unicode:{Courier:f,"Courier-Bold":f,"Courier-BoldOblique":f,"Courier-Oblique":f,Helvetica:f,"Helvetica-Bold":f,"Helvetica-BoldOblique":f,"Helvetica-Oblique":f,"Times-Roman":f,"Times-Bold":f,"Times-BoldItalic":f,"Times-Italic":f}},g={Unicode:{"Courier-Oblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":u("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":u("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:u("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:u("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":u("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":u("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(x){var m=x.font,w=g.Unicode[m.postScriptName];w&&(m.metadata.Unicode={},m.metadata.Unicode.widths=w.widths,m.metadata.Unicode.kerning=w.kerning);var v=h.Unicode[m.postScriptName];v&&(m.metadata.Unicode.encoding=v,m.encoding=v.codePages[0])}])})(_r.API),(function(e){var t=function(r){for(var a=r.length,s=new Uint8Array(a),n=0;n<a;n++)s[n]=r.charCodeAt(n);return s};e.API.events.push(["addFont",function(r){var a=void 0,s=r.font,n=r.instance;if(!s.isStandardFont){if(n===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(a=n.existsFileInVFS(s.postScriptName)===!1?n.loadFile(s.postScriptName):n.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(o,c){c=/^\x00\x01\x00\x00/.test(c)?t(c):t(Zm(c)),o.metadata=e.API.TTFFont.open(c),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(s,a)}}])})(_r),_r.API.addSvgAsImage=function(e,t,r,a,s,n,o,c){if(isNaN(t)||isNaN(r))throw us.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(a)||isNaN(s))throw us.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=a,u.height=s;var f=u.getContext("2d");f.fillStyle="#fff",f.fillRect(0,0,u.width,u.height);var h={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},g=this;return(Xr.canvg?Promise.resolve(Xr.canvg):BA(()=>import("./index.es-PUVmI-lO.js"),__vite__mapDeps([0,1,2,3,4]))).catch(function(x){return Promise.reject(new Error("Could not load canvg: "+x))}).then(function(x){return x.default?x.default:x}).then(function(x){return x.fromString(f,e,h)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(x){return x.render(h)}).then(function(){g.addImage(u.toDataURL("image/jpeg",1),t,r,a,s,o,c)})},_r.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var a=1;a<=this.internal.getNumberOfPages();a++)for(var s=0;s<this.internal.pages[a].length;s++)this.internal.pages[a][s]=this.internal.pages[a][s].replace(t,r);return this},_r.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var a,s,n,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},c=Object.keys(o),u=[],f=0,h=0,g=0;function x(w,v){var B,k=!1;for(B=0;B<w.length;B+=1)w[B]===v&&(k=!0);return k}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var m=c.length;for(g=0;g<m;g+=1)r[c[g]].value=r[c[g]].defaultValue,r[c[g]].explicitSet=!1}if(Ya(e)==="object"){for(s in e)if(n=e[s],x(c,s)&&n!==void 0){if(r[s].type==="boolean"&&typeof n=="boolean")r[s].value=n;else if(r[s].type==="name"&&x(r[s].valueSet,n))r[s].value=n;else if(r[s].type==="integer"&&Number.isInteger(n))r[s].value=n;else if(r[s].type==="array"){for(f=0;f<n.length;f+=1)if(a=!0,n[f].length===1&&typeof n[f][0]=="number")u.push(String(n[f]-1));else if(n[f].length>1){for(h=0;h<n[f].length;h+=1)typeof n[f][h]!="number"&&(a=!1);a===!0&&u.push([n[f][0]-1,n[f][1]-1].join(" "))}r[s].value="["+u.join(" ")+"]"}else r[s].value=r[s].defaultValue;r[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var w,v=[];for(w in r)r[w].explicitSet===!0&&(r[w].type==="name"?v.push("/"+w+" /"+r[w].value):v.push("/"+w+" "+r[w].value));v.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+v.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},_r.API.addMetadata=function(e,t){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:e,namespaceUri:t??"http://jspdf.default.namespaceuri/",rawXml:typeof t=="boolean"&&t},this.internal.events.subscribe("putCatalog",lte),this.internal.events.subscribe("postPutResources",ite)),this},(function(e){var t=e.API,r=t.pdfEscape16=function(n,o){for(var c,u=o.metadata.Unicode.widths,f=["","0","00","000","0000"],h=[""],g=0,x=n.length;g<x;++g){if(c=o.metadata.characterToGlyph(n.charCodeAt(g)),o.metadata.glyIdsUsed.push(c),o.metadata.toUnicode[c]=n.charCodeAt(g),u.indexOf(c)==-1&&(u.push(c),u.push([parseInt(o.metadata.widthOfGlyph(c),10)])),c=="0")return h.join("");c=c.toString(16),h.push(f[4-c.length],c)}return h.join("")},a=function(n){var o,c,u,f,h,g,x;for(h=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,u=[],g=0,x=(c=Object.keys(n).sort(function(m,w){return m-w})).length;g<x;g++)o=c[g],u.length>=100&&(h+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar`,u=[]),n[o]!==void 0&&n[o]!==null&&typeof n[o].toString=="function"&&(f=("0000"+n[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),u.push("<"+o+"><"+f+">"));return u.length&&(h+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar
`),h+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(n){(function(o){var c=o.font,u=o.out,f=o.newObject,h=o.putStream;if(c.metadata instanceof e.API.TTFFont&&c.encoding==="Identity-H"){for(var g=c.metadata.Unicode.widths,x=c.metadata.subset.encode(c.metadata.glyIdsUsed,1),m="",w=0;w<x.length;w++)m+=String.fromCharCode(x[w]);var v=f();h({data:m,addLength1:!0,objectId:v}),u("endobj");var B=f();h({data:a(c.metadata.toUnicode),addLength1:!0,objectId:B}),u("endobj");var k=f();u("<<"),u("/Type /FontDescriptor"),u("/FontName /"+df(c.fontName)),u("/FontFile2 "+v+" 0 R"),u("/FontBBox "+e.API.PDFObject.convert(c.metadata.bbox)),u("/Flags "+c.metadata.flags),u("/StemV "+c.metadata.stemV),u("/ItalicAngle "+c.metadata.italicAngle),u("/Ascent "+c.metadata.ascender),u("/Descent "+c.metadata.decender),u("/CapHeight "+c.metadata.capHeight),u(">>"),u("endobj");var E=f();u("<<"),u("/Type /Font"),u("/BaseFont /"+df(c.fontName)),u("/FontDescriptor "+k+" 0 R"),u("/W "+e.API.PDFObject.convert(g)),u("/CIDToGIDMap /Identity"),u("/DW 1000"),u("/Subtype /CIDFontType2"),u("/CIDSystemInfo"),u("<<"),u("/Supplement 0"),u("/Registry (Adobe)"),u("/Ordering ("+c.encoding+")"),u(">>"),u(">>"),u("endobj"),c.objectNumber=f(),u("<<"),u("/Type /Font"),u("/Subtype /Type0"),u("/ToUnicode "+B+" 0 R"),u("/BaseFont /"+df(c.fontName)),u("/Encoding /"+c.encoding),u("/DescendantFonts ["+E+" 0 R]"),u(">>"),u("endobj"),c.isAlreadyPutted=!0}})(n)}]),t.events.push(["putFont",function(n){(function(o){var c=o.font,u=o.out,f=o.newObject,h=o.putStream;if(c.metadata instanceof e.API.TTFFont&&c.encoding==="WinAnsiEncoding"){for(var g=c.metadata.rawData,x="",m=0;m<g.length;m++)x+=String.fromCharCode(g[m]);var w=f();h({data:x,addLength1:!0,objectId:w}),u("endobj");var v=f();h({data:a(c.metadata.toUnicode),addLength1:!0,objectId:v}),u("endobj");var B=f();u("<<"),u("/Descent "+c.metadata.decender),u("/CapHeight "+c.metadata.capHeight),u("/StemV "+c.metadata.stemV),u("/Type /FontDescriptor"),u("/FontFile2 "+w+" 0 R"),u("/Flags 96"),u("/FontBBox "+e.API.PDFObject.convert(c.metadata.bbox)),u("/FontName /"+df(c.fontName)),u("/ItalicAngle "+c.metadata.italicAngle),u("/Ascent "+c.metadata.ascender),u(">>"),u("endobj"),c.objectNumber=f();for(var k=0;k<c.metadata.hmtx.widths.length;k++)c.metadata.hmtx.widths[k]=parseInt(c.metadata.hmtx.widths[k]*(1e3/c.metadata.head.unitsPerEm));u("<</Subtype/TrueType/Type/Font/ToUnicode "+v+" 0 R/BaseFont/"+df(c.fontName)+"/FontDescriptor "+B+" 0 R/Encoding/"+c.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(c.metadata.hmtx.widths)+">>"),u("endobj"),c.isAlreadyPutted=!0}})(n)}]);var s=function(n){var o,c=n.text||"",u=n.x,f=n.y,h=n.options||{},g=n.mutex||{},x=g.pdfEscape,m=g.activeFontKey,w=g.fonts,v=m,B="",k=0,E="",S=w[v].encoding;if(w[v].encoding!=="Identity-H")return{text:c,x:u,y:f,options:h,mutex:g};for(E=c,v=m,Array.isArray(c)&&(E=c[0]),k=0;k<E.length;k+=1)w[v].metadata.hasOwnProperty("cmap")&&(o=w[v].metadata.cmap.unicode.codeMap[E[k].charCodeAt(0)]),o||E[k].charCodeAt(0)<256&&w[v].metadata.hasOwnProperty("Unicode")?B+=E[k]:B+="";var L="";return parseInt(v.slice(1))<14||S==="WinAnsiEncoding"?L=x(B,v).split("").map(function(P){return P.charCodeAt(0).toString(16)}).join(""):S==="Identity-H"&&(L=r(B,w[v])),g.isHex=!0,{text:L,x:u,y:f,options:h,mutex:g}};t.events.push(["postProcessText",function(n){var o=n.text||"",c=[],u={text:o,x:n.x,y:n.y,options:n.options,mutex:n.mutex};if(Array.isArray(o)){var f=0;for(f=0;f<o.length;f+=1)Array.isArray(o[f])&&o[f].length===3?c.push([s(Object.assign({},u,{text:o[f][0]})).text,o[f][1],o[f][2]]):c.push(s(Object.assign({},u,{text:o[f]})).text);n.text=c}else n.text=s(Object.assign({},u,{text:o})).text}])})(_r),(function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,a){return t.call(this),this.internal.vFS[r]=a,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}})(_r.API),(function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(a){var s,n,o,c,u,f,h,g=t,x=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],m=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],w={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},v={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},B=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],k=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),E=!1,S=0;this.__bidiEngine__={};var L=function(T){var D=T.charCodeAt(),G=D>>8,ne=v[G];return ne!==void 0?g[256*ne+(255&D)]:G===252||G===253?"AL":k.test(G)?"L":G===8?"R":"N"},P=function(T){for(var D,G=0;G<T.length;G++){if((D=L(T.charAt(G)))==="L")return!1;if(D==="R")return!0}return!1},R=function(T,D,G,ne){var H,ee,le,pe,te=D[ne];switch(te){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":E=!1;break;case"N":case"AN":break;case"EN":E&&(te="AN");break;case"AL":E=!0,te="R";break;case"WS":case"BN":te="N";break;case"CS":ne<1||ne+1>=D.length||(H=G[ne-1])!=="EN"&&H!=="AN"||(ee=D[ne+1])!=="EN"&&ee!=="AN"?te="N":E&&(ee="AN"),te=ee===H?ee:"N";break;case"ES":te=(H=ne>0?G[ne-1]:"B")==="EN"&&ne+1<D.length&&D[ne+1]==="EN"?"EN":"N";break;case"ET":if(ne>0&&G[ne-1]==="EN"){te="EN";break}if(E){te="N";break}for(le=ne+1,pe=D.length;le<pe&&D[le]==="ET";)le++;te=le<pe&&D[le]==="EN"?"EN":"N";break;case"NSM":if(o&&!c){for(pe=D.length,le=ne+1;le<pe&&D[le]==="NSM";)le++;if(le<pe){var Le=T[ne],je=Le>=1425&&Le<=2303||Le===64286;if(H=D[le],je&&(H==="R"||H==="AL")){te="R";break}}}te=ne<1||(H=D[ne-1])==="B"?"N":G[ne-1];break;case"B":E=!1,s=!0,te=S;break;case"S":n=!0,te="N"}return te},Q=function(T,D,G){var ne=T.split("");return G&&V(ne,G,{hiLevel:S}),ne.reverse(),D&&D.reverse(),ne.join("")},V=function(T,D,G){var ne,H,ee,le,pe,te=-1,Le=T.length,je=0,F=[],K=S?m:x,I=[];for(E=!1,s=!1,n=!1,H=0;H<Le;H++)I[H]=L(T[H]);for(ee=0;ee<Le;ee++){if(pe=je,F[ee]=R(T,I,F,ee),ne=240&(je=K[pe][w[F[ee]]]),je&=15,D[ee]=le=K[je][5],ne>0)if(ne===16){for(H=te;H<ee;H++)D[H]=1;te=-1}else te=-1;if(K[je][6])te===-1&&(te=ee);else if(te>-1){for(H=te;H<ee;H++)D[H]=le;te=-1}I[ee]==="B"&&(D[ee]=0),G.hiLevel|=le}n&&(function(q,J,Y){for(var de=0;de<Y;de++)if(q[de]==="S"){J[de]=S;for(var ue=de-1;ue>=0&&q[ue]==="WS";ue--)J[ue]=S}})(I,D,Le)},U=function(T,D,G,ne,H){if(!(H.hiLevel<T)){if(T===1&&S===1&&!s)return D.reverse(),void(G&&G.reverse());for(var ee,le,pe,te,Le=D.length,je=0;je<Le;){if(ne[je]>=T){for(pe=je+1;pe<Le&&ne[pe]>=T;)pe++;for(te=je,le=pe-1;te<le;te++,le--)ee=D[te],D[te]=D[le],D[le]=ee,G&&(ee=G[te],G[te]=G[le],G[le]=ee);je=pe}je++}}},M=function(T,D,G){var ne=T.split(""),H={hiLevel:S};return G||(G=[]),V(ne,G,H),(function(ee,le,pe){if(pe.hiLevel!==0&&h)for(var te,Le=0;Le<ee.length;Le++)le[Le]===1&&(te=B.indexOf(ee[Le]))>=0&&(ee[Le]=B[te+1])})(ne,G,H),U(2,ne,D,G,H),U(1,ne,D,G,H),ne.join("")};return this.__bidiEngine__.doBidiReorder=function(T,D,G){if((function(H,ee){if(ee)for(var le=0;le<H.length;le++)ee[le]=le;c===void 0&&(c=P(H)),f===void 0&&(f=P(H))})(T,D),o||!u||f)if(o&&u&&c^f)S=c?1:0,T=Q(T,D,G);else if(!o&&u&&f)S=c?1:0,T=M(T,D,G),T=Q(T,D);else if(!o||c||u||f){if(o&&!u&&c^f)T=Q(T,D),c?(S=0,T=M(T,D,G)):(S=1,T=M(T,D,G),T=Q(T,D));else if(o&&c&&!u&&f)S=1,T=M(T,D,G),T=Q(T,D);else if(!o&&!u&&c^f){var ne=h;c?(S=1,T=M(T,D,G),S=0,h=!1,T=M(T,D,G),h=ne):(S=0,T=M(T,D,G),T=Q(T,D),S=1,h=!1,T=M(T,D,G),h=ne,T=Q(T,D))}}else S=0,T=M(T,D,G);else S=c?1:0,T=M(T,D,G);return T},this.__bidiEngine__.setOptions=function(T){T&&(o=T.isInputVisual,u=T.isOutputVisual,c=T.isInputRtl,f=T.isOutputRtl,h=T.isSymmetricSwapping)},this.__bidiEngine__.setOptions(a),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(a){var s=a.text;a.x,a.y;var n=a.options||{};a.mutex,n.lang;var o=[];if(n.isInputVisual=typeof n.isInputVisual!="boolean"||n.isInputVisual,r.setOptions(n),Object.prototype.toString.call(s)==="[object Array]"){var c=0;for(o=[],c=0;c<s.length;c+=1)Object.prototype.toString.call(s[c])==="[object Array]"?o.push([r.doBidiReorder(s[c][0]),s[c][1],s[c][2]]):o.push([r.doBidiReorder(s[c])]);a.text=o}else a.text=r.doBidiReorder(s);r.setOptions({isInputVisual:!0})}])})(_r),_r.API.TTFFont=(function(){function e(t){var r;if(this.rawData=t,r=this.contents=new f0(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new _te(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new ote(this.contents),this.head=new cte(this),this.name=new pte(this),this.cmap=new JT(this),this.toUnicode={},this.hhea=new ute(this),this.maxp=new gte(this),this.hmtx=new mte(this),this.post=new fte(this),this.os2=new dte(this),this.loca=new wte(this),this.glyf=new xte(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,a,s,n;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,c,u,f;for(f=[],o=0,c=(u=this.bbox).length;o<c;o++)t=u[o],f.push(Math.round(t*this.scaleFactor));return f}).call(this),this.stemV=0,this.post.exists?(a=255&(s=this.post.italic_angle),32768&(r=s>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+a)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(n=this.familyClass)===1||n===2||n===3||n===4||n===5||n===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,a){var s,n,o,c;for(o=0,n=0,c=(t=""+t).length;0<=c?n<c:n>c;n=0<=c?++n:--n)s=t.charCodeAt(n),o+=this.widthOfGlyph(this.characterToGlyph(s))+a*(1e3/r)||0;return o*(r/1e3)},e.prototype.lineHeight=function(t,r){var a;return r==null&&(r=!1),a=r?this.lineGap:0,(this.ascender+a-this.decender)/1e3*t},e})();var QA,f0=(function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,a;for(a=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)a[r]=String.fromCharCode(this.readByte());return a.join("")},e.prototype.writeString=function(t){var r,a,s;for(s=[],r=0,a=t.length;0<=a?r<a:r>a;r=0<=a?++r:--r)s.push(this.writeByte(t.charCodeAt(r)));return s},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,a,s,n,o,c,u;return t=this.readByte(),r=this.readByte(),a=this.readByte(),s=this.readByte(),n=this.readByte(),o=this.readByte(),c=this.readByte(),u=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^a)+4294967296*(255^s)+16777216*(255^n)+65536*(255^o)+256*(255^c)+(255^u)+1):72057594037927940*t+281474976710656*r+1099511627776*a+4294967296*s+16777216*n+65536*o+256*c+u},e.prototype.writeLongLong=function(t){var r,a;return r=Math.floor(t/4294967296),a=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(a>>24&255),this.writeByte(a>>16&255),this.writeByte(a>>8&255),this.writeByte(255&a)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,a;for(r=[],a=0;0<=t?a<t:a>t;a=0<=t?++a:--a)r.push(this.readByte());return r},e.prototype.write=function(t){var r,a,s,n;for(n=[],a=0,s=t.length;a<s;a++)r=t[a],n.push(this.writeByte(r));return n},e})(),ote=(function(){var e;function t(r){var a,s,n;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},s=0,n=this.tableCount;0<=n?s<n:s>n;s=0<=n?++s:--s)a={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[a.tag]=a}return t.prototype.encode=function(r){var a,s,n,o,c,u,f,h,g,x,m,w,v;for(v in m=Object.keys(r).length,u=Math.log(2),g=16*Math.floor(Math.log(m)/u),o=Math.floor(g/u),h=16*m-g,(s=new f0).writeInt(this.scalarType),s.writeShort(m),s.writeShort(g),s.writeShort(o),s.writeShort(h),n=16*m,f=s.pos+n,c=null,w=[],r)for(x=r[v],s.writeString(v),s.writeInt(e(x)),s.writeInt(f),s.writeInt(x.length),w=w.concat(x),v==="head"&&(c=f),f+=x.length;f%4;)w.push(0),f++;return s.write(w),a=2981146554-e(s.data),s.pos=c+8,s.writeUInt32(a),s.data},e=function(r){var a,s,n,o;for(r=ZT.call(r);r.length%4;)r.push(0);for(n=new f0(r),s=0,a=0,o=r.length;a<o;a=a+=4)s+=n.readUInt32();return 4294967295&s},t})(),Ate={}.hasOwnProperty,Fc=function(e,t){for(var r in t)Ate.call(t,r)&&(e[r]=t[r]);function a(){this.constructor=e}return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e};QA=(function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e})();var cte=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Fc(e,QA),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new f0).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e})(),wS=(function(){function e(t,r){var a,s,n,o,c,u,f,h,g,x,m,w,v,B,k,E,S;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),g=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(u=0;u<256;++u)this.codeMap[u]=t.readByte();break;case 4:for(m=t.readUInt16(),x=m/2,t.pos+=6,n=(function(){var L,P;for(P=[],u=L=0;0<=x?L<x:L>x;u=0<=x?++L:--L)P.push(t.readUInt16());return P})(),t.pos+=2,v=(function(){var L,P;for(P=[],u=L=0;0<=x?L<x:L>x;u=0<=x?++L:--L)P.push(t.readUInt16());return P})(),f=(function(){var L,P;for(P=[],u=L=0;0<=x?L<x:L>x;u=0<=x?++L:--L)P.push(t.readUInt16());return P})(),h=(function(){var L,P;for(P=[],u=L=0;0<=x?L<x:L>x;u=0<=x?++L:--L)P.push(t.readUInt16());return P})(),s=(this.length-t.pos+this.offset)/2,c=(function(){var L,P;for(P=[],u=L=0;0<=s?L<s:L>s;u=0<=s?++L:--L)P.push(t.readUInt16());return P})(),u=k=0,S=n.length;k<S;u=++k)for(B=n[u],a=E=w=v[u];w<=B?E<=B:E>=B;a=w<=B?++E:--E)h[u]===0?o=a+f[u]:(o=c[h[u]/2+(a-w)-(x-u)]||0)!==0&&(o+=f[u]),this.codeMap[a]=65535&o}t.pos=g}return e.encode=function(t,r){var a,s,n,o,c,u,f,h,g,x,m,w,v,B,k,E,S,L,P,R,Q,V,U,M,T,D,G,ne,H,ee,le,pe,te,Le,je,F,K,I,q,J,Y,de,ue,we,Ie,Ae;switch(ne=new f0,o=Object.keys(t).sort(function(oe,He){return oe-He}),r){case"macroman":for(v=0,B=(function(){var oe=[];for(w=0;w<256;++w)oe.push(0);return oe})(),E={0:0},n={},H=0,te=o.length;H<te;H++)E[ue=t[s=o[H]]]==null&&(E[ue]=++v),n[s]={old:t[s],new:E[t[s]]},B[s]=E[t[s]];return ne.writeUInt16(1),ne.writeUInt16(0),ne.writeUInt32(12),ne.writeUInt16(0),ne.writeUInt16(262),ne.writeUInt16(0),ne.write(B),{charMap:n,subtable:ne.data,maxGlyphID:v+1};case"unicode":for(D=[],g=[],S=0,E={},a={},k=f=null,ee=0,Le=o.length;ee<Le;ee++)E[P=t[s=o[ee]]]==null&&(E[P]=++S),a[s]={old:P,new:E[P]},c=E[P]-s,k!=null&&c===f||(k&&g.push(k),D.push(s),f=c),k=s;for(k&&g.push(k),g.push(65535),D.push(65535),M=2*(U=D.length),V=2*Math.pow(Math.log(U)/Math.LN2,2),x=Math.log(V/2)/Math.LN2,Q=2*U-V,u=[],R=[],m=[],w=le=0,je=D.length;le<je;w=++le){if(T=D[w],h=g[w],T===65535){u.push(0),R.push(0);break}if(T-(G=a[T].new)>=32768)for(u.push(0),R.push(2*(m.length+U-w)),s=pe=T;T<=h?pe<=h:pe>=h;s=T<=h?++pe:--pe)m.push(a[s].new);else u.push(G-T),R.push(0)}for(ne.writeUInt16(3),ne.writeUInt16(1),ne.writeUInt32(12),ne.writeUInt16(4),ne.writeUInt16(16+8*U+2*m.length),ne.writeUInt16(0),ne.writeUInt16(M),ne.writeUInt16(V),ne.writeUInt16(x),ne.writeUInt16(Q),Y=0,F=g.length;Y<F;Y++)s=g[Y],ne.writeUInt16(s);for(ne.writeUInt16(0),de=0,K=D.length;de<K;de++)s=D[de],ne.writeUInt16(s);for(we=0,I=u.length;we<I;we++)c=u[we],ne.writeUInt16(c);for(Ie=0,q=R.length;Ie<q;Ie++)L=R[Ie],ne.writeUInt16(L);for(Ae=0,J=m.length;Ae<J;Ae++)v=m[Ae],ne.writeUInt16(v);return{charMap:a,subtable:ne.data,maxGlyphID:S+1}}},e})(),JT=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Fc(e,QA),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,a,s;for(t.pos=this.offset,this.version=t.readUInt16(),s=t.readUInt16(),this.tables=[],this.unicode=null,a=0;0<=s?a<s:a>s;a=0<=s?++a:--a)r=new wS(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var a,s;return r==null&&(r="macroman"),a=wS.encode(t,r),(s=new f0).writeUInt16(0),s.writeUInt16(1),a.table=s.data.concat(a.subtable),a},e})(),ute=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Fc(e,QA),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e})(),dte=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Fc(e,QA),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=(function(){var r,a;for(a=[],r=0;r<10;++r)a.push(t.readByte());return a})(),this.charRange=(function(){var r,a;for(a=[],r=0;r<4;++r)a.push(t.readInt());return a})(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=(function(){var r,a;for(a=[],r=0;r<2;r=++r)a.push(t.readInt());return a})(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e})(),fte=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Fc(e,QA),e.prototype.tag="post",e.prototype.parse=function(t){var r,a,s;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var n;for(a=t.readUInt16(),this.glyphNameIndex=[],n=0;0<=a?n<a:n>a;n=0<=a?++n:--n)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],s=[];t.pos<this.offset+this.length;)r=t.readByte(),s.push(this.names.push(t.readString(r)));return s;case 151552:return a=t.readUInt16(),this.offsets=t.read(a);case 262144:return this.map=(function(){var o,c,u;for(u=[],n=o=0,c=this.file.maxp.numGlyphs;0<=c?o<c:o>c;n=0<=c?++o:--o)u.push(t.readUInt32());return u}).call(this)}},e})(),hte=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},pte=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Fc(e,QA),e.prototype.tag="name",e.prototype.parse=function(t){var r,a,s,n,o,c,u,f,h,g,x;for(t.pos=this.offset,t.readShort(),r=t.readShort(),c=t.readShort(),a=[],n=0;0<=r?n<r:n>r;n=0<=r?++n:--n)a.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+c+t.readShort()});for(u={},n=h=0,g=a.length;h<g;n=++h)s=a[n],t.pos=s.offset,f=t.readString(s.length),o=new hte(f,s),u[x=s.nameID]==null&&(u[x]=[]),u[s.nameID].push(o);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},e})(),gte=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Fc(e,QA),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e})(),mte=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Fc(e,QA),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,a,s,n,o,c,u;for(t.pos=this.offset,this.metrics=[],r=0,c=this.file.hhea.numberOfMetrics;0<=c?r<c:r>c;r=0<=c?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var f,h;for(h=[],r=f=0;0<=s?f<s:f>s;r=0<=s?++f:--f)h.push(t.readInt16());return h})(),this.widths=(function(){var f,h,g,x;for(x=[],f=0,h=(g=this.metrics).length;f<h;f++)n=g[f],x.push(n.advance);return x}).call(this),a=this.widths[this.widths.length-1],u=[],r=o=0;0<=s?o<s:o>s;r=0<=s?++o:--o)u.push(this.widths.push(a));return u},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e})(),ZT=[].slice,xte=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Fc(e,QA),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,a,s,n,o,c,u,f,h,g;return t in this.cache?this.cache[t]:(n=this.file.loca,r=this.file.contents,a=n.indexOf(t),(s=n.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+a,o=(c=new f0(r.read(s))).readShort(),f=c.readShort(),g=c.readShort(),u=c.readShort(),h=c.readShort(),this.cache[t]=o===-1?new vte(c,f,g,u,h):new bte(c,o,f,g,u,h),this.cache[t]))},e.prototype.encode=function(t,r,a){var s,n,o,c,u;for(o=[],n=[],c=0,u=r.length;c<u;c++)s=t[r[c]],n.push(o.length),s&&(o=o.concat(s.encode(a)));return n.push(o.length),{table:o,offsets:n}},e})(),bte=(function(){function e(t,r,a,s,n,o){this.raw=t,this.numberOfContours=r,this.xMin=a,this.yMin=s,this.xMax=n,this.yMax=o,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e})(),vte=(function(){function e(t,r,a,s,n){var o,c;for(this.raw=t,this.xMin=r,this.yMin=a,this.xMax=s,this.yMax=n,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;c=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&c;)o.pos+=1&c?4:2,128&c?o.pos+=8:64&c?o.pos+=4:8&c&&(o.pos+=2)}return e.prototype.encode=function(){var t,r,a;for(r=new f0(ZT.call(this.raw.data)),t=0,a=this.glyphIDs.length;t<a;++t)r.pos=this.glyphOffsets[t];return r.data},e})(),wte=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Fc(e,QA),e.prototype.tag="loca",e.prototype.parse=function(t){var r,a;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var s,n;for(n=[],a=0,s=this.length;a<s;a+=2)n.push(2*t.readUInt16());return n}).call(this):(function(){var s,n;for(n=[],a=0,s=this.length;a<s;a+=4)n.push(t.readUInt32());return n}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var a=new Uint32Array(this.offsets.length),s=0,n=0,o=0;o<a.length;++o)if(a[o]=s,n<r.length&&r[n]==o){++n,a[o]=s;var c=this.offsets[o],u=this.offsets[o+1]-c;u>0&&(s+=u)}for(var f=new Array(4*a.length),h=0;h<a.length;++h)f[4*h+3]=255&a[h],f[4*h+2]=(65280&a[h])>>8,f[4*h+1]=(16711680&a[h])>>16,f[4*h]=(4278190080&a[h])>>24;return f},e})(),_te=(function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,a,s,n;for(r in s=this.font.cmap.tables[0].codeMap,t={},n=this.subset)a=n[r],t[r]=s[a];return t},e.prototype.glyphsFor=function(t){var r,a,s,n,o,c,u;for(s={},o=0,c=t.length;o<c;o++)s[n=t[o]]=this.font.glyf.glyphFor(n);for(n in r=[],s)(a=s[n])!=null&&a.compound&&r.push.apply(r,a.glyphIDs);if(r.length>0)for(n in u=this.glyphsFor(r))a=u[n],s[n]=a;return s},e.prototype.encode=function(t,r){var a,s,n,o,c,u,f,h,g,x,m,w,v,B,k;for(s in a=JT.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(t),m={0:0},k=a.charMap)m[(u=k[s]).old]=u.new;for(w in x=a.maxGlyphID,o)w in m||(m[w]=x++);return h=(function(E){var S,L;for(S in L={},E)L[E[S]]=S;return L})(m),g=Object.keys(h).sort(function(E,S){return E-S}),v=(function(){var E,S,L;for(L=[],E=0,S=g.length;E<S;E++)c=g[E],L.push(h[c]);return L})(),n=this.font.glyf.encode(o,v,m),f=this.font.loca.encode(n.offsets,v),B={cmap:this.font.cmap.raw(),glyf:n.table,loca:f,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(B["OS/2"]=this.font.os2.raw()),this.font.directory.encode(B)},e})();_r.API.PDFObject=(function(){var e;function t(){}return e=function(r,a){return(Array(a+1).join("0")+r).slice(-a)},t.convert=function(r){var a,s,n,o;if(Array.isArray(r))return"["+(function(){var c,u,f;for(f=[],c=0,u=r.length;c<u;c++)a=r[c],f.push(t.convert(a));return f})().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(s in n=["<<"],r)o=r[s],n.push("/"+s+" "+t.convert(o));return n.push(">>"),n.join(`
`)}return""+r},t})();const D_=()=>{const{t:e}=ds(),t=UA("ReportExport"),[r,a]=Z.useState(!1),[s,n]=Z.useState(0),o=k=>{const E=k.replace("#","");if(!/^[0-9a-fA-F]{6}$/.test(E))return[30,41,59];const S=parseInt(E.slice(0,2),16),L=parseInt(E.slice(2,4),16),P=parseInt(E.slice(4,6),16);return[S,L,P]},c=k=>new Promise((E,S)=>{const L=new FileReader;L.onloadend=()=>E(String(L.result||"")),L.onerror=()=>S(new Error("Failed to read image blob")),L.readAsDataURL(k)}),u=(k,E)=>{const S=k.toLowerCase();if(S.includes("jpeg")||S.includes("jpg"))return"JPEG";if(S.includes("webp"))return"WEBP";if(S.includes("png"))return"PNG";const L=E.toLowerCase();return L.endsWith(".jpg")||L.endsWith(".jpeg")?"JPEG":L.endsWith(".webp")?"WEBP":"PNG"},f=async k=>{if(k.startsWith("data:image/")){const R=k.includes("image/jpeg")||k.includes("image/jpg")?"JPEG":k.includes("image/webp")?"WEBP":"PNG";return{data:k,format:R}}const E=await fetch(k,{mode:"cors",referrerPolicy:"no-referrer"});if(!E.ok)throw new Error(`Image request failed with status ${E.status}`);const S=await E.blob(),L=u(S.type,k);return{data:await c(S),format:L}},h=(k,E,S,L,P)=>{const R=P?.showHeader??!0,Q=P?.showFooter??!0,V=k.internal.pageSize.getWidth(),U=k.internal.pageSize.getHeight();if(R&&(k.setFontSize(10),k.setTextColor(120,120,120),k.text(P?.headerText||E.title,10,10),k.line(10,12,V-10,12),E.status&&E.status!=="info")){const M=E.status.toUpperCase();k.setFontSize(8);const T=E.status==="critical"?[220,38,38]:E.status==="warning"?[217,119,6]:[5,150,105];k.setTextColor(T[0],T[1],T[2]),k.text(M,V-10,10,{align:"right"})}if(Q){k.setFontSize(9),k.setTextColor(130,130,130);const M=P?.dataAsOf?.trim(),T=P?.footerText||(M?`${e("reports.data_as_of","Data as of")}: ${M}`:`${e("reports.generated_on")}: ${new Date().toLocaleDateString()}`);k.text(T,10,U-8);const D=`${S}/${L}`;k.text(D,V-10,U-8,{align:"right"})}},g=async(k,E)=>{const S=document.getElementById(k);if(!S)return null;const L=S.cloneNode(!0);L.style.position="fixed",L.style.top="0",L.style.left="500vw",L.style.width=E?`${E}px`:`${S.scrollWidth||1200}px`,L.style.height="auto",L.style.minHeight=`${S.scrollHeight||800}px`,L.style.overflow="visible",L.style.zIndex="-100",L.style.padding="40px",L.style.backgroundColor="#ffffff",L.querySelectorAll(".overflow-auto, .overflow-y-auto, .overflow-x-auto").forEach(V=>{V.style.overflow="visible",V.style.height="auto"}),L.querySelectorAll("h1, h2, h3, h4, h5, h6, .truncate").forEach(V=>{const U=V;U.style.overflow="visible",U.style.textOverflow="clip",U.style.lineHeight="1.35",U.style.paddingBottom="2px"}),document.body.appendChild(L),await new Promise(V=>setTimeout(V,800)),"fonts"in document&&await document.fonts.ready;const Q=await a2(L,{scale:2,useCORS:!0,logging:!1,backgroundColor:"#ffffff",width:L.offsetWidth,height:L.offsetHeight});return document.body.removeChild(L),{imgData:Q.toDataURL("image/png"),width:Q.width,height:Q.height}};return{isExporting:r,exportProgress:s,exportToPdf:async(k,E,S="landscape")=>{a(!0),n(0);try{const L=await g(k);if(!L)return;const P=new _r({orientation:S,unit:"mm",format:"a4"}),R=P.internal.pageSize.getWidth(),Q=P.internal.pageSize.getHeight(),V=Math.min(R/(L.width/2),Q/(L.height/2)),U=L.width/2*V,M=L.height/2*V;P.addImage(L.imgData,"PNG",(R-U)/2,(Q-M)/2,U,M),P.save(`${E}.pdf`)}catch(L){t.error("Export failed:",L)}finally{a(!1)}},exportPackageToPdf:async(k,E,S,L,P)=>{a(!0),n(0);const R=new _r({orientation:"portrait",unit:"mm",format:"a4"});try{if(S){const[U,M,T]=S.themeColor?o(S.themeColor):[30,41,59];if(R.setFillColor(U,M,T),R.rect(0,0,210,297,"F"),R.setTextColor(255,255,255),R.setFontSize(32),R.text(S.title,20,100),S.subtitle&&(R.setFontSize(16),R.setTextColor(148,163,184),R.text(S.subtitle,20,115)),R.setFontSize(12),R.setTextColor(100,116,139),R.text(`${e("reports.generated_on")}: ${new Date().toLocaleDateString()}`,20,260),S.author&&R.text(`${e("reports.author_prefix")}: ${S.author}`,20,267),S.logoUrl)try{const D=await f(S.logoUrl),G=30,H=210-20-G;R.addImage(D.data,D.format,H,25,G,G)}catch(D){t.warn("Cover logo could not be loaded for PDF export. The host likely blocks cross-origin image access.",D)}R.addPage()}const Q=S?2:1,V=(S?1:0)+E.length;for(let U=0;U<E.length;U++){n(Math.round((U+1)/E.length*100));const M=E[U],T=await g(M.elementId,M.orientation==="landscape"?1400:1e3);if(T){const D=M.orientation||"portrait";(U>0||S)&&R.addPage(void 0,D);const G=R.internal.pageSize.getWidth(),ne=R.internal.pageSize.getHeight();((L?.footerMode??"all")==="all"||(L?.footerMode??"all")==="content_only")&&h(R,M,Q+U,V,L);const H=L?.showHeader===!1?12:20,ee=L?.showFooter===!1?12:18,le=Math.min((G-20)/(T.width/2),(ne-(H+ee))/(T.height/2)),pe=T.width/2*le,te=T.height/2*le;R.addImage(T.imgData,"PNG",(G-pe)/2,H,pe,te)}}if(L?.includeAuditAppendix){R.addPage(),R.setFontSize(18),R.setTextColor(30,41,59),R.text(e("reports.audit_appendix_title","Audit Appendix"),14,18),R.setFontSize(10),R.setTextColor(71,85,105);const U=[];U.push(`${e("reports.pack_name","Package")}: ${P?.packName||k}`),U.push(`${e("reports.generated_on")}: ${P?.generatedAt||new Date().toISOString()}`),(P?.dataAsOf||L?.dataAsOf)&&U.push(`${e("reports.data_as_of","Data as of")}: ${P?.dataAsOf||L?.dataAsOf}`),U.push(`${e("reports.pages","Pages")}: ${E.length}`),U.push(""),U.push(`${e("reports.audit_sql_sources","SQL Sources")}:`);const M=P?.sqlSources||[];M.length?M.forEach(D=>{U.push(`- ${D.source}`);const G=D.sql.replace(/\s+/g," ").trim();U.push(`  ${G.slice(0,1800)}`)}):U.push(`- ${e("common.no_data","No data")}`);const T=R.splitTextToSize(U.join(`
`),180);R.text(T,14,28)}R.save(`${k}.pdf`)}catch(Q){t.error("Batch Export failed:",Q),await Qt.error(e("reports.export_failed","Export failed."))}finally{a(!1),n(0)}},exportPackageToHtml:async(k,E,S,L,P)=>{a(!0),n(0);try{const R=[];for(let le=0;le<E.length;le++){const pe=E[le],te=await g(pe.elementId,pe.orientation==="landscape"?1400:1e3);te&&R.push({title:pe.title,image:te.imgData,status:pe.status,threshold:pe.threshold,subtitle:pe.subtitle}),n(Math.round((le+1)/Math.max(E.length,1)*100))}const Q=le=>le.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),V=new Date().toLocaleString(),U=L?.headerText?.trim()||S?.title||k,M=L?.footerText?.trim()||`${e("reports.generated_on")}: ${V}`,T=R.map((le,pe)=>`<button class="nav-btn${pe===0?" active":""}" data-page="${pe}">${pe+1}. ${Q(le.title)}</button>`).join(""),D=R.map((le,pe)=>`
                <section class="report-page${pe===0?" active":""}" data-page="${pe}">
                    ${L?.showHeader??!0?`<header class="page-header">${Q(U)}</header>`:""}
                    ${le.status||le.threshold||le.subtitle?`<div class="page-context">
                        ${le.status?`<span class="status status-${le.status}">${Q(le.status.toUpperCase())}</span>`:""}
                        ${le.threshold?`<span class="threshold">${Q(le.threshold)}</span>`:""}
                        ${le.subtitle?`<span class="comment">${Q(le.subtitle)}</span>`:""}
                    </div>`:""}
                    <img src="${le.image}" alt="${Q(le.title)}" class="page-image" />
                    ${L?.showFooter??!0?`<footer class="page-footer"><span>${Q(M)}</span><span>${pe+1}/${Math.max(R.length,1)}</span></footer>`:""}
                </section>
                `).join(""),G=`<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>${Q(k)}</title>
  <style>
    :root { color-scheme: light dark; }
    body { margin: 0; font-family: Segoe UI, Arial, sans-serif; background: #0f172a; color: #e2e8f0; }
    .shell { display: grid; grid-template-columns: 280px minmax(0,1fr); min-height: 100vh; }
    .sidebar { border-right: 1px solid #334155; padding: 16px; background: #111827; }
    .title { font-size: 18px; font-weight: 700; margin: 0 0 6px; }
    .meta { font-size: 12px; color: #94a3b8; margin: 0 0 12px; }
    .nav { display: grid; gap: 8px; }
    .nav-btn { text-align: left; border: 1px solid #334155; background: #0f172a; color: #cbd5e1; border-radius: 8px; padding: 10px; cursor: pointer; font-size: 13px; }
    .nav-btn.active { border-color: #2563eb; background: #1e3a8a33; color: #dbeafe; }
    .content { padding: 20px; background: radial-gradient(circle at top right, #1e293b 0%, #0f172a 60%); }
    .report-page { display: none; max-width: 1200px; margin: 0 auto; background: #ffffff; color: #0f172a; border-radius: 10px; overflow: hidden; box-shadow: 0 12px 30px rgba(0,0,0,0.35); }
    .report-page.active { display: block; }
    .page-header, .page-footer { display: flex; justify-content: space-between; align-items: center; padding: 10px 16px; font-size: 12px; color: #475569; background: #f8fafc; border-bottom: 1px solid #e2e8f0; }
    .page-footer { border-top: 1px solid #e2e8f0; border-bottom: 0; }
    .page-context { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; padding: 8px 16px; border-bottom: 1px solid #e2e8f0; background: #f8fafc; }
    .page-image { display: block; width: 100%; height: auto; }
    .status { font-size: 11px; font-weight: 700; padding: 2px 8px; border-radius: 999px; border: 1px solid #cbd5e1; }
    .status-ok { color: #065f46; background: #d1fae5; border-color: #6ee7b7; }
    .status-warning { color: #92400e; background: #fef3c7; border-color: #fcd34d; }
    .status-critical { color: #991b1b; background: #fee2e2; border-color: #fca5a5; }
    .status-info { color: #1e3a8a; background: #dbeafe; border-color: #93c5fd; }
    .threshold, .comment { font-size: 11px; color: #475569; }
    @media (max-width: 920px) { .shell { grid-template-columns: 1fr; } .sidebar { border-right: 0; border-bottom: 1px solid #334155; } }
  </style>
</head>
<body>
  <div class="shell">
    <aside class="sidebar">
      <h1 class="title">${Q(S?.title||k)}</h1>
      <p class="meta">${Q(S?.subtitle||"")}</p>
      <p class="meta">${Q(`${e("reports.generated_on")}: ${V}`)}</p>
      ${P?.dataAsOf||L?.dataAsOf?`<p class="meta">${Q(`${e("reports.data_as_of","Data as of")}: ${P?.dataAsOf||L?.dataAsOf||""}`)}</p>`:""}
      ${L?.includeAuditAppendix?`<p class="meta">${Q(`${e("reports.audit_sql_sources","SQL Sources")}: ${(P?.sqlSources||[]).length}`)}</p>`:""}
      <nav class="nav">${T||`<span class="meta">${Q(e("common.no_data"))}</span>`}</nav>
    </aside>
    <main class="content">${D||""}</main>
  </div>
  <script>
    const navButtons = Array.from(document.querySelectorAll('.nav-btn'));
    const pages = Array.from(document.querySelectorAll('.report-page'));
    navButtons.forEach((btn) => {
      btn.addEventListener('click', () => {
        const target = btn.getAttribute('data-page');
        navButtons.forEach((b) => b.classList.toggle('active', b === btn));
        pages.forEach((p) => p.classList.toggle('active', p.getAttribute('data-page') === target));
      });
    });
  <\/script>
</body>
</html>`,ne=new Blob([G],{type:"text/html;charset=utf-8"}),H=document.createElement("a"),ee=k.trim().replace(/[<>:"/\\|?*]/g,"_")||"report-package";H.download=`${ee}.html`,H.href=URL.createObjectURL(ne),H.click(),URL.revokeObjectURL(H.href)}catch(R){t.error("HTML export failed:",R),await Qt.error(e("reports.export_failed","Export failed."))}finally{a(!1),n(0)}},exportPackageToPpt:async(k,E,S,L,P)=>{a(!0),n(0);try{const R=[];for(let pe=0;pe<E.length;pe++){const te=E[pe],Le=await g(te.elementId,te.orientation==="landscape"?1400:1e3);Le&&R.push({title:te.title,image:Le.imgData,status:te.status,threshold:te.threshold}),n(Math.round((pe+1)/Math.max(E.length,1)*100))}const Q=pe=>pe.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),V=new Date().toLocaleString(),U=L?.footerText?.trim()||`${e("reports.generated_on")}: ${V}`,M=S?.title||k,T=S?.subtitle||"",D=S?.author||"",G=R.map((pe,te)=>`
                <div class="slide">
                    ${L?.showHeader??!0?`<div class="header">${Q(pe.title)}</div>`:""}
                    ${pe.status||pe.threshold?`<div class="context">${pe.status?Q(pe.status.toUpperCase()):""}${pe.threshold?`  ${Q(pe.threshold)}`:""}</div>`:""}
                    <div class="content"><img src="${pe.image}" alt="${Q(pe.title)}" /></div>
                    ${L?.showFooter??!0?`<div class="footer"><span>${Q(U)}</span><span>${te+1}/${Math.max(R.length,1)}</span></div>`:""}
                </div>
            `).join(""),ne=`<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>${Q(k)}</title>
  <style>
    @page { size: 13.333in 7.5in; margin: 0; }
    html, body { margin: 0; padding: 0; font-family: Segoe UI, Arial, sans-serif; background: #0f172a; }
    .slide { width: 13.333in; height: 7.5in; background: #ffffff; page-break-after: always; display: flex; flex-direction: column; }
    .slide:last-child { page-break-after: auto; }
    .cover { justify-content: center; background: #1e293b; color: #ffffff; padding: 0.7in; box-sizing: border-box; }
    .cover h1 { margin: 0 0 0.2in; font-size: 42px; }
    .cover p { margin: 0.08in 0; color: #cbd5e1; font-size: 18px; }
    .header, .footer { height: 0.42in; padding: 0 0.35in; box-sizing: border-box; display: flex; align-items: center; justify-content: space-between; font-size: 12px; color: #475569; background: #f8fafc; }
    .context { min-height: 0.28in; padding: 0.04in 0.35in; font-size: 11px; color: #334155; background: #f8fafc; border-bottom: 1px solid #e2e8f0; }
    .content { flex: 1; display: flex; align-items: center; justify-content: center; padding: 0.2in; box-sizing: border-box; background: #ffffff; }
    .content img { max-width: 100%; max-height: 100%; object-fit: contain; }
  </style>
</head>
<body>
  <div class="slide cover">
    <h1>${Q(M)}</h1>
    ${T?`<p>${Q(T)}</p>`:""}
    ${D?`<p>${Q(D)}</p>`:""}
    <p>${Q(`${e("reports.generated_on")}: ${V}`)}</p>
    ${P?.dataAsOf||L?.dataAsOf?`<p>${Q(`${e("reports.data_as_of","Data as of")}: ${P?.dataAsOf||L?.dataAsOf||""}`)}</p>`:""}
  </div>
  ${G}
  ${L?.includeAuditAppendix?`<div class="slide"><div class="header">${Q(e("reports.audit_appendix_title","Audit Appendix"))}</div><div class="content" style="align-items:flex-start; justify-content:flex-start;"><pre style="font-family: Consolas, monospace; font-size: 10px; color: #334155; white-space: pre-wrap;">${Q((P?.sqlSources||[]).map(pe=>`${pe.source}
${pe.sql}`).join(`

`)||e("common.no_data","No data"))}</pre></div></div>`:""}
</body>
</html>`,H=new Blob([ne],{type:"application/vnd.ms-powerpoint"}),ee=document.createElement("a"),le=k.trim().replace(/[<>:"/\\|?*]/g,"_")||"report-package";ee.download=`${le}.ppt`,ee.href=URL.createObjectURL(H),ee.click(),URL.revokeObjectURL(ee.href)}catch(R){t.error("PPT export failed:",R),await Qt.error(e("reports.export_failed","Export failed."))}finally{a(!1),n(0)}},exportToImage:async(k,E)=>{a(!0);try{const S=document.getElementById(k);if(!S)return;await new Promise(R=>setTimeout(R,500));const L=await a2(S,{scale:2,useCORS:!0,logging:!1,backgroundColor:"#ffffff"}),P=document.createElement("a");P.download=`${E}.png`,P.href=L.toDataURL("image/png"),P.click()}catch(S){t.error("Export failed:",S)}finally{a(!1)}}}},yte=e=>{const t=e.toLowerCase();return t.includes("price")||t.includes("amount")||t.includes("preis")||t.includes("betrag")||t.includes("summe")||t.includes("kosten")||t.includes("total")},Ma=(e,t)=>{if(typeof e!="number"){if(typeof e=="string")return e;if(typeof e=="boolean")return e?"true":"false";if(e==null)return"";if(typeof e=="object")try{return JSON.stringify(e)}catch{return String(e)}return String(e)}return t&&yte(t)?new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(e):new Intl.NumberFormat("de-DE").format(e)},p2=({data:e,rows:t,cols:r,measures:a})=>{const{t:s}=ds(),n=Z.useMemo(()=>{if(!e||e.length===0||a.length===0)return null;const o=new Set,c=new Set,u={};e.forEach(x=>{const m=t.map(v=>String(x[v]??"")).join(" | "),w=r.map(v=>String(x[v]??"")).join(" | ");o.add(m),c.add(w),u[m]||(u[m]={}),u[m][w]||(u[m][w]={}),a.forEach(v=>{u[m][w][v.field]||(u[m][w][v.field]=[]);const B=Number(x[v.field]);isNaN(B)?v.agg==="count"&&u[m][w][v.field].push(1):u[m][w][v.field].push(B)})});const f=Array.from(o).sort(),h=Array.from(c).sort(),g={};return f.forEach(x=>{g[x]={},h.forEach(m=>{g[x][m]={},a.forEach(w=>{const v=u[x]?.[m]?.[w.field]||[];let B=0;if(v.length>0)switch(w.agg){case"sum":B=v.reduce((k,E)=>k+E,0);break;case"count":B=v.length;break;case"avg":B=v.reduce((k,E)=>k+E,0)/v.length;break;case"min":B=Math.min(...v);break;case"max":B=Math.max(...v);break}g[x][m][w.field]=B})})}),{rowLabels:f,colLabels:h,values:g}},[e,t,r,a]);return n?l.jsx("div",{className:"w-full h-full overflow-auto bg-white dark:bg-slate-900 shadow-inner rounded-lg border border-slate-200 dark:border-slate-700",children:l.jsxs("table",{className:"min-w-full text-xs border-collapse",children:[l.jsxs("thead",{className:"sticky top-0 z-20 bg-slate-50 dark:bg-slate-800 border-b border-slate-300 dark:border-slate-700",children:[l.jsxs("tr",{children:[l.jsx("th",{colSpan:t.length,className:"p-2 border border-slate-300 dark:border-slate-700 font-bold bg-slate-100 dark:bg-slate-800 text-slate-500 uppercase tracking-wider",children:t.join(" / ")}),n.colLabels.map(o=>l.jsx("th",{colSpan:a.length,className:"p-2 border border-slate-300 dark:border-slate-700 font-bold text-center bg-blue-50/50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300",children:o||"--"},o))]}),a.length>1&&l.jsxs("tr",{children:[l.jsx("th",{colSpan:t.length,className:"border border-slate-300 dark:border-slate-700"}),n.colLabels.map(o=>a.map(c=>l.jsxs("th",{className:"p-1 border border-slate-300 dark:border-slate-700 text-[10px] text-slate-400 font-medium",children:[c.field," (",s(`querybuilder.pivot_agg_${c.agg}`),")"]},`${o}-${c.field}`)))]}),a.length===1&&l.jsxs("tr",{children:[l.jsx("th",{colSpan:t.length,className:"border border-slate-300 dark:border-slate-700"}),n.colLabels.map(o=>l.jsx("th",{className:"p-1 border border-slate-300 dark:border-slate-700 text-[10px] text-slate-400 font-medium italic",children:s(`querybuilder.pivot_agg_${a[0].agg}`)},`measure-${o}`))]})]}),l.jsx("tbody",{children:n.rowLabels.map((o,c)=>l.jsxs("tr",{className:c%2===0?"bg-white dark:bg-slate-900":"bg-slate-50/30 dark:bg-slate-800/20",children:[o.split(" | ").map((u,f)=>l.jsx("td",{className:"p-2 border border-slate-200 dark:border-slate-800 font-medium text-slate-700 dark:text-slate-300 whitespace-nowrap",children:u},f)),n.colLabels.map(u=>a.map(f=>{const h=n.values[o][u][f.field];return l.jsx("td",{className:"p-2 border border-slate-200 dark:border-slate-800 text-right font-mono tabular-nums",children:Ma(h,f.field)},`${u}-${f.field}`)}))]},o))})]})}):l.jsx("div",{className:"p-8 text-center text-slate-400 italic",children:s("common.no_data")})},kte=e=>e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),Bte=e=>{const t=e.trim();return t&&/^(https?:|mailto:|tel:)/i.test(t)?t:"#"},Hh=e=>{let t=kte(e);return t=t.replace(/`([^`]+)`/g,'<code class="px-1 py-0.5 rounded bg-slate-100 dark:bg-slate-800 font-mono text-[0.9em]">$1</code>'),t=t.replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>"),t=t.replace(/\*([^*]+)\*/g,"<em>$1</em>"),t=t.replace(/\[([^\]]+)\]\(([^)]+)\)/g,(r,a,s)=>`<a class="text-blue-600 dark:text-blue-400 underline underline-offset-2" href="${Bte(s)}" target="_blank" rel="noopener noreferrer">${a}</a>`),t},Cte=e=>{const t=e.replace(/\r\n/g,`
`).split(`
`),r=[];let a=!1,s=!1;const n=()=>{a&&(r.push("</ul>"),a=!1),s&&(r.push("</ol>"),s=!1)};for(const o of t){const c=o.trim();if(!c){n();continue}const u=c.match(/^(#{1,6})\s+(.+)$/);if(u){n();const x=u[1].length;r.push(`<h${x} class="font-bold ${x<=2?"text-lg":x===3?"text-base":"text-sm"} mt-2 mb-1">${Hh(u[2])}</h${x}>`);continue}const f=c.match(/^>\s?(.+)$/);if(f){n(),r.push(`<blockquote class="border-l-2 border-slate-300 dark:border-slate-600 pl-3 italic text-slate-600 dark:text-slate-300 my-1">${Hh(f[1])}</blockquote>`);continue}const h=c.match(/^[-*+]\s+(.+)$/);if(h){s&&(r.push("</ol>"),s=!1),a||(r.push('<ul class="list-disc list-inside space-y-1 my-1">'),a=!0),r.push(`<li>${Hh(h[1])}</li>`);continue}const g=c.match(/^\d+\.\s+(.+)$/);if(g){a&&(r.push("</ul>"),a=!1),s||(r.push('<ol class="list-decimal list-inside space-y-1 my-1">'),s=!0),r.push(`<li>${Hh(g[1])}</li>`);continue}if(/^(-{3,}|\*{3,}|_{3,})$/.test(c)){n(),r.push('<hr class="my-2 border-slate-200 dark:border-slate-700" />');continue}n(),r.push(`<p class="my-1">${Hh(c)}</p>`)}return n(),r.join("")},e6=({markdown:e,className:t="",emptyText:r=""})=>{const a=e.trim();return a?l.jsx("div",{className:t,dangerouslySetInnerHTML:{__html:Cte(a)}}):l.jsx("div",{className:t,children:r})},_S="",ln=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8","#82ca9d"],Ste=UA("QueryBuilderView"),af=e=>e.replace(/\s+/g," ").trim().toLowerCase(),Nte=384,Ete=()=>{const{t:e}=ds(),[t,r]=Z.useState(_S),[a,s]=Z.useState([]),[n,o]=Z.useState(""),[c,u]=Z.useState(!1),[f,h]=Z.useState(""),[g,x]=Z.useState(0),[m,w]=Z.useState("graphic"),[v,B]=Z.useState(""),[k,E]=Z.useState("sql"),[S,L]=Z.useState("source"),[P,R]=Z.useState("none"),[Q,V]=Z.useState(!1),[U,M]=Z.useState(1),[T,D]=Jt("query_builder_config",void 0),[G,ne]=Z.useState("table"),[H,ee]=Z.useState({type:"table",color:"#3b82f6"}),[le,pe]=Z.useState(null),[te,Le]=Z.useState(!1),[je,F]=Z.useState(""),[K,I]=Z.useState(""),[q,J]=Z.useState(""),[Y,de]=Z.useState(""),[ue,we]=Z.useState(!1),[Ie,Ae]=Z.useState(!1),[oe,He]=Z.useState(0),[se,qe]=Z.useState(null),{isExporting:Ye,exportToPdf:at}=D_(),{togglePresentationMode:Ge,isReadOnly:pt}=So(),{data:nt,refresh:Dt}=Ai(async()=>await jt.getUserWidgets(),[]),{data:It}=Ai(async()=>await jt.listSqlStatements("global"),[]);Z.useEffect(()=>{qe(null)},[]),Z.useEffect(()=>{we(!1)},[H.imageUrl]);const Ot=Z.useCallback(async ve=>{u(!0),o("");try{const it=ve||t,St=await jt.executeRaw(it);if(s(St),h(it),St.length>0){const st=Object.keys(St[0]).filter(yr=>typeof St[0][yr]=="number"),Hr=Object.keys(St[0]).filter(yr=>typeof St[0][yr]=="string");H.xAxis||ee(yr=>({...yr,xAxis:Hr[0]||Object.keys(St[0])[0],yAxes:yr.yAxes?.length?yr.yAxes:st.length>0?[st[0]]:[]}))}return!0}catch(it){return o(it instanceof Error?it.message:String(it)),!1}finally{u(!1)}},[t,H.xAxis]),sr=(ve,it=!0)=>{let St={type:"table",color:"#3b82f6"},st="table",Hr="sql",yr;const wa=ve.sql_statement_id?(It||[]).find(Lr=>Lr.id===ve.sql_statement_id):void 0,Na=(wa?.sql_text||ve.sql_query||"").trim()||_S;pe(ve.id),F(ve.name),r(Na);const Gn=(It||[]).find(Lr=>af(Lr.sql_text)===af(Na));de(wa?.id||Gn?.id||""),h(""),s([]),o(""),w("graphic"),D(void 0),E("sql"),ne("table"),ee({type:"table",color:"#3b82f6"});try{const Lr=JSON.parse(ve.visualization_config),Ia=Lr.type==="kpu_manual"?"kpi_manual":Lr.type;St={...Lr,type:Ia||"table",kpiTitle:Lr.kpiTitle??Lr.kpuTitle??"",kpiValue:Lr.kpiValue??Lr.kpuValue??"",kpiUnit:Lr.kpiUnit??Lr.kpuUnit??"",kpiTarget:Lr.kpiTarget??Lr.kpuTarget??"",kpiTrend:Lr.kpiTrend??Lr.kpuTrend??"flat",kpiAlign:Lr.kpiAlign??Lr.kpuAlign??"left",kpiNote:Lr.kpiNote??Lr.kpuNote??""},st=Ia||"table",ne(st),ee(St),Hr="sql",ve.visual_builder_config?yr=JSON.parse(ve.visual_builder_config):yr=void 0,E(Hr),D(void 0)}catch(Lr){Ste.error("Error parsing widget config",Lr)}it&&L("source"),st==="text"||st==="markdown"||st==="status"||st==="section"||st==="kpi_manual"||st==="image"?(r(""),h(""),E("sql"),D(void 0),it&&(M(3),L("visual"))):(r(Na),setTimeout(()=>Ot(Na),100),it&&(M(3),L("visual"))),B(Ct({currentSql:st==="text"||st==="markdown"||st==="status"||st==="section"||st==="kpi_manual"||st==="image"?"":Na,currentBuilderMode:Hr,currentQueryConfig:st==="text"||st==="markdown"||st==="status"||st==="section"||st==="kpi_manual"||st==="image"?void 0:yr,currentVisType:st,currentVisConfig:St,currentWidgetName:ve.name,currentActiveWidgetId:ve.id}))},er=async(ve="update")=>{if(!je||pt)return;const it=ve==="new";let St=it?crypto.randomUUID():le||crypto.randomUUID();const st=je.trim(),Hr=st.toLowerCase(),yr=(nt||[]).find(wa=>wa.id!==St&&wa.name.trim().toLowerCase()===Hr);if(yr){if(!await Qt.confirm(e("querybuilder.confirm_overwrite_widget_name",{name:st,defaultValue:`Ein Widget mit dem Namen "${st}" existiert bereits. Ueberschreiben?`})))return;St=yr.id}try{const wa=(It||[]).find(Ia=>Ia.id===Y),Na=Xt?"":t.trim(),Gn=!Xt&&wa&&af(wa.sql_text)===af(Na)?wa.id:null,Lr={id:St,name:st,description:"",sql_statement_id:Gn,sql_query:Na,visualization_config:{...H,type:G},visual_builder_config:null};await jt.saveUserWidget(Lr),Le(!1),Dt(),pe(Lr.id),B(Ct({currentSql:Lr.sql_query,currentBuilderMode:k,currentQueryConfig:void 0,currentVisType:G,currentVisConfig:{...H,type:G},currentWidgetName:Lr.name,currentActiveWidgetId:Lr.id})),M(1),L("source"),R("widget"),w("graphic")}catch(wa){await Qt.error(e("querybuilder.error_save")+(wa instanceof Error?wa.message:String(wa)));return}await Qt.info(e(it?"querybuilder.success_save":"querybuilder.success_update"))},cr=async ve=>{if(pt)return;(!(localStorage.getItem("notifications_confirm_destructive")!=="false")||await Qt.confirm(e("dashboard.confirm_delete_report")))&&(await jt.deleteUserWidget(ve),Dt(),le===ve&&(pe(null),F("")))},Vt=Z.useMemo(()=>a.length===0?[]:Object.keys(a[0]).map(ve=>({header:ve,accessor:ve,render:it=>Ma(it[ve],ve)})),[a]),mt=Z.useMemo(()=>{const ve=nt||[],it=K.trim().toLowerCase();return it?ve.filter(St=>St.name.toLowerCase().includes(it)||(St.sql_query||"").toLowerCase().includes(it)):ve},[nt,K]),Nt=Z.useMemo(()=>{const ve=It||[],it=q.trim().toLowerCase();return it?ve.filter(St=>St.name.toLowerCase().includes(it)||St.sql_text.toLowerCase().includes(it)||(St.description||"").toLowerCase().includes(it)):ve},[It,q]),gt=Z.useMemo(()=>(It||[]).find(ve=>ve.id===Y),[It,Y]),dr=Z.useMemo(()=>!!(gt&&af(gt.sql_text)===af(t)),[gt,t]),Ht=Z.useMemo(()=>a.length>0?Object.keys(a[0]):[],[a]),Rt=Z.useMemo(()=>a.length===0?[]:Ht.filter(ve=>a.some(it=>it[ve]!==null&&it[ve]!==void 0&&typeof it[ve]=="number")),[a,Ht]),$t=G==="text",vr=G==="markdown",vt=G==="status",kr=G==="section",tr=G==="kpi_manual",rr=G==="image",Xt=$t||vr||vt||kr||tr||rr,Kt=H.xAxis||"",Ft=(H.yAxes||[])[0]||"",Zt=Z.useMemo(()=>G!=="scatter"||!Kt||!Ft?[]:a.map(ve=>{const it=Number(ve[Kt]),St=Number(ve[Ft]);return{...ve,[Kt]:it,[Ft]:St}}).filter(ve=>Number.isFinite(ve[Kt])&&Number.isFinite(ve[Ft])),[a,Kt,Ft,G]),wr=U===2&&!Xt?"table":G,Re=!Xt&&t.trim().length>0,Et=wr!=="table"&&wr!=="pivot"&&wr!=="text"&&wr!=="markdown"&&wr!=="status"&&wr!=="section"&&wr!=="kpi_manual"&&wr!=="image",Tt=Xt||a.length>0,Bt=Ye||!Xt&&a.length===0,Yt=!Tt||pt||!Xt&&!dr,Mr=pt?e("common.read_only"):Tt?!Xt&&!dr?e("querybuilder.hint_select_sql_statement_before_save","Bitte ein SQL-Statement aus dem SQL-Manager auswaehlen."):"":e("querybuilder.hint_run_query_before_save"),Jr=Ye?e("common.exporting"):!Xt&&a.length===0?e("querybuilder.hint_run_query_before_export"):"",jr=P==="none"?!0:P==="query"?dr:!!le,fr=Xt||dr,Cr=Xt||a.length>0&&!n&&f.trim()===t.trim(),re=Z.useMemo(()=>{if(!dr)return Xt?vr?!!(H.markdownContent||"").trim():vt?!!((H.statusTitle||"").trim()||(H.statusMessage||"").trim()):kr?!!((H.sectionTitle||"").trim()||(H.sectionSubtitle||"").trim()):tr?!!((H.kpiTitle||"").trim()||(H.kpiValue||"").trim()):rr?!!(H.imageUrl||"").trim():!!(H.textContent||"").trim():!1;if($t)return!!(H.textContent||"").trim();if(vr)return!!(H.markdownContent||"").trim();if(vt)return!!((H.statusTitle||"").trim()||(H.statusMessage||"").trim());if(kr)return!!((H.sectionTitle||"").trim()||(H.sectionSubtitle||"").trim());if(tr)return!!((H.kpiTitle||"").trim()||(H.kpiValue||"").trim());if(rr)return!!(H.imageUrl||"").trim();if(G==="table"||G==="pivot")return!0;const ve=!!H.xAxis,it=!!(H.yAxes&&H.yAxes.length>0);if(!ve||!it)return!1;if(G==="scatter"){const st=Rt.includes(Kt),Hr=Rt.includes(Ft);return st&&Hr&&Zt.length>0}return G==="kpi"?a.length>0:a.some(st=>{const Hr=st[H.xAxis];return Hr==null||Hr===""?!1:(H.yAxes||[]).some(yr=>{const wa=st[yr];return wa!=null&&wa!==""})})},[Xt,rr,tr,vr,kr,vt,$t,G,H,Rt,Zt.length,Kt,Ft,a,dr]),ke=!Xt&&a.length>0&&wr!=="table"&&wr!=="pivot"&&!re,me=P==="none"?Xt&&re?4:3:P==="query"?dr?Cr?re?4:3:2:1:le?Xt||Cr?re?4:3:2:1,be=ve=>Xt&&ve===2?!1:ve<=me,ye=c||(U===1?!jr:U===2?Xt?!1:!fr||!Cr:U===3?!re:Yt),O=U>=4?e("querybuilder.finish"):e("querybuilder.next"),ce=U===2&&!Xt,Fe=c||(U===2?Xt||!fr:U!==3),Ne=e(c?"common.loading":"querybuilder.step_run"),Te=U===1?P==="query"&&!dr?e("querybuilder.hint_select_sql_statement_for_widget","Bitte zuerst ein SQL-Statement im SQL-Manager auswaehlen."):P==="widget"&&!le?e("querybuilder.mode_open_select","Waehle ein bestehendes Widget aus der Liste."):"":U===2?dr?Cr?"":e("querybuilder.hint_run_query_before_continue","Bitte die Abfrage zuerst ausfuehren."):e("querybuilder.hint_select_sql_statement_for_widget","Bitte zuerst ein SQL-Statement im SQL-Manager auswaehlen."):U===3&&!re?e("querybuilder.hint_configure_visualization_before_continue","Bitte Visualisierung konfigurieren, um fortzufahren."):U===4&&Yt?Mr:"",Ue=S,tt=me>=3,_t=me>=4,Ct=Z.useCallback(ve=>JSON.stringify({sql:(ve?.currentSql??t).trim(),builderMode:ve?.currentBuilderMode??k,queryConfig:ve?.currentQueryConfig??T??null,visType:ve?.currentVisType??G,visConfig:ve?.currentVisConfig??H,widgetName:(ve?.currentWidgetName??je).trim(),activeWidgetId:ve?.currentActiveWidgetId??le}),[t,k,T,G,H,je,le]),yt=Z.useMemo(()=>Ct(),[Ct]),Ut=v.length>0&&yt!==v,zt=le?e("querybuilder.mode_widget_edit","Widget aendern"):P==="none"?e("querybuilder.mode_new_text_without_data","Neues Widget erstellen (Text - Ohne Daten)"):e("querybuilder.mode_new_query_widget","Neues Widget erstellen (Abfrage)"),Gr=Z.useCallback(ve=>{de(ve.id),D(void 0),r(ve.sql_text),h(""),s([]),o("")},[D]),Qr=Z.useMemo(()=>{const ve="w-5 h-5";switch(wr){case"table":return{icon:l.jsx(CA,{className:ve}),label:e("querybuilder.table")};case"bar":return{icon:l.jsx(Bh,{className:ve}),label:e("querybuilder.bar")};case"line":return{icon:l.jsx(ck,{className:ve}),label:e("querybuilder.line")};case"text":return{icon:l.jsx(H1,{className:ve}),label:e("querybuilder.text")};case"markdown":return{icon:l.jsx(lf,{className:ve}),label:e("querybuilder.markdown","Markdown")};case"status":return{icon:l.jsx(Cn,{className:ve}),label:e("querybuilder.status","Status")};case"section":return{icon:l.jsx(wn,{className:ve}),label:e("querybuilder.section","Section")};case"kpi_manual":return{icon:l.jsx(zm,{className:ve}),label:e("querybuilder.kpi_manual","KPI Manual")};case"image":return{icon:l.jsx(ff,{className:ve}),label:e("querybuilder.image","Image")};default:return{icon:l.jsx(wn,{className:ve}),label:wr.toUpperCase()}}},[wr,e]),oa=le?je.trim()||e("querybuilder.new_report"):e("querybuilder.preview_new_widget_title","Neues Widget ..."),fs=ve=>{be(ve)&&(M(ve),ve<=2&&L("source"),ve===3&&L("visual"),ve===4&&L("widget"))},Tn=async()=>{if(U===1){if(P==="none"){ne("table"),de(""),r(""),h(""),s([]),o(""),M(3),L("visual");return}if(P==="query"){if(!dr||(ne("table"),!await Ot()))return;M(3),L("visual");return}if(!le)return;if(Xt){M(3),L("visual");return}if(!await Ot())return;M(3),L("visual");return}if(U===2){if(Xt){fs(3);return}if(!fr||!Cr)return;fs(3);return}if(U===3){if(!re)return;fs(4);return}U===4&&!Yt&&Le(!0)},Vn=async()=>{if(U===2){if(Xt||!fr||c)return;await Ot();return}U===3&&x(ve=>ve+1)};return Z.useEffect(()=>{v||B(yt)},[v,yt]),Z.useEffect(()=>{const ve=it=>{Ut&&(it.preventDefault(),it.returnValue="")};return window.addEventListener("beforeunload",ve),()=>window.removeEventListener("beforeunload",ve)},[Ut]),Z.useEffect(()=>{M(ve=>ve>me?me:ve)},[me]),Z.useEffect(()=>{if(G!=="scatter"||Rt.length===0)return;const ve=H.xAxis||"",it=(H.yAxes||[])[0]||"",St=Rt.includes(ve),st=Rt.includes(it);if(St&&st)return;const Hr=St?ve:Rt[0],yr=Rt[1]||Rt[0],wa=st?it:yr;ee(Na=>({...Na,xAxis:Hr,yAxes:wa?[wa]:[]}))},[G,Rt,H.xAxis,H.yAxes]),Z.useEffect(()=>{const ve=it=>{if(!(it.ctrlKey||it.metaKey))return;const st=it.key.toLowerCase();st==="enter"&&(it.preventDefault(),c||Ot()),st==="s"&&(it.preventDefault(),Yt||Le(!0))};return window.addEventListener("keydown",ve),()=>window.removeEventListener("keydown",ve)},[c,Yt,Ot]),l.jsxs(x0,{header:{title:e("sidebar.query_builder"),subtitle:e("querybuilder.subtitle"),actions:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:Ge,className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors border border-transparent hover:border-blue-100",title:e("dashboard.presentation_mode"),children:l.jsx(ix,{className:"w-5 h-5"})}),l.jsxs("button",{onClick:()=>at("query-visualization",`report-${je||"query"}`),disabled:Bt,title:Bt?Jr:e("querybuilder.hint_export_shortcut"),className:"flex items-center gap-2 px-3 py-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-300 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors shadow-sm font-medium text-sm disabled:opacity-50",children:[l.jsx(Jx,{className:"w-4 h-4"}),e(Ye?"common.exporting":"common.export_pdf")]})]})},children:[l.jsx("div",{className:"flex flex-col gap-6 h-full min-h-0",children:l.jsxs("div",{className:"flex-1 flex flex-col lg:flex-row gap-4 lg:gap-6 min-h-0 overflow-hidden relative",children:[l.jsx("div",{className:`${Q?"hidden":"w-full lg:w-96"} min-h-0 overflow-hidden transition-all duration-300`,children:l.jsxs("div",{className:"flex flex-col h-full max-h-[46vh] lg:max-h-none bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm overflow-hidden",children:[l.jsx("div",{className:"border-b border-slate-100 dark:border-slate-800 bg-slate-50/50 dark:bg-slate-900/50",children:l.jsx("div",{className:"p-3",children:l.jsx("h3",{className:"text-[10px] font-black text-slate-400 uppercase tracking-wider px-1",children:e("querybuilder.guided_panel")})})}),l.jsx("div",{className:"px-3 py-2 border-b border-slate-100 dark:border-slate-800 bg-white dark:bg-slate-900",children:l.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[l.jsxs("button",{type:"button",onClick:()=>{L("source"),M(1)},className:`px-2 py-1.5 rounded text-[10px] font-bold border transition-colors flex items-center justify-center gap-1 ${Ue==="source"?"bg-blue-50 text-blue-700 border-blue-200 dark:bg-blue-900/30 dark:text-blue-200 dark:border-blue-700":"bg-white dark:bg-slate-900 text-slate-500 dark:text-slate-300 border-slate-200 dark:border-slate-700"}`,children:[l.jsx(Zo,{className:"w-3 h-3"}),e("querybuilder.tab_source","Quelle")]}),l.jsxs("button",{type:"button",onClick:()=>tt&&L("visual"),disabled:!tt,className:`px-2 py-1.5 rounded text-[10px] font-bold border transition-colors flex items-center justify-center gap-1 ${Ue==="visual"?"bg-blue-50 text-blue-700 border-blue-200 dark:bg-blue-900/30 dark:text-blue-200 dark:border-blue-700":"bg-white dark:bg-slate-900 text-slate-500 dark:text-slate-300 border-slate-200 dark:border-slate-700"} disabled:opacity-40`,children:[l.jsx(Bh,{className:"w-3 h-3"}),e("querybuilder.tab_visualization","Visualisierung")]}),l.jsxs("button",{type:"button",onClick:()=>_t&&L("widget"),disabled:!_t,className:`px-2 py-1.5 rounded text-[10px] font-bold border transition-colors flex items-center justify-center gap-1 ${Ue==="widget"?"bg-blue-50 text-blue-700 border-blue-200 dark:bg-blue-900/30 dark:text-blue-200 dark:border-blue-700":"bg-white dark:bg-slate-900 text-slate-500 dark:text-slate-300 border-slate-200 dark:border-slate-700"} disabled:opacity-40`,children:[l.jsx(uk,{className:"w-3 h-3"}),e("querybuilder.tab_widget","Widget")]})]})}),l.jsx("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar space-y-4",children:Ue==="source"?l.jsxs("div",{className:"space-y-4",children:[U===1&&l.jsxs("div",{className:"rounded-xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950/30 overflow-hidden",children:[l.jsx("div",{className:"px-3 py-2 border-b border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900/40",children:l.jsxs("div",{className:"inline-flex items-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 p-1",children:[l.jsx("button",{type:"button",onClick:()=>{R("none"),pe(null),F(""),de(""),r(""),h(""),s([]),o(""),ne("table")},className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${P==="none"?"bg-blue-600 text-white":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:e("querybuilder.source_tab_none","Kein")}),l.jsx("button",{type:"button",onClick:()=>{R("query"),pe(null),F(""),de(""),r(""),h(""),s([]),o(""),ne("table")},className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${P==="query"?"bg-blue-600 text-white":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:e("querybuilder.source_tab_query","Abfrage auswaehlen")}),l.jsx("button",{type:"button",onClick:()=>{R("widget")},className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${P==="widget"?"bg-blue-600 text-white":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:e("querybuilder.source_tab_widget","Widget auswaehlen")})]})}),l.jsx("div",{className:"p-3",children:P==="none"?l.jsx("div",{className:"p-3 rounded-lg border border-dashed border-slate-200 dark:border-slate-700 text-[11px] text-slate-500 dark:text-slate-300",children:e("querybuilder.source_tab_none_hint","Ohne Datenabfrage oder Widget mit Weiter zum naechsten Schritt gehen.")}):P==="query"?l.jsxs("div",{className:"space-y-2 animate-in fade-in duration-300",children:[l.jsxs("h3",{className:"text-[10px] font-black uppercase text-slate-400 px-2 py-1 flex items-center justify-between",children:[e("querybuilder.sql_manager_source","SQL Manager Source"),l.jsxs("span",{className:"bg-slate-100 dark:bg-slate-800 px-1.5 py-0.5 rounded text-[9px]",children:[Nt.length,"/",It?.length||0]})]}),l.jsxs("div",{className:"relative",children:[l.jsx(Zo,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-slate-400"}),l.jsx("input",{value:q,onChange:ve=>J(ve.target.value),placeholder:e("querybuilder.search_sql_statements","Search SQL statements..."),className:"w-full pl-8 pr-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 text-xs text-slate-700 dark:text-slate-200 outline-none focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("div",{className:"space-y-1 max-h-72 overflow-y-auto custom-scrollbar pr-1",children:[Nt.map(ve=>l.jsxs("button",{type:"button",onClick:()=>{if(Y===ve.id){de(""),r(""),h(""),s([]),o(""),ne("table");return}R("query"),pe(null),F(""),Gr(ve),ne("table"),Ot(ve.sql_text)},className:`w-full text-left p-2.5 rounded-lg border transition-all ${Y===ve.id?"bg-blue-50 dark:bg-blue-900/30 border-blue-200 dark:border-blue-700":"bg-white dark:bg-slate-900 border-slate-200 dark:border-slate-800 hover:border-blue-200 dark:hover:border-blue-700"}`,children:[l.jsx("div",{className:"text-xs font-semibold text-slate-700 dark:text-slate-200 truncate",children:ve.name}),l.jsx("div",{className:"text-[10px] text-slate-400 dark:text-slate-500 font-mono truncate",children:ve.sql_text})]},ve.id)),Nt.length===0&&l.jsx("div",{className:"p-3 rounded-lg border border-dashed border-slate-200 dark:border-slate-700 text-[11px] text-slate-400 text-center",children:e("querybuilder.no_sql_statements","No SQL statements found.")})]}),l.jsx("p",{className:"text-[10px] text-slate-500 px-1",children:e("querybuilder.new_without_query_hint","Ohne Auswahl und mit Klick auf Weiter wird ein neues Text-Widget ohne Datenabfrage erstellt.")})]}):l.jsxs("div",{className:"space-y-2 animate-in fade-in duration-300",children:[l.jsxs("h3",{className:"text-[10px] font-black uppercase text-slate-400 px-2 py-1 flex items-center justify-between",children:[e("querybuilder.saved_reports"),l.jsxs("span",{className:"bg-slate-100 dark:bg-slate-800 px-1.5 py-0.5 rounded text-[9px]",children:[mt.length,"/",nt?.length||0]})]}),l.jsxs("div",{className:"relative",children:[l.jsx(Zo,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-slate-400"}),l.jsx("input",{value:K,onChange:ve=>I(ve.target.value),placeholder:e("querybuilder.search_saved_reports","Search saved widgets..."),className:"w-full pl-8 pr-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 text-xs text-slate-700 dark:text-slate-200 outline-none focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("div",{className:"space-y-1 max-h-72 overflow-y-auto custom-scrollbar pr-1",children:[mt.map(ve=>l.jsxs("div",{className:`group p-2.5 rounded-lg border flex flex-col gap-1 transition-all cursor-pointer ${le===ve.id?"bg-blue-50 border-blue-200 ring-1 ring-blue-100":"bg-white dark:bg-slate-900 border-slate-200 dark:border-slate-800 hover:border-blue-200"}`,onClick:()=>{if(le===ve.id){pe(null),F(""),de(""),r(""),h(""),s([]),o(""),ne("table"),L("source"),M(1);return}sr(ve,!1)},children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-200 text-xs truncate",children:ve.name}),!pt&&l.jsx("button",{onClick:it=>{it.stopPropagation(),cr(ve.id)},className:"opacity-0 group-hover:opacity-100 p-1 text-slate-400 hover:text-red-500 rounded transition-all",children:l.jsx(ii,{className:"w-3.5 h-3.5"})})]}),l.jsxs("div",{className:"flex items-center gap-2 text-[9px]",children:[l.jsx("span",{className:"text-slate-400 truncate max-w-[150px] font-mono",children:ve.sql_query||"-"}),l.jsx("span",{className:"ml-auto text-blue-400 flex items-center gap-1 font-bold italic",children:(()=>{try{return(JSON.parse(ve.visualization_config).type||"table").toUpperCase()}catch{return"TABLE"}})()})]})]},ve.id)),mt.length===0&&l.jsx("div",{className:"p-3 rounded-lg border border-dashed border-slate-200 text-[11px] text-slate-400 text-center",children:e("querybuilder.no_saved_reports_filtered","No matching widgets found.")})]})]})})]}),U===1?null:l.jsx("div",{className:"space-y-0",children:l.jsxs("div",{className:"rounded-xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950/30 overflow-hidden",children:[l.jsxs("div",{className:"px-3 py-2 border-b border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900/40 flex items-center justify-between",children:[l.jsxs("div",{className:"text-[10px] font-bold uppercase tracking-wide text-slate-600 dark:text-slate-300",children:[l.jsx("span",{className:"font-mono",children:"SQL"})," ",e("querybuilder.direct_editor")]}),l.jsx("span",{className:"text-[10px] text-slate-500",children:e("common.read_only")})]}),l.jsxs("div",{className:"p-3 space-y-2",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400",children:e("querybuilder.sql_query")}),!Xt&&l.jsx("span",{className:"text-[10px] text-slate-500",children:e("querybuilder.widget_studio_sql_locked_hint","SQL-Auswahl erfolgt im Startschritt unter Neu.")})]}),l.jsx("textarea",{value:t,readOnly:!0,className:"w-full font-mono text-xs p-3 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-100 rounded-lg outline-none resize-none cursor-default",style:{height:`${Nte}px`},placeholder:"SELECT * FROM..."})]})]})}),n&&l.jsxs("div",{className:"bg-red-50 text-red-600 text-[10px] p-3 rounded-lg border border-red-100 flex items-start gap-2 font-mono break-all",children:[l.jsx(Cn,{className:"w-3.5 h-3.5 flex-shrink-0 mt-0.5"}),n]})]}):Ue==="visual"?l.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950/30 space-y-4 animate-in slide-in-from-right-4 duration-300",children:[l.jsxs("h3",{className:"text-xs font-black uppercase text-slate-400 flex items-center gap-2",children:[l.jsx(wn,{className:"w-3.5 h-3.5 text-blue-500"}),e("querybuilder.graph_type")]}),l.jsx("div",{className:"grid grid-cols-3 gap-2",children:(dr?[{id:"table",icon:CA,label:e("querybuilder.table")},{id:"bar",icon:Bh,label:e("querybuilder.bar")},{id:"line",icon:ck,label:e("querybuilder.line")},{id:"area",icon:wn,label:e("querybuilder.area")},{id:"pie",icon:wn,label:e("querybuilder.pie")},{id:"kpi",icon:wn,label:e("querybuilder.kpi")},{id:"composed",icon:wn,label:e("querybuilder.composed")},{id:"radar",icon:wn,label:e("querybuilder.radar")},{id:"scatter",icon:wn,label:e("querybuilder.scatter")},{id:"pivot",icon:wn,label:e("querybuilder.pivot")},{id:"text",icon:H1,label:e("querybuilder.text")},{id:"markdown",icon:lf,label:e("querybuilder.markdown","Markdown")},{id:"status",icon:Cn,label:e("querybuilder.status","Status")},{id:"section",icon:wn,label:e("querybuilder.section","Section")},{id:"kpi_manual",icon:zm,label:e("querybuilder.kpi_manual","KPI Manual")},{id:"image",icon:ff,label:e("querybuilder.image","Image")}]:[{id:"text",icon:H1,label:e("querybuilder.text")},{id:"markdown",icon:lf,label:e("querybuilder.markdown","Markdown")},{id:"status",icon:Cn,label:e("querybuilder.status","Status")},{id:"section",icon:wn,label:e("querybuilder.section","Section")},{id:"kpi_manual",icon:zm,label:e("querybuilder.kpi_manual","KPI Manual")},{id:"image",icon:ff,label:e("querybuilder.image","Image")}]).map(ve=>l.jsxs("button",{onClick:()=>ne(ve.id),className:`p-2 rounded-lg flex flex-col items-center justify-center gap-1 border transition-all ${G===ve.id?"bg-blue-50 dark:bg-blue-900/30 border-blue-200 text-blue-600 shadow-sm":"bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 text-slate-400 hover:border-slate-300"}`,children:[l.jsx(ve.icon,{className:"w-4 h-4"}),l.jsx("span",{className:"text-[9px] uppercase font-black",children:ve.label})]},ve.id))}),!dr&&l.jsx("p",{className:"text-[10px] text-slate-500",children:e("querybuilder.visual_text_only_hint","Ohne ausgewaehlte Abfrage sind nur Text-, Markdown-, Status-, Section-, KPI-Manual- oder Image-Widgets verfuegbar.")}),G!=="table"&&G!=="pivot"&&G!=="text"&&G!=="markdown"&&G!=="status"&&G!=="section"&&G!=="kpi_manual"&&G!=="image"&&l.jsxs("div",{className:"flex items-center justify-between rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[l.jsxs("span",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:[e("querybuilder.labels"),":"]}),l.jsx("button",{onClick:()=>ee({...H,showLabels:!H.showLabels}),className:`px-2 py-0.5 rounded text-[10px] font-black uppercase transition-all ${H.showLabels?"bg-blue-600 text-white":"bg-slate-200 text-slate-500"}`,children:H.showLabels?e("querybuilder.label_on"):e("querybuilder.label_off")})]}),Et&&a.length>0&&l.jsxs("div",{className:"space-y-4 pt-4 border-t border-slate-100 dark:border-slate-800 animate-in slide-in-from-top-2 duration-300",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.x_axis")}),l.jsxs("select",{value:H.xAxis||"",onChange:ve=>ee({...H,xAxis:ve.target.value}),className:"w-full p-2 border border-slate-200 dark:border-slate-700 rounded text-[11px] bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-100 outline-none",children:[l.jsx("option",{value:"",children:e("querybuilder.select_column")}),(G==="scatter"?Rt:Ht).map(ve=>l.jsx("option",{value:ve,children:ve},ve))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.y_axes")}),l.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:(H.yAxes||[]).map(ve=>l.jsxs("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 rounded text-[10px] font-bold flex items-center gap-1",children:[ve,l.jsx("button",{onClick:()=>ee({...H,yAxes:(H.yAxes||[]).filter(it=>it!==ve)}),children:l.jsx(vl,{className:"w-2.5 h-2.5"})})]},ve))}),l.jsxs("select",{onChange:ve=>{ve.target.value&&(ee({...H,yAxes:[...H.yAxes||[],ve.target.value]}),ve.target.value="")},className:"w-full p-2 border border-slate-200 dark:border-slate-700 rounded text-[11px] bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-100 outline-none",children:[l.jsx("option",{value:"",children:e("querybuilder.add_y_axis")}),(G==="scatter"?Rt:Ht).filter(ve=>!(H.yAxes||[]).includes(ve)).map(ve=>l.jsx("option",{value:ve,children:ve},ve))]})]})]}),G==="text"&&l.jsxs("div",{className:"space-y-4 pt-4 border-t border-slate-100 dark:border-slate-800 animate-in slide-in-from-top-2 duration-300",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.text_content")}),l.jsx("textarea",{value:H.textContent||"",onChange:ve=>ee({...H,textContent:ve.target.value}),className:"w-full h-32 p-2 border border-slate-200 dark:border-slate-700 rounded text-[11px] bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-100 outline-none resize-y",placeholder:e("querybuilder.text_placeholder")})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.text_size")}),l.jsxs("select",{value:H.textSize||"md",onChange:ve=>ee({...H,textSize:ve.target.value}),className:"w-full p-2 border border-slate-200 dark:border-slate-700 rounded text-[11px] bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-100 outline-none",children:[l.jsx("option",{value:"sm",children:e("querybuilder.text_size_sm")}),l.jsx("option",{value:"md",children:e("querybuilder.text_size_md")}),l.jsx("option",{value:"lg",children:e("querybuilder.text_size_lg")}),l.jsx("option",{value:"xl",children:e("querybuilder.text_size_xl")}),l.jsx("option",{value:"2xl",children:e("querybuilder.text_size_2xl")})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.text_align")}),l.jsxs("select",{value:H.textAlign||"left",onChange:ve=>ee({...H,textAlign:ve.target.value}),className:"w-full p-2 border border-slate-200 dark:border-slate-700 rounded text-[11px] bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-100 outline-none",children:[l.jsx("option",{value:"left",children:e("querybuilder.text_align_left")}),l.jsx("option",{value:"center",children:e("querybuilder.text_align_center")}),l.jsx("option",{value:"right",children:e("querybuilder.text_align_right")})]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.text_style")}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>ee({...H,textBold:!H.textBold}),className:`px-2 py-1 rounded border text-[11px] font-bold ${H.textBold?"bg-blue-50 dark:bg-blue-900/30 border-blue-200 dark:border-blue-700 text-blue-700 dark:text-blue-200":"bg-white dark:bg-slate-900 border-slate-200 dark:border-slate-700 text-slate-500 dark:text-slate-300"}`,children:e("querybuilder.text_bold")}),l.jsx("button",{onClick:()=>ee({...H,textItalic:!H.textItalic}),className:`px-2 py-1 rounded border text-[11px] italic ${H.textItalic?"bg-blue-50 dark:bg-blue-900/30 border-blue-200 dark:border-blue-700 text-blue-700 dark:text-blue-200":"bg-white dark:bg-slate-900 border-slate-200 dark:border-slate-700 text-slate-500 dark:text-slate-300"}`,children:e("querybuilder.text_italic")}),l.jsx("button",{onClick:()=>ee({...H,textUnderline:!H.textUnderline}),className:`px-2 py-1 rounded border text-[11px] underline ${H.textUnderline?"bg-blue-50 dark:bg-blue-900/30 border-blue-200 dark:border-blue-700 text-blue-700 dark:text-blue-200":"bg-white dark:bg-slate-900 border-slate-200 dark:border-slate-700 text-slate-500 dark:text-slate-300"}`,children:e("querybuilder.text_underline")})]})]})]}),G==="markdown"&&l.jsx("div",{className:"space-y-4 pt-4 border-t border-slate-100 dark:border-slate-800 animate-in slide-in-from-top-2 duration-300",children:l.jsxs("div",{children:[l.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.markdown_content","Markdown Inhalt")}),l.jsx("textarea",{value:H.markdownContent||"",onChange:ve=>ee({...H,markdownContent:ve.target.value}),className:"w-full h-36 p-2 border border-slate-200 dark:border-slate-700 rounded text-[11px] bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-100 outline-none resize-y font-mono",placeholder:e("querybuilder.markdown_placeholder",`# Titel
Text mit **Fett** und [Link](https://example.com)`)}),l.jsx("p",{className:"mt-1 text-[10px] text-slate-500",children:e("querybuilder.markdown_help","Unterstuetzt u. a. Ueberschriften, Listen, **Fett**, *Kursiv*, `Code` und Links.")})]})}),G==="status"&&l.jsxs("div",{className:"space-y-4 pt-4 border-t border-slate-100 dark:border-slate-800 animate-in slide-in-from-top-2 duration-300",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.status_level","Status-Level")}),l.jsxs("select",{value:H.statusLevel||"ok",onChange:ve=>ee({...H,statusLevel:ve.target.value}),className:"w-full p-2 border border-slate-200 dark:border-slate-700 rounded text-[11px] bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-100 outline-none",children:[l.jsx("option",{value:"ok",children:e("querybuilder.status_level_ok","OK")}),l.jsx("option",{value:"info",children:e("querybuilder.status_level_info","Info")}),l.jsx("option",{value:"warning",children:e("querybuilder.status_level_warning","Warnung")}),l.jsx("option",{value:"critical",children:e("querybuilder.status_level_critical","Kritisch")})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.status_title","Titel")}),l.jsx("input",{value:H.statusTitle||"",onChange:ve=>ee({...H,statusTitle:ve.target.value}),className:"w-full p-2 border border-slate-200 dark:border-slate-700 rounded text-[11px] bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-100 outline-none",placeholder:e("querybuilder.status_placeholder_title","Systemstatus")})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.status_message","Nachricht")}),l.jsx("textarea",{value:H.statusMessage||"",onChange:ve=>ee({...H,statusMessage:ve.target.value}),className:"w-full h-24 p-2 border border-slate-200 dark:border-slate-700 rounded text-[11px] bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-100 outline-none resize-y",placeholder:e("querybuilder.status_placeholder_message","Alle Kernsysteme laufen stabil.")})]}),l.jsxs("div",{className:"flex items-center justify-between rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900/50 px-3 py-2",children:[l.jsx("span",{className:"text-[10px] font-black text-slate-400 dark:text-slate-300 uppercase tracking-widest",children:e("querybuilder.status_pulse","Signal-Animation")}),l.jsx("button",{type:"button",onClick:()=>ee({...H,statusPulse:!H.statusPulse}),className:`px-2 py-0.5 rounded text-[10px] font-black uppercase transition-all ${H.statusPulse?"bg-blue-600 text-white":"bg-slate-200 dark:bg-slate-700 text-slate-500 dark:text-slate-200"}`,children:H.statusPulse?e("querybuilder.label_on"):e("querybuilder.label_off")})]})]}),G==="section"&&l.jsxs("div",{className:"space-y-4 pt-4 border-t border-slate-100 dark:border-slate-800 animate-in slide-in-from-top-2 duration-300",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.section_title","Ueberschrift")}),l.jsx("input",{value:H.sectionTitle||"",onChange:ve=>ee({...H,sectionTitle:ve.target.value}),className:"w-full p-2 border border-slate-200 dark:border-slate-700 rounded text-[11px] bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-100 outline-none",placeholder:e("querybuilder.section_placeholder_title","Abschnittstitel")})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.section_subtitle","Untertitel")}),l.jsx("input",{value:H.sectionSubtitle||"",onChange:ve=>ee({...H,sectionSubtitle:ve.target.value}),className:"w-full p-2 border border-slate-200 dark:border-slate-700 rounded text-[11px] bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-100 outline-none",placeholder:e("querybuilder.section_placeholder_subtitle","Optionaler Hinweistext")})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.section_align","Ausrichtung")}),l.jsxs("select",{value:H.sectionAlign||"left",onChange:ve=>ee({...H,sectionAlign:ve.target.value}),className:"w-full p-2 border border-slate-200 dark:border-slate-700 rounded text-[11px] bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-100 outline-none",children:[l.jsx("option",{value:"left",children:e("querybuilder.text_align_left")}),l.jsx("option",{value:"center",children:e("querybuilder.text_align_center")}),l.jsx("option",{value:"right",children:e("querybuilder.text_align_right")})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.section_divider","Trennlinie")}),l.jsxs("select",{value:H.sectionDividerStyle||"line",onChange:ve=>ee({...H,sectionDividerStyle:ve.target.value}),className:"w-full p-2 border border-slate-200 dark:border-slate-700 rounded text-[11px] bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-100 outline-none",children:[l.jsx("option",{value:"line",children:e("querybuilder.section_divider_line","Linie")}),l.jsx("option",{value:"double",children:e("querybuilder.section_divider_double","Doppelt")}),l.jsx("option",{value:"none",children:e("querybuilder.section_divider_none","Keine")})]})]})]})]}),G==="kpi_manual"&&l.jsxs("div",{className:"space-y-4 pt-4 border-t border-slate-100 dark:border-slate-800 animate-in slide-in-from-top-2 duration-300",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.kpi_title","Kennzahl-Titel")}),l.jsx("input",{value:H.kpiTitle||"",onChange:ve=>ee({...H,kpiTitle:ve.target.value}),className:"w-full p-2 border border-slate-200 dark:border-slate-700 rounded text-[11px] bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-100 outline-none",placeholder:e("querybuilder.kpi_placeholder_title","z. B. Verfuegbarkeit")})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.kpi_value","Wert")}),l.jsx("input",{value:H.kpiValue||"",onChange:ve=>ee({...H,kpiValue:ve.target.value}),className:"w-full p-2 border border-slate-200 dark:border-slate-700 rounded text-[11px] bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-100 outline-none",placeholder:e("querybuilder.kpi_placeholder_value","99.9")})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.kpi_unit","Einheit")}),l.jsx("input",{value:H.kpiUnit||"",onChange:ve=>ee({...H,kpiUnit:ve.target.value}),className:"w-full p-2 border border-slate-200 dark:border-slate-700 rounded text-[11px] bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-100 outline-none",placeholder:e("querybuilder.kpi_placeholder_unit","%")})]})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.kpi_target","Ziel")}),l.jsx("input",{value:H.kpiTarget||"",onChange:ve=>ee({...H,kpiTarget:ve.target.value}),className:"w-full p-2 border border-slate-200 dark:border-slate-700 rounded text-[11px] bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-100 outline-none",placeholder:e("querybuilder.kpi_placeholder_target","99.5")})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.kpi_trend","Trend")}),l.jsxs("select",{value:H.kpiTrend||"flat",onChange:ve=>ee({...H,kpiTrend:ve.target.value}),className:"w-full p-2 border border-slate-200 dark:border-slate-700 rounded text-[11px] bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-100 outline-none",children:[l.jsx("option",{value:"up",children:e("querybuilder.kpi_trend_up","Steigend")}),l.jsx("option",{value:"flat",children:e("querybuilder.kpi_trend_flat","Stabil")}),l.jsx("option",{value:"down",children:e("querybuilder.kpi_trend_down","Fallend")})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.text_align","Ausrichtung")}),l.jsxs("select",{value:H.kpiAlign||"left",onChange:ve=>ee({...H,kpiAlign:ve.target.value}),className:"w-full p-2 border border-slate-200 dark:border-slate-700 rounded text-[11px] bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-100 outline-none",children:[l.jsx("option",{value:"left",children:e("querybuilder.text_align_left","Links")}),l.jsx("option",{value:"center",children:e("querybuilder.text_align_center","Zentriert")}),l.jsx("option",{value:"right",children:e("querybuilder.text_align_right","Rechts")})]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.kpi_note","Hinweis")}),l.jsx("textarea",{value:H.kpiNote||"",onChange:ve=>ee({...H,kpiNote:ve.target.value}),className:"w-full h-20 p-2 border border-slate-200 dark:border-slate-700 rounded text-[11px] bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-100 outline-none resize-y",placeholder:e("querybuilder.kpi_placeholder_note","Optionaler Kontext zur Kennzahl.")})]})]}),G==="image"&&l.jsxs("div",{className:"space-y-4 pt-4 border-t border-slate-100 dark:border-slate-800 animate-in slide-in-from-top-2 duration-300",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.image_url","Bild-URL")}),l.jsx("input",{value:H.imageUrl||"",onChange:ve=>ee({...H,imageUrl:ve.target.value}),className:"w-full p-2 border border-slate-200 dark:border-slate-700 rounded text-[11px] bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-100 outline-none",placeholder:e("querybuilder.image_placeholder_url","https://...")})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.image_alt","Alternativtext")}),l.jsx("input",{value:H.imageAlt||"",onChange:ve=>ee({...H,imageAlt:ve.target.value}),className:"w-full p-2 border border-slate-200 dark:border-slate-700 rounded text-[11px] bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-100 outline-none",placeholder:e("querybuilder.image_placeholder_alt","Beschreibung fuer Screenreader")})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.image_fit","Darstellung")}),l.jsxs("select",{value:H.imageFit||"contain",onChange:ve=>ee({...H,imageFit:ve.target.value}),className:"w-full p-2 border border-slate-200 dark:border-slate-700 rounded text-[11px] bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-100 outline-none",children:[l.jsx("option",{value:"contain",children:e("querybuilder.image_fit_contain","Einpassen")}),l.jsx("option",{value:"cover",children:e("querybuilder.image_fit_cover","Ausfuellen")})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.text_align","Ausrichtung")}),l.jsxs("select",{value:H.imageAlign||"center",onChange:ve=>ee({...H,imageAlign:ve.target.value}),className:"w-full p-2 border border-slate-200 dark:border-slate-700 rounded text-[11px] bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-100 outline-none",children:[l.jsx("option",{value:"left",children:e("querybuilder.text_align_left","Links")}),l.jsx("option",{value:"center",children:e("querybuilder.text_align_center","Zentriert")}),l.jsx("option",{value:"right",children:e("querybuilder.text_align_right","Rechts")})]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.image_caption","Bildunterschrift")}),l.jsx("input",{value:H.imageCaption||"",onChange:ve=>ee({...H,imageCaption:ve.target.value}),className:"w-full p-2 border border-slate-200 dark:border-slate-700 rounded text-[11px] bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-100 outline-none",placeholder:e("querybuilder.image_placeholder_caption","Optional")})]})]}),G==="pivot"&&a.length>0&&l.jsxs("div",{className:"space-y-4 pt-4 border-t border-slate-100 dark:border-slate-800 animate-in slide-in-from-top-2 duration-300",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.pivot_rows")}),l.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:(H.pivotRows||[]).map(ve=>l.jsxs("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 rounded text-[10px] font-bold flex items-center gap-1",children:[ve,l.jsx("button",{onClick:()=>ee({...H,pivotRows:(H.pivotRows||[]).filter(it=>it!==ve)}),children:l.jsx(vl,{className:"w-2.5 h-2.5"})})]},ve))}),l.jsxs("select",{onChange:ve=>{ve.target.value&&(ee({...H,pivotRows:[...H.pivotRows||[],ve.target.value]}),ve.target.value="")},className:"w-full p-2 border border-slate-200 dark:border-slate-700 rounded text-[11px] bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-100 outline-none",children:[l.jsx("option",{value:"",children:e("querybuilder.pivot_add_row")}),Ht.filter(ve=>!(H.pivotRows||[]).includes(ve)).map(ve=>l.jsx("option",{value:ve,children:ve},ve))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.pivot_cols")}),l.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:(H.pivotCols||[]).map(ve=>l.jsxs("span",{className:"px-2 py-0.5 bg-emerald-100 text-emerald-700 rounded text-[10px] font-bold flex items-center gap-1",children:[ve,l.jsx("button",{onClick:()=>ee({...H,pivotCols:(H.pivotCols||[]).filter(it=>it!==ve)}),children:l.jsx(vl,{className:"w-2.5 h-2.5"})})]},ve))}),l.jsxs("select",{onChange:ve=>{ve.target.value&&(ee({...H,pivotCols:[...H.pivotCols||[],ve.target.value]}),ve.target.value="")},className:"w-full p-2 border border-slate-200 dark:border-slate-700 rounded text-[11px] bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-100 outline-none",children:[l.jsx("option",{value:"",children:e("querybuilder.pivot_add_col")}),Ht.filter(ve=>!(H.pivotCols||[]).includes(ve)).map(ve=>l.jsx("option",{value:ve,children:ve},ve))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-2",children:e("querybuilder.pivot_measures")}),l.jsxs("div",{className:"space-y-2",children:[(H.pivotMeasures||[]).map((ve,it)=>l.jsxs("div",{className:"flex items-center gap-1 bg-slate-50 dark:bg-slate-800/50 p-2 rounded border border-slate-100",children:[l.jsx("span",{className:"text-[10px] font-bold text-slate-600 truncate flex-1",children:ve.field}),l.jsxs("select",{value:ve.agg,onChange:St=>{const st=[...H.pivotMeasures||[]],Hr=St.target.value;st[it]={...ve,agg:Hr},ee({...H,pivotMeasures:st})},className:"bg-transparent text-[10px] font-bold text-blue-600 outline-none",children:[l.jsx("option",{value:"sum",children:e("querybuilder.pivot_agg_sum")}),l.jsx("option",{value:"count",children:e("querybuilder.pivot_agg_count")}),l.jsx("option",{value:"avg",children:e("querybuilder.pivot_agg_avg")}),l.jsx("option",{value:"min",children:e("querybuilder.pivot_agg_min")}),l.jsx("option",{value:"max",children:e("querybuilder.pivot_agg_max")})]}),l.jsx("button",{onClick:()=>ee({...H,pivotMeasures:(H.pivotMeasures||[]).filter((St,st)=>st!==it)}),className:"text-slate-300 hover:text-red-500",children:l.jsx(vl,{className:"w-3"})})]},it)),l.jsxs("select",{onChange:ve=>{ve.target.value&&(ee({...H,pivotMeasures:[...H.pivotMeasures||[],{field:ve.target.value,agg:"sum"}]}),ve.target.value="")},className:"w-full p-2 border border-slate-200 dark:border-slate-700 rounded text-[11px] bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-100 outline-none",children:[l.jsx("option",{value:"",children:e("querybuilder.pivot_add_measure")}),Ht.map(ve=>l.jsx("option",{value:ve,children:ve},ve))]})]})]})]}),G==="kpi"&&a.length>0&&l.jsxs("div",{className:"space-y-4 pt-4 border-t border-slate-100 dark:border-slate-800 animate-in slide-in-from-top-2 duration-300",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h4",{className:"text-[10px] font-black uppercase text-slate-400",children:e("querybuilder.kpi_rules")}),l.jsxs("button",{onClick:()=>ee({...H,rules:[...H.rules||[],{operator:">",value:0,color:"green"}]}),className:"p-1 px-2 bg-blue-50 text-blue-600 rounded text-[9px] font-bold hover:bg-blue-100 transition-colors",children:["+ ",e("querybuilder.add_rule")]})]}),l.jsx("div",{className:"space-y-2",children:(H.rules||[]).map((ve,it)=>l.jsxs("div",{className:"flex items-center gap-1.5 p-2 bg-slate-50 dark:bg-slate-800/50 rounded-lg border border-slate-100 dark:border-slate-800",children:[l.jsxs("select",{value:ve.operator,onChange:St=>{const st=[...H.rules||[]],Hr=St.target.value;st[it]={...ve,operator:Hr},ee({...H,rules:st})},className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded p-1 text-[10px] outline-none",children:[l.jsx("option",{value:">",children:">"}),l.jsx("option",{value:"<",children:"<"}),l.jsx("option",{value:">=",children:">="}),l.jsx("option",{value:"<=",children:"<="}),l.jsx("option",{value:"==",children:"=="})]}),l.jsx("input",{type:"number",value:ve.value,onChange:St=>{const st=[...H.rules||[]];st[it]={...ve,value:Number(St.target.value)},ee({...H,rules:st})},className:"w-16 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded p-1 text-[10px] outline-none"}),l.jsx("div",{className:"flex gap-1",children:["green","yellow","red","blue"].map(St=>l.jsx("button",{onClick:()=>{const st=[...H.rules||[]];st[it]={...ve,color:St},ee({...H,rules:st})},className:`w-4 h-4 rounded-full border-2 ${ve.color===St?"border-slate-400 scale-110":"border-transparent opacity-40 hover:opacity-100"}`,style:{backgroundColor:St==="green"?"#10b981":St==="red"?"#f43f5e":St==="yellow"?"#fbbf24":"#3b82f6"}},St))}),l.jsx("button",{onClick:()=>ee({...H,rules:(H.rules||[]).filter((St,st)=>st!==it)}),className:"ml-auto text-slate-300 hover:text-red-500",children:l.jsx(vl,{className:"w-3.5 h-3.5"})})]},it))})]})]}):l.jsxs("div",{className:"p-4 rounded-xl border border-blue-200 bg-blue-50/60 dark:bg-blue-950/20 space-y-3 animate-in slide-in-from-right-4 duration-300",children:[l.jsx("p",{className:"text-[10px] font-black uppercase tracking-wide text-blue-500",children:e("querybuilder.step_finalize")}),l.jsxs("div",{className:"rounded-lg border border-blue-100 dark:border-blue-900 bg-white dark:bg-slate-900 px-3 py-2",children:[l.jsx("label",{className:"text-[10px] font-black uppercase tracking-wide text-slate-400",children:e("querybuilder.archive_name")}),l.jsx("input",{value:je,onChange:ve=>F(ve.target.value),placeholder:e("querybuilder.archive_placeholder"),className:"mt-1 w-full bg-transparent border border-slate-200 dark:border-slate-700 rounded-md px-2 py-1.5 text-xs font-semibold text-slate-800 dark:text-slate-100 outline-none focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("div",{className:"space-y-2 text-[11px]",children:[l.jsxs("div",{className:"rounded-lg border border-blue-100 dark:border-blue-900 bg-white dark:bg-slate-900 px-3 py-2",children:[l.jsx("div",{className:"text-[10px] font-black uppercase tracking-wide text-slate-400",children:e("querybuilder.finalize_mode")}),l.jsx("div",{className:"mt-1 text-slate-700 dark:text-slate-200",children:zt})]}),l.jsxs("div",{className:"rounded-lg border border-blue-100 dark:border-blue-900 bg-white dark:bg-slate-900 px-3 py-2",children:[l.jsx("div",{className:"text-[10px] font-black uppercase tracking-wide text-slate-400",children:e("querybuilder.finalize_source")}),l.jsx("div",{className:"mt-1 text-slate-700 dark:text-slate-200",children:Xt?vr?e("querybuilder.new_markdown_card_type","MARKDOWN"):vt?e("querybuilder.new_status_card_type","STATUS"):kr?e("querybuilder.new_section_card_type","SECTION"):tr?e("querybuilder.new_kpi_manual_card_type","KPI MANUAL"):rr?e("querybuilder.new_image_card_type","IMAGE"):e("querybuilder.new_text_card_type"):e("querybuilder.sql_manager_source","SQL Manager Source")})]}),l.jsxs("div",{className:"rounded-lg border border-blue-100 dark:border-blue-900 bg-white dark:bg-slate-900 px-3 py-2",children:[l.jsx("div",{className:"text-[10px] font-black uppercase tracking-wide text-slate-400",children:e("querybuilder.finalize_chart")}),l.jsx("div",{className:"mt-1 text-slate-700 dark:text-slate-200 font-semibold",children:Qr.label}),!Xt&&l.jsx("div",{className:"mt-1 text-[10px] text-slate-500",children:e("querybuilder.finalize_axes",{x:H.xAxis||"-",count:(H.yAxes||[]).length})}),Xt&&l.jsx("div",{className:"mt-1 text-[10px] text-slate-500",children:vt?e("querybuilder.finalize_status_level",{level:e(`querybuilder.status_level_${H.statusLevel||"ok"}`,H.statusLevel||"ok")}):kr?e("querybuilder.finalize_section_style",{style:e(`querybuilder.section_divider_${H.sectionDividerStyle||"line"}`,H.sectionDividerStyle||"line")}):tr?e("querybuilder.finalize_kpi_target",{target:H.kpiTarget||"-"}):rr?e("querybuilder.finalize_image_url",{url:(H.imageUrl||"").trim()?"OK":"-"}):e("querybuilder.finalize_text_length",{count:vr?(H.markdownContent||"").trim().length:(H.textContent||"").trim().length})})]}),l.jsxs("div",{className:"rounded-lg border border-blue-100 dark:border-blue-900 bg-white dark:bg-slate-900 px-3 py-2",children:[l.jsx("div",{className:"text-[10px] font-black uppercase tracking-wide text-slate-400",children:e("querybuilder.preview",{count:a.length})}),l.jsx("div",{className:`mt-1 text-[11px] font-semibold ${ke?"text-amber-700":"text-emerald-700"}`,children:e(ke?"querybuilder.preview_not_renderable_title":"querybuilder.finalize_ready")})]})]}),Yt&&Mr&&l.jsx("p",{className:"text-[10px] text-amber-700",children:Mr})]})}),l.jsxs("div",{className:"sticky bottom-0 z-20 border-t border-slate-200 dark:border-slate-700 bg-white/95 dark:bg-slate-900/95 backdrop-blur px-4 py-3 shadow-[0_-6px_18px_-14px_rgba(15,23,42,0.5)]",children:[l.jsx("div",{className:"flex items-center justify-center gap-3",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>{const ve=U===3?1:Math.max(1,U-1);fs(ve)},disabled:U<=1,className:"px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 text-xs font-bold text-slate-500 dark:text-slate-300 disabled:opacity-40",children:e("querybuilder.back")}),ce&&l.jsx("button",{onClick:()=>{Vn()},disabled:Fe,className:"px-4 py-2 rounded-lg border border-blue-200 dark:border-blue-700 bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-200 text-xs font-bold disabled:opacity-40",children:Ne}),l.jsx("button",{onClick:()=>{Tn()},disabled:ye,className:"px-4 py-2 rounded-lg bg-blue-600 text-white text-xs font-bold shadow-sm disabled:opacity-40",children:O})]})}),ye&&Te&&l.jsx("p",{className:"mt-2 text-center text-[10px] text-amber-700",children:Te})]})]})}),l.jsxs("div",{id:"query-visualization",className:"flex-1 min-w-0 bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm overflow-hidden flex flex-col h-full min-h-[320px] sm:min-h-[380px] lg:min-h-[460px] relative",children:[l.jsxs("div",{className:"border-b border-slate-100 dark:border-slate-800 bg-slate-50/50 dark:bg-slate-900/50",children:[l.jsxs("div",{className:"p-3 flex items-center justify-between gap-2",children:[l.jsx("h3",{className:"text-[10px] font-black text-slate-400 uppercase tracking-wider",children:e("querybuilder.preview_panel_title","Vorschau")}),l.jsx("p",{className:"text-[10px] text-slate-500 dark:text-slate-400 truncate",children:oa})]}),l.jsx("div",{className:"px-3 pb-2 border-t border-slate-100 dark:border-slate-800",children:l.jsxs("div",{className:"pt-2 flex items-center justify-between gap-2",children:[l.jsxs("div",{className:"inline-flex items-center gap-1",children:[l.jsxs("button",{type:"button",onClick:()=>w("graphic"),className:`px-2 py-1.5 rounded text-[10px] font-bold border transition-colors flex items-center justify-center gap-1 ${m==="graphic"?"bg-blue-50 text-blue-700 border-blue-200 dark:bg-blue-900/30 dark:text-blue-200 dark:border-blue-700":"bg-white dark:bg-slate-900 text-slate-500 dark:text-slate-300 border-slate-200 dark:border-slate-700"}`,children:[l.jsx(Bh,{className:"w-3 h-3"}),e("querybuilder.preview_tab_graphic","Grafisch")]}),l.jsxs("button",{type:"button",onClick:()=>{Xt||w("table")},disabled:Xt,className:`px-2 py-1.5 rounded text-[10px] font-bold border transition-colors flex items-center justify-center gap-1 ${m==="table"?"bg-blue-50 text-blue-700 border-blue-200 dark:bg-blue-900/30 dark:text-blue-200 dark:border-blue-700":"bg-white dark:bg-slate-900 text-slate-500 dark:text-slate-300 border-slate-200 dark:border-slate-700"} disabled:opacity-40 disabled:cursor-not-allowed`,children:[l.jsx(CA,{className:"w-3 h-3"}),e("querybuilder.preview_tab_table","Tabelle")]}),l.jsxs("button",{type:"button",onClick:()=>{Xt||w("sql")},disabled:Xt,className:`px-2 py-1.5 rounded text-[10px] font-bold border transition-colors flex items-center justify-center gap-1 ${m==="sql"?"bg-blue-50 text-blue-700 border-blue-200 dark:bg-blue-900/30 dark:text-blue-200 dark:border-blue-700":"bg-white dark:bg-slate-900 text-slate-500 dark:text-slate-300 border-slate-200 dark:border-slate-700"} disabled:opacity-40 disabled:cursor-not-allowed`,children:[l.jsx(lf,{className:"w-3 h-3"}),e("querybuilder.preview_tab_sql","SQL")]})]}),l.jsxs("button",{onClick:()=>V(!Q),className:"px-2 py-1.5 rounded text-[10px] font-bold border bg-white dark:bg-slate-900 text-slate-500 dark:text-slate-300 border-slate-200 dark:border-slate-700 hover:text-slate-700 dark:hover:text-slate-100 transition-colors flex items-center justify-center gap-1",children:[Q?l.jsx(y2,{className:"w-3 h-3"}):l.jsx(ix,{className:"w-3 h-3"}),l.jsx("span",{children:e(Q?"querybuilder.centered":"querybuilder.focus")})]})]})})]}),l.jsx("div",{className:"flex-1 overflow-auto p-4 min-h-0 container-scrollbar",children:m==="graphic"?$t?l.jsx("div",{className:`h-full min-h-[260px] p-6 whitespace-pre-wrap break-words text-slate-800 dark:text-slate-100 ${H.textSize==="sm"?"text-sm":H.textSize==="lg"?"text-lg":H.textSize==="xl"?"text-xl":H.textSize==="2xl"?"text-2xl":"text-base"} ${H.textBold?"font-bold":"font-normal"} ${H.textItalic?"italic":"not-italic"} ${H.textUnderline?"underline":"no-underline"} ${H.textAlign==="center"?"text-center":H.textAlign==="right"?"text-right":"text-left"}`,children:(H.textContent||"").trim()||e("querybuilder.text_placeholder")}):vr?l.jsx("div",{className:"h-full min-h-[260px] p-6 text-slate-800 dark:text-slate-100",children:l.jsx(e6,{markdown:(H.markdownContent||"").trim(),emptyText:e("querybuilder.markdown_placeholder",`# Titel
Text mit **Fett** und [Link](https://example.com)`),className:"text-sm leading-6"})}):vt?l.jsx("div",{className:"h-full min-h-[260px] p-6 flex items-center justify-center",children:(()=>{const ve=H.statusLevel||"ok",St={ok:{ring:"ring-emerald-200 bg-emerald-50 dark:bg-emerald-900/20",dot:"bg-emerald-500",title:"text-emerald-800 dark:text-emerald-300",text:"text-emerald-700/90 dark:text-emerald-200/90"},info:{ring:"ring-blue-200 bg-blue-50 dark:bg-blue-900/20",dot:"bg-blue-500",title:"text-blue-800 dark:text-blue-300",text:"text-blue-700/90 dark:text-blue-200/90"},warning:{ring:"ring-amber-200 bg-amber-50 dark:bg-amber-900/20",dot:"bg-amber-500",title:"text-amber-800 dark:text-amber-300",text:"text-amber-700/90 dark:text-amber-200/90"},critical:{ring:"ring-rose-200 bg-rose-50 dark:bg-rose-900/20",dot:"bg-rose-500",title:"text-rose-800 dark:text-rose-300",text:"text-rose-700/90 dark:text-rose-200/90"}}[ve];return l.jsxs("div",{className:`w-full max-w-xl rounded-xl ring-1 ${St.ring} p-5`,children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:`relative inline-flex h-3.5 w-3.5 rounded-full ${St.dot}`,children:H.statusPulse&&l.jsx("span",{className:`absolute inline-flex h-full w-full rounded-full ${St.dot} opacity-75 animate-ping`})}),l.jsx("span",{className:`text-[11px] font-black uppercase tracking-wider ${St.title}`,children:e(`querybuilder.status_level_${ve}`,ve)})]}),l.jsx("div",{className:`mt-3 text-lg font-bold ${St.title}`,children:(H.statusTitle||"").trim()||e("querybuilder.status_placeholder_title","Systemstatus")}),l.jsx("p",{className:`mt-2 text-sm ${St.text}`,children:(H.statusMessage||"").trim()||e("querybuilder.status_placeholder_message","Alle Kernsysteme laufen stabil.")})]})})()}):kr?l.jsx("div",{className:"h-full min-h-[260px] p-6 flex flex-col justify-center",children:(()=>{const ve=H.sectionAlign||"left",it=ve==="center"?"text-center":ve==="right"?"text-right":"text-left",St=H.sectionDividerStyle||"line";return l.jsxs("div",{className:`w-full ${it}`,children:[l.jsx("h2",{className:"text-2xl font-black tracking-tight text-slate-800 dark:text-slate-100",children:(H.sectionTitle||"").trim()||e("querybuilder.section_placeholder_title","Abschnittstitel")}),(H.sectionSubtitle||"").trim()&&l.jsx("p",{className:"mt-1 text-sm text-slate-500 dark:text-slate-400",children:H.sectionSubtitle}),St==="line"&&l.jsx("div",{className:`mt-4 h-px bg-slate-300 dark:bg-slate-700 ${ve==="center"?"mx-auto w-2/3":ve==="right"?"ml-auto w-2/3":"w-2/3"}`}),St==="double"&&l.jsxs("div",{className:`mt-4 space-y-1 ${ve==="center"?"mx-auto w-2/3":ve==="right"?"ml-auto w-2/3":"w-2/3"}`,children:[l.jsx("div",{className:"h-px bg-slate-300 dark:bg-slate-700"}),l.jsx("div",{className:"h-px bg-slate-300 dark:bg-slate-700"})]})]})})()}):tr?l.jsx("div",{className:"h-full min-h-[260px] p-6 flex items-center justify-center",children:(()=>{const ve=H.kpiTrend||"flat",it=no=>{if(!no)return Number.NaN;const Ln=no.replace(/\s+/g,"").replace(",",".").replace(/[^0-9.+-]/g,"");return Number(Ln)},St=it(H.kpiValue),st=it(H.kpiTarget),Hr=H.kpiAlign||"left",yr=Hr==="center"?"text-center":Hr==="right"?"text-right":"text-left",wa=Hr==="center"?"justify-center":Hr==="right"?"justify-end":"justify-start",Na=Number.isFinite(St)&&Number.isFinite(st)&&st!==0,Gn=Na?St/st:Number.NaN,Lr=Na?Gn>=1?"ok":Gn>=.95?"warn":"crit":"neutral",Ia=ve==="up"?"text-emerald-700 dark:text-emerald-300 bg-emerald-50 dark:bg-emerald-900/20":ve==="down"?"text-rose-700 dark:text-rose-300 bg-rose-50 dark:bg-rose-900/20":"text-slate-700 dark:text-slate-300 bg-slate-100 dark:bg-slate-700/40",hs=Lr==="ok"?"text-emerald-700 dark:text-emerald-300 bg-emerald-50 dark:bg-emerald-900/20 border-emerald-200 dark:border-emerald-800":Lr==="warn"?"text-amber-700 dark:text-amber-300 bg-amber-50 dark:bg-amber-900/20 border-amber-200 dark:border-amber-800":Lr==="crit"?"text-rose-700 dark:text-rose-300 bg-rose-50 dark:bg-rose-900/20 border-rose-200 dark:border-rose-800":"text-slate-600 dark:text-slate-300 bg-slate-100 dark:bg-slate-700/40 border-slate-200 dark:border-slate-700",ls=Lr==="ok"?"text-emerald-700 dark:text-emerald-300":Lr==="warn"?"text-amber-700 dark:text-amber-300":Lr==="crit"?"text-rose-700 dark:text-rose-300":"text-slate-900 dark:text-slate-100";return l.jsxs("div",{className:`w-full max-w-xl rounded-xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 p-5 ${yr}`,children:[l.jsx("div",{className:"text-[10px] font-black uppercase tracking-wider text-slate-400",children:(H.kpiTitle||"").trim()||e("querybuilder.kpi_placeholder_title","Kennzahl")}),l.jsxs("div",{className:`mt-3 flex items-end gap-2 ${wa}`,children:[l.jsx("div",{className:`text-4xl font-black tracking-tight ${ls}`,children:(H.kpiValue||"").trim()||"--"}),(H.kpiUnit||"").trim()&&l.jsx("div",{className:"pb-1 text-sm font-bold text-slate-500 dark:text-slate-400",children:H.kpiUnit})]}),l.jsxs("div",{className:`mt-3 flex flex-wrap items-center gap-2 ${wa}`,children:[l.jsxs("span",{className:"px-2 py-1 rounded-full text-[10px] font-black uppercase tracking-wide bg-blue-50 text-blue-700 dark:bg-blue-900/20 dark:text-blue-300",children:[e("querybuilder.kpi_target","Ziel"),": ",(H.kpiTarget||"").trim()||"-"]}),l.jsx("span",{className:`px-2 py-1 rounded-full text-[10px] font-black uppercase tracking-wide ${Ia}`,children:e(`querybuilder.kpi_trend_${ve}`,ve)}),l.jsx("span",{className:`px-2 py-1 rounded-full border text-[10px] font-black uppercase tracking-wide ${hs}`,children:Lr==="ok"?e("querybuilder.kpi_status_on_target","Im Ziel"):Lr==="warn"?e("querybuilder.kpi_status_near_target","Nahe am Ziel"):Lr==="crit"?e("querybuilder.kpi_status_below_target","Unter Ziel"):e("querybuilder.kpi_status_no_compare","Kein Zielvergleich")})]}),(H.kpiNote||"").trim()&&l.jsx("p",{className:"mt-3 text-xs text-slate-500 dark:text-slate-400",children:H.kpiNote})]})})()}):rr?l.jsx("div",{className:"h-full min-h-[260px] p-6 flex items-center justify-center",children:(()=>{const ve=H.imageAlign||"center",it=ve==="left"?"items-start":ve==="right"?"items-end":"items-center";return l.jsx("div",{className:`w-full h-full flex flex-col ${it} justify-center`,children:(H.imageUrl||"").trim()&&!ue?l.jsxs(l.Fragment,{children:[l.jsx("img",{src:(H.imageUrl||"").trim(),alt:(H.imageAlt||"").trim()||"Preview image",referrerPolicy:"no-referrer",crossOrigin:"anonymous",onError:()=>we(!0),className:`max-h-[320px] w-full rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 ${H.imageFit==="cover"?"object-cover":"object-contain"}`}),(H.imageCaption||"").trim()&&l.jsx("p",{className:"mt-2 text-xs text-slate-500 dark:text-slate-400",children:H.imageCaption})]}):(H.imageUrl||"").trim()?l.jsx("div",{className:"w-full rounded-lg border border-amber-300 bg-amber-50 dark:bg-amber-900/20 dark:border-amber-700 p-3 text-amber-900 dark:text-amber-200",children:l.jsxs("div",{className:"flex items-start gap-2",children:[l.jsx(Cn,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),l.jsxs("div",{className:"min-w-0",children:[l.jsx("p",{className:"text-xs font-bold",children:e("querybuilder.image_load_error_title","Bild konnte nicht geladen werden.")}),l.jsx("p",{className:"text-[11px] mt-1",children:e("querybuilder.image_load_error_hint","Bitte URL, Zugriff und CORS/Hotlink-Schutz pruefen.")}),l.jsx("p",{className:"text-[10px] mt-1 font-mono break-all opacity-80",children:(H.imageUrl||"").trim()})]})]})}):l.jsxs("div",{className:"h-[220px] w-full rounded-lg border border-dashed border-slate-300 dark:border-slate-700 flex flex-col items-center justify-center text-slate-400",children:[l.jsx(ff,{className:"w-8 h-8 mb-2 opacity-60"}),l.jsx("p",{className:"text-xs font-semibold text-center",children:e("querybuilder.image_empty_hint","Bitte eine Bild-URL hinterlegen.")})]})})})()}):Re?a.length===0?l.jsxs("div",{className:"h-full min-h-[260px] flex flex-col items-center justify-center text-slate-300",children:[l.jsx(Q0,{className:"w-12 h-12 mb-4 opacity-10"}),l.jsx("p",{className:"text-xs font-black uppercase tracking-widest text-center whitespace-pre-wrap",children:e("querybuilder.no_data_prompt")})]}):wr==="table"?l.jsx(Tx,{columns:Vt,data:a,onRowClick:ve=>{He(a.indexOf(ve)),Ae(!0)}}):wr==="pivot"?l.jsx(p2,{data:a,rows:H.pivotRows||[],cols:H.pivotCols||[],measures:H.pivotMeasures||[]}):Et?l.jsx("div",{className:"h-full min-h-[260px] w-full flex flex-col",children:ke?l.jsx("div",{className:"flex-1 flex items-center justify-center p-6",children:l.jsx("div",{className:"max-w-md w-full rounded-xl border border-amber-200 bg-amber-50 text-amber-900 px-4 py-4",children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx("div",{className:"mt-0.5 text-amber-600",children:Qr.icon}),l.jsxs("div",{className:"min-w-0",children:[l.jsx("div",{className:"text-xs font-black uppercase tracking-wide text-amber-700",children:Qr.label}),l.jsx("p",{className:"text-sm font-bold mt-1",children:e("querybuilder.preview_not_renderable_title")}),l.jsx("p",{className:"text-xs text-amber-800/90 mt-1",children:e("querybuilder.preview_not_renderable_hint")})]})]})})}):wr==="kpi"?(()=>{const ve=a[0][Object.keys(a[0])[0]],it=Number(ve);let St="text-slate-900 dark:text-white";if(H.rules&&!isNaN(it))for(const st of H.rules){let Hr=!1;switch(st.operator){case">":Hr=it>st.value;break;case"<":Hr=it<st.value;break;case">=":Hr=it>=st.value;break;case"<=":Hr=it<=st.value;break;case"==":Hr=it===st.value;break}if(Hr){st.color==="green"?St="text-emerald-500":st.color==="red"?St="text-rose-500":st.color==="yellow"?St="text-amber-500":st.color==="blue"&&(St="text-blue-500");break}}return l.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-8 animate-in zoom-in-95 duration-500",children:[l.jsx("div",{className:`text-6xl lg:text-8xl font-black tracking-widest break-all transition-colors duration-300 ${St}`,children:Ma(ve,Object.keys(a[0])[0])}),l.jsx("div",{className:"text-xs font-bold text-slate-400 mt-6 uppercase tracking-[0.4em] font-mono",children:(H.yAxes||[])[0]||Object.keys(a[0])[0]})]})})():l.jsx("div",{className:"flex-1 min-h-[280px] min-w-0",children:l.jsx(XS,{width:"100%",height:"100%",minWidth:320,minHeight:280,children:wr==="bar"?l.jsxs(YS,{data:a,children:[l.jsx(pc,{strokeDasharray:"3 3",vertical:!1,stroke:"#f1f5f9"}),l.jsx(gc,{dataKey:H.xAxis,axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#94a3b8",fontWeight:"bold"}}),l.jsx(mc,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#94a3b8",fontWeight:"bold"},tickFormatter:ve=>Ma(ve,(H.yAxes||[])[0])}),l.jsx(Jl,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1)"},cursor:{fill:"#f8fafc"},formatter:(ve,it)=>[Ma(ve,it),it]}),l.jsx(Zl,{verticalAlign:"top",height:36,iconType:"circle",wrapperStyle:{fontSize:"10px",fontWeight:"bold"}}),(H.yAxes||[]).map((ve,it)=>l.jsx(ox,{dataKey:ve,fill:it===0?H.color||ln[0]:ln[it%ln.length],radius:[4,4,0,0],children:H.showLabels&&l.jsx(xc,{dataKey:ve,position:"top",style:{fontSize:"10px",fontWeight:"bold",fill:"#64748b"},formatter:St=>Ma(St,ve)})},ve))]}):wr==="line"?l.jsxs(JS,{data:a,children:[l.jsx(pc,{strokeDasharray:"3 3",vertical:!1,stroke:"#f1f5f9"}),l.jsx(gc,{dataKey:H.xAxis,axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#94a3b8",fontWeight:"bold"}}),l.jsx(mc,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#94a3b8",fontWeight:"bold"},tickFormatter:ve=>Ma(ve,(H.yAxes||[])[0])}),l.jsx(Jl,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1)"},formatter:(ve,it)=>[Ma(ve,it),it]}),l.jsx(Zl,{verticalAlign:"top",height:36,iconType:"circle"}),(H.yAxes||[]).map((ve,it)=>l.jsx(Ax,{type:"monotone",dataKey:ve,stroke:it===0?H.color||ln[0]:ln[it%ln.length],strokeWidth:3,dot:{r:4},activeDot:{r:6},children:H.showLabels&&l.jsx(xc,{dataKey:ve,position:"top",offset:10,style:{fontSize:"10px",fontWeight:"bold",fill:"#64748b"},formatter:St=>Ma(St,ve)})},ve))]}):wr==="area"?l.jsxs(ZS,{data:a,children:[l.jsx(pc,{strokeDasharray:"3 3",vertical:!1,stroke:"#f1f5f9"}),l.jsx(gc,{dataKey:H.xAxis,axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#94a3b8",fontWeight:"bold"}}),l.jsx(mc,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#94a3b8",fontWeight:"bold"},tickFormatter:ve=>Ma(ve,(H.yAxes||[])[0])}),l.jsx(Jl,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1)"},formatter:(ve,it)=>[Ma(ve,it),it]}),l.jsx(Zl,{verticalAlign:"top",height:36,iconType:"circle",wrapperStyle:{fontSize:"10px",fontWeight:"bold"}}),(H.yAxes||[]).map((ve,it)=>l.jsx(e3,{type:"monotone",dataKey:ve,stroke:it===0?H.color||ln[0]:ln[it%ln.length],fill:it===0?H.color||ln[0]:ln[it%ln.length],fillOpacity:.2,strokeWidth:2,children:H.showLabels&&l.jsx(xc,{dataKey:ve,position:"top",style:{fontSize:"10px",fontWeight:"bold",fill:"#64748b"},formatter:St=>Ma(St,ve)})},ve))]}):wr==="pie"?l.jsxs(t3,{children:[l.jsx(r3,{data:a,cx:"50%",cy:"50%",labelLine:!1,label:({name:ve,percent:it})=>`${ve} ${((it||0)*100).toFixed(0)}%`,outerRadius:120,innerRadius:80,paddingAngle:5,dataKey:(H.yAxes||[])[0]||"",nameKey:H.xAxis,children:a.map((ve,it)=>l.jsx(a3,{fill:ln[it%ln.length]},`cell-${it}`))}),l.jsx(Jl,{contentStyle:{borderRadius:"12px",border:"none"}}),l.jsx(Zl,{layout:"vertical",align:"right",verticalAlign:"middle",iconType:"circle",wrapperStyle:{fontSize:"10px",fontWeight:"bold"}})]}):wr==="composed"?l.jsxs(s3,{data:a,children:[l.jsx(pc,{strokeDasharray:"3 3",vertical:!1,stroke:"#f1f5f9"}),l.jsx(gc,{dataKey:H.xAxis,axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#94a3b8",fontWeight:"bold"}}),l.jsx(mc,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#94a3b8",fontWeight:"bold"},tickFormatter:ve=>Ma(ve,(H.yAxes||[])[0])}),l.jsx(Jl,{contentStyle:{borderRadius:"12px",border:"none"},formatter:(ve,it)=>[Ma(ve,it),it]}),l.jsx(Zl,{verticalAlign:"top",height:36,wrapperStyle:{fontSize:"10px",fontWeight:"bold"}}),(H.yAxes||[]).map((ve,it)=>it===0?l.jsx(ox,{dataKey:ve,fill:ln[0],radius:[4,4,0,0],children:H.showLabels&&l.jsx(xc,{dataKey:ve,position:"top",style:{fontSize:"10px",fontWeight:"bold",fill:"#64748b"},formatter:St=>Ma(St,ve)})},ve):l.jsx(Ax,{type:"monotone",dataKey:ve,stroke:ln[it%ln.length],strokeWidth:3,children:H.showLabels&&l.jsx(xc,{dataKey:ve,position:"top",style:{fontSize:"10px",fontWeight:"bold",fill:"#64748b"},formatter:St=>Ma(St,ve)})},ve))]}):wr==="radar"?l.jsxs(n3,{cx:"50%",cy:"50%",outerRadius:"80%",data:a,children:[l.jsx(i3,{stroke:"#e2e8f0"}),l.jsx(l3,{dataKey:H.xAxis,tick:{fontSize:10,fill:"#94a3b8",fontWeight:"bold"}}),l.jsx(o3,{angle:30,domain:[0,"auto"],tick:{fontSize:10,fill:"#94a3b8"}}),(H.yAxes||[]).map((ve,it)=>l.jsx(A3,{name:ve,dataKey:ve,stroke:ln[it%ln.length],fill:ln[it%ln.length],fillOpacity:.6},ve)),l.jsx(Zl,{iconType:"circle",wrapperStyle:{fontSize:"10px",fontWeight:"bold"}}),l.jsx(Jl,{contentStyle:{borderRadius:"12px",border:"none"}})]}):wr==="scatter"?l.jsxs(c3,{children:[l.jsx(pc,{strokeDasharray:"3 3",vertical:!1,stroke:"#f1f5f9"}),l.jsx(gc,{type:"number",dataKey:H.xAxis,name:H.xAxis,axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#94a3b8",fontWeight:"bold"}}),l.jsx(mc,{type:"number",dataKey:(H.yAxes||[])[0],name:(H.yAxes||[])[0],axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#94a3b8",fontWeight:"bold"}}),l.jsx(Jl,{cursor:{strokeDasharray:"3 3"}}),l.jsx(Zl,{verticalAlign:"top",height:36,iconType:"circle",wrapperStyle:{fontSize:"10px",fontWeight:"bold"}}),l.jsx(u3,{name:je||"Scatter",data:Zt,fill:H.color||ln[0]})]}):null})})},`${wr}-${g}`):l.jsxs("div",{className:"h-full min-h-[260px] flex flex-col items-center justify-center text-slate-400",children:[l.jsx(wn,{className:"w-10 h-10 mb-3 opacity-40"}),l.jsx("p",{className:"text-xs font-bold text-center",children:e("querybuilder.preview_graphic_not_selected_hint","Fuer die grafische Ansicht bitte einen Diagrammtyp auswaehlen.")})]}):l.jsxs("div",{className:"h-full min-h-[260px] flex flex-col items-center justify-center text-slate-400",children:[l.jsx(Bh,{className:"w-10 h-10 mb-3 opacity-40"}),l.jsx("p",{className:"text-xs font-bold text-center",children:e("querybuilder.preview_graphic_no_query_hint","Keine Abfrage vorhanden. Fuer Text/Markdown/Status/Section/KPI-Manual/Image-Widgets steht nur die Inhaltsvorschau zur Verfuegung.")})]}):m==="table"?Re?a.length===0?l.jsxs("div",{className:"h-full min-h-[260px] flex flex-col items-center justify-center text-slate-300",children:[l.jsx(Q0,{className:"w-12 h-12 mb-4 opacity-10"}),l.jsx("p",{className:"text-xs font-black uppercase tracking-widest text-center whitespace-pre-wrap",children:e("querybuilder.no_data_prompt")})]}):l.jsx(Tx,{columns:Vt,data:a,onRowClick:ve=>{He(a.indexOf(ve)),Ae(!0)}}):l.jsxs("div",{className:"h-full min-h-[260px] flex flex-col items-center justify-center text-slate-400",children:[l.jsx(CA,{className:"w-10 h-10 mb-3 opacity-40"}),l.jsx("p",{className:"text-xs font-bold text-center",children:e("querybuilder.preview_no_data_source","Keine Datenquelle ausgewaehlt.")})]}):Re?l.jsx("div",{className:"h-full",children:l.jsx("textarea",{value:t,readOnly:!0,className:"w-full h-full min-h-[260px] font-mono text-xs p-3 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-100 rounded-lg outline-none resize-none"})}):l.jsxs("div",{className:"h-full min-h-[260px] flex flex-col items-center justify-center text-slate-400",children:[l.jsx(lf,{className:"w-10 h-10 mb-3 opacity-40"}),l.jsx("p",{className:"text-xs font-bold text-center",children:e("querybuilder.preview_no_data_source","Keine Datenquelle ausgewaehlt.")})]})})]})]})}),l.jsx(Bo,{isOpen:te,onClose:()=>Le(!1),title:e(le?"querybuilder.update_title":"querybuilder.save_title"),children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"bg-blue-50 p-4 rounded-xl border border-blue-100 flex items-center gap-3",children:[l.jsx(uk,{className:"w-8 h-8 text-blue-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-[10px] font-black uppercase text-blue-400",children:e("querybuilder.archive_name")}),l.jsx("input",{autoFocus:!0,value:je,onChange:ve=>F(ve.target.value),placeholder:e("querybuilder.archive_placeholder"),className:"w-full bg-transparent border-none outline-none font-bold text-blue-900 placeholder:text-blue-200"})]})]}),l.jsx("div",{className:"flex justify-end gap-2 pt-2",children:l.jsxs("button",{onClick:()=>{er("update")},disabled:!je,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-bold text-xs shadow-lg flex items-center gap-2",children:[l.jsx(Yx,{className:"w-4 h-4"})," ",e("common.save")]})})]})}),l.jsx(cb,{isOpen:Ie,onClose:()=>Ae(!1),items:a,initialIndex:oe,tableName:void 0,schema:se||void 0})]})},yb=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function zf(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function I_(e){return"nodeType"in e}function so(e){var t,r;return e?zf(e)?e:I_(e)&&(t=(r=e.ownerDocument)==null?void 0:r.defaultView)!=null?t:window:window}function Q_(e){const{Document:t}=so(e);return e instanceof t}function ng(e){return zf(e)?!1:e instanceof so(e).HTMLElement}function t6(e){return e instanceof so(e).SVGElement}function Vf(e){return e?zf(e)?e.document:I_(e)?Q_(e)?e:ng(e)||t6(e)?e.ownerDocument:document:document:document}const h0=yb?Z.useLayoutEffect:Z.useEffect;function O_(e){const t=Z.useRef(e);return h0(()=>{t.current=e}),Z.useCallback(function(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return t.current==null?void 0:t.current(...a)},[])}function Fte(){const e=Z.useRef(null),t=Z.useCallback((a,s)=>{e.current=setInterval(a,s)},[]),r=Z.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,r]}function Kp(e,t){t===void 0&&(t=[e]);const r=Z.useRef(e);return h0(()=>{r.current!==e&&(r.current=e)},t),r}function ig(e,t){const r=Z.useRef();return Z.useMemo(()=>{const a=e(r.current);return r.current=a,a},[...t])}function Gx(e){const t=O_(e),r=Z.useRef(null),a=Z.useCallback(s=>{s!==r.current&&t?.(s,r.current),r.current=s},[]);return[r,a]}function g2(e){const t=Z.useRef();return Z.useEffect(()=>{t.current=e},[e]),t.current}let aw={};function kb(e,t){return Z.useMemo(()=>{if(t)return t;const r=aw[e]==null?0:aw[e]+1;return aw[e]=r,e+"-"+r},[e,t])}function r6(e){return function(t){for(var r=arguments.length,a=new Array(r>1?r-1:0),s=1;s<r;s++)a[s-1]=arguments[s];return a.reduce((n,o)=>{const c=Object.entries(o);for(const[u,f]of c){const h=n[u];h!=null&&(n[u]=h+e*f)}return n},{...t})}}const Ef=r6(1),zp=r6(-1);function Tte(e){return"clientX"in e&&"clientY"in e}function a6(e){if(!e)return!1;const{KeyboardEvent:t}=so(e.target);return t&&e instanceof t}function Lte(e){if(!e)return!1;const{TouchEvent:t}=so(e.target);return t&&e instanceof t}function m2(e){if(Lte(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return Tte(e)?{x:e.clientX,y:e.clientY}:null}const x2=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[x2.Translate.toString(e),x2.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:a}=e;return t+" "+r+"ms "+a}}}),yS="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function jte(e){return e.matches(yS)?e:e.querySelector(yS)}const Ute={display:"none"};function Dte(e){let{id:t,value:r}=e;return Wt.createElement("div",{id:t,style:Ute},r)}function Ite(e){let{id:t,announcement:r,ariaLiveType:a="assertive"}=e;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return Wt.createElement("div",{id:t,style:s,role:"status","aria-live":a,"aria-atomic":!0},r)}function Qte(){const[e,t]=Z.useState("");return{announce:Z.useCallback(a=>{a!=null&&t(a)},[]),announcement:e}}const s6=Z.createContext(null);function Ote(e){const t=Z.useContext(s6);Z.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function Rte(){const[e]=Z.useState(()=>new Set),t=Z.useCallback(a=>(e.add(a),()=>e.delete(a)),[e]);return[Z.useCallback(a=>{let{type:s,event:n}=a;e.forEach(o=>{var c;return(c=o[s])==null?void 0:c.call(o,n)})},[e]),t]}const Mte={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Hte={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function Pte(e){let{announcements:t=Hte,container:r,hiddenTextDescribedById:a,screenReaderInstructions:s=Mte}=e;const{announce:n,announcement:o}=Qte(),c=kb("DndLiveRegion"),[u,f]=Z.useState(!1);if(Z.useEffect(()=>{f(!0)},[]),Ote(Z.useMemo(()=>({onDragStart(g){let{active:x}=g;n(t.onDragStart({active:x}))},onDragMove(g){let{active:x,over:m}=g;t.onDragMove&&n(t.onDragMove({active:x,over:m}))},onDragOver(g){let{active:x,over:m}=g;n(t.onDragOver({active:x,over:m}))},onDragEnd(g){let{active:x,over:m}=g;n(t.onDragEnd({active:x,over:m}))},onDragCancel(g){let{active:x,over:m}=g;n(t.onDragCancel({active:x,over:m}))}}),[n,t])),!u)return null;const h=Wt.createElement(Wt.Fragment,null,Wt.createElement(Dte,{id:a,value:s.draggable}),Wt.createElement(Ite,{id:c,announcement:o}));return r?I0.createPortal(h,r):h}var li;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(li||(li={}));function Wx(){}function kS(e,t){return Z.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function qte(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Z.useMemo(()=>[...t].filter(a=>a!=null),[...t])}const LA=Object.freeze({x:0,y:0});function n6(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function i6(e,t){let{data:{value:r}}=e,{data:{value:a}}=t;return r-a}function Kte(e,t){let{data:{value:r}}=e,{data:{value:a}}=t;return a-r}function BS(e){let{left:t,top:r,height:a,width:s}=e;return[{x:t,y:r},{x:t+s,y:r},{x:t,y:r+a},{x:t+s,y:r+a}]}function l6(e,t){if(!e||e.length===0)return null;const[r]=e;return r[t]}function CS(e,t,r){return t===void 0&&(t=e.left),r===void 0&&(r=e.top),{x:t+e.width*.5,y:r+e.height*.5}}const zte=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:a}=e;const s=CS(t,t.left,t.top),n=[];for(const o of a){const{id:c}=o,u=r.get(c);if(u){const f=n6(CS(u),s);n.push({id:c,data:{droppableContainer:o,value:f}})}}return n.sort(i6)},Vte=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:a}=e;const s=BS(t),n=[];for(const o of a){const{id:c}=o,u=r.get(c);if(u){const f=BS(u),h=s.reduce((x,m,w)=>x+n6(f[w],m),0),g=Number((h/4).toFixed(4));n.push({id:c,data:{droppableContainer:o,value:g}})}}return n.sort(i6)};function Gte(e,t){const r=Math.max(t.top,e.top),a=Math.max(t.left,e.left),s=Math.min(t.left+t.width,e.left+e.width),n=Math.min(t.top+t.height,e.top+e.height),o=s-a,c=n-r;if(a<s&&r<n){const u=t.width*t.height,f=e.width*e.height,h=o*c,g=h/(u+f-h);return Number(g.toFixed(4))}return 0}const Wte=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:a}=e;const s=[];for(const n of a){const{id:o}=n,c=r.get(o);if(c){const u=Gte(c,t);u>0&&s.push({id:o,data:{droppableContainer:n,value:u}})}}return s.sort(Kte)};function $te(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}function o6(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:LA}function Xte(e){return function(r){for(var a=arguments.length,s=new Array(a>1?a-1:0),n=1;n<a;n++)s[n-1]=arguments[n];return s.reduce((o,c)=>({...o,top:o.top+e*c.y,bottom:o.bottom+e*c.y,left:o.left+e*c.x,right:o.right+e*c.x}),{...r})}}const Yte=Xte(1);function Jte(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function Zte(e,t,r){const a=Jte(t);if(!a)return e;const{scaleX:s,scaleY:n,x:o,y:c}=a,u=e.left-o-(1-s)*parseFloat(r),f=e.top-c-(1-n)*parseFloat(r.slice(r.indexOf(" ")+1)),h=s?e.width/s:e.width,g=n?e.height/n:e.height;return{width:h,height:g,top:f,right:u+h,bottom:f+g,left:u}}const ere={ignoreTransform:!1};function lg(e,t){t===void 0&&(t=ere);let r=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:f,transformOrigin:h}=so(e).getComputedStyle(e);f&&(r=Zte(r,f,h))}const{top:a,left:s,width:n,height:o,bottom:c,right:u}=r;return{top:a,left:s,width:n,height:o,bottom:c,right:u}}function SS(e){return lg(e,{ignoreTransform:!0})}function tre(e){const t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}function rre(e,t){return t===void 0&&(t=so(e).getComputedStyle(e)),t.position==="fixed"}function are(e,t){t===void 0&&(t=so(e).getComputedStyle(e));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const n=t[s];return typeof n=="string"?r.test(n):!1})}function Bb(e,t){const r=[];function a(s){if(t!=null&&r.length>=t||!s)return r;if(Q_(s)&&s.scrollingElement!=null&&!r.includes(s.scrollingElement))return r.push(s.scrollingElement),r;if(!ng(s)||t6(s)||r.includes(s))return r;const n=so(e).getComputedStyle(s);return s!==e&&are(s,n)&&r.push(s),rre(s,n)?r:a(s.parentNode)}return e?a(e):r}function A6(e){const[t]=Bb(e,1);return t??null}function sw(e){return!yb||!e?null:zf(e)?e:I_(e)?Q_(e)||e===Vf(e).scrollingElement?window:ng(e)?e:null:null}function c6(e){return zf(e)?e.scrollX:e.scrollLeft}function u6(e){return zf(e)?e.scrollY:e.scrollTop}function b2(e){return{x:c6(e),y:u6(e)}}var _i;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(_i||(_i={}));function d6(e){return!yb||!e?!1:e===document.scrollingElement}function f6(e){const t={x:0,y:0},r=d6(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},a={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},s=e.scrollTop<=t.y,n=e.scrollLeft<=t.x,o=e.scrollTop>=a.y,c=e.scrollLeft>=a.x;return{isTop:s,isLeft:n,isBottom:o,isRight:c,maxScroll:a,minScroll:t}}const sre={x:.2,y:.2};function nre(e,t,r,a,s){let{top:n,left:o,right:c,bottom:u}=r;a===void 0&&(a=10),s===void 0&&(s=sre);const{isTop:f,isBottom:h,isLeft:g,isRight:x}=f6(e),m={x:0,y:0},w={x:0,y:0},v={height:t.height*s.y,width:t.width*s.x};return!f&&n<=t.top+v.height?(m.y=_i.Backward,w.y=a*Math.abs((t.top+v.height-n)/v.height)):!h&&u>=t.bottom-v.height&&(m.y=_i.Forward,w.y=a*Math.abs((t.bottom-v.height-u)/v.height)),!x&&c>=t.right-v.width?(m.x=_i.Forward,w.x=a*Math.abs((t.right-v.width-c)/v.width)):!g&&o<=t.left+v.width&&(m.x=_i.Backward,w.x=a*Math.abs((t.left+v.width-o)/v.width)),{direction:m,speed:w}}function ire(e){if(e===document.scrollingElement){const{innerWidth:n,innerHeight:o}=window;return{top:0,left:0,right:n,bottom:o,width:n,height:o}}const{top:t,left:r,right:a,bottom:s}=e.getBoundingClientRect();return{top:t,left:r,right:a,bottom:s,width:e.clientWidth,height:e.clientHeight}}function h6(e){return e.reduce((t,r)=>Ef(t,b2(r)),LA)}function lre(e){return e.reduce((t,r)=>t+c6(r),0)}function ore(e){return e.reduce((t,r)=>t+u6(r),0)}function Are(e,t){if(t===void 0&&(t=lg),!e)return;const{top:r,left:a,bottom:s,right:n}=t(e);A6(e)&&(s<=0||n<=0||r>=window.innerHeight||a>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const cre=[["x",["left","right"],lre],["y",["top","bottom"],ore]];class R_{constructor(t,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const a=Bb(r),s=h6(a);this.rect={...t},this.width=t.width,this.height=t.height;for(const[n,o,c]of cre)for(const u of o)Object.defineProperty(this,u,{get:()=>{const f=c(a),h=s[n]-f;return this.rect[u]+h},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class xp{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var a;return(a=this.target)==null?void 0:a.removeEventListener(...r)})},this.target=t}add(t,r,a){var s;(s=this.target)==null||s.addEventListener(t,r,a),this.listeners.push([t,r,a])}}function ure(e){const{EventTarget:t}=so(e);return e instanceof t?e:Vf(e)}function nw(e,t){const r=Math.abs(e.x),a=Math.abs(e.y);return typeof t=="number"?Math.sqrt(r**2+a**2)>t:"x"in t&&"y"in t?r>t.x&&a>t.y:"x"in t?r>t.x:"y"in t?a>t.y:!1}var $o;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})($o||($o={}));function NS(e){e.preventDefault()}function dre(e){e.stopPropagation()}var ka;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(ka||(ka={}));const p6={start:[ka.Space,ka.Enter],cancel:[ka.Esc],end:[ka.Space,ka.Enter,ka.Tab]},fre=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case ka.Right:return{...r,x:r.x+25};case ka.Left:return{...r,x:r.x-25};case ka.Down:return{...r,y:r.y+25};case ka.Up:return{...r,y:r.y-25}}};class M_{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:r}}=t;this.props=t,this.listeners=new xp(Vf(r)),this.windowListeners=new xp(so(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add($o.Resize,this.handleCancel),this.windowListeners.add($o.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add($o.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:r}=this.props,a=t.node.current;a&&Are(a),r(LA)}handleKeyDown(t){if(a6(t)){const{active:r,context:a,options:s}=this.props,{keyboardCodes:n=p6,coordinateGetter:o=fre,scrollBehavior:c="smooth"}=s,{code:u}=t;if(n.end.includes(u)){this.handleEnd(t);return}if(n.cancel.includes(u)){this.handleCancel(t);return}const{collisionRect:f}=a.current,h=f?{x:f.left,y:f.top}:LA;this.referenceCoordinates||(this.referenceCoordinates=h);const g=o(t,{active:r,context:a.current,currentCoordinates:h});if(g){const x=zp(g,h),m={x:0,y:0},{scrollableAncestors:w}=a.current;for(const v of w){const B=t.code,{isTop:k,isRight:E,isLeft:S,isBottom:L,maxScroll:P,minScroll:R}=f6(v),Q=ire(v),V={x:Math.min(B===ka.Right?Q.right-Q.width/2:Q.right,Math.max(B===ka.Right?Q.left:Q.left+Q.width/2,g.x)),y:Math.min(B===ka.Down?Q.bottom-Q.height/2:Q.bottom,Math.max(B===ka.Down?Q.top:Q.top+Q.height/2,g.y))},U=B===ka.Right&&!E||B===ka.Left&&!S,M=B===ka.Down&&!L||B===ka.Up&&!k;if(U&&V.x!==g.x){const T=v.scrollLeft+x.x,D=B===ka.Right&&T<=P.x||B===ka.Left&&T>=R.x;if(D&&!x.y){v.scrollTo({left:T,behavior:c});return}D?m.x=v.scrollLeft-T:m.x=B===ka.Right?v.scrollLeft-P.x:v.scrollLeft-R.x,m.x&&v.scrollBy({left:-m.x,behavior:c});break}else if(M&&V.y!==g.y){const T=v.scrollTop+x.y,D=B===ka.Down&&T<=P.y||B===ka.Up&&T>=R.y;if(D&&!x.x){v.scrollTo({top:T,behavior:c});return}D?m.y=v.scrollTop-T:m.y=B===ka.Down?v.scrollTop-P.y:v.scrollTop-R.y,m.y&&v.scrollBy({top:-m.y,behavior:c});break}}this.handleMove(t,Ef(zp(g,this.referenceCoordinates),m))}}}handleMove(t,r){const{onMove:a}=this.props;t.preventDefault(),a(r)}handleEnd(t){const{onEnd:r}=this.props;t.preventDefault(),this.detach(),r()}handleCancel(t){const{onCancel:r}=this.props;t.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}M_.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:a=p6,onActivation:s}=t,{active:n}=r;const{code:o}=e.nativeEvent;if(a.start.includes(o)){const c=n.activatorNode.current;return c&&e.target!==c?!1:(e.preventDefault(),s?.({event:e.nativeEvent}),!0)}return!1}}];function ES(e){return!!(e&&"distance"in e)}function FS(e){return!!(e&&"delay"in e)}class H_{constructor(t,r,a){var s;a===void 0&&(a=ure(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=r;const{event:n}=t,{target:o}=n;this.props=t,this.events=r,this.document=Vf(o),this.documentListeners=new xp(this.document),this.listeners=new xp(a),this.windowListeners=new xp(so(o)),this.initialCoordinates=(s=m2(n))!=null?s:LA,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:r,bypassActivationConstraint:a}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add($o.Resize,this.handleCancel),this.windowListeners.add($o.DragStart,NS),this.windowListeners.add($o.VisibilityChange,this.handleCancel),this.windowListeners.add($o.ContextMenu,NS),this.documentListeners.add($o.Keydown,this.handleKeydown),r){if(a!=null&&a({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(FS(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(ES(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,r){const{active:a,onPending:s}=this.props;s(a,t,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:t}=this,{onStart:r}=this.props;t&&(this.activated=!0,this.documentListeners.add($o.Click,dre,{capture:!0}),this.removeTextSelection(),this.documentListeners.add($o.SelectionChange,this.removeTextSelection),r(t))}handleMove(t){var r;const{activated:a,initialCoordinates:s,props:n}=this,{onMove:o,options:{activationConstraint:c}}=n;if(!s)return;const u=(r=m2(t))!=null?r:LA,f=zp(s,u);if(!a&&c){if(ES(c)){if(c.tolerance!=null&&nw(f,c.tolerance))return this.handleCancel();if(nw(f,c.distance))return this.handleStart()}if(FS(c)&&nw(f,c.tolerance))return this.handleCancel();this.handlePending(c,f);return}t.cancelable&&t.preventDefault(),o(u)}handleEnd(){const{onAbort:t,onEnd:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleCancel(){const{onAbort:t,onCancel:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleKeydown(t){t.code===ka.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const hre={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class P_ extends H_{constructor(t){const{event:r}=t,a=Vf(r.target);super(t,hre,a)}}P_.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:a}=t;return!r.isPrimary||r.button!==0?!1:(a?.({event:r}),!0)}}];const pre={move:{name:"mousemove"},end:{name:"mouseup"}};var v2;(function(e){e[e.RightClick=2]="RightClick"})(v2||(v2={}));class gre extends H_{constructor(t){super(t,pre,Vf(t.event.target))}}gre.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:a}=t;return r.button===v2.RightClick?!1:(a?.({event:r}),!0)}}];const iw={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class mre extends H_{constructor(t){super(t,iw)}static setup(){return window.addEventListener(iw.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(iw.move.name,t)};function t(){}}}mre.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:a}=t;const{touches:s}=r;return s.length>1?!1:(a?.({event:r}),!0)}}];var bp;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(bp||(bp={}));var $x;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})($x||($x={}));function xre(e){let{acceleration:t,activator:r=bp.Pointer,canScroll:a,draggingRect:s,enabled:n,interval:o=5,order:c=$x.TreeOrder,pointerCoordinates:u,scrollableAncestors:f,scrollableAncestorRects:h,delta:g,threshold:x}=e;const m=vre({delta:g,disabled:!n}),[w,v]=Fte(),B=Z.useRef({x:0,y:0}),k=Z.useRef({x:0,y:0}),E=Z.useMemo(()=>{switch(r){case bp.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case bp.DraggableRect:return s}},[r,s,u]),S=Z.useRef(null),L=Z.useCallback(()=>{const R=S.current;if(!R)return;const Q=B.current.x*k.current.x,V=B.current.y*k.current.y;R.scrollBy(Q,V)},[]),P=Z.useMemo(()=>c===$x.TreeOrder?[...f].reverse():f,[c,f]);Z.useEffect(()=>{if(!n||!f.length||!E){v();return}for(const R of P){if(a?.(R)===!1)continue;const Q=f.indexOf(R),V=h[Q];if(!V)continue;const{direction:U,speed:M}=nre(R,V,E,t,x);for(const T of["x","y"])m[T][U[T]]||(M[T]=0,U[T]=0);if(M.x>0||M.y>0){v(),S.current=R,w(L,o),B.current=M,k.current=U;return}}B.current={x:0,y:0},k.current={x:0,y:0},v()},[t,L,a,v,n,o,JSON.stringify(E),JSON.stringify(m),w,f,P,h,JSON.stringify(x)])}const bre={x:{[_i.Backward]:!1,[_i.Forward]:!1},y:{[_i.Backward]:!1,[_i.Forward]:!1}};function vre(e){let{delta:t,disabled:r}=e;const a=g2(t);return ig(s=>{if(r||!a||!s)return bre;const n={x:Math.sign(t.x-a.x),y:Math.sign(t.y-a.y)};return{x:{[_i.Backward]:s.x[_i.Backward]||n.x===-1,[_i.Forward]:s.x[_i.Forward]||n.x===1},y:{[_i.Backward]:s.y[_i.Backward]||n.y===-1,[_i.Forward]:s.y[_i.Forward]||n.y===1}}},[r,t,a])}function wre(e,t){const r=t!=null?e.get(t):void 0,a=r?r.node.current:null;return ig(s=>{var n;return t==null?null:(n=a??s)!=null?n:null},[a,t])}function _re(e,t){return Z.useMemo(()=>e.reduce((r,a)=>{const{sensor:s}=a,n=s.activators.map(o=>({eventName:o.eventName,handler:t(o.handler,a)}));return[...r,...n]},[]),[e,t])}var Vp;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Vp||(Vp={}));var w2;(function(e){e.Optimized="optimized"})(w2||(w2={}));const TS=new Map;function yre(e,t){let{dragging:r,dependencies:a,config:s}=t;const[n,o]=Z.useState(null),{frequency:c,measure:u,strategy:f}=s,h=Z.useRef(e),g=B(),x=Kp(g),m=Z.useCallback(function(k){k===void 0&&(k=[]),!x.current&&o(E=>E===null?k:E.concat(k.filter(S=>!E.includes(S))))},[x]),w=Z.useRef(null),v=ig(k=>{if(g&&!r)return TS;if(!k||k===TS||h.current!==e||n!=null){const E=new Map;for(let S of e){if(!S)continue;if(n&&n.length>0&&!n.includes(S.id)&&S.rect.current){E.set(S.id,S.rect.current);continue}const L=S.node.current,P=L?new R_(u(L),L):null;S.rect.current=P,P&&E.set(S.id,P)}return E}return k},[e,n,r,g,u]);return Z.useEffect(()=>{h.current=e},[e]),Z.useEffect(()=>{g||m()},[r,g]),Z.useEffect(()=>{n&&n.length>0&&o(null)},[JSON.stringify(n)]),Z.useEffect(()=>{g||typeof c!="number"||w.current!==null||(w.current=setTimeout(()=>{m(),w.current=null},c))},[c,g,m,...a]),{droppableRects:v,measureDroppableContainers:m,measuringScheduled:n!=null};function B(){switch(f){case Vp.Always:return!1;case Vp.BeforeDragging:return r;default:return!r}}}function g6(e,t){return ig(r=>e?r||(typeof t=="function"?t(e):e):null,[t,e])}function kre(e,t){return g6(e,t)}function Bre(e){let{callback:t,disabled:r}=e;const a=O_(t),s=Z.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:n}=window;return new n(a)},[a,r]);return Z.useEffect(()=>()=>s?.disconnect(),[s]),s}function Cb(e){let{callback:t,disabled:r}=e;const a=O_(t),s=Z.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:n}=window;return new n(a)},[r]);return Z.useEffect(()=>()=>s?.disconnect(),[s]),s}function Cre(e){return new R_(lg(e),e)}function LS(e,t,r){t===void 0&&(t=Cre);const[a,s]=Z.useState(null);function n(){s(u=>{if(!e)return null;if(e.isConnected===!1){var f;return(f=u??r)!=null?f:null}const h=t(e);return JSON.stringify(u)===JSON.stringify(h)?u:h})}const o=Bre({callback(u){if(e)for(const f of u){const{type:h,target:g}=f;if(h==="childList"&&g instanceof HTMLElement&&g.contains(e)){n();break}}}}),c=Cb({callback:n});return h0(()=>{n(),e?(c?.observe(e),o?.observe(document.body,{childList:!0,subtree:!0})):(c?.disconnect(),o?.disconnect())},[e]),a}function Sre(e){const t=g6(e);return o6(e,t)}const jS=[];function Nre(e){const t=Z.useRef(e),r=ig(a=>e?a&&a!==jS&&e&&t.current&&e.parentNode===t.current.parentNode?a:Bb(e):jS,[e]);return Z.useEffect(()=>{t.current=e},[e]),r}function Ere(e){const[t,r]=Z.useState(null),a=Z.useRef(e),s=Z.useCallback(n=>{const o=sw(n.target);o&&r(c=>c?(c.set(o,b2(o)),new Map(c)):null)},[]);return Z.useEffect(()=>{const n=a.current;if(e!==n){o(n);const c=e.map(u=>{const f=sw(u);return f?(f.addEventListener("scroll",s,{passive:!0}),[f,b2(f)]):null}).filter(u=>u!=null);r(c.length?new Map(c):null),a.current=e}return()=>{o(e),o(n)};function o(c){c.forEach(u=>{const f=sw(u);f?.removeEventListener("scroll",s)})}},[s,e]),Z.useMemo(()=>e.length?t?Array.from(t.values()).reduce((n,o)=>Ef(n,o),LA):h6(e):LA,[e,t])}function US(e,t){t===void 0&&(t=[]);const r=Z.useRef(null);return Z.useEffect(()=>{r.current=null},t),Z.useEffect(()=>{const a=e!==LA;a&&!r.current&&(r.current=e),!a&&r.current&&(r.current=null)},[e]),r.current?zp(e,r.current):LA}function Fre(e){Z.useEffect(()=>{if(!yb)return;const t=e.map(r=>{let{sensor:a}=r;return a.setup==null?void 0:a.setup()});return()=>{for(const r of t)r?.()}},e.map(t=>{let{sensor:r}=t;return r}))}function Tre(e,t){return Z.useMemo(()=>e.reduce((r,a)=>{let{eventName:s,handler:n}=a;return r[s]=o=>{n(o,t)},r},{}),[e,t])}function m6(e){return Z.useMemo(()=>e?tre(e):null,[e])}const DS=[];function Lre(e,t){t===void 0&&(t=lg);const[r]=e,a=m6(r?so(r):null),[s,n]=Z.useState(DS);function o(){n(()=>e.length?e.map(u=>d6(u)?a:new R_(t(u),u)):DS)}const c=Cb({callback:o});return h0(()=>{c?.disconnect(),o(),e.forEach(u=>c?.observe(u))},[e]),s}function jre(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return ng(t)?t:e}function Ure(e){let{measure:t}=e;const[r,a]=Z.useState(null),s=Z.useCallback(f=>{for(const{target:h}of f)if(ng(h)){a(g=>{const x=t(h);return g?{...g,width:x.width,height:x.height}:x});break}},[t]),n=Cb({callback:s}),o=Z.useCallback(f=>{const h=jre(f);n?.disconnect(),h&&n?.observe(h),a(h?t(h):null)},[t,n]),[c,u]=Gx(o);return Z.useMemo(()=>({nodeRef:c,rect:r,setRef:u}),[r,c,u])}const Dre=[{sensor:P_,options:{}},{sensor:M_,options:{}}],Ire={current:{}},sx={draggable:{measure:SS},droppable:{measure:SS,strategy:Vp.WhileDragging,frequency:w2.Optimized},dragOverlay:{measure:lg}};class vp extends Map{get(t){var r;return t!=null&&(r=super.get(t))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:r}=t;return!r})}getNodeFor(t){var r,a;return(r=(a=this.get(t))==null?void 0:a.node.current)!=null?r:void 0}}const Qre={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new vp,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Wx},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:sx,measureDroppableContainers:Wx,windowRect:null,measuringScheduled:!1},Ore={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Wx,draggableNodes:new Map,over:null,measureDroppableContainers:Wx},Sb=Z.createContext(Ore),Rre=Z.createContext(Qre);function Mre(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new vp}}}function Hre(e,t){switch(t.type){case li.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case li.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case li.DragEnd:case li.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case li.RegisterDroppable:{const{element:r}=t,{id:a}=r,s=new vp(e.droppable.containers);return s.set(a,r),{...e,droppable:{...e.droppable,containers:s}}}case li.SetDroppableDisabled:{const{id:r,key:a,disabled:s}=t,n=e.droppable.containers.get(r);if(!n||a!==n.key)return e;const o=new vp(e.droppable.containers);return o.set(r,{...n,disabled:s}),{...e,droppable:{...e.droppable,containers:o}}}case li.UnregisterDroppable:{const{id:r,key:a}=t,s=e.droppable.containers.get(r);if(!s||a!==s.key)return e;const n=new vp(e.droppable.containers);return n.delete(r),{...e,droppable:{...e.droppable,containers:n}}}default:return e}}function Pre(e){let{disabled:t}=e;const{active:r,activatorEvent:a,draggableNodes:s}=Z.useContext(Sb),n=g2(a),o=g2(r?.id);return Z.useEffect(()=>{if(!t&&!a&&n&&o!=null){if(!a6(n)||document.activeElement===n.target)return;const c=s.get(o);if(!c)return;const{activatorNode:u,node:f}=c;if(!u.current&&!f.current)return;requestAnimationFrame(()=>{for(const h of[u.current,f.current]){if(!h)continue;const g=jte(h);if(g){g.focus();break}}})}},[a,t,s,o,n]),null}function qre(e,t){let{transform:r,...a}=t;return e!=null&&e.length?e.reduce((s,n)=>n({transform:s,...a}),r):r}function Kre(e){return Z.useMemo(()=>({draggable:{...sx.draggable,...e?.draggable},droppable:{...sx.droppable,...e?.droppable},dragOverlay:{...sx.dragOverlay,...e?.dragOverlay}}),[e?.draggable,e?.droppable,e?.dragOverlay])}function zre(e){let{activeNode:t,measure:r,initialRect:a,config:s=!0}=e;const n=Z.useRef(!1),{x:o,y:c}=typeof s=="boolean"?{x:s,y:s}:s;h0(()=>{if(!o&&!c||!t){n.current=!1;return}if(n.current||!a)return;const f=t?.node.current;if(!f||f.isConnected===!1)return;const h=r(f),g=o6(h,a);if(o||(g.x=0),c||(g.y=0),n.current=!0,Math.abs(g.x)>0||Math.abs(g.y)>0){const x=A6(f);x&&x.scrollBy({top:g.y,left:g.x})}},[t,o,c,a,r])}const x6=Z.createContext({...LA,scaleX:1,scaleY:1});var zu;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(zu||(zu={}));const Vre=Z.memo(function(t){var r,a,s,n;let{id:o,accessibility:c,autoScroll:u=!0,children:f,sensors:h=Dre,collisionDetection:g=Wte,measuring:x,modifiers:m,...w}=t;const v=Z.useReducer(Hre,void 0,Mre),[B,k]=v,[E,S]=Rte(),[L,P]=Z.useState(zu.Uninitialized),R=L===zu.Initialized,{draggable:{active:Q,nodes:V,translate:U},droppable:{containers:M}}=B,T=Q!=null?V.get(Q):null,D=Z.useRef({initial:null,translated:null}),G=Z.useMemo(()=>{var Kt;return Q!=null?{id:Q,data:(Kt=T?.data)!=null?Kt:Ire,rect:D}:null},[Q,T]),ne=Z.useRef(null),[H,ee]=Z.useState(null),[le,pe]=Z.useState(null),te=Kp(w,Object.values(w)),Le=kb("DndDescribedBy",o),je=Z.useMemo(()=>M.getEnabled(),[M]),F=Kre(x),{droppableRects:K,measureDroppableContainers:I,measuringScheduled:q}=yre(je,{dragging:R,dependencies:[U.x,U.y],config:F.droppable}),J=wre(V,Q),Y=Z.useMemo(()=>le?m2(le):null,[le]),de=Xt(),ue=kre(J,F.draggable.measure);zre({activeNode:Q!=null?V.get(Q):null,config:de.layoutShiftCompensation,initialRect:ue,measure:F.draggable.measure});const we=LS(J,F.draggable.measure,ue),Ie=LS(J?J.parentElement:null),Ae=Z.useRef({activatorEvent:null,active:null,activeNode:J,collisionRect:null,collisions:null,droppableRects:K,draggableNodes:V,draggingNode:null,draggingNodeRect:null,droppableContainers:M,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),oe=M.getNodeFor((r=Ae.current.over)==null?void 0:r.id),He=Ure({measure:F.dragOverlay.measure}),se=(a=He.nodeRef.current)!=null?a:J,qe=R?(s=He.rect)!=null?s:we:null,Ye=!!(He.nodeRef.current&&He.rect),at=Sre(Ye?null:we),Ge=m6(se?so(se):null),pt=Nre(R?oe??J:null),nt=Lre(pt),Dt=qre(m,{transform:{x:U.x-at.x,y:U.y-at.y,scaleX:1,scaleY:1},activatorEvent:le,active:G,activeNodeRect:we,containerNodeRect:Ie,draggingNodeRect:qe,over:Ae.current.over,overlayNodeRect:He.rect,scrollableAncestors:pt,scrollableAncestorRects:nt,windowRect:Ge}),It=Y?Ef(Y,U):null,Ot=Ere(pt),sr=US(Ot),er=US(Ot,[we]),cr=Ef(Dt,sr),Vt=qe?Yte(qe,Dt):null,mt=G&&Vt?g({active:G,collisionRect:Vt,droppableRects:K,droppableContainers:je,pointerCoordinates:It}):null,Nt=l6(mt,"id"),[gt,dr]=Z.useState(null),Ht=Ye?Dt:Ef(Dt,er),Rt=$te(Ht,(n=gt?.rect)!=null?n:null,we),$t=Z.useRef(null),vr=Z.useCallback((Kt,Ft)=>{let{sensor:Zt,options:wr}=Ft;if(ne.current==null)return;const Re=V.get(ne.current);if(!Re)return;const Et=Kt.nativeEvent,Tt=new Zt({active:ne.current,activeNode:Re,event:Et,options:wr,context:Ae,onAbort(Yt){if(!V.get(Yt))return;const{onDragAbort:Jr}=te.current,jr={id:Yt};Jr?.(jr),E({type:"onDragAbort",event:jr})},onPending(Yt,Mr,Jr,jr){if(!V.get(Yt))return;const{onDragPending:Cr}=te.current,re={id:Yt,constraint:Mr,initialCoordinates:Jr,offset:jr};Cr?.(re),E({type:"onDragPending",event:re})},onStart(Yt){const Mr=ne.current;if(Mr==null)return;const Jr=V.get(Mr);if(!Jr)return;const{onDragStart:jr}=te.current,fr={activatorEvent:Et,active:{id:Mr,data:Jr.data,rect:D}};I0.unstable_batchedUpdates(()=>{jr?.(fr),P(zu.Initializing),k({type:li.DragStart,initialCoordinates:Yt,active:Mr}),E({type:"onDragStart",event:fr}),ee($t.current),pe(Et)})},onMove(Yt){k({type:li.DragMove,coordinates:Yt})},onEnd:Bt(li.DragEnd),onCancel:Bt(li.DragCancel)});$t.current=Tt;function Bt(Yt){return async function(){const{active:Jr,collisions:jr,over:fr,scrollAdjustedTranslate:Cr}=Ae.current;let re=null;if(Jr&&Cr){const{cancelDrop:ke}=te.current;re={activatorEvent:Et,active:Jr,collisions:jr,delta:Cr,over:fr},Yt===li.DragEnd&&typeof ke=="function"&&await Promise.resolve(ke(re))&&(Yt=li.DragCancel)}ne.current=null,I0.unstable_batchedUpdates(()=>{k({type:Yt}),P(zu.Uninitialized),dr(null),ee(null),pe(null),$t.current=null;const ke=Yt===li.DragEnd?"onDragEnd":"onDragCancel";if(re){const me=te.current[ke];me?.(re),E({type:ke,event:re})}})}}},[V]),vt=Z.useCallback((Kt,Ft)=>(Zt,wr)=>{const Re=Zt.nativeEvent,Et=V.get(wr);if(ne.current!==null||!Et||Re.dndKit||Re.defaultPrevented)return;const Tt={active:Et};Kt(Zt,Ft.options,Tt)===!0&&(Re.dndKit={capturedBy:Ft.sensor},ne.current=wr,vr(Zt,Ft))},[V,vr]),kr=_re(h,vt);Fre(h),h0(()=>{we&&L===zu.Initializing&&P(zu.Initialized)},[we,L]),Z.useEffect(()=>{const{onDragMove:Kt}=te.current,{active:Ft,activatorEvent:Zt,collisions:wr,over:Re}=Ae.current;if(!Ft||!Zt)return;const Et={active:Ft,activatorEvent:Zt,collisions:wr,delta:{x:cr.x,y:cr.y},over:Re};I0.unstable_batchedUpdates(()=>{Kt?.(Et),E({type:"onDragMove",event:Et})})},[cr.x,cr.y]),Z.useEffect(()=>{const{active:Kt,activatorEvent:Ft,collisions:Zt,droppableContainers:wr,scrollAdjustedTranslate:Re}=Ae.current;if(!Kt||ne.current==null||!Ft||!Re)return;const{onDragOver:Et}=te.current,Tt=wr.get(Nt),Bt=Tt&&Tt.rect.current?{id:Tt.id,rect:Tt.rect.current,data:Tt.data,disabled:Tt.disabled}:null,Yt={active:Kt,activatorEvent:Ft,collisions:Zt,delta:{x:Re.x,y:Re.y},over:Bt};I0.unstable_batchedUpdates(()=>{dr(Bt),Et?.(Yt),E({type:"onDragOver",event:Yt})})},[Nt]),h0(()=>{Ae.current={activatorEvent:le,active:G,activeNode:J,collisionRect:Vt,collisions:mt,droppableRects:K,draggableNodes:V,draggingNode:se,draggingNodeRect:qe,droppableContainers:M,over:gt,scrollableAncestors:pt,scrollAdjustedTranslate:cr},D.current={initial:qe,translated:Vt}},[G,J,mt,Vt,V,se,qe,K,M,gt,pt,cr]),xre({...de,delta:U,draggingRect:Vt,pointerCoordinates:It,scrollableAncestors:pt,scrollableAncestorRects:nt});const tr=Z.useMemo(()=>({active:G,activeNode:J,activeNodeRect:we,activatorEvent:le,collisions:mt,containerNodeRect:Ie,dragOverlay:He,draggableNodes:V,droppableContainers:M,droppableRects:K,over:gt,measureDroppableContainers:I,scrollableAncestors:pt,scrollableAncestorRects:nt,measuringConfiguration:F,measuringScheduled:q,windowRect:Ge}),[G,J,we,le,mt,Ie,He,V,M,K,gt,I,pt,nt,F,q,Ge]),rr=Z.useMemo(()=>({activatorEvent:le,activators:kr,active:G,activeNodeRect:we,ariaDescribedById:{draggable:Le},dispatch:k,draggableNodes:V,over:gt,measureDroppableContainers:I}),[le,kr,G,we,k,Le,V,gt,I]);return Wt.createElement(s6.Provider,{value:S},Wt.createElement(Sb.Provider,{value:rr},Wt.createElement(Rre.Provider,{value:tr},Wt.createElement(x6.Provider,{value:Rt},f)),Wt.createElement(Pre,{disabled:c?.restoreFocus===!1})),Wt.createElement(Pte,{...c,hiddenTextDescribedById:Le}));function Xt(){const Kt=H?.autoScrollEnabled===!1,Ft=typeof u=="object"?u.enabled===!1:u===!1,Zt=R&&!Kt&&!Ft;return typeof u=="object"?{...u,enabled:Zt}:{enabled:Zt}}}),Gre=Z.createContext(null),IS="button",Wre="Draggable";function $re(e){let{id:t,data:r,disabled:a=!1,attributes:s}=e;const n=kb(Wre),{activators:o,activatorEvent:c,active:u,activeNodeRect:f,ariaDescribedById:h,draggableNodes:g,over:x}=Z.useContext(Sb),{role:m=IS,roleDescription:w="draggable",tabIndex:v=0}=s??{},B=u?.id===t,k=Z.useContext(B?x6:Gre),[E,S]=Gx(),[L,P]=Gx(),R=Tre(o,t),Q=Kp(r);h0(()=>(g.set(t,{id:t,key:n,node:E,activatorNode:L,data:Q}),()=>{const U=g.get(t);U&&U.key===n&&g.delete(t)}),[g,t]);const V=Z.useMemo(()=>({role:m,tabIndex:v,"aria-disabled":a,"aria-pressed":B&&m===IS?!0:void 0,"aria-roledescription":w,"aria-describedby":h.draggable}),[a,m,v,B,w,h.draggable]);return{active:u,activatorEvent:c,activeNodeRect:f,attributes:V,isDragging:B,listeners:a?void 0:R,node:E,over:x,setNodeRef:S,setActivatorNodeRef:P,transform:k}}const Xre="Droppable",Yre={timeout:25};function Jre(e){let{data:t,disabled:r=!1,id:a,resizeObserverConfig:s}=e;const n=kb(Xre),{active:o,dispatch:c,over:u,measureDroppableContainers:f}=Z.useContext(Sb),h=Z.useRef({disabled:r}),g=Z.useRef(!1),x=Z.useRef(null),m=Z.useRef(null),{disabled:w,updateMeasurementsFor:v,timeout:B}={...Yre,...s},k=Kp(v??a),E=Z.useCallback(()=>{if(!g.current){g.current=!0;return}m.current!=null&&clearTimeout(m.current),m.current=setTimeout(()=>{f(Array.isArray(k.current)?k.current:[k.current]),m.current=null},B)},[B]),S=Cb({callback:E,disabled:w||!o}),L=Z.useCallback((V,U)=>{S&&(U&&(S.unobserve(U),g.current=!1),V&&S.observe(V))},[S]),[P,R]=Gx(L),Q=Kp(t);return Z.useEffect(()=>{!S||!P.current||(S.disconnect(),g.current=!1,S.observe(P.current))},[P,S]),Z.useEffect(()=>(c({type:li.RegisterDroppable,element:{id:a,key:n,disabled:r,node:P,rect:x,data:Q}}),()=>c({type:li.UnregisterDroppable,key:n,id:a})),[a]),Z.useEffect(()=>{r!==h.current.disabled&&(c({type:li.SetDroppableDisabled,id:a,key:n,disabled:r}),h.current.disabled=r)},[a,n,r,c]),{active:o,rect:x,isOver:u?.id===a,node:P,over:u,setNodeRef:R}}function QS(e,t,r){const a=e.slice();return a.splice(r<0?a.length+r:r,0,a.splice(t,1)[0]),a}function Xx(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const Zre=[ka.Down,ka.Right,ka.Up,ka.Left],eae=(e,t)=>{let{context:{active:r,collisionRect:a,droppableRects:s,droppableContainers:n,over:o,scrollableAncestors:c}}=t;if(Zre.includes(e.code)){if(e.preventDefault(),!r||!a)return;const u=[];n.getEnabled().forEach(g=>{if(!g||g!=null&&g.disabled)return;const x=s.get(g.id);if(x)switch(e.code){case ka.Down:a.top<x.top&&u.push(g);break;case ka.Up:a.top>x.top&&u.push(g);break;case ka.Left:a.left>x.left&&u.push(g);break;case ka.Right:a.left<x.left&&u.push(g);break}});const f=Vte({collisionRect:a,droppableRects:s,droppableContainers:u});let h=l6(f,"id");if(h===o?.id&&f.length>1&&(h=f[1].id),h!=null){const g=n.get(r.id),x=n.get(h),m=x?s.get(x.id):null,w=x?.node.current;if(w&&m&&g&&x){const B=Bb(w).some((R,Q)=>c[Q]!==R),k=b6(g,x),E=tae(g,x),S=B||!k?{x:0,y:0}:{x:E?a.width-m.width:0,y:E?a.height-m.height:0},L={x:m.left,y:m.top};return S.x&&S.y?L:zp(L,S)}}}};function b6(e,t){return!Xx(e)||!Xx(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function tae(e,t){return!Xx(e)||!Xx(t)||!b6(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const ms=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8","#82ca9d"],_2=({title:e,sql:t,config:r,globalFilters:a,showInspectorJump:s=!1,inspectorReturnHash:n})=>{const{t:o}=ds(),c=jA(),u=MS(),f=Z.useMemo(()=>{let M=t;if(!a||a.length===0)return M;const T=a.filter(G=>G.column&&(G.operator==="is null"||G.value));if(T.length===0)return M;const D=T.map(G=>{const ne=`"${G.column.replace(/"/g,'""')}"`,H=typeof G.value=="string"?`'${G.value.replace(/'/g,"''")}'`:G.value,ee=G.operator==="contains"?"LIKE":G.operator==="is null"?"IS NULL":G.operator;if(G.operator==="is null")return`${ne} IS NULL`;const le=G.operator==="contains"?`'%${G.value}%'`:H;return`${ne} ${ee} ${le}`}).join(" AND ");return M.toUpperCase().includes("WHERE")?M=M.replace(/WHERE/i,`WHERE (${D}) AND `):M.toUpperCase().includes("GROUP BY")?M=M.replace(/GROUP BY/i,`WHERE ${D} GROUP BY `):M.toUpperCase().includes("ORDER BY")?M=M.replace(/ORDER BY/i,`WHERE ${D} ORDER BY `):M.toUpperCase().includes("LIMIT")?M=M.replace(/LIMIT/i,`WHERE ${D} LIMIT `):M+=` WHERE ${D}`,M},[t,a]),h=s&&/^\s*SELECT\b/i.test(f),g=Wt.useCallback(()=>{if(!h)return;localStorage.setItem(Vm,f);const M=`#${u.pathname}${u.search||""}`;localStorage.setItem(Gm,n||M),c("/sql-workspace")},[h,f,n,u.pathname,u.search,c]),{data:x,loading:m,error:w}=Ai(async()=>r.type==="text"||r.type==="markdown"||r.type==="status"||r.type==="section"||r.type==="kpi_manual"||r.type==="kpu_manual"||r.type==="image"?[]:f?await jt.executeRaw(f):[],[f,r.type]),v=(r.imageUrl||"").trim(),[B,k]=Wt.useState(!1);Wt.useEffect(()=>{k(!1)},[v]);const[E,S]=Wt.useState(!1),[L,P]=Wt.useState(0),[R,Q]=Wt.useState(null);Wt.useEffect(()=>{if(x&&x.length>0){const M=t.match(/FROM\s+([a-zA-Z0-9_]+)/i),T=M?M[1]:"Dataset",D={title:e,description:`${o("widgets.data_inspector.description")}: ${T}`,type:"object",properties:Object.keys(x[0]).reduce((G,ne)=>{const ee=typeof x[0][ne]=="number"?"number":"string";return G[ne]={type:ee,description:ne},G},{})};Q(D)}},[x,t,e,o]);const V=Z.useMemo(()=>!x||x.length===0?[]:Object.keys(x[0]).map(M=>({header:M,accessor:M,render:T=>Ma(T[M],M)})),[x]),U={sm:"text-sm",md:"text-base",lg:"text-lg",xl:"text-xl","2xl":"text-2xl"};if(r.type==="text")return l.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-slate-800 rounded-xl border border-slate-300 dark:border-slate-700/50 shadow-sm hover:shadow-xl hover:shadow-slate-200/50 dark:hover:shadow-none transition-all duration-500 overflow-hidden",children:[l.jsx("div",{className:"flex items-center justify-between pt-2.5 pb-2.5 px-5 bg-slate-50/50 dark:bg-slate-900/20 border-b border-slate-200 dark:border-slate-800/50",children:l.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[l.jsx("div",{className:"p-1.5 rounded-xl shrink-0 shadow-sm text-blue-600 bg-blue-50 dark:bg-blue-900/20 dark:text-blue-400",children:l.jsx(dk,{className:"w-4 h-4"})}),l.jsxs("div",{className:"min-w-0",children:[l.jsx("h3",{className:"text-xs font-bold leading-snug text-slate-800 dark:text-white truncate tracking-tight",children:e}),l.jsx("div",{className:"h-0.5 w-4 bg-slate-200 dark:bg-slate-700 rounded-full mt-0.5"})]})]})}),l.jsx("div",{className:`flex-1 p-4 whitespace-pre-wrap break-words text-slate-800 dark:text-slate-100 ${U[r.textSize||"md"]} ${r.textBold?"font-bold":"font-normal"} ${r.textItalic?"italic":"not-italic"} ${r.textUnderline?"underline":"no-underline"} ${r.textAlign==="center"?"text-center":r.textAlign==="right"?"text-right":"text-left"}`,children:(r.textContent||"").trim()||o("querybuilder.text_placeholder")})]});if(r.type==="markdown")return l.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-slate-800 rounded-xl border border-slate-300 dark:border-slate-700/50 shadow-sm hover:shadow-xl hover:shadow-slate-200/50 dark:hover:shadow-none transition-all duration-500 overflow-hidden",children:[l.jsx("div",{className:"flex items-center justify-between pt-2.5 pb-2.5 px-5 bg-slate-50/50 dark:bg-slate-900/20 border-b border-slate-200 dark:border-slate-800/50",children:l.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[l.jsx("div",{className:"p-1.5 rounded-xl shrink-0 shadow-sm text-blue-600 bg-blue-50 dark:bg-blue-900/20 dark:text-blue-400",children:l.jsx(xf,{className:"w-4 h-4"})}),l.jsxs("div",{className:"min-w-0",children:[l.jsx("h3",{className:"text-xs font-bold leading-snug text-slate-800 dark:text-white truncate tracking-tight",children:e}),l.jsx("div",{className:"h-0.5 w-4 bg-slate-200 dark:bg-slate-700 rounded-full mt-0.5"})]})]})}),l.jsx("div",{className:"flex-1 p-4 overflow-auto text-slate-800 dark:text-slate-100",children:l.jsx(e6,{markdown:(r.markdownContent||"").trim(),emptyText:o("querybuilder.markdown_placeholder",`# Titel
Text mit **Fett** und [Link](https://example.com)`),className:"text-sm leading-6"})})]});if(r.type==="status"){const M=r.statusLevel||"ok",D={ok:{ring:"ring-emerald-200 bg-emerald-50 dark:bg-emerald-900/20",dot:"bg-emerald-500",title:"text-emerald-800 dark:text-emerald-300",text:"text-emerald-700/90 dark:text-emerald-200/90"},info:{ring:"ring-blue-200 bg-blue-50 dark:bg-blue-900/20",dot:"bg-blue-500",title:"text-blue-800 dark:text-blue-300",text:"text-blue-700/90 dark:text-blue-200/90"},warning:{ring:"ring-amber-200 bg-amber-50 dark:bg-amber-900/20",dot:"bg-amber-500",title:"text-amber-800 dark:text-amber-300",text:"text-amber-700/90 dark:text-amber-200/90"},critical:{ring:"ring-rose-200 bg-rose-50 dark:bg-rose-900/20",dot:"bg-rose-500",title:"text-rose-800 dark:text-rose-300",text:"text-rose-700/90 dark:text-rose-200/90"}}[M];return l.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-slate-800 rounded-xl border border-slate-300 dark:border-slate-700/50 shadow-sm hover:shadow-xl hover:shadow-slate-200/50 dark:hover:shadow-none transition-all duration-500 overflow-hidden",children:[l.jsx("div",{className:"flex items-center justify-between pt-2.5 pb-2.5 px-5 bg-slate-50/50 dark:bg-slate-900/20 border-b border-slate-200 dark:border-slate-800/50",children:l.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[l.jsx("div",{className:"p-1.5 rounded-xl shrink-0 shadow-sm text-blue-600 bg-blue-50 dark:bg-blue-900/20 dark:text-blue-400",children:l.jsx(Cn,{className:"w-4 h-4"})}),l.jsxs("div",{className:"min-w-0",children:[l.jsx("h3",{className:"text-xs font-bold leading-snug text-slate-800 dark:text-white truncate tracking-tight",children:e}),l.jsx("div",{className:"h-0.5 w-4 bg-slate-200 dark:bg-slate-700 rounded-full mt-0.5"})]})]})}),l.jsx("div",{className:"flex-1 p-4 flex items-center justify-center",children:l.jsxs("div",{className:`w-full rounded-xl ring-1 ${D.ring} p-5`,children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:`relative inline-flex h-3.5 w-3.5 rounded-full ${D.dot}`,children:r.statusPulse&&l.jsx("span",{className:`absolute inline-flex h-full w-full rounded-full ${D.dot} opacity-75 animate-ping`})}),l.jsx("span",{className:`text-[11px] font-black uppercase tracking-wider ${D.title}`,children:o(`querybuilder.status_level_${M}`,M)})]}),l.jsx("div",{className:`mt-3 text-lg font-bold ${D.title}`,children:(r.statusTitle||"").trim()||o("querybuilder.status_placeholder_title","System status")}),l.jsx("p",{className:`mt-2 text-sm ${D.text}`,children:(r.statusMessage||"").trim()||o("querybuilder.status_placeholder_message","All core systems are running stable.")})]})})]})}if(r.type==="section"){const M=r.sectionAlign||"left",T=M==="center"?"text-center":M==="right"?"text-right":"text-left",D=r.sectionDividerStyle||"line";return l.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-slate-800 rounded-xl border border-slate-300 dark:border-slate-700/50 shadow-sm hover:shadow-xl hover:shadow-slate-200/50 dark:hover:shadow-none transition-all duration-500 overflow-hidden",children:[l.jsx("div",{className:"flex items-center justify-between pt-2.5 pb-2.5 px-5 bg-slate-50/50 dark:bg-slate-900/20 border-b border-slate-200 dark:border-slate-800/50",children:l.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[l.jsx("div",{className:"p-1.5 rounded-xl shrink-0 shadow-sm text-blue-600 bg-blue-50 dark:bg-blue-900/20 dark:text-blue-400",children:l.jsx(wn,{className:"w-4 h-4"})}),l.jsxs("div",{className:"min-w-0",children:[l.jsx("h3",{className:"text-xs font-bold leading-snug text-slate-800 dark:text-white truncate tracking-tight",children:e}),l.jsx("div",{className:"h-0.5 w-4 bg-slate-200 dark:bg-slate-700 rounded-full mt-0.5"})]})]})}),l.jsx("div",{className:"flex-1 p-5 flex flex-col justify-center",children:l.jsxs("div",{className:`w-full ${T}`,children:[l.jsx("h2",{className:"text-2xl font-black tracking-tight text-slate-800 dark:text-slate-100",children:(r.sectionTitle||"").trim()||o("querybuilder.section_placeholder_title","Section title")}),(r.sectionSubtitle||"").trim()&&l.jsx("p",{className:"mt-1 text-sm text-slate-500 dark:text-slate-400",children:r.sectionSubtitle}),D==="line"&&l.jsx("div",{className:`mt-4 h-px bg-slate-300 dark:bg-slate-700 ${M==="center"?"mx-auto w-2/3":M==="right"?"ml-auto w-2/3":"w-2/3"}`}),D==="double"&&l.jsxs("div",{className:`mt-4 space-y-1 ${M==="center"?"mx-auto w-2/3":M==="right"?"ml-auto w-2/3":"w-2/3"}`,children:[l.jsx("div",{className:"h-px bg-slate-300 dark:bg-slate-700"}),l.jsx("div",{className:"h-px bg-slate-300 dark:bg-slate-700"})]})]})})]})}if(r.type==="kpi_manual"||r.type==="kpu_manual"){const M=r.kpiTrend||r.kpuTrend||"flat",T=K=>{if(!K)return Number.NaN;const I=K.replace(/\s+/g,"").replace(",",".").replace(/[^0-9.+-]/g,"");return Number(I)},D=T(r.kpiValue||r.kpuValue),G=T(r.kpiTarget||r.kpuTarget),ne=r.kpiAlign||r.kpuAlign||"left",H=ne==="center"?"text-center":ne==="right"?"text-right":"text-left",ee=ne==="center"?"justify-center":ne==="right"?"justify-end":"justify-start",le=Number.isFinite(D)&&Number.isFinite(G)&&G!==0,pe=le?D/G:Number.NaN,te=le?pe>=1?"ok":pe>=.95?"warn":"crit":"neutral",Le=M==="up"?"text-emerald-700 dark:text-emerald-300 bg-emerald-50 dark:bg-emerald-900/20":M==="down"?"text-rose-700 dark:text-rose-300 bg-rose-50 dark:bg-rose-900/20":"text-slate-700 dark:text-slate-300 bg-slate-100 dark:bg-slate-700/40",je=te==="ok"?"text-emerald-700 dark:text-emerald-300 bg-emerald-50 dark:bg-emerald-900/20 border-emerald-200 dark:border-emerald-800":te==="warn"?"text-amber-700 dark:text-amber-300 bg-amber-50 dark:bg-amber-900/20 border-amber-200 dark:border-amber-800":te==="crit"?"text-rose-700 dark:text-rose-300 bg-rose-50 dark:bg-rose-900/20 border-rose-200 dark:border-rose-800":"text-slate-600 dark:text-slate-300 bg-slate-100 dark:bg-slate-700/40 border-slate-200 dark:border-slate-700",F=te==="ok"?"text-emerald-700 dark:text-emerald-300":te==="warn"?"text-amber-700 dark:text-amber-300":te==="crit"?"text-rose-700 dark:text-rose-300":"text-slate-900 dark:text-slate-100";return l.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-slate-800 rounded-xl border border-slate-300 dark:border-slate-700/50 shadow-sm hover:shadow-xl hover:shadow-slate-200/50 dark:hover:shadow-none transition-all duration-500 overflow-hidden",children:[l.jsx("div",{className:"flex items-center justify-between pt-2.5 pb-2.5 px-5 bg-slate-50/50 dark:bg-slate-900/20 border-b border-slate-200 dark:border-slate-800/50",children:l.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[l.jsx("div",{className:"p-1.5 rounded-xl shrink-0 shadow-sm text-blue-600 bg-blue-50 dark:bg-blue-900/20 dark:text-blue-400",children:l.jsx(zm,{className:"w-4 h-4"})}),l.jsxs("div",{className:"min-w-0",children:[l.jsx("h3",{className:"text-xs font-bold leading-snug text-slate-800 dark:text-white truncate tracking-tight",children:e}),l.jsx("div",{className:"h-0.5 w-4 bg-slate-200 dark:bg-slate-700 rounded-full mt-0.5"})]})]})}),l.jsx("div",{className:"flex-1 p-5 flex items-center justify-center",children:l.jsxs("div",{className:`w-full rounded-xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 p-5 ${H}`,children:[l.jsx("div",{className:"text-[10px] font-black uppercase tracking-wider text-slate-400",children:(r.kpiTitle||r.kpuTitle||"").trim()||o("querybuilder.kpi_placeholder_title","KPI")}),l.jsxs("div",{className:`mt-3 flex items-end gap-2 ${ee}`,children:[l.jsx("div",{className:`text-4xl font-black tracking-tight ${F}`,children:(r.kpiValue||r.kpuValue||"").trim()||"--"}),(r.kpiUnit||r.kpuUnit||"").trim()&&l.jsx("div",{className:"pb-1 text-sm font-bold text-slate-500 dark:text-slate-400",children:r.kpiUnit||r.kpuUnit})]}),l.jsxs("div",{className:`mt-3 flex flex-wrap items-center gap-2 ${ee}`,children:[l.jsxs("span",{className:"px-2 py-1 rounded-full text-[10px] font-black uppercase tracking-wide bg-blue-50 text-blue-700 dark:bg-blue-900/20 dark:text-blue-300",children:[o("querybuilder.kpi_target","Target"),": ",(r.kpiTarget||r.kpuTarget||"").trim()||"-"]}),l.jsx("span",{className:`px-2 py-1 rounded-full text-[10px] font-black uppercase tracking-wide ${Le}`,children:o(`querybuilder.kpi_trend_${M}`,M)}),l.jsx("span",{className:`px-2 py-1 rounded-full border text-[10px] font-black uppercase tracking-wide ${je}`,children:te==="ok"?o("querybuilder.kpi_status_on_target","On target"):te==="warn"?o("querybuilder.kpi_status_near_target","Near target"):te==="crit"?o("querybuilder.kpi_status_below_target","Below target"):o("querybuilder.kpi_status_no_compare","No target comparison")})]}),(r.kpiNote||r.kpuNote||"").trim()&&l.jsx("p",{className:"mt-3 text-xs text-slate-500 dark:text-slate-400",children:r.kpiNote||r.kpuNote})]})})]})}if(r.type==="image"){const M=r.imageAlign||"center",T=M==="left"?"items-start":M==="right"?"items-end":"items-center",D=v;return l.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-slate-800 rounded-xl border border-slate-300 dark:border-slate-700/50 shadow-sm hover:shadow-xl hover:shadow-slate-200/50 dark:hover:shadow-none transition-all duration-500 overflow-hidden",children:[l.jsx("div",{className:"flex items-center justify-between pt-2.5 pb-2.5 px-5 bg-slate-50/50 dark:bg-slate-900/20 border-b border-slate-200 dark:border-slate-800/50",children:l.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[l.jsx("div",{className:"p-1.5 rounded-xl shrink-0 shadow-sm text-blue-600 bg-blue-50 dark:bg-blue-900/20 dark:text-blue-400",children:l.jsx(ff,{className:"w-4 h-4"})}),l.jsxs("div",{className:"min-w-0",children:[l.jsx("h3",{className:"text-xs font-bold leading-snug text-slate-800 dark:text-white truncate tracking-tight",children:e}),l.jsx("div",{className:"h-0.5 w-4 bg-slate-200 dark:bg-slate-700 rounded-full mt-0.5"})]})]})}),l.jsx("div",{className:"flex-1 p-5",children:l.jsx("div",{className:`h-full w-full flex flex-col ${T} justify-center`,children:D&&!B?l.jsxs(l.Fragment,{children:[l.jsx("img",{src:D,alt:(r.imageAlt||"").trim()||"Image widget",referrerPolicy:"no-referrer",crossOrigin:"anonymous",onError:()=>k(!0),className:`max-h-[320px] w-full rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 ${r.imageFit==="cover"?"object-cover":"object-contain"}`}),(r.imageCaption||"").trim()&&l.jsx("p",{className:"mt-2 text-xs text-slate-500 dark:text-slate-400",children:r.imageCaption})]}):D?l.jsx("div",{className:"w-full rounded-lg border border-amber-300 bg-amber-50 dark:bg-amber-900/20 dark:border-amber-700 p-3 text-amber-900 dark:text-amber-200",children:l.jsxs("div",{className:"flex items-start gap-2",children:[l.jsx(Cn,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),l.jsxs("div",{className:"min-w-0",children:[l.jsx("p",{className:"text-xs font-bold",children:o("querybuilder.image_load_error_title","Image could not be loaded.")}),l.jsx("p",{className:"text-[11px] mt-1",children:o("querybuilder.image_load_error_hint","Please check URL access and CORS/hotlink protection.")}),l.jsx("p",{className:"text-[10px] mt-1 font-mono break-all opacity-80",children:D})]})]})}):l.jsxs("div",{className:"h-[220px] w-full rounded-lg border border-dashed border-slate-300 dark:border-slate-700 flex flex-col items-center justify-center text-slate-400",children:[l.jsx(ff,{className:"w-8 h-8 mb-2 opacity-60"}),l.jsx("p",{className:"text-xs font-semibold text-center",children:o("querybuilder.image_empty_hint","Please provide an image URL.")})]})})})]})}return m?l.jsx("div",{className:"h-full flex items-center justify-center text-slate-400",children:l.jsx(nx,{className:"w-6 h-6 animate-spin"})}):w?l.jsx("div",{className:"h-full flex items-center justify-center text-red-400 p-4 text-center",children:l.jsxs("div",{className:"flex flex-col items-center gap-2",children:[l.jsx(Cn,{className:"w-6 h-6"}),l.jsx("span",{className:"text-xs",children:w.message})]})}):!x||x.length===0?l.jsx("div",{className:"h-full flex items-center justify-center text-slate-400 text-sm",children:o("common.no_data")}):l.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-slate-800 rounded-xl border border-slate-300 dark:border-slate-700/50 shadow-sm hover:shadow-xl hover:shadow-slate-200/50 dark:hover:shadow-none transition-all duration-500 overflow-hidden",children:[l.jsxs("div",{className:"flex items-center justify-between pt-2.5 pb-2.5 px-5 bg-slate-50/50 dark:bg-slate-900/20 border-b border-slate-200 dark:border-slate-800/50",children:[l.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[l.jsx("div",{className:"p-1.5 rounded-xl shrink-0 shadow-sm text-blue-600 bg-blue-50 dark:bg-blue-900/20 dark:text-blue-400",children:l.jsx(dk,{className:"w-4 h-4"})}),l.jsxs("div",{className:"min-w-0",children:[l.jsx("h3",{className:"text-xs font-bold leading-snug text-slate-800 dark:text-white truncate tracking-tight",children:e}),l.jsx("div",{className:"h-0.5 w-4 bg-slate-200 dark:bg-slate-700 rounded-full mt-0.5"})]})]}),h&&l.jsxs("button",{type:"button",onClick:g,className:"inline-flex items-center gap-1.5 px-2 py-1 text-[10px] font-bold uppercase tracking-wider rounded-md border border-slate-200 dark:border-slate-700 text-slate-500 hover:text-blue-600 hover:border-blue-300 dark:hover:border-blue-600 transition-colors",title:o("common.open_in_inspector"),children:[l.jsx(Vu,{className:"w-3 h-3"}),o("common.open")]})]}),l.jsx("div",{className:"flex-1 min-h-0 p-2",children:r.type==="table"?l.jsx("div",{className:"h-full overflow-auto",children:l.jsx(Tx,{columns:V,data:x,onRowClick:M=>{const T=x.indexOf(M);P(T>=0?T:0),S(!0)}})}):r.type==="pivot"?l.jsx(p2,{data:x,rows:r.pivotRows||[],cols:r.pivotCols||[],measures:r.pivotMeasures||[]}):r.type==="kpi"?l.jsx("div",{className:"h-full flex flex-col items-center justify-center p-4",children:x&&x.length>0?(()=>{const M=x[0][Object.keys(x[0])[0]],T=Number(M);let D="text-slate-900 dark:text-white";if(r.rules&&!isNaN(T))for(const G of r.rules){let ne=!1;switch(G.operator){case">":ne=T>G.value;break;case"<":ne=T<G.value;break;case">=":ne=T>=G.value;break;case"<=":ne=T<=G.value;break;case"==":ne=T===G.value;break}if(ne){G.color==="green"?D="text-emerald-500":G.color==="red"?D="text-rose-500":G.color==="yellow"?D="text-amber-500":G.color==="blue"?D="text-blue-500":D=`text-[${G.color}]`;break}}return l.jsxs("div",{className:"flex flex-col items-center text-center animate-in zoom-in-95 duration-500",children:[l.jsx("div",{className:`text-4xl md:text-5xl lg:text-6xl font-black tracking-widest break-all transition-colors duration-300 ${D}`,children:Ma(M,Object.keys(x[0])[0])}),l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-[0.3em] mt-3",children:Object.keys(x[0])[0]})]})})():l.jsx("div",{className:"text-slate-300 text-[10px] font-bold uppercase tracking-widest",children:o("common.no_data")})}):l.jsx(XS,{width:"100%",height:"100%",minWidth:0,children:r.type==="bar"?l.jsxs(YS,{data:x,children:[l.jsx(pc,{strokeDasharray:"3 3",vertical:!1,stroke:"#e2e8f0"}),l.jsx(gc,{dataKey:r.xAxis,axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#64748b"}}),l.jsx(mc,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#64748b"},tickFormatter:M=>Ma(M,(r.yAxes||[])[0])}),l.jsx(Jl,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1)"},cursor:{fill:"#f1f5f9"},formatter:(M,T)=>[Ma(M,T),T]}),l.jsx(Zl,{verticalAlign:"top",height:36,iconType:"circle",wrapperStyle:{fontSize:"10px",fontWeight:"bold",textTransform:"uppercase"}}),(r.yAxes||(r.yAxis?[r.yAxis]:[])).map((M,T)=>l.jsx(ox,{dataKey:M,fill:T===0?r.color||ms[0]:ms[T%ms.length],radius:[4,4,0,0],children:r.showLabels&&l.jsx(xc,{dataKey:M,position:"top",style:{fontSize:"10px",fontWeight:"bold",fill:"#64748b"},formatter:D=>Ma(D,M)})},M))]}):r.type==="line"?l.jsxs(JS,{data:x,children:[l.jsx(pc,{strokeDasharray:"3 3",vertical:!1,stroke:"#e2e8f0"}),l.jsx(gc,{dataKey:r.xAxis,axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#64748b"}}),l.jsx(mc,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#64748b"},tickFormatter:M=>Ma(M,(r.yAxes||[])[0])}),l.jsx(Jl,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1)"},formatter:(M,T)=>[Ma(M,T),T]}),l.jsx(Zl,{verticalAlign:"top",height:36,iconType:"circle",wrapperStyle:{fontSize:"10px",fontWeight:"bold",textTransform:"uppercase"}}),(r.yAxes||(r.yAxis?[r.yAxis]:[])).map((M,T)=>l.jsx(Ax,{type:"monotone",dataKey:M,stroke:T===0?r.color||ms[0]:ms[T%ms.length],strokeWidth:3,dot:{r:4},activeDot:{r:6},children:r.showLabels&&l.jsx(xc,{dataKey:M,position:"top",offset:10,style:{fontSize:"10px",fontWeight:"bold",fill:"#64748b"},formatter:D=>Ma(D,M)})},M))]}):r.type==="area"?l.jsxs(ZS,{data:x,children:[l.jsx("defs",{children:(r.yAxes||(r.yAxis?[r.yAxis]:[])).map((M,T)=>l.jsxs("linearGradient",{id:`color-${M}-${e.replace(/\s+/g,"")}`,x1:"0",y1:"0",x2:"0",y2:"1",children:[l.jsx("stop",{offset:"5%",stopColor:T===0?r.color||ms[0]:ms[T%ms.length],stopOpacity:.8}),l.jsx("stop",{offset:"95%",stopColor:T===0?r.color||ms[0]:ms[T%ms.length],stopOpacity:0})]},`grad-${M}`))}),l.jsx(gc,{dataKey:r.xAxis,axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#64748b"}}),l.jsx(mc,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#64748b"},tickFormatter:M=>Ma(M,(r.yAxes||[])[0])}),l.jsx(pc,{strokeDasharray:"3 3",vertical:!1,stroke:"#e2e8f0"}),l.jsx(Jl,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1)"},formatter:(M,T)=>[Ma(M,T),T]}),l.jsx(Zl,{verticalAlign:"top",height:36,iconType:"circle",wrapperStyle:{fontSize:"10px",fontWeight:"bold"}}),(r.yAxes||(r.yAxis?[r.yAxis]:[])).map((M,T)=>l.jsx(e3,{type:"monotone",dataKey:M,stroke:T===0?r.color||ms[0]:ms[T%ms.length],strokeWidth:3,fillOpacity:1,fill:`url(#color-${M}-${e.replace(/\s+/g,"")})`,children:r.showLabels&&l.jsx(xc,{dataKey:M,position:"top",style:{fontSize:"10px",fontWeight:"bold",fill:"#64748b"},formatter:D=>Ma(D,M)})},M))]}):r.type==="pie"?l.jsxs(t3,{children:[l.jsx(r3,{data:x,cx:"50%",cy:"50%",labelLine:!1,label:({name:M,percent:T})=>`${M??""} ${(T?T*100:0).toFixed(0)}%`,outerRadius:80,innerRadius:50,paddingAngle:5,dataKey:(r.yAxes||(r.yAxis?[r.yAxis]:[]))[0]||"",nameKey:r.xAxis,children:x.map((M,T)=>l.jsx(a3,{fill:ms[T%ms.length],stroke:"white",strokeWidth:2},`cell-${T}`))}),l.jsx(Jl,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1)"}}),l.jsx(Zl,{verticalAlign:"bottom",height:36,iconSize:8,wrapperStyle:{fontSize:"10px",fontWeight:"bold"}})]}):r.type==="composed"?l.jsxs(s3,{data:x,children:[l.jsx(pc,{strokeDasharray:"3 3",vertical:!1,stroke:"#e2e8f0"}),l.jsx(gc,{dataKey:r.xAxis,axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#64748b"}}),l.jsx(mc,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#64748b"},tickFormatter:M=>Ma(M,(r.yAxes||[])[0])}),l.jsx(Jl,{contentStyle:{borderRadius:"12px",border:"none"},formatter:(M,T)=>[Ma(M,T),T]}),l.jsx(Zl,{verticalAlign:"top",height:36,iconType:"circle"}),(r.yAxes||[]).map((M,T)=>r.lineSeries?.includes(M)?l.jsx(Ax,{type:"monotone",dataKey:M,stroke:ms[T%ms.length],strokeWidth:3,children:r.showLabels&&l.jsx(xc,{dataKey:M,position:"top",style:{fontSize:"10px",fontWeight:"bold",fill:"#64748b"},formatter:D=>Ma(D,M)})},M):l.jsx(ox,{dataKey:M,fill:ms[T%ms.length],radius:[4,4,0,0],children:r.showLabels&&l.jsx(xc,{dataKey:M,position:"top",style:{fontSize:"10px",fontWeight:"bold",fill:"#64748b"},formatter:D=>Ma(D,M)})},M))]}):r.type==="radar"?l.jsxs(n3,{cx:"50%",cy:"50%",outerRadius:"80%",data:x,children:[l.jsx(i3,{stroke:"#e2e8f0"}),l.jsx(l3,{dataKey:r.xAxis,tick:{fontSize:10,fill:"#64748b"}}),l.jsx(o3,{angle:30,domain:[0,"auto"],tick:{fontSize:8}}),(r.yAxes||[]).map((M,T)=>l.jsx(A3,{name:M,dataKey:M,stroke:ms[T%ms.length],fill:ms[T%ms.length],fillOpacity:.6},M)),l.jsx(Zl,{iconType:"circle",wrapperStyle:{fontSize:"10px"}}),l.jsx(Jl,{})]}):r.type==="scatter"?l.jsxs(c3,{children:[l.jsx(pc,{strokeDasharray:"3 3",vertical:!1,stroke:"#e2e8f0"}),l.jsx(gc,{type:"number",dataKey:r.xAxis,name:r.xAxis,axisLine:!1,tickLine:!1,tick:{fontSize:10}}),l.jsx(mc,{type:"number",dataKey:(r.yAxes||[])[0],name:(r.yAxes||[])[0],axisLine:!1,tickLine:!1,tick:{fontSize:10}}),l.jsx(Jl,{cursor:{strokeDasharray:"3 3"}}),l.jsx(Zl,{verticalAlign:"top",height:36}),l.jsx(u3,{name:e,data:x,fill:r.color||ms[0]})]}):r.type==="pivot"?l.jsx(p2,{data:x,rows:r.pivotRows||[],cols:r.pivotCols||[],measures:r.pivotMeasures||[]}):null})}),x&&x.length>0&&l.jsx(cb,{isOpen:E,onClose:()=>S(!1),items:x,initialIndex:L,title:e,schema:R||void 0,tableName:t.match(/FROM\s+([a-zA-Z0-9_]+)/i)?.[1]})]})},rae={blue:"text-blue-600 bg-blue-50 dark:bg-blue-900/20 dark:text-blue-400",emerald:"text-emerald-600 bg-emerald-50 dark:bg-emerald-900/20 dark:text-emerald-400",rose:"text-rose-600 bg-rose-50 dark:bg-rose-900/20 dark:text-rose-400",amber:"text-amber-600 bg-amber-50 dark:bg-amber-900/20 dark:text-amber-400",indigo:"text-indigo-600 bg-indigo-50 dark:bg-indigo-900/20 dark:text-indigo-400",slate:"text-slate-600 bg-slate-50 dark:bg-slate-900/20 dark:text-slate-400"},og=({title:e,icon:t,iconColor:r="blue",children:a,onRemove:s,onClick:n,targetView:o,footerLeft:c,footerRight:u,className:f,backgroundIcon:h})=>{const{t:g}=ds(),x=jA(),m=c||u||o,w=c||(o&&!u?l.jsxs("button",{onClick:v=>{v.stopPropagation(),x(o)},className:"flex items-center gap-1.5 text-[10px] font-black text-slate-400 hover:text-blue-600 uppercase tracking-widest transition-colors group/footer",children:[g("common.open_details"),l.jsx(Yl,{className:"w-3 h-3 transition-transform group-hover/footer:translate-x-0.5"})]}):null);return l.jsxs("div",{className:ni("group relative flex flex-col bg-white dark:bg-slate-800 rounded-xl border border-slate-300 dark:border-slate-700/50 shadow-sm hover:shadow-xl hover:shadow-slate-200/50 dark:hover:shadow-none transition-all duration-500 overflow-hidden h-full",n&&"cursor-pointer active:scale-[0.98]",f),children:[h&&l.jsx("div",{className:"absolute -right-8 -bottom-8 text-slate-50/50 dark:text-slate-900/20 group-hover:text-slate-100/50 dark:group-hover:text-slate-900/40 transition-colors duration-500",children:l.jsx(h,{size:160,strokeWidth:1})}),l.jsxs("div",{className:"relative flex items-center justify-between pt-2.5 pb-2.5 px-5 bg-slate-50/50 dark:bg-slate-900/20 border-b border-slate-200 dark:border-slate-800/50",children:[l.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[l.jsx("div",{className:ni("p-1.5 rounded-xl shrink-0 shadow-sm",rae[r]),children:l.jsx(t,{className:"w-4 h-4"})}),l.jsxs("div",{className:"min-w-0",children:[l.jsx("h3",{className:"text-xs font-bold leading-snug text-slate-800 dark:text-white truncate tracking-tight",children:e}),l.jsx("div",{className:"h-0.5 w-4 bg-slate-200 dark:bg-slate-700 rounded-full mt-0.5 group-hover:w-8 transition-all duration-500"})]})]}),l.jsx("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-all duration-300 translate-x-2 group-hover:translate-x-0",children:s&&l.jsx("button",{onClick:v=>{v.stopPropagation(),s()},className:"p-1 text-slate-400 hover:text-rose-600 hover:bg-rose-50 dark:hover:bg-rose-900/20 rounded-lg transition-colors",title:g("common.remove"),children:l.jsx(vl,{className:"w-3.5 h-3.5"})})})]}),l.jsx("div",{className:"relative flex-1 p-4 px-5 pt-2 min-h-0",onClick:n,children:a}),m&&l.jsxs("div",{className:"relative p-3 px-5 border-t border-slate-200 dark:border-slate-800/50 bg-slate-50/50 dark:bg-slate-900/30 flex items-center justify-between min-h-[40px]",children:[l.jsx("div",{className:"flex-1 min-w-0",children:w}),l.jsx("div",{className:"shrink-0",children:u})]}),l.jsx("div",{className:"absolute inset-0 pointer-events-none border border-transparent group-hover:border-blue-500/10 dark:group-hover:border-blue-400/10 rounded-xl transition-colors"})]})},aae=({onRemove:e,dragHandleProps:t,onClick:r,targetView:a})=>{const{t:s,i18n:n}=ds(),[o,c]=Z.useState(new Date);Z.useEffect(()=>{const g=setInterval(()=>c(new Date),1e3);return()=>clearInterval(g)},[]);const u=Z.useMemo(()=>new Intl.DateTimeFormat(n.language==="de"?"de-DE":"en-US",{weekday:"long",day:"2-digit",month:"long"}).format(o),[o,n.language]),f=o.toLocaleTimeString(n.language==="de"?"de-DE":"en-US",{hour:"2-digit",minute:"2-digit"});return l.jsx(og,{title:s("widgets.clock.title"),icon:lx,iconColor:"indigo",onRemove:e,dragHandleProps:t,onClick:r,targetView:a,backgroundIcon:lx,children:l.jsx("div",{className:"flex flex-col h-full items-center justify-center -mt-2",children:l.jsxs("div",{className:"text-center group-hover:scale-110 transition-transform duration-700",children:[l.jsxs("div",{className:"flex items-baseline justify-center gap-1.5",children:[l.jsx("span",{className:"text-6xl font-black text-slate-900 dark:text-white tracking-tighter tabular-nums leading-none",children:f}),l.jsx("span",{className:"text-xs font-black text-indigo-500/80 dark:text-indigo-400/80 uppercase tracking-widest tabular-nums",children:"CET"})]}),l.jsxs("div",{className:"mt-4 flex flex-col items-center",children:[l.jsx("div",{className:"h-px w-8 bg-slate-100 dark:bg-slate-800 mb-4"}),l.jsxs("div",{className:"flex items-center gap-2 px-4 py-1.5 bg-slate-50 dark:bg-slate-900/40 rounded-2xl border border-slate-100 dark:border-slate-800/50",children:[l.jsx(Z8,{className:"w-3.5 h-3.5 text-slate-400 flex-shrink-0"}),l.jsx("span",{className:"text-xs font-bold text-slate-600 dark:text-slate-300 tracking-tight whitespace-nowrap",children:u})]})]})]})})})},sae=({className:e=""})=>l.jsx("div",{className:`animate-shimmer bg-slate-100 dark:bg-slate-800 rounded ${e}`}),nae=({onRemove:e,dragHandleProps:t,onClick:r,targetView:a})=>{const{t:s}=ds(),n=jA(),{data:o,loading:c,error:u}=Ai(()=>jt.getDatabaseStats(),[],{cacheKey:"db-stats-tile",ttl:600*1e3});if(u)return l.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-red-200 dark:border-red-900/50 p-4 h-full flex items-center justify-center text-center",children:l.jsx("p",{className:"text-red-500 font-bold text-[10px] uppercase",children:s("common.error")})});const f=()=>{r&&r(),n("/inspector")};return l.jsx(og,{title:s("widgets.data_inspector.title"),icon:Zo,iconColor:"indigo",onClick:r||f,onRemove:e,targetView:a,dragHandleProps:t,backgroundIcon:Zo,className:"cursor-pointer",footerLeft:l.jsxs("button",{onClick:h=>{h.stopPropagation(),n("/inspector")},className:"flex items-center gap-1.5 text-[10px] font-black text-slate-400 hover:text-indigo-600 uppercase tracking-widest transition-colors group/footer",children:[s("widgets.data_inspector.details"),l.jsx(Zo,{className:"w-3 h-3 transition-transform group-hover/footer:scale-110"})]}),children:l.jsxs("div",{className:"flex flex-col h-full items-center justify-around py-2",children:[l.jsxs("div",{className:"text-center group-hover:scale-105 transition-transform duration-500",children:[l.jsxs("div",{className:"flex items-center justify-center gap-1.5 text-[10px] font-black text-indigo-600 dark:text-indigo-400 uppercase tracking-widest mb-1",children:[l.jsx(CA,{className:"w-3 h-3"}),l.jsx("span",{children:s("widgets.data_inspector.records_total")})]}),l.jsx("div",{className:"text-4xl font-black text-slate-900 dark:text-white tracking-tighter tabular-nums leading-none",children:c||!o?l.jsx(sae,{className:"h-8 w-20 mx-auto"}):o.records.toLocaleString()})]}),l.jsxs("div",{className:"w-full pt-4 border-t border-slate-200 dark:border-slate-800/50 text-center",children:[l.jsxs("div",{className:"flex items-center justify-center gap-1.5 text-[10px] font-black text-indigo-500 dark:text-indigo-400 uppercase tracking-widest mb-1",children:[l.jsx(wl,{className:"w-3 h-3"}),l.jsx("span",{children:s("widgets.data_inspector.tables")})]}),l.jsx("div",{className:"text-2xl font-black text-slate-700 dark:text-slate-300 tabular-nums leading-none",children:c||!o?"...":o.tables})]})]})})},iae=({onRemove:e,dragHandleProps:t,onClick:r,targetView:a})=>{const{t:s}=ds(),[n,o]=Z.useState(!1),[c,u]=Z.useState(null),[f,h]=Z.useState(null);Wt.useEffect(()=>{const x=performance.getEntriesByType("navigation")[0];x&&h(Math.round(x.duration));const m=()=>{const v=performance;if(v.memory){const B=v.memory;u({used:Math.round(B.usedJSHeapSize/1024/1024),total:Math.round(B.jsHeapSizeLimit/1024/1024)})}};m();const w=setInterval(m,5e3);return()=>clearInterval(w)},[]);const g=()=>{o(!0),r&&r()};return l.jsxs(l.Fragment,{children:[l.jsx(og,{title:s("widgets.system_status.title"),icon:r0,iconColor:"emerald",onRemove:e,dragHandleProps:t,onClick:g,targetView:a,backgroundIcon:r0,className:"cursor-pointer",footerLeft:l.jsxs("button",{onClick:x=>{x.stopPropagation(),o(!0)},className:"flex items-center gap-1.5 text-[10px] font-black text-slate-400 hover:text-blue-600 uppercase tracking-widest transition-colors group/footer",children:[s("widgets.system_status.details"),l.jsx(r0,{className:"w-3 h-3 transition-transform group-hover/footer:scale-110"})]}),children:l.jsxs("div",{className:"flex flex-col h-full items-center justify-around py-2",children:[l.jsxs("div",{className:"text-center group-hover:scale-105 transition-transform duration-500",children:[l.jsxs("div",{className:"flex items-center justify-center gap-1.5 text-[10px] font-black text-emerald-600 dark:text-emerald-400 uppercase tracking-widest mb-1",children:[l.jsx(HS,{className:"w-3 h-3"}),l.jsx("span",{children:s("widgets.system_status.memory_usage")})]}),l.jsx("div",{className:"text-4xl font-black text-slate-900 dark:text-white tracking-tighter tabular-nums leading-none",children:c?`${c.used} MB`:"---"}),l.jsx("div",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-tighter mt-1",children:s("widgets.system_status.heap_from",{total:c?c.total:"---"})})]}),l.jsxs("div",{className:"w-full pt-4 border-t border-slate-200 dark:border-slate-800/50 text-center",children:[l.jsxs("div",{className:"flex items-center justify-center gap-1.5 text-[10px] font-black text-blue-500 dark:text-blue-400 uppercase tracking-widest mb-1",children:[l.jsx(eL,{className:"w-3 h-3"}),l.jsx("span",{children:s("widgets.system_status.load_time")})]}),l.jsx("div",{className:"text-2xl font-black text-slate-700 dark:text-slate-300 tabular-nums leading-none",children:f?`${f} ms`:"---"})]})]})}),l.jsx(g_,{isOpen:n,onClose:()=>o(!1)})]})},lae=({onRemove:e,dragHandleProps:t,onClick:r,targetView:a,isOverlay:s})=>{const{t:n,i18n:o}=ds(),c=jA(),{lastBackup:u,changeCount:f,isBackupRecommended:h}=nF(),g=m=>m?m.toLocaleString(o.language==="de"?"de-DE":"en-US",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):n("widgets.database_status.never"),x=m=>{m.stopPropagation(),c("/datasource")};return l.jsx(og,{title:n("widgets.database_status.title"),icon:wl,iconColor:h?"amber":"emerald",onRemove:e,dragHandleProps:t,onClick:r,targetView:a,backgroundIcon:wl,className:s?"opacity-90":"",footerLeft:l.jsxs("button",{onClick:x,className:"flex items-center gap-1.5 text-[10px] font-black text-slate-400 hover:text-blue-600 uppercase tracking-widest transition-colors group/footer",children:[n("widgets.database_status.data_management"),l.jsx(_p,{className:"w-3 h-3 transition-transform group-hover/footer:rotate-90"})]}),children:l.jsxs("div",{className:"flex flex-col h-full items-center justify-around py-2",children:[l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"flex items-center justify-center gap-1.5 text-[10px] font-black text-slate-500 dark:text-slate-400 uppercase tracking-widest mb-1",children:[l.jsx(B2,{className:"w-3 h-3"}),l.jsx("span",{children:n("widgets.database_status.last_backup")})]}),l.jsx("div",{className:"text-xl font-black text-slate-900 dark:text-white tracking-tight tabular-nums leading-none",children:g(u)})]}),l.jsxs("div",{className:"w-full pt-4 border-t border-slate-100 dark:border-slate-800/50 text-center",children:[l.jsxs("div",{className:`flex items-center justify-center gap-1.5 text-[10px] font-black uppercase tracking-widest mb-1 ${h?"text-amber-600 dark:text-amber-400":"text-emerald-600 dark:text-emerald-400"}`,children:[h?l.jsx(Cn,{className:"w-3 h-3"}):l.jsx(wl,{className:"w-3 h-3"}),l.jsx("span",{children:n("widgets.database_status.modifications")})]}),l.jsx("div",{className:`text-4xl font-black tabular-nums leading-none tracking-tighter ${h?"text-amber-600 dark:text-amber-400":"text-slate-900 dark:text-white"}`,children:f}),l.jsx("div",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-tighter mt-1",children:n("widgets.database_status.records_since_backup")})]})]})})},oae=UA("WorklistComponent"),Aae=({onRemove:e,dragHandleProps:t,onClick:r,targetView:a,isOverlay:s})=>{const{t:n}=ds(),o=jA(),[c,u]=Z.useState({total:0,pending:0}),[f,h]=Z.useState(!0),g=async()=>{try{const m=await jt.getWorklist(),w=m.length,v=m.filter(B=>B.status==="pending"||!B.status).length;u({total:w,pending:v})}catch(m){oae.error("Failed to load worklist stats",m)}finally{h(!1)}};Z.useEffect(()=>(g(),window.addEventListener("db-updated",g),window.addEventListener("db-changed",g),()=>{window.removeEventListener("db-updated",g),window.removeEventListener("db-changed",g)}),[]);const x=m=>{m.stopPropagation(),o("/worklist")};return l.jsx(og,{title:n("widgets.worklist.title"),icon:bf,iconColor:c.pending>0?"amber":"emerald",onRemove:e,dragHandleProps:t,onClick:r,targetView:a,backgroundIcon:bf,className:s?"opacity-90":"",footerLeft:l.jsxs("button",{onClick:x,className:"flex items-center gap-1.5 text-[10px] font-black text-slate-400 hover:text-blue-600 uppercase tracking-widest transition-colors group/footer",children:[n("widgets.worklist.open_list"),l.jsx(k2,{className:"w-3 h-3 transition-transform group-hover/footer:translate-x-1"})]}),children:l.jsxs("div",{className:"flex flex-col h-full items-center justify-around py-2",children:[l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:`flex items-center justify-center gap-1.5 text-[10px] font-black uppercase tracking-widest mb-1 ${c.pending>0?"text-amber-600 dark:text-amber-400":"text-emerald-600 dark:text-emerald-400"}`,children:[c.pending>0?l.jsx(Cn,{className:"w-3 h-3"}):l.jsx(If,{className:"w-3 h-3"}),l.jsx("span",{children:c.pending>0?n("widgets.worklist.open_tasks"):n("widgets.worklist.all_done")})]}),l.jsx("div",{className:`text-4xl font-black tracking-tighter tabular-nums leading-none ${c.pending>0?"text-amber-600 dark:text-amber-400":"text-slate-900 dark:text-white"}`,children:f?"---":c.pending})]}),l.jsxs("div",{className:"w-full pt-4 border-t border-slate-100 dark:border-slate-800/50 text-center",children:[l.jsxs("div",{className:"flex items-center justify-center gap-1.5 text-[10px] font-black text-slate-500 dark:text-slate-400 uppercase tracking-widest mb-1",children:[l.jsx(bf,{className:"w-3 h-3"}),l.jsx("span",{children:n("widgets.worklist.total_entries")})]}),l.jsx("div",{className:"text-xl font-black text-slate-700 dark:text-slate-300 tabular-nums leading-none",children:f?"---":c.total})]})]})})},cae={ClockComponent:aae,DataInspectorComponent:nae,SystemStatusComponent:iae,DatabaseStatusComponent:lae,WorklistComponent:Aae},lw=[{id:"SystemStatusComponent",titleKey:"widgets.system_status.title",descriptionKey:"widgets.system_status.description",icon:r0,defaultColSpan:1},{id:"DataInspectorComponent",titleKey:"widgets.data_inspector.title",descriptionKey:"widgets.data_inspector.description",icon:Zo,defaultColSpan:1},{id:"DatabaseStatusComponent",titleKey:"widgets.database_status.title",descriptionKey:"widgets.database_status.description",icon:PS,defaultColSpan:1},{id:"ClockComponent",titleKey:"widgets.clock.title",descriptionKey:"widgets.clock.description",icon:lx,defaultColSpan:1},{id:"WorklistComponent",titleKey:"widgets.worklist.title",descriptionKey:"widgets.worklist.description",icon:bf,defaultColSpan:1}],uae=e=>cae[e]||null,dae=UA("CustomDashboardView"),fae="litebi:app-ready",OS=({id:e,className:t,children:r})=>{const{attributes:a,listeners:s,setNodeRef:n,transform:o,isDragging:c}=$re({id:e}),{setNodeRef:u,isOver:f}=Jre({id:e}),h=g=>{n(g),u(g)};return l.jsx("div",{ref:h,style:{transform:x2.Translate.toString(o)},className:`${t||""} ${c?"opacity-50 z-10":""} ${f&&!c?"ring-2 ring-blue-300 rounded-xl":""}`,...a,...s,children:r})},hae=()=>{const{t:e}=ds(),[t,r]=Z.useState([]),[a,s]=Z.useState(null),[n,o]=Z.useState(!1),[c,u]=Z.useState(!1),[f,h]=Z.useState(!1),[g,x]=Z.useState("system"),[m,w]=Z.useState(""),[v,B]=Z.useState(!1),[k,E]=Z.useState(!1),[S,L]=Jt("dashboard_tools_open",!1),[P,R]=Jt("dashboard_tools_tab_v1","layout"),[Q,V]=Z.useState([]),{visibleSidebarComponentIds:U,setVisibleSidebarComponentIds:M,togglePresentationMode:T,isReadOnly:D}=So(),{isExporting:G,exportToPdf:ne}=D_(),H=qte(kS(P_,{activationConstraint:{distance:8}}),kS(M_,{coordinateGetter:eae})),{data:ee,refresh:le}=Ai(async()=>await jt.executeRaw("SELECT * FROM sys_user_widgets ORDER BY created_at DESC"),[]),pe=Wt.useRef(!1);Z.useEffect(()=>{(async()=>{if(pe.current)return;pe.current=!0;let se=await jt.getDashboards();const qe=localStorage.getItem("custom_dashboard_layout");if(se.length===0){const nt={id:crypto.randomUUID(),name:e("dashboard.default_name"),layout:qe?JSON.parse(qe):[],is_default:!0};await jt.saveDashboard(nt,!0),qe&&localStorage.removeItem("custom_dashboard_layout"),se=[nt]}else se.length>0&&(se=se.map(nt=>({...nt,layout:typeof nt.layout=="string"?JSON.parse(nt.layout):nt.layout})));r(se);const Ye=window.location.hash||"#/",at=Ye.includes("?")?Ye.slice(Ye.indexOf("?")+1):"",Ge=at?new URLSearchParams(at).get("dashboard"):null,pt=Ge&&se.some(nt=>nt.id===Ge)?Ge:se[0]?.id??null;s(pt),o(!0),window.__LITEBI_READY__=!0,window.dispatchEvent(new Event(fae))})()},[e]);const te=t.find(oe=>oe.id===a);Z.useEffect(()=>{if(!te||!ee)return;(async()=>{const He=te.layout.map(at=>at.id),se=ee.filter(at=>He.includes(at.id)),qe=new Set;se.forEach(at=>{const Ge=at.sql_query.match(/FROM\s+([a-zA-Z0-9_]+)/i);Ge&&qe.add(Ge[1])});const Ye=new Set;for(const at of Array.from(qe))try{const Ge=await jt.getTableSchema(at);Ge&&Array.isArray(Ge)&&Ge.forEach(pt=>Ye.add(pt.name))}catch(Ge){dae.error("Error fetching schema for table",at,Ge)}V(Array.from(Ye).sort())})()},[te,ee]);const Le=async oe=>{await jt.saveDashboard(oe),r(He=>He.map(se=>se.id===oe.id?oe:se))},je=async(oe,He)=>{if(!te||te.layout.find(qe=>qe.id===oe))return;const se={...te,layout:[...te.layout,{id:oe,type:He}]};await Le(se),u(!1)},F=async oe=>{if(!te)return;const He={...te,layout:te.layout.filter(se=>se.id!==oe)};await Le(He)},K=async oe=>{if(D||!te)return;const{active:He,over:se}=oe;if(!se||He.id===se.id)return;const qe=te.layout.findIndex(Ge=>Ge.id===String(He.id)),Ye=te.layout.findIndex(Ge=>Ge.id===String(se.id));if(qe<0||Ye<0)return;const at=QS(te.layout,qe,Ye);await Le({...te,layout:at})},I=async(oe,He)=>{if(!te)return;const se=te.layout.findIndex(at=>at.id===oe);if(se<0)return;const qe=se+He;if(qe<0||qe>=te.layout.length)return;const Ye=QS(te.layout,se,qe);await Le({...te,layout:Ye})},q=async(oe="")=>{te&&await Le({...te,filters:[...te.filters||[],{column:oe,operator:"=",value:""}]})},J=async(oe,He)=>{if(!te)return;const se=[...te.filters||[]];se[oe]={...se[oe],...He},await Le({...te,filters:se})},Y=async oe=>{te&&await Le({...te,filters:(te.filters||[]).filter((He,se)=>se!==oe)})},de=async()=>{te&&await Le({...te,filters:[]})},ue=oe=>{if(oe.type==="system"){const He=lw.find(se=>se.id===oe.id);return He?e(He.titleKey):oe.id}return ee?.find(He=>He.id===oe.id)?.name||oe.id},we=async oe=>{await Qt.confirm(e("dashboard.confirm_delete_report"))&&(await jt.deleteUserWidget(oe),le(),F(oe))},Ie=async()=>{if(!m.trim())return;const oe={id:crypto.randomUUID(),name:m,layout:[],is_default:!1};await jt.saveDashboard(oe),r([...t,oe]),s(oe.id),w(""),B(!1)},Ae=async oe=>{if(t.length<=1||!await Qt.confirm(e("dashboard.delete_confirm")))return;await jt.deleteDashboard(oe);const He=t.filter(se=>se.id!==oe);r(He),a===oe&&s(He[0].id)};return n?l.jsxs(x0,{header:{title:e("dashboard.title"),subtitle:e("dashboard.subtitle"),actions:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:T,className:"p-2 text-slate-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors border border-transparent hover:border-blue-100 dark:hover:border-blue-800/40",title:e("dashboard.presentation_mode"),children:l.jsx(ix,{className:"w-5 h-5"})}),l.jsxs("button",{onClick:()=>ne("dashboard-grid",`dashboard-${te?.name||"export"}`),disabled:G,className:"flex items-center gap-2 px-3 py-2 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-300 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors shadow-sm font-medium text-sm disabled:opacity-50",children:[l.jsx(Jx,{className:"w-4 h-4"}),e(G?"common.exporting":"common.export_pdf")]}),l.jsx("button",{onClick:()=>E(!k),className:`p-2 rounded-lg transition-colors border ${k?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800 text-blue-600 dark:text-blue-300":"text-slate-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border-transparent hover:border-blue-100 dark:hover:border-blue-800/40"}`,title:e("querybuilder.filter"),children:l.jsx(Jh,{className:"w-5 h-5"})}),!D&&l.jsxs("button",{onClick:()=>u(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm font-medium text-sm",children:[l.jsx(eA,{className:"w-4 h-4"}),e("dashboard.add_title")]})]})},rightPanel:{title:e("dashboard.tools_title","Dashboard Tools"),enabled:!!te,triggerTitle:e("dashboard.tools_title","Dashboard Tools"),width:"sm",isOpen:S,onOpenChange:L,content:l.jsxs("div",{className:"h-full min-h-0 flex flex-col gap-4",children:[l.jsxs("div",{className:"inline-flex items-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 p-1 flex-shrink-0",children:[l.jsx("button",{type:"button",onClick:()=>R("layout"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${P==="layout"?"bg-blue-600 text-white":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:e("dashboard.tools_tab_layout","Layout")}),l.jsx("button",{type:"button",onClick:()=>R("filters"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${P==="filters"?"bg-blue-600 text-white":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:e("dashboard.tools_tab_filters","Filters")})]}),te?P==="layout"?l.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-2",children:[l.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:e("dashboard.tools_layout_hint","Reorder widgets and remove items without leaving the dashboard.")}),l.jsx("div",{className:"flex-1 min-h-0 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg divide-y divide-slate-100 dark:divide-slate-700",children:te.layout.length===0?l.jsx("div",{className:"p-3 text-xs text-slate-400 dark:text-slate-500",children:e("dashboard.no_reports")}):te.layout.map((oe,He)=>l.jsxs("div",{className:"p-3 flex items-center justify-between gap-2",children:[l.jsxs("div",{className:"min-w-0",children:[l.jsx("div",{className:"text-xs font-semibold text-slate-700 dark:text-slate-200 truncate",children:ue(oe)}),l.jsx("div",{className:"text-[10px] text-slate-400 dark:text-slate-500 uppercase",children:oe.type})]}),!D&&l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("button",{type:"button",onClick:()=>{I(oe.id,-1)},disabled:He===0,className:"h-7 w-7 inline-flex items-center justify-center rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300 disabled:opacity-40",title:e("dashboard.tools_move_up","Move up"),children:l.jsx(Aw,{className:"w-3.5 h-3.5"})}),l.jsx("button",{type:"button",onClick:()=>{I(oe.id,1)},disabled:He===te.layout.length-1,className:"h-7 w-7 inline-flex items-center justify-center rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300 disabled:opacity-40",title:e("dashboard.tools_move_down","Move down"),children:l.jsx(cw,{className:"w-3.5 h-3.5"})}),l.jsx("button",{type:"button",onClick:()=>{F(oe.id)},className:"h-7 w-7 inline-flex items-center justify-center rounded border border-rose-200 dark:border-rose-800 bg-rose-50 dark:bg-rose-900/20 hover:bg-rose-100 dark:hover:bg-rose-900/30 text-rose-700 dark:text-rose-300",title:e("common.remove"),children:l.jsx(ii,{className:"w-3.5 h-3.5"})})]})]},`${oe.type}:${oe.id}`))})]}):l.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-2",children:[l.jsxs("div",{className:"flex items-center justify-between gap-2",children:[l.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:e("dashboard.tools_filters_hint","Manage global dashboard filters in one place.")}),!D&&l.jsx("button",{type:"button",onClick:()=>{q("")},className:"h-7 px-2 rounded border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/30 text-blue-700 dark:text-blue-300 text-[11px] font-semibold",children:e("dashboard.add_filter")})]}),!D&&l.jsx("div",{className:"flex items-center justify-end",children:l.jsx("button",{type:"button",onClick:()=>{de()},className:"text-[11px] text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200",children:e("dashboard.tools_clear_filters","Clear filters")})}),l.jsx("div",{className:"flex-1 min-h-0 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg divide-y divide-slate-100 dark:divide-slate-700",children:(te.filters||[]).length===0?l.jsx("div",{className:"p-3 text-xs text-slate-400 dark:text-slate-500",children:e("dashboard.no_filters")}):(te.filters||[]).map((oe,He)=>l.jsxs("div",{className:"p-3 space-y-2",children:[l.jsx("input",{list:"suggested-columns",value:oe.column,onChange:se=>{J(He,{column:se.target.value})},placeholder:e("dashboard.filter_column"),className:"w-full h-8 px-2 border border-slate-200 dark:border-slate-700 rounded bg-white dark:bg-slate-900 text-xs text-slate-700 dark:text-slate-200 outline-none"}),l.jsxs("div",{className:"grid grid-cols-[1fr_1fr_auto] gap-2",children:[l.jsxs("select",{value:oe.operator,onChange:se=>{J(He,{operator:se.target.value})},className:"h-8 px-2 border border-slate-200 dark:border-slate-700 rounded bg-white dark:bg-slate-900 text-xs text-slate-700 dark:text-slate-200 outline-none",children:[l.jsx("option",{value:"=",children:"="}),l.jsx("option",{value:"!=",children:"!="}),l.jsx("option",{value:">",children:">"}),l.jsx("option",{value:"<",children:"<"}),l.jsx("option",{value:"contains",children:e("dashboard.op_contains")}),l.jsx("option",{value:"is null",children:e("dashboard.op_is_null")})]}),l.jsx("input",{value:oe.value,onChange:se=>{J(He,{value:se.target.value})},placeholder:e("dashboard.filter_value"),className:"h-8 px-2 border border-slate-200 dark:border-slate-700 rounded bg-white dark:bg-slate-900 text-xs text-slate-700 dark:text-slate-200 outline-none"}),!D&&l.jsx("button",{type:"button",onClick:()=>{Y(He)},className:"h-8 w-8 inline-flex items-center justify-center rounded border border-rose-200 dark:border-rose-800 bg-rose-50 dark:bg-rose-900/20 hover:bg-rose-100 dark:hover:bg-rose-900/30 text-rose-700 dark:text-rose-300",title:e("common.remove"),children:l.jsx(ii,{className:"w-3.5 h-3.5"})})]})]},He))})]}):l.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:e("common.no_data")})]})},children:[k&&te&&l.jsxs("div",{className:"mb-6 p-4 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl shadow-sm animate-in slide-in-from-top-2 duration-300",children:[l.jsx("datalist",{id:"suggested-columns",children:Q.map(oe=>l.jsx("option",{value:oe},oe))}),l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{className:"flex flex-col gap-1",children:[l.jsxs("h4",{className:"text-xs font-black uppercase text-slate-400 flex items-center gap-2",children:[l.jsx(Jh,{className:"w-3.5 h-3.5 text-blue-500"})," ",e("dashboard.filters_title")]}),l.jsx("p",{className:"text-[10px] text-slate-400",children:e("dashboard.filters_subtitle","Slicers that affect all dashboard charts simultaneously.")})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[Q.filter(oe=>["Year","FiscalYear","Date","Month","Category","Group","Type","Status"].some(He=>oe.toLowerCase().includes(He.toLowerCase()))).slice(0,3).map(oe=>l.jsxs("button",{onClick:()=>Le({...te,filters:[...te.filters||[],{column:oe,operator:"=",value:""}]}),className:"px-2 py-1 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded text-[10px] font-bold text-slate-500 hover:text-blue-600 transition-colors",children:["+ ",oe]},oe)),l.jsx("button",{onClick:()=>Le({...te,filters:[...te.filters||[],{column:"",operator:"=",value:""}]}),className:"px-3 py-1 bg-blue-600 text-white rounded text-[10px] font-bold shadow-sm shadow-blue-100 hover:bg-blue-700 transition-colors",children:e("dashboard.add_filter")})]})]}),l.jsxs("div",{className:"space-y-2",children:[(te.filters||[]).map((oe,He)=>l.jsxs("div",{className:"flex items-center gap-2 group animate-in slide-in-from-left-2 duration-200",style:{animationDelay:`${He*50}ms`},children:[l.jsxs("div",{className:"flex-1 grid grid-cols-12 gap-2 p-1 bg-slate-50 dark:bg-slate-800/50 border border-slate-100 dark:border-slate-800 rounded-lg group-hover:border-slate-200 group-hover:bg-white dark:group-hover:bg-slate-800 transition-all",children:[l.jsx("input",{placeholder:e("dashboard.filter_column"),list:"suggested-columns",className:"col-span-4 p-1.5 text-[11px] bg-transparent outline-none font-bold text-slate-700 dark:text-slate-200",value:oe.column,onChange:se=>{const qe=[...te.filters||[]];qe[He].column=se.target.value,Le({...te,filters:qe})}}),l.jsxs("select",{className:"col-span-3 p-1.5 text-[11px] bg-transparent outline-none border-l border-slate-100 dark:border-slate-800 text-slate-500 font-medium cursor-pointer",value:oe.operator,onChange:se=>{const qe=[...te.filters||[]];qe[He].operator=se.target.value,Le({...te,filters:qe})},children:[l.jsx("option",{value:"=",children:"="}),l.jsx("option",{value:"!=",children:"!="}),l.jsx("option",{value:">",children:">"}),l.jsx("option",{value:"<",children:"<"}),l.jsx("option",{value:"contains",children:e("dashboard.op_contains")}),l.jsx("option",{value:"is null",children:e("dashboard.op_is_null")})]}),l.jsx("input",{placeholder:e("dashboard.filter_value"),className:"col-span-5 p-1.5 text-[11px] bg-transparent outline-none border-l border-slate-100 dark:border-slate-800 font-bold text-blue-600 dark:text-blue-400 placeholder:text-blue-200",value:oe.value,onChange:se=>{const qe=[...te.filters||[]];qe[He].value=se.target.value,Le({...te,filters:qe})}})]}),l.jsx("button",{onClick:()=>Le({...te,filters:(te.filters||[]).filter((se,qe)=>qe!==He)}),className:"p-1.5 text-slate-300 hover:text-red-500 transition-colors bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-lg shadow-sm",children:l.jsx(ii,{className:"w-3.5 h-3.5"})})]},He)),(te.filters||[]).length===0&&l.jsxs("div",{className:"py-8 text-center border-2 border-dashed border-slate-50 dark:border-slate-800 rounded-xl",children:[l.jsx(Jh,{className:"w-8 h-8 mx-auto mb-2 text-slate-200"}),l.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-slate-300",children:e("dashboard.no_filters")})]})]})]}),l.jsxs("div",{className:"mb-6 flex items-center justify-between border-b border-slate-200 dark:border-slate-800",children:[l.jsxs("div",{className:"flex items-center gap-1 overflow-x-auto no-scrollbar pb-px",children:[t.map(oe=>l.jsx("button",{onClick:()=>s(oe.id),className:`px-4 py-2.5 text-sm font-bold transition-all border-b-2 whitespace-nowrap ${a===oe.id?"text-blue-600 border-blue-600":"text-slate-400 border-transparent hover:text-slate-600"}`,children:oe.name},oe.id)),!D&&l.jsx("button",{onClick:()=>{B(!0),w("")},className:"px-4 py-2.5 text-slate-400 hover:text-blue-600 transition-all border-b-2 border-transparent",title:e("dashboard.new_dashboard_title"),children:l.jsx(eA,{className:"w-4 h-4"})})]}),!D&&l.jsx("button",{onClick:()=>h(!0),className:"p-2 text-slate-400 hover:text-slate-600",title:e("dashboard.manage_title"),children:l.jsx(_p,{className:"w-4 h-4"})})]}),v&&l.jsxs("div",{className:"mb-6 p-4 bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-800 rounded-xl flex items-center gap-3",children:[l.jsx(wn,{className:"w-5 h-5 text-slate-400"}),l.jsx("input",{autoFocus:!0,type:"text",placeholder:e("dashboard.new_dashboard_placeholder"),className:"flex-1 bg-transparent border-none outline-none font-bold text-slate-700 dark:text-slate-200",value:m,onChange:oe=>w(oe.target.value),onKeyDown:oe=>oe.key==="Enter"&&Ie()}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("button",{onClick:Ie,className:"p-1.5 text-green-600 hover:bg-green-50 rounded",children:l.jsx(Yx,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>B(!1),className:"p-1.5 text-slate-400 hover:bg-slate-100 rounded",children:l.jsx(vl,{className:"w-4 h-4"})})]})]}),te&&te.layout.length===0?l.jsxs("div",{className:"flex flex-col items-center justify-center p-12 border-2 border-dashed border-slate-200 dark:border-slate-700 rounded-xl bg-slate-50 dark:bg-slate-900/40 text-slate-400 dark:text-slate-500",children:[l.jsx(wn,{className:"w-12 h-12 mb-4 opacity-50"}),l.jsx("h3",{className:"font-bold text-lg text-slate-600 dark:text-slate-200",children:e("dashboard.empty_msg",{name:te.name})}),l.jsx("p",{className:"mb-4 text-sm text-center text-slate-500 dark:text-slate-400",children:e("dashboard.empty_hint")}),!D&&l.jsx("button",{onClick:()=>u(!0),className:"px-6 py-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-blue-600 dark:text-blue-300 font-bold hover:shadow-sm transition-all text-sm",children:e("dashboard.add_title")})]}):te?l.jsx(Vre,{sensors:H,collisionDetection:zte,onDragEnd:oe=>{K(oe)},children:l.jsx("div",{id:"dashboard-grid",className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6 auto-rows-[300px]",children:te.layout.map(oe=>{if(oe.type==="system"){const qe=lw.find(at=>at.id===oe.id);if(!qe)return null;const Ye=uae(qe.id);return Ye?l.jsxs(OS,{id:oe.id,className:`relative group h-full ${qe.defaultColSpan===2?"md:col-span-2":""}`,children:[!D&&l.jsx("div",{className:"absolute -top-2 -right-2 z-20 opacity-0 group-hover:opacity-100 transition-opacity",children:l.jsx("button",{onClick:at=>{at.stopPropagation(),F(oe.id)},className:"p-1.5 bg-white/95 backdrop-blur-sm border border-slate-200 rounded-full text-slate-400 hover:text-red-500 shadow-sm",title:e("common.remove"),children:l.jsx(ii,{className:"w-3 h-3"})})}),l.jsx("div",{className:"h-full",children:l.jsx(Ye,{onRemove:void 0,targetView:Gu.find(at=>at.component===qe.id)?.targetView})})]},oe.id):null}const He=ee?.find(qe=>qe.id===oe.id);if(!He)return null;let se;try{se=JSON.parse(He.visualization_config)}catch{se={type:"table"}}return l.jsxs(OS,{id:oe.id,className:"relative group md:col-span-1 xl:col-span-2 h-full",children:[!D&&l.jsx("div",{className:"absolute -top-2 -right-2 z-20 opacity-0 group-hover:opacity-100 transition-opacity",children:l.jsx("button",{onClick:()=>F(oe.id),className:"p-1.5 bg-white/95 backdrop-blur-sm border border-slate-200 rounded-full text-slate-400 hover:text-red-500 shadow-sm",title:"Entfernen",children:l.jsx(ii,{className:"w-3 h-3"})})}),l.jsx(_2,{title:He.name,sql:He.sql_query,config:se,globalFilters:te.filters,showInspectorJump:!0,inspectorReturnHash:te?.id?`#/?dashboard=${encodeURIComponent(te.id)}`:"#/"})]},oe.id)})})}):null,l.jsx(Bo,{isOpen:f,onClose:()=>h(!1),title:e("dashboard.manage_title"),children:l.jsxs("div",{className:"space-y-3",children:[t.map(oe=>l.jsxs("div",{className:"flex items-center justify-between p-3 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg group",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(wn,{className:"w-4 h-4 text-slate-400 dark:text-slate-500"}),l.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-200",children:oe.name}),oe.is_default&&l.jsx("span",{className:"text-[10px] bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-200 px-1.5 py-0.5 rounded font-black uppercase tracking-wider",children:"Default"})]}),l.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[l.jsx("button",{onClick:async()=>{const He=await Qt.prompt("Name fuer Dashboard:",{defaultValue:oe.name});He&&He!==oe.name&&Le({...oe,name:He})},className:"p-1.5 text-slate-400 dark:text-slate-500 hover:text-blue-600 dark:hover:text-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded",children:l.jsx($S,{className:"w-3.5 h-3.5"})}),l.jsx("button",{onClick:()=>Ae(oe.id),disabled:t.length<=1,className:"p-1.5 text-slate-400 dark:text-slate-500 hover:text-red-600 dark:hover:text-red-300 hover:bg-red-50 dark:hover:bg-red-900/30 rounded disabled:opacity-30",children:l.jsx(ii,{className:"w-3.5 h-3.5"})})]})]},oe.id)),l.jsxs("button",{onClick:()=>{h(!1),B(!0)},className:"w-full p-3 border-2 border-dashed border-slate-200 dark:border-slate-700 rounded-lg text-slate-400 dark:text-slate-500 hover:text-blue-600 dark:hover:text-blue-300 hover:border-blue-200 dark:hover:border-blue-700 text-sm font-bold transition-all flex items-center justify-center gap-2",children:[l.jsx(eA,{className:"w-4 h-4"})," Neues Dashboard"]})]})}),l.jsxs(Bo,{isOpen:c,onClose:()=>u(!1),title:e("dashboard.add_title"),children:[l.jsxs("div",{className:"flex gap-4 mb-4 border-b border-slate-200 dark:border-slate-700",children:[l.jsx("button",{onClick:()=>x("system"),className:`pb-2 text-sm font-bold ${g==="system"?"text-blue-600 dark:text-blue-400 border-b-2 border-blue-600 dark:border-blue-400":"text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300"}`,children:e("dashboard.system_widgets")}),l.jsx("button",{onClick:()=>x("custom"),className:`pb-2 text-sm font-bold ${g==="custom"?"text-blue-600 dark:text-blue-400 border-b-2 border-blue-600 dark:border-blue-400":"text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300"}`,children:e("dashboard.custom_widgets")})]}),l.jsxs("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto min-h-[300px]",children:[g==="system"&&l.jsx("div",{className:"grid grid-cols-1 gap-2",children:lw.map(oe=>{const He=te?.layout.some(at=>at.id===oe.id),se=Gu.find(at=>at.component===oe.id),qe=!!se?.targetView,Ye=qe&&U.includes(se.id);return l.jsxs("div",{className:"flex items-center justify-between p-3 border border-slate-200 dark:border-slate-700 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800/60",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-2 bg-slate-100 dark:bg-slate-800 rounded-lg text-slate-500 dark:text-slate-300",children:l.jsx(oe.icon,{className:"w-5 h-5"})}),l.jsxs("div",{children:[l.jsx("div",{className:"font-bold text-slate-700 dark:text-slate-100",children:e(oe.titleKey)}),l.jsx("div",{className:"text-xs text-slate-400 dark:text-slate-500",children:e(oe.descriptionKey)})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[qe&&l.jsx("button",{onClick:at=>{at.stopPropagation(),M(Ye?U.filter(Ge=>Ge!==se.id):[...U,se.id])},title:e(Ye?"dashboard.unpin_sidebar":"dashboard.pin_sidebar"),className:`p-1.5 rounded-md border transition-all ${Ye?"bg-amber-50 dark:bg-amber-900/30 border-amber-200 dark:border-amber-700 text-amber-500 dark:text-amber-300":"bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 text-slate-300 dark:text-slate-500 hover:text-amber-400 dark:hover:text-amber-300"}`,children:l.jsx(Km,{className:`w-4 h-4 ${Ye?"fill-current":""}`})}),l.jsx("button",{onClick:()=>je(oe.id,"system"),disabled:He,className:`px-3 py-1.5 text-xs font-bold rounded ${He?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300":"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 hover:bg-blue-200 dark:hover:bg-blue-900/50"}`,children:e(He?"dashboard.active":"common.add")})]})]},oe.id)})}),g==="custom"&&l.jsx("div",{className:"grid grid-cols-1 gap-2",children:ee&&ee.length>0?ee.map(oe=>{const He=te?.layout.some(se=>se.id===oe.id);return l.jsxs("div",{className:"flex items-center justify-between p-3 border border-slate-200 dark:border-slate-700 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800/60",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-2 bg-blue-50 dark:bg-blue-900/30 rounded-lg text-blue-500 dark:text-blue-300",children:l.jsx(wl,{className:"w-5 h-5"})}),l.jsxs("div",{children:[l.jsx("div",{className:"font-bold text-slate-700 dark:text-slate-100",children:oe.name}),l.jsx("div",{className:"text-xs text-slate-400 dark:text-slate-500 truncate max-w-[200px]",children:oe.sql_query})]})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:()=>we(oe.id),className:"p-2 text-slate-400 dark:text-slate-500 hover:text-red-500 dark:hover:text-red-300",title:e("common.delete"),children:l.jsx(ii,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>je(oe.id,"custom"),disabled:He,className:`px-3 py-1.5 text-xs font-bold rounded ${He?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300":"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 hover:bg-blue-200 dark:hover:bg-blue-900/50"}`,children:e(He?"dashboard.active":"common.add")})]})]},oe.id)}):l.jsx("p",{className:"text-center text-slate-400 dark:text-slate-500 py-4",children:e("dashboard.no_reports")})})]})]})]}):null},pae=UA("WorklistView"),gae=()=>{if(typeof window>"u")return"all";const e=localStorage.getItem("worklist_default_view");return e==="open"||e==="overdue"||e==="today"||e==="high_priority"||e==="all"?e:"all"},mae=()=>{const{t:e}=ds(),t=jA(),r=gae(),[a,s]=Z.useState([]),[n,o]=Z.useState(!0),[c,u]=Z.useState(r==="open"?"open":"all"),[f,h]=Z.useState(r==="overdue"||r==="today"||r==="high_priority"?r:"none"),[g,x]=Z.useState(""),[m,w]=Z.useState(!1),[v,B]=Z.useState("focus"),[k,E]=Z.useState([]),[S,L]=Z.useState(null),{isReadOnly:P}=So(),[R]=Jt("worklist_hide_completed",!1),[Q,V]=Z.useState(null),[U,M]=Z.useState([]),[T,D]=Z.useState(!1),G=Z.useCallback(async()=>{o(!0);const Y=await jt.getWorklist(),de=await Promise.all(Y.map(async ue=>{const we=await jt.checkRecordExists(ue.source_table,ue.source_id);return{...ue,_exists:we}}));s(de),o(!1)},[]);Z.useEffect(()=>{const Y=window.setTimeout(()=>{G()},0);return window.addEventListener("db-updated",G),window.addEventListener("db-changed",G),()=>{window.clearTimeout(Y),window.removeEventListener("db-updated",G),window.removeEventListener("db-changed",G)}},[G]);const ne=async Y=>{P||(await jt.executeRaw("DELETE FROM sys_worklist WHERE id = ?",[Y]),await G())},H=async Y=>{let de=[];try{de=await jt.executeRaw(`SELECT rowid as _rowid, * FROM "${Y.source_table}" WHERE id = ?`,[Y.source_id])}catch{try{const we=(await jt.getTableSchema(Y.source_table)).find(Ie=>Ie.pk===1||Ie.name.toLowerCase()==="id")?.name;we&&we.toLowerCase()!=="id"?de=await jt.executeRaw(`SELECT rowid as _rowid, * FROM "${Y.source_table}" WHERE "${we}" = ?`,[Y.source_id]):de=await jt.executeRaw(`SELECT rowid as _rowid, * FROM "${Y.source_table}" WHERE rowid = ?`,[Y.source_id])}catch(ue){pae.error("Failed to load details for",Y,ue)}}de.length>0?(M(de),V(Y),D(!0)):(M([{...Y,_deleted:!0}]),V(Y),D(!0))},ee=Y=>{switch(Y){case"done":return l.jsx(If,{className:"w-4 h-4 text-emerald-500"});case"in_progress":return l.jsx(lx,{className:"w-4 h-4 text-blue-500"});case"closed":return l.jsx(aL,{className:"w-4 h-4 text-slate-400 opacity-50"});default:return l.jsx(Cn,{className:"w-4 h-4 text-amber-500"})}},le=Y=>{if(!Y)return!1;const de=new Date,ue=new Date(de.getFullYear(),de.getMonth(),de.getDate()),we=new Date(Y);return new Date(we.getFullYear(),we.getMonth(),we.getDate()).getTime()<ue.getTime()},pe=Y=>{if(!Y)return!1;const de=new Date,ue=new Date(Y);return ue.getFullYear()===de.getFullYear()&&ue.getMonth()===de.getMonth()&&ue.getDate()===de.getDate()},te={critical:4,high:3,normal:2,low:1},Le=a.filter(Y=>c==="all"||Y.status===c).filter(Y=>!R||Y.status!=="done"&&Y.status!=="closed").filter(Y=>f==="none"?!0:f==="overdue"?Y.status!=="done"&&Y.status!=="closed"&&le(Y.due_at):f==="today"?pe(Y.due_at):f==="high_priority"?Y.priority==="high"||Y.priority==="critical":!0).filter(Y=>Y.display_label?.toLowerCase().includes(g.toLowerCase())||Y.source_table?.toLowerCase().includes(g.toLowerCase())||Y.comment?.toLowerCase().includes(g.toLowerCase())).sort((Y,de)=>{const ue=le(Y.due_at)&&Y.status!=="done"&&Y.status!=="closed"?1:0,we=le(de.due_at)&&de.status!=="done"&&de.status!=="closed"?1:0;if(ue!==we)return we-ue;const Ie=te[Y.priority||"normal"],Ae=te[de.priority||"normal"];if(Ie!==Ae)return Ae-Ie;const oe=new Date(Y.updated_at||Y.created_at).getTime();return new Date(de.updated_at||de.created_at).getTime()-oe}),je=Le.filter(Y=>k.includes(Y.id)),F=Le.find(Y=>Y.id===S)||je[0]||Le[0]||null,K=Y=>{E(de=>de.includes(Y)?de.filter(ue=>ue!==Y):[...de,Y])},I=Y=>{E(Y?Le.map(de=>de.id):[])},q=async Y=>{k.length===0||P||(await Promise.all(k.map(de=>jt.updateWorklistItem(de,Y))),await G())},J=Y=>{const de=new Date;return de.setDate(de.getDate()+Y),`${de.getFullYear()}-${String(de.getMonth()+1).padStart(2,"0")}-${String(de.getDate()).padStart(2,"0")}`};return l.jsxs(x0,{header:{title:e("sidebar.worklist"),subtitle:e("worklist.subtitle"),onBack:()=>t(-1)},rightPanel:{title:e("worklist.tools_title","Worklist Tools"),enabled:!0,triggerTitle:e("worklist.tools_title","Worklist Tools"),width:"sm",isOpen:m,onOpenChange:w,content:l.jsxs("div",{className:"h-full min-h-0 flex flex-col gap-4",children:[l.jsxs("div",{className:"inline-flex items-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 p-1 flex-shrink-0",children:[l.jsx("button",{type:"button",onClick:()=>B("focus"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${v==="focus"?"bg-blue-600 text-white":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:e("worklist.tools_tab_focus","Fokus")}),l.jsx("button",{type:"button",onClick:()=>B("batch"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${v==="batch"?"bg-blue-600 text-white":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:e("worklist.tools_tab_batch","Batch")}),l.jsx("button",{type:"button",onClick:()=>B("preview"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${v==="preview"?"bg-blue-600 text-white":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:e("worklist.tools_tab_preview","Preview")})]}),v==="focus"&&l.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-3",children:[l.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[l.jsxs("div",{className:"rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900/40 p-2",children:[l.jsx("div",{className:"text-[10px] font-bold uppercase tracking-wider text-slate-500 dark:text-slate-400",children:e("worklist.focus_open","Offen")}),l.jsx("div",{className:"text-lg font-black text-slate-800 dark:text-slate-100",children:a.filter(Y=>Y.status==="open"||Y.status==="in_progress").length})]}),l.jsxs("div",{className:"rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900/40 p-2",children:[l.jsx("div",{className:"text-[10px] font-bold uppercase tracking-wider text-slate-500 dark:text-slate-400",children:e("worklist.quick_overdue","Ueberfaellig")}),l.jsx("div",{className:"text-lg font-black text-rose-600 dark:text-rose-300",children:a.filter(Y=>Y.status!=="done"&&Y.status!=="closed"&&le(Y.due_at)).length})]}),l.jsxs("div",{className:"rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900/40 p-2",children:[l.jsx("div",{className:"text-[10px] font-bold uppercase tracking-wider text-slate-500 dark:text-slate-400",children:e("worklist.quick_today","Heute")}),l.jsx("div",{className:"text-lg font-black text-blue-600 dark:text-blue-300",children:a.filter(Y=>pe(Y.due_at)).length})]})]}),l.jsxs("div",{className:"flex-1 min-h-0 rounded-lg border border-slate-200 dark:border-slate-700 p-3 space-y-2",children:[l.jsx("div",{className:"text-xs font-bold text-slate-700 dark:text-slate-200",children:e("worklist.tools_quick_filters","Schnellfilter")}),l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsx("button",{type:"button",onClick:()=>{h("none"),u("all")},className:"h-9 rounded-md border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-xs font-semibold text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700",children:e("worklist.quick_all","Alles")}),l.jsx("button",{type:"button",onClick:()=>{h("overdue"),u("all")},className:"h-9 rounded-md border border-rose-200 dark:border-rose-800 bg-rose-50 dark:bg-rose-900/20 text-xs font-semibold text-rose-700 dark:text-rose-300 hover:bg-rose-100 dark:hover:bg-rose-900/30",children:e("worklist.quick_overdue","Ueberfaellig")}),l.jsx("button",{type:"button",onClick:()=>{h("today"),u("all")},className:"h-9 rounded-md border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20 text-xs font-semibold text-blue-700 dark:text-blue-300 hover:bg-blue-100 dark:hover:bg-blue-900/30",children:e("worklist.quick_today","Heute")}),l.jsx("button",{type:"button",onClick:()=>{h("high_priority"),u("all")},className:"h-9 rounded-md border border-amber-200 dark:border-amber-800 bg-amber-50 dark:bg-amber-900/20 text-xs font-semibold text-amber-700 dark:text-amber-300 hover:bg-amber-100 dark:hover:bg-amber-900/30",children:e("worklist.quick_high_priority","Hohe Prioritaet")})]})]})]}),v==="batch"&&l.jsxs("div",{className:"flex-1 min-h-0 rounded-lg border border-slate-200 dark:border-slate-700 p-3 space-y-3",children:[l.jsx("div",{className:"text-xs font-bold text-slate-700 dark:text-slate-200",children:e("worklist.tools_selected_count","{{count}} ausgewaehlt",{count:k.length})}),l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsx("button",{type:"button",disabled:k.length===0||P,onClick:()=>{q({status:"open"})},className:"h-9 rounded-md border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-xs font-semibold text-slate-600 dark:text-slate-300 disabled:opacity-40",children:e("worklist.status_open","Neu / Offen")}),l.jsx("button",{type:"button",disabled:k.length===0||P,onClick:()=>{q({status:"in_progress"})},className:"h-9 rounded-md border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-xs font-semibold text-slate-600 dark:text-slate-300 disabled:opacity-40",children:e("worklist.status_in_progress","In Bearbeitung")}),l.jsx("button",{type:"button",disabled:k.length===0||P,onClick:()=>{q({status:"done"})},className:"h-9 rounded-md border border-emerald-200 dark:border-emerald-800 bg-emerald-50 dark:bg-emerald-900/20 text-xs font-semibold text-emerald-700 dark:text-emerald-300 disabled:opacity-40",children:e("worklist.status_done","Erledigt")}),l.jsx("button",{type:"button",disabled:k.length===0||P,onClick:()=>{q({status:"closed"})},className:"h-9 rounded-md border border-slate-300 dark:border-slate-700 bg-slate-100 dark:bg-slate-800 text-xs font-semibold text-slate-700 dark:text-slate-300 disabled:opacity-40",children:e("worklist.status_closed","Geschlossen")})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsx("button",{type:"button",disabled:k.length===0||P,onClick:()=>{q({priority:"normal"})},className:"h-9 rounded-md border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-xs font-semibold text-slate-600 dark:text-slate-300 disabled:opacity-40",children:e("worklist.priority_normal","Normal")}),l.jsx("button",{type:"button",disabled:k.length===0||P,onClick:()=>{q({priority:"high"})},className:"h-9 rounded-md border border-amber-200 dark:border-amber-800 bg-amber-50 dark:bg-amber-900/20 text-xs font-semibold text-amber-700 dark:text-amber-300 disabled:opacity-40",children:e("worklist.priority_high","Hoch")})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[l.jsx("button",{type:"button",disabled:k.length===0||P,onClick:()=>{q({due_at:J(0)})},className:"h-9 rounded-md border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20 text-xs font-semibold text-blue-700 dark:text-blue-300 disabled:opacity-40",children:e("worklist.quick_today","Heute")}),l.jsx("button",{type:"button",disabled:k.length===0||P,onClick:()=>{q({due_at:J(7)})},className:"h-9 rounded-md border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20 text-xs font-semibold text-blue-700 dark:text-blue-300 disabled:opacity-40",children:"+7"}),l.jsx("button",{type:"button",disabled:k.length===0||P,onClick:()=>{q({due_at:null})},className:"h-9 rounded-md border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-xs font-semibold text-slate-600 dark:text-slate-300 disabled:opacity-40",children:e("common.clear","Leeren")})]})]}),v==="preview"&&l.jsx("div",{className:"flex-1 min-h-0 rounded-lg border border-slate-200 dark:border-slate-700 p-3",children:F?l.jsxs("div",{className:"space-y-2",children:[l.jsx("div",{className:"text-sm font-bold text-slate-800 dark:text-slate-100 truncate",children:F.display_label||e("worklist.entry_id",{id:F.source_id})}),l.jsx("div",{className:"text-[11px] text-slate-500 dark:text-slate-400",children:F.source_table}),l.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600 dark:text-slate-300",children:[l.jsx("span",{className:"px-2 py-0.5 rounded bg-slate-100 dark:bg-slate-800",children:F.status}),l.jsx("span",{className:"px-2 py-0.5 rounded bg-slate-100 dark:bg-slate-800",children:F.priority||"normal"})]}),l.jsxs("div",{className:"text-xs text-slate-600 dark:text-slate-300 flex items-center gap-1.5",children:[l.jsx(rL,{className:"w-3.5 h-3.5 text-slate-400"}),F.due_at?String(F.due_at).slice(0,10):"-"]}),l.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-300 min-h-[48px] rounded border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900/40 p-2",children:F.comment||"-"}),l.jsx("button",{type:"button",onClick:()=>{H(F)},className:"h-9 w-full rounded-md border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20 text-xs font-semibold text-blue-700 dark:text-blue-300 hover:bg-blue-100 dark:hover:bg-blue-900/30",children:e("worklist.details_btn","Details oeffnen")})]}):l.jsx("div",{className:"h-full flex items-center justify-center text-xs text-slate-500 dark:text-slate-400",children:e("common.no_data")})})]})},children:[l.jsxs("div",{className:"max-w-5xl space-y-6",children:[l.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 bg-white dark:bg-slate-800 p-4 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("div",{className:"relative",children:[l.jsx(Zo,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),l.jsx("input",{type:"text",placeholder:e("common.search"),value:g,onChange:Y=>x(Y.target.value),className:"h-10 pl-10 pr-4 bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-700 rounded-lg outline-none focus:ring-2 focus:ring-blue-500/20 w-64 text-sm font-medium text-slate-700 dark:text-slate-200"})]}),l.jsx("div",{className:"h-10 flex items-center gap-1 p-1 bg-slate-50 dark:bg-slate-900/50 rounded-lg border border-slate-200 dark:border-slate-700",children:[{id:"all",label:e("worklist.filter_all")},{id:"open",label:e("worklist.filter_open")},{id:"in_progress",label:e("worklist.filter_in_progress")},{id:"done",label:e("worklist.filter_done")},{id:"closed",label:e("worklist.filter_closed")}].map(Y=>l.jsx("button",{onClick:()=>u(Y.id),className:`h-8 px-3 text-[10px] font-black rounded-md transition-all ${c===Y.id?"bg-white dark:bg-slate-700 text-blue-600 dark:text-blue-400 shadow-sm":"text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300"}`,children:Y.label.toUpperCase()},Y.id))}),l.jsx("div",{className:"h-10 flex items-center gap-1 p-1 bg-slate-50 dark:bg-slate-900/50 rounded-lg border border-slate-200 dark:border-slate-700",children:[{id:"none",label:e("worklist.quick_all","Alles")},{id:"overdue",label:e("worklist.quick_overdue","Ueberfaellig")},{id:"today",label:e("worklist.quick_today","Heute")},{id:"high_priority",label:e("worklist.quick_high_priority","Hohe Prioritaet")}].map(Y=>l.jsx("button",{onClick:()=>h(Y.id),className:`h-8 px-3 text-[10px] font-black rounded-md transition-all ${f===Y.id?"bg-white dark:bg-slate-700 text-blue-600 dark:text-blue-400 shadow-sm":"text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300"}`,children:Y.label.toUpperCase()},Y.id))})]}),l.jsxs("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:[e("worklist.found_count",{count:Le.length}),"  ",e("worklist.tools_selected_count","{{count}} ausgewaehlt",{count:k.length})]})]}),n?l.jsxs("div",{className:"flex flex-col items-center justify-center py-20 animate-pulse",children:[l.jsx("div",{className:"w-12 h-12 bg-slate-200 dark:bg-slate-800 rounded-full mb-4"}),l.jsx("div",{className:"h-4 w-32 bg-slate-200 dark:bg-slate-800 rounded mb-2"}),l.jsx("div",{className:"h-3 w-48 bg-slate-200 dark:bg-slate-800 rounded opacity-50"})]}):Le.length===0?l.jsxs("div",{className:"flex flex-col items-center justify-center py-20 bg-white dark:bg-slate-800/50 rounded-2xl border-2 border-dashed border-slate-200 dark:border-slate-800",children:[l.jsx("div",{className:"p-4 bg-slate-50 dark:bg-slate-900 rounded-full mb-4",children:l.jsx(bf,{className:"w-8 h-8 text-slate-300"})}),l.jsx("h3",{className:"text-sm font-bold text-slate-900 dark:text-white mb-1",children:e("worklist.empty_msg")}),l.jsx("p",{className:"text-xs text-slate-500 max-w-xs text-center",children:e("worklist.empty_hint")})]}):l.jsx("div",{className:"bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl shadow-sm overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-left text-sm whitespace-nowrap",children:[l.jsx("thead",{className:"bg-slate-50 dark:bg-slate-900/50 border-b border-slate-200 dark:border-slate-700 text-slate-500 dark:text-slate-400 uppercase text-[11px] font-black tracking-wider",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 w-12",children:l.jsx("button",{type:"button",onClick:()=>I(k.length!==Le.length||Le.length===0),className:"inline-flex items-center justify-center text-slate-500 dark:text-slate-400 hover:text-blue-600 dark:hover:text-blue-400",title:k.length===Le.length&&Le.length>0?e("common.clear","Leeren"):e("common.select_all","Alle waehlen"),children:k.length===Le.length&&Le.length>0?l.jsx(fk,{className:"w-4 h-4"}):l.jsx(hk,{className:"w-4 h-4"})})}),l.jsx("th",{className:"px-4 py-3 w-40",children:e("worklist.status_label","Status")}),l.jsx("th",{className:"px-4 py-3",children:e("worklist.element_label","Element")}),l.jsx("th",{className:"px-4 py-3",children:e("worklist.table_label","Tabelle")}),l.jsx("th",{className:"px-4 py-3 w-36",children:e("worklist.priority_label","Prioritaet")}),l.jsx("th",{className:"px-4 py-3 w-36",children:e("worklist.due_label","Faellig")}),l.jsx("th",{className:"px-4 py-3",children:e("worklist.context_label","Kontext")}),l.jsx("th",{className:"px-4 py-3 hidden md:table-cell",children:e("worklist.created_label","Erstellt am")}),l.jsx("th",{className:"px-4 py-3 text-right",children:e("common.actions","Aktionen")})]})}),l.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700/50",children:Le.map(Y=>l.jsxs("tr",{onClick:()=>L(Y.id),className:`group hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors cursor-pointer ${k.includes(Y.id)?"bg-blue-50/40 dark:bg-blue-900/10":""} ${Y._exists?"":"bg-red-50/10"}`,children:[l.jsx("td",{className:"px-4 py-3",children:l.jsx("button",{type:"button",onClick:de=>{de.stopPropagation(),K(Y.id)},className:"inline-flex items-center justify-center text-slate-500 dark:text-slate-400 hover:text-blue-600 dark:hover:text-blue-400",children:k.includes(Y.id)?l.jsx(fk,{className:"w-4 h-4"}):l.jsx(hk,{className:"w-4 h-4"})})}),l.jsx("td",{className:"px-4 py-3",children:l.jsxs("select",{value:Y.status,disabled:P,onChange:async de=>{de.stopPropagation(),!P&&(await jt.updateWorklistItem(Y.id,{status:de.target.value}),await G())},className:"h-9 w-full bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded px-2 text-[11px] font-bold outline-none cursor-pointer focus:ring-2 focus:ring-blue-500/20 text-slate-700 dark:text-slate-300",children:[l.jsx("option",{value:"open",children:e("worklist.status_open","Neu / Offen")}),l.jsx("option",{value:"in_progress",children:e("worklist.status_in_progress","In Bearbeitung")}),l.jsx("option",{value:"done",children:e("worklist.status_done","Erledigt")}),l.jsx("option",{value:"closed",children:e("worklist.status_closed","Geschlossen")})]})}),l.jsx("td",{className:"px-4 py-3",onClick:()=>H(Y),children:l.jsxs("div",{className:"flex items-center gap-3 cursor-pointer",children:[ee(Y.status),l.jsx("span",{className:"font-bold text-slate-900 dark:text-white group-hover:text-blue-600 transition-colors",children:Y.display_label||e("worklist.entry_id",{id:Y.source_id})}),!Y._exists&&l.jsxs("span",{className:"flex items-center gap-1 px-1.5 py-0.5 bg-red-100 dark:bg-red-900/30 text-[9px] font-black text-red-600 dark:text-red-400 rounded uppercase tracking-tighter shadow-sm",children:[l.jsx(Cn,{className:"w-2.5 h-2.5"})," ",e("common.deleted")]})]})}),l.jsx("td",{className:"px-4 py-3",children:l.jsx("span",{className:"px-2 py-1 bg-slate-100 dark:bg-slate-700/50 text-[10px] font-mono font-bold text-slate-500 dark:text-slate-400 rounded",children:Y.source_table})}),l.jsx("td",{className:"px-4 py-3",children:l.jsxs("select",{value:Y.priority||"normal",disabled:P,onChange:async de=>{de.stopPropagation(),!P&&(await jt.updateWorklistItem(Y.id,{priority:de.target.value}),await G())},className:"h-9 w-full bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded px-2 text-[11px] font-bold outline-none cursor-pointer focus:ring-2 focus:ring-blue-500/20 text-slate-700 dark:text-slate-300",children:[l.jsx("option",{value:"low",children:e("worklist.priority_low","Niedrig")}),l.jsx("option",{value:"normal",children:e("worklist.priority_normal","Normal")}),l.jsx("option",{value:"high",children:e("worklist.priority_high","Hoch")}),l.jsx("option",{value:"critical",children:e("worklist.priority_critical","Kritisch")})]})}),l.jsx("td",{className:"px-4 py-3",children:l.jsx("input",{type:"date",value:Y.due_at?String(Y.due_at).slice(0,10):"",disabled:P,onChange:async de=>{de.stopPropagation(),!P&&(await jt.updateWorklistItem(Y.id,{due_at:de.target.value||null}),await G())},className:`h-9 w-full bg-slate-50 dark:bg-slate-900 border rounded px-2 text-[11px] font-bold outline-none focus:ring-2 focus:ring-blue-500/20 ${le(Y.due_at)&&Y.status!=="done"&&Y.status!=="closed"?"border-rose-300 dark:border-rose-700 text-rose-700 dark:text-rose-300":"border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-300"}`})}),l.jsx("td",{className:"px-4 py-3 text-slate-500 dark:text-slate-400",children:l.jsx("div",{className:"flex items-center gap-3 text-[11px]",children:Y.comment?l.jsxs("span",{className:"flex items-center gap-1.5 text-slate-700 dark:text-slate-300 w-full max-w-[200px] truncate",title:Y.comment,children:[l.jsx(tL,{className:"w-3 h-3 opacity-60 shrink-0"}),l.jsx("span",{className:"truncate",children:Y.comment})]}):l.jsx("span",{className:"text-slate-400 dark:text-slate-600 italic",children:"-"})})}),l.jsx("td",{className:"px-4 py-3 text-slate-500 hidden md:table-cell text-[11px]",children:new Date(Y.created_at).toLocaleDateString()}),l.jsx("td",{className:"px-4 py-3 text-right",children:l.jsxs("div",{className:"flex items-center justify-end gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[l.jsx("button",{onClick:()=>H(Y),className:"p-1.5 text-slate-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-all",title:e("worklist.details_btn"),children:l.jsx(Vu,{className:"w-4 h-4"})}),!P&&l.jsx("button",{onClick:()=>ne(Y.id),className:"p-1.5 text-slate-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-all",title:e("worklist.remove_btn"),children:l.jsx(ii,{className:"w-4 h-4"})})]})})]},Y.id))})]})})})]}),T&&Q&&l.jsx(cb,{isOpen:T,onClose:()=>D(!1),items:U,initialIndex:0,tableName:Q.source_table,title:Q.display_label??void 0})]})},sf={github:"https://github.com/hrmnns/litebistudio",readme:"https://github.com/hrmnns/litebistudio/blob/main/README.md",changelog:"https://github.com/hrmnns/litebistudio/blob/main/CHANGELOG.md",docs:"https://github.com/hrmnns/litebistudio/wiki",website:"https://hrmnns.github.io/litebistudio/",contact:"https://www.cherware.de/contact/"},xae=()=>{const{t:e}=ds(),t=jA(),r="1.2.0",a="20260228-0737",s=[{name:"React",description:e("about.tech_ui_framework")},{name:"TypeScript",description:e("about.tech_language")},{name:"Vite",description:e("about.tech_build_tool")},{name:"Tailwind CSS",description:e("about.tech_styling")},{name:"SQLite (WASM) + OPFS",description:e("about.tech_local_database")},{name:"Recharts",description:e("about.tech_visualization")},{name:"i18next + react-i18next",description:e("about.tech_i18n")},{name:"html2canvas + jsPDF",description:e("about.tech_pdf_export")},{name:"Lucide",description:e("about.tech_icon_system")}];return l.jsx(x0,{header:{title:e("about.title","About LiteBI Studio"),subtitle:e("about.subtitle","Information about the project and system"),onBack:()=>t(-1)},breadcrumbs:[{label:e("sidebar.settings","Settings"),onClick:()=>t("/settings")},{label:e("about.title","About")}],children:l.jsxs("div",{className:"max-w-4xl space-y-8 pb-12",children:[l.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-indigo-700 rounded-3xl p-8 md:p-12 text-white shadow-xl relative overflow-hidden",children:[l.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row items-center gap-8",children:[l.jsx("div",{className:"p-4 bg-white/20 backdrop-blur-md rounded-2xl shadow-inner group transition-transform hover:scale-105",children:l.jsx(Ab,{size:80})}),l.jsxs("div",{className:"text-center md:text-left",children:[l.jsx("h2",{className:"text-3xl md:text-4xl font-black tracking-tight mb-2",children:"LiteBI Studio"}),l.jsx("p",{className:"text-blue-100 text-lg md:text-xl font-medium max-w-xl",children:e("about.tagline","The lightweight business intelligence platform directly in your browser.")}),l.jsxs("div",{className:"mt-6 flex flex-wrap justify-center md:justify-start gap-3",children:[l.jsxs("span",{className:"px-3 py-1 bg-white/20 backdrop-blur-md rounded-full text-xs font-bold uppercase tracking-wider border border-white/30",children:["Version ",r]}),l.jsxs("span",{className:"px-3 py-1 bg-white/20 backdrop-blur-md rounded-full text-xs font-bold uppercase tracking-wider border border-white/30",children:["Build ",a]})]})]})]}),l.jsx("div",{className:"absolute top-0 right-0 -mr-16 -mt-16 w-64 h-64 bg-white/10 rounded-full blur-3xl"}),l.jsx("div",{className:"absolute bottom-0 left-0 -ml-16 -mb-16 w-64 h-64 bg-blue-900/20 rounded-full blur-3xl"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[l.jsxs("div",{className:"md:col-span-2 space-y-6",children:[l.jsxs("section",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm",children:[l.jsxs("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[l.jsx(sL,{className:"w-5 h-5 text-rose-500"}),e("about.philosophy_title","Our Philosophy")]}),l.jsxs("div",{className:"prose dark:prose-invert max-w-none text-slate-600 dark:text-slate-400 space-y-4",children:[l.jsx("p",{children:e("about.philosophy_description")}),l.jsxs("ul",{className:"list-disc pl-5 space-y-2",children:[l.jsxs("li",{children:[l.jsxs("strong",{children:[e("about.point_privacy_title"),":"]})," ",e("about.point_privacy_desc")]}),l.jsxs("li",{children:[l.jsxs("strong",{children:[e("about.point_speed_title"),":"]})," ",e("about.point_speed_desc")]}),l.jsxs("li",{children:[l.jsxs("strong",{children:[e("about.point_offline_title"),":"]})," ",e("about.point_offline_desc")]})]})]})]}),l.jsxs("section",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm",children:[l.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-4",children:e("about.tech_stack_title","Tech Stack")}),l.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:s.map(n=>l.jsxs("div",{className:"p-4 rounded-xl bg-slate-50 dark:bg-slate-700/50 border border-slate-200 dark:border-slate-600 transition-colors hover:border-blue-500 group",children:[l.jsx("div",{className:"font-bold text-slate-900 dark:text-white group-hover:text-blue-600 transition-colors",children:n.name}),l.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:n.description})]},n.name))})]})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("section",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm",children:[l.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white mb-4",children:e("about.links_title","Links")}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("a",{href:sf.github,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between p-3 rounded-xl bg-slate-50 dark:bg-slate-700/50 hover:bg-slate-100 dark:hover:bg-slate-700 transition-all group",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(nL,{className:"w-5 h-5 text-slate-700 dark:text-slate-300"}),l.jsx("span",{className:"text-sm font-medium",children:e("about.link_github","GitHub Repository")})]}),l.jsx(Vu,{className:"w-4 h-4 text-slate-400 opacity-0 group-hover:opacity-100 transition-opacity"})]}),l.jsxs("a",{href:sf.readme,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between p-3 rounded-xl bg-slate-50 dark:bg-slate-700/50 hover:bg-slate-100 dark:hover:bg-slate-700 transition-all group",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(uw,{className:"w-5 h-5 text-indigo-500"}),l.jsx("span",{className:"text-sm font-medium",children:e("about.link_readme","README")})]}),l.jsx(Vu,{className:"w-4 h-4 text-slate-400 opacity-0 group-hover:opacity-100 transition-opacity"})]}),l.jsxs("a",{href:sf.changelog,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between p-3 rounded-xl bg-slate-50 dark:bg-slate-700/50 hover:bg-slate-100 dark:hover:bg-slate-700 transition-all group",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(xf,{className:"w-5 h-5 text-amber-500"}),l.jsx("span",{className:"text-sm font-medium",children:e("about.link_changelog","Changelog")})]}),l.jsx(Vu,{className:"w-4 h-4 text-slate-400 opacity-0 group-hover:opacity-100 transition-opacity"})]}),l.jsxs("a",{href:sf.docs,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between p-3 rounded-xl bg-slate-50 dark:bg-slate-700/50 hover:bg-slate-100 dark:hover:bg-slate-700 transition-all group",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(uw,{className:"w-5 h-5 text-blue-500"}),l.jsx("span",{className:"text-sm font-medium",children:e("about.link_docs","Documentation")})]}),l.jsx(Vu,{className:"w-4 h-4 text-slate-400 opacity-0 group-hover:opacity-100 transition-opacity"})]}),l.jsxs("a",{href:sf.website,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between p-3 rounded-xl bg-slate-50 dark:bg-slate-700/50 hover:bg-slate-100 dark:hover:bg-slate-700 transition-all group",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(wp,{className:"w-5 h-5 text-emerald-500"}),l.jsx("span",{className:"text-sm font-medium",children:e("about.link_website","Website")})]}),l.jsx(Vu,{className:"w-4 h-4 text-slate-400 opacity-0 group-hover:opacity-100 transition-opacity"})]})]})]}),l.jsxs("section",{className:"bg-blue-50 dark:bg-blue-900/10 rounded-2xl border border-blue-100 dark:border-blue-900/30 p-6",children:[l.jsxs("h3",{className:"text-lg font-bold text-blue-900 dark:text-blue-100 mb-2 flex items-center gap-2",children:[l.jsx(iL,{className:"w-4 h-4"}),e("about.support_title","Support")]}),l.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300 mb-4 font-medium",children:e("about.support_text","Do you have questions or feedback? We look forward to your message.")}),l.jsx("a",{href:sf.contact,target:"_blank",rel:"noopener noreferrer",className:"w-full inline-block text-center py-2.5 bg-blue-600 text-white rounded-lg font-bold text-sm shadow-lg shadow-blue-200 dark:shadow-none hover:bg-blue-700 transition-all active:scale-95",children:e("about.contact_cta","Contact us")})]}),l.jsx("div",{className:"px-2",children:l.jsxs("p",{className:"text-[10px] text-slate-400 dark:text-slate-500 uppercase tracking-widest font-bold",children:[e("about.copyright_prefix"," {{year}} LiteBI Studio Project. Released under ",{year:new Date().getFullYear()}),l.jsx("a",{href:"LICENSE",target:"_blank",rel:"noopener noreferrer",children:"MIT License"}),"."]})})]})]})]})})},qm={async get(e){const t=await Vr("SELECT value FROM sys_settings WHERE key = ?",[e]);return t.length>0?t[0]?.value:null},async set(e,t){await Vr("INSERT OR REPLACE INTO sys_settings (key, value) VALUES (?, ?)",[e,t]),Bi()}},bae=()=>{const{t:e}=ds(),t="report_pack_categories",r="report_pack_expanded_state",a=e("reports.default_category","General"),s="__all__",[n,o]=Z.useState([]),[c,u]=Z.useState([]),[f,h]=Z.useState(s),[g,x]=Z.useState(!1),[m,w]=Z.useState(""),[v,B]=Z.useState(!1),[k,E]=Z.useState(null),[S,L]=Z.useState({}),[P,R]=Z.useState(!1),[Q,V]=Z.useState(!1),[U,M]=Z.useState(null),[T,D]=Z.useState(null),G=Z.useRef(null),ne=Z.useRef(null),H=Z.useRef(Promise.resolve()),[ee,le]=Z.useState(null),[pe,te]=Z.useState({general:!0,cover:!0,headerFooter:!0,pageOptions:!0,quality:!0,preview:!0}),[Le,je]=Z.useState(!1),{isReadOnly:F}=So(),{isExporting:K,exportProgress:I,exportPackageToPdf:q,exportPackageToHtml:J,exportPackageToPpt:Y}=D_(),{data:de}=Ai(()=>jt.getDashboards(),[]),{data:ue}=Ai(()=>jt.getUserWidgets(),[]),we=Z.useCallback(async()=>{const ce=(await jt.getReportPacks()).map(Te=>({...Te,category:typeof Te.category=="string"&&Te.category.trim().length>0?Te.category:a})),Fe=await qm.get(r),Ne={};if(Fe)try{const Te=JSON.parse(Fe);Object.entries(Te).forEach(([Ue,tt])=>{typeof tt=="boolean"&&(Ne[Ue]=tt)})}catch{}o(ce),ce.length>0&&!k&&E(ce[0].id),L(()=>{const Te={};return ce.forEach(Ue=>{Te[Ue.id]=Ne[Ue.id]??!0}),Te})},[k,a,r]),Ie=Z.useCallback(async()=>{const O=await qm.get(t);if(!O){u([]);return}try{const ce=JSON.parse(O);if(!Array.isArray(ce)){u([]);return}const Fe=Array.from(new Set(ce.filter(Ne=>typeof Ne=="string").map(Ne=>Ne.trim()).filter(Ne=>Ne.length>0)));u(Fe)}catch{u([])}},[t]);Z.useEffect(()=>{const O=window.setTimeout(()=>{we(),Ie()},0);return()=>window.clearTimeout(O)},[Ie,we]);const Ae=O=>{if(typeof O=="string")try{return JSON.parse(O)}catch{return{type:"table"}}return O&&typeof O=="object"?O:{type:"table"}},oe=n.find(O=>O.id===k),He=(oe?.config.coverLogoUrl||"").trim(),se=Z.useMemo(()=>{const O=n.map(ce=>ce.category||a);return O.push(a),Array.from(new Set([...O,...c])).sort((ce,Fe)=>ce.localeCompare(Fe))},[c,a,n]),qe=m.trim(),Ye=se.some(O=>O.toLowerCase()===qe.toLowerCase()),at=qe.length>0&&!Ye,Ge=f===s||se.includes(f)?f:s,pt=Ge===s?n:n.filter(O=>(O.category||a)===Ge),nt=O=>n.find(ce=>ce.id===O),Dt=O=>{te(ce=>({...ce,[O]:!ce[O]}))},It=O=>O==="summary"?{orientation:"landscape",pageStatus:"info",statusThreshold:e("reports.template_summary_threshold","Top KPIs within plan"),pageComment:e("reports.template_summary_comment","Management summary with key trends and highlights.")}:O==="kpi"?{orientation:"portrait",pageStatus:"ok",statusThreshold:e("reports.template_kpi_threshold","Target >= 95%"),pageComment:e("reports.template_kpi_comment","Focused KPI page with target, variance and interpretation.")}:{orientation:"landscape",pageStatus:"warning",statusThreshold:e("reports.template_detail_threshold","Review outliers and exceptions"),pageComment:e("reports.template_detail_comment","Detailed analysis page with drilldown context and notes.")},Ot=(O,ce,Fe)=>{if(!oe)return;const Ne=[...oe.config.items],Te=Ne[O];if(!Te)return;const Ue=It(ce);Ne[O]={...Te,pageTemplate:ce,titleOverride:Te.titleOverride||`${e(`reports.template_${ce}`,ce)} - ${Fe}`,orientation:Ue.orientation,pageStatus:Ue.pageStatus,statusThreshold:Ue.statusThreshold,pageComment:Ue.pageComment},vt({...oe,config:{...oe.config,items:Ne}})},sr=Z.useCallback(O=>O.type==="dashboard"?de?.find(ce=>ce.id===O.id)?.name||"Dashboard":ue?.find(ce=>ce.id===O.id)?.name||"Widget",[de,ue]),er=Z.useCallback(O=>{if(O.type==="widget"){const Ne=ue?.find(Te=>Te.id===O.id);return!!(Ne?.sql_query&&Ne.sql_query.trim().length>0)}const ce=de?.find(Ne=>Ne.id===O.id);return(Array.isArray(ce?.layout)?ce?.layout||[]:[]).some(Ne=>{const Te=typeof Ne?.id=="string"?Ne.id:"",Ue=ue?.find(tt=>tt.id===Te);return!!(Ue?.sql_query&&Ue.sql_query.trim().length>0)})},[de,ue]),cr=Z.useCallback(O=>{const ce=[];return O.titleOverride?.trim()||ce.push(e("reports.quality_missing_title","Missing page title")),O.pageTemplate||ce.push(e("reports.quality_missing_template","No template selected")),O.pageStatus||ce.push(e("reports.quality_missing_status","No status set")),O.statusThreshold?.trim()||ce.push(e("reports.quality_missing_threshold","No threshold/target note")),O.pageComment?.trim()||ce.push(e("reports.quality_missing_comment","No page comment")),er(O)||ce.push(e("reports.quality_missing_data_source","No data source linked")),ce},[er,e]),Vt=Z.useMemo(()=>oe?oe.config.items.map((O,ce)=>{const Fe=cr(O);return{index:ce,name:sr(O),issues:Fe}}):[],[oe,cr,sr]),mt=Vt.reduce((O,ce)=>O+ce.issues.length,0),Nt=Z.useMemo(()=>n.map(O=>{const ce=O.config.items.reduce((Fe,Ne)=>Fe+cr(Ne).length,0);return{id:O.id,name:O.name,pageCount:O.config.items.length,issues:ce}}).sort((O,ce)=>ce.issues-O.issues||O.name.localeCompare(ce.name)),[n,cr]),gt=Nt.reduce((O,ce)=>O+ce.issues,0),dr=n.reduce((O,ce)=>O+ce.config.items.length,0),Ht=O=>{if(!oe)return;const ce=[...oe.config.items],Fe=ce[O];if(!Fe)return;const Ne=sr(Fe),Te=Fe.pageTemplate||"summary",Ue=It(Te);ce[O]={...Fe,pageTemplate:Te,titleOverride:Fe.titleOverride?.trim()?Fe.titleOverride:Ne,pageStatus:Fe.pageStatus||Ue.pageStatus,statusThreshold:Fe.statusThreshold?.trim()?Fe.statusThreshold:Ue.statusThreshold,pageComment:Fe.pageComment?.trim()?Fe.pageComment:Ue.pageComment},vt({...oe,config:{...oe.config,items:ce}})},Rt=()=>{if(!oe)return;const O=oe.config.items.map(ce=>{const Fe=sr(ce),Ne=ce.pageTemplate||"summary",Te=It(Ne);return{...ce,pageTemplate:Ne,titleOverride:ce.titleOverride?.trim()?ce.titleOverride:Fe,pageStatus:ce.pageStatus||Te.pageStatus,statusThreshold:ce.statusThreshold?.trim()?ce.statusThreshold:Te.statusThreshold,pageComment:ce.pageComment?.trim()?ce.pageComment:Te.pageComment}});vt({...oe,config:{...oe.config,items:O}})},$t=O=>new Promise((ce,Fe)=>{const Ne=new FileReader;Ne.onload=()=>ce(String(Ne.result||"")),Ne.onerror=()=>Fe(new Error("Failed to read file")),Ne.readAsDataURL(O)}),vr=async O=>{const ce=O.target.files?.[0];if(!(!ce||!oe))try{const Fe=await $t(ce);M(null),await vt({...oe,config:{...oe.config,coverLogoUrl:Fe}})}catch{await Qt.error(e("reports.logo_upload_failed","Logo upload failed."))}finally{O.target.value=""}},vt=async O=>{if(F)return;const ce=typeof O.category=="string"&&O.category.trim().length>0?O.category.trim():a,Fe={...O,category:ce};o(Ne=>{const Te=Ne.findIndex(Ue=>Ue.id===Fe.id);if(Te>=0){const Ue=[...Ne];return Ue[Te]=Fe,Ue}return[Fe,...Ne]}),H.current=H.current.catch(()=>{}).then(async()=>{await jt.saveReportPack({...Fe,category:ce})}),await H.current},kr=async O=>{const ce=Array.from(new Set(O.map(Fe=>Fe.trim()).filter(Fe=>Fe.length>0)));u(ce),await qm.set(t,JSON.stringify(ce))},tr=async O=>{await qm.set(r,JSON.stringify(O))},rr=()=>{const O=localStorage.getItem("reports_default_author")||"LiteBI Studio",ce=localStorage.getItem("reports_default_theme_color")||"#1e293b",Fe=localStorage.getItem("reports_default_show_header"),Ne=localStorage.getItem("reports_default_show_footer"),Te=localStorage.getItem("reports_default_include_audit_appendix"),Ue=Ge===s?a:Ge,tt={id:crypto.randomUUID(),name:e("reports.new_pack_name"),category:Ue,description:"",config:{coverTitle:e("reports.new_pack_name"),coverSubtitle:new Date().toLocaleDateString(void 0,{month:"long",year:"numeric"}),author:O,coverLogoUrl:"",themeColor:ce,showTOC:!0,exportOptions:{showHeader:Fe===null?!0:Fe==="true",showFooter:Ne===null?!0:Ne==="true",headerText:"",footerText:"",footerMode:"content_only",dataAsOf:"",includeAuditAppendix:Te===null?!1:Te==="true"},items:[]}};vt(tt),E(tt.id),h(Ue)},Xt=async()=>{F||!at||(se.includes(qe)||await kr([...c,qe]),h(qe),x(!1),w(""))},Kt=async O=>{if(F||O===a)return;const Fe=(await Qt.prompt(e("reports.rename_category_prompt","New category name:"),{defaultValue:O}))?.trim();if(!Fe||Fe===O)return;if(se.some(Ue=>Ue.toLowerCase()===Fe.toLowerCase()&&Ue!==O)){await Qt.warning(e("reports.category_exists","A category with this name already exists."));return}const Te=n.filter(Ue=>(Ue.category||a)===O);await Promise.all(Te.map(Ue=>jt.saveReportPack({...Ue,category:Fe}))),await kr(c.map(Ue=>Ue===O?Fe:Ue)),f===O&&h(Fe),await we()},Ft=async O=>{if(F||O===a)return;const ce=n.filter(Te=>(Te.category||a)===O),Fe=ce.length;(Fe===0?await Qt.confirm(e("reports.delete_category_confirm","Delete this category?")):await Qt.confirm(e("reports.delete_category_with_packs_confirm",{count:Fe,category:O,defaultValue:`Delete category "${O}" and all ${Fe} report packages in it?`})))&&(Fe>0&&(await Promise.all(ce.map(Te=>jt.deleteReportPack(Te.id))),k&&ce.some(Te=>Te.id===k)&&E(null)),await kr(c.filter(Te=>Te!==O)),f===O&&h(s),await we())},Zt=async O=>{F||await Qt.confirm(e("common.confirm_delete"))&&(await jt.deleteReportPack(O),await we(),k===O&&E(null))},wr=O=>{L(ce=>{const Fe={...ce,[O]:!ce[O]};return tr(Fe),Fe})},Re=O=>{L(ce=>{const Fe={...ce};return n.forEach(Ne=>{Fe[Ne.id]=O}),tr(Fe),Fe})},Et=O=>{E(O),V(!0)},Tt=O=>{E(O),R(!0)},Bt=(O,ce,Fe)=>{const Ne=nt(O);if(!Ne)return;const Te=[...Ne.config.items],Ue=Fe==="up"?ce-1:ce+1;Ue<0||Ue>=Te.length||([Te[ce],Te[Ue]]=[Te[Ue],Te[ce]],vt({...Ne,config:{...Ne.config,items:Te}}))},Yt=(O,ce)=>{const Fe=nt(O);if(!Fe)return;const Ne=Fe.config.items.filter((Te,Ue)=>Ue!==ce);vt({...Fe,config:{...Fe.config,items:Ne}})},Mr=O=>{oe&&(vt({...oe,config:{...oe.config,items:[...oe.config.items,O]}}),V(!1))},Jr=async(O,ce)=>{F||(await vt({...O,category:ce}),D(null))},jr=O=>{const ce=[];return{exportItems:O.config.items.map(Ne=>{if(Ne.type==="dashboard"){const tt=de?.find(yt=>yt.id===Ne.id),_t=tt?.name||"Dashboard";return(Array.isArray(tt?.layout)?tt.layout||[]:[]).forEach(yt=>{const Ut=typeof yt?.id=="string"?yt.id:"";if(!Ut)return;const zt=ue?.find(Gr=>Gr.id===Ut);zt?.sql_query&&ce.push({source:`${_t} / ${zt.name}`,sql:zt.sql_query})}),{elementId:`export-dash-${Ne.id}`,title:Ne.titleOverride||_t,subtitle:Ne.pageComment||"",status:Ne.pageStatus,threshold:Ne.statusThreshold||"",orientation:Ne.orientation||"landscape"}}const Te=ue?.find(tt=>tt.id===Ne.id),Ue=Te?.name||"Widget";return Te?.sql_query&&ce.push({source:Ue,sql:Te.sql_query}),{elementId:`export-widget-${Ne.id}`,title:Ne.titleOverride||Ue,subtitle:Ne.pageComment||"",status:Ne.pageStatus,threshold:Ne.statusThreshold||"",orientation:Ne.orientation||"landscape"}}),auditMeta:{packName:O.name,generatedAt:new Date().toISOString(),dataAsOf:O.config.exportOptions?.dataAsOf,sqlSources:ce}}},fr=async O=>{E(O.id),await new Promise(Ne=>requestAnimationFrame(()=>Ne()));const{exportItems:ce,auditMeta:Fe}=jr(O);await q(O.name,ce,{title:O.config.coverTitle,subtitle:O.config.coverSubtitle,author:O.config.author,logoUrl:O.config.coverLogoUrl?.trim(),themeColor:O.config.themeColor},O.config.exportOptions,Fe)},Cr=async O=>{E(O.id),await new Promise(Ne=>requestAnimationFrame(()=>Ne()));const{exportItems:ce,auditMeta:Fe}=jr(O);await J(O.name,ce,{title:O.config.coverTitle,subtitle:O.config.coverSubtitle,author:O.config.author,logoUrl:O.config.coverLogoUrl?.trim(),themeColor:O.config.themeColor},O.config.exportOptions,Fe)},re=async O=>{E(O.id),await new Promise(Ne=>requestAnimationFrame(()=>Ne()));const{exportItems:ce,auditMeta:Fe}=jr(O);await Y(O.name,ce,{title:O.config.coverTitle,subtitle:O.config.coverSubtitle,author:O.config.author,logoUrl:O.config.coverLogoUrl?.trim(),themeColor:O.config.themeColor},O.config.exportOptions,Fe)},ke=O=>{const ce={type:"litebi-report-pack",version:1,exportedAt:new Date().toISOString(),pack:O},Fe=new Blob([JSON.stringify(ce,null,2)],{type:"application/json;charset=utf-8"}),Ne=document.createElement("a"),Te=(O.name||"report-pack").trim().replace(/[<>:"/\\|?*]/g,"_");Ne.download=`${Te||"report-pack"}.litebi-report-pack.json`,Ne.href=URL.createObjectURL(Fe),Ne.click(),URL.revokeObjectURL(Ne.href)},me=O=>{le(O),ne.current?.click()},be=()=>{le(null),ne.current?.click()},ye=async O=>{const ce=O.target.files?.[0];if(O.target.value="",!!ce)try{const Fe=await ce.text(),Ne=JSON.parse(Fe),Te=Ne&&typeof Ne=="object"&&"pack"in Ne?Ne.pack:Ne;if(!Te||typeof Te!="object")throw new Error("Invalid JSON structure");const Ue=Te;if(!Ue.name||!Ue.config||!Array.isArray(Ue.config.items))throw new Error("Invalid report package payload");const tt=ee?nt(ee):void 0;if(tt)if(await Qt.confirm(e("reports.import_overwrite_confirm",{name:tt.name,defaultValue:`Replace "${tt.name}" with the imported definition?`}))){const Ct={...Ue,id:tt.id,category:tt.category||a};await vt(Ct),E(tt.id)}else{const Ct={...Ue,id:crypto.randomUUID(),category:tt.category||a,name:`${Ue.name} (Import)`};await vt(Ct),E(Ct.id)}else{const _t={...Ue,id:crypto.randomUUID(),category:Ue.category||a};await vt(_t),E(_t.id)}await Qt.info(e("reports.import_success","Report package was imported successfully."))}catch{await Qt.error(e("reports.import_failed","Import failed. Invalid report package JSON."))}finally{le(null)}};return l.jsxs(x0,{header:{title:e("reports.title","Reporting"),subtitle:e("reports.subtitle","Build and export multi-page management reports."),actions:l.jsx("div",{className:"flex items-center gap-2",children:l.jsxs("button",{onClick:rr,disabled:F,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm font-medium text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:[l.jsx(eA,{className:"w-4 h-4"})," ",e("common.add")]})})},rightPanel:{title:e("reports.panel_title","Reporting Assistant"),triggerTitle:e("reports.panel_title","Reporting Assistant"),enabled:!0,width:"md",isOpen:Le,onOpenChange:je,content:l.jsxs("div",{className:"h-full min-h-0 flex flex-col gap-4",children:[l.jsxs("section",{className:"rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50/60 dark:bg-slate-900/40 p-3 space-y-3",children:[l.jsx("div",{className:"text-[10px] font-black uppercase tracking-wider text-slate-400",children:e("reports.panel_overview","Overview")}),l.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[l.jsxs("div",{className:"rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 p-2",children:[l.jsx("div",{className:"text-[10px] text-slate-400",children:e("reports.panel_metric_packs","Packs")}),l.jsx("div",{className:"text-sm font-bold text-slate-800 dark:text-slate-100",children:n.length})]}),l.jsxs("div",{className:"rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 p-2",children:[l.jsx("div",{className:"text-[10px] text-slate-400",children:e("reports.panel_metric_pages","Pages")}),l.jsx("div",{className:"text-sm font-bold text-slate-800 dark:text-slate-100",children:dr})]}),l.jsxs("div",{className:"rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 p-2",children:[l.jsx("div",{className:"text-[10px] text-slate-400",children:e("reports.panel_metric_issues","Issues")}),l.jsx("div",{className:`text-sm font-bold ${gt>0?"text-amber-600 dark:text-amber-300":"text-emerald-600 dark:text-emerald-300"}`,children:gt})]})]})]}),l.jsxs("section",{className:"rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50/60 dark:bg-slate-900/40 p-3 space-y-2",children:[l.jsx("div",{className:"text-[10px] font-black uppercase tracking-wider text-slate-400",children:e("reports.panel_quick_actions","Quick Actions")}),l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsx("button",{type:"button",onClick:()=>{rr(),je(!1)},disabled:F,className:"px-2 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 text-xs font-semibold text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800 disabled:opacity-40",children:e("reports.panel_action_new_pack","New Pack")}),l.jsx("button",{type:"button",onClick:be,disabled:F,className:"px-2 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 text-xs font-semibold text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800 disabled:opacity-40",children:e("reports.panel_action_import_json","Import JSON")}),l.jsx("button",{type:"button",onClick:()=>Re(!0),className:"px-2 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 text-xs font-semibold text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800",children:e("reports.panel_action_expand_all","Expand all")}),l.jsx("button",{type:"button",onClick:()=>Re(!1),className:"px-2 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 text-xs font-semibold text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800",children:e("reports.panel_action_collapse_all","Collapse all")})]})]}),l.jsxs("section",{className:"rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50/60 dark:bg-slate-900/40 p-3 space-y-2 min-h-0 flex-1 flex flex-col",children:[l.jsx("div",{className:"text-[10px] font-black uppercase tracking-wider text-slate-400",children:e("reports.panel_quality_global","Quality (Global)")}),l.jsx("div",{className:"min-h-0 overflow-auto custom-scrollbar space-y-2 pr-1",children:Nt.length===0?l.jsx("div",{className:"text-xs text-slate-400",children:e("common.no_data","No data")}):Nt.slice(0,8).map(O=>l.jsxs("div",{className:"w-full text-left p-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 opacity-80",children:[l.jsx("div",{className:"text-xs font-semibold text-slate-700 dark:text-slate-200 truncate",children:O.name}),l.jsxs("div",{className:"text-[11px] text-slate-500 dark:text-slate-400",children:[O.pageCount," ",e("reports.pages","Pages"),"  ",O.issues," ",e("reports.panel_metric_issues","Issues")]})]},O.id))})]})]})},children:[l.jsxs("div",{className:`h-[calc(100vh-140px)] overflow-y-auto custom-scrollbar p-1 ${F?"pointer-events-none opacity-80":""}`,children:[l.jsxs("div",{className:"space-y-5",children:[l.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200 dark:border-slate-800",children:[l.jsxs("div",{className:"flex items-center gap-1 overflow-x-auto no-scrollbar pb-px",children:[l.jsx("button",{onClick:()=>h(s),className:`px-4 py-2.5 text-sm font-bold transition-all border-b-2 whitespace-nowrap ${Ge===s?"text-blue-600 border-blue-600":"text-slate-400 border-transparent hover:text-slate-600"}`,children:e("common.all","All")}),se.map(O=>l.jsx("button",{onClick:()=>h(O),className:`px-4 py-2.5 text-sm font-bold transition-all border-b-2 whitespace-nowrap ${Ge===O?"text-blue-600 border-blue-600":"text-slate-400 border-transparent hover:text-slate-600"}`,children:O},O)),!F&&l.jsx("button",{onClick:()=>{x(!0),w("")},className:"px-4 py-2.5 text-slate-400 hover:text-blue-600 transition-all border-b-2 border-transparent",title:e("reports.new_category","New category"),children:l.jsx(eA,{className:"w-4 h-4"})})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("button",{onClick:()=>Re(!0),className:"p-2 text-slate-400 hover:text-slate-600",title:e("reports.expand_all_packs","Expand all reports"),children:l.jsx(ix,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>Re(!1),className:"p-2 text-slate-400 hover:text-slate-600",title:e("reports.collapse_all_packs","Collapse all reports"),children:l.jsx(y2,{className:"w-4 h-4"})}),!F&&l.jsx("button",{onClick:()=>B(!0),className:"p-2 text-slate-400 hover:text-slate-600",title:e("reports.manage_categories","Manage categories"),children:l.jsx(_p,{className:"w-4 h-4"})})]})]}),g&&l.jsxs("div",{className:"mb-1 p-4 bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-800 rounded-xl flex items-center gap-3",children:[l.jsx(wn,{className:"w-5 h-5 text-slate-400"}),l.jsx("input",{autoFocus:!0,type:"text",placeholder:e("reports.new_category_placeholder","Category name (e.g. Management)"),className:"flex-1 bg-transparent border-none outline-none font-bold text-slate-700 dark:text-slate-200",value:m,onChange:O=>w(O.target.value),onKeyDown:O=>O.key==="Enter"&&void Xt()}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("button",{onClick:()=>{Xt()},disabled:!at,className:`p-1.5 rounded transition-colors ${at?"text-green-600 hover:bg-green-50":"text-slate-300 cursor-not-allowed"}`,children:l.jsx(Yx,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>{x(!1),w("")},className:"p-1.5 text-slate-400 hover:bg-slate-100 rounded",children:l.jsx(vl,{className:"w-4 h-4"})})]})]}),pt.map(O=>{const ce=S[O.id]??!0,Fe=k===O.id,Ne=O.category||a,Te=se.filter(Ue=>Ue!==Ne);return l.jsxs("section",{className:`bg-white dark:bg-slate-900 border rounded-2xl shadow-sm transition-all ${Fe?"border-blue-200 dark:border-blue-800":"border-slate-200 dark:border-slate-800"}`,children:[l.jsxs("div",{className:"flex items-center justify-between p-4",children:[l.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[l.jsx("button",{onClick:()=>wr(O.id),className:"p-1 text-slate-400 hover:text-blue-600 rounded transition-colors",title:ce?e("common.collapse","Collapse"):e("common.expand","Expand"),children:l.jsx(Yl,{className:`w-4 h-4 transition-transform ${ce?"rotate-90":""}`})}),l.jsx("button",{onClick:()=>E(O.id),className:"w-10 h-10 bg-blue-50 dark:bg-blue-900/20 rounded-xl flex items-center justify-center text-blue-600 shrink-0",title:e("reports.pack_settings","Package Settings"),children:l.jsx(uw,{className:"w-5 h-5"})}),l.jsxs("div",{className:"min-w-0",children:[l.jsx("h3",{className:"font-bold text-slate-800 dark:text-white leading-tight truncate",children:O.name}),l.jsxs("p",{className:"text-xs text-slate-400",children:[O.category||a," | ",O.config.items.length," ",e("reports.pages","Pages")]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[!F&&l.jsxs("div",{className:"relative",children:[l.jsx("button",{onClick:()=>D(Ue=>Ue===O.id?null:O.id),disabled:Te.length===0,className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors disabled:opacity-30 disabled:hover:text-slate-400 disabled:hover:bg-transparent",title:Te.length===0?e("reports.move_category_unavailable","No other category available"):e("reports.move_category","Move to category"),children:l.jsx(lL,{className:"w-4 h-4"})}),T===O.id&&Te.length>0&&l.jsx("div",{className:"absolute right-0 top-10 z-20 min-w-[170px] rounded-xl border border-slate-200 bg-white shadow-lg p-1",children:Te.map(Ue=>l.jsx("button",{onClick:()=>{Jr(O,Ue)},className:"w-full text-left px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 rounded-lg transition-colors",children:Ue},`${O.id}-move-${Ue}`))})]}),!F&&l.jsxs("button",{onClick:()=>Et(O.id),className:"flex items-center gap-2 px-2 sm:px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-lg text-slate-500 dark:text-slate-300 hover:text-blue-600 hover:border-blue-200 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors font-bold text-sm",title:e("reports.add_page","Add Page"),"aria-label":e("reports.add_page","Add Page"),children:[l.jsx(eA,{className:"w-4 h-4"}),l.jsx("span",{className:"hidden sm:inline",children:e("reports.add_page","Add Page")})]}),!F&&l.jsx("button",{onClick:()=>Tt(O.id),className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:e("common.settings"),children:l.jsx(_p,{className:"w-5 h-5"})}),!F&&l.jsx("button",{onClick:()=>Zt(O.id),className:"p-2 text-slate-300 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors",title:e("common.delete"),children:l.jsx(ii,{className:"w-4 h-4"})}),l.jsxs("div",{className:"inline-flex items-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 p-1",children:[l.jsx("button",{onClick:()=>fr(O),disabled:K||O.config.items.length===0,className:"p-2 text-slate-500 dark:text-slate-300 hover:text-blue-600 dark:hover:text-blue-300 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:K&&Fe?`${I}%`:`${e("reports.export_batch")} (.pdf)`,"aria-label":K&&Fe?`${I}%`:`${e("reports.export_batch")} (.pdf)`,children:l.jsx(oL,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>{re(O)},disabled:K||O.config.items.length===0,className:"p-2 text-slate-500 dark:text-slate-300 hover:text-blue-600 dark:hover:text-blue-300 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:`${e("reports.export_ppt","Export PPT")} (.ppt)`,"aria-label":`${e("reports.export_ppt","Export PPT")} (.ppt)`,children:l.jsx(C2,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>{Cr(O)},disabled:K||O.config.items.length===0,className:"p-2 text-slate-500 dark:text-slate-300 hover:text-blue-600 dark:hover:text-blue-300 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:`${e("reports.export_html","Export HTML")} (.html)`,"aria-label":`${e("reports.export_html","Export HTML")} (.html)`,children:l.jsx(wp,{className:"w-4 h-4"})})]}),l.jsxs("div",{className:"inline-flex items-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 p-1",children:[l.jsx("button",{onClick:()=>ke(O),disabled:K,className:"p-2 text-slate-500 dark:text-slate-300 hover:text-blue-600 dark:hover:text-blue-300 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:`${e("reports.export_json","Export JSON")} (.json)`,"aria-label":`${e("reports.export_json","Export JSON")} (.json)`,children:l.jsx(lf,{className:"w-4 h-4"})}),!F&&l.jsx("button",{onClick:()=>me(O.id),className:"p-2 text-slate-500 dark:text-slate-300 hover:text-blue-600 dark:hover:text-blue-300 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-md transition-colors",title:`${e("reports.import_json","Import JSON")} (.json)`,"aria-label":`${e("reports.import_json","Import JSON")} (.json)`,children:l.jsx(yp,{className:"w-4 h-4"})})]})]})]}),ce&&l.jsx("div",{className:"px-4 pb-4",children:O.config.items.length>0?l.jsx("div",{className:"space-y-3",children:O.config.items.map((Ue,tt)=>{const _t=Ue.type==="dashboard"?de?.find(Ct=>Ct.id===Ue.id):ue?.find(Ct=>Ct.id===Ue.id);return _t?l.jsxs("div",{className:"flex items-center gap-4 p-4 bg-slate-50/70 dark:bg-slate-800/40 border border-slate-100 dark:border-slate-800 rounded-xl group hover:shadow-sm transition-all",children:[l.jsxs("div",{className:"flex flex-col gap-1 items-center",children:[l.jsx("button",{onClick:()=>Bt(O.id,tt,"up"),className:"text-slate-300 hover:text-blue-500 disabled:opacity-0",disabled:tt===0,children:l.jsx(AL,{className:"w-3.5 h-3.5"})}),l.jsx("div",{className:"w-6 h-6 bg-white dark:bg-slate-900 rounded flex items-center justify-center text-[10px] font-black text-slate-400",children:tt+1}),l.jsx("button",{onClick:()=>Bt(O.id,tt,"down"),className:"text-slate-300 hover:text-blue-500 disabled:opacity-0",disabled:tt===O.config.items.length-1,children:l.jsx(cL,{className:"w-3.5 h-3.5"})})]}),l.jsx("div",{className:"w-10 h-10 bg-slate-100 dark:bg-slate-800 rounded-lg flex items-center justify-center",children:Ue.type==="dashboard"?l.jsx(wn,{className:"w-5 h-5 text-slate-400"}):l.jsx(wl,{className:"w-5 h-5 text-slate-400"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("div",{className:"text-sm font-bold text-slate-700 dark:text-slate-200 truncate",children:_t.name}),l.jsx("div",{className:"text-[10px] font-black uppercase tracking-widest text-slate-400",children:Ue.type})]}),l.jsx("button",{onClick:()=>Yt(O.id,tt),className:"p-2 text-slate-200 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-all",children:l.jsx(ii,{className:"w-4 h-4"})})]},tt):null})}):l.jsx("div",{className:"text-center py-8 border border-dashed border-slate-200 dark:border-slate-700 rounded-xl text-slate-400 text-sm",children:e("reports.add_page","Add Page")})})]},O.id)}),n.length===0&&l.jsxs("div",{className:"text-center py-16 border-2 border-dashed border-slate-100 dark:border-slate-800 rounded-2xl",children:[l.jsx(xf,{className:"w-10 h-10 mx-auto mb-3 text-slate-200"}),l.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-slate-300",children:e("reports.no_packages")})]}),n.length>0&&pt.length===0&&l.jsxs("div",{className:"text-center py-16 border-2 border-dashed border-slate-100 dark:border-slate-800 rounded-2xl",children:[l.jsx(xf,{className:"w-10 h-10 mx-auto mb-3 text-slate-200"}),l.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-slate-300",children:e("reports.no_packages_in_category","No packages in this category yet.")})]})]}),l.jsx("div",{className:"fixed -left-[10000px] top-0 opacity-0 pointer-events-none w-[1400px]",children:oe?.config.items.map((O,ce)=>{if(O.type==="dashboard"){const Te=de?.find(Ue=>Ue.id===O.id);return Te?l.jsxs("div",{id:`export-dash-${O.id}`,className:"bg-white p-10 min-h-[1000px]",children:[l.jsxs("div",{className:"mb-10 flex items-center justify-between border-b pb-4",children:[l.jsx("h1",{className:"text-3xl font-black text-slate-800",children:Te.name}),l.jsxs("span",{className:"text-sm text-slate-400 font-mono",children:[e("reports.page")," ",ce+1]})]}),l.jsx("div",{className:"grid grid-cols-2 gap-10",children:Array.isArray(Te.layout)&&Te.layout.map(Ue=>{const tt=ue?.find(Ct=>Ct.id===Ue.id);if(!tt)return null;const _t=Ae(tt.visualization_config);return l.jsx("div",{className:"h-[400px]",children:l.jsx(_2,{title:tt.name,sql:tt.sql_query,config:_t})},Ue.id)})})]},`ghost-dash-${ce}`):null}const Fe=ue?.find(Te=>Te.id===O.id);if(!Fe)return null;const Ne=Ae(Fe.visualization_config);return l.jsx("div",{id:`export-widget-${O.id}`,className:"bg-white p-10 min-h-[1000px] flex flex-col items-center justify-center",children:l.jsx("div",{className:"w-full max-w-4xl h-[600px]",children:l.jsx(_2,{title:Fe.name,sql:Fe.sql_query,config:Ne})})},`ghost-widget-${ce}`)})}),l.jsx("input",{ref:ne,type:"file",accept:".json,application/json",className:"hidden",onChange:O=>{ye(O)}})]}),l.jsx(HE,{isOpen:P,onClose:()=>R(!1),title:e("reports.pack_settings","Package Settings"),width:"md",noScroll:!0,children:oe&&l.jsxs("div",{className:"flex h-full min-h-0 flex-col",children:[l.jsxs("div",{className:"flex-1 min-h-0 overflow-auto pr-1 space-y-6",children:[l.jsxs("section",{className:"space-y-3 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50/50 dark:bg-slate-900/40 p-3",children:[l.jsxs("button",{type:"button",onClick:()=>Dt("general"),className:"w-full flex items-center justify-between text-left rounded-lg px-1 py-1 hover:bg-slate-100/70 dark:hover:bg-slate-800/70",children:[l.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 tracking-wider cursor-pointer",children:e("reports.general")}),l.jsx(Yl,{className:`w-4 h-4 text-slate-400 transition-transform ${pe.general?"rotate-90":""}`})]}),pe.general&&l.jsxs("div",{className:"space-y-3",children:[l.jsx("input",{className:"w-full px-4 py-2 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl font-bold text-slate-900 dark:text-slate-100 placeholder:text-slate-400 dark:placeholder:text-slate-500 outline-none focus:ring-2 focus:ring-blue-500",value:oe.name,onChange:O=>vt({...oe,name:O.target.value}),placeholder:e("reports.pack_name_placeholder")}),l.jsx("input",{className:"w-full px-4 py-2 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl font-medium text-slate-900 dark:text-slate-100 placeholder:text-slate-400 dark:placeholder:text-slate-500 outline-none focus:ring-2 focus:ring-blue-500",value:oe.category||a,onChange:O=>vt({...oe,category:O.target.value}),placeholder:e("reports.category","Category")})]})]}),l.jsxs("section",{className:"space-y-3 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50/50 dark:bg-slate-900/40 p-3",children:[l.jsxs("button",{type:"button",onClick:()=>Dt("quality"),className:"w-full flex items-center justify-between text-left rounded-lg px-1 py-1 hover:bg-slate-100/70 dark:hover:bg-slate-800/70",children:[l.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 tracking-wider cursor-pointer",children:e("reports.quality","Quality")}),l.jsx(Yl,{className:`w-4 h-4 text-slate-400 transition-transform ${pe.quality?"rotate-90":""}`})]}),pe.quality&&l.jsxs("div",{className:"space-y-3 p-4 bg-slate-50 dark:bg-slate-800 rounded-2xl",children:[l.jsxs("div",{className:"flex items-center justify-between gap-3",children:[l.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-300",children:mt===0?e("reports.quality_all_good","All pages look good."):e("reports.quality_issues_count",{count:mt,defaultValue:"{{count}} quality issues found."})}),l.jsx("button",{type:"button",onClick:Rt,disabled:mt===0,className:"px-2 py-1.5 rounded text-xs font-semibold border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800 disabled:opacity-40",children:e("reports.quality_fix_all","Fix all")})]}),l.jsx("div",{className:"space-y-2 max-h-56 overflow-auto custom-scrollbar pr-1",children:Vt.map(O=>l.jsxs("div",{className:"p-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900",children:[l.jsxs("div",{className:"flex items-center justify-between gap-2",children:[l.jsxs("div",{className:"text-xs font-semibold text-slate-700 dark:text-slate-200 truncate",children:[O.index+1,". ",O.name]}),l.jsx("button",{type:"button",onClick:()=>Ht(O.index),disabled:O.issues.length===0,className:"px-2 py-1 rounded text-[11px] font-semibold border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-700 disabled:opacity-40",children:e("reports.quality_fix","Fix")})]}),O.issues.length>0?l.jsx("ul",{className:"mt-2 space-y-1",children:O.issues.map((ce,Fe)=>l.jsxs("li",{className:"text-[11px] text-slate-500 dark:text-slate-400",children:[" ",ce]},`${O.index}-${Fe}`))}):l.jsx("div",{className:"mt-2 text-[11px] text-emerald-600 dark:text-emerald-300",children:e("reports.quality_row_ok","No issues")})]},`quality-${O.index}`))})]})]}),l.jsxs("section",{className:"space-y-3 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50/50 dark:bg-slate-900/40 p-3",children:[l.jsxs("button",{type:"button",onClick:()=>Dt("cover"),className:"w-full flex items-center justify-between text-left rounded-lg px-1 py-1 hover:bg-slate-100/70 dark:hover:bg-slate-800/70",children:[l.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 tracking-wider cursor-pointer",children:e("reports.cover_page")}),l.jsx(Yl,{className:`w-4 h-4 text-slate-400 transition-transform ${pe.cover?"rotate-90":""}`})]}),pe.cover&&l.jsxs("div",{className:"space-y-3 p-4 bg-slate-50 dark:bg-slate-800 rounded-2xl",children:[l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex items-center gap-2 text-[11px] font-bold text-slate-500 dark:text-slate-400",children:[l.jsx(xf,{className:"w-3 h-3"})," ",e("reports.title_label")]}),l.jsx("input",{className:"w-full bg-white dark:bg-slate-900 px-3 py-1.5 rounded-lg text-sm text-slate-900 dark:text-slate-100 border border-slate-100 dark:border-slate-700 placeholder:text-slate-400 dark:placeholder:text-slate-500 outline-none focus:ring-2 focus:ring-blue-500/50",value:oe.config.coverTitle,onChange:O=>vt({...oe,config:{...oe.config,coverTitle:O.target.value}})})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex items-center gap-2 text-[11px] font-bold text-slate-500 dark:text-slate-400",children:[l.jsx(Yl,{className:"w-3 h-3"})," ",e("reports.subtitle_label")]}),l.jsx("input",{className:"w-full bg-white dark:bg-slate-900 px-3 py-1.5 rounded-lg text-sm text-slate-900 dark:text-slate-100 border border-slate-100 dark:border-slate-700 placeholder:text-slate-400 dark:placeholder:text-slate-500 outline-none focus:ring-2 focus:ring-blue-500/50",value:oe.config.coverSubtitle||"",onChange:O=>vt({...oe,config:{...oe.config,coverSubtitle:O.target.value}})})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex items-center gap-2 text-[11px] font-bold text-slate-500 dark:text-slate-400",children:[l.jsx(VS,{className:"w-3 h-3"})," ",e("reports.author")]}),l.jsx("input",{className:"w-full bg-white dark:bg-slate-900 px-3 py-1.5 rounded-lg text-sm text-slate-900 dark:text-slate-100 border border-slate-100 dark:border-slate-700 placeholder:text-slate-400 dark:placeholder:text-slate-500 outline-none focus:ring-2 focus:ring-blue-500/50",value:oe.config.author||"",onChange:O=>vt({...oe,config:{...oe.config,author:O.target.value}})})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("div",{className:"flex items-center gap-2 text-[11px] font-bold text-slate-500 dark:text-slate-400",children:e("reports.logo_url","Logo URL")}),l.jsx("input",{className:"w-full bg-white dark:bg-slate-900 px-3 py-1.5 rounded-lg text-sm text-slate-900 dark:text-slate-100 border border-slate-100 dark:border-slate-700 placeholder:text-slate-400 dark:placeholder:text-slate-500 outline-none focus:ring-2 focus:ring-blue-500/50",value:oe.config.coverLogoUrl||"",onChange:O=>{M(null),vt({...oe,config:{...oe.config,coverLogoUrl:O.target.value}})},placeholder:"https://..."}),l.jsxs("div",{className:"flex items-center gap-2 pt-1",children:[l.jsx("input",{ref:G,type:"file",accept:"image/*",className:"hidden",onChange:O=>{vr(O)}}),l.jsx("button",{type:"button",onClick:()=>G.current?.click(),className:"px-2.5 py-1.5 rounded-lg text-xs font-semibold border border-slate-200 dark:border-slate-700 bg-slate-100 dark:bg-slate-900 hover:bg-slate-200 dark:hover:bg-slate-800 text-slate-700 dark:text-slate-200 transition-colors",children:e("reports.upload_logo","Upload logo")}),!!oe.config.coverLogoUrl&&l.jsx("button",{type:"button",onClick:()=>{M(null),vt({...oe,config:{...oe.config,coverLogoUrl:""}})},className:"px-2.5 py-1.5 rounded-lg text-xs font-semibold border border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-900/20 hover:bg-red-100 dark:hover:bg-red-900/30 text-red-600 dark:text-red-300 transition-colors",children:e("common.remove","Remove")})]})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("div",{className:"flex items-center gap-2 text-[11px] font-bold text-slate-500 dark:text-slate-400",children:e("reports.theme_color","Theme Color")}),l.jsx("input",{type:"color",className:"w-full h-9 bg-white dark:bg-slate-900 px-1 py-1 rounded-lg border border-slate-100 dark:border-slate-700 outline-none",value:oe.config.themeColor||"#1e293b",onChange:O=>vt({...oe,config:{...oe.config,themeColor:O.target.value}})})]})]})]}),l.jsxs("section",{className:"space-y-3 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50/50 dark:bg-slate-900/40 p-3",children:[l.jsxs("button",{type:"button",onClick:()=>Dt("headerFooter"),className:"w-full flex items-center justify-between text-left rounded-lg px-1 py-1 hover:bg-slate-100/70 dark:hover:bg-slate-800/70",children:[l.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 tracking-wider cursor-pointer",children:e("reports.export_options","Header / Footer")}),l.jsx(Yl,{className:`w-4 h-4 text-slate-400 transition-transform ${pe.headerFooter?"rotate-90":""}`})]}),pe.headerFooter&&l.jsxs("div",{className:"space-y-3 p-4 bg-slate-50 dark:bg-slate-800 rounded-2xl",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("label",{className:"flex items-center gap-2 text-xs font-semibold text-slate-600 dark:text-slate-300",children:[l.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-900 text-blue-600 dark:text-blue-400 accent-blue-600 dark:accent-blue-500 focus:ring-blue-500/50",checked:oe.config.exportOptions?.showHeader??!0,onChange:O=>vt({...oe,config:{...oe.config,exportOptions:{...oe.config.exportOptions||{},showHeader:O.target.checked}}})}),e("reports.show_header","Show header")]}),l.jsxs("label",{className:"flex items-center gap-2 text-xs font-semibold text-slate-600 dark:text-slate-300",children:[l.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-900 text-blue-600 dark:text-blue-400 accent-blue-600 dark:accent-blue-500 focus:ring-blue-500/50",checked:oe.config.exportOptions?.showFooter??!0,onChange:O=>vt({...oe,config:{...oe.config,exportOptions:{...oe.config.exportOptions||{},showFooter:O.target.checked}}})}),e("reports.show_footer","Show footer")]})]}),l.jsx("input",{className:"w-full bg-white dark:bg-slate-900 px-3 py-1.5 rounded-lg text-sm text-slate-900 dark:text-slate-100 border border-slate-100 dark:border-slate-700 placeholder:text-slate-400 dark:placeholder:text-slate-500 outline-none focus:ring-2 focus:ring-blue-500/50",value:oe.config.exportOptions?.headerText||"",onChange:O=>vt({...oe,config:{...oe.config,exportOptions:{...oe.config.exportOptions||{},headerText:O.target.value}}}),placeholder:e("reports.header_text","Header text (optional)")}),l.jsx("input",{className:"w-full bg-white dark:bg-slate-900 px-3 py-1.5 rounded-lg text-sm text-slate-900 dark:text-slate-100 border border-slate-100 dark:border-slate-700 placeholder:text-slate-400 dark:placeholder:text-slate-500 outline-none focus:ring-2 focus:ring-blue-500/50",value:oe.config.exportOptions?.footerText||"",onChange:O=>vt({...oe,config:{...oe.config,exportOptions:{...oe.config.exportOptions||{},footerText:O.target.value}}}),placeholder:e("reports.footer_text","Footer text (optional)")}),l.jsx("input",{className:"w-full bg-white dark:bg-slate-900 px-3 py-1.5 rounded-lg text-sm text-slate-900 dark:text-slate-100 border border-slate-100 dark:border-slate-700 placeholder:text-slate-400 dark:placeholder:text-slate-500 outline-none focus:ring-2 focus:ring-blue-500/50",value:oe.config.exportOptions?.dataAsOf||"",onChange:O=>vt({...oe,config:{...oe.config,exportOptions:{...oe.config.exportOptions||{},dataAsOf:O.target.value}}}),placeholder:e("reports.data_as_of","Data as of")}),l.jsxs("label",{className:"flex items-center gap-2 text-xs font-semibold text-slate-600 dark:text-slate-300",children:[l.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-900 text-blue-600 dark:text-blue-400 accent-blue-600 dark:accent-blue-500 focus:ring-blue-500/50",checked:oe.config.exportOptions?.includeAuditAppendix??!1,onChange:O=>vt({...oe,config:{...oe.config,exportOptions:{...oe.config.exportOptions||{},includeAuditAppendix:O.target.checked}}})}),e("reports.include_audit_appendix","Include audit appendix (SQL sources)")]})]})]}),l.jsxs("section",{className:"space-y-3 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50/50 dark:bg-slate-900/40 p-3",children:[l.jsxs("button",{type:"button",onClick:()=>Dt("pageOptions"),className:"w-full flex items-center justify-between text-left rounded-lg px-1 py-1 hover:bg-slate-100/70 dark:hover:bg-slate-800/70",children:[l.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 tracking-wider cursor-pointer",children:e("reports.page_options","Per-Page Options")}),l.jsx(Yl,{className:`w-4 h-4 text-slate-400 transition-transform ${pe.pageOptions?"rotate-90":""}`})]}),pe.pageOptions&&l.jsxs("div",{className:"space-y-2 p-4 bg-slate-50 dark:bg-slate-800 rounded-2xl",children:[oe.config.items.length===0&&l.jsx("p",{className:"text-xs text-slate-400",children:e("reports.no_pages","No pages in this package yet.")}),oe.config.items.map((O,ce)=>{const Fe=O.type==="dashboard"?de?.find(Ne=>Ne.id===O.id):ue?.find(Ne=>Ne.id===O.id);return Fe?l.jsxs("div",{className:"p-3 bg-white dark:bg-slate-900 border border-slate-100 dark:border-slate-700 rounded-xl space-y-2",children:[l.jsxs("div",{className:"text-xs font-bold text-slate-700 dark:text-slate-200",children:[ce+1,". ",Fe.name]}),l.jsxs("div",{className:"grid grid-cols-[minmax(0,1fr)_auto] gap-2",children:[l.jsxs("select",{className:"w-full bg-slate-50 dark:bg-slate-800 px-2 py-1.5 rounded text-xs text-slate-900 dark:text-slate-100 border border-slate-200 dark:border-slate-700 outline-none focus:ring-2 focus:ring-blue-500/50",value:O.pageTemplate||"",onChange:Ne=>{const Te=[...oe.config.items];Te[ce]={...O,pageTemplate:Ne.target.value||void 0},vt({...oe,config:{...oe.config,items:Te}})},children:[l.jsx("option",{value:"",children:e("reports.template_none","No template")}),l.jsx("option",{value:"summary",children:e("reports.template_summary","Management Summary")}),l.jsx("option",{value:"kpi",children:e("reports.template_kpi","KPI Page")}),l.jsx("option",{value:"detail",children:e("reports.template_detail","Detail Page")})]}),l.jsx("button",{type:"button",disabled:!O.pageTemplate,onClick:()=>{O.pageTemplate&&Ot(ce,O.pageTemplate,Fe.name)},className:"px-2 py-1.5 rounded text-xs font-semibold border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-700 disabled:opacity-40",children:e("common.apply","Apply")})]}),l.jsx("input",{className:"w-full bg-slate-50 dark:bg-slate-800 px-2 py-1.5 rounded text-xs text-slate-900 dark:text-slate-100 border border-slate-200 dark:border-slate-700 placeholder:text-slate-400 dark:placeholder:text-slate-500 outline-none focus:ring-2 focus:ring-blue-500/50",value:O.titleOverride||"",onChange:Ne=>{const Te=[...oe.config.items];Te[ce]={...O,titleOverride:Ne.target.value},vt({...oe,config:{...oe.config,items:Te}})},placeholder:e("reports.page_title_override","Page title override (optional)")}),l.jsxs("select",{className:"w-full bg-slate-50 dark:bg-slate-800 px-2 py-1.5 rounded text-xs text-slate-900 dark:text-slate-100 border border-slate-200 dark:border-slate-700 outline-none focus:ring-2 focus:ring-blue-500/50",value:O.orientation||"landscape",onChange:Ne=>{const Te=[...oe.config.items];Te[ce]={...O,orientation:Ne.target.value},vt({...oe,config:{...oe.config,items:Te}})},children:[l.jsx("option",{value:"landscape",children:e("reports.landscape","Landscape")}),l.jsx("option",{value:"portrait",children:e("reports.portrait","Portrait")})]}),l.jsxs("select",{className:"w-full bg-slate-50 dark:bg-slate-800 px-2 py-1.5 rounded text-xs text-slate-900 dark:text-slate-100 border border-slate-200 dark:border-slate-700 outline-none focus:ring-2 focus:ring-blue-500/50",value:O.pageStatus||"info",onChange:Ne=>{const Te=[...oe.config.items];Te[ce]={...O,pageStatus:Ne.target.value},vt({...oe,config:{...oe.config,items:Te}})},children:[l.jsx("option",{value:"info",children:e("reports.status_info","Info")}),l.jsx("option",{value:"ok",children:e("reports.status_ok","OK")}),l.jsx("option",{value:"warning",children:e("reports.status_warning","Warning")}),l.jsx("option",{value:"critical",children:e("reports.status_critical","Critical")})]}),l.jsx("input",{className:"w-full bg-slate-50 dark:bg-slate-800 px-2 py-1.5 rounded text-xs text-slate-900 dark:text-slate-100 border border-slate-200 dark:border-slate-700 placeholder:text-slate-400 dark:placeholder:text-slate-500 outline-none focus:ring-2 focus:ring-blue-500/50",value:O.statusThreshold||"",onChange:Ne=>{const Te=[...oe.config.items];Te[ce]={...O,statusThreshold:Ne.target.value},vt({...oe,config:{...oe.config,items:Te}})},placeholder:e("reports.status_threshold","Threshold / target note")}),l.jsx("textarea",{className:"w-full min-h-[58px] bg-slate-50 dark:bg-slate-800 px-2 py-1.5 rounded text-xs text-slate-900 dark:text-slate-100 border border-slate-200 dark:border-slate-700 placeholder:text-slate-400 dark:placeholder:text-slate-500 outline-none focus:ring-2 focus:ring-blue-500/50",value:O.pageComment||"",onChange:Ne=>{const Te=[...oe.config.items];Te[ce]={...O,pageComment:Ne.target.value},vt({...oe,config:{...oe.config,items:Te}})},placeholder:e("reports.page_comment","Page comment (analysis note)")})]},`${O.id}-${ce}`):null})]})]}),l.jsxs("section",{className:"space-y-3 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50/50 dark:bg-slate-900/40 p-3",children:[l.jsxs("button",{type:"button",onClick:()=>Dt("preview"),className:"w-full flex items-center justify-between text-left rounded-lg px-1 py-1 hover:bg-slate-100/70 dark:hover:bg-slate-800/70",children:[l.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 tracking-wider cursor-pointer",children:e("reports.preview","Live Preview")}),l.jsx(Yl,{className:`w-4 h-4 text-slate-400 transition-transform ${pe.preview?"rotate-90":""}`})]}),pe.preview&&l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"rounded-2xl border border-slate-200 dark:border-slate-700 overflow-hidden shadow-sm",children:[l.jsxs("div",{className:"h-36 px-4 py-3 flex flex-col justify-between",style:{backgroundColor:oe.config.themeColor||"#1e293b"},children:[l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsx("div",{className:"text-white text-sm font-black truncate",children:oe.config.coverTitle||e("reports.title_label")}),He&&U!==He?l.jsx("img",{src:He,alt:"Logo preview",className:"w-10 h-10 object-contain rounded bg-white/80 p-1",referrerPolicy:"no-referrer",onError:()=>M(He)}):l.jsx("div",{className:"w-10 h-10 rounded bg-white/20 border border-white/30"})]}),l.jsx("div",{className:"text-xs text-slate-200",children:oe.config.coverSubtitle||e("reports.subtitle_label")})]}),l.jsx("div",{className:"px-4 py-2 bg-white dark:bg-slate-900 border-t border-slate-100 dark:border-slate-800 text-[11px] text-slate-500",children:oe.config.author||e("reports.author")})]}),l.jsxs("div",{className:"rounded-2xl border border-slate-200 dark:border-slate-700 overflow-hidden shadow-sm bg-white dark:bg-slate-900",children:[l.jsx("div",{className:"px-4 py-2 text-[10px] font-black uppercase tracking-wider text-slate-400 border-b border-slate-100 dark:border-slate-800",children:e("reports.content_page_preview","Content Page Preview")}),l.jsxs("div",{className:"p-4 space-y-3",children:[l.jsx("div",{className:`text-[11px] text-slate-500 ${oe.config.exportOptions?.showHeader===!1?"opacity-30":""}`,children:oe.config.exportOptions?.headerText||oe.name||e("reports.header_text","Header text")}),!!oe.config.items[0]&&l.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-slate-600 dark:text-slate-300",children:[l.jsx("span",{className:"px-2 py-0.5 rounded-full border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800",children:(oe.config.items[0].pageStatus||"info").toUpperCase()}),oe.config.items[0].statusThreshold&&l.jsx("span",{children:oe.config.items[0].statusThreshold})]}),!!oe.config.items[0]?.pageComment&&l.jsx("div",{className:"text-[11px] text-slate-500 dark:text-slate-400",children:oe.config.items[0].pageComment}),l.jsx("div",{className:"h-16 rounded border border-dashed border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800/50 flex items-center justify-center text-xs text-slate-400",children:e("reports.page_content","Page content")}),l.jsxs("div",{className:`flex items-center justify-between text-[11px] text-slate-500 ${oe.config.exportOptions?.showFooter===!1?"opacity-30":""}`,children:[l.jsx("span",{children:oe.config.exportOptions?.footerText||e("reports.footer_text","Footer text")}),l.jsxs("span",{children:["1 / ",Math.max(1,oe.config.items.length)]})]})]})]})]})]})]}),l.jsx("div",{className:"mt-4 -mx-5 -mb-5 px-5 py-3 border-t border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-950/90",children:l.jsx("div",{className:"flex justify-end",children:l.jsx("button",{onClick:()=>R(!1),className:"px-6 py-2 rounded-xl font-bold text-sm bg-blue-600 hover:bg-blue-700 text-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500/60",children:e("common.done","Done")})})})]})}),l.jsx(Bo,{isOpen:Q,onClose:()=>V(!1),title:e("reports.pick_content","Add Page"),children:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"text-[10px] font-black uppercase text-slate-400 mb-2",children:e("dashboard.dashboards")}),l.jsx("div",{className:"grid grid-cols-1 gap-1.5",children:de?.map(O=>l.jsxs("button",{onClick:()=>Mr({type:"dashboard",id:O.id}),className:"flex items-center gap-3 p-3 text-left bg-slate-50 dark:bg-slate-800 hover:bg-blue-50 dark:hover:bg-blue-900/40 rounded-xl transition-all border border-transparent hover:border-blue-200 group",children:[l.jsx(wn,{className:"w-4 h-4 text-slate-400 group-hover:text-blue-500"}),l.jsx("span",{className:"text-sm font-bold text-slate-700 dark:text-slate-200",children:O.name})]},O.id))})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-[10px] font-black uppercase text-slate-400 mb-2",children:e("dashboard.reports")}),l.jsx("div",{className:"grid grid-cols-1 gap-1.5 max-h-[300px] overflow-y-auto custom-scrollbar",children:ue?.map(O=>l.jsxs("button",{onClick:()=>Mr({type:"widget",id:O.id}),className:"flex items-center gap-3 p-3 text-left bg-slate-50 dark:bg-slate-800 hover:bg-blue-50 dark:hover:bg-blue-900/40 rounded-xl transition-all border border-transparent hover:border-blue-200 group",children:[l.jsx(wl,{className:"w-4 h-4 text-slate-400 group-hover:text-blue-500"}),l.jsx("span",{className:"text-sm font-bold text-slate-700 dark:text-slate-200",children:O.name})]},O.id))})]})]})}),l.jsx(Bo,{isOpen:v,onClose:()=>B(!1),title:e("reports.manage_categories","Manage categories"),children:l.jsxs("div",{className:"space-y-3",children:[se.length===0&&l.jsx("div",{className:"text-center py-8 border border-dashed border-slate-200 dark:border-slate-700 rounded-xl text-slate-400 text-sm",children:e("reports.no_categories","No categories yet.")}),se.map(O=>{const ce=O===a,Fe=n.filter(Ne=>(Ne.category||a)===O).length;return l.jsxs("div",{className:"flex items-center justify-between p-3 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg group",children:[l.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[l.jsx(wn,{className:"w-4 h-4 text-slate-400 dark:text-slate-500 shrink-0"}),l.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-200 truncate",children:O}),ce&&l.jsx("span",{className:"text-[10px] bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-200 px-1.5 py-0.5 rounded font-black uppercase tracking-wider",children:e("common.default","Default")}),l.jsxs("span",{className:"text-[10px] bg-slate-100 dark:bg-slate-800 text-slate-500 dark:text-slate-300 px-1.5 py-0.5 rounded font-black uppercase tracking-wider",children:[Fe," ",e("reports.packages","packages")]})]}),!F&&l.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[l.jsx("button",{onClick:()=>{Kt(O)},disabled:ce,className:"p-1.5 text-slate-400 dark:text-slate-500 hover:text-blue-600 dark:hover:text-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded disabled:opacity-30 disabled:hover:text-slate-400 dark:disabled:hover:text-slate-500 disabled:hover:bg-transparent",title:e("common.rename","Rename"),children:l.jsx($S,{className:"w-3.5 h-3.5"})}),l.jsx("button",{onClick:()=>{Ft(O)},disabled:ce,className:"p-1.5 text-slate-400 dark:text-slate-500 hover:text-red-600 dark:hover:text-red-300 hover:bg-red-50 dark:hover:bg-red-900/20 rounded disabled:opacity-30 disabled:hover:text-slate-400 dark:disabled:hover:text-slate-500 disabled:hover:bg-transparent",title:ce?e("reports.default_category_protected","Default category cannot be deleted"):Fe>0?e("reports.delete_with_content","Delete category and its report packages"):e("reports.delete_empty_category","Delete empty category"),children:l.jsx(ii,{className:"w-3.5 h-3.5"})})]})]},O)})]})})]})},vae=()=>{const e=jA();return l.jsx(L8,{children:l.jsxs(lc,{element:l.jsx(UK,{}),children:[l.jsx(lc,{index:!0,element:l.jsx(hae,{})}),l.jsx(lc,{path:"datasource",element:l.jsx(iG,{onImportComplete:()=>{e("/")}})}),l.jsx(lc,{path:"settings",element:l.jsx($K,{})}),l.jsx(lc,{path:"inspector",element:l.jsx(cB,{onBack:()=>e(-1),fixedMode:"table",titleKey:"sidebar.data_inspector",breadcrumbKey:"sidebar.data_inspector"})}),l.jsx(lc,{path:"sql-workspace",element:l.jsx(cB,{onBack:()=>e(-1),fixedMode:"sql",titleKey:"sidebar.sql_workspace",breadcrumbKey:"sidebar.sql_workspace"})}),l.jsx(lc,{path:"query",element:l.jsx(Ete,{})}),l.jsx(lc,{path:"worklist",element:l.jsx(mae,{})}),l.jsx(lc,{path:"about",element:l.jsx(xae,{})}),l.jsx(lc,{path:"reports",element:l.jsx(bae,{})})]})})},wae=()=>l.jsx(T8,{children:l.jsx(vae,{})}),_ae=()=>{const{t:e}=ds(),[t,r]=Wt.useState(null),[a,s]=Wt.useState("");if(Wt.useEffect(()=>BK(h=>new Promise(g=>{s(h.defaultValue||""),r({...h,resolve:g})})),[]),!t)return null;const n=()=>{t.kind==="prompt"?t.resolve({confirmed:!1,value:void 0}):t.kind==="confirm"?t.resolve({confirmed:!1}):t.resolve({confirmed:!0}),r(null)},o=()=>{t.kind==="prompt"?t.resolve({confirmed:!0,value:a}):t.resolve({confirmed:!0}),r(null)},c=t.title||(t.kind==="error"?e("common.error"):t.kind==="warning"?e("common.warning","Warning"):t.kind==="confirm"?e("common.confirm_title"):t.kind==="prompt"?e("common.input","Input"):e("common.info","Information")),u=t.kind==="error"?Cn:t.kind==="warning"?t0:t.kind==="info"?wl:iu,f=t.kind==="error"?"text-rose-700 bg-rose-50 ring-rose-200 dark:text-rose-300 dark:bg-rose-500/15 dark:ring-rose-400/30":t.kind==="warning"?"text-amber-700 bg-amber-50 ring-amber-200 dark:text-amber-300 dark:bg-amber-500/15 dark:ring-amber-400/30":"text-blue-700 bg-blue-50 ring-blue-200 dark:text-blue-300 dark:bg-blue-500/15 dark:ring-blue-400/30";return l.jsx(Bo,{isOpen:!0,onClose:n,title:c,variant:"dialog",noScroll:!0,children:l.jsxs("div",{className:"flex h-full min-h-[170px] flex-col",children:[l.jsx("div",{className:"flex-1 p-5",children:l.jsxs("div",{className:"grid grid-cols-[64px_minmax(0,1fr)] items-start gap-y-4",children:[l.jsx("div",{className:"flex justify-center pt-0.5",children:l.jsx("span",{className:`inline-flex h-12 w-12 items-center justify-center rounded-full ring-1 ${f}`,children:l.jsx(u,{className:"w-6 h-6"})})}),l.jsxs("div",{className:"pt-0.5 pl-[5px]",children:[l.jsx("div",{className:"text-sm font-semibold text-slate-800 dark:text-slate-100",children:c}),l.jsx("p",{className:"mt-1 text-sm text-slate-600 dark:text-slate-300 whitespace-pre-wrap",children:t.message})]}),t.kind==="prompt"&&l.jsxs(l.Fragment,{children:[l.jsx("div",{}),l.jsx("div",{className:"pl-[5px]",children:l.jsx("input",{autoFocus:!0,value:a,onChange:h=>s(h.target.value),placeholder:t.placeholder,className:"w-full p-2.5 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-slate-900 dark:text-slate-100 placeholder:text-slate-400 dark:placeholder:text-slate-500 text-sm shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500/50 focus-visible:border-blue-300",onKeyDown:h=>{h.key==="Enter"&&o(),h.key==="Escape"&&n()}})})]})]})}),l.jsx("div",{className:"mt-auto border-t border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900/60 px-4 py-3",children:l.jsxs("div",{className:"flex justify-end gap-2",children:[(t.kind==="confirm"||t.kind==="prompt")&&l.jsx("button",{type:"button",onClick:n,className:"w-32 px-3 py-1.5 text-sm font-semibold rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400/60",children:e("common.cancel")}),l.jsx("button",{type:"button",onClick:o,className:"w-32 px-3 py-1.5 text-sm font-semibold rounded-lg bg-blue-600 text-white hover:bg-blue-700 shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500/70",children:e("common.ok","OK")})]})})]})})},RS="litebi:app-ready",yae=3e3,kae=()=>{const[e,t]=Wt.useState(!0),[r,a]=Wt.useState(!1),[s,n]=Wt.useState(()=>!!window.__LITEBI_READY__),[o,c]=Wt.useState(8);return Wt.useEffect(()=>{const u=()=>n(!0);window.addEventListener(RS,u);const f=window.setTimeout(()=>a(!0),yae);return(async()=>{try{await jt.getStorageStatus()}catch{}finally{n(!0)}})(),()=>{window.removeEventListener(RS,u),window.clearTimeout(f)}},[]),Wt.useEffect(()=>{if(!e)return;const u=window.setInterval(()=>{c(f=>Math.min(s?100:92,f+(s?6:2)))},120);return()=>window.clearInterval(u)},[e,s]),Wt.useEffect(()=>{if(!(r&&s))return;c(100);const u=window.setTimeout(()=>t(!1),180);return()=>window.clearTimeout(u)},[r,s]),e?l.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-slate-100/96 dark:bg-slate-950/96 backdrop-blur-sm",children:l.jsxs("div",{className:"w-[min(92vw,520px)] rounded-2xl border border-slate-200 dark:border-slate-800 bg-white/95 dark:bg-slate-900/95 shadow-2xl p-7",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(Ab,{size:40}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-base font-black tracking-tight text-slate-800 dark:text-slate-100",children:"LiteBI Studio"}),l.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Preparing your workspace..."})]})]}),l.jsxs("div",{className:"mt-6",children:[l.jsx("div",{className:"h-2 w-full rounded-full bg-slate-200 dark:bg-slate-800 overflow-hidden",children:l.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 via-cyan-400 to-emerald-400 transition-[width] duration-150 ease-linear",style:{width:`${o}%`}})}),l.jsxs("div",{className:"mt-2 flex items-center justify-between text-[11px] text-slate-500 dark:text-slate-400",children:[l.jsx("span",{children:s?"Finalizing...":"Loading modules..."}),l.jsxs("span",{children:[Math.round(o),"%"]})]})]})]})}):null};function Bae(){return l.jsxs(l.Fragment,{children:[l.jsx(wae,{}),l.jsx(_ae,{}),l.jsx(kae,{})]})}xL.createRoot(document.getElementById("root")).render(l.jsx(Z.StrictMode,{children:l.jsx(DK,{children:l.jsx(Gj,{children:l.jsx(Bae,{})})})}));export{Ya as _};
