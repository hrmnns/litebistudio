(function(){"use strict";async function Pt(we={}){var ne,c=we,oe=!!globalThis.window,Ae=!!globalThis.WorkerGlobalScope;globalThis.process?.versions?.node&&globalThis.process?.type;var Ce="./this.program",We=self.location.href,mt="";function St(e){return c.locateFile?c.locateFile(e,mt):mt+e}var Xe,it;if(oe||Ae){try{mt=new URL(".",We).href}catch{}Ae&&(it=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),Xe=async e=>{var t=await fetch(e,{credentials:"same-origin"});if(t.ok)return t.arrayBuffer();throw new Error(t.status+" : "+t.url)}}var be=console.log.bind(console),Ne=console.error.bind(console),Qe,ut=!1,wt,It,He,st,gt,Pe,Le,ze,jt=!1;function Mt(){var e=et.buffer;He=new Int8Array(e),gt=new Int16Array(e),st=new Uint8Array(e),Pe=new Int32Array(e),Le=new Uint32Array(e),ze=new BigInt64Array(e),new BigUint64Array(e)}function mn(){if(c.wasmMemory)et=c.wasmMemory;else{var e=c.INITIAL_MEMORY||8388608;et=new WebAssembly.Memory({initial:e/65536,maximum:32768})}Mt()}function gn(){if(c.preRun)for(typeof c.preRun=="function"&&(c.preRun=[c.preRun]);c.preRun.length;)kn(c.preRun.shift());zt(Ut)}function bn(){jt=!0,!c.noFSInit&&!l.initialized&&l.init(),dt.__wasm_call_ctors(),l.ignorePermissions=!1}function yn(){if(c.postRun)for(typeof c.postRun=="function"&&(c.postRun=[c.postRun]);c.postRun.length;)Tn(c.postRun.shift());zt(Bt)}function Ye(e){c.onAbort?.(e),e="Aborted("+e+")",Ne(e),ut=!0,e+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(e);throw It?.(t),t}var xt;function qn(){return c.locateFile?St("sqlite3.wasm"):new URL("/itdashboard/assets/sqlite3-DGXXSD5r.wasm",self.location.href).href}function vn(e){if(e==xt&&Qe)return new Uint8Array(Qe);if(it)return it(e);throw"both async and sync fetching of the wasm failed"}async function En(e){if(!Qe)try{var t=await Xe(e);return new Uint8Array(t)}catch{}return vn(e)}async function Sn(e,t){try{var o=await En(e);return await WebAssembly.instantiate(o,t)}catch(s){Ne(`failed to asynchronously prepare wasm: ${s}`),Ye(s)}}async function wn(e,t,o){if(!e)try{var s=fetch(t,{credentials:"same-origin"});return await WebAssembly.instantiateStreaming(s,o)}catch(n){Ne(`wasm streaming compile failed: ${n}`),Ne("falling back to ArrayBuffer instantiation")}return Sn(t,o)}function In(){return{env:nn,wasi_snapshot_preview1:nn}}async function An(){function e(s,n){return dt=s.exports,Pr(dt),dt}function t(s){return e(s.instance)}var o=In();return c.instantiateWasm?new Promise((s,n)=>{c.instantiateWasm(o,(i,r)=>{s(e(i))})}):(xt??=qn(),t(await wn(Qe,xt,o)))}var zt=e=>{for(;e.length>0;)e.shift()(c)},Bt=[],Tn=e=>Bt.push(e),Ut=[],kn=e=>Ut.push(e),et,xe={isAbs:e=>e.charAt(0)==="/",splitPath:e=>/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1),normalizeArray:(e,t)=>{for(var o=0,s=e.length-1;s>=0;s--){var n=e[s];n==="."?e.splice(s,1):n===".."?(e.splice(s,1),o++):o&&(e.splice(s,1),o--)}if(t)for(;o;o--)e.unshift("..");return e},normalize:e=>{var t=xe.isAbs(e),o=e.slice(-1)==="/";return e=xe.normalizeArray(e.split("/").filter(s=>!!s),!t).join("/"),!e&&!t&&(e="."),e&&o&&(e+="/"),(t?"/":"")+e},dirname:e=>{var t=xe.splitPath(e),o=t[0],s=t[1];return!o&&!s?".":(s&&(s=s.slice(0,-1)),o+s)},basename:e=>e&&e.match(/([^\/]+|\/)\/*$/)[1],join:(...e)=>xe.normalize(e.join("/")),join2:(e,t)=>xe.normalize(e+"/"+t)},On=()=>e=>crypto.getRandomValues(e),Wt=e=>{(Wt=On())(e)},_t={resolve:(...e)=>{for(var t="",o=!1,s=e.length-1;s>=-1&&!o;s--){var n=s>=0?e[s]:l.cwd();if(typeof n!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!n)return"";t=n+"/"+t,o=xe.isAbs(n)}return t=xe.normalizeArray(t.split("/").filter(i=>!!i),!o).join("/"),(o?"/":"")+t||"."},relative:(e,t)=>{e=_t.resolve(e).slice(1),t=_t.resolve(t).slice(1);function o(T){for(var J=0;J<T.length&&T[J]==="";J++);for(var N=T.length-1;N>=0&&T[N]==="";N--);return J>N?[]:T.slice(J,N-J+1)}for(var s=o(e.split("/")),n=o(t.split("/")),i=Math.min(s.length,n.length),r=i,u=0;u<i;u++)if(s[u]!==n[u]){r=u;break}for(var F=[],u=r;u<s.length;u++)F.push("..");return F=F.concat(n.slice(r)),F.join("/")}},Qt=new TextDecoder,Vt=(e,t,o,s)=>{for(var n=t+o;e[t]&&!(t>=n);)++t;return t},bt=(e,t=0,o,s)=>{var n=Vt(e,t,o);return Qt.decode(e.buffer?e.subarray(t,n):new Uint8Array(e.slice(t,n)))},Ft=[],At=e=>{for(var t=0,o=0;o<e.length;++o){var s=e.charCodeAt(o);s<=127?t++:s<=2047?t+=2:s>=55296&&s<=57343?(t+=4,++o):t+=3}return t},Ht=(e,t,o,s)=>{if(!(s>0))return 0;for(var n=o,i=o+s-1,r=0;r<e.length;++r){var u=e.codePointAt(r);if(u<=127){if(o>=i)break;t[o++]=u}else if(u<=2047){if(o+1>=i)break;t[o++]=192|u>>6,t[o++]=128|u&63}else if(u<=65535){if(o+2>=i)break;t[o++]=224|u>>12,t[o++]=128|u>>6&63,t[o++]=128|u&63}else{if(o+3>=i)break;t[o++]=240|u>>18,t[o++]=128|u>>12&63,t[o++]=128|u>>6&63,t[o++]=128|u&63,r++}}return t[o]=0,o-n},Lt=(e,t,o)=>{var s=At(e)+1,n=new Array(s),i=Ht(e,n,0,n.length);return n.length=i,n},Pn=()=>{if(!Ft.length){var e=null;if(globalThis.window?.prompt&&(e=window.prompt("Input: "),e!==null&&(e+=`
`)),!e)return null;Ft=Lt(e)}return Ft.shift()},ot={ttys:[],init(){},shutdown(){},register(e,t){ot.ttys[e]={input:[],output:[],ops:t},l.registerDevice(e,ot.stream_ops)},stream_ops:{open(e){var t=ot.ttys[e.node.rdev];if(!t)throw new l.ErrnoError(43);e.tty=t,e.seekable=!1},close(e){e.tty.ops.fsync(e.tty)},fsync(e){e.tty.ops.fsync(e.tty)},read(e,t,o,s,n){if(!e.tty||!e.tty.ops.get_char)throw new l.ErrnoError(60);for(var i=0,r=0;r<s;r++){var u;try{u=e.tty.ops.get_char(e.tty)}catch{throw new l.ErrnoError(29)}if(u===void 0&&i===0)throw new l.ErrnoError(6);if(u==null)break;i++,t[o+r]=u}return i&&(e.node.atime=Date.now()),i},write(e,t,o,s,n){if(!e.tty||!e.tty.ops.put_char)throw new l.ErrnoError(60);try{for(var i=0;i<s;i++)e.tty.ops.put_char(e.tty,t[o+i])}catch{throw new l.ErrnoError(29)}return s&&(e.node.mtime=e.node.ctime=Date.now()),i}},default_tty_ops:{get_char(e){return Pn()},put_char(e,t){t===null||t===10?(be(bt(e.output)),e.output=[]):t!=0&&e.output.push(t)},fsync(e){e.output?.length>0&&(be(bt(e.output)),e.output=[])},ioctl_tcgets(e){return{c_iflag:25856,c_oflag:5,c_cflag:191,c_lflag:35387,c_cc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},ioctl_tcsets(e,t,o){return 0},ioctl_tiocgwinsz(e){return[24,80]}},default_tty1_ops:{put_char(e,t){t===null||t===10?(Ne(bt(e.output)),e.output=[]):t!=0&&e.output.push(t)},fsync(e){e.output?.length>0&&(Ne(bt(e.output)),e.output=[])}}},xn=(e,t)=>st.fill(0,e,e+t),Gt=(e,t)=>Math.ceil(e/t)*t,$t=e=>{e=Gt(e,65536);var t=tn(65536,e);return t&&xn(t,e),t},qe={ops_table:null,mount(e){return qe.createNode(null,"/",16895,0)},createNode(e,t,o,s){if(l.isBlkdev(o)||l.isFIFO(o))throw new l.ErrnoError(63);qe.ops_table||={dir:{node:{getattr:qe.node_ops.getattr,setattr:qe.node_ops.setattr,lookup:qe.node_ops.lookup,mknod:qe.node_ops.mknod,rename:qe.node_ops.rename,unlink:qe.node_ops.unlink,rmdir:qe.node_ops.rmdir,readdir:qe.node_ops.readdir,symlink:qe.node_ops.symlink},stream:{llseek:qe.stream_ops.llseek}},file:{node:{getattr:qe.node_ops.getattr,setattr:qe.node_ops.setattr},stream:{llseek:qe.stream_ops.llseek,read:qe.stream_ops.read,write:qe.stream_ops.write,mmap:qe.stream_ops.mmap,msync:qe.stream_ops.msync}},link:{node:{getattr:qe.node_ops.getattr,setattr:qe.node_ops.setattr,readlink:qe.node_ops.readlink},stream:{}},chrdev:{node:{getattr:qe.node_ops.getattr,setattr:qe.node_ops.setattr},stream:l.chrdev_stream_ops}};var n=l.createNode(e,t,o,s);return l.isDir(n.mode)?(n.node_ops=qe.ops_table.dir.node,n.stream_ops=qe.ops_table.dir.stream,n.contents={}):l.isFile(n.mode)?(n.node_ops=qe.ops_table.file.node,n.stream_ops=qe.ops_table.file.stream,n.usedBytes=0,n.contents=null):l.isLink(n.mode)?(n.node_ops=qe.ops_table.link.node,n.stream_ops=qe.ops_table.link.stream):l.isChrdev(n.mode)&&(n.node_ops=qe.ops_table.chrdev.node,n.stream_ops=qe.ops_table.chrdev.stream),n.atime=n.mtime=n.ctime=Date.now(),e&&(e.contents[t]=n,e.atime=e.mtime=e.ctime=n.atime),n},getFileDataAsTypedArray(e){return e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array(0)},expandFileStorage(e,t){var o=e.contents?e.contents.length:0;if(!(o>=t)){t=Math.max(t,o*(o<1024*1024?2:1.125)>>>0),o!=0&&(t=Math.max(t,256));var s=e.contents;e.contents=new Uint8Array(t),e.usedBytes>0&&e.contents.set(s.subarray(0,e.usedBytes),0)}},resizeFileStorage(e,t){if(e.usedBytes!=t)if(t==0)e.contents=null,e.usedBytes=0;else{var o=e.contents;e.contents=new Uint8Array(t),o&&e.contents.set(o.subarray(0,Math.min(t,e.usedBytes))),e.usedBytes=t}},node_ops:{getattr(e){var t={};return t.dev=l.isChrdev(e.mode)?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,l.isDir(e.mode)?t.size=4096:l.isFile(e.mode)?t.size=e.usedBytes:l.isLink(e.mode)?t.size=e.link.length:t.size=0,t.atime=new Date(e.atime),t.mtime=new Date(e.mtime),t.ctime=new Date(e.ctime),t.blksize=4096,t.blocks=Math.ceil(t.size/t.blksize),t},setattr(e,t){for(const o of["mode","atime","mtime","ctime"])t[o]!=null&&(e[o]=t[o]);t.size!==void 0&&qe.resizeFileStorage(e,t.size)},lookup(e,t){throw qe.doesNotExistError||(qe.doesNotExistError=new l.ErrnoError(44),qe.doesNotExistError.stack="<generic error, no stack>"),qe.doesNotExistError},mknod(e,t,o,s){return qe.createNode(e,t,o,s)},rename(e,t,o){var s;try{s=l.lookupNode(t,o)}catch{}if(s){if(l.isDir(e.mode))for(var n in s.contents)throw new l.ErrnoError(55);l.hashRemoveNode(s)}delete e.parent.contents[e.name],t.contents[o]=e,e.name=o,t.ctime=t.mtime=e.parent.ctime=e.parent.mtime=Date.now()},unlink(e,t){delete e.contents[t],e.ctime=e.mtime=Date.now()},rmdir(e,t){for(var o in l.lookupNode(e,t).contents)throw new l.ErrnoError(55);delete e.contents[t],e.ctime=e.mtime=Date.now()},readdir(e){return[".","..",...Object.keys(e.contents)]},symlink(e,t,o){var s=qe.createNode(e,t,41471,0);return s.link=o,s},readlink(e){if(!l.isLink(e.mode))throw new l.ErrnoError(28);return e.link}},stream_ops:{read(e,t,o,s,n){var i=e.node.contents;if(n>=e.node.usedBytes)return 0;var r=Math.min(e.node.usedBytes-n,s);if(r>8&&i.subarray)t.set(i.subarray(n,n+r),o);else for(var u=0;u<r;u++)t[o+u]=i[n+u];return r},write(e,t,o,s,n,i){if(t.buffer===He.buffer&&(i=!1),!s)return 0;var r=e.node;if(r.mtime=r.ctime=Date.now(),t.subarray&&(!r.contents||r.contents.subarray)){if(i)return r.contents=t.subarray(o,o+s),r.usedBytes=s,s;if(r.usedBytes===0&&n===0)return r.contents=t.slice(o,o+s),r.usedBytes=s,s;if(n+s<=r.usedBytes)return r.contents.set(t.subarray(o,o+s),n),s}if(qe.expandFileStorage(r,n+s),r.contents.subarray&&t.subarray)r.contents.set(t.subarray(o,o+s),n);else for(var u=0;u<s;u++)r.contents[n+u]=t[o+u];return r.usedBytes=Math.max(r.usedBytes,n+s),s},llseek(e,t,o){var s=t;if(o===1?s+=e.position:o===2&&l.isFile(e.node.mode)&&(s+=e.node.usedBytes),s<0)throw new l.ErrnoError(28);return s},mmap(e,t,o,s,n){if(!l.isFile(e.node.mode))throw new l.ErrnoError(43);var i,r,u=e.node.contents;if(!(n&2)&&u&&u.buffer===He.buffer)r=!1,i=u.byteOffset;else{if(r=!0,i=$t(t),!i)throw new l.ErrnoError(48);u&&((o>0||o+t<u.length)&&(u.subarray?u=u.subarray(o,o+t):u=Array.prototype.slice.call(u,o,o+t)),He.set(u,i))}return{ptr:i,allocated:r}},msync(e,t,o,s,n){return qe.stream_ops.write(e,t,0,s,o,!1),0}}},Fn=e=>{var t={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[e];if(typeof t>"u")throw new Error(`Unknown file open mode: ${e}`);return t},Nt=(e,t)=>{var o=0;return e&&(o|=365),t&&(o|=146),o},Ln=async e=>{var t=await Xe(e);return new Uint8Array(t)},Nn=(...e)=>l.createDataFile(...e),at=0,yt=null,Cn=e=>{if(at--,c.monitorRunDependencies?.(at),at==0&&yt){var t=yt;yt=null,t()}},Rn=e=>{at++,c.monitorRunDependencies?.(at)},Kt=[],Dn=async(e,t)=>{typeof Browser<"u"&&Browser.init();for(var o of Kt)if(o.canHandle(t))return o.handle(e,t);return e},Jt=async(e,t,o,s,n,i,r,u)=>{var F=t?_t.resolve(xe.join2(e,t)):e;Rn();try{var T=o;typeof o=="string"&&(T=await Ln(o)),T=await Dn(T,F),u?.(),i||Nn(e,t,T,s,n,r)}finally{Cn()}},jn=(e,t,o,s,n,i,r,u,F,T)=>{Jt(e,t,o,s,n,u,F,T).then(i).catch(r)},l={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,filesystems:null,syncFSRequests:0,readFiles:{},ErrnoError:class{name="ErrnoError";constructor(e){this.errno=e}},FSStream:class{shared={};get object(){return this.node}set object(e){this.node=e}get isRead(){return(this.flags&2097155)!==1}get isWrite(){return(this.flags&2097155)!==0}get isAppend(){return this.flags&1024}get flags(){return this.shared.flags}set flags(e){this.shared.flags=e}get position(){return this.shared.position}set position(e){this.shared.position=e}},FSNode:class{node_ops={};stream_ops={};readMode=365;writeMode=146;mounted=null;constructor(e,t,o,s){e||(e=this),this.parent=e,this.mount=e.mount,this.id=l.nextInode++,this.name=t,this.mode=o,this.rdev=s,this.atime=this.mtime=this.ctime=Date.now()}get read(){return(this.mode&this.readMode)===this.readMode}set read(e){e?this.mode|=this.readMode:this.mode&=~this.readMode}get write(){return(this.mode&this.writeMode)===this.writeMode}set write(e){e?this.mode|=this.writeMode:this.mode&=~this.writeMode}get isFolder(){return l.isDir(this.mode)}get isDevice(){return l.isChrdev(this.mode)}},lookupPath(e,t={}){if(!e)throw new l.ErrnoError(44);t.follow_mount??=!0,xe.isAbs(e)||(e=l.cwd()+"/"+e);e:for(var o=0;o<40;o++){for(var s=e.split("/").filter(T=>!!T),n=l.root,i="/",r=0;r<s.length;r++){var u=r===s.length-1;if(u&&t.parent)break;if(s[r]!=="."){if(s[r]===".."){if(i=xe.dirname(i),l.isRoot(n)){e=i+"/"+s.slice(r+1).join("/"),o--;continue e}else n=n.parent;continue}i=xe.join2(i,s[r]);try{n=l.lookupNode(n,s[r])}catch(T){if(T?.errno===44&&u&&t.noent_okay)return{path:i};throw T}if(l.isMountpoint(n)&&(!u||t.follow_mount)&&(n=n.mounted.root),l.isLink(n.mode)&&(!u||t.follow)){if(!n.node_ops.readlink)throw new l.ErrnoError(52);var F=n.node_ops.readlink(n);xe.isAbs(F)||(F=xe.dirname(i)+"/"+F),e=F+"/"+s.slice(r+1).join("/");continue e}}}return{path:i,node:n}}throw new l.ErrnoError(32)},getPath(e){for(var t;;){if(l.isRoot(e)){var o=e.mount.mountpoint;return t?o[o.length-1]!=="/"?`${o}/${t}`:o+t:o}t=t?`${e.name}/${t}`:e.name,e=e.parent}},hashName(e,t){for(var o=0,s=0;s<t.length;s++)o=(o<<5)-o+t.charCodeAt(s)|0;return(e+o>>>0)%l.nameTable.length},hashAddNode(e){var t=l.hashName(e.parent.id,e.name);e.name_next=l.nameTable[t],l.nameTable[t]=e},hashRemoveNode(e){var t=l.hashName(e.parent.id,e.name);if(l.nameTable[t]===e)l.nameTable[t]=e.name_next;else for(var o=l.nameTable[t];o;){if(o.name_next===e){o.name_next=e.name_next;break}o=o.name_next}},lookupNode(e,t){var o=l.mayLookup(e);if(o)throw new l.ErrnoError(o);for(var s=l.hashName(e.id,t),n=l.nameTable[s];n;n=n.name_next){var i=n.name;if(n.parent.id===e.id&&i===t)return n}return l.lookup(e,t)},createNode(e,t,o,s){var n=new l.FSNode(e,t,o,s);return l.hashAddNode(n),n},destroyNode(e){l.hashRemoveNode(e)},isRoot(e){return e===e.parent},isMountpoint(e){return!!e.mounted},isFile(e){return(e&61440)===32768},isDir(e){return(e&61440)===16384},isLink(e){return(e&61440)===40960},isChrdev(e){return(e&61440)===8192},isBlkdev(e){return(e&61440)===24576},isFIFO(e){return(e&61440)===4096},isSocket(e){return(e&49152)===49152},flagsToPermissionString(e){var t=["r","w","rw"][e&3];return e&512&&(t+="w"),t},nodePermissions(e,t){return l.ignorePermissions?0:t.includes("r")&&!(e.mode&292)||t.includes("w")&&!(e.mode&146)||t.includes("x")&&!(e.mode&73)?2:0},mayLookup(e){if(!l.isDir(e.mode))return 54;var t=l.nodePermissions(e,"x");return t||(e.node_ops.lookup?0:2)},mayCreate(e,t){if(!l.isDir(e.mode))return 54;try{return l.lookupNode(e,t),20}catch{}return l.nodePermissions(e,"wx")},mayDelete(e,t,o){var s;try{s=l.lookupNode(e,t)}catch(i){return i.errno}var n=l.nodePermissions(e,"wx");if(n)return n;if(o){if(!l.isDir(s.mode))return 54;if(l.isRoot(s)||l.getPath(s)===l.cwd())return 10}else if(l.isDir(s.mode))return 31;return 0},mayOpen(e,t){return e?l.isLink(e.mode)?32:l.isDir(e.mode)&&(l.flagsToPermissionString(t)!=="r"||t&576)?31:l.nodePermissions(e,l.flagsToPermissionString(t)):44},checkOpExists(e,t){if(!e)throw new l.ErrnoError(t);return e},MAX_OPEN_FDS:4096,nextfd(){for(var e=0;e<=l.MAX_OPEN_FDS;e++)if(!l.streams[e])return e;throw new l.ErrnoError(33)},getStreamChecked(e){var t=l.getStream(e);if(!t)throw new l.ErrnoError(8);return t},getStream:e=>l.streams[e],createStream(e,t=-1){return e=Object.assign(new l.FSStream,e),t==-1&&(t=l.nextfd()),e.fd=t,l.streams[t]=e,e},closeStream(e){l.streams[e]=null},dupStream(e,t=-1){var o=l.createStream(e,t);return o.stream_ops?.dup?.(o),o},doSetAttr(e,t,o){var s=e?.stream_ops.setattr,n=s?e:t;s??=t.node_ops.setattr,l.checkOpExists(s,63),s(n,o)},chrdev_stream_ops:{open(e){e.stream_ops=l.getDevice(e.node.rdev).stream_ops,e.stream_ops.open?.(e)},llseek(){throw new l.ErrnoError(70)}},major:e=>e>>8,minor:e=>e&255,makedev:(e,t)=>e<<8|t,registerDevice(e,t){l.devices[e]={stream_ops:t}},getDevice:e=>l.devices[e],getMounts(e){for(var t=[],o=[e];o.length;){var s=o.pop();t.push(s),o.push(...s.mounts)}return t},syncfs(e,t){typeof e=="function"&&(t=e,e=!1),l.syncFSRequests++,l.syncFSRequests>1&&Ne(`warning: ${l.syncFSRequests} FS.syncfs operations in flight at once, probably just doing extra work`);var o=l.getMounts(l.root.mount),s=0;function n(u){return l.syncFSRequests--,t(u)}function i(u){if(u)return i.errored?void 0:(i.errored=!0,n(u));++s>=o.length&&n(null)}for(var r of o)r.type.syncfs?r.type.syncfs(r,e,i):i(null)},mount(e,t,o){var s=o==="/",n=!o,i;if(s&&l.root)throw new l.ErrnoError(10);if(!s&&!n){var r=l.lookupPath(o,{follow_mount:!1});if(o=r.path,i=r.node,l.isMountpoint(i))throw new l.ErrnoError(10);if(!l.isDir(i.mode))throw new l.ErrnoError(54)}var u={type:e,opts:t,mountpoint:o,mounts:[]},F=e.mount(u);return F.mount=u,u.root=F,s?l.root=F:i&&(i.mounted=u,i.mount&&i.mount.mounts.push(u)),F},unmount(e){var t=l.lookupPath(e,{follow_mount:!1});if(!l.isMountpoint(t.node))throw new l.ErrnoError(28);var o=t.node,s=o.mounted,n=l.getMounts(s);for(var[i,r]of Object.entries(l.nameTable))for(;r;){var u=r.name_next;n.includes(r.mount)&&l.destroyNode(r),r=u}o.mounted=null;var F=o.mount.mounts.indexOf(s);o.mount.mounts.splice(F,1)},lookup(e,t){return e.node_ops.lookup(e,t)},mknod(e,t,o){var s=l.lookupPath(e,{parent:!0}).node,n=xe.basename(e);if(!n)throw new l.ErrnoError(28);if(n==="."||n==="..")throw new l.ErrnoError(20);var i=l.mayCreate(s,n);if(i)throw new l.ErrnoError(i);if(!s.node_ops.mknod)throw new l.ErrnoError(63);return s.node_ops.mknod(s,n,t,o)},statfs(e){return l.statfsNode(l.lookupPath(e,{follow:!0}).node)},statfsStream(e){return l.statfsNode(e.node)},statfsNode(e){var t={bsize:4096,frsize:4096,blocks:1e6,bfree:5e5,bavail:5e5,files:l.nextInode,ffree:l.nextInode-1,fsid:42,flags:2,namelen:255};return e.node_ops.statfs&&Object.assign(t,e.node_ops.statfs(e.mount.opts.root)),t},create(e,t=438){return t&=4095,t|=32768,l.mknod(e,t,0)},mkdir(e,t=511){return t&=1023,t|=16384,l.mknod(e,t,0)},mkdirTree(e,t){var o=e.split("/"),s="";for(var n of o)if(n){(s||xe.isAbs(e))&&(s+="/"),s+=n;try{l.mkdir(s,t)}catch(i){if(i.errno!=20)throw i}}},mkdev(e,t,o){return typeof o>"u"&&(o=t,t=438),t|=8192,l.mknod(e,t,o)},symlink(e,t){if(!_t.resolve(e))throw new l.ErrnoError(44);var o=l.lookupPath(t,{parent:!0}).node;if(!o)throw new l.ErrnoError(44);var s=xe.basename(t),n=l.mayCreate(o,s);if(n)throw new l.ErrnoError(n);if(!o.node_ops.symlink)throw new l.ErrnoError(63);return o.node_ops.symlink(o,s,e)},rename(e,t){var o=xe.dirname(e),s=xe.dirname(t),n=xe.basename(e),i=xe.basename(t),r=l.lookupPath(e,{parent:!0}),u=r.node,F;if(r=l.lookupPath(t,{parent:!0}),F=r.node,!u||!F)throw new l.ErrnoError(44);if(u.mount!==F.mount)throw new l.ErrnoError(75);var T=l.lookupNode(u,n),J=_t.relative(e,s);if(J.charAt(0)!==".")throw new l.ErrnoError(28);if(J=_t.relative(t,o),J.charAt(0)!==".")throw new l.ErrnoError(55);var N;try{N=l.lookupNode(F,i)}catch{}if(T!==N){var G=l.isDir(T.mode),p=l.mayDelete(u,n,G);if(p)throw new l.ErrnoError(p);if(p=N?l.mayDelete(F,i,G):l.mayCreate(F,i),p)throw new l.ErrnoError(p);if(!u.node_ops.rename)throw new l.ErrnoError(63);if(l.isMountpoint(T)||N&&l.isMountpoint(N))throw new l.ErrnoError(10);if(F!==u&&(p=l.nodePermissions(u,"w"),p))throw new l.ErrnoError(p);l.hashRemoveNode(T);try{u.node_ops.rename(T,F,i),T.parent=F}catch(z){throw z}finally{l.hashAddNode(T)}}},rmdir(e){var t=l.lookupPath(e,{parent:!0}).node,o=xe.basename(e),s=l.lookupNode(t,o),n=l.mayDelete(t,o,!0);if(n)throw new l.ErrnoError(n);if(!t.node_ops.rmdir)throw new l.ErrnoError(63);if(l.isMountpoint(s))throw new l.ErrnoError(10);t.node_ops.rmdir(t,o),l.destroyNode(s)},readdir(e){var t=l.lookupPath(e,{follow:!0}).node;return l.checkOpExists(t.node_ops.readdir,54)(t)},unlink(e){var t=l.lookupPath(e,{parent:!0}).node;if(!t)throw new l.ErrnoError(44);var o=xe.basename(e),s=l.lookupNode(t,o),n=l.mayDelete(t,o,!1);if(n)throw new l.ErrnoError(n);if(!t.node_ops.unlink)throw new l.ErrnoError(63);if(l.isMountpoint(s))throw new l.ErrnoError(10);t.node_ops.unlink(t,o),l.destroyNode(s)},readlink(e){var t=l.lookupPath(e).node;if(!t)throw new l.ErrnoError(44);if(!t.node_ops.readlink)throw new l.ErrnoError(28);return t.node_ops.readlink(t)},stat(e,t){var o=l.lookupPath(e,{follow:!t}).node;return l.checkOpExists(o.node_ops.getattr,63)(o)},fstat(e){var t=l.getStreamChecked(e),o=t.node,s=t.stream_ops.getattr,n=s?t:o;return s??=o.node_ops.getattr,l.checkOpExists(s,63),s(n)},lstat(e){return l.stat(e,!0)},doChmod(e,t,o,s){l.doSetAttr(e,t,{mode:o&4095|t.mode&-4096,ctime:Date.now(),dontFollow:s})},chmod(e,t,o){var s;typeof e=="string"?s=l.lookupPath(e,{follow:!o}).node:s=e,l.doChmod(null,s,t,o)},lchmod(e,t){l.chmod(e,t,!0)},fchmod(e,t){var o=l.getStreamChecked(e);l.doChmod(o,o.node,t,!1)},doChown(e,t,o){l.doSetAttr(e,t,{timestamp:Date.now(),dontFollow:o})},chown(e,t,o,s){var n;typeof e=="string"?n=l.lookupPath(e,{follow:!s}).node:n=e,l.doChown(null,n,s)},lchown(e,t,o){l.chown(e,t,o,!0)},fchown(e,t,o){var s=l.getStreamChecked(e);l.doChown(s,s.node,!1)},doTruncate(e,t,o){if(l.isDir(t.mode))throw new l.ErrnoError(31);if(!l.isFile(t.mode))throw new l.ErrnoError(28);var s=l.nodePermissions(t,"w");if(s)throw new l.ErrnoError(s);l.doSetAttr(e,t,{size:o,timestamp:Date.now()})},truncate(e,t){if(t<0)throw new l.ErrnoError(28);var o;typeof e=="string"?o=l.lookupPath(e,{follow:!0}).node:o=e,l.doTruncate(null,o,t)},ftruncate(e,t){var o=l.getStreamChecked(e);if(t<0||(o.flags&2097155)===0)throw new l.ErrnoError(28);l.doTruncate(o,o.node,t)},utime(e,t,o){var s=l.lookupPath(e,{follow:!0}).node;l.checkOpExists(s.node_ops.setattr,63)(s,{atime:t,mtime:o})},open(e,t,o=438){if(e==="")throw new l.ErrnoError(44);t=typeof t=="string"?Fn(t):t,t&64?o=o&4095|32768:o=0;var s,n;if(typeof e=="object")s=e;else{n=e.endsWith("/");var i=l.lookupPath(e,{follow:!(t&131072),noent_okay:!0});s=i.node,e=i.path}var r=!1;if(t&64)if(s){if(t&128)throw new l.ErrnoError(20)}else{if(n)throw new l.ErrnoError(31);s=l.mknod(e,o|511,0),r=!0}if(!s)throw new l.ErrnoError(44);if(l.isChrdev(s.mode)&&(t&=-513),t&65536&&!l.isDir(s.mode))throw new l.ErrnoError(54);if(!r){var u=l.mayOpen(s,t);if(u)throw new l.ErrnoError(u)}t&512&&!r&&l.truncate(s,0),t&=-131713;var F=l.createStream({node:s,path:l.getPath(s),flags:t,seekable:!0,position:0,stream_ops:s.stream_ops,ungotten:[],error:!1});return F.stream_ops.open&&F.stream_ops.open(F),r&&l.chmod(s,o&511),c.logReadFiles&&!(t&1)&&(e in l.readFiles||(l.readFiles[e]=1)),F},close(e){if(l.isClosed(e))throw new l.ErrnoError(8);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(t){throw t}finally{l.closeStream(e.fd)}e.fd=null},isClosed(e){return e.fd===null},llseek(e,t,o){if(l.isClosed(e))throw new l.ErrnoError(8);if(!e.seekable||!e.stream_ops.llseek)throw new l.ErrnoError(70);if(o!=0&&o!=1&&o!=2)throw new l.ErrnoError(28);return e.position=e.stream_ops.llseek(e,t,o),e.ungotten=[],e.position},read(e,t,o,s,n){if(s<0||n<0)throw new l.ErrnoError(28);if(l.isClosed(e))throw new l.ErrnoError(8);if((e.flags&2097155)===1)throw new l.ErrnoError(8);if(l.isDir(e.node.mode))throw new l.ErrnoError(31);if(!e.stream_ops.read)throw new l.ErrnoError(28);var i=typeof n<"u";if(!i)n=e.position;else if(!e.seekable)throw new l.ErrnoError(70);var r=e.stream_ops.read(e,t,o,s,n);return i||(e.position+=r),r},write(e,t,o,s,n,i){if(s<0||n<0)throw new l.ErrnoError(28);if(l.isClosed(e))throw new l.ErrnoError(8);if((e.flags&2097155)===0)throw new l.ErrnoError(8);if(l.isDir(e.node.mode))throw new l.ErrnoError(31);if(!e.stream_ops.write)throw new l.ErrnoError(28);e.seekable&&e.flags&1024&&l.llseek(e,0,2);var r=typeof n<"u";if(!r)n=e.position;else if(!e.seekable)throw new l.ErrnoError(70);var u=e.stream_ops.write(e,t,o,s,n,i);return r||(e.position+=u),u},mmap(e,t,o,s,n){if((s&2)!==0&&(n&2)===0&&(e.flags&2097155)!==2)throw new l.ErrnoError(2);if((e.flags&2097155)===1)throw new l.ErrnoError(2);if(!e.stream_ops.mmap)throw new l.ErrnoError(43);if(!t)throw new l.ErrnoError(28);return e.stream_ops.mmap(e,t,o,s,n)},msync(e,t,o,s,n){return e.stream_ops.msync?e.stream_ops.msync(e,t,o,s,n):0},ioctl(e,t,o){if(!e.stream_ops.ioctl)throw new l.ErrnoError(59);return e.stream_ops.ioctl(e,t,o)},readFile(e,t={}){t.flags=t.flags||0,t.encoding=t.encoding||"binary",t.encoding!=="utf8"&&t.encoding!=="binary"&&Ye(`Invalid encoding type "${t.encoding}"`);var o=l.open(e,t.flags),s=l.stat(e).size,n=new Uint8Array(s);return l.read(o,n,0,s,0),t.encoding==="utf8"&&(n=bt(n)),l.close(o),n},writeFile(e,t,o={}){o.flags=o.flags||577;var s=l.open(e,o.flags,o.mode);typeof t=="string"&&(t=new Uint8Array(Lt(t))),ArrayBuffer.isView(t)?l.write(s,t,0,t.byteLength,void 0,o.canOwn):Ye("Unsupported data type"),l.close(s)},cwd:()=>l.currentPath,chdir(e){var t=l.lookupPath(e,{follow:!0});if(t.node===null)throw new l.ErrnoError(44);if(!l.isDir(t.node.mode))throw new l.ErrnoError(54);var o=l.nodePermissions(t.node,"x");if(o)throw new l.ErrnoError(o);l.currentPath=t.path},createDefaultDirectories(){l.mkdir("/tmp"),l.mkdir("/home"),l.mkdir("/home/web_user")},createDefaultDevices(){l.mkdir("/dev"),l.registerDevice(l.makedev(1,3),{read:()=>0,write:(s,n,i,r,u)=>r,llseek:()=>0}),l.mkdev("/dev/null",l.makedev(1,3)),ot.register(l.makedev(5,0),ot.default_tty_ops),ot.register(l.makedev(6,0),ot.default_tty1_ops),l.mkdev("/dev/tty",l.makedev(5,0)),l.mkdev("/dev/tty1",l.makedev(6,0));var e=new Uint8Array(1024),t=0,o=()=>(t===0&&(Wt(e),t=e.byteLength),e[--t]);l.createDevice("/dev","random",o),l.createDevice("/dev","urandom",o),l.mkdir("/dev/shm"),l.mkdir("/dev/shm/tmp")},createSpecialDirectories(){l.mkdir("/proc");var e=l.mkdir("/proc/self");l.mkdir("/proc/self/fd"),l.mount({mount(){var t=l.createNode(e,"fd",16895,73);return t.stream_ops={llseek:qe.stream_ops.llseek},t.node_ops={lookup(o,s){var n=+s,i=l.getStreamChecked(n),r={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>i.path},id:n+1};return r.parent=r,r},readdir(){return Array.from(l.streams.entries()).filter(([o,s])=>s).map(([o,s])=>o.toString())}},t}},{},"/proc/self/fd")},createStandardStreams(e,t,o){e?l.createDevice("/dev","stdin",e):l.symlink("/dev/tty","/dev/stdin"),t?l.createDevice("/dev","stdout",null,t):l.symlink("/dev/tty","/dev/stdout"),o?l.createDevice("/dev","stderr",null,o):l.symlink("/dev/tty1","/dev/stderr"),l.open("/dev/stdin",0),l.open("/dev/stdout",1),l.open("/dev/stderr",1)},staticInit(){l.nameTable=new Array(4096),l.mount(qe,{},"/"),l.createDefaultDirectories(),l.createDefaultDevices(),l.createSpecialDirectories(),l.filesystems={MEMFS:qe}},init(e,t,o){l.initialized=!0,e??=c.stdin,t??=c.stdout,o??=c.stderr,l.createStandardStreams(e,t,o)},quit(){l.initialized=!1;for(var e of l.streams)e&&l.close(e)},findObject(e,t){var o=l.analyzePath(e,t);return o.exists?o.object:null},analyzePath(e,t){try{var o=l.lookupPath(e,{follow:!t});e=o.path}catch{}var s={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var o=l.lookupPath(e,{parent:!0});s.parentExists=!0,s.parentPath=o.path,s.parentObject=o.node,s.name=xe.basename(e),o=l.lookupPath(e,{follow:!t}),s.exists=!0,s.path=o.path,s.object=o.node,s.name=o.node.name,s.isRoot=o.path==="/"}catch(n){s.error=n.errno}return s},createPath(e,t,o,s){e=typeof e=="string"?e:l.getPath(e);for(var n=t.split("/").reverse();n.length;){var i=n.pop();if(i){var r=xe.join2(e,i);try{l.mkdir(r)}catch(u){if(u.errno!=20)throw u}e=r}}return r},createFile(e,t,o,s,n){var i=xe.join2(typeof e=="string"?e:l.getPath(e),t),r=Nt(s,n);return l.create(i,r)},createDataFile(e,t,o,s,n,i){var r=t;e&&(e=typeof e=="string"?e:l.getPath(e),r=t?xe.join2(e,t):e);var u=Nt(s,n),F=l.create(r,u);if(o){if(typeof o=="string"){for(var T=new Array(o.length),J=0,N=o.length;J<N;++J)T[J]=o.charCodeAt(J);o=T}l.chmod(F,u|146);var G=l.open(F,577);l.write(G,o,0,o.length,0,i),l.close(G),l.chmod(F,u)}},createDevice(e,t,o,s){var n=xe.join2(typeof e=="string"?e:l.getPath(e),t),i=Nt(!!o,!!s);l.createDevice.major??=64;var r=l.makedev(l.createDevice.major++,0);return l.registerDevice(r,{open(u){u.seekable=!1},close(u){s?.buffer?.length&&s(10)},read(u,F,T,J,N){for(var G=0,p=0;p<J;p++){var z;try{z=o()}catch{throw new l.ErrnoError(29)}if(z===void 0&&G===0)throw new l.ErrnoError(6);if(z==null)break;G++,F[T+p]=z}return G&&(u.node.atime=Date.now()),G},write(u,F,T,J,N){for(var G=0;G<J;G++)try{s(F[T+G])}catch{throw new l.ErrnoError(29)}return J&&(u.node.mtime=u.node.ctime=Date.now()),G}}),l.mkdev(n,i,r)},forceLoadFile(e){if(e.isDevice||e.isFolder||e.link||e.contents)return!0;if(globalThis.XMLHttpRequest)Ye("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");else try{e.contents=it(e.url)}catch{throw new l.ErrnoError(29)}},createLazyFile(e,t,o,s,n){class i{lengthKnown=!1;chunks=[];get(N){if(!(N>this.length-1||N<0)){var G=N%this.chunkSize,p=N/this.chunkSize|0;return this.getter(p)[G]}}setDataGetter(N){this.getter=N}cacheLength(){var N=new XMLHttpRequest;N.open("HEAD",o,!1),N.send(null),N.status>=200&&N.status<300||N.status===304||Ye("Couldn't load "+o+". Status: "+N.status);var G=Number(N.getResponseHeader("Content-length")),p,z=(p=N.getResponseHeader("Accept-Ranges"))&&p==="bytes",C=(p=N.getResponseHeader("Content-Encoding"))&&p==="gzip",te=1024*1024;z||(te=G);var y=(R,U)=>{R>U&&Ye("invalid range ("+R+", "+U+") or no bytes requested!"),U>G-1&&Ye("only "+G+" bytes available! programmer error!");var w=new XMLHttpRequest;return w.open("GET",o,!1),G!==te&&w.setRequestHeader("Range","bytes="+R+"-"+U),w.responseType="arraybuffer",w.overrideMimeType&&w.overrideMimeType("text/plain; charset=x-user-defined"),w.send(null),w.status>=200&&w.status<300||w.status===304||Ye("Couldn't load "+o+". Status: "+w.status),w.response!==void 0?new Uint8Array(w.response||[]):Lt(w.responseText||"")},b=this;b.setDataGetter(R=>{var U=R*te,w=(R+1)*te-1;return w=Math.min(w,G-1),typeof b.chunks[R]>"u"&&(b.chunks[R]=y(U,w)),typeof b.chunks[R]>"u"&&Ye("doXHR failed!"),b.chunks[R]}),(C||!G)&&(te=G=1,G=this.getter(0).length,te=G,be("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=G,this._chunkSize=te,this.lengthKnown=!0}get length(){return this.lengthKnown||this.cacheLength(),this._length}get chunkSize(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}if(globalThis.XMLHttpRequest){Ae||Ye("Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc");var r={isDevice:!1,contents:new i}}else var r={isDevice:!1,url:o};var u=l.createFile(e,t,r,s,n);r.contents?u.contents=r.contents:r.url&&(u.contents=null,u.url=r.url),Object.defineProperties(u,{usedBytes:{get:function(){return this.contents.length}}});var F={};for(const[J,N]of Object.entries(u.stream_ops))F[J]=(...G)=>(l.forceLoadFile(u),N(...G));function T(J,N,G,p,z){var C=J.node.contents;if(z>=C.length)return 0;var te=Math.min(C.length-z,p);if(C.slice)for(var y=0;y<te;y++)N[G+y]=C[z+y];else for(var y=0;y<te;y++)N[G+y]=C.get(z+y);return te}return F.read=(J,N,G,p,z)=>(l.forceLoadFile(u),T(J,N,G,p,z)),F.mmap=(J,N,G,p,z)=>{l.forceLoadFile(u);var C=$t(N);if(!C)throw new l.ErrnoError(48);return T(J,He,C,N,G),{ptr:C,allocated:!0}},u.stream_ops=F,u}},Mn=(e,t,o)=>{if(!e)return"";var s=Vt(st,e,t);return Qt.decode(st.subarray(e,s))},Ie={calculateAt(e,t,o){if(xe.isAbs(t))return t;var s;if(e===-100?s=l.cwd():s=Ie.getStreamFromFD(e).path,t.length==0){if(!o)throw new l.ErrnoError(44);return s}return s+"/"+t},writeStat(e,t){Le[e>>2]=t.dev,Le[e+4>>2]=t.mode,Le[e+8>>2]=t.nlink,Le[e+12>>2]=t.uid,Le[e+16>>2]=t.gid,Le[e+20>>2]=t.rdev,ze[e+24>>3]=BigInt(t.size),Pe[e+32>>2]=4096,Pe[e+36>>2]=t.blocks;var o=t.atime.getTime(),s=t.mtime.getTime(),n=t.ctime.getTime();return ze[e+40>>3]=BigInt(Math.floor(o/1e3)),Le[e+48>>2]=o%1e3*1e3*1e3,ze[e+56>>3]=BigInt(Math.floor(s/1e3)),Le[e+64>>2]=s%1e3*1e3*1e3,ze[e+72>>3]=BigInt(Math.floor(n/1e3)),Le[e+80>>2]=n%1e3*1e3*1e3,ze[e+88>>3]=BigInt(t.ino),0},writeStatFs(e,t){Le[e+4>>2]=t.bsize,Le[e+60>>2]=t.bsize,ze[e+8>>3]=BigInt(t.blocks),ze[e+16>>3]=BigInt(t.bfree),ze[e+24>>3]=BigInt(t.bavail),ze[e+32>>3]=BigInt(t.files),ze[e+40>>3]=BigInt(t.ffree),Le[e+48>>2]=t.fsid,Le[e+64>>2]=t.flags,Le[e+56>>2]=t.namelen},doMsync(e,t,o,s,n){if(!l.isFile(t.node.mode))throw new l.ErrnoError(43);if(s&2)return 0;var i=st.slice(e,e+o);l.msync(t,i,n,o,s)},getStreamFromFD(e){return l.getStreamChecked(e)},varargs:void 0,getStr(e){return Mn(e)}};function zn(e,t){try{return e=Ie.getStr(e),l.chmod(e,t),0}catch(o){if(typeof l>"u"||o.name!=="ErrnoError")throw o;return-o.errno}}function Bn(e,t,o,s){try{if(t=Ie.getStr(t),t=Ie.calculateAt(e,t),o&-8)return-28;var n=l.lookupPath(t,{follow:!0}).node;if(!n)return-44;var i="";return o&4&&(i+="r"),o&2&&(i+="w"),o&1&&(i+="x"),i&&l.nodePermissions(n,i)?-2:0}catch(r){if(typeof l>"u"||r.name!=="ErrnoError")throw r;return-r.errno}}function Un(e,t){try{return l.fchmod(e,t),0}catch(o){if(typeof l>"u"||o.name!=="ErrnoError")throw o;return-o.errno}}function Wn(e,t,o){try{return l.fchown(e,t,o),0}catch(s){if(typeof l>"u"||s.name!=="ErrnoError")throw s;return-s.errno}}var Tt=()=>{var e=Pe[+Ie.varargs>>2];return Ie.varargs+=4,e},ft=Tt;function Qn(e,t,o){Ie.varargs=o;try{var s=Ie.getStreamFromFD(e);switch(t){case 0:var n=Tt();if(n<0)return-28;for(;l.streams[n];)n++;return l.dupStream(s,n).fd;case 1:case 2:return 0;case 3:return s.flags;case 4:var n=Tt();return s.flags|=n,0;case 12:var n=ft(),i=0;return gt[n+i>>1]=2,0;case 13:case 14:return 0}return-28}catch(r){if(typeof l>"u"||r.name!=="ErrnoError")throw r;return-r.errno}}function Vn(e,t){try{return Ie.writeStat(t,l.fstat(e))}catch(o){if(typeof l>"u"||o.name!=="ErrnoError")throw o;return-o.errno}}var Hn=9007199254740992,Gn=-9007199254740992,qt=e=>e<Gn||e>Hn?NaN:Number(e);function $n(e,t){t=qt(t);try{return isNaN(t)?-61:(l.ftruncate(e,t),0)}catch(o){if(typeof l>"u"||o.name!=="ErrnoError")throw o;return-o.errno}}var lt=(e,t,o)=>Ht(e,st,t,o);function Kn(e,t){try{if(t===0)return-28;var o=l.cwd(),s=At(o)+1;return t<s?-68:(lt(o,e,t),s)}catch(n){if(typeof l>"u"||n.name!=="ErrnoError")throw n;return-n.errno}}function Jn(e,t,o){Ie.varargs=o;try{var s=Ie.getStreamFromFD(e);switch(t){case 21509:return s.tty?0:-59;case 21505:if(!s.tty)return-59;if(s.tty.ops.ioctl_tcgets){var n=s.tty.ops.ioctl_tcgets(s),N=ft();Pe[N>>2]=n.c_iflag||0,Pe[N+4>>2]=n.c_oflag||0,Pe[N+8>>2]=n.c_cflag||0,Pe[N+12>>2]=n.c_lflag||0;for(var i=0;i<32;i++)He[N+i+17]=n.c_cc[i]||0;return 0}return 0;case 21510:case 21511:case 21512:return s.tty?0:-59;case 21506:case 21507:case 21508:if(!s.tty)return-59;if(s.tty.ops.ioctl_tcsets){for(var N=ft(),r=Pe[N>>2],u=Pe[N+4>>2],F=Pe[N+8>>2],T=Pe[N+12>>2],J=[],i=0;i<32;i++)J.push(He[N+i+17]);return s.tty.ops.ioctl_tcsets(s.tty,t,{c_iflag:r,c_oflag:u,c_cflag:F,c_lflag:T,c_cc:J})}return 0;case 21519:if(!s.tty)return-59;var N=ft();return Pe[N>>2]=0,0;case 21520:return s.tty?-28:-59;case 21537:case 21531:var N=ft();return l.ioctl(s,t,N);case 21523:if(!s.tty)return-59;if(s.tty.ops.ioctl_tiocgwinsz){var G=s.tty.ops.ioctl_tiocgwinsz(s.tty),N=ft();gt[N>>1]=G[0],gt[N+2>>1]=G[1]}return 0;case 21524:return s.tty?0:-59;case 21515:return s.tty?0:-59;default:return-28}}catch(p){if(typeof l>"u"||p.name!=="ErrnoError")throw p;return-p.errno}}function Xn(e,t){try{return e=Ie.getStr(e),Ie.writeStat(t,l.lstat(e))}catch(o){if(typeof l>"u"||o.name!=="ErrnoError")throw o;return-o.errno}}function Yn(e,t,o){try{return t=Ie.getStr(t),t=Ie.calculateAt(e,t),l.mkdir(t,o,0),0}catch(s){if(typeof l>"u"||s.name!=="ErrnoError")throw s;return-s.errno}}function Zn(e,t,o,s){try{t=Ie.getStr(t);var n=s&256,i=s&4096;return s=s&-6401,t=Ie.calculateAt(e,t,i),Ie.writeStat(o,n?l.lstat(t):l.stat(t))}catch(r){if(typeof l>"u"||r.name!=="ErrnoError")throw r;return-r.errno}}function er(e,t,o,s){Ie.varargs=s;try{t=Ie.getStr(t),t=Ie.calculateAt(e,t);var n=s?Tt():0;return l.open(t,o,n).fd}catch(i){if(typeof l>"u"||i.name!=="ErrnoError")throw i;return-i.errno}}function tr(e,t,o,s){try{if(t=Ie.getStr(t),t=Ie.calculateAt(e,t),s<=0)return-28;var n=l.readlink(t),i=Math.min(s,At(n)),r=He[o+i];return lt(n,o,s+1),He[o+i]=r,i}catch(u){if(typeof l>"u"||u.name!=="ErrnoError")throw u;return-u.errno}}function nr(e){try{return e=Ie.getStr(e),l.rmdir(e),0}catch(t){if(typeof l>"u"||t.name!=="ErrnoError")throw t;return-t.errno}}function rr(e,t){try{return e=Ie.getStr(e),Ie.writeStat(t,l.stat(e))}catch(o){if(typeof l>"u"||o.name!=="ErrnoError")throw o;return-o.errno}}function ir(e,t,o){try{if(t=Ie.getStr(t),t=Ie.calculateAt(e,t),!o)l.unlink(t);else if(o===512)l.rmdir(t);else return-28;return 0}catch(s){if(typeof l>"u"||s.name!=="ErrnoError")throw s;return-s.errno}}var Xt=e=>Le[e>>2]+Pe[e+4>>2]*4294967296;function sr(e,t,o,s){try{t=Ie.getStr(t),t=Ie.calculateAt(e,t,!0);var n=Date.now(),i,r;if(!o)i=n,r=n;else{var u=Xt(o),F=Pe[o+8>>2];F==1073741823?i=n:F==1073741822?i=null:i=u*1e3+F/(1e3*1e3),o+=16,u=Xt(o),F=Pe[o+8>>2],F==1073741823?r=n:F==1073741822?r=null:r=u*1e3+F/(1e3*1e3)}return(r??i)!==null&&l.utime(t,i,r),0}catch(T){if(typeof l>"u"||T.name!=="ErrnoError")throw T;return-T.errno}}var or=e=>e%4===0&&(e%100!==0||e%400===0),ar=[0,31,60,91,121,152,182,213,244,274,305,335],lr=[0,31,59,90,120,151,181,212,243,273,304,334],cr=e=>(or(e.getFullYear())?ar:lr)[e.getMonth()]+e.getDate()-1;function ur(e,t){e=qt(e);var o=new Date(e*1e3);Pe[t>>2]=o.getSeconds(),Pe[t+4>>2]=o.getMinutes(),Pe[t+8>>2]=o.getHours(),Pe[t+12>>2]=o.getDate(),Pe[t+16>>2]=o.getMonth(),Pe[t+20>>2]=o.getFullYear()-1900,Pe[t+24>>2]=o.getDay();var s=cr(o)|0;Pe[t+28>>2]=s,Pe[t+36>>2]=-(o.getTimezoneOffset()*60);var n=new Date(o.getFullYear(),0,1),i=new Date(o.getFullYear(),6,1).getTimezoneOffset(),r=n.getTimezoneOffset(),u=(i!=r&&o.getTimezoneOffset()==Math.min(r,i))|0;Pe[t+32>>2]=u}function _r(e,t,o,s,n,i,r){n=qt(n);try{var u=Ie.getStreamFromFD(s),F=l.mmap(u,e,n,t,o),T=F.ptr;return Pe[i>>2]=F.allocated,Le[r>>2]=T,0}catch(J){if(typeof l>"u"||J.name!=="ErrnoError")throw J;return-J.errno}}function fr(e,t,o,s,n,i){i=qt(i);try{var r=Ie.getStreamFromFD(n);o&2&&Ie.doMsync(e,r,t,s,i)}catch(u){if(typeof l>"u"||u.name!=="ErrnoError")throw u;return-u.errno}}var dr=(e,t,o,s)=>{var n=new Date().getFullYear(),i=new Date(n,0,1),r=new Date(n,6,1),u=i.getTimezoneOffset(),F=r.getTimezoneOffset(),T=Math.max(u,F);Le[e>>2]=T*60,Pe[t>>2]=+(u!=F);var J=p=>{var z=p>=0?"-":"+",C=Math.abs(p);return`UTC${z}${String(Math.floor(C/60)).padStart(2,"0")}${String(C%60).padStart(2,"0")}`},N=J(u),G=J(F);F<u?(lt(N,o,17),lt(G,s,17)):(lt(N,s,17),lt(G,o,17))},Yt=()=>performance.now(),Zt=()=>Date.now(),pr=e=>e>=0&&e<=3;function hr(e,t,o){if(!pr(e))return 28;var s;e===0?s=Zt():s=Yt();var n=Math.round(s*1e3*1e3);return ze[o>>3]=BigInt(n),0}var en=()=>2147483648,mr=()=>en(),gr=e=>{var t=(e-et.buffer.byteLength+65535)/65536|0;try{return et.grow(t),Mt(),1}catch{}},br=e=>{var t=st.length;e>>>=0;var o=en();if(e>o)return!1;for(var s=1;s<=4;s*=2){var n=t*(1+.2/s);if(n=Math.min(n,e+100663296),gr(Math.min(o,Gt(Math.max(e,n),65536))))return!0}return!1},Ct={},yr=()=>Ce||"./this.program",vt=()=>{if(!vt.strings){var e=(globalThis.navigator?.language??"C").replace("-","_")+".UTF-8",t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:e,_:yr()};for(var o in Ct)Ct[o]===void 0?delete t[o]:t[o]=Ct[o];var s=[];for(var o in t)s.push(`${o}=${t[o]}`);vt.strings=s}return vt.strings},qr=(e,t)=>{var o=0,s=0;for(var n of vt()){var i=t+o;Le[e+s>>2]=i,o+=lt(n,i,1/0)+1,s+=4}return 0},vr=(e,t)=>{var o=vt();Le[e>>2]=o.length;var s=0;for(var n of o)s+=At(n)+1;return Le[t>>2]=s,0};function Er(e){try{var t=Ie.getStreamFromFD(e);return l.close(t),0}catch(o){if(typeof l>"u"||o.name!=="ErrnoError")throw o;return o.errno}}function Sr(e,t){try{var o=0,s=0,n=0,i=Ie.getStreamFromFD(e),r=i.tty?2:l.isDir(i.mode)?3:l.isLink(i.mode)?7:4;return He[t]=r,gt[t+2>>1]=n,ze[t+8>>3]=BigInt(o),ze[t+16>>3]=BigInt(s),0}catch(u){if(typeof l>"u"||u.name!=="ErrnoError")throw u;return u.errno}}var wr=(e,t,o,s)=>{for(var n=0,i=0;i<o;i++){var r=Le[t>>2],u=Le[t+4>>2];t+=8;var F=l.read(e,He,r,u,s);if(F<0)return-1;if(n+=F,F<u)break}return n};function Ir(e,t,o,s){try{var n=wr(Ie.getStreamFromFD(e),t,o);return Le[s>>2]=n,0}catch(i){if(typeof l>"u"||i.name!=="ErrnoError")throw i;return i.errno}}function Ar(e,t,o,s){t=qt(t);try{if(isNaN(t))return 61;var n=Ie.getStreamFromFD(e);return l.llseek(n,t,o),ze[s>>3]=BigInt(n.position),n.getdents&&t===0&&o===0&&(n.getdents=null),0}catch(i){if(typeof l>"u"||i.name!=="ErrnoError")throw i;return i.errno}}function Tr(e){try{var t=Ie.getStreamFromFD(e);return t.stream_ops?.fsync?.(t)}catch(o){if(typeof l>"u"||o.name!=="ErrnoError")throw o;return o.errno}}var kr=(e,t,o,s)=>{for(var n=0,i=0;i<o;i++){var r=Le[t>>2],u=Le[t+4>>2];t+=8;var F=l.write(e,He,r,u,s);if(F<0)return-1;if(n+=F,F<u)break}return n};function Or(e,t,o,s){try{var n=kr(Ie.getStreamFromFD(e),t,o);return Le[s>>2]=n,0}catch(i){if(typeof l>"u"||i.name!=="ErrnoError")throw i;return i.errno}}if(l.createPreloadedFile=jn,l.preloadFile=Jt,l.staticInit(),mn(),c.noExitRuntime&&c.noExitRuntime,c.preloadPlugins&&(Kt=c.preloadPlugins),c.print&&(be=c.print),c.printErr&&(Ne=c.printErr),c.wasmBinary&&(Qe=c.wasmBinary),c.arguments&&c.arguments,c.thisProgram&&(Ce=c.thisProgram),c.preInit)for(typeof c.preInit=="function"&&(c.preInit=[c.preInit]);c.preInit.length>0;)c.preInit.shift()();c.wasmMemory=et;var tn;function Pr(e){c._sqlite3_status64=e.sqlite3_status64,c._sqlite3_status=e.sqlite3_status,c._sqlite3_db_status64=e.sqlite3_db_status64,c._sqlite3_msize=e.sqlite3_msize,c._sqlite3_db_status=e.sqlite3_db_status,c._sqlite3_vfs_find=e.sqlite3_vfs_find,c._sqlite3_initialize=e.sqlite3_initialize,c._sqlite3_malloc=e.sqlite3_malloc,c._sqlite3_free=e.sqlite3_free,c._sqlite3_vfs_register=e.sqlite3_vfs_register,c._sqlite3_vfs_unregister=e.sqlite3_vfs_unregister,c._sqlite3_malloc64=e.sqlite3_malloc64,c._sqlite3_realloc=e.sqlite3_realloc,c._sqlite3_realloc64=e.sqlite3_realloc64,c._sqlite3_value_text=e.sqlite3_value_text,c._sqlite3_randomness=e.sqlite3_randomness,c._sqlite3_stricmp=e.sqlite3_stricmp,c._sqlite3_strnicmp=e.sqlite3_strnicmp,c._sqlite3_uri_parameter=e.sqlite3_uri_parameter,c._sqlite3_uri_boolean=e.sqlite3_uri_boolean,c._sqlite3_serialize=e.sqlite3_serialize,c._sqlite3_prepare_v2=e.sqlite3_prepare_v2,c._sqlite3_step=e.sqlite3_step,c._sqlite3_column_int64=e.sqlite3_column_int64,c._sqlite3_reset=e.sqlite3_reset,c._sqlite3_exec=e.sqlite3_exec,c._sqlite3_column_int=e.sqlite3_column_int,c._sqlite3_finalize=e.sqlite3_finalize,c._sqlite3_file_control=e.sqlite3_file_control,c._sqlite3_column_name=e.sqlite3_column_name,c._sqlite3_column_text=e.sqlite3_column_text,c._sqlite3_column_type=e.sqlite3_column_type,c._sqlite3_errmsg=e.sqlite3_errmsg,c._sqlite3_deserialize=e.sqlite3_deserialize,c._sqlite3_clear_bindings=e.sqlite3_clear_bindings,c._sqlite3_value_blob=e.sqlite3_value_blob,c._sqlite3_value_bytes=e.sqlite3_value_bytes,c._sqlite3_value_double=e.sqlite3_value_double,c._sqlite3_value_int=e.sqlite3_value_int,c._sqlite3_value_int64=e.sqlite3_value_int64,c._sqlite3_value_subtype=e.sqlite3_value_subtype,c._sqlite3_value_pointer=e.sqlite3_value_pointer,c._sqlite3_value_type=e.sqlite3_value_type,c._sqlite3_value_nochange=e.sqlite3_value_nochange,c._sqlite3_value_frombind=e.sqlite3_value_frombind,c._sqlite3_value_dup=e.sqlite3_value_dup,c._sqlite3_value_free=e.sqlite3_value_free,c._sqlite3_result_blob=e.sqlite3_result_blob,c._sqlite3_result_error_toobig=e.sqlite3_result_error_toobig,c._sqlite3_result_error_nomem=e.sqlite3_result_error_nomem,c._sqlite3_result_double=e.sqlite3_result_double,c._sqlite3_result_error=e.sqlite3_result_error,c._sqlite3_result_int=e.sqlite3_result_int,c._sqlite3_result_int64=e.sqlite3_result_int64,c._sqlite3_result_null=e.sqlite3_result_null,c._sqlite3_result_pointer=e.sqlite3_result_pointer,c._sqlite3_result_subtype=e.sqlite3_result_subtype,c._sqlite3_result_text=e.sqlite3_result_text,c._sqlite3_result_zeroblob=e.sqlite3_result_zeroblob,c._sqlite3_result_zeroblob64=e.sqlite3_result_zeroblob64,c._sqlite3_result_error_code=e.sqlite3_result_error_code,c._sqlite3_user_data=e.sqlite3_user_data,c._sqlite3_context_db_handle=e.sqlite3_context_db_handle,c._sqlite3_vtab_nochange=e.sqlite3_vtab_nochange,c._sqlite3_vtab_in_first=e.sqlite3_vtab_in_first,c._sqlite3_vtab_in_next=e.sqlite3_vtab_in_next,c._sqlite3_aggregate_context=e.sqlite3_aggregate_context,c._sqlite3_get_auxdata=e.sqlite3_get_auxdata,c._sqlite3_set_auxdata=e.sqlite3_set_auxdata,c._sqlite3_column_count=e.sqlite3_column_count,c._sqlite3_data_count=e.sqlite3_data_count,c._sqlite3_column_blob=e.sqlite3_column_blob,c._sqlite3_column_bytes=e.sqlite3_column_bytes,c._sqlite3_column_double=e.sqlite3_column_double,c._sqlite3_column_value=e.sqlite3_column_value,c._sqlite3_column_decltype=e.sqlite3_column_decltype,c._sqlite3_column_database_name=e.sqlite3_column_database_name,c._sqlite3_column_table_name=e.sqlite3_column_table_name,c._sqlite3_column_origin_name=e.sqlite3_column_origin_name,c._sqlite3_bind_blob=e.sqlite3_bind_blob,c._sqlite3_bind_double=e.sqlite3_bind_double,c._sqlite3_bind_int=e.sqlite3_bind_int,c._sqlite3_bind_int64=e.sqlite3_bind_int64,c._sqlite3_bind_null=e.sqlite3_bind_null,c._sqlite3_bind_pointer=e.sqlite3_bind_pointer,c._sqlite3_bind_text=e.sqlite3_bind_text,c._sqlite3_bind_parameter_count=e.sqlite3_bind_parameter_count,c._sqlite3_bind_parameter_name=e.sqlite3_bind_parameter_name,c._sqlite3_bind_parameter_index=e.sqlite3_bind_parameter_index,c._sqlite3_db_handle=e.sqlite3_db_handle,c._sqlite3_stmt_readonly=e.sqlite3_stmt_readonly,c._sqlite3_stmt_isexplain=e.sqlite3_stmt_isexplain,c._sqlite3_stmt_explain=e.sqlite3_stmt_explain,c._sqlite3_stmt_busy=e.sqlite3_stmt_busy,c._sqlite3_next_stmt=e.sqlite3_next_stmt,c._sqlite3_stmt_status=e.sqlite3_stmt_status,c._sqlite3_sql=e.sqlite3_sql,c._sqlite3_expanded_sql=e.sqlite3_expanded_sql,c._sqlite3_preupdate_old=e.sqlite3_preupdate_old,c._sqlite3_preupdate_count=e.sqlite3_preupdate_count,c._sqlite3_preupdate_depth=e.sqlite3_preupdate_depth,c._sqlite3_preupdate_blobwrite=e.sqlite3_preupdate_blobwrite,c._sqlite3_preupdate_new=e.sqlite3_preupdate_new,c._sqlite3_value_numeric_type=e.sqlite3_value_numeric_type,c._sqlite3_set_authorizer=e.sqlite3_set_authorizer,c._sqlite3_strglob=e.sqlite3_strglob,c._sqlite3_strlike=e.sqlite3_strlike,c._sqlite3_auto_extension=e.sqlite3_auto_extension,c._sqlite3_cancel_auto_extension=e.sqlite3_cancel_auto_extension,c._sqlite3_reset_auto_extension=e.sqlite3_reset_auto_extension,c._sqlite3_prepare_v3=e.sqlite3_prepare_v3,c._sqlite3_create_module=e.sqlite3_create_module,c._sqlite3_create_module_v2=e.sqlite3_create_module_v2,c._sqlite3_drop_modules=e.sqlite3_drop_modules,c._sqlite3_declare_vtab=e.sqlite3_declare_vtab,c._sqlite3_vtab_on_conflict=e.sqlite3_vtab_on_conflict,c._sqlite3_vtab_collation=e.sqlite3_vtab_collation,c._sqlite3_vtab_in=e.sqlite3_vtab_in,c._sqlite3_vtab_rhs_value=e.sqlite3_vtab_rhs_value,c._sqlite3_vtab_distinct=e.sqlite3_vtab_distinct,c._sqlite3_keyword_name=e.sqlite3_keyword_name,c._sqlite3_keyword_count=e.sqlite3_keyword_count,c._sqlite3_keyword_check=e.sqlite3_keyword_check,c._sqlite3_complete=e.sqlite3_complete,c._sqlite3_libversion=e.sqlite3_libversion,c._sqlite3_libversion_number=e.sqlite3_libversion_number,c._sqlite3_shutdown=e.sqlite3_shutdown,c._sqlite3_last_insert_rowid=e.sqlite3_last_insert_rowid,c._sqlite3_set_last_insert_rowid=e.sqlite3_set_last_insert_rowid,c._sqlite3_changes64=e.sqlite3_changes64,c._sqlite3_changes=e.sqlite3_changes,c._sqlite3_total_changes64=e.sqlite3_total_changes64,c._sqlite3_total_changes=e.sqlite3_total_changes,c._sqlite3_txn_state=e.sqlite3_txn_state,c._sqlite3_close_v2=e.sqlite3_close_v2,c._sqlite3_busy_handler=e.sqlite3_busy_handler,c._sqlite3_progress_handler=e.sqlite3_progress_handler,c._sqlite3_busy_timeout=e.sqlite3_busy_timeout,c._sqlite3_interrupt=e.sqlite3_interrupt,c._sqlite3_is_interrupted=e.sqlite3_is_interrupted,c._sqlite3_create_function=e.sqlite3_create_function,c._sqlite3_create_function_v2=e.sqlite3_create_function_v2,c._sqlite3_create_window_function=e.sqlite3_create_window_function,c._sqlite3_overload_function=e.sqlite3_overload_function,c._sqlite3_trace_v2=e.sqlite3_trace_v2,c._sqlite3_commit_hook=e.sqlite3_commit_hook,c._sqlite3_update_hook=e.sqlite3_update_hook,c._sqlite3_rollback_hook=e.sqlite3_rollback_hook,c._sqlite3_preupdate_hook=e.sqlite3_preupdate_hook,c._sqlite3_set_errmsg=e.sqlite3_set_errmsg,c._sqlite3_error_offset=e.sqlite3_error_offset,c._sqlite3_errcode=e.sqlite3_errcode,c._sqlite3_extended_errcode=e.sqlite3_extended_errcode,c._sqlite3_errstr=e.sqlite3_errstr,c._sqlite3_limit=e.sqlite3_limit,c._sqlite3_open=e.sqlite3_open,c._sqlite3_open_v2=e.sqlite3_open_v2,c._sqlite3_create_collation=e.sqlite3_create_collation,c._sqlite3_create_collation_v2=e.sqlite3_create_collation_v2,c._sqlite3_collation_needed=e.sqlite3_collation_needed,c._sqlite3_get_autocommit=e.sqlite3_get_autocommit,c._sqlite3_table_column_metadata=e.sqlite3_table_column_metadata,c._sqlite3_extended_result_codes=e.sqlite3_extended_result_codes,c._sqlite3_uri_key=e.sqlite3_uri_key,c._sqlite3_uri_int64=e.sqlite3_uri_int64,c._sqlite3_db_name=e.sqlite3_db_name,c._sqlite3_db_filename=e.sqlite3_db_filename,c._sqlite3_db_readonly=e.sqlite3_db_readonly,c._sqlite3_compileoption_used=e.sqlite3_compileoption_used,c._sqlite3_compileoption_get=e.sqlite3_compileoption_get,c._sqlite3session_diff=e.sqlite3session_diff,c._sqlite3session_attach=e.sqlite3session_attach,c._sqlite3session_create=e.sqlite3session_create,c._sqlite3session_delete=e.sqlite3session_delete,c._sqlite3session_table_filter=e.sqlite3session_table_filter,c._sqlite3session_changeset=e.sqlite3session_changeset,c._sqlite3session_changeset_strm=e.sqlite3session_changeset_strm,c._sqlite3session_patchset_strm=e.sqlite3session_patchset_strm,c._sqlite3session_patchset=e.sqlite3session_patchset,c._sqlite3session_enable=e.sqlite3session_enable,c._sqlite3session_indirect=e.sqlite3session_indirect,c._sqlite3session_isempty=e.sqlite3session_isempty,c._sqlite3session_memory_used=e.sqlite3session_memory_used,c._sqlite3session_object_config=e.sqlite3session_object_config,c._sqlite3session_changeset_size=e.sqlite3session_changeset_size,c._sqlite3changeset_start=e.sqlite3changeset_start,c._sqlite3changeset_start_v2=e.sqlite3changeset_start_v2,c._sqlite3changeset_start_strm=e.sqlite3changeset_start_strm,c._sqlite3changeset_start_v2_strm=e.sqlite3changeset_start_v2_strm,c._sqlite3changeset_next=e.sqlite3changeset_next,c._sqlite3changeset_op=e.sqlite3changeset_op,c._sqlite3changeset_pk=e.sqlite3changeset_pk,c._sqlite3changeset_old=e.sqlite3changeset_old,c._sqlite3changeset_new=e.sqlite3changeset_new,c._sqlite3changeset_conflict=e.sqlite3changeset_conflict,c._sqlite3changeset_fk_conflicts=e.sqlite3changeset_fk_conflicts,c._sqlite3changeset_finalize=e.sqlite3changeset_finalize,c._sqlite3changeset_invert=e.sqlite3changeset_invert,c._sqlite3changeset_invert_strm=e.sqlite3changeset_invert_strm,c._sqlite3changeset_apply_v2=e.sqlite3changeset_apply_v2,c._sqlite3changeset_apply_v3=e.sqlite3changeset_apply_v3,c._sqlite3changeset_apply=e.sqlite3changeset_apply,c._sqlite3changeset_apply_v3_strm=e.sqlite3changeset_apply_v3_strm,c._sqlite3changeset_apply_v2_strm=e.sqlite3changeset_apply_v2_strm,c._sqlite3changeset_apply_strm=e.sqlite3changeset_apply_strm,c._sqlite3changegroup_new=e.sqlite3changegroup_new,c._sqlite3changegroup_add=e.sqlite3changegroup_add,c._sqlite3changegroup_output=e.sqlite3changegroup_output,c._sqlite3changegroup_add_strm=e.sqlite3changegroup_add_strm,c._sqlite3changegroup_output_strm=e.sqlite3changegroup_output_strm,c._sqlite3changegroup_delete=e.sqlite3changegroup_delete,c._sqlite3changeset_concat=e.sqlite3changeset_concat,c._sqlite3changeset_concat_strm=e.sqlite3changeset_concat_strm,c._sqlite3session_config=e.sqlite3session_config,c._sqlite3_sourceid=e.sqlite3_sourceid,c._sqlite3__wasm_pstack_ptr=e.sqlite3__wasm_pstack_ptr,c._sqlite3__wasm_pstack_restore=e.sqlite3__wasm_pstack_restore,c._sqlite3__wasm_pstack_alloc=e.sqlite3__wasm_pstack_alloc,c._sqlite3__wasm_pstack_remaining=e.sqlite3__wasm_pstack_remaining,c._sqlite3__wasm_pstack_quota=e.sqlite3__wasm_pstack_quota,c._sqlite3__wasm_test_struct=e.sqlite3__wasm_test_struct,c._sqlite3__wasm_enum_json=e.sqlite3__wasm_enum_json,c._sqlite3__wasm_vfs_unlink=e.sqlite3__wasm_vfs_unlink,c._sqlite3__wasm_db_vfs=e.sqlite3__wasm_db_vfs,c._sqlite3__wasm_db_reset=e.sqlite3__wasm_db_reset,c._sqlite3__wasm_db_export_chunked=e.sqlite3__wasm_db_export_chunked,c._sqlite3__wasm_db_serialize=e.sqlite3__wasm_db_serialize,c._sqlite3__wasm_vfs_create_file=e.sqlite3__wasm_vfs_create_file,c._sqlite3__wasm_posix_create_file=e.sqlite3__wasm_posix_create_file,c._sqlite3__wasm_kvvfsMakeKey=e.sqlite3__wasm_kvvfsMakeKey,c._sqlite3__wasm_kvvfs_methods=e.sqlite3__wasm_kvvfs_methods,c._sqlite3__wasm_vtab_config=e.sqlite3__wasm_vtab_config,c._sqlite3__wasm_db_config_ip=e.sqlite3__wasm_db_config_ip,c._sqlite3__wasm_db_config_pii=e.sqlite3__wasm_db_config_pii,c._sqlite3__wasm_db_config_s=e.sqlite3__wasm_db_config_s,c._sqlite3__wasm_config_i=e.sqlite3__wasm_config_i,c._sqlite3__wasm_config_ii=e.sqlite3__wasm_config_ii,c._sqlite3__wasm_config_j=e.sqlite3__wasm_config_j,c._sqlite3__wasm_qfmt_token=e.sqlite3__wasm_qfmt_token,c._sqlite3__wasm_kvvfs_decode=e.sqlite3__wasm_kvvfs_decode,c._sqlite3__wasm_kvvfs_encode=e.sqlite3__wasm_kvvfs_encode,c._sqlite3__wasm_init_wasmfs=e.sqlite3__wasm_init_wasmfs,c._sqlite3__wasm_test_intptr=e.sqlite3__wasm_test_intptr,c._sqlite3__wasm_test_voidptr=e.sqlite3__wasm_test_voidptr,c._sqlite3__wasm_test_int64_max=e.sqlite3__wasm_test_int64_max,c._sqlite3__wasm_test_int64_min=e.sqlite3__wasm_test_int64_min,c._sqlite3__wasm_test_int64_times2=e.sqlite3__wasm_test_int64_times2,c._sqlite3__wasm_test_int64_minmax=e.sqlite3__wasm_test_int64_minmax,c._sqlite3__wasm_test_int64ptr=e.sqlite3__wasm_test_int64ptr,c._sqlite3__wasm_test_stack_overflow=e.sqlite3__wasm_test_stack_overflow,c._sqlite3__wasm_test_str_hello=e.sqlite3__wasm_test_str_hello,c._sqlite3__wasm_SQLTester_strglob=e.sqlite3__wasm_SQLTester_strglob,c._malloc=e.malloc,c._free=e.free,c._realloc=e.realloc,tn=e.emscripten_builtin_memalign,e._emscripten_stack_restore,e._emscripten_stack_alloc,e.emscripten_stack_get_current,e.__indirect_function_table}var nn={__syscall_chmod:zn,__syscall_faccessat:Bn,__syscall_fchmod:Un,__syscall_fchown32:Wn,__syscall_fcntl64:Qn,__syscall_fstat64:Vn,__syscall_ftruncate64:$n,__syscall_getcwd:Kn,__syscall_ioctl:Jn,__syscall_lstat64:Xn,__syscall_mkdirat:Yn,__syscall_newfstatat:Zn,__syscall_openat:er,__syscall_readlinkat:tr,__syscall_rmdir:nr,__syscall_stat64:rr,__syscall_unlinkat:ir,__syscall_utimensat:sr,_localtime_js:ur,_mmap_js:_r,_munmap_js:fr,_tzset_js:dr,clock_time_get:hr,emscripten_date_now:Zt,emscripten_get_heap_max:mr,emscripten_get_now:Yt,emscripten_resize_heap:br,environ_get:qr,environ_sizes_get:vr,fd_close:Er,fd_fdstat_get:Sr,fd_read:Ir,fd_seek:Ar,fd_sync:Tr,fd_write:Or,memory:et};function Rt(){if(at>0){yt=Rt;return}if(gn(),at>0){yt=Rt;return}function e(){c.calledRun=!0,!ut&&(bn(),wt?.(c),c.onRuntimeInitialized?.(),yn())}c.setStatus?(c.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>c.setStatus(""),1),e()},1)):e()}var dt=await An();return Rt(),c.runSQLite3PostLoadInit=async function(e,t,o){delete t.runSQLite3PostLoadInit,globalThis.sqlite3ApiBootstrap=async function s(n=globalThis.sqlite3ApiConfig||s.defaultConfig){if(s.sqlite3)return(s.sqlite3.config||console).warn("sqlite3ApiBootstrap() called multiple times.","Config and external initializers are ignored on calls after the first."),s.sqlite3;const i=Object.assign(Object.create(null),{exports:void 0,memory:void 0,bigIntEnabled:!!globalThis.BigInt64Array,debug:console.debug.bind(console),warn:console.warn.bind(console),error:console.error.bind(console),log:console.log.bind(console),wasmfsOpfsDir:"/opfs",useStdAlloc:!1},n||{});Object.assign(i,{allocExportName:i.useStdAlloc?"malloc":"sqlite3_malloc",deallocExportName:i.useStdAlloc?"free":"sqlite3_free",reallocExportName:i.useStdAlloc?"realloc":"sqlite3_realloc"}),["exports","memory","functionTable","wasmfsOpfsDir"].forEach(f=>{typeof i[f]=="function"&&(i[f]=i[f]())});const r=Object.create(null),u=Object.create(null),F=f=>r.sqlite3_js_rc_str&&r.sqlite3_js_rc_str(f)||"Unknown result code #"+f,T=f=>typeof f=="number"&&f===(f|0)&&f<=2147483647&&f>=-2147483648;class J extends Error{constructor(...m){let q;if(m.length)if(T(m[0]))if(q=m[0],m.length===1)super(F(m[0]));else{const j=F(q);typeof m[1]=="object"?super(j,m[1]):(m[0]=j+":",super(m.join(" ")))}else m.length===2&&typeof m[1]=="object"?super(...m):super(m.join(" "));this.resultCode=q||r.SQLITE_ERROR,this.name="SQLite3Error"}}J.toss=(...f)=>{throw new J(...f)};const N=J.toss;i.wasmfsOpfsDir&&!/^\/[^/]+$/.test(i.wasmfsOpfsDir)&&N("config.wasmfsOpfsDir must be falsy or in the form '/dir-name'.");const G=function f(m){return f._max||(f._max=BigInt("0x7fffffffffffffff"),f._min=~f._max),m>=f._min&&m<=f._max},p=f=>f>=-2147483647n-1n&&f<=2147483647n,z=function f(m){return f._min||(f._min=Number.MIN_SAFE_INTEGER,f._max=Number.MAX_SAFE_INTEGER),m>=f._min&&m<=f._max},C=f=>f&&f.constructor&&T(f.constructor.BYTES_PER_ELEMENT)?f:!1,te=f=>f&&(f instanceof Uint8Array||f instanceof Int8Array||f instanceof ArrayBuffer),y=f=>f&&(f instanceof Uint8Array||f instanceof Int8Array||f instanceof ArrayBuffer),b=f=>te(f)||N("Value is not of a supported TypedArray type."),R=function(f){return y(f)?u.typedArrayToString(f instanceof ArrayBuffer?new Uint8Array(f):f,0,f.length):Array.isArray(f)?f.join(""):(u.isPtr(f)&&(f=u.cstrToJs(f)),f)};class U extends Error{constructor(...m){m.length===2&&typeof m[1]=="object"?super(...m):m.length?super(m.join(" ")):super("Allocation failed."),this.resultCode=r.SQLITE_NOMEM,this.name="WasmAllocError"}}U.toss=(...f)=>{throw new U(...f)},Object.assign(r,{sqlite3_bind_blob:void 0,sqlite3_bind_text:void 0,sqlite3_create_function_v2:(f,m,q,j,Y,ae,ye,ve,de)=>{},sqlite3_create_function:(f,m,q,j,Y,ae,ye,ve)=>{},sqlite3_create_window_function:(f,m,q,j,Y,ae,ye,ve,de,V)=>{},sqlite3_prepare_v3:(f,m,q,j,Y,ae)=>{},sqlite3_prepare_v2:(f,m,q,j,Y)=>{},sqlite3_exec:(f,m,q,j,Y)=>{},sqlite3_randomness:(f,m)=>{}});const w={affirmBindableTypedArray:b,flexibleString:R,bigIntFits32:p,bigIntFits64:G,bigIntFitsDouble:z,isBindableTypedArray:te,isInt32:T,isSQLableTypedArray:y,isTypedArray:C,isUIThread:()=>globalThis.window===globalThis&&!!globalThis.document,toss:function(...f){throw new Error(f.join(" "))},toss3:N,typedArrayPart:u.typedArrayPart,assert:function(f,m){f||w.toss("Assertion failed:",m)},affirmDbHeader:function(f){f instanceof ArrayBuffer&&(f=new Uint8Array(f));const m="SQLite format 3";15>f.byteLength&&N("Input does not contain an SQLite3 database header.");for(let q=0;q<15;++q)m.charCodeAt(q)!==f[q]&&N("Input does not contain an SQLite3 database header.")},affirmIsDb:function(f){f instanceof ArrayBuffer&&(f=new Uint8Array(f));const m=f.byteLength;(m<512||m%512!==0)&&N("Byte array size",m,"is invalid for an SQLite3 db."),w.affirmDbHeader(f)}};Object.assign(u,{exports:i.exports||N("Missing API config.exports (WASM module exports)."),memory:i.memory||i.exports.memory||N("API config object requires a WebAssembly.Memory object","in either config.exports.memory (exported)","or config.memory (imported)."),pointerSize:typeof i.exports.sqlite3_libversion()=="number"?4:8,bigIntEnabled:!!i.bigIntEnabled,functionTable:i.functionTable,alloc:void 0,realloc:void 0,dealloc:void 0}),u.allocFromTypedArray=function(f){f instanceof ArrayBuffer&&(f=new Uint8Array(f)),b(f);const m=u.alloc(f.byteLength||1);return u.heapForSize(f.constructor).set(f.byteLength?f:[0],Number(m)),m};{const f=i.allocExportName,m=i.deallocExportName,q=i.reallocExportName;for(const j of[f,m,q])u.exports[j]instanceof Function||N("Missing required exports[",j,"] function.");u.alloc=function j(Y){return j.impl(Y)||U.toss("Failed to allocate",Y," bytes.")},u.alloc.impl=u.exports[f],u.realloc=function j(Y,ae){const ye=j.impl(u.ptr.coerce(Y),ae);return ae?ye||U.toss("Failed to reallocate",ae," bytes."):u.ptr.null},u.realloc.impl=u.exports[q],u.dealloc=function j(Y){j.impl(u.ptr.coerce(Y))},u.dealloc.impl=u.exports[m]}u.compileOptionUsed=function f(m){if(arguments.length){if(Array.isArray(m)){const q=Object.create(null);return m.forEach(j=>{q[j]=r.sqlite3_compileoption_used(j)}),q}else if(typeof m=="object")return Object.keys(m).forEach(q=>{m[q]=r.sqlite3_compileoption_used(q)}),m}else{if(f._result)return f._result;f._opt||(f._rx=/^([^=]+)=(.+)/,f._rxInt=/^-?\d+$/,f._opt=function(ye,ve){const de=f._rx.exec(ye);ve[0]=de?de[1]:ye,ve[1]=de?f._rxInt.test(de[2])?+de[2]:de[2]:!0});const q=Object.create(null),j=[0,0];let Y=0,ae;for(;ae=r.sqlite3_compileoption_get(Y++);)f._opt(ae,j),q[j[0]]=j[1];return f._result=q}return typeof m=="string"?!!r.sqlite3_compileoption_used(m):!1},u.pstack=Object.assign(Object.create(null),{restore:u.exports.sqlite3__wasm_pstack_restore,alloc:function(f){return typeof f=="string"&&!(f=u.sizeofIR(f))&&U.toss("Invalid value for pstack.alloc(",arguments[0],")"),u.exports.sqlite3__wasm_pstack_alloc(f)||U.toss("Could not allocate",f,"bytes from the pstack.")},allocChunks:function(f,m){typeof m=="string"&&!(m=u.sizeofIR(m))&&U.toss("Invalid size value for allocChunks(",arguments[1],")");const q=u.pstack.alloc(f*m),j=[q];let Y=1,ae=m;for(;Y<f;++Y,ae+=m)j.push(u.ptr.add(q,ae));return j},allocPtr:(f=1,m=!0)=>f===1?u.pstack.alloc(m?8:u.ptr.size):u.pstack.allocChunks(f,m?8:u.ptr.size),call:function(f){const m=u.pstack.pointer;try{return f(O)}finally{u.pstack.restore(m)}}}),Object.defineProperties(u.pstack,{pointer:{configurable:!1,iterable:!0,writeable:!1,get:u.exports.sqlite3__wasm_pstack_ptr},quota:{configurable:!1,iterable:!0,writeable:!1,get:u.exports.sqlite3__wasm_pstack_quota},remaining:{configurable:!1,iterable:!0,writeable:!1,get:u.exports.sqlite3__wasm_pstack_remaining}}),r.sqlite3_randomness=(...f)=>{if(f.length===1&&w.isTypedArray(f[0])&&f[0].BYTES_PER_ELEMENT===1){const m=f[0];if(m.byteLength===0)return u.exports.sqlite3_randomness(0,u.ptr.null),m;const q=u.pstack.pointer;try{let j=m.byteLength,Y=0;const ae=u.exports.sqlite3_randomness,ye=u.heap8u(),ve=j<512?j:512,de=u.pstack.alloc(ve);do{const V=j>ve?ve:j;ae(V,de),m.set(u.typedArrayPart(ye,de,u.ptr.add(de,V)),Y),j-=V,Y+=V}while(j>0)}catch(j){i.error("Highly unexpected (and ignored!) exception in sqlite3_randomness():",j)}finally{u.pstack.restore(q)}return m}u.exports.sqlite3_randomness(...f)},r.sqlite3_wasmfs_opfs_dir=(function(){if(this.dir!==void 0)return this.dir;const f=i.wasmfsOpfsDir;if(!f||!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle||!u.exports.sqlite3__wasm_init_wasmfs)return this.dir="";try{return f&&u.xCallWrapped("sqlite3__wasm_init_wasmfs","i32",["string"],f)===0?this.dir=f:this.dir=""}catch{return this.dir=""}}).bind(Object.create(null)),r.sqlite3_wasmfs_filename_is_persistent=function(f){const m=r.sqlite3_wasmfs_opfs_dir();return m&&f?f.startsWith(m+"/"):!1},r.sqlite3_js_db_uses_vfs=function(f,m,q=0){try{const j=r.sqlite3_vfs_find(m);return j?f?j===r.sqlite3_js_db_vfs(f,q)?j:!1:j===r.sqlite3_vfs_find(0)?j:!1:!1}catch{return!1}},r.sqlite3_js_vfs_list=function(){const f=[];let m=r.sqlite3_vfs_find(u.ptr.null);for(;m;){const q=new r.sqlite3_vfs(m);f.push(u.cstrToJs(q.$zName)),m=q.$pNext,q.dispose()}return f},r.sqlite3_js_db_export=function(f,m=0){f=u.xWrap.testConvertArg("sqlite3*",f),f||N("Invalid sqlite3* argument."),u.bigIntEnabled||N("BigInt support is not enabled.");const q=u.scopedAllocPush();let j;try{const Y=u.scopedAlloc(8+u.ptr.size),ae=u.ptr.add(Y,8),ye=m?u.isPtr(m)?m:u.scopedAllocCString(""+m):u.ptr.null;let ve=u.exports.sqlite3__wasm_db_serialize(f,ye,ae,Y,0);ve&&N("Database serialization failed with code",O.capi.sqlite3_js_rc_str(ve)),j=u.peekPtr(ae);const de=u.peek(Y,"i64");return ve=de?u.heap8u().slice(Number(j),Number(j)+Number(de)):new Uint8Array,ve}finally{j&&u.exports.sqlite3_free(j),u.scopedAllocPop(q)}},r.sqlite3_js_db_vfs=(f,m=u.ptr.null)=>w.sqlite3__wasm_db_vfs(f,m),r.sqlite3_js_aggregate_context=(f,m)=>r.sqlite3_aggregate_context(f,m)||(m?U.toss("Cannot allocate",m,"bytes for sqlite3_aggregate_context()"):0),r.sqlite3_js_posix_create_file=function(f,m,q){let j;m&&u.isPtr(m)?j=m:m instanceof ArrayBuffer||m instanceof Uint8Array?(j=u.allocFromTypedArray(m),(arguments.length<3||!w.isInt32(q)||q<0)&&(q=m.byteLength)):J.toss("Invalid 2nd argument for sqlite3_js_posix_create_file().");try{(!w.isInt32(q)||q<0)&&J.toss("Invalid 3rd argument for sqlite3_js_posix_create_file().");const Y=w.sqlite3__wasm_posix_create_file(f,j,q);Y&&J.toss("Creation of file failed with sqlite3 result code",r.sqlite3_js_rc_str(Y))}finally{j&&j!==m&&u.dealloc(j)}},r.sqlite3_js_vfs_create_file=function(f,m,q,j){i.warn("sqlite3_js_vfs_create_file() is deprecated and","should be avoided because it can lead to C-level crashes.","See its documentation for alternatives.");let Y;q?u.isPtr(q)?Y=q:(q instanceof ArrayBuffer&&(q=new Uint8Array(q)),q instanceof Uint8Array?(Y=u.allocFromTypedArray(q),(arguments.length<4||!w.isInt32(j)||j<0)&&(j=q.byteLength)):J.toss("Invalid 3rd argument type for sqlite3_js_vfs_create_file().")):Y=0,(!w.isInt32(j)||j<0)&&(Y&&Y!==q&&u.dealloc(Y),J.toss("Invalid 4th argument for sqlite3_js_vfs_create_file()."));try{const ae=w.sqlite3__wasm_vfs_create_file(f,m,Y,j);ae&&J.toss("Creation of file failed with sqlite3 result code",r.sqlite3_js_rc_str(ae))}finally{Y&&Y!==q&&u.dealloc(Y)}},r.sqlite3_js_sql_to_string=f=>{if(typeof f=="string")return f;const m=R(v);return m===v?void 0:m},r.sqlite3_db_config=(function(f,m,...q){switch(m){case r.SQLITE_DBCONFIG_ENABLE_FKEY:case r.SQLITE_DBCONFIG_ENABLE_TRIGGER:case r.SQLITE_DBCONFIG_ENABLE_FTS3_TOKENIZER:case r.SQLITE_DBCONFIG_ENABLE_LOAD_EXTENSION:case r.SQLITE_DBCONFIG_NO_CKPT_ON_CLOSE:case r.SQLITE_DBCONFIG_ENABLE_QPSG:case r.SQLITE_DBCONFIG_TRIGGER_EQP:case r.SQLITE_DBCONFIG_RESET_DATABASE:case r.SQLITE_DBCONFIG_DEFENSIVE:case r.SQLITE_DBCONFIG_WRITABLE_SCHEMA:case r.SQLITE_DBCONFIG_LEGACY_ALTER_TABLE:case r.SQLITE_DBCONFIG_DQS_DML:case r.SQLITE_DBCONFIG_DQS_DDL:case r.SQLITE_DBCONFIG_ENABLE_VIEW:case r.SQLITE_DBCONFIG_LEGACY_FILE_FORMAT:case r.SQLITE_DBCONFIG_TRUSTED_SCHEMA:case r.SQLITE_DBCONFIG_STMT_SCANSTATUS:case r.SQLITE_DBCONFIG_REVERSE_SCANORDER:case r.SQLITE_DBCONFIG_ENABLE_ATTACH_CREATE:case r.SQLITE_DBCONFIG_ENABLE_ATTACH_WRITE:case r.SQLITE_DBCONFIG_ENABLE_COMMENTS:return this.ip||(this.ip=u.xWrap("sqlite3__wasm_db_config_ip","int",["sqlite3*","int","int","*"])),this.ip(f,m,q[0],q[1]||0);case r.SQLITE_DBCONFIG_LOOKASIDE:return this.pii||(this.pii=u.xWrap("sqlite3__wasm_db_config_pii","int",["sqlite3*","int","*","int","int"])),this.pii(f,m,q[0],q[1],q[2]);case r.SQLITE_DBCONFIG_MAINDBNAME:return this.s||(this.s=u.xWrap("sqlite3__wasm_db_config_s","int",["sqlite3*","int","string:static"])),this.s(f,m,q[0]);default:return r.SQLITE_MISUSE}}).bind(Object.create(null)),r.sqlite3_value_to_js=function(f,m=!0){let q;const j=r.sqlite3_value_type(f);switch(j){case r.SQLITE_INTEGER:u.bigIntEnabled?(q=r.sqlite3_value_int64(f),w.bigIntFitsDouble(q)&&(q=Number(q))):q=r.sqlite3_value_double(f);break;case r.SQLITE_FLOAT:q=r.sqlite3_value_double(f);break;case r.SQLITE_TEXT:q=r.sqlite3_value_text(f);break;case r.SQLITE_BLOB:{const Y=r.sqlite3_value_bytes(f),ae=r.sqlite3_value_blob(f);Y&&!ae&&O.WasmAllocError.toss("Cannot allocate memory for blob argument of",Y,"byte(s)"),q=Y?u.heap8u().slice(Number(ae),Number(ae)+Number(Y)):null;break}case r.SQLITE_NULL:q=null;break;default:m&&N(r.SQLITE_MISMATCH,"Unhandled sqlite3_value_type():",j),q=void 0}return q},r.sqlite3_values_to_js=function(f,m,q=!0){let j;const Y=[];for(j=0;j<f;++j)Y.push(r.sqlite3_value_to_js(u.peekPtr(u.ptr.add(m,u.ptr.size*j)),q));return Y},r.sqlite3_result_error_js=function(f,m){m instanceof U?r.sqlite3_result_error_nomem(f):r.sqlite3_result_error(f,""+m,-1)},r.sqlite3_result_js=function(f,m){if(m instanceof Error){r.sqlite3_result_error_js(f,m);return}try{switch(typeof m){case"undefined":break;case"boolean":r.sqlite3_result_int(f,m?1:0);break;case"bigint":w.bigIntFits32(m)?r.sqlite3_result_int(f,Number(m)):w.bigIntFitsDouble(m)?r.sqlite3_result_double(f,Number(m)):u.bigIntEnabled?w.bigIntFits64(m)?r.sqlite3_result_int64(f,m):N("BigInt value",m.toString(),"is too BigInt for int64."):N("BigInt value",m.toString(),"is too BigInt.");break;case"number":{let q;w.isInt32(m)?q=r.sqlite3_result_int:u.bigIntEnabled&&Number.isInteger(m)&&w.bigIntFits64(BigInt(m))?q=r.sqlite3_result_int64:q=r.sqlite3_result_double,q(f,m);break}case"string":{const[q,j]=u.allocCString(m,!0);r.sqlite3_result_text(f,q,j,r.SQLITE_WASM_DEALLOC);break}case"object":if(m===null){r.sqlite3_result_null(f);break}else if(w.isBindableTypedArray(m)){const q=u.allocFromTypedArray(m);r.sqlite3_result_blob(f,q,m.byteLength,r.SQLITE_WASM_DEALLOC);break}default:N("Don't not how to handle this UDF result value:",typeof m,m)}}catch(q){r.sqlite3_result_error_js(f,q)}},r.sqlite3_column_js=function(f,m,q=!0){const j=r.sqlite3_column_value(f,m);return j===0?void 0:r.sqlite3_value_to_js(j,q)};{const f=(function(m,q,j){j=r[j],this.ptr?u.pokePtr(this.ptr,0):this.ptr=u.allocPtr();const Y=j(m,q,this.ptr);if(Y)return J.toss(Y,arguments[2]+"() failed with code "+Y);const ae=u.peekPtr(this.ptr);return ae?r.sqlite3_value_to_js(ae,!0):void 0}).bind(Object.create(null));r.sqlite3_preupdate_new_js=(m,q)=>f(m,q,"sqlite3_preupdate_new"),r.sqlite3_preupdate_old_js=(m,q)=>f(m,q,"sqlite3_preupdate_old"),r.sqlite3changeset_new_js=(m,q)=>f(m,q,"sqlite3changeset_new"),r.sqlite3changeset_old_js=(m,q)=>f(m,q,"sqlite3changeset_old")}const O={WasmAllocError:U,SQLite3Error:J,capi:r,util:w,wasm:u,config:i,version:Object.create(null),client:void 0,asyncPostInit:(async function f(){if(f.isReady instanceof Promise)return f.isReady;let m=this.initializersAsync;delete this.initializersAsync;const q=async()=>(O.__isUnderTest||(delete O.util,delete O.StructBinder),O),j=ae=>{throw i.error("an async sqlite3 initializer failed:",ae),ae};if(!m||!m.length)return f.isReady=q().catch(j);m=m.map(ae=>ae instanceof Function?async ye=>ae(O):ae),m.push(q);let Y=Promise.resolve(O);for(;m.length;)Y=Y.then(m.shift());return f.isReady=Y.catch(j)}).bind(s),scriptInfo:void 0};typeof o<"u"&&(O.__isUnderTest=!!o);try{s.initializers.forEach(f=>{f(O)})}catch(f){throw console.error("sqlite3 bootstrap initializer threw:",f),f}if(delete s.initializers,s.sqlite3=O,typeof e<"u"&&(e.debugModule("sqlite3ApiBootstrap() complete",O),O.scriptInfo=e),O.__isUnderTest){typeof t<"u"&&(O.config.emscripten=t);const f=O.scriptInfo?.instantiateWasm;f&&(O.wasm.module=f.module,O.wasm.instance=f.instance,O.wasm.imports=f.imports)}return delete globalThis.sqlite3ApiConfig,delete globalThis.sqlite3ApiBootstrap,delete s.defaultConfig,O.asyncPostInit().then(f=>(typeof e<"u"&&e.debugModule("sqlite3.asyncPostInit() complete",f),delete f.asyncPostInit,delete f.scriptInfo,delete f.emscripten,f))},globalThis.sqlite3ApiBootstrap.initializers=[],globalThis.sqlite3ApiBootstrap.initializersAsync=[],globalThis.sqlite3ApiBootstrap.defaultConfig=Object.create(null),globalThis.sqlite3ApiBootstrap.sqlite3=void 0,globalThis.sqlite3ApiBootstrap.initializers.push(function(s){s.version={libVersion:"3.52.0",libVersionNumber:3052e3,sourceId:"2026-01-30 06:37:34 407724c4e80efdf93d885e95b5209a100a3f470fe0298138be57201f65f9817e",downloadVersion:352e4,scm:{"sha3-256":"407724c4e80efdf93d885e95b5209a100a3f470fe0298138be57201f65f9817e",branch:"trunk",tags:"",datetime:"2026-01-30T06:37:34.096Z"}}}),globalThis.WhWasmUtilInstaller=function(n){n.bigIntEnabled===void 0&&(n.bigIntEnabled=!!globalThis.BigInt64Array);const i=(...a)=>{throw new Error(a.join(" "))};if(!n.pointerSize&&!n.pointerIR&&n.alloc&&n.dealloc){const a=n.alloc(1);n.pointerSize=typeof a=="bigint"?8:4,n.dealloc(a)}n.pointerSize&&!n.pointerIR&&(n.pointerIR=n.pointerSize===4?"i32":"i64");const r=n.pointerIR??="i32",u=n.pointerSize??=r==="i32"?4:r==="i64"?8:0;delete n.pointerSize,delete n.pointerIR,r!=="i32"&&r!=="i64"?i("Invalid pointerIR:",r):u!==8&&u!==4&&i("Invalid pointerSize:",u);const F=n.bigIntEnabled?a=>BigInt(a||0):a=>i("BigInt support is disabled in this build."),J=u===4?a=>Number(a||0):F,N=J(0),G=function(...a){let _=J(0);for(const d of a)_+=J(d);return _};{const a=Object.create(null);Object.defineProperty(n,"ptr",{enumerable:!0,get:()=>a,set:()=>i("The ptr property is read-only.")}),(function _(d,E){return Object.defineProperty(a,d,{enumerable:!0,get:()=>E,set:()=>i("ptr["+d+"] is read-only.")}),_})("null",N)("size",u)("ir",r)("coerce",J)("add",G)("addn",r===4?G:(..._)=>Number(G(..._)))}n.exports||Object.defineProperty(n,"exports",{enumerable:!0,configurable:!0,get:()=>n.instance?.exports});const p=Object.create(null);p.heapSize=0,p.memory=null,p.freeFuncIndexes=[],p.scopedAlloc=[],p.scopedAlloc.pushPtr=a=>(p.scopedAlloc[p.scopedAlloc.length-1].push(a),a),p.utf8Decoder=new TextDecoder,p.utf8Encoder=new TextEncoder("utf-8"),n.sizeofIR=a=>{switch(a){case"i8":return 1;case"i16":return 2;case"i32":case"f32":case"float":return 4;case"i64":case"f64":case"double":return 8;case"*":return u;default:return(""+a).endsWith("*")?u:void 0}};const z=function(){if(!p.memory)p.memory=n.memory instanceof WebAssembly.Memory?n.memory:n.exports.memory;else if(p.heapSize===p.memory.buffer.byteLength)return p;const a=p.memory.buffer;return p.HEAP8=new Int8Array(a),p.HEAP8U=new Uint8Array(a),p.HEAP16=new Int16Array(a),p.HEAP16U=new Uint16Array(a),p.HEAP32=new Int32Array(a),p.HEAP32U=new Uint32Array(a),p.HEAP32F=new Float32Array(a),p.HEAP64F=new Float64Array(a),n.bigIntEnabled&&(typeof BigInt64Array<"u"?(p.HEAP64=new BigInt64Array(a),p.HEAP64U=new BigUint64Array(a)):i("BigInt support is enabled, but the BigInt64Array type is missing.")),p.heapSize=a.byteLength,p};n.heap8=()=>z().HEAP8,n.heap8u=()=>z().HEAP8U,n.heap16=()=>z().HEAP16,n.heap16u=()=>z().HEAP16U,n.heap32=()=>z().HEAP32,n.heap32u=()=>z().HEAP32U,n.heapForSize=function(a,_=!0){const d=p.memory&&p.heapSize===p.memory.buffer.byteLength?p:z();switch(a){case Int8Array:return d.HEAP8;case Uint8Array:return d.HEAP8U;case Int16Array:return d.HEAP16;case Uint16Array:return d.HEAP16U;case Int32Array:return d.HEAP32;case Uint32Array:return d.HEAP32U;case 8:return _?d.HEAP8U:d.HEAP8;case 16:return _?d.HEAP16U:d.HEAP16;case 32:return _?d.HEAP32U:d.HEAP32;case 64:if(d.HEAP64)return _?d.HEAP64U:d.HEAP64;break;default:if(n.bigIntEnabled){if(a===globalThis.BigUint64Array)return d.HEAP64U;if(a===globalThis.BigInt64Array)return d.HEAP64;break}}i("Invalid heapForSize() size: expecting 8, 16, 32,","or (if BigInt is enabled) 64.")};const C=n.functionTable;delete n.functionTable,n.functionTable=C?()=>C:()=>n.exports.__indirect_function_table,n.functionEntry=function(a){const _=n.functionTable();return a<_.length?_.get(J(a)):void 0},n.jsFuncToWasm=function a(_,d){if(a._||(a._={sigTypes:Object.assign(Object.create(null),{i:"i32",p:r,P:r,s:r,j:"i64",f:"f32",d:"f64"}),typeCodes:Object.assign(Object.create(null),{f64:124,f32:125,i64:126,i32:127}),uleb128Encode:(D,h,P)=>{P<128?D[h](P):D[h](P%128|128,P>>7)},rxJSig:/^(\w)\((\w*)\)$/,sigParams:D=>{const h=a._.rxJSig.exec(D);return h?h[2]:D.substr(1)},letterType:D=>a._.sigTypes[D]||i("Invalid signature letter:",D),pushSigType:(D,h)=>D.push(a._.typeCodes[a._.letterType(h)])}),typeof _=="string"){const D=d;d=_,_=D}const E=a._,W=E.sigParams(d),K=[1,96];E.uleb128Encode(K,"push",W.length);for(const D of W)E.pushSigType(K,D);return d[0]==="v"?K.push(0):(K.push(1),E.pushSigType(K,d[0])),E.uleb128Encode(K,"unshift",K.length),K.unshift(0,97,115,109,1,0,0,0,1),K.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array(K)),{e:{f:_}}).exports.f};const te=function(_,d,E){if(E&&!p.scopedAlloc.length&&i("No scopedAllocPush() scope is active."),typeof _=="string"){const h=d;d=_,_=h}(typeof d!="string"||!(_ instanceof Function))&&i("Invalid arguments: expecting (function,signature) or (signature,function).");const W=n.functionTable(),K=J(W.length);let D;for(;(D=p.freeFuncIndexes.pop())&&W.get(D);){D=null;continue}D||(D=J(K),W.grow(J(1)));try{return W.set(D,_),E&&p.scopedAlloc.pushPtr(D),D}catch(h){if(!(h instanceof TypeError))throw D===K&&p.freeFuncIndexes.push(K),h}try{const h=n.jsFuncToWasm(_,d);W.set(D,h),E&&p.scopedAlloc.pushPtr(D)}catch(h){throw D===K&&p.freeFuncIndexes.push(K),h}return D};n.installFunction=(a,_)=>te(a,_,!1),n.scopedInstallFunction=(a,_)=>te(a,_,!0),n.uninstallFunction=function(a){if(!a&&N!==a)return;const _=n.functionTable();p.freeFuncIndexes.push(a);const d=_.get(a);return _.set(a,null),d},n.peek=function(_,d="i8"){d.endsWith("*")&&(d=r);const E=p.memory&&p.heapSize===p.memory.buffer.byteLength?p:z(),W=Array.isArray(_)?[]:void 0;let K;do{switch(W&&(_=arguments[0].shift()),d){case"i1":case"i8":K=E.HEAP8[Number(_)>>0];break;case"i16":K=E.HEAP16[Number(_)>>1];break;case"i32":K=E.HEAP32[Number(_)>>2];break;case"float":case"f32":K=E.HEAP32F[Number(_)>>2];break;case"double":case"f64":K=Number(E.HEAP64F[Number(_)>>3]);break;case"i64":if(E.HEAP64){K=F(E.HEAP64[Number(_)>>3]);break}default:i("Invalid type for peek():",d)}W&&W.push(K)}while(W&&arguments[0].length);return W||K},n.poke=function(a,_,d="i8"){d.endsWith("*")&&(d=r);const E=p.memory&&p.heapSize===p.memory.buffer.byteLength?p:z();for(const W of Array.isArray(a)?a:[a])switch(d){case"i1":case"i8":E.HEAP8[Number(W)>>0]=_;continue;case"i16":E.HEAP16[Number(W)>>1]=_;continue;case"i32":E.HEAP32[Number(W)>>2]=_;continue;case"float":case"f32":E.HEAP32F[Number(W)>>2]=_;continue;case"double":case"f64":E.HEAP64F[Number(W)>>3]=_;continue;case"i64":if(E.HEAP64){E.HEAP64[Number(W)>>3]=F(_);continue}default:i("Invalid type for poke(): "+d)}return this},n.peekPtr=(...a)=>n.peek(a.length===1?a[0]:a,r),n.pokePtr=(a,_=0)=>n.poke(a,_,r),n.peek8=(...a)=>n.peek(a.length===1?a[0]:a,"i8"),n.poke8=(a,_)=>n.poke(a,_,"i8"),n.peek16=(...a)=>n.peek(a.length===1?a[0]:a,"i16"),n.poke16=(a,_)=>n.poke(a,_,"i16"),n.peek32=(...a)=>n.peek(a.length===1?a[0]:a,"i32"),n.poke32=(a,_)=>n.poke(a,_,"i32"),n.peek64=(...a)=>n.peek(a.length===1?a[0]:a,"i64"),n.poke64=(a,_)=>n.poke(a,_,"i64"),n.peek32f=(...a)=>n.peek(a.length===1?a[0]:a,"f32"),n.poke32f=(a,_)=>n.poke(a,_,"f32"),n.peek64f=(...a)=>n.peek(a.length===1?a[0]:a,"f64"),n.poke64f=(a,_)=>n.poke(a,_,"f64"),n.getMemValue=n.peek,n.getPtrValue=n.peekPtr,n.setMemValue=n.poke,n.setPtrValue=n.pokePtr,n.isPtr32=a=>typeof a=="number"&&a>=0&&a===(a|0),n.isPtr64=a=>typeof a=="bigint"?a>=0:n.isPtr32(a),n.isPtr=u===4?n.isPtr32:n.isPtr64,n.cstrlen=function(a){if(!a||!n.isPtr(a))return null;a=Number(a);const _=z().HEAP8U;let d=a;for(;_[d]!==0;++d);return d-a};const y=typeof SharedArrayBuffer>"u"?function(){}:SharedArrayBuffer,b=a=>a.buffer instanceof y;n.isSharedTypedArray=b;const R=(a,_,d)=>(u===8&&(typeof _=="bigint"&&(_=Number(_)),typeof d=="bigint"&&(d=Number(d))),b(a)?a.slice(_,d):a.subarray(_,d));n.typedArrayPart=R;const U=(a,_,d)=>p.utf8Decoder.decode(R(a,_,d));n.typedArrayToString=U,n.cstrToJs=function(a){const _=n.cstrlen(a);return _?U(z().HEAP8U,Number(a),Number(a)+_):_===null?_:""},n.jstrlen=function(a){if(typeof a!="string")return null;const _=a.length;let d=0;for(let E=0;E<_;++E){let W=a.charCodeAt(E);W>=55296&&W<=57343&&(W=65536+((W&1023)<<10)|a.charCodeAt(++E)&1023),W<=127?++d:W<=2047?d+=2:W<=65535?d+=3:d+=4}return d},n.jstrcpy=function(a,_,d=0,E=-1,W=!0){if((!_||!(_ instanceof Int8Array)&&!(_ instanceof Uint8Array))&&i("jstrcpy() target must be an Int8Array or Uint8Array."),E=Number(E),d=Number(d),E<0&&(E=_.length-d),!(E>0)||!(d>=0))return 0;let K=0,D=a.length;const h=d,P=d+E-(W?1:0);for(;K<D&&d<P;++K){let Q=a.charCodeAt(K);if(Q>=55296&&Q<=57343&&(Q=65536+((Q&1023)<<10)|a.charCodeAt(++K)&1023),Q<=127){if(d>=P)break;_[d++]=Q}else if(Q<=2047){if(d+1>=P)break;_[d++]=192|Q>>6,_[d++]=128|Q&63}else if(Q<=65535){if(d+2>=P)break;_[d++]=224|Q>>12,_[d++]=128|Q>>6&63,_[d++]=128|Q&63}else{if(d+3>=P)break;_[d++]=240|Q>>18,_[d++]=128|Q>>12&63,_[d++]=128|Q>>6&63,_[d++]=128|Q&63}}return W&&(_[d++]=0),d-h},n.cstrncpy=function(a,_,d){if((!a||!_)&&i("cstrncpy() does not accept NULL strings."),d<0)d=n.cstrlen(strPtr)+1;else if(!(d>0))return 0;const E=n.heap8u();let W=0,K;const D=Number(a),h=Number(_);for(;W<d&&(K=E[h+W]);++W)E[D+W]=K;return W<d&&(E[D+W++]=0),W},n.jstrToUintArray=(a,_=!1)=>p.utf8Encoder.encode(_?a+"\0":a);const w=(a,_)=>{(!(a.alloc instanceof Function)||!(a.dealloc instanceof Function))&&i("Object is missing alloc() and/or dealloc() function(s)","required by",_+"().")},O=function(a,_,d,E){if(w(n,E),typeof a!="string")return null;const W=p.utf8Encoder.encode(a),K=d(W.length+1);let D=K;try{const h=z().HEAP8U;return h.set(W,Number(K)),h[G(K,W.length)]=0,D=N,_?[K,W.length]:K}finally{D&&n.dealloc(D)}};n.allocCString=(a,_=!1)=>O(a,_,n.alloc,"allocCString()"),n.scopedAllocPush=function(){w(n,"scopedAllocPush");const a=[];return p.scopedAlloc.push(a),a},n.scopedAllocPop=function(a){w(n,"scopedAllocPop");const _=arguments.length?p.scopedAlloc.indexOf(a):p.scopedAlloc.length-1;_<0&&i("Invalid state object for scopedAllocPop()."),arguments.length===0&&(a=p.scopedAlloc[_]),p.scopedAlloc.splice(_,1);for(let d;d=a.pop();)n.functionEntry(d)?n.uninstallFunction(d):n.dealloc(d)},n.scopedAlloc=function(a){p.scopedAlloc.length||i("No scopedAllocPush() scope is active.");const _=J(n.alloc(a));return p.scopedAlloc.pushPtr(_)},Object.defineProperty(n.scopedAlloc,"level",{configurable:!1,enumerable:!1,get:()=>p.scopedAlloc.length,set:()=>i("The 'active' property is read-only.")}),n.scopedAllocCString=(a,_=!1)=>O(a,_,n.scopedAlloc,"scopedAllocCString()");const f=function(a,_){const d=n[a?"scopedAlloc":"alloc"]((_.length+1)*n.ptr.size);let E=0;return _.forEach(W=>{n.pokePtr(G(d,n.ptr.size*E++),n[a?"scopedAllocCString":"allocCString"](""+W))}),n.pokePtr(G(d,n.ptr.size*E),0),d};n.scopedAllocMainArgv=a=>f(!0,a),n.allocMainArgv=a=>f(!1,a),n.cArgvToJs=(a,_)=>{const d=[];for(let E=0;E<a;++E){const W=n.peekPtr(G(_,n.ptr.size*E));d.push(W?n.cstrToJs(W):null)}return d},n.scopedAllocCall=function(a){n.scopedAllocPush();try{return a()}finally{n.scopedAllocPop()}};const m=function(a,_,d){w(n,d);const E=_?"i64":r;let W=n[d](a*(_?8:u));if(n.poke(W,0,E),a===1)return W;const K=[W];for(let D=1;D<a;++D)W=G(W,_?8:u),K[D]=W,n.poke(W,0,E);return K};n.allocPtr=(a=1,_=!0)=>m(a,_,"alloc"),n.scopedAllocPtr=(a=1,_=!0)=>m(a,_,"scopedAlloc"),n.xGet=function(a){return n.exports[a]||i("Cannot find exported symbol:",a)};const q=(a,_)=>i(a+"() requires",_,"argument(s).");n.xCall=function(a,..._){const d=a instanceof Function?a:n.xGet(a);return d instanceof Function||i("Exported symbol",a,"is not a function."),d.length!==_.length&&q(d===a?d.name:a,d.length),arguments.length===2&&Array.isArray(arguments[1])?d.apply(null,arguments[1]):d.apply(null,_)},p.xWrap=Object.create(null),p.xWrap.convert=Object.create(null),p.xWrap.convert.arg=new Map,p.xWrap.convert.result=new Map;const j=p.xWrap.convert.arg,Y=p.xWrap.convert.result,ae=J;j.set("i64",F).set("i32",a=>a|0).set("i16",a=>(a|0)&65535).set("i8",a=>(a|0)&255).set("f32",a=>Number(a).valueOf()).set("float",j.get("f32")).set("f64",j.get("f32")).set("double",j.get("f64")).set("int",j.get("i32")).set("null",a=>a).set(null,j.get("null")).set("**",ae).set("*",ae),Y.set("*",ae).set("pointer",ae).set("number",a=>Number(a)).set("void",a=>{}).set(void 0,Y.get("void")).set("null",a=>a).set(null,Y.get("null"));for(const a of["i8","i16","i32","i64","int","f32","float","f64","double"])j.set(a+"*",ae),Y.set(a+"*",ae),Y.set(a,j.get(a)||i("Maintenance required: missing arg converter for",a));const ye=a=>typeof a=="string"?n.scopedAllocCString(a):J(a);j.set("string",ye).set("utf8",ye),Y.set("string",a=>n.cstrToJs(a)).set("utf8",Y.get("string")).set("string:dealloc",a=>{try{return a?n.cstrToJs(a):null}finally{n.dealloc(a)}}).set("utf8:dealloc",Y.get("string:dealloc")).set("json",a=>JSON.parse(n.cstrToJs(a))).set("json:dealloc",a=>{try{return a?JSON.parse(n.cstrToJs(a)):null}finally{n.dealloc(a)}});const ve=class{constructor(a){this.name=a.name||"unnamed adapter"}convertArg(a,_,d){i("AbstractArgAdapter must be subclassed.")}};j.FuncPtrAdapter=class tt extends ve{constructor(_){super(_),j.FuncPtrAdapter.warnOnUse&&console.warn("xArg.FuncPtrAdapter is an internal-only API","and is not intended to be invoked from","client-level code. Invoked with:",_),this.name=_.name||"unnamed",this.signature=_.signature,_.contextKey instanceof Function&&(this.contextKey=_.contextKey,_.bindScope||(_.bindScope="context")),this.bindScope=_.bindScope||i("FuncPtrAdapter options requires a bindScope (explicit or implied)."),tt.bindScopes.indexOf(_.bindScope)<0&&i("Invalid options.bindScope ("+_.bindMod+") for FuncPtrAdapter. Expecting one of: ("+tt.bindScopes.join(", ")+")"),this.isTransient=this.bindScope==="transient",this.isContext=this.bindScope==="context",this.isPermanent=this.bindScope==="permanent",this.singleton=this.bindScope==="singleton"?[]:void 0,this.callProxy=_.callProxy instanceof Function?_.callProxy:void 0}contextKey(_,d){return this}contextMap(_){const d=this.__cmap||(this.__cmap=new Map);let E=d.get(_);return E===void 0&&d.set(_,E=[]),E}convertArg(_,d,E){let W=this.singleton;if(!W&&this.isContext&&(W=this.contextMap(this.contextKey(d,E))),W&&W.length===2&&W[0]===_)return W[1];if(_ instanceof Function){this.callProxy&&(_=this.callProxy(_));const K=te(_,this.signature,this.isTransient);if(tt.debugFuncInstall&&tt.debugOut("FuncPtrAdapter installed",this,this.contextKey(d,E),"@"+K,_),W){if(W[1]){tt.debugFuncInstall&&tt.debugOut("FuncPtrAdapter uninstalling",this,this.contextKey(d,E),"@"+W[1],_);try{p.scopedAlloc.pushPtr(W[1])}catch{}}W[0]=arguments[0]||N,W[1]=K}return K}else if(n.isPtr(_)||_===null||_===void 0){if(W&&W[1]&&W[1]!==_){tt.debugFuncInstall&&tt.debugOut("FuncPtrAdapter uninstalling",this,this.contextKey(d,E),"@"+W[1],_);try{p.scopedAlloc.pushPtr(W[1])}catch{}W[0]=W[1]=_||N}return _||N}else throw new TypeError("Invalid FuncPtrAdapter argument type. Expecting a function pointer or a "+(this.name?this.name+" ":"")+"function matching signature "+this.signature+".")}},j.FuncPtrAdapter.warnOnUse=!1,j.FuncPtrAdapter.debugFuncInstall=!1,j.FuncPtrAdapter.debugOut=console.debug.bind(console),j.FuncPtrAdapter.bindScopes=["transient","context","singleton","permanent"];const de=a=>j.get(a)||i("Argument adapter not found:",a),V=a=>Y.get(a)||i("Result adapter not found:",a);p.xWrap.convertArg=(a,..._)=>de(a)(..._),p.xWrap.convertArgNoCheck=(a,..._)=>j.get(a)(..._),p.xWrap.convertResult=(a,_)=>a===null?_:a?V(a)(_):void 0,p.xWrap.convertResultNoCheck=(a,_)=>a===null?_:a?Y.get(a)(_):void 0,n.xWrap=function a(_,d,...E){arguments.length===3&&Array.isArray(arguments[2])&&(E=arguments[2]),n.isPtr(_)&&(_=n.functionEntry(_)||i("Function pointer not found in WASM function table."));const W=_ instanceof Function,K=W?_:n.xGet(_);if(W&&(_=K.name||"unnamed function"),E.length!==K.length&&q(_,K.length),K.length===0&&(d===null||d==="null"))return K;V(d);for(const h of E)h instanceof ve?j.set(h,(...P)=>h.convertArg(...P)):de(h);const D=p.xWrap;return K.length===0?(...h)=>h.length?q(_,K.length):D.convertResult(d,K.call(null)):function(...h){h.length!==K.length&&q(_,K.length);const P=n.scopedAllocPush();try{let Q=0;for(a.debug&&console.debug("xWrap() preparing: resultType ",d,"xf",K,"argTypes",E,"args",h);Q<h.length;++Q)h[Q]=D.convertArgNoCheck(E[Q],h[Q],h,Q);return a.debug&&console.debug("xWrap() calling: resultType ",d,"xf",K,"argTypes",E,"args",h),D.convertResultNoCheck(d,K.apply(null,h))}finally{n.scopedAllocPop(P)}}};const I=function(a,_,d,E,W,K){if(typeof d=="string"){if(_===1)return K.get(d);if(_===2){if(E)E instanceof Function||i(W,"requires a function argument.");else return K.delete(d),a;return K.set(d,E),a}}i("Invalid arguments to",W)};return n.xWrap.resultAdapter=function a(_,d){return I(a,arguments.length,_,d,"resultAdapter()",Y)},n.xWrap.argAdapter=function a(_,d){return I(a,arguments.length,_,d,"argAdapter()",j)},n.xWrap.FuncPtrAdapter=j.FuncPtrAdapter,n.xCallWrapped=function(a,_,d,...E){return Array.isArray(arguments[3])&&(E=arguments[3]),n.xWrap(a,_,d||[]).apply(null,E||[])},n.xWrap.testConvertArg=p.xWrap.convertArg,n.xWrap.testConvertResult=p.xWrap.convertResult,n},globalThis.WhWasmUtilInstaller.yawl=(function(n){const i=()=>fetch(n.uri,{credentials:"same-origin"}),r=this,u=function(F){if(n.wasmUtilTarget){const T=(...N)=>{throw new Error(N.join(" "))},J=n.wasmUtilTarget;if(J.module=F.module,J.instance=F.instance,J.instance.exports.memory||(J.memory=n?.imports?.env?.memory||T("Missing 'memory' object!")),!J.alloc&&F.instance.exports.malloc){const N=F.instance.exports;J.alloc=function(G){return N.malloc(G)||T("Allocation of",G,"bytes failed.")},J.dealloc=function(G){G&&N.free(G)}}r(J)}return F.config=n,n.onload&&n.onload(F),F};return WebAssembly.instantiateStreaming?()=>WebAssembly.instantiateStreaming(i(),n.imports||{}).then(u):()=>i().then(F=>F.arrayBuffer()).then(F=>WebAssembly.instantiate(F,n.imports||{})).then(u)}).bind(globalThis.WhWasmUtilInstaller),globalThis.Jaccwabyt=function s(n){const i=(...A)=>{throw new Error(A.join(" "))};{let A=n.heap;A instanceof WebAssembly.Memory?A=(function(){return new Uint8Array(this.buffer)}).bind(A):A instanceof Function||i("config.heap must be WebAssembly.Memory instance or","a function which returns one."),n.heap=A}["alloc","dealloc"].forEach(function(A){n[A]instanceof Function||i("Config option '"+A+"' must be a function.")});const r=s,u=n.heap,F=n.alloc,T=n.dealloc;n.realloc;const J=n.log||console.debug.bind(console),N=n.memberPrefix||"",G=n.memberSuffix||"",p=globalThis.BigInt,z=globalThis.BigInt64Array,C=n.bigIntEnabled??!!z;let te;const y=n.pointerSize||n.ptrSize||(typeof(te=F(1))=="bigint"?8:4),b=n.pointerIR||n.ptrIR||(y===4?"i32":"i64");te&&(T(te),te=void 0),y!==4&&y!==8&&i("Invalid pointer size:",y),b!=="i32"&&b!=="i64"&&i("Invalid pointer representation:",b);const R=C&&p?A=>p(A||0):A=>i("BigInt support is disabled in this build."),U=b=="i32"?Number:R,w=U(0),O=function(...A){let $=w;for(let X=0;X<A.length;++X)$+=U(A[X]);return $},f=function(...A){return O(this.pointer,...A)};r.debugFlags||(r.__makeDebugFlags=function(A=null){A&&A.__flags&&(A=A.__flags);const $=function X(se){return arguments.length===0?X.__flags:(se<0?(delete X.__flags.getter,delete X.__flags.setter,delete X.__flags.alloc,delete X.__flags.dealloc):(X.__flags.getter=(1&se)!==0,X.__flags.setter=(2&se)!==0,X.__flags.alloc=(4&se)!==0,X.__flags.dealloc=(8&se)!==0),X._flags)};return Object.defineProperty($,"__flags",{iterable:!1,writable:!1,value:Object.create(A)}),A||$(0),$},r.debugFlags=r.__makeDebugFlags());const m=!0,q=A=>A[1]==="(",j=A=>A==="p"||A==="P"||A==="s",Y=A=>A==="P",ae=A=>A?q(A)?"p":A[0]:void 0,ye=function(A){switch(ae(A)){case"c":case"C":return"i8";case"i":return"i32";case"p":case"P":case"s":return b;case"j":return"i64";case"f":return"float";case"d":return"double"}i("Unhandled signature IR:",A)},ve=function(A){switch(ae(A)){case"c":case"C":return 1;case"i":return 4;case"p":case"P":case"s":return y;case"j":return 8;case"f":return 4;case"d":return 8}i("Unhandled signature sizeof:",A)},de=z?()=>!0:()=>i("BigInt64Array is not available."),V=function(A){switch(ae(A)){case"p":case"P":case"s":switch(y){case 4:return"getInt32";case 8:return de()&&"getBigInt64"}break;case"i":return"getInt32";case"c":return"getInt8";case"C":return"getUint8";case"j":return de()&&"getBigInt64";case"f":return"getFloat32";case"d":return"getFloat64"}i("Unhandled DataView getter for signature:",A)},I=function(A){switch(ae(A)){case"p":case"P":case"s":switch(y){case 4:return"setInt32";case 8:return de()&&"setBigInt64"}break;case"i":return"setInt32";case"c":return"setInt8";case"C":return"setUint8";case"j":return de()&&"setBigInt64";case"f":return"setFloat32";case"d":return"setFloat64"}i("Unhandled DataView setter for signature:",A)},a=function(A){switch(ae(A)){case"i":case"f":case"c":case"C":case"d":return Number;case"j":return R;case"p":case"P":case"s":switch(y){case 4:return Number;case 8:return R}break}i("Unhandled DataView set wrapper for signature:",A)},_=(A,$)=>A+"::"+$,d=function(A,$){return()=>i(_(A,$),"is read-only.")},E=function A($,X=!0){let se=A.map.get($);return!se&&X&&A.map.set($,se=A.create($)),se};E.map=new WeakMap,E.create=A=>Object.assign(Object.create(null),{o:A,p:void 0,ownsPointer:!1,zod:!1,xb:0});const W=A=>E.map.delete(A),K=A=>typeof A=="number"&&A===(A|0)&&A>=0,h=y===4?K:A=>typeof A=="bigint"&&A>=0||K(A),P=A=>h(A)&&A>0,Q=function(A,$,X){const se=E($,!1);if(se){if(W($),!X&&!(X=se.p)){console.warn("Cannot(?) happen: __freeStruct() found no instanceInfo");return}if(Array.isArray($.ondispose)){let pe;for(;pe=$.ondispose.pop();)try{pe instanceof Function?pe.call($):pe instanceof $e?pe.dispose():h(pe)&&T(pe)}catch(Oe){console.warn("ondispose() for",A.structName,"@",X,"threw. NOT propagating it.",Oe)}}else if($.ondispose instanceof Function)try{$.ondispose()}catch(pe){console.warn("ondispose() for",A.structName,"@",X,"threw. NOT propagating it.",pe)}delete $.ondispose,A.debugFlags.__flags.dealloc&&J("debug.dealloc:",se.ownsPointer?"":"EXTERNAL",A.structName,"instance:",A.structInfo.sizeof,"bytes @"+X),se.ownsPointer&&((se.zod||A.structInfo.zeroOnDispose)&&u().fill(0,Number(X),Number(X)+A.structInfo.sizeof+se.xb),T(X))}},re=()=>({configurable:!1,writable:!1,iterable:!1}),g=A=>({...re(),value:A}),L=function($,X,se){let pe;const Oe=ke=>{P(ke)||i("Invalid pointer value",arguments[0],"for",$.structName,"constructor.")};arguments.length>=3?se&&typeof se=="object"?(pe=se,se=pe?.wrap):(Oe(se),pe={wrap:se}):pe={};const De=!se;let Be=0,Ue=!1;if(se)Oe(se),Ue=!!pe?.takeOwnership;else{const ke=pe?.extraBytes??0;(ke<0||ke!==(ke|0))&&i("Invalid extraBytes value:",pe?.extraBytes),Be=$.structInfo.sizeof+ke,se=F(Be)||i("Allocation of",$.structName,"structure failed."),Ue=!0}try{pe?.debugFlags&&X.debugFlags(pe.debugFlags),$.debugFlags.__flags.alloc&&J("debug.alloc:",De?"":"EXTERNAL",$.structName,"instance:",$.structInfo.sizeof,"bytes @"+se),De&&u().fill(0,Number(se),Number(se)+Be);const ke=E(X);ke.p=se,ke.ownsPointer=Ue,ke.xb=Be?Be-$.structInfo.sizeof:0,ke.zod=!!pe?.zeroOnDispose,pe?.ondispose&&pe.ondispose!==se&&X.addOnDispose(pe.ondispose)}catch(ke){throw Q($,X,se),ke}},H=function A($){return A.rxSig1??=/^[ipPsjfdcC]$/,A.rxSig2??=/^[vipPsjfdcC]\([ipPsjfdcC]*\)$/,A.rxSig1.test($)||A.rxSig2.test($)},ie=(function(A){let $=this.get(A);return $||($=[Object.create(null),Object.create(null),Object.create(null)],this.set(A,$)),$}).bind(new WeakMap),Z=function(A,$,X,se){const pe=ie(A)[$];return arguments.length===3?pe[X]:se?pe[X]=se:delete pe[X]},ue=function(A,...$){return Z(this,0,A,...$)},Ee=function(A,$){H($)&&i(A,"(",$,") collides with a data type signature.")},_e=function(A,...$){return Ee("Setter adaptor",A),Z(this,1,A,...$)},S=function(A,...$){return Ee("Struct adaptor",A),Z(this,2,A,...$)},x=function(A,$){const X=typeof $=="string"?Z(A,2,$):$;return typeof X!="object"&&i("Invalid struct mapping object. Arg =",$,JSON.stringify(X)),X},B=g(A=>N+A+G),ee=function(A,$,X=!0){let se=A.members[$];if(!se&&(N||G)){for(const pe of Object.values(A.members))if(pe.key===$){se=pe;break}!se&&X&&i(_(A.name||A.structName,$),"is not a mapped struct member.")}return se},le=function A($,X,se=!1){A._||(A._=Oe=>Oe.replace(/[^vipPsjrdcC]/g,"").replace(/[pPscC]/g,"i"));const pe=ee($.structInfo,X,!0);return se?A._(pe.signature):pe.signature},fe=g(function(){const A=[];for(const $ of Object.keys(this.structInfo.members))A.push(this.memberKey($));return A}),ce=new TextDecoder("utf-8"),me=new TextEncoder,Te=typeof SharedArrayBuffer>"u"?function(){}:SharedArrayBuffer,Fe=function(A,$,X){return y===8&&($=Number($),X=Number(X)),ce.decode(A.buffer instanceof Te?A.slice($,X):A.subarray($,X))},Se=function(A,$,X=!1){const se=ee(A.structInfo,$,X);return se&&se.signature.length===1&&se.signature[0]==="s"?se:!1},Me=function(A){A.signature!=="s"&&i("Invalid member type signature for C-string value:",JSON.stringify(A))},Ke=function($,X){const se=ee($.structInfo,X,!0);Me(se);const pe=$[se.key];if(!pe)return null;let Oe=pe;const De=u();for(;De[Oe]!==0;++Oe);return pe===Oe?"":Fe(De,pe,Oe)},ct=function(A,...$){A.ondispose?Array.isArray(A.ondispose)||(A.ondispose=[A.ondispose]):A.ondispose=[],A.ondispose.push(...$)},Ge=function(A){const $=me.encode(A),X=F($.length+1);X||i("Allocation error while duplicating string:",A);const se=u();return se.set($,Number(X)),se[O(X,$.length)]=0,X},Et=function(A,$,X){const se=ee(A.structInfo,$,!0);Me(se);const pe=Ge(X);return A[se.key]=pe,ct(A,pe),A},$e=function($,X){arguments[2]!==g&&i("Do not call the StructType constructor","from client-level code."),Object.defineProperties(this,{structName:g($),structInfo:g(X)})};$e.prototype=Object.create(null,{dispose:g(function(){Q(this.constructor,this)}),lookupMember:g(function(A,$=!0){return ee(this.structInfo,A,$)}),memberToJsString:g(function(A){return Ke(this,A)}),memberIsString:g(function(A,$=!0){return Se(this,A,$)}),memberKey:B,memberKeys:fe,memberSignature:g(function(A,$=!1){return le(this,A,$)}),memoryDump:g(function(){const A=this.pointer;return A?new Uint8Array(u().slice(Number(A),Number(A)+this.structInfo.sizeof)):null}),extraBytes:{configurable:!1,enumerable:!1,get:function(){return E(this,!1)?.xb??0}},zeroOnDispose:{configurable:!1,enumerable:!1,get:function(){return E(this,!1)?.zod??!!this.structInfo.zeroOnDispose}},pointer:{configurable:!1,enumerable:!1,get:function(){return E(this,!1)?.p},set:()=>i("Cannot assign the 'pointer' property of a struct.")},setMemberCString:g(function(A,$){return Et(this,A,$)})}),Object.assign($e.prototype,{addOnDispose:function(...A){return ct(this,...A),this}}),Object.defineProperties($e,{allocCString:g(Ge),isA:g(A=>A instanceof $e),hasExternalPointer:g(A=>{const $=E(A,!1);return!!($?.p&&!$?.ownsPointer)}),memberKey:B});const nt=function(A){return A.get||(A.adaptGet?Ve.adaptGet(A.adaptGet):void 0)},kt=function(A){return A.set||(A.adaptSet?Ve.adaptSet(A.adaptSet):void 0)},xr=function A($,X,se){const pe=A.innerStructs??=new Map,Oe=$.memberKey(X);se.signature!==void 0&&i("'signature' cannot be used on an embedded struct (",$.structName,".",Oe,")."),kt(se)&&i("'set' and 'adaptSet' are not permitted for nested struct members."),se.structName??=$.structName+"::"+X,se.key=Oe,se.name=X,se.constructor=this.call(this,se.structName,se);const De=nt(se),Be=Object.assign(Object.create(null),{configurable:!1,enumerable:!1,set:d($.structName,Oe),get:function(){const Ue=this.debugFlags.__flags,ke=this.pointer,je=ke+"."+Oe;let he=pe.get(je);return Ue.getter&&J("debug.getter: k =",je),he||(he=new se.constructor(O(ke,se.offset)),pe.set(je,he),this.addOnDispose(()=>he.dispose()),he.addOnDispose(()=>pe.delete(je))),De&&(he=De.apply(this,[he,Oe])),Ue.getter&&J("debug.getter: result =",he),he}});Object.defineProperty($.prototype,Oe,Be)},Fr=function A($,X,se){if(se=x(this,se),se.members)return xr.call(this,$,X,se);if(!A.cache){A.cache={getters:{},setters:{},sw:{}};const je=["i","c","C","p","P","s","f","d","v()"];C&&je.push("j"),je.forEach(function(he){A.cache.getters[he]=V(he),A.cache.setters[he]=I(he),A.cache.sw[he]=a(he)}),A.sigCheck=function(he,Re,Ot,sn){Object.prototype.hasOwnProperty.call(he,Ot)&&i(he.structName,"already has a property named",Ot+"."),H(sn)||i("Malformed signature for",_(he.structName,Re)+":",sn)}}const pe=$.memberKey(X);A.sigCheck($.prototype,X,pe,se.signature),se.key=pe,se.name=X;const Oe=ae(se.signature),De=_($.structName,pe),Be=$.debugFlags.__flags,Ue=nt(se),ke=Object.create(null);if(ke.configurable=!1,ke.enumerable=!1,ke.get=function(){Be.getter&&J("debug.getter:",A.cache.getters[Oe],"for",ye(Oe),De,"@",this.pointer,"+",se.offset,"sz",se.sizeof);let je=new DataView(u().buffer,Number(this.pointer)+se.offset,se.sizeof)[A.cache.getters[Oe]](0,m);return Ue&&(je=Ue.apply(this,[pe,je])),Be.getter&&J("debug.getter:",De,"result =",je),je},se.readOnly)ke.set=d($.prototype.structName,pe);else{const je=kt(se);ke.set=function(he){Be.setter&&J("debug.setter:",A.cache.setters[Oe],"for",ye(Oe),De,"@",this.pointer,"+",se.offset,"sz",se.sizeof,he),this.pointer||i("Cannot set native property on a disposed",this.structName,"instance."),je&&(he=je.apply(this,[pe,he])),he==null?he=w:j(se.signature)&&!h(he)&&(Y(se.signature)&&he instanceof $e?(he=he.pointer||w,Be.setter&&J("debug.setter:",De,"resolved to",he)):i("Invalid value for pointer-type",De+".")),new DataView(u().buffer,Number(this.pointer)+se.offset,se.sizeof)[A.cache.setters[Oe]](0,A.cache.sw[Oe](he),m)}}Object.defineProperty($.prototype,pe,ke)},rn=function A($,X,se=Object.create(null)){const pe=function he(Re){this instanceof he||i("The",$,"constructor may only be called via 'new'."),L(he,this,...arguments)},Oe=this,De=he=>typeof he=="string"&&H(he)?{signature:he}:x(Oe,he);arguments.length===1?(X=De($),$=X.structName||X.name):arguments.length===2?(X=De(X),X.name??=$):X=De(X),$??=X.structName,$??=se.structName,$||i("One of 'name' or 'structName' are required."),X.adapt&&(Object.keys(X.adapt.struct||{}).forEach(he=>{S.call(A,he,X.adapt.struct[he])}),Object.keys(X.adapt.set||{}).forEach(he=>{_e.call(A,he,X.adapt.set[he])}),Object.keys(X.adapt.get||{}).forEach(he=>{ue.call(A,he,X.adapt.get[he])})),!X.members&&!X.sizeof&&(X.sizeof=ve(X.signature));const Be=g(r.__makeDebugFlags(Ve.debugFlags));Object.defineProperties(pe,{debugFlags:Be,isA:g(he=>he instanceof pe),memberKey:B,memberKeys:fe,structInfo:g(X),structName:g($),ptrAdd:g(O)}),pe.prototype=new $e($,X,g),Object.defineProperties(pe.prototype,{debugFlags:Be,constructor:g(pe),ptrAdd:g(f)});let Ue=!1,ke=0;const je=!!X.autoCalcSizeOffset;return je||X.sizeof||i($,"description is missing its sizeof property."),X.offset??=0,Object.keys(X.members||{}).forEach(he=>{let Re=De(X.members[he]);!Re.members&&!Re.sizeof&&(Re.sizeof=ve(Re.signature),Re.sizeof||i(_($,he),"is missing a sizeof property.",Re)),Re.offset===void 0&&(je?Re.offset=ke:i(_($,he),"is missing its offset.",JSON.stringify(Re))),X.members[he]=Re,(!Ue||Ue.offset<Re.offset)&&(Ue=Re);const Ot=!!Re.autoCalc;je&&(Re.autoCalcSizeOffset=!0),Fr.call(Oe,pe,he,Re),Ot?Re.autoCalcSizeOffset=!0:delete Re.autoCalcSizeOffset,ke+=Re.sizeof}),Ue||i("No member property descriptions found."),X.sizeof||(X.sizeof=ke),X.sizeof===1?X.signature==="c"||X.signature==="C"||i("Unexpected sizeof==1 member",_($,k),"with signature",X.signature):(X.sizeof%4!==0&&(console.warn("Invalid struct member description",X),i($,"sizeof is not aligned. sizeof="+X.sizeof)),X.offset%4!==0&&(console.warn("Invalid struct member description",X),i($,"offset is not aligned. offset="+X.offset))),X.sizeof<ke&&(console.warn("Suspect struct description:",X,"offset =",ke),i("Mismatch in the calculated vs. the provided sizeof/offset info.","Expected sizeof",ke,"but got",X.sizeof,"for",X)),delete X.autoCalcSizeOffset,pe},Ve=function A($,X){return arguments.length==1?rn.call(A,$):rn.call(A,$,X)};return Ve.StructType=$e,Ve.config=n,Ve.allocCString=Ge,Ve.adaptGet=ue,Ve.adaptSet=_e,Ve.adaptStruct=S,Ve.ptrAdd=O,Ve.debugFlags||(Ve.debugFlags=r.__makeDebugFlags(r.debugFlags)),Ve},globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const n=(...y)=>{throw new Error(y.join(" "))},i=s.capi,r=s.wasm,u=s.util;globalThis.WhWasmUtilInstaller(r),delete globalThis.WhWasmUtilInstaller;const F={core:[["sqlite3_aggregate_context","void*","sqlite3_context*","int"],["sqlite3_bind_double","int","sqlite3_stmt*","int","f64"],["sqlite3_bind_int","int","sqlite3_stmt*","int","int"],["sqlite3_bind_null",void 0,"sqlite3_stmt*","int"],["sqlite3_bind_parameter_count","int","sqlite3_stmt*"],["sqlite3_bind_parameter_index","int","sqlite3_stmt*","string"],["sqlite3_bind_parameter_name","string","sqlite3_stmt*","int"],["sqlite3_bind_pointer","int","sqlite3_stmt*","int","*","string:static","*"],["sqlite3_busy_handler","int",["sqlite3*",new r.xWrap.FuncPtrAdapter({signature:"i(pi)",contextKey:(y,b)=>y[0]}),"*"]],["sqlite3_busy_timeout","int","sqlite3*","int"],["sqlite3_changes","int","sqlite3*"],["sqlite3_clear_bindings","int","sqlite3_stmt*"],["sqlite3_collation_needed","int","sqlite3*","*","*"],["sqlite3_column_blob","*","sqlite3_stmt*","int"],["sqlite3_column_bytes","int","sqlite3_stmt*","int"],["sqlite3_column_count","int","sqlite3_stmt*"],["sqlite3_column_decltype","string","sqlite3_stmt*","int"],["sqlite3_column_double","f64","sqlite3_stmt*","int"],["sqlite3_column_int","int","sqlite3_stmt*","int"],["sqlite3_column_name","string","sqlite3_stmt*","int"],["sqlite3_column_type","int","sqlite3_stmt*","int"],["sqlite3_column_value","sqlite3_value*","sqlite3_stmt*","int"],["sqlite3_commit_hook","void*",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"sqlite3_commit_hook",signature:"i(p)",contextKey:y=>y[0]}),"*"]],["sqlite3_compileoption_get","string","int"],["sqlite3_compileoption_used","int","string"],["sqlite3_complete","int","string:flexible"],["sqlite3_context_db_handle","sqlite3*","sqlite3_context*"],["sqlite3_data_count","int","sqlite3_stmt*"],["sqlite3_db_filename","string","sqlite3*","string"],["sqlite3_db_handle","sqlite3*","sqlite3_stmt*"],["sqlite3_db_name","string","sqlite3*","int"],["sqlite3_db_readonly","int","sqlite3*","string"],["sqlite3_db_status","int","sqlite3*","int","*","*","int"],["sqlite3_errcode","int","sqlite3*"],["sqlite3_errmsg","string","sqlite3*"],["sqlite3_error_offset","int","sqlite3*"],["sqlite3_errstr","string","int"],["sqlite3_exec","int",["sqlite3*","string:flexible",new r.xWrap.FuncPtrAdapter({signature:"i(pipp)",bindScope:"transient",callProxy:y=>{let b;return(R,U,w,O)=>{try{const f=r.cArgvToJs(U,w);return b||(b=r.cArgvToJs(U,O)),y(f,b)|0}catch(f){return f.resultCode||i.SQLITE_ERROR}}}}),"*","**"]],["sqlite3_expanded_sql","string","sqlite3_stmt*"],["sqlite3_extended_errcode","int","sqlite3*"],["sqlite3_extended_result_codes","int","sqlite3*","int"],["sqlite3_file_control","int","sqlite3*","string","int","*"],["sqlite3_finalize","int","sqlite3_stmt*"],["sqlite3_free",void 0,"*"],["sqlite3_get_autocommit","int","sqlite3*"],["sqlite3_get_auxdata","*","sqlite3_context*","int"],["sqlite3_initialize",void 0],["sqlite3_interrupt",void 0,"sqlite3*"],["sqlite3_is_interrupted","int","sqlite3*"],["sqlite3_keyword_count","int"],["sqlite3_keyword_name","int",["int","**","*"]],["sqlite3_keyword_check","int",["string","int"]],["sqlite3_libversion","string"],["sqlite3_libversion_number","int"],["sqlite3_limit","int",["sqlite3*","int","int"]],["sqlite3_malloc","*","int"],["sqlite3_next_stmt","sqlite3_stmt*",["sqlite3*","sqlite3_stmt*"]],["sqlite3_open","int","string","*"],["sqlite3_open_v2","int","string","*","int","string"],["sqlite3_realloc","*","*","int"],["sqlite3_reset","int","sqlite3_stmt*"],["sqlite3_result_blob",void 0,"sqlite3_context*","*","int","*"],["sqlite3_result_double",void 0,"sqlite3_context*","f64"],["sqlite3_result_error",void 0,"sqlite3_context*","string","int"],["sqlite3_result_error_code",void 0,"sqlite3_context*","int"],["sqlite3_result_error_nomem",void 0,"sqlite3_context*"],["sqlite3_result_error_toobig",void 0,"sqlite3_context*"],["sqlite3_result_int",void 0,"sqlite3_context*","int"],["sqlite3_result_null",void 0,"sqlite3_context*"],["sqlite3_result_pointer",void 0,"sqlite3_context*","*","string:static","*"],["sqlite3_result_subtype",void 0,"sqlite3_value*","int"],["sqlite3_result_text",void 0,"sqlite3_context*","string","int","*"],["sqlite3_result_zeroblob",void 0,"sqlite3_context*","int"],["sqlite3_rollback_hook","void*",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"sqlite3_rollback_hook",signature:"v(p)",contextKey:y=>y[0]}),"*"]],["sqlite3_set_auxdata",void 0,["sqlite3_context*","int","*","*"]],["sqlite3_set_errmsg","int","sqlite3*","int","string"],["sqlite3_shutdown",void 0],["sqlite3_sourceid","string"],["sqlite3_sql","string","sqlite3_stmt*"],["sqlite3_status","int","int","*","*","int"],["sqlite3_step","int","sqlite3_stmt*"],["sqlite3_stmt_busy","int","sqlite3_stmt*"],["sqlite3_stmt_readonly","int","sqlite3_stmt*"],["sqlite3_stmt_status","int","sqlite3_stmt*","int","int"],["sqlite3_strglob","int","string","string"],["sqlite3_stricmp","int","string","string"],["sqlite3_strlike","int","string","string","int"],["sqlite3_strnicmp","int","string","string","int"],["sqlite3_table_column_metadata","int","sqlite3*","string","string","string","**","**","*","*","*"],["sqlite3_total_changes","int","sqlite3*"],["sqlite3_trace_v2","int",["sqlite3*","int",new r.xWrap.FuncPtrAdapter({name:"sqlite3_trace_v2::callback",signature:"i(ippp)",contextKey:(y,b)=>y[0]}),"*"]],["sqlite3_txn_state","int",["sqlite3*","string"]],["sqlite3_uri_boolean","int","sqlite3_filename","string","int"],["sqlite3_uri_key","string","sqlite3_filename","int"],["sqlite3_uri_parameter","string","sqlite3_filename","string"],["sqlite3_user_data","void*","sqlite3_context*"],["sqlite3_value_blob","*","sqlite3_value*"],["sqlite3_value_bytes","int","sqlite3_value*"],["sqlite3_value_double","f64","sqlite3_value*"],["sqlite3_value_dup","sqlite3_value*","sqlite3_value*"],["sqlite3_value_free",void 0,"sqlite3_value*"],["sqlite3_value_frombind","int","sqlite3_value*"],["sqlite3_value_int","int","sqlite3_value*"],["sqlite3_value_nochange","int","sqlite3_value*"],["sqlite3_value_numeric_type","int","sqlite3_value*"],["sqlite3_value_pointer","*","sqlite3_value*","string:static"],["sqlite3_value_subtype","int","sqlite3_value*"],["sqlite3_value_type","int","sqlite3_value*"],["sqlite3_vfs_find","*","string"],["sqlite3_vfs_register","int","sqlite3_vfs*","int"],["sqlite3_vfs_unregister","int","sqlite3_vfs*"]],int64:[["sqlite3_bind_int64","int",["sqlite3_stmt*","int","i64"]],["sqlite3_changes64","i64",["sqlite3*"]],["sqlite3_column_int64","i64",["sqlite3_stmt*","int"]],["sqlite3_deserialize","int","sqlite3*","string","*","i64","i64","int"],["sqlite3_last_insert_rowid","i64",["sqlite3*"]],["sqlite3_malloc64","*","i64"],["sqlite3_msize","i64","*"],["sqlite3_overload_function","int",["sqlite3*","string","int"]],["sqlite3_realloc64","*","*","i64"],["sqlite3_result_int64",void 0,"*","i64"],["sqlite3_result_zeroblob64","int","*","i64"],["sqlite3_serialize","*","sqlite3*","string","*","int"],["sqlite3_set_last_insert_rowid",void 0,["sqlite3*","i64"]],["sqlite3_status64","int","int","*","*","int"],["sqlite3_db_status64","int","sqlite3*","int","*","*","int"],["sqlite3_total_changes64","i64",["sqlite3*"]],["sqlite3_update_hook","*",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"sqlite3_update_hook::callback",signature:"v(pippj)",contextKey:y=>y[0],callProxy:y=>(b,R,U,w,O)=>{y(b,R,r.cstrToJs(U),r.cstrToJs(w),O)}}),"*"]],["sqlite3_uri_int64","i64",["sqlite3_filename","string","i64"]],["sqlite3_value_int64","i64","sqlite3_value*"]],wasmInternal:[["sqlite3__wasm_db_reset","int","sqlite3*"],["sqlite3__wasm_db_vfs","sqlite3_vfs*","sqlite3*","string"],["sqlite3__wasm_vfs_create_file","int","sqlite3_vfs*","string","*","int"],["sqlite3__wasm_posix_create_file","int","string","*","int"],["sqlite3__wasm_vfs_unlink","int","sqlite3_vfs*","string"],["sqlite3__wasm_qfmt_token","string:dealloc","string","int"]]};if(r.exports.sqlite3_progress_handler&&F.core.push(["sqlite3_progress_handler",void 0,["sqlite3*","int",new r.xWrap.FuncPtrAdapter({name:"xProgressHandler",signature:"i(p)",bindScope:"context",contextKey:(y,b)=>y[0]}),"*"]]),r.exports.sqlite3_stmt_explain&&F.core.push(["sqlite3_stmt_explain","int","sqlite3_stmt*","int"],["sqlite3_stmt_isexplain","int","sqlite3_stmt*"]),r.exports.sqlite3_set_authorizer&&F.core.push(["sqlite3_set_authorizer","int",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"sqlite3_set_authorizer::xAuth",signature:"i(pissss)",contextKey:(y,b)=>y[0],callProxy:y=>(b,R,U,w,O,f)=>{try{return U=U&&r.cstrToJs(U),w=w&&r.cstrToJs(w),O=O&&r.cstrToJs(O),f=f&&r.cstrToJs(f),y(b,R,U,w,O,f)|0}catch(m){return m.resultCode||i.SQLITE_ERROR}}}),"*"]]),r.exports.sqlite3_column_origin_name&&F.core.push(["sqlite3_column_database_name","string","sqlite3_stmt*","int"],["sqlite3_column_origin_name","string","sqlite3_stmt*","int"],["sqlite3_column_table_name","string","sqlite3_stmt*","int"]),r.bigIntEnabled&&r.exports.sqlite3_declare_vtab&&F.int64.push(["sqlite3_create_module","int",["sqlite3*","string","sqlite3_module*","*"]],["sqlite3_create_module_v2","int",["sqlite3*","string","sqlite3_module*","*","*"]],["sqlite3_declare_vtab","int",["sqlite3*","string:flexible"]],["sqlite3_drop_modules","int",["sqlite3*","**"]],["sqlite3_vtab_collation","string","sqlite3_index_info*","int"],["sqlite3_vtab_distinct","int","sqlite3_index_info*"],["sqlite3_vtab_in","int","sqlite3_index_info*","int","int"],["sqlite3_vtab_in_first","int","sqlite3_value*","**"],["sqlite3_vtab_in_next","int","sqlite3_value*","**"],["sqlite3_vtab_nochange","int","sqlite3_context*"],["sqlite3_vtab_on_conflict","int","sqlite3*"],["sqlite3_vtab_rhs_value","int","sqlite3_index_info*","int","**"]),r.bigIntEnabled&&r.exports.sqlite3_preupdate_hook&&F.int64.push(["sqlite3_preupdate_blobwrite","int","sqlite3*"],["sqlite3_preupdate_count","int","sqlite3*"],["sqlite3_preupdate_depth","int","sqlite3*"],["sqlite3_preupdate_hook","*",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"sqlite3_preupdate_hook",signature:"v(ppippjj)",contextKey:y=>y[0],callProxy:y=>(b,R,U,w,O,f,m)=>{y(b,R,U,r.cstrToJs(w),r.cstrToJs(O),f,m)}}),"*"]],["sqlite3_preupdate_new","int",["sqlite3*","int","**"]],["sqlite3_preupdate_old","int",["sqlite3*","int","**"]]),r.bigIntEnabled&&r.exports.sqlite3changegroup_add&&r.exports.sqlite3session_create&&r.exports.sqlite3_preupdate_hook){const y={signature:"i(ps)",callProxy:b=>(R,U)=>{try{return b(R,r.cstrToJs(U))|0}catch(w){return w.resultCode||i.SQLITE_ERROR}}};F.int64.push(["sqlite3changegroup_add","int",["sqlite3_changegroup*","int","void*"]],["sqlite3changegroup_add_strm","int",["sqlite3_changegroup*",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3changegroup_delete",void 0,["sqlite3_changegroup*"]],["sqlite3changegroup_new","int",["**"]],["sqlite3changegroup_output","int",["sqlite3_changegroup*","int*","**"]],["sqlite3changegroup_output_strm","int",["sqlite3_changegroup*",new r.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply","int",["sqlite3*","int","void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...y}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply_strm","int",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...y}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply_v2","int",["sqlite3*","int","void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...y}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_apply_v2_strm","int",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...y}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_apply_v3","int",["sqlite3*","int","void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",signature:"i(pp)",bindScope:"transient"}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_apply_v3_strm","int",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",signature:"i(pp)",bindScope:"transient"}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_concat","int",["int","void*","int","void*","int*","**"]],["sqlite3changeset_concat_strm","int",[new r.xWrap.FuncPtrAdapter({name:"xInputA",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xInputB",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_conflict","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_finalize","int",["sqlite3_changeset_iter*"]],["sqlite3changeset_fk_conflicts","int",["sqlite3_changeset_iter*","int*"]],["sqlite3changeset_invert","int",["int","void*","int*","**"]],["sqlite3changeset_invert_strm","int",[new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_new","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_next","int",["sqlite3_changeset_iter*"]],["sqlite3changeset_old","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_op","int",["sqlite3_changeset_iter*","**","int*","int*","int*"]],["sqlite3changeset_pk","int",["sqlite3_changeset_iter*","**","int*"]],["sqlite3changeset_start","int",["**","int","*"]],["sqlite3changeset_start_strm","int",["**",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3changeset_start_v2","int",["**","int","*","int"]],["sqlite3changeset_start_v2_strm","int",["**",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*","int"]],["sqlite3session_attach","int",["sqlite3_session*","string"]],["sqlite3session_changeset","int",["sqlite3_session*","int*","**"]],["sqlite3session_changeset_size","i64",["sqlite3_session*"]],["sqlite3session_changeset_strm","int",["sqlite3_session*",new r.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3session_config","int",["int","void*"]],["sqlite3session_create","int",["sqlite3*","string","**"]],["sqlite3session_diff","int",["sqlite3_session*","string","string","**"]],["sqlite3session_enable","int",["sqlite3_session*","int"]],["sqlite3session_indirect","int",["sqlite3_session*","int"]],["sqlite3session_isempty","int",["sqlite3_session*"]],["sqlite3session_memory_used","i64",["sqlite3_session*"]],["sqlite3session_object_config","int",["sqlite3_session*","int","void*"]],["sqlite3session_patchset","int",["sqlite3_session*","*","**"]],["sqlite3session_patchset_strm","int",["sqlite3_session*",new r.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3session_table_filter",void 0,["sqlite3_session*",new r.xWrap.FuncPtrAdapter({name:"xFilter",...y,contextKey:(b,R)=>b[0]}),"*"]])}s.StructBinder=globalThis.Jaccwabyt({heap:r.heap8u,alloc:r.alloc,dealloc:r.dealloc,bigIntEnabled:r.bigIntEnabled,pointerIR:r.ptr.ir,memberPrefix:"$"}),delete globalThis.Jaccwabyt;{const y=r.xWrap.argAdapter("string");r.xWrap.argAdapter("string:flexible",w=>y(u.flexibleString(w))),r.xWrap.argAdapter("string:static",(function(w){return r.isPtr(w)?w:(w=""+w,this[w]||(this[w]=r.allocCString(w)))}).bind(Object.create(null)));const b=r.xWrap.argAdapter("*"),R=function(){};r.xWrap.argAdapter("sqlite3_filename",b)("sqlite3_context*",b)("sqlite3_value*",b)("void*",b)("sqlite3_changegroup*",b)("sqlite3_changeset_iter*",b)("sqlite3_session*",b)("sqlite3_stmt*",w=>b(w instanceof(s?.oo1?.Stmt||R)?w.pointer:w))("sqlite3*",w=>b(w instanceof(s?.oo1?.DB||R)?w.pointer:w))("sqlite3_vfs*",w=>typeof w=="string"?i.sqlite3_vfs_find(w)||s.SQLite3Error.toss(i.SQLITE_NOTFOUND,"Unknown sqlite3_vfs name:",w):b(w instanceof(i.sqlite3_vfs||R)?w.pointer:w)),r.exports.sqlite3_declare_vtab&&r.xWrap.argAdapter("sqlite3_index_info*",w=>b(w instanceof(i.sqlite3_index_info||R)?w.pointer:w))("sqlite3_module*",w=>b(w instanceof(i.sqlite3_module||R)?w.pointer:w));const U=r.xWrap.resultAdapter("*");r.xWrap.resultAdapter("sqlite3*",U)("sqlite3_context*",U)("sqlite3_stmt*",U)("sqlite3_value*",U)("sqlite3_vfs*",U)("void*",U);for(const w of F.core)i[w[0]]=r.xWrap.apply(null,w);for(const w of F.wasmInternal)u[w[0]]=r.xWrap.apply(null,w);for(const w of F.int64)i[w[0]]=r.bigIntEnabled?r.xWrap.apply(null,w):()=>n(w[0]+"() is unavailable due to lack","of BigInt support in this build.");delete F.core,delete F.int64,delete F.wasmInternal,u.sqlite3__wasm_db_error=function(w,O,f){return w?(O instanceof s.WasmAllocError?(O=i.SQLITE_NOMEM,f=0):O instanceof Error&&(f=f||""+O,O=O.resultCode||i.SQLITE_ERROR),i.sqlite3_set_errmsg(w,O,f)||O):i.SQLITE_MISUSE}}{const y=r.xCall("sqlite3__wasm_enum_json");y||n("Maintenance required: increase sqlite3__wasm_enum_json()'s","static buffer size!"),r.ctype=JSON.parse(r.cstrToJs(y));const b=["access","authorizer","blobFinalizers","changeset","config","dataTypes","dbConfig","dbStatus","encodings","fcntl","flock","ioCap","limits","openFlags","prepareFlags","resultCodes","sqlite3Status","stmtStatus","syncFlags","trace","txnState","udfFlags","version"];r.bigIntEnabled&&b.push("serialize","session","vtab");for(const w of b)for(const O of Object.entries(r.ctype[w]))i[O[0]]=O[1];r.functionEntry(i.SQLITE_WASM_DEALLOC)||n("Internal error: cannot resolve exported function","entry SQLITE_WASM_DEALLOC (=="+i.SQLITE_WASM_DEALLOC+").");const R=Object.create(null);for(const w of Object.entries(r.ctype.resultCodes))R[w[1]]=w[0];i.sqlite3_js_rc_str=w=>R[w];const U=Object.assign(Object.create(null),{WasmTestStruct:!0,sqlite3_index_info:!r.bigIntEnabled,sqlite3_index_constraint:!r.bigIntEnabled,sqlite3_index_orderby:!r.bigIntEnabled,sqlite3_index_constraint_usage:!r.bigIntEnabled});for(const w of r.ctype.structs)U[w.name]||(i[w.name]=s.StructBinder(w));if(i.sqlite3_index_info){for(const w of["sqlite3_index_constraint","sqlite3_index_orderby","sqlite3_index_constraint_usage"])i.sqlite3_index_info[w]=i[w],delete i[w];i.sqlite3_vtab_config=r.xWrap("sqlite3__wasm_vtab_config","int",["sqlite3*","int","int"])}}const T=(y,b,R)=>u.sqlite3__wasm_db_error(y,i.SQLITE_MISUSE,b+"() requires "+R+" argument"+(R===1?"":"s")+"."),J=y=>u.sqlite3__wasm_db_error(y,i.SQLITE_FORMAT,"SQLITE_UTF8 is the only supported encoding."),N=y=>r.xWrap.argAdapter("sqlite3*")(y),G=y=>r.isPtr(y)?r.cstrToJs(y):y,p=(function(y,b){y=N(y);let R=this.dbMap.get(y);if(b)!R&&b>0&&this.dbMap.set(y,R=Object.create(null));else return this.dbMap.delete(y),R;return R}).bind(Object.assign(Object.create(null),{dbMap:new Map}));p.addCollation=function(y,b){const R=p(y,1);R.collation||(R.collation=new Set),R.collation.add(G(b).toLowerCase())},p._addUDF=function(y,b,R,U){b=G(b).toLowerCase();let w=U.get(b);w||U.set(b,w=new Set),w.add(R<0?-1:R)},p.addFunction=function(y,b,R){const U=p(y,1);U.udf||(U.udf=new Map),this._addUDF(y,b,R,U.udf)},r.exports.sqlite3_create_window_function&&(p.addWindowFunc=function(y,b,R){const U=p(y,1);U.wudf||(U.wudf=new Map),this._addUDF(y,b,R,U.wudf)}),p.cleanup=function(y){y=N(y);for(const U of[["sqlite3_busy_handler",3],["sqlite3_commit_hook",3],["sqlite3_preupdate_hook",3],["sqlite3_progress_handler",4],["sqlite3_rollback_hook",3],["sqlite3_set_authorizer",3],["sqlite3_trace_v2",4],["sqlite3_update_hook",3]]){const[w,O]=U;if(!r.exports[w])continue;const f=[y];f.length=O;try{i[w](...f)}catch(m){s.config.warn("close-time call of",w+"(",f,") threw:",m)}}const b=p(y,0);if(!b)return;if(b.collation){for(const U of b.collation)try{i.sqlite3_create_collation_v2(y,U,i.SQLITE_UTF8,0,0,0)}catch{}delete b.collation}let R;for(R=0;R<2;++R){const U=R?b.wudf:b.udf;if(!U)continue;const w=R?i.sqlite3_create_window_function:i.sqlite3_create_function_v2;for(const O of U){const f=O[0],m=O[1],q=[y,f,0,i.SQLITE_UTF8,0,0,0,0,0];R&&q.push(0);for(const j of m)try{q[2]=j,w.apply(null,q)}catch{}m.clear()}U.clear()}delete b.udf,delete b.wudf};{const y=r.xWrap("sqlite3_close_v2","int","sqlite3*");i.sqlite3_close_v2=function(b){if(arguments.length!==1)return T(b,"sqlite3_close_v2",1);if(b)try{p.cleanup(b)}catch{}return y(b)}}if(i.sqlite3session_create){const y=r.xWrap("sqlite3session_delete",void 0,["sqlite3_session*"]);i.sqlite3session_delete=function(b){if(arguments.length!==1)return T(pDb,"sqlite3session_delete",1);b&&i.sqlite3session_table_filter(b,0,0),y(b)}}{const y=(R,U)=>"argv["+U+"]:"+R[0]+":"+r.cstrToJs(R[1]).toLowerCase(),b=r.xWrap("sqlite3_create_collation_v2","int",["sqlite3*","string","int","*",new r.xWrap.FuncPtrAdapter({name:"xCompare",signature:"i(pipip)",contextKey:y}),new r.xWrap.FuncPtrAdapter({name:"xDestroy",signature:"v(p)",contextKey:y})]);i.sqlite3_create_collation_v2=function(R,U,w,O,f,m){if(arguments.length!==6)return T(R,"sqlite3_create_collation_v2",6);if((w&15)===0)w|=i.SQLITE_UTF8;else if(i.SQLITE_UTF8!==(w&15))return J(R);try{const q=b(R,U,w,O,f,m);return q===0&&f instanceof Function&&p.addCollation(R,U),q}catch(q){return u.sqlite3__wasm_db_error(R,q)}},i.sqlite3_create_collation=(R,U,w,O,f)=>arguments.length===5?i.sqlite3_create_collation_v2(R,U,w,O,f,0):T(R,"sqlite3_create_collation",5)}{const y=function(w,O){return w[0]+":"+(w[2]<0?-1:w[2])+":"+O+":"+r.cstrToJs(w[1]).toLowerCase()},b=Object.assign(Object.create(null),{xInverseAndStep:{signature:"v(pip)",contextKey:y,callProxy:w=>(O,f,m)=>{try{w(O,...i.sqlite3_values_to_js(f,m))}catch(q){i.sqlite3_result_error_js(O,q)}}},xFinalAndValue:{signature:"v(p)",contextKey:y,callProxy:w=>O=>{try{i.sqlite3_result_js(O,w(O))}catch(f){i.sqlite3_result_error_js(O,f)}}},xFunc:{signature:"v(pip)",contextKey:y,callProxy:w=>(O,f,m)=>{try{i.sqlite3_result_js(O,w(O,...i.sqlite3_values_to_js(f,m)))}catch(q){i.sqlite3_result_error_js(O,q)}}},xDestroy:{signature:"v(p)",contextKey:y,callProxy:w=>O=>{try{w(O)}catch(f){console.error("UDF xDestroy method threw:",f)}}}}),R=r.xWrap("sqlite3_create_function_v2","int",["sqlite3*","string","int","int","*",new r.xWrap.FuncPtrAdapter({name:"xFunc",...b.xFunc}),new r.xWrap.FuncPtrAdapter({name:"xStep",...b.xInverseAndStep}),new r.xWrap.FuncPtrAdapter({name:"xFinal",...b.xFinalAndValue}),new r.xWrap.FuncPtrAdapter({name:"xDestroy",...b.xDestroy})]),U=r.exports.sqlite3_create_window_function?r.xWrap("sqlite3_create_window_function","int",["sqlite3*","string","int","int","*",new r.xWrap.FuncPtrAdapter({name:"xStep",...b.xInverseAndStep}),new r.xWrap.FuncPtrAdapter({name:"xFinal",...b.xFinalAndValue}),new r.xWrap.FuncPtrAdapter({name:"xValue",...b.xFinalAndValue}),new r.xWrap.FuncPtrAdapter({name:"xInverse",...b.xInverseAndStep}),new r.xWrap.FuncPtrAdapter({name:"xDestroy",...b.xDestroy})]):void 0;i.sqlite3_create_function_v2=function w(O,f,m,q,j,Y,ae,ye,ve){if(w.length!==arguments.length)return T(O,"sqlite3_create_function_v2",w.length);if((q&15)===0)q|=i.SQLITE_UTF8;else if(i.SQLITE_UTF8!==(q&15))return J(O);try{const de=R(O,f,m,q,j,Y,ae,ye,ve);return de===0&&(Y instanceof Function||ae instanceof Function||ye instanceof Function||ve instanceof Function)&&p.addFunction(O,f,m),de}catch(de){return console.error("sqlite3_create_function_v2() setup threw:",de),u.sqlite3__wasm_db_error(O,de,"Creation of UDF threw: "+de)}},i.sqlite3_create_function=function w(O,f,m,q,j,Y,ae,ye){return w.length===arguments.length?i.sqlite3_create_function_v2(O,f,m,q,j,Y,ae,ye,0):T(O,"sqlite3_create_function",w.length)},U?i.sqlite3_create_window_function=function w(O,f,m,q,j,Y,ae,ye,ve,de){if(w.length!==arguments.length)return T(O,"sqlite3_create_window_function",w.length);if((q&15)===0)q|=i.SQLITE_UTF8;else if(i.SQLITE_UTF8!==(q&15))return J(O);try{const V=U(O,f,m,q,j,Y,ae,ye,ve,de);return V===0&&(Y instanceof Function||ae instanceof Function||ye instanceof Function||ve instanceof Function||de instanceof Function)&&p.addWindowFunc(O,f,m),V}catch(V){return console.error("sqlite3_create_window_function() setup threw:",V),u.sqlite3__wasm_db_error(O,V,"Creation of UDF threw: "+V)}}:delete i.sqlite3_create_window_function,i.sqlite3_create_function_v2.udfSetResult=i.sqlite3_create_function.udfSetResult=i.sqlite3_result_js,i.sqlite3_create_window_function&&(i.sqlite3_create_window_function.udfSetResult=i.sqlite3_result_js),i.sqlite3_create_function_v2.udfConvertArgs=i.sqlite3_create_function.udfConvertArgs=i.sqlite3_values_to_js,i.sqlite3_create_window_function&&(i.sqlite3_create_window_function.udfConvertArgs=i.sqlite3_values_to_js),i.sqlite3_create_function_v2.udfSetError=i.sqlite3_create_function.udfSetError=i.sqlite3_result_error_js,i.sqlite3_create_window_function&&(i.sqlite3_create_window_function.udfSetError=i.sqlite3_result_error_js)}{const y=(R,U)=>(typeof R=="string"?U=-1:u.isSQLableTypedArray(R)?(U=R.byteLength,R=r.typedArrayToString(R instanceof ArrayBuffer?new Uint8Array(R):R)):Array.isArray(R)&&(R=R.join(""),U=-1),[R,U]),b={basic:r.xWrap("sqlite3_prepare_v3","int",["sqlite3*","string","int","int","**","**"]),full:r.xWrap("sqlite3_prepare_v3","int",["sqlite3*","*","int","int","**","**"])};i.sqlite3_prepare_v3=function R(U,w,O,f,m,q){if(R.length!==arguments.length)return T(U,"sqlite3_prepare_v3",R.length);const[j,Y]=y(w,Number(O));switch(typeof j){case"string":return b.basic(U,j,Y,f,m,null);case typeof r.ptr.null:return b.full(U,r.ptr.coerce(j),Y,f,m,q);default:return u.sqlite3__wasm_db_error(U,i.SQLITE_MISUSE,"Invalid SQL argument type for sqlite3_prepare_v2/v3(). typeof="+typeof j)}},i.sqlite3_prepare_v2=function R(U,w,O,f,m){return R.length===arguments.length?i.sqlite3_prepare_v3(U,w,O,0,f,m):T(U,"sqlite3_prepare_v2",R.length)}}{const y=r.xWrap("sqlite3_bind_text","int",["sqlite3_stmt*","int","string","int","*"]),b=r.xWrap("sqlite3_bind_blob","int",["sqlite3_stmt*","int","*","int","*"]);i.sqlite3_bind_text=function R(U,w,O,f,m){if(R.length!==arguments.length)return T(i.sqlite3_db_handle(U),"sqlite3_bind_text",R.length);if(r.isPtr(O)||O===null)return y(U,w,O,f,m);O instanceof ArrayBuffer?O=new Uint8Array(O):Array.isArray(pMem)&&(O=pMem.join(""));let q,j;try{if(u.isSQLableTypedArray(O))q=r.allocFromTypedArray(O),j=O.byteLength;else if(typeof O=="string")[q,j]=r.allocCString(O);else return u.sqlite3__wasm_db_error(i.sqlite3_db_handle(U),i.SQLITE_MISUSE,"Invalid 3rd argument type for sqlite3_bind_text().");return y(U,w,q,j,i.SQLITE_WASM_DEALLOC)}catch(Y){return r.dealloc(q),u.sqlite3__wasm_db_error(i.sqlite3_db_handle(U),Y)}},i.sqlite3_bind_blob=function R(U,w,O,f,m){if(R.length!==arguments.length)return T(i.sqlite3_db_handle(U),"sqlite3_bind_blob",R.length);if(r.isPtr(O)||O===null)return b(U,w,O,f,m);O instanceof ArrayBuffer?O=new Uint8Array(O):Array.isArray(O)&&(O=O.join(""));let q,j;try{if(u.isBindableTypedArray(O))q=r.allocFromTypedArray(O),j=f>=0?f:O.byteLength;else if(typeof O=="string")[q,j]=r.allocCString(O);else return u.sqlite3__wasm_db_error(i.sqlite3_db_handle(U),i.SQLITE_MISUSE,"Invalid 3rd argument type for sqlite3_bind_blob().");return b(U,w,q,j,i.SQLITE_WASM_DEALLOC)}catch(Y){return r.dealloc(q),u.sqlite3__wasm_db_error(i.sqlite3_db_handle(U),Y)}}}if(!i.sqlite3_column_text){const y=r.xWrap.argAdapter("sqlite3_stmt*"),b=r.xWrap.argAdapter("int"),R=r.xWrap.argAdapter("sqlite3_value*"),U=(w,O)=>r.typedArrayToString(r.heap8u(),Number(w),Number(w)+O);i.sqlite3_column_text=function(w,O){const f=y(w),m=b(O),q=r.exports.sqlite3_column_text(f,m);return q?U(q,r.exports.sqlite3_column_bytes(f,m)):null},i.sqlite3_value_text=function(w){const O=R(w),f=r.exports.sqlite3_value_text(O);return f?U(f,r.exports.sqlite3_value_bytes(O)):null}}i.sqlite3_config=function(y,...b){if(arguments.length<2)return i.SQLITE_MISUSE;switch(y){case i.SQLITE_CONFIG_COVERING_INDEX_SCAN:case i.SQLITE_CONFIG_MEMSTATUS:case i.SQLITE_CONFIG_SMALL_MALLOC:case i.SQLITE_CONFIG_SORTERREF_SIZE:case i.SQLITE_CONFIG_STMTJRNL_SPILL:case i.SQLITE_CONFIG_URI:return r.exports.sqlite3__wasm_config_i(y,b[0]);case i.SQLITE_CONFIG_LOOKASIDE:return r.exports.sqlite3__wasm_config_ii(y,b[0],b[1]);case i.SQLITE_CONFIG_MEMDB_MAXSIZE:return r.exports.sqlite3__wasm_config_j(y,b[0]);case i.SQLITE_CONFIG_GETMALLOC:case i.SQLITE_CONFIG_GETMUTEX:case i.SQLITE_CONFIG_GETPCACHE2:case i.SQLITE_CONFIG_GETPCACHE:case i.SQLITE_CONFIG_HEAP:case i.SQLITE_CONFIG_LOG:case i.SQLITE_CONFIG_MALLOC:case i.SQLITE_CONFIG_MMAP_SIZE:case i.SQLITE_CONFIG_MULTITHREAD:case i.SQLITE_CONFIG_MUTEX:case i.SQLITE_CONFIG_PAGECACHE:case i.SQLITE_CONFIG_PCACHE2:case i.SQLITE_CONFIG_PCACHE:case i.SQLITE_CONFIG_PCACHE_HDRSZ:case i.SQLITE_CONFIG_PMASZ:case i.SQLITE_CONFIG_SERIALIZED:case i.SQLITE_CONFIG_SINGLETHREAD:case i.SQLITE_CONFIG_SQLLOG:case i.SQLITE_CONFIG_WIN32_HEAPSIZE:default:return i.SQLITE_NOTFOUND}};{const y=new Set;i.sqlite3_auto_extension=function(b){if(b instanceof Function)b=r.installFunction("i(ppp)",b);else if(arguments.length!==1||!r.isPtr(b))return i.SQLITE_MISUSE;const R=r.exports.sqlite3_auto_extension(b);return b!==arguments[0]&&(R===0?y.add(b):r.uninstallFunction(b)),R},i.sqlite3_cancel_auto_extension=function(b){return!b||arguments.length!==1||!r.isPtr(b)?0:r.exports.sqlite3_cancel_auto_extension(b)},i.sqlite3_reset_auto_extension=function(){r.exports.sqlite3_reset_auto_extension();for(const b of y)r.uninstallFunction(b);y.clear()}}r.xWrap.FuncPtrAdapter.warnOnUse=!0;const z=s.StructBinder,C=function y(b,R,U,w=y.installMethodArgcCheck){if(b instanceof z.StructType?!(U instanceof Function)&&!r.isPtr(U)&&n("Usage error: expecting a Function or WASM pointer to one."):n("Usage error: target object is-not-a StructType."),arguments.length===1)return(q,j)=>y(b,q,j,w);y.argcProxy||(y.argcProxy=function(q,j,Y,ae){return function(...ye){return Y.length!==arguments.length&&n("Argument mismatch for",q.structInfo.name+"::"+j+": Native signature is:",ae),Y.apply(this,ye)}},y.removeFuncList=function(){this.ondispose.__removeFuncList&&(this.ondispose.__removeFuncList.forEach((q,j)=>{if(r.isPtr(q))try{r.uninstallFunction(q)}catch{}}),delete this.ondispose.__removeFuncList)});const O=b.memberSignature(R);O.length<2&&n("Member",R,"does not have a function pointer signature:",O);const f=b.memberKey(R),m=w&&!r.isPtr(U)?y.argcProxy(b,f,U,O):U;if(r.isPtr(m))m&&!r.functionEntry(m)&&n("Pointer",m,"is not a WASM function table entry."),b[f]=m;else{const q=r.installFunction(m,O);b[f]=q,(!b.ondispose||!b.ondispose.__removeFuncList)&&(b.addOnDispose("ondispose.__removeFuncList handler",y.removeFuncList),b.ondispose.__removeFuncList=[]),b.ondispose.__removeFuncList.push(f,q)}return(q,j)=>y(b,q,j,w)};C.installMethodArgcCheck=!1;const te=function(y,b,R=C.installMethodArgcCheck){const U=new Map;for(const w of Object.keys(b)){const O=b[w],f=U.get(O);if(f){const m=y.memberKey(w);y[m]=y[y.memberKey(f)]}else C(y,w,O,R),U.set(O,w)}return y};z.StructType.prototype.installMethod=function(b,R,U=C.installMethodArgcCheck){return arguments.length<3&&b&&typeof b=="object"?te(this,...arguments):C(this,...arguments)},z.StructType.prototype.installMethods=function(y,b=C.installMethodArgcCheck){return te(this,y,b)}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const n=(...I)=>{throw new s.SQLite3Error(...I)},i=s.capi,r=s.wasm,u=s.util,F=function(I){return(...a)=>I("sqlite3.oo1:",...a)};s.__isUnderTest?F(console.debug.bind(console)):F(s.config.debug),s.__isUnderTest?F(console.warn.bind(console)):F(s.config.warn),s.__isUnderTest?F(console.error.bind(console)):F(s.config.error);const T=new WeakMap,J=new Set,N=new WeakMap,G=(I,a,_)=>{const d=Object.getOwnPropertyDescriptor(I,a);return d?d.value:_},p=function(I,a){return a&&(I instanceof y&&(I=I.pointer),n(a,"sqlite3 result code",a+":",I?i.sqlite3_errmsg(I):i.sqlite3_errstr(a))),arguments[0]},z=r.installFunction("i(ippp)",(function(I,a,_,d){i.SQLITE_TRACE_STMT===I&&console.log("SQL TRACE #"+ ++this.counter,"via sqlite3@"+a+"["+i.sqlite3_db_filename(a,null)+"]",r.cstrToJs(d))}).bind({counter:0})),C=Object.create(null),te=function I(...a){const _=I.normalizeArgs(...a);let d;if(d=_["sqlite3*"])_["sqlite3*:takeOwnership"]||J.add(this),this.filename=i.sqlite3_db_filename(d,"main");else{let E=_.filename,W=_.vfs,K=_.flags;(typeof E!="string"&&!r.isPtr(E)||typeof K!="string"||W&&typeof W!="string"&&!r.isPtr(W))&&(s.config.error("Invalid DB ctor args",_,arguments),n("Invalid arguments for DB constructor:",arguments,"opts:",_));let D=0;K.indexOf("c")>=0&&(D|=i.SQLITE_OPEN_CREATE|i.SQLITE_OPEN_READWRITE),K.indexOf("w")>=0&&(D|=i.SQLITE_OPEN_READWRITE),D===0&&(D|=i.SQLITE_OPEN_READONLY),D|=i.SQLITE_OPEN_EXRESCODE;const h=r.pstack.pointer;try{const P=r.pstack.allocPtr();let Q=i.sqlite3_open_v2(E,P,D,W||r.ptr.null);d=r.peekPtr(P),p(d,Q),i.sqlite3_extended_result_codes(d,1),K.indexOf("t")>=0&&i.sqlite3_trace_v2(d,i.SQLITE_TRACE_STMT,z,d)}catch(P){throw d&&i.sqlite3_close_v2(d),P}finally{r.pstack.restore(h)}this.filename=r.isPtr(E)?r.cstrToJs(E):E}if(T.set(this,d),N.set(this,Object.create(null)),!_["sqlite3*"])try{const E=C[i.sqlite3_js_db_vfs(d)||n("Internal error: cannot get VFS for new db handle.")];E&&(E instanceof Function?E(this,s):p(d,i.sqlite3_exec(d,E,0,0,0)))}catch(E){throw this.close(),E}};te.setVfsPostOpenCallback=function(I,a){a instanceof Function||n("dbCtorHelper.setVfsPostOpenCallback() should not be used with a non-function argument.",arguments),C[I]=a},te.normalizeArgs=function(I=":memory:",a="c",_=null){const d={};return arguments.length===1&&arguments[0]&&typeof arguments[0]=="object"?(Object.assign(d,arguments[0]),d.flags===void 0&&(d.flags="c"),d.vfs===void 0&&(d.vfs=null),d.filename===void 0&&(d.filename=":memory:")):(d.filename=I,d.flags=a,d.vfs=_),d};const y=function(...I){te.apply(this,I)};y.dbCtorHelper=te;const b={null:1,number:2,string:3,boolean:4,blob:5};r.bigIntEnabled&&(b.bigint=b.number);const R=function(){b!==arguments[2]&&n(i.SQLITE_MISUSE,"Do not call the Stmt constructor directly. Use DB.prepare()."),this.db=arguments[0],T.set(this,arguments[1]),arguments.length>3&&!arguments[3]&&J.add(this)},U=function(I){return I.pointer||n("DB has been closed."),I},w=function(I,a){return(a!==(a|0)||a<0||a>=I.columnCount)&&n("Column index",a,"is out of range."),I},O=function(I,a){const _=Object.create(null);switch(_.opt=Object.create(null),a.length){case 1:typeof a[0]=="string"||u.isSQLableTypedArray(a[0])||Array.isArray(a[0])?_.sql=a[0]:a[0]&&typeof a[0]=="object"&&(_.opt=a[0],_.sql=_.opt.sql);break;case 2:_.sql=a[0],_.opt=a[1];break;default:n("Invalid argument count for exec().")}_.sql=u.flexibleString(_.sql),typeof _.sql!="string"&&n("Missing SQL argument or unsupported SQL value type.");const d=_.opt;switch(d.returnValue){case"resultRows":d.resultRows||(d.resultRows=[]),_.returnVal=()=>d.resultRows;break;case"saveSql":d.saveSql||(d.saveSql=[]),_.returnVal=()=>d.saveSql;break;case void 0:case"this":_.returnVal=()=>I;break;default:n("Invalid returnValue value:",d.returnValue)}if(!d.callback&&!d.returnValue&&d.rowMode!==void 0&&(d.resultRows||(d.resultRows=[]),_.returnVal=()=>d.resultRows),d.callback||d.resultRows)switch(d.rowMode===void 0?"array":d.rowMode){case"object":_.cbArg=(E,W)=>{W.columnNames||(W.columnNames=E.getColumnNames([]));const K=E.get([]),D=Object.create(null);for(const h in W.columnNames)D[W.columnNames[h]]=K[h];return D};break;case"array":_.cbArg=E=>E.get([]);break;case"stmt":Array.isArray(d.resultRows)&&n("exec(): invalid rowMode for a resultRows array: must","be one of 'array', 'object',","a result column number, or column name reference."),_.cbArg=E=>E;break;default:if(u.isInt32(d.rowMode)){_.cbArg=E=>E.get(d.rowMode);break}else if(typeof d.rowMode=="string"&&d.rowMode.length>1&&d.rowMode[0]==="$"){const E=d.rowMode.substr(1);_.cbArg=W=>{const K=W.get(Object.create(null))[E];return K===void 0?n(i.SQLITE_NOTFOUND,"exec(): unknown result column:",E):K};break}n("Invalid rowMode:",d.rowMode)}return _},f=(I,a,_,...d)=>{const E=I.prepare(a);try{const W=E.bind(_).step()?E.get(...d):void 0;return E.reset(),W}finally{E.finalize()}},m=(I,a,_,d)=>I.exec({sql:a,bind:_,rowMode:d,returnValue:"resultRows"});y.checkRc=(I,a)=>p(I,a),y.prototype={isOpen:function(){return!!this.pointer},affirmOpen:function(){return U(this)},close:function(){const I=this.pointer;if(I){if(this.onclose&&this.onclose.before instanceof Function)try{this.onclose.before(this)}catch{}if(Object.keys(N.get(this)).forEach((a,_)=>{if(_&&_.pointer)try{_.finalize()}catch{}}),T.delete(this),N.delete(this),J.delete(this)||i.sqlite3_close_v2(I),this.onclose&&this.onclose.after instanceof Function)try{this.onclose.after(this)}catch{}delete this.filename}},changes:function(I=!1,a=!1){const _=U(this).pointer;return I?a?i.sqlite3_total_changes64(_):i.sqlite3_total_changes(_):a?i.sqlite3_changes64(_):i.sqlite3_changes(_)},dbFilename:function(I="main"){return i.sqlite3_db_filename(U(this).pointer,I)},dbName:function(I=0){return i.sqlite3_db_name(U(this).pointer,I)},dbVfsName:function(I=0){let a;const _=i.sqlite3_js_db_vfs(U(this).pointer,I);if(_){const d=new i.sqlite3_vfs(_);try{a=r.cstrToJs(d.$zName)}finally{d.dispose()}}return a},prepare:function(I){U(this);const a=r.pstack.pointer;let _,d;try{_=r.pstack.alloc(8),y.checkRc(this,i.sqlite3_prepare_v2(this.pointer,I,-1,_,null)),d=r.peekPtr(_)}finally{r.pstack.restore(a)}d||n("Cannot prepare empty SQL.");const E=new R(this,d,b);return N.get(this)[d]=E,E},exec:function(){U(this);const I=O(this,arguments);if(!I.sql)return n("exec() requires an SQL string.");const a=I.opt,_=a.callback,d=Array.isArray(a.resultRows)?a.resultRows:void 0;let E,W=a.bind,K=!!(I.cbArg||a.columnNames||d);const D=r.scopedAllocPush(),h=Array.isArray(a.saveSql)?a.saveSql:void 0;try{const P=u.isSQLableTypedArray(I.sql);let Q=P?I.sql.byteLength:r.jstrlen(I.sql);const re=r.scopedAlloc(2*r.ptr.size+(Q+1)),g=r.ptr.add(re,r.ptr.size);let L=r.ptr.add(g,r.ptr.size);const H=r.ptr.add(L,Q);for(P?r.heap8().set(I.sql,L):r.jstrcpy(I.sql,r.heap8(),L,Q,!1),r.poke8(r.ptr.add(L,Q),0);L&&r.peek8(L);){r.pokePtr([re,g],0),y.checkRc(this,i.sqlite3_prepare_v3(this.pointer,L,Q,0,re,g));const ie=r.peekPtr(re);if(L=r.peekPtr(g),Q=Number(r.ptr.add(H,-L)),!!ie){if(h&&h.push(i.sqlite3_sql(ie).trim()),E=new R(this,ie,b),W&&E.parameterCount&&(E.bind(W),W=null),K&&E.columnCount){let Z=Array.isArray(a.columnNames)?0:1;if(K=!1,I.cbArg||d){const ue=Object.create(null);for(;E.step();ye.delete(E)){Z++===0&&E.getColumnNames(ue.columnNames=a.columnNames||[]),ye.add(E);const Ee=I.cbArg(E,ue);if(d&&d.push(Ee),_&&_.call(a,Ee,E)===!1)break}ye.delete(E)}Z===0&&E.getColumnNames(a.columnNames)}else E.step();E.reset().finalize(),E=null}}}finally{E&&(ye.delete(E),E.finalize()),r.scopedAllocPop(D)}return I.returnVal()},createFunction:function(a,_,d){const E=ue=>ue instanceof Function;switch(arguments.length){case 1:d=a,a=d.name,_=d.xFunc||0;break;case 2:E(_)||(d=_,_=d.xFunc||0);break}d||(d={}),typeof a!="string"&&n("Invalid arguments: missing function name.");let W=d.xStep||0,K=d.xFinal||0;const D=d.xValue||0,h=d.xInverse||0;let P;E(_)?(P=!1,(E(W)||E(K))&&n("Ambiguous arguments: scalar or aggregate?"),W=K=null):E(W)?(E(K)||n("Missing xFinal() callback for aggregate or window UDF."),_=null):E(K)?n("Missing xStep() callback for aggregate or window UDF."):n("Missing function-type properties."),P===!1?(E(D)||E(h))&&n("xValue and xInverse are not permitted for non-window UDFs."):E(D)?(E(h)||n("xInverse must be provided if xValue is."),P=!0):E(h)&&n("xValue must be provided if xInverse is.");const Q=d.pApp;Q!=null&&!r.isPtr(Q)&&n("Invalid value for pApp property. Must be a legal WASM pointer value.");const re=d.xDestroy||0;re&&!E(re)&&n("xDestroy property must be a function.");let g=0;G(d,"deterministic")&&(g|=i.SQLITE_DETERMINISTIC),G(d,"directOnly")&&(g|=i.SQLITE_DIRECTONLY),G(d,"innocuous")&&(g|=i.SQLITE_INNOCUOUS),a=a.toLowerCase();const L=_||W,H=G(d,"arity"),ie=typeof H=="number"?H:L.length?L.length-1:0;let Z;return P?Z=i.sqlite3_create_window_function(this.pointer,a,ie,i.SQLITE_UTF8|g,Q||0,W,K,D,h,re):Z=i.sqlite3_create_function_v2(this.pointer,a,ie,i.SQLITE_UTF8|g,Q||0,_,W,K,re),y.checkRc(this,Z),this},selectValue:function(I,a,_){return f(this,I,a,0,_)},selectValues:function(I,a,_){const d=this.prepare(I),E=[];try{for(d.bind(a);d.step();)E.push(d.get(0,_));d.reset()}finally{d.finalize()}return E},selectArray:function(I,a){return f(this,I,a,[])},selectObject:function(I,a){return f(this,I,a,{})},selectArrays:function(I,a){return m(this,I,a,"array")},selectObjects:function(I,a){return m(this,I,a,"object")},openStatementCount:function(){return this.pointer?Object.keys(N.get(this)).length:0},transaction:function(I){let a="BEGIN";arguments.length>1&&(/[^a-zA-Z]/.test(arguments[0])&&n(i.SQLITE_MISUSE,"Invalid argument for BEGIN qualifier."),a+=" "+arguments[0],I=arguments[1]),U(this).exec(a);try{const _=I(this);return this.exec("COMMIT"),_}catch(_){throw this.exec("ROLLBACK"),_}},savepoint:function(I){U(this).exec("SAVEPOINT oo1");try{const a=I(this);return this.exec("RELEASE oo1"),a}catch(a){throw this.exec("ROLLBACK to SAVEPOINT oo1; RELEASE SAVEPOINT oo1"),a}},checkRc:function(I){return p(this,I)}},y.wrapHandle=function(I,a=!1){if(!I||!r.isPtr(I))throw new s.SQLite3Error(i.SQLITE_MISUSE,"Argument must be a WASM sqlite3 pointer");return new y({"sqlite3*":I,"sqlite3*:takeOwnership":!!a})};const q=function(I){return I.pointer||n("Stmt has been closed."),I},j=function(I){let a=b[I==null?"null":typeof I];switch(a){case b.boolean:case b.null:case b.number:case b.string:return a;case b.bigint:return r.bigIntEnabled?a:void 0;default:return u.isBindableTypedArray(I)?b.blob:void 0}},Y=function(I){return j(I)||n("Unsupported bind() argument type:",typeof I)},ae=function(I,a){const _=typeof a=="number"?a:i.sqlite3_bind_parameter_index(I.pointer,a);return _===0||!u.isInt32(_)?n("Invalid bind() parameter name: "+a):(_<1||_>I.parameterCount)&&n("Bind index",a,"is out of range."),_},ye=new Set,ve=new Set,de=function(I,a){return ye.has(I)&&n("Operation is illegal when statement is locked:",a),I},V=function I(a,_,d,E){de(q(a),"bind()"),I._||(I._tooBigInt=K=>n("BigInt value is too big to store without precision loss:",K),I._={string:function(K,D,h,P){const[Q,re]=r.allocCString(h,!0);return(P?i.sqlite3_bind_blob:i.sqlite3_bind_text)(K.pointer,D,Q,re,i.SQLITE_WASM_DEALLOC)}}),Y(E),_=ae(a,_);let W=0;switch(E==null?b.null:d){case b.null:W=i.sqlite3_bind_null(a.pointer,_);break;case b.string:W=I._.string(a,_,E,!1);break;case b.number:{let K;u.isInt32(E)?K=i.sqlite3_bind_int:typeof E=="bigint"?u.bigIntFits64(E)?r.bigIntEnabled?K=i.sqlite3_bind_int64:u.bigIntFitsDouble(E)?(E=Number(E),K=i.sqlite3_bind_double):I._tooBigInt(E):I._tooBigInt(E):(E=Number(E),r.bigIntEnabled&&Number.isInteger(E)?K=i.sqlite3_bind_int64:K=i.sqlite3_bind_double),W=K(a.pointer,_,E);break}case b.boolean:W=i.sqlite3_bind_int(a.pointer,_,E?1:0);break;case b.blob:{if(typeof E=="string"){W=I._.string(a,_,E,!0);break}else E instanceof ArrayBuffer?E=new Uint8Array(E):u.isBindableTypedArray(E)||n("Binding a value as a blob requires","that it be a string, Uint8Array, Int8Array, or ArrayBuffer.");const K=r.alloc(E.byteLength||1);r.heap8().set(E.byteLength?E:[0],Number(K)),W=i.sqlite3_bind_blob(a.pointer,_,K,E.byteLength,i.SQLITE_WASM_DEALLOC);break}default:s.config.warn("Unsupported bind() argument type:",E),n("Unsupported bind() argument type: "+typeof E)}return W&&y.checkRc(a.db.pointer,W),a};R.prototype={finalize:function(){const I=this.pointer;if(I){de(this,"finalize()");const a=J.delete(this)?0:i.sqlite3_finalize(I);return delete N.get(this.db)[I],T.delete(this),ye.delete(this),ve.delete(this),delete this.parameterCount,delete this.db,a}},clearBindings:function(){return de(q(this),"clearBindings()"),i.sqlite3_clear_bindings(this.pointer),ve.delete(this),this},reset:function(I){de(this,"reset()"),I&&this.clearBindings();const a=i.sqlite3_reset(q(this).pointer);return ve.delete(this),p(this.db,a),this},bind:function(){q(this);let I,a;switch(arguments.length){case 1:I=1,a=arguments[0];break;case 2:I=arguments[0],a=arguments[1];break;default:n("Invalid bind() arguments.")}return a===void 0?this:(this.parameterCount||n("This statement has no bindable parameters."),ve.delete(this),a===null?V(this,I,b.null,a):Array.isArray(a)?(arguments.length!==1&&n("When binding an array, an index argument is not permitted."),a.forEach((_,d)=>V(this,d+1,Y(_),_)),this):(a instanceof ArrayBuffer&&(a=new Uint8Array(a)),typeof a=="object"&&!u.isBindableTypedArray(a)?(arguments.length!==1&&n("When binding an object, an index argument is not permitted."),Object.keys(a).forEach(_=>V(this,_,Y(a[_]),a[_])),this):V(this,I,Y(a),a)))},bindAsBlob:function(I,a){q(this),arguments.length===1&&(a=I,I=1);const _=Y(a);return b.string!==_&&b.blob!==_&&b.null!==_&&n("Invalid value type for bindAsBlob()"),V(this,I,b.blob,a)},step:function(){de(this,"step()");const I=i.sqlite3_step(q(this).pointer);switch(I){case i.SQLITE_DONE:return ve.delete(this),!1;case i.SQLITE_ROW:return ve.add(this),!0;default:ve.delete(this),s.config.warn("sqlite3_step() rc=",I,i.sqlite3_js_rc_str(I),"SQL =",i.sqlite3_sql(this.pointer)),y.checkRc(this.db.pointer,I)}},stepReset:function(){return this.step(),this.reset()},stepFinalize:function(){try{const I=this.step();return this.reset(),I}finally{try{this.finalize()}catch{}}},get:function(I,a){if(ve.has(q(this))||n("Stmt.step() has not (recently) returned true."),Array.isArray(I)){let _=0;const d=this.columnCount;for(;_<d;)I[_]=this.get(_++);return I}else if(I&&typeof I=="object"){let _=0;const d=this.columnCount;for(;_<d;)I[i.sqlite3_column_name(this.pointer,_)]=this.get(_++);return I}switch(w(this,I),a===void 0?i.sqlite3_column_type(this.pointer,I):a){case i.SQLITE_NULL:return null;case i.SQLITE_INTEGER:if(r.bigIntEnabled){const _=i.sqlite3_column_int64(this.pointer,I);return _>=Number.MIN_SAFE_INTEGER&&_<=Number.MAX_SAFE_INTEGER?Number(_).valueOf():_}else{const _=i.sqlite3_column_double(this.pointer,I);return(_>Number.MAX_SAFE_INTEGER||_<Number.MIN_SAFE_INTEGER)&&n("Integer is out of range for JS integer range: "+_),u.isInt32(_)?_|0:_}case i.SQLITE_FLOAT:return i.sqlite3_column_double(this.pointer,I);case i.SQLITE_TEXT:return i.sqlite3_column_text(this.pointer,I);case i.SQLITE_BLOB:{const _=i.sqlite3_column_bytes(this.pointer,I),d=i.sqlite3_column_blob(this.pointer,I),E=new Uint8Array(_);return _&&(E.set(r.heap8u().slice(Number(d),Number(d)+_),0),this.db._blobXfer instanceof Array&&this.db._blobXfer.push(E.buffer)),E}default:n("Don't know how to translate","type of result column #"+I+".")}n("Not reached.")},getInt:function(I){return this.get(I,i.SQLITE_INTEGER)},getFloat:function(I){return this.get(I,i.SQLITE_FLOAT)},getString:function(I){return this.get(I,i.SQLITE_TEXT)},getBlob:function(I){return this.get(I,i.SQLITE_BLOB)},getJSON:function(I){const a=this.get(I,i.SQLITE_STRING);return a===null?a:JSON.parse(a)},getColumnName:function(I){return i.sqlite3_column_name(w(q(this),I).pointer,I)},getColumnNames:function(I=[]){w(q(this),0);const a=this.columnCount;for(let _=0;_<a;++_)I.push(i.sqlite3_column_name(this.pointer,_));return I},getParamIndex:function(I){return q(this).parameterCount?i.sqlite3_bind_parameter_index(this.pointer,I):void 0},getParamName:function(I){return q(this).parameterCount?i.sqlite3_bind_parameter_name(this.pointer,I):void 0},isBusy:function(){return i.sqlite3_stmt_busy(q(this))!==0},isReadOnly:function(){return i.sqlite3_stmt_readonly(q(this))!==0}};{const I={enumerable:!0,get:function(){return T.get(this)},set:()=>n("The pointer property is read-only.")};Object.defineProperty(R.prototype,"pointer",I),Object.defineProperty(y.prototype,"pointer",I)}Object.defineProperty(R.prototype,"columnCount",{enumerable:!1,get:function(){return i.sqlite3_column_count(this.pointer)},set:()=>n("The columnCount property is read-only.")}),Object.defineProperty(R.prototype,"parameterCount",{enumerable:!1,get:function(){return i.sqlite3_bind_parameter_count(this.pointer)},set:()=>n("The parameterCount property is read-only.")}),R.wrapHandle=function(I,a,_=!1){if(!(I instanceof y)||!I.pointer)throw new s.SQLite3Error(s.SQLITE_MISUSE,"First argument must be an opened sqlite3.oo1.DB instance");if(!a||!r.isPtr(a))throw new s.SQLite3Error(s.SQLITE_MISUSE,"Second argument must be a WASM sqlite3_stmt pointer");return new R(I,a,b,!!_)},s.oo1={DB:y,Stmt:R}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const n=s.util;s.initWorker1API=(function(){const i=(...z)=>{throw new Error(z.join(" "))};globalThis.WorkerGlobalScope instanceof Function||i("initWorker1API() must be run from a Worker thread.");const r=this.sqlite3||i("Missing this.sqlite3 object."),u=r.oo1.DB,F=function(z){let C=T.idMap.get(z);return C||(C="db#"+ ++T.idSeq+":"+Math.floor(Math.random()*1e8)+":"+Math.floor(Math.random()*1e8),T.idMap.set(z,C),C)},T={dbList:[],idSeq:0,idMap:new WeakMap,xfer:[],open:function(z){const C=new u(z);return this.dbs[F(C)]=C,this.dbList.indexOf(C)<0&&this.dbList.push(C),C},close:function(z,C){if(z){delete this.dbs[F(z)];const te=z.filename,y=n.sqlite3__wasm_db_vfs(z.pointer,0);z.close();const b=this.dbList.indexOf(z);b>=0&&this.dbList.splice(b,1),C&&te&&y&&n.sqlite3__wasm_vfs_unlink(y,te)}},post:function(z,C){C&&C.length?(globalThis.postMessage(z,Array.from(C)),C.length=0):globalThis.postMessage(z)},dbs:Object.create(null),getDb:function(z,C=!0){return this.dbs[z]||(C?i("Unknown (or closed) DB ID:",z):void 0)}},J=function(z=T.dbList[0]){return z&&z.pointer?z:i("DB is not opened.")},N=function(z,C=!0){const te=T.getDb(z.dbId,!1)||T.dbList[0];return C?J(te):te},G=function(){return T.dbList[0]&&F(T.dbList[0])},p={open:function(z){const C=Object.create(null),te=z.args||Object.create(null);te.simulateError&&i("Throwing because of simulateError flag.");const y=Object.create(null);C.vfs=te.vfs,C.filename=te.filename||"";const b=T.open(C);return y.filename=b.filename,y.persistent=!!r.capi.sqlite3_js_db_uses_vfs(b.pointer,"opfs"),y.dbId=F(b),y.vfs=b.dbVfsName(),y},close:function(z){const C=N(z,!1),te={filename:C&&C.filename};if(C){const y=z.args&&typeof z.args=="object"?!!z.args.unlink:!1;T.close(C,y)}return te},exec:function(z){const C=typeof z.args=="string"?{sql:z.args}:z.args||Object.create(null);C.rowMode==="stmt"?i("Invalid rowMode for 'exec': stmt mode","does not work in the Worker API."):C.sql||i("'exec' requires input SQL.");const te=N(z);(C.callback||Array.isArray(C.resultRows))&&(te._blobXfer=T.xfer);const y=C.callback;let b=0;const R=!!C.columnNames;typeof y=="string"&&(R||(C.columnNames=[]),C.callback=function(U,w){T.post({type:y,columnNames:C.columnNames,rowNumber:++b,row:U},T.xfer)});try{const U=C.countChanges?te.changes(!0,C.countChanges===64):void 0;te.exec(C),U!==void 0&&(C.changeCount=te.changes(!0,C.countChanges===64)-U);const w=C.lastInsertRowId?r.capi.sqlite3_last_insert_rowid(te):void 0;w!==void 0&&(C.lastInsertRowId=w),C.callback instanceof Function&&(C.callback=y,T.post({type:y,columnNames:C.columnNames,rowNumber:null,row:void 0}))}finally{delete te._blobXfer,C.callback&&(C.callback=y)}return C},"config-get":function(){const z=Object.create(null),C=r.config;return["bigIntEnabled"].forEach(function(te){Object.getOwnPropertyDescriptor(C,te)&&(z[te]=C[te])}),z.version=r.version,z.vfsList=r.capi.sqlite3_js_vfs_list(),z},export:function(z){const C=N(z),te={byteArray:r.capi.sqlite3_js_db_export(C.pointer),filename:C.filename,mimetype:"application/x-sqlite3"};return T.xfer.push(te.byteArray.buffer),te},toss:function(z){i("Testing worker exception")}};globalThis.onmessage=async function(z){z=z.data;let C,te=z.dbId,y=z.type;const b=performance.now();try{p.hasOwnProperty(y)&&p[y]instanceof Function?C=await p[y](z):i("Unknown db worker message type:",z.type)}catch(R){y="error",C={operation:z.type,message:R.message,errorClass:R.name,input:z},R.stack&&(C.stack=typeof R.stack=="string"?R.stack.split(/\n\s*/):R.stack)}te||(te=C.dbId||G()),T.post({type:y,dbId:te,messageId:z.messageId,workerReceivedTime:b,workerRespondTime:performance.now(),departureTime:z.departureTime,result:C},T.xfer)},globalThis.postMessage({type:"sqlite3-api",result:"worker1-ready"})}).bind({sqlite3:s})}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const n=s.wasm,i=s.capi,r=s.util.toss3,u=Object.create(null);s.vfs=u,i.sqlite3_vfs.prototype.registerVfs=function(F=!1){this instanceof s.capi.sqlite3_vfs||r("Expecting a sqlite3_vfs-type argument.");const T=i.sqlite3_vfs_register(this,F?1:0);return T&&r("sqlite3_vfs_register(",this,") failed with rc",T),this.pointer!==i.sqlite3_vfs_find(this.$zName)&&r("BUG: sqlite3_vfs_find(vfs.$zName) failed for just-installed VFS",this),this},u.installVfs=function(F){let T=0;const J=["io","vfs"];for(const N of J){const G=F[N];G&&(++T,G.struct.installMethods(G.methods,!!G.applyArgcCheck),N==="vfs"&&(!G.struct.$zName&&typeof G.name=="string"&&G.struct.addOnDispose(G.struct.$zName=n.allocCString(G.name)),G.struct.registerVfs(!!G.asDefault)))}return T||r("Misuse: installVfs() options object requires at least","one of:",J),this}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){if(!s.wasm.exports.sqlite3_declare_vtab)return;const n=s.wasm,i=s.capi,r=s.util.toss3,u=Object.create(null);s.vtab=u;const F=i.sqlite3_index_info;F.prototype.nthConstraint=function(N,G=!1){if(N<0||N>=this.$nConstraint)return!1;const p=n.ptr.add(this.$aConstraint,F.sqlite3_index_constraint.structInfo.sizeof*N);return G?p:new F.sqlite3_index_constraint(p)},F.prototype.nthConstraintUsage=function(N,G=!1){if(N<0||N>=this.$nConstraint)return!1;const p=n.ptr.add(this.$aConstraintUsage,F.sqlite3_index_constraint_usage.structInfo.sizeof*N);return G?p:new F.sqlite3_index_constraint_usage(p)},F.prototype.nthOrderBy=function(N,G=!1){if(N<0||N>=this.$nOrderBy)return!1;const p=n.ptr.add(this.$aOrderBy,F.sqlite3_index_orderby.structInfo.sizeof*N);return G?p:new F.sqlite3_index_orderby(p)};const T=function(N,G){return(function(p,z=!1){if(arguments.length===0&&(p=new G),p instanceof G)return this.set(p.pointer,p),p;n.isPtr(p)||s.SQLite3Error.toss("Invalid argument to",N+"()");let C=this.get(p);return z&&this.delete(p),C}).bind(new Map)},J=function(N,G){const p=T(N,G);return Object.assign(Object.create(null),{StructType:G,create:z=>{const C=p();return n.pokePtr(z,C.pointer),C},get:z=>p(z),unget:z=>p(z,!0),dispose:z=>p(z,!0)?.dispose?.()})};u.xVtab=J("xVtab",i.sqlite3_vtab),u.xCursor=J("xCursor",i.sqlite3_vtab_cursor),u.xIndexInfo=N=>new i.sqlite3_index_info(N),u.xError=function N(G,p,z){if(N.errorReporter instanceof Function)try{N.errorReporter("sqlite3_module::"+G+"(): "+p.message)}catch{}let C;return p instanceof s.WasmAllocError?C=i.SQLITE_NOMEM:arguments.length>2?C=z:p instanceof s.SQLite3Error&&(C=p.resultCode),C||i.SQLITE_ERROR},u.xError.errorReporter=s.config.error.bind(s.config),u.xRowid=(N,G)=>n.poke(N,G,"i64"),u.setupModule=function(N){let G=!1;const p=this instanceof i.sqlite3_module?this:N.struct||(G=new i.sqlite3_module);try{const z=N.methods||r("Missing 'methods' object.");for(const C of Object.entries({xConnect:"xCreate",xDisconnect:"xDestroy"})){const te=C[0],y=C[1];z[te]===!0?z[te]=z[y]:z[y]===!0&&(z[y]=z[te])}if(N.catchExceptions){const C=function(b,R){return["xConnect","xCreate"].indexOf(b)>=0?function(U,w,O,f,m,q){try{return R(...arguments)||0}catch(j){return j instanceof s.WasmAllocError||(n.dealloc(n.peekPtr(q)),n.pokePtr(q,n.allocCString(j.message))),u.xError(b,j)}}:function(...U){try{return R(...U)||0}catch(w){return u.xError(b,w)}}},te=["xCreate","xConnect","xBestIndex","xDisconnect","xDestroy","xOpen","xClose","xFilter","xNext","xEof","xColumn","xRowid","xUpdate","xBegin","xSync","xCommit","xRollback","xFindFunction","xRename","xSavepoint","xRelease","xRollbackTo","xShadowName"],y=Object.create(null);for(const b of te){const R=z[b];if(R instanceof Function)b==="xConnect"&&z.xCreate===R?y[b]=z.xCreate:b==="xCreate"&&z.xConnect===R?y[b]=z.xConnect:y[b]=C(b,R);else continue}p.installMethods(y,!1)}else p.installMethods(z,!!N.applyArgcCheck);if(p.$iVersion===0){let C;typeof N.iVersion=="number"?C=N.iVersion:p.$xIntegrity?C=4:p.$xShadowName?C=3:p.$xSavePoint||p.$xRelease||p.$xRollbackTo?C=2:C=1,p.$iVersion=C}}catch(z){throw G&&G.dispose(),z}return p},i.sqlite3_module.prototype.setupModule=function(N){return u.setupModule.call(this,N)}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const n=s.capi,i=n.sqlite3_kvvfs_methods,r=n.KVVfsFile,u=s.capi.sqlite3_vfs_find("kvvfs");if(delete n.sqlite3_kvvfs_methods,delete n.KVVfsFile,!u)return;const F=s.util,T=s.wasm,J=F.toss3,N=(S,x)=>Object.prototype.hasOwnProperty.call(S,x),G=new i(T.exports.sqlite3__wasm_kvvfs_methods());F.assert(32<=G.$nKeySize,"unexpected kvvfsMethods.$nKeySize: "+G.$nKeySize);const p=Object.assign(Object.create(null),{rxJournalSuffix:/-journal$/,zKeyJrnl:T.allocCString("jrnl"),zKeySz:T.allocCString("sz"),keySize:G.$nKeySize,buffer:Object.assign(Object.create(null),{n:G.$nBufferSize,pool:Object.create(null)})});p.memBuffer=(S=0)=>p.buffer.pool[S]??=T.alloc(p.buffer.n),p.memBufferFree=S=>{const x=p.buffer.pool[S];x&&(T.dealloc(x),delete p.buffer.pool[S])};const z=()=>{},C=s.__isUnderTest?(...S)=>s.config.debug("kvvfs:",...S):z,te=(...S)=>s.config.warn("kvvfs:",...S),y=(...S)=>s.config.error("kvvfs:",...S);class b{#e;#r;#a(){return this.#r??=Object.keys(this.#e)}constructor(){this.clear()}key(x){const M=this.#a();return x<M.length?M[x]:null}getItem(x){return this.#e[x]??null}setItem(x,M){N(this.#e,x)||(this.#r=null),this.#e[x]=""+M}removeItem(x){delete this.#e[x]&&(this.#r=null)}clear(){this.#e=Object.create(null),this.#r=null}get length(){return this.#a().length}}const R=S=>S==="local"||S==="session",U=S=>R(S)?"kvvfs-"+S+"-":"",w=function(S,x=!1){if(R(S))return;const M=new Blob([S]).size;M||J(n.SQLITE_MISUSE,"Empty name is not permitted.");let B=p.keySize-1;p.rxJournalSuffix.test(S)?x||J(n.SQLITE_MISUSE,"Storage names may not have a '-journal' suffix."):["-wal","-shm"].filter(le=>S.endsWith(le)).length?J(n.SQLITE_MISUSE,"Storage names may not have a -wal or -shm suffix."):B-=8,M>B&&J(n.SQLITE_RANGE,"Storage name is too long. Limit =",B);let ee;for(ee=0;ee<M;++ee){const le=S.codePointAt(ee);le<32&&J(n.SQLITE_RANGE,"Illegal character ("+le+"d) in storage name:",S)}},O=(S,x=void 0)=>Object.assign(Object.create(null),{jzClass:S,refc:1,deleteAtRefc0:!1,storage:x||new b,keyPrefix:U(S),files:[],listeners:void 0}),f=s.kvvfs=Object.create(null);s.__isUnderTest&&(f.log=Object.assign(Object.create(null),{xOpen:!1,xClose:!1,xWrite:!1,xRead:!1,xSync:!1,xAccess:!1,xFileControl:!1,xRcrdRead:!1,xRcrdWrite:!1,xRcrdDelete:!1}));const m=function(S){const x=p.rxJournalSuffix.test(S.jzClass)?S.jzClass.replace(p.rxJournalSuffix,""):S.jzClass+"-journal";f?.log?.xClose&&C("cleaning up storage handles [",S.jzClass,x,"]",S),delete p.storagePool[S.jzClass],delete p.storagePool[x],s.__isUnderTest||(delete S.storage,delete S.refc)},q=S=>p.storagePool[S.jzClass]=p.storagePool[S.jzClass+"-journal"]=S,j=".";p.storagePool=Object.assign(Object.create(null),{[j]:O(j)}),globalThis.Storage&&(globalThis.localStorage instanceof globalThis.Storage&&(p.storagePool.local=O("local",globalThis.localStorage)),globalThis.sessionStorage instanceof globalThis.Storage&&(p.storagePool.session=O("session",globalThis.sessionStorage))),p.builtinStorageNames=Object.keys(p.storagePool);const Y=S=>p.builtinStorageNames.indexOf(S)>-1;for(const S of Object.keys(p.storagePool)){const x=p.storagePool[S];p.storagePool[S+"-journal"]=x}p.setError=(S=void 0,x=n.SQLITE_ERROR)=>S?(p.lastError=S,S.resultCode|0||x):(delete p.lastError,0),p.popError=()=>{const S=p.lastError;return delete p.lastError,S};const ae=S=>{te("kvvfs.listener handler threw:",S)},ye=T.exports.sqlite3__wasm_kvvfs_decode,ve=T.exports.sqlite3__wasm_kvvfs_encode,de=async function(S,x,...M){try{x.keyPrefix&&M[0]&&(M[0]=M[0].replace(x.keyPrefix,""));let B,ee,le,fe;for(const ce of x.listeners){const me=Object.create(null);me.storageName=x.jzClass,me.type=S,ce.decodePages;const Te=ce.events[S];if(Te){if(!ce.includeJournal&&M[0]==="jrnl")continue;if(S==="write"&&ce.decodePages&&+M[0]>0){if(me.data=[M[0]],fe?.[M[0]]){me.data[1]=fe[M[0]];continue}B??=new TextEncoder("utf-8"),ee??=p.memBuffer(10),le??=p.memBuffer(11);const Fe=B.encode(M[1]),Se=T.heap8u();Se.set(Fe,Number(ee)),Se[T.ptr.addn(ee,Fe.length)]=0;const Me=ye(ee,le,p.buffer.n);if(Me>0)fe??=Object.create(null),fe[M[0]]=me.data[1]=Se.slice(Number(le),T.ptr.addn(le,Me));else continue}else me.data=M.length?M.length===1?M[0]:M:void 0;try{Te(me)?.catch?.(ae)}catch(Fe){te("notifyListeners [",x.jzClass,"]",S,Fe)}}}}catch(B){ae(B)}},V=S=>typeof S=="string"?p.storagePool[S]:p.storagePool[T.cstrToJs(S)],I=T.exports.sqlite3__wasm_kvvfsMakeKey,a=(S,x,M)=>x&&S.keyPrefix?I(x,M):M,_=(S,x,M)=>T.cstrToJs(a(S,x,M)),d=S=>+S.storage.getItem(S.keyPrefix+"sz"),E=new Map,W={vfs:Object.create(null),ioDb:Object.create(null),ioJrnl:Object.create(null)},K=new n.sqlite3_vfs(G.$pVfs),D=new n.sqlite3_io_methods(G.$pIoDb),h=new n.sqlite3_io_methods(G.$pIoJrnl),P=Object.create(null),Q=Object.assign(Object.create(null),{pFileHandles:E,cache:p,storageForZClass:V,KVVfsStorage:b,disablePageSizeChange:!0});f.log&&(f.internal=Q);const re={recordHandler:{xRcrdRead:(S,x,M,B)=>{try{const ee=T.cstrToJs(S),le=V(ee);if(!le)return-1;const fe=_(le,S,x);f?.log?.xRcrdRead&&te("xRcrdRead",ee,fe,B,le);const ce=le.storage.getItem(fe);if(ce===null)return-1;const me=ce.length;if(B<=0)return me;if(B===1)return T.poke(M,0),me;B+1<me&&J(n.SQLITE_RANGE,"xRcrdRead()",ee,fe,"input buffer is too small: need",me,"but have",B);const Te=p.memBuffer(0),Fe=T.heap8();let Se;for(Se=0;Se<me;++Se)Fe[T.ptr.add(Te,Se)]=ce.codePointAt(Se)&255;return Fe.copyWithin(Number(M),Number(Te),T.ptr.addn(Te,Se)),Fe[T.ptr.add(M,me)]=0,B}catch(ee){return y("kvrecordRead()",ee),p.setError(ee),-2}},xRcrdWrite:(S,x,M)=>{try{const B=V(S),ee=_(B,S,x),le=T.cstrToJs(M);return f?.log?.xRcrdWrite&&te("xRcrdWrite",ee,B),B.storage.setItem(ee,le),B.listeners&&de("write",B,ee,le),0}catch(B){return y("kvrecordWrite()",B),p.setError(B,n.SQLITE_IOERR)}},xRcrdDelete:(S,x)=>{try{const M=V(S),B=_(M,S,x);return f?.log?.xRcrdDelete&&te("xRcrdDelete",B,M),M.storage.removeItem(B),M.listeners&&de("delete",M,B),0}catch(M){return y("kvrecordDelete()",M),p.setError(M,n.SQLITE_IOERR)}}},vfs:{xOpen:function(S,x,M,B,ee){p.popError();let le;try{x||(le=T.allocCString(""+M+"."+(Math.random()*1e5|0)),x=le);const fe=T.cstrToJs(x);f?.log?.xOpen&&C("xOpen",fe,"flags =",B),w(fe,!0),B&(n.SQLITE_OPEN_MAIN_DB|n.SQLITE_OPEN_TEMP_DB|n.SQLITE_OPEN_TRANSIENT_DB)&&p.rxJournalSuffix.test(fe)&&J(n.SQLITE_ERROR,"DB files may not have a '-journal' suffix.");let ce=V(fe);!ce&&!(B&n.SQLITE_OPEN_CREATE)&&J(n.SQLITE_ERROR,"Storage not found:",fe);const me=W.vfs.xOpen(S,x,M,B,ee);if(me)return me;let Te=!!(n.SQLITE_OPEN_DELETEONCLOSE&B);T.isPtr(arguments[1])&&n.sqlite3_uri_boolean(x,"delete-on-close",0)&&(Te=!0);const Fe=new r(M);if(F.assert(Fe.$zClass,"Missing f.$zClass"),Fe.addOnDispose(le),le=void 0,ce)++ce.refc,ce.files.push(Fe),T.poke32(ee,B);else{T.poke32(ee,B|n.SQLITE_OPEN_CREATE),F.assert(!Fe.$isJournal,"Opening a journal before its db? "+fe);const Se=fe.replace(p.rxJournalSuffix,"");ce=O(Se),q(ce),ce.files.push(Fe),ce.deleteAtRefc0=Te,f?.log?.xOpen&&C("xOpen installed storage handle [",Se,Se+"-journal","]",ce)}return E.set(M,{store:ce,file:Fe,jzClass:fe}),ce.listeners&&de("open",ce,ce.files.length),0}catch(fe){return te("xOpen:",fe),p.setError(fe)}finally{le&&T.dealloc(le)}},xDelete:function(S,x,M){p.popError();try{const B=T.cstrToJs(x);return p.rxJournalSuffix.test(B)&&P.xRcrdDelete(x,p.zKeyJrnl),0}catch(B){return te("xDelete",B),p.setError(B)}},xAccess:function(S,x,M,B){p.popError();try{const ee=V(x),le=ee?.jzClass||T.cstrToJs(x);if(f?.log?.xAccess&&C("xAccess",le,"flags =",M,"*pResOut =",T.peek32(B),"store =",ee),!ee)try{w(le)}catch{return T.poke32(B,0),0}if(ee){const fe=ee.keyPrefix+(p.rxJournalSuffix.test(le)?"jrnl":"1"),ce=ee.storage.getItem(fe)?0:1;T.poke32(B,ce)}else T.poke32(B,0);return 0}catch(ee){return y("xAccess",ee),p.setError(ee)}},xRandomness:function(S,x,M){const B=T.heap8u();let ee=0;const le=Number(M);for(;ee<x;++ee)B[le+ee]=Math.random()*255e3&255;return x},xGetLastError:function(S,x,M){const B=p.popError();if(C("xGetLastError",B),B){const ee=T.scopedAllocPush();try{const[le,fe]=T.scopedAllocCString(B.message,!0);return T.cstrncpy(M,le,x),fe>x&&T.poke8(T.ptr.add(M,x,-1),0),C("set xGetLastError",B.message),B.resultCode|0||n.SQLITE_IOERR}catch{return n.SQLITE_NOMEM}finally{T.scopedAllocPop(ee)}}return 0}},ioDb:{xClose:function(S){p.popError();try{const x=E.get(S);if(f?.log?.xClose&&C("xClose",S,x),x){E.delete(S);const M=x.store;M.files=M.files.filter(B=>B!==x.file),--M.refc<=0&&M.deleteAtRefc0&&m(M),W.ioDb.xClose(S),x.file.dispose(),M.listeners&&de("close",M,M.files.length)}return 0}catch(x){return y("xClose",x),p.setError(x)}},xFileControl:function(S,x,M){p.popError();try{const B=E.get(S);if(F.assert(B,"Missing KVVfsFile handle"),f?.log?.xFileControl&&C("xFileControl",B,"op =",x),x===n.SQLITE_FCNTL_PRAGMA&&Q.disablePageSizeChange){const le=T.peekPtr(T.ptr.add(M,T.ptr.size));if(T.cstrToJs(le)==="page_size"){f?.log?.xFileControl&&C("xFileControl pragma",T.cstrToJs(le));const fe=T.peekPtr(T.ptr.add(M,2*T.ptr.size));if(fe)return f?.log?.xFileControl&&te("xFileControl pragma",B,"NOT setting page size to",T.cstrToJs(fe)),B.file.$szPage=-1,0;if(B.file.$szPage>0)return f?.log?.xFileControl&&te("xFileControl",B,"getting page size",B.file.$szPage),T.pokePtr(M,T.allocCString(""+B.file.$szPage)),0}}const ee=W.ioDb.xFileControl(S,x,M);return ee==0&&n.SQLITE_FCNTL_SYNC===x&&B.store.listeners&&de("sync",B.store,!1),ee}catch(B){return y("xFileControl",B),p.setError(B)}},xSync:function(S,x){p.popError();try{const M=E.get(S);f?.log?.xSync&&C("xSync",M),F.assert(M,"Missing KVVfsFile handle");const B=W.ioDb.xSync(S,x);return B==0&&M.store.listeners&&de("sync",M.store,!0),B}catch(M){return y("xSync",M),p.setError(M)}},xRead:function(S,x,M,B){p.popError();try{if(f?.log?.xRead){const ee=E.get(S);F.assert(ee,"Missing KVVfsFile handle"),C("xRead",M,B,ee)}return W.ioDb.xRead(S,x,M,B)}catch(ee){return y("xRead",ee),p.setError(ee)}},xWrite:function(S,x,M,B){p.popError();try{if(f?.log?.xWrite){const ee=E.get(S);F.assert(ee,"Missing KVVfsFile handle"),C("xWrite",M,B,ee)}return W.ioDb.xWrite(S,x,M,B)}catch(ee){return y("xWrite",ee),p.setError(ee)}}},ioJrnl:{xClose:!0}};C("pVfs and friends",K,D,h,G,n.sqlite3_file.structInfo,r.structInfo);try{F.assert(p.buffer.n>1024*129,"Heap buffer is not large enough");for(const S of Object.entries(re.recordHandler)){const x=S[0],M=S[1];P[x]=M,G[G.memberKey(x)]=T.installFunction(G.memberSignature(x),M)}for(const S of Object.entries(re.vfs)){const x=S[0],M=S[1],B=K.memberKey(x),ee=K.structInfo.members[x]||F.toss("Missing pVfs.structInfo[",x,"]");W.vfs[x]=T.functionEntry(K[B]),K[B]=T.installFunction(ee.signature,M)}for(const S of Object.entries(re.ioDb)){const x=S[0],M=S[1],B=D.memberKey(x);W.ioDb[x]=T.functionEntry(D[B])||F.toss("Missing native pIoDb[",B,"]"),D[B]=T.installFunction(D.memberSignature(x),M)}for(const S of Object.entries(re.ioJrnl)){const x=S[0],M=S[1],B=h.memberKey(x);W.ioJrnl[x]=T.functionEntry(h[B])||F.toss("Missing native pIoJrnl[",B,"]"),M===!0?h[B]=D[B]||F.toss("Missing copied pIoDb[",B,"]"):h[B]=T.installFunction(h.memberSignature(x),M)}}finally{G.dispose(),K.dispose(),D.dispose(),h.dispose()}const g=function S(x){if(x==="")return S("local")+S("session");const M=V(x);if(!M)return 0;M.files.length&&(globalThis.localStorage===M.storage||globalThis.sessionStorage===M.storage||J(n.SQLITE_ACCESS,"Cannot clear in-use database storage."));const B=M.storage,ee=[];let le,fe=B.length;for(le=0;le<fe;++le){const ce=B.key(le);(!M.keyPrefix||ce.startsWith(M.keyPrefix))&&ee.push(ce)}return ee.forEach(ce=>B.removeItem(ce)),ee.length},L=function S(x){if(x==="")return S("local")+S("session");const M=V(x);if(!M)return 0;const B=M.storage;let ee,le=0;for(ee=0;ee<B.length;++ee){const fe=B.key(ee);(!M.keyPrefix||fe.startsWith(M.keyPrefix))&&(le+=fe.length,le+=B.getItem(fe).length)}return le*2},H=function(...x){let M;x.length===1&&typeof x[0]=="object"?M=x[0]:x.length&&(M=Object.assign(Object.create(null),{name:x[0]}));const B=M?V(M.name):null;B||J(n.SQLITE_NOTFOUND,"There is no kvvfs storage named",M?.name);const ee=B.storage,le=Object.assign(Object.create(null),{name:B.jzClass,timestamp:Date.now(),pages:[]}),fe=Object.create(null),ce=B.keyPrefix,me=ce?/^kvvfs-[^-]+-(\w+)/:void 0;let Te=0,Fe=ee.length;for(;Te<Fe;++Te){const Se=ee.key(Te);if(!ce||Se.startsWith(ce)){let Me=(ce?me.exec(Se):void 0)?.[1]??Se;switch(Me){case"jrnl":M.includeJournal&&(le.journal=ee.getItem(Se));break;case"sz":le.size=+ee.getItem(Se);break;default:if(Me=+Me,(!F.isInt32(Me)||Me<=0)&&J(n.SQLITE_RANGE,"Malformed kvvfs key: "+Se),M.decodePages){const Ke=ee.getItem(Se),ct=Ke.length,Ge=p.memBuffer(0),Et=p.memBuffer(1),$e=T.heap8u();let nt=0;for(;nt<ct;++nt)$e[T.ptr.add(Ge,nt)]=Ke.codePointAt(nt)&255;$e[T.ptr.add(Ge,nt)]=0;const kt=ye(Ge,Et,p.buffer.n);fe[Me]=$e.slice(Number(Et),T.ptr.addn(Et,kt))}else fe[Me]=ee.getItem(Se);break}}}return M.decodePages&&p.memBufferFree(1),Object.keys(fe).map(Se=>+Se).sort().forEach(Se=>le.pages.push(fe[Se])),le},ie=function(S,x=!1){!S?.timestamp||!S.name||S.size===void 0||!Array.isArray(S.pages)?J(n.SQLITE_MISUSE,"Malformed export object."):(!S.size||S.size!==(S.size|0)||S.size>=2147483647)&&J(n.SQLITE_RANGE,"Invalid db size: "+S.size),w(S.name);let M=V(S.name);const B=!M;M?(x?!M.files||!M.jzClass?J(n.SQLITE_ERROR,"Internal storage object",S.name,"seems to be malformed."):M.files.length&&J(n.SQLITE_IOERR_ACCESS,"Cannot import db storage while it is in use."):J(n.SQLITE_ACCESS,"Storage '"+S.name+"' already exists and","overwrite was not specified."),g(S.name)):M=O(S.name);const ee=U(S.name);let le;try{const fe=M.storage;fe.setItem(ee+"sz",S.size),S.journal&&fe.setItem(ee+"jrnl",S.journal),S.pages[0]instanceof Uint8Array?S.pages.forEach((ce,me)=>{const Te=ce.length;le??=p.memBuffer(1);const Fe=p.memBuffer(0),Se=T.heap8u();Se.set(ce,Number(Fe)),Se[T.ptr.addn(Fe,Te)]=0;const Me=ve(Fe,Te,le);F.assert(Me<p.buffer.n,"Impossibly long output - possibly smashed the heap"),F.assert(T.peek8(T.ptr.add(le,Me))===0,"Expecting NUL-terminated encoded output");const Ke=T.cstrToJs(le);fe.setItem(ee+(me+1),Ke)}):S.pages[0]&&S.pages.forEach((ce,me)=>fe.setItem(ee+(me+1),ce)),B&&q(M)}catch{if(!B)try{g(S.name)}catch{}}finally{le&&p.memBufferFree(1)}return this},Z=function(S){let x=V(S);if(x){++x.refc;return}w(S),q(O(S))},ue=function(S){const x=V(S);return!x||R(x.jzClass)||Y(x.jzClass)||p.rxJournalSuffix.test(S)?!1:x.refc>x.files.length||x.files.length===0?(--x.refc<=0&&m(x),!0):!1},Ee=function(S){(!S||typeof S!="object")&&J(n.SQLITE_MISUSE,"Expecting a listener object.");let x=V(S.storage);x||(S.storage&&S.reserve?(Z(S.storage),x=V(S.storage),F.assert(x,"Unexpectedly cannot fetch reserved storage "+S.storage)):J(n.SQLITE_NOTFOUND,"No such storage:",S.storage)),S.events&&(x.listeners??=[]).push(S)},_e=function(S){const x=V(S?.storage);if(x?.listeners&&S.events){const M=x.listeners.length;x.listeners=x.listeners.filter(ee=>ee!==S);const B=M>x.listeners.length;return x.listeners.length||(x.listeners=void 0),B}return!1};if(s.kvvfs.reserve=Z,s.kvvfs.import=ie,s.kvvfs.export=H,s.kvvfs.unlink=ue,s.kvvfs.listen=Ee,s.kvvfs.unlisten=_e,s.kvvfs.exists=S=>!!V(S),s.kvvfs.estimateSize=L,s.kvvfs.clear=g,globalThis.Storage&&(n.sqlite3_js_kvvfs_size=(S="")=>L(S),n.sqlite3_js_kvvfs_clear=(S="")=>g(S)),s.oo1?.DB){const S=s.oo1.DB;s.oo1.JsStorageDb=function(M=s.oo1.JsStorageDb.defaultStorageName){const B=S.dbCtorHelper.normalizeArgs(...arguments);switch(B.vfs="kvvfs",B.filename){case":sessionStorage:":B.filename="session";break;case":localStorage:":B.filename="local";break}const ee=/(file:(\/\/)?)([^?]+)/.exec(B.filename);w(ee?ee[3]:B.filename),S.dbCtorHelper.call(this,B)},s.oo1.JsStorageDb.defaultStorageName=p.storagePool.session?"session":j;const x=s.oo1.JsStorageDb;x.prototype=Object.create(S.prototype),x.clearStorage=g,x.prototype.clearStorage=function(){return x.clearStorage(this.affirmOpen().dbFilename(),!0)},x.storageSize=L,x.prototype.storageSize=function(){return x.storageSize(this.affirmOpen().dbFilename(),!0)}}if(s.__isUnderTest&&s.vtab){const S=Object.assign(Object.create(null),{rowid:{type:"INTEGER"},name:{type:"TEXT"},nRef:{type:"INTEGER"},nOpen:{type:"INTEGER"},isTransient:{type:"INTEGER"},dbSize:{type:"INTEGER"}});Object.keys(S).forEach((fe,ce)=>S[fe].colId=ce);const x=s.vtab,M=Object.assign(Object.create(null),{row:function(){return p.storagePool[this.names[this.rowid]]}});Object.assign(Object.create(M),{rowid:0,names:Object.keys(p.storagePool).filter(fe=>!p.rxJournalSuffix.test(fe))});const B=function(fe,ce){const me=fe instanceof n.sqlite3_vtab_cursor?fe:x.xCursor.get(fe);return(ce||!me.vTabState)&&(me.vTabState=Object.assign(Object.create(M),{rowid:0,names:Object.keys(p.storagePool).filter(Te=>!p.rxJournalSuffix.test(Te))})),me.vTabState},ee=()=>{},le=function fe(){return fe.mod??=new s.capi.sqlite3_module().setupModule({catchExceptions:!0,methods:{xConnect:function(ce,me,Te,Fe,Se,Me){try{const Ke=[];Object.keys(S).forEach(Ge=>{Ke.push(Ge+" "+S[Ge].type)});const ct=n.sqlite3_declare_vtab(ce,"CREATE TABLE ignored("+Ke.join(",")+")");if(ct===0){const Ge=x.xVtab.create(Se);F.assert(Ge===x.xVtab.get(T.peekPtr(Se)),"output pointer check failed")}return ct}catch(Ke){return x.xErrror("xConnect",Ke,n.SQLITE_ERROR)}},xCreate:T.ptr.null,xDisconnect:function(ce){return x.xVtab.dispose(ce),0},xOpen:function(ce,me){return x.xCursor.create(me),0},xClose:function(ce){const me=x.xCursor.unget(ce);return delete me.vTabState,me.dispose(),0},xNext:function(ce){const me=x.xCursor.get(ce);return++B(me).rowid,0},xColumn:function(ce,me,Te){const Fe=B(ce),Se=Fe.row();switch(F.assert(Se,"Unexpected xColumn call"),Te){case S.rowid.colId:n.sqlite3_result_int(me,Fe.rowid);break;case S.name.colId:n.sqlite3_result_text(me,Se.jzClass,-1,n.SQLITE_TRANSIENT);break;case S.nRef.colId:n.sqlite3_result_int(me,Se.refc);break;case S.nOpen.colId:n.sqlite3_result_int(me,Se.files.length);break;case S.isTransient.colId:n.sqlite3_result_int(me,!!Se.deleteAtRefc0);break;case S.dbSize.colId:n.sqlite3_result_int(me,d(Se));break;default:return n.sqlite3_result_error(me,"Invalid column id: "+Te),n.SQLITE_RANGE}return 0},xRowid:function(ce,me){const Te=B(ce);return x.xRowid(me,Te.rowid),0},xEof:function(ce){const me=B(ce);return ee("xEof?="+!me.row(),...arguments),!me.row()},xFilter:function(ce,me,Te,Fe,Se){return B(ce,!0),0},xBestIndex:function(ce,me){const Te=new n.sqlite3_index_info(me);return Te.$estimatedRows=p.storagePool.size,Te.$estimatedCost=1,Te.dispose(),0}}})};s.kvvfs.create_module=function(fe,ce="sqlite_kvvfs"){return n.sqlite3_create_module(fe,ce,le(),T.ptr.null)}}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const n=function i(r){if(!globalThis.SharedArrayBuffer||!globalThis.Atomics)return Promise.reject(new Error("Cannot install OPFS: Missing SharedArrayBuffer and/or Atomics. The server must emit the COOP/COEP response headers to enable those. See https://sqlite.org/wasm/doc/trunk/persistence.md#coop-coep"));if(typeof WorkerGlobalScope>"u")return Promise.reject(new Error("The OPFS sqlite3_vfs cannot run in the main thread because it requires Atomics.wait()."));if(!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle||!globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle||!navigator?.storage?.getDirectory)return Promise.reject(new Error("Missing required OPFS APIs."));(!r||typeof r!="object")&&(r=Object.create(null));const u=new URL(globalThis.location.href).searchParams;return u.has("opfs-disable")?Promise.resolve(s):(r.verbose===void 0&&(r.verbose=u.has("opfs-verbose")?+u.get("opfs-verbose")||2:1),r.sanityChecks===void 0&&(r.sanityChecks=u.has("opfs-sanity-check")),r.proxyUri===void 0&&(r.proxyUri=i.defaultProxyUri),typeof r.proxyUri=="function"&&(r.proxyUri=r.proxyUri()),new Promise(function(F,T){const J=[s.config.error,s.config.warn,s.config.log],N=(g,...L)=>{r.verbose>g&&J[g]("OPFS syncer:",...L)},G=(...g)=>N(2,...g),p=(...g)=>N(1,...g),z=(...g)=>N(0,...g),C=s.util.toss,te=s.capi,y=s.util,b=s.wasm,R=te.sqlite3_vfs,U=te.sqlite3_file,w=te.sqlite3_io_methods,O=Object.create(null),f=()=>globalThis.FileSystemHandle&&globalThis.FileSystemDirectoryHandle&&globalThis.FileSystemFileHandle&&globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle&&navigator?.storage?.getDirectory;O.metrics={dump:function(){let g,L=0,H=0,ie=0;for(g in V.opIds){const Z=I[g];L+=Z.count,H+=Z.time,ie+=Z.wait,Z.avgTime=Z.count&&Z.time?Z.time/Z.count:0,Z.avgWait=Z.count&&Z.wait?Z.wait/Z.count:0}s.config.log(globalThis.location.href,"metrics for",globalThis.location.href,":",I,`
Total of`,L,"op(s) for",H,"ms (incl. "+ie+" ms of waiting on the async side)"),s.config.log("Serialization metrics:",I.s11n),ye.postMessage({type:"opfs-async-metrics"})},reset:function(){let g;const L=ie=>ie.count=ie.time=ie.wait=0;for(g in V.opIds)L(I[g]=Object.create(null));let H=I.s11n=Object.create(null);H=H.serialize=Object.create(null),H.count=H.time=0,H=I.s11n.deserialize=Object.create(null),H.count=H.time=0}};const m=new w,q=new R().addOnDispose(()=>m.dispose());let j;const Y=g=>(j=!0,q.dispose(),T(g)),ae=()=>(j=!1,F(s)),ye=new Worker(new URL("/itdashboard/assets/sqlite3-opfs-async-proxy-BWKAW6aw.js",self.location.href));setTimeout(()=>{j===void 0&&Y(new Error("Timeout while waiting for OPFS async proxy worker."))},4e3),ye._originalOnError=ye.onerror,ye.onerror=function(g){z("Error initializing OPFS asyncer:",g),Y(new Error("Loading OPFS async Worker failed for unknown reasons."))};const ve=te.sqlite3_vfs_find(null),de=ve?new R(ve):null;m.$iVersion=1,q.$iVersion=2,q.$szOsFile=te.sqlite3_file.structInfo.sizeof,q.$mxPathname=1024,q.$zName=b.allocCString("opfs"),q.$xDlOpen=q.$xDlError=q.$xDlSym=q.$xDlClose=null,q.addOnDispose("$zName",q.$zName,"cleanup default VFS wrapper",()=>de?de.dispose():null);const V=Object.create(null);V.verbose=r.verbose,V.littleEndian=(()=>{const g=new ArrayBuffer(2);return new DataView(g).setInt16(0,256,!0),new Int16Array(g)[0]===256})(),V.asyncIdleWaitTime=150,V.asyncS11nExceptions=1,V.fileBufferSize=65536,V.sabS11nOffset=V.fileBufferSize,V.sabS11nSize=q.$mxPathname*2,V.sabIO=new SharedArrayBuffer(V.fileBufferSize+V.sabS11nSize),V.opIds=Object.create(null);const I=Object.create(null);{let g=0;V.opIds.whichOp=g++,V.opIds.rc=g++,V.opIds.xAccess=g++,V.opIds.xClose=g++,V.opIds.xDelete=g++,V.opIds.xDeleteNoWait=g++,V.opIds.xFileSize=g++,V.opIds.xLock=g++,V.opIds.xOpen=g++,V.opIds.xRead=g++,V.opIds.xSleep=g++,V.opIds.xSync=g++,V.opIds.xTruncate=g++,V.opIds.xUnlock=g++,V.opIds.xWrite=g++,V.opIds.mkdir=g++,V.opIds["opfs-async-metrics"]=g++,V.opIds["opfs-async-shutdown"]=g++,V.opIds.retry=g++,V.sabOP=new SharedArrayBuffer(g*4),O.metrics.reset()}V.sq3Codes=Object.create(null),["SQLITE_ACCESS_EXISTS","SQLITE_ACCESS_READWRITE","SQLITE_BUSY","SQLITE_CANTOPEN","SQLITE_ERROR","SQLITE_IOERR","SQLITE_IOERR_ACCESS","SQLITE_IOERR_CLOSE","SQLITE_IOERR_DELETE","SQLITE_IOERR_FSYNC","SQLITE_IOERR_LOCK","SQLITE_IOERR_READ","SQLITE_IOERR_SHORT_READ","SQLITE_IOERR_TRUNCATE","SQLITE_IOERR_UNLOCK","SQLITE_IOERR_WRITE","SQLITE_LOCK_EXCLUSIVE","SQLITE_LOCK_NONE","SQLITE_LOCK_PENDING","SQLITE_LOCK_RESERVED","SQLITE_LOCK_SHARED","SQLITE_LOCKED","SQLITE_MISUSE","SQLITE_NOTFOUND","SQLITE_OPEN_CREATE","SQLITE_OPEN_DELETEONCLOSE","SQLITE_OPEN_MAIN_DB","SQLITE_OPEN_READONLY"].forEach(g=>{(V.sq3Codes[g]=te[g])===void 0&&C("Maintenance required: not found:",g)}),V.opfsFlags=Object.assign(Object.create(null),{OPFS_UNLOCK_ASAP:1,OPFS_UNLINK_BEFORE_OPEN:2,defaultUnlockAsap:!1});const a=(g,...L)=>{const H=V.opIds[g]||C("Invalid op ID:",g);V.s11n.serialize(...L),Atomics.store(V.sabOPView,V.opIds.rc,-1),Atomics.store(V.sabOPView,V.opIds.whichOp,H),Atomics.notify(V.sabOPView,V.opIds.whichOp);const ie=performance.now();for(;Atomics.wait(V.sabOPView,V.opIds.rc,-1)!=="not-equal";);const Z=Atomics.load(V.sabOPView,V.opIds.rc);if(I[g].wait+=performance.now()-ie,Z&&V.asyncS11nExceptions){const ue=V.s11n.deserialize();ue&&z(g+"() async error:",...ue)}return Z};O.debug={asyncShutdown:()=>{p("Shutting down OPFS async listener. The OPFS VFS will no longer work."),a("opfs-async-shutdown")},asyncRestart:()=>{p("Attempting to restart OPFS VFS async listener. Might work, might not."),ye.postMessage({type:"opfs-async-restart"})}};const _=()=>{if(V.s11n)return V.s11n;const g=new TextDecoder,L=new TextEncoder("utf-8"),H=new Uint8Array(V.sabIO,V.sabS11nOffset,V.sabS11nSize),ie=new DataView(V.sabIO,V.sabS11nOffset,V.sabS11nSize);V.s11n=Object.create(null);const Z=Object.create(null);Z.number={id:1,size:8,getter:"getFloat64",setter:"setFloat64"},Z.bigint={id:2,size:8,getter:"getBigInt64",setter:"setBigInt64"},Z.boolean={id:3,size:4,getter:"getInt32",setter:"setInt32"},Z.string={id:4};const ue=_e=>Z[typeof _e]||C("Maintenance required: this value type cannot be serialized.",_e),Ee=_e=>{switch(_e){case Z.number.id:return Z.number;case Z.bigint.id:return Z.bigint;case Z.boolean.id:return Z.boolean;case Z.string.id:return Z.string;default:C("Invalid type ID:",_e)}};return V.s11n.deserialize=function(_e=!1){++I.s11n.deserialize.count;const S=performance.now(),x=H[0],M=x?[]:null;if(x){const B=[];let ee=1,le,fe,ce;for(le=0;le<x;++le,++ee)B.push(Ee(H[ee]));for(le=0;le<x;++le){const me=B[le];me.getter?(ce=ie[me.getter](ee,V.littleEndian),ee+=me.size):(fe=ie.getInt32(ee,V.littleEndian),ee+=4,ce=g.decode(H.slice(ee,ee+fe)),ee+=fe),M.push(ce)}}return _e&&(H[0]=0),I.s11n.deserialize.time+=performance.now()-S,M},V.s11n.serialize=function(..._e){const S=performance.now();if(++I.s11n.serialize.count,_e.length){const x=[];let M=0,B=1;for(H[0]=_e.length&255;M<_e.length;++M,++B)x.push(ue(_e[M])),H[B]=x[M].id;for(M=0;M<_e.length;++M){const ee=x[M];if(ee.setter)ie[ee.setter](B,_e[M],V.littleEndian),B+=ee.size;else{const le=L.encode(_e[M]);ie.setInt32(B,le.byteLength,V.littleEndian),B+=4,H.set(le,B),B+=le.byteLength}}}else H[0]=0;I.s11n.serialize.time+=performance.now()-S},V.s11n},d=function g(L=16){g._chars||(g._chars="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ012346789",g._n=g._chars.length);const H=[];let ie=0;for(;ie<L;++ie){const Z=Math.random()*(g._n*64)%g._n|0;H[ie]=g._chars[Z]}return H.join("")},E=Object.create(null),W=Object.create(null);W.op=void 0,W.start=void 0;const K=g=>{W.start=performance.now(),W.op=g,++I[g].count},D=()=>I[W.op].time+=performance.now()-W.start,h={xCheckReservedLock:function(g,L){return b.poke(L,0,"i32"),0},xClose:function(g){K("xClose");let L=0;const H=E[g];return H&&(delete E[g],L=a("xClose",g),H.sq3File&&H.sq3File.dispose()),D(),L},xDeviceCharacteristics:function(g){return te.SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN},xFileControl:function(g,L,H){return te.SQLITE_NOTFOUND},xFileSize:function(g,L){K("xFileSize");let H=a("xFileSize",g);if(H==0)try{const ie=V.s11n.deserialize()[0];b.poke(L,ie,"i64")}catch(ie){z("Unexpected error reading xFileSize() result:",ie),H=V.sq3Codes.SQLITE_IOERR}return D(),H},xLock:function(g,L){K("xLock");const H=E[g];let ie=0;return H.lockType?H.lockType=L:(ie=a("xLock",g,L),ie===0&&(H.lockType=L)),D(),ie},xRead:function(g,L,H,ie){K("xRead");const Z=E[g];let ue;try{ue=a("xRead",g,H,Number(ie)),(ue===0||te.SQLITE_IOERR_SHORT_READ===ue)&&b.heap8u().set(Z.sabView.subarray(0,H),Number(L))}catch(Ee){z("xRead(",arguments,") failed:",Ee,Z),ue=te.SQLITE_IOERR_READ}return D(),ue},xSync:function(g,L){K("xSync"),++I.xSync.count;const H=a("xSync",g,L);return D(),H},xTruncate:function(g,L){K("xTruncate");const H=a("xTruncate",g,Number(L));return D(),H},xUnlock:function(g,L){K("xUnlock");const H=E[g];let ie=0;return te.SQLITE_LOCK_NONE===L&&H.lockType&&(ie=a("xUnlock",g,L)),ie===0&&(H.lockType=L),D(),ie},xWrite:function(g,L,H,ie){K("xWrite");const Z=E[g];let ue;try{Z.sabView.set(b.heap8u().subarray(Number(L),Number(L)+H)),ue=a("xWrite",g,H,Number(ie))}catch(Ee){z("xWrite(",arguments,") failed:",Ee,Z),ue=te.SQLITE_IOERR_WRITE}return D(),ue}},P={xAccess:function(g,L,H,ie){K("xAccess");const Z=a("xAccess",b.cstrToJs(L));return b.poke(ie,Z?0:1,"i32"),D(),0},xCurrentTime:function(g,L){return b.poke(L,24405875e-1+new Date().getTime()/864e5,"double"),0},xCurrentTimeInt64:function(g,L){return b.poke(L,24405875e-1*864e5+new Date().getTime(),"i64"),0},xDelete:function(g,L,H){K("xDelete");const ie=a("xDelete",b.cstrToJs(L),H,!1);return D(),ie},xFullPathname:function(g,L,H,ie){return b.cstrncpy(ie,L,H)<H?0:te.SQLITE_CANTOPEN},xGetLastError:function(g,L,H){return p("OPFS xGetLastError() has nothing sensible to return."),0},xOpen:function(L,H,ie,Z,ue){K("xOpen");let Ee=0;H===0?H=d():b.isPtr(H)&&(te.sqlite3_uri_boolean(H,"opfs-unlock-asap",0)&&(Ee|=V.opfsFlags.OPFS_UNLOCK_ASAP),te.sqlite3_uri_boolean(H,"delete-before-open",0)&&(Ee|=V.opfsFlags.OPFS_UNLINK_BEFORE_OPEN),H=b.cstrToJs(H));const _e=Object.create(null);_e.fid=ie,_e.filename=H,_e.sab=new SharedArrayBuffer(V.fileBufferSize),_e.flags=Z,_e.readOnly=!(te.SQLITE_OPEN_CREATE&Z)&&!!(Z&te.SQLITE_OPEN_READONLY);const S=a("xOpen",ie,H,Z,Ee);return S||(_e.readOnly&&b.poke(ue,te.SQLITE_OPEN_READONLY,"i32"),E[ie]=_e,_e.sabView=V.sabFileBufView,_e.sq3File=new U(ie),_e.sq3File.$pMethods=m.pointer,_e.lockType=te.SQLITE_LOCK_NONE),D(),S}};de&&(q.$xRandomness=de.$xRandomness,q.$xSleep=de.$xSleep),q.$xRandomness||(P.xRandomness=function(g,L,H){const ie=b.heap8u();let Z=0;const ue=Number(H);for(;Z<L;++Z)ie[ue+Z]=Math.random()*255e3&255;return Z}),q.$xSleep||(P.xSleep=function(g,L){return Atomics.wait(V.sabOPView,V.opIds.xSleep,0,L),0}),O.getResolvedPath=function(g,L){const H=new URL(g,"file://irrelevant").pathname;return L?H.split("/").filter(ie=>!!ie):H},O.getDirForFilename=async function(L,H=!1){const ie=O.getResolvedPath(L,!0),Z=ie.pop();let ue=O.rootDirectory;for(const Ee of ie)Ee&&(ue=await ue.getDirectoryHandle(Ee,{create:!!H}));return[ue,Z]},O.mkdir=async function(g){try{return await O.getDirForFilename(g+"/filepart",!0),!0}catch{return!1}},O.entryExists=async function(g){try{const[L,H]=await O.getDirForFilename(g);return await L.getFileHandle(H),!0}catch{return!1}},O.randomFilename=d,O.treeList=async function(){const g=async function H(ie,Z){Z.name=ie.name,Z.dirs=[],Z.files=[];for await(const ue of ie.values())if(ue.kind==="directory"){const Ee=Object.create(null);Z.dirs.push(Ee),await H(ue,Ee)}else Z.files.push(ue.name)},L=Object.create(null);return await g(O.rootDirectory,L),L},O.rmfr=async function(){const g=O.rootDirectory,L={recurse:!0};for await(const H of g.values())g.removeEntry(H.name,L)},O.unlink=async function(g,L=!1,H=!1){try{const[ie,Z]=await O.getDirForFilename(g,!1);return await ie.removeEntry(Z,{recursive:L}),!0}catch(ie){if(H)throw new Error("unlink(",arguments[0],") failed: "+ie.message,{cause:ie});return!1}},O.traverse=async function(g){const L={recursive:!0,directory:O.rootDirectory};typeof g=="function"&&(g={callback:g}),g=Object.assign(L,g||{}),(async function H(ie,Z){for await(const ue of ie.values()){if(g.callback(ue,ie,Z)===!1)return!1;if(g.recursive&&ue.kind==="directory"&&await H(ue,Z+1)===!1)break}})(g.directory,0)};const Q=async function(g,L){const[H,ie]=await O.getDirForFilename(g,!0);let Z=await(await H.getFileHandle(ie,{create:!0})).createSyncAccessHandle(),ue=0,Ee,_e=!1;try{for(Z.truncate(0);(Ee=await L())!==void 0;)Ee instanceof ArrayBuffer&&(Ee=new Uint8Array(Ee)),!_e&&ue===0&&Ee.byteLength>=15&&(y.affirmDbHeader(Ee),_e=!0),Z.write(Ee,{at:ue}),ue+=Ee.byteLength;if((ue<512||ue%512!==0)&&C("Input size",ue,"is not correct for an SQLite database."),!_e){const S=new Uint8Array(20);Z.read(S,{at:0}),y.affirmDbHeader(S)}return Z.write(new Uint8Array([1,1]),{at:18}),ue}catch(S){throw await Z.close(),Z=void 0,await H.removeEntry(ie).catch(()=>{}),S}finally{Z&&await Z.close()}};if(O.importDb=async function(g,L){if(L instanceof Function)return Q(g,L);L instanceof ArrayBuffer&&(L=new Uint8Array(L)),y.affirmIsDb(L);const H=L.byteLength,[ie,Z]=await O.getDirForFilename(g,!0);let ue,Ee=0;try{return ue=await(await ie.getFileHandle(Z,{create:!0})).createSyncAccessHandle(),ue.truncate(0),Ee=ue.write(L,{at:0}),Ee!=H&&C("Expected to write "+H+" bytes but wrote "+Ee+"."),ue.write(new Uint8Array([1,1]),{at:18}),Ee}catch(_e){throw ue&&(await ue.close(),ue=void 0),await ie.removeEntry(Z).catch(()=>{}),_e}finally{ue&&await ue.close()}},s.oo1){const g=function(...L){const H=s.oo1.DB.dbCtorHelper.normalizeArgs(...L);H.vfs=q.$zName,s.oo1.DB.dbCtorHelper.call(this,H)};g.prototype=Object.create(s.oo1.DB.prototype),s.oo1.OpfsDb=g,g.importDb=O.importDb,s.oo1.DB.dbCtorHelper.setVfsPostOpenCallback(q.pointer,function(L,H){H.capi.sqlite3_busy_timeout(L,1e4)})}const re=function(){const g=b.scopedAllocPush(),L=new U;try{const H=L.pointer,ie=te.SQLITE_OPEN_CREATE|te.SQLITE_OPEN_READWRITE|te.SQLITE_OPEN_MAIN_DB,Z=b.scopedAlloc(8),ue="/sanity/check/file"+d(8),Ee=b.scopedAllocCString(ue);let _e;if(V.s11n.serialize("This is  string."),_e=V.s11n.deserialize(),G("deserialize() says:",_e),_e[0]!=="This is  string."&&C("String d13n error."),P.xAccess(q.pointer,Ee,0,Z),_e=b.peek(Z,"i32"),G("xAccess(",ue,") exists ?=",_e),_e=P.xOpen(q.pointer,Ee,H,ie,Z),G("open rc =",_e,"state.sabOPView[xOpen] =",V.sabOPView[V.opIds.xOpen]),_e!==0){z("open failed with code",_e);return}P.xAccess(q.pointer,Ee,0,Z),_e=b.peek(Z,"i32"),_e||C("xAccess() failed to detect file."),_e=h.xSync(L.pointer,0),_e&&C("sync failed w/ rc",_e),_e=h.xTruncate(L.pointer,1024),_e&&C("truncate failed w/ rc",_e),b.poke(Z,0,"i64"),_e=h.xFileSize(L.pointer,Z),_e&&C("xFileSize failed w/ rc",_e),G("xFileSize says:",b.peek(Z,"i64")),_e=h.xWrite(L.pointer,Ee,10,1),_e&&C("xWrite() failed!");const S=b.scopedAlloc(16);_e=h.xRead(L.pointer,S,6,2),b.poke(S+6,0);let x=b.cstrToJs(S);G("xRead() got:",x),x!=="sanity"&&C("Unexpected xRead() value."),P.xSleep&&(G("xSleep()ing before close()ing..."),P.xSleep(q.pointer,2e3),G("waking up from xSleep()")),_e=h.xClose(H),G("xClose rc =",_e,"sabOPView =",V.sabOPView),G("Deleting file:",ue),P.xDelete(q.pointer,Ee,4660),P.xAccess(q.pointer,Ee,0,Z),_e=b.peek(Z,"i32"),_e&&C("Expecting 0 from xAccess(",ue,") after xDelete()."),p("End of OPFS sanity checks.")}finally{L.dispose(),b.scopedAllocPop(g)}};ye.onmessage=function({data:g}){switch(g.type){case"opfs-unavailable":Y(new Error(g.payload.join(" ")));break;case"opfs-async-loaded":ye.postMessage({type:"opfs-async-init",args:V});break;case"opfs-async-inited":if(j===!0)break;try{s.vfs.installVfs({io:{struct:m,methods:h},vfs:{struct:q,methods:P}}),V.sabOPView=new Int32Array(V.sabOP),V.sabFileBufView=new Uint8Array(V.sabIO,0,V.fileBufferSize),V.sabS11nView=new Uint8Array(V.sabIO,V.sabS11nOffset,V.sabS11nSize),_(),r.sanityChecks&&(p("Running sanity checks because of opfs-sanity-check URL arg..."),re()),f()?navigator.storage.getDirectory().then(L=>{ye.onerror=ye._originalOnError,delete ye._originalOnError,s.opfs=O,O.rootDirectory=L,G("End of OPFS sqlite3_vfs setup.",q),ae()}).catch(Y):ae()}catch(L){z(L),Y(L)}break;default:{const L="Unexpected message from the OPFS async worker: "+JSON.stringify(g);z(L),Y(new Error(L));break}}}}))};n.defaultProxyUri="sqlite3-opfs-async-proxy.js",globalThis.sqlite3ApiBootstrap.initializersAsync.push(async i=>{try{let r=n.defaultProxyUri;return i?.scriptInfo?.sqlite3Dir&&(n.defaultProxyUri=i.scriptInfo.sqlite3Dir+r),n().catch(u=>{i.config.warn("Ignoring inability to install OPFS sqlite3_vfs:",u.message)})}catch(r){return i.config.error("installOpfsVfs() exception:",r),Promise.reject(r)}})}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const n=s.util.toss,i=s.util.toss3,r=Object.create(null),u=s.capi,F=s.util,T=s.wasm,J=4096,N=512,G=4,p=8,z=N+G,C=N,te=z,y=J,b=u.SQLITE_OPEN_MAIN_DB|u.SQLITE_OPEN_MAIN_JOURNAL|u.SQLITE_OPEN_SUPER_JOURNAL|u.SQLITE_OPEN_WAL,R=u.SQLITE_OPEN_MEMORY,U=".opaque",w=()=>Math.random().toString(36).slice(2),O=new TextDecoder,f=new TextEncoder,m=Object.assign(Object.create(null),{name:"opfs-sahpool",directory:void 0,initialCapacity:6,clearOnInit:!1,verbosity:2,forceReinitIfPreviouslyFailed:!1}),q=[s.config.error,s.config.warn,s.config.log];s.config.log;const j=s.config.warn;s.config.error;const Y=new Map,ae=D=>Y.get(D),ye=(D,h)=>{h?Y.set(D,h):Y.delete(D)},ve=new Map,de=D=>ve.get(D),V=(D,h)=>{h?ve.set(D,h):ve.delete(D)},I={xCheckReservedLock:function(D,h){const P=de(D);return P.log("xCheckReservedLock"),P.storeErr(),T.poke32(h,1),0},xClose:function(D){const h=de(D);h.storeErr();const P=h.getOFileForS3File(D);if(P)try{h.log(`xClose ${P.path}`),h.mapS3FileToOFile(D,!1),P.sah.flush(),P.flags&u.SQLITE_OPEN_DELETEONCLOSE&&h.deletePath(P.path)}catch(Q){return h.storeErr(Q,u.SQLITE_IOERR)}return 0},xDeviceCharacteristics:function(D){return u.SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN},xFileControl:function(D,h,P){return u.SQLITE_NOTFOUND},xFileSize:function(D,h){const P=de(D);P.log("xFileSize");const Q=P.getOFileForS3File(D).sah.getSize()-y;return T.poke64(h,BigInt(Q)),0},xLock:function(D,h){const P=de(D);P.log(`xLock ${h}`),P.storeErr();const Q=P.getOFileForS3File(D);return Q.lockType=h,0},xRead:function(D,h,P,Q){const re=de(D);re.storeErr();const g=re.getOFileForS3File(D);re.log(`xRead ${g.path} ${P} @ ${Q}`);try{const L=g.sah.read(T.heap8u().subarray(Number(h),Number(h)+P),{at:y+Number(Q)});return L<P?(T.heap8u().fill(0,Number(h)+L,Number(h)+P),u.SQLITE_IOERR_SHORT_READ):0}catch(L){return re.storeErr(L,u.SQLITE_IOERR)}},xSectorSize:function(D){return J},xSync:function(D,h){const P=de(D);P.log(`xSync ${h}`),P.storeErr();const Q=P.getOFileForS3File(D);try{return Q.sah.flush(),0}catch(re){return P.storeErr(re,u.SQLITE_IOERR)}},xTruncate:function(D,h){const P=de(D);P.log(`xTruncate ${h}`),P.storeErr();const Q=P.getOFileForS3File(D);try{return Q.sah.truncate(y+Number(h)),0}catch(re){return P.storeErr(re,u.SQLITE_IOERR)}},xUnlock:function(D,h){const P=de(D);P.log("xUnlock");const Q=P.getOFileForS3File(D);return Q.lockType=h,0},xWrite:function(D,h,P,Q){const re=de(D);re.storeErr();const g=re.getOFileForS3File(D);re.log(`xWrite ${g.path} ${P} ${Q}`);try{return P===g.sah.write(T.heap8u().subarray(Number(h),Number(h)+P),{at:y+Number(Q)})?0:n("Unknown write() failure.")}catch(L){return re.storeErr(L,u.SQLITE_IOERR)}}},a=new u.sqlite3_io_methods;a.$iVersion=1,s.vfs.installVfs({io:{struct:a,methods:I}});const _={xAccess:function(D,h,P,Q){const re=ae(D);re.storeErr();try{const g=re.getPath(h);T.poke32(Q,re.hasFilename(g)?1:0)}catch{T.poke32(Q,0)}return 0},xCurrentTime:function(D,h){return T.poke(h,24405875e-1+new Date().getTime()/864e5,"double"),0},xCurrentTimeInt64:function(D,h){return T.poke(h,24405875e-1*864e5+new Date().getTime(),"i64"),0},xDelete:function(D,h,P){const Q=ae(D);Q.log(`xDelete ${T.cstrToJs(h)}`),Q.storeErr();try{return Q.deletePath(Q.getPath(h)),0}catch(re){return Q.storeErr(re),u.SQLITE_IOERR_DELETE}},xFullPathname:function(D,h,P,Q){return T.cstrncpy(Q,h,P)<P?0:u.SQLITE_CANTOPEN},xGetLastError:function(D,h,P){const Q=ae(D),re=Q.popErr();if(Q.log(`xGetLastError ${h} e =`,re),re){const g=T.scopedAllocPush();try{const[L,H]=T.scopedAllocCString(re.message,!0);T.cstrncpy(P,L,h),H>h&&T.poke8(T.ptr.add(P,h,-1),0)}catch{return u.SQLITE_NOMEM}finally{T.scopedAllocPop(g)}}return re?re.sqlite3Rc||u.SQLITE_IOERR:0},xOpen:function(h,P,Q,re,g){const L=ae(h);try{re&=~R,L.log(`xOpen ${T.cstrToJs(P)} ${re}`);const H=P&&T.peek8(P)?L.getPath(P):w();let ie=L.getSAHForPath(H);!ie&&re&u.SQLITE_OPEN_CREATE&&(L.getFileCount()<L.getCapacity()?(ie=L.nextAvailableSAH(),L.setAssociatedPath(ie,H,re)):n("SAH pool is full. Cannot create file",H)),ie||n("file not found:",H);const Z={path:H,flags:re,sah:ie};L.mapS3FileToOFile(Q,Z),Z.lockType=u.SQLITE_LOCK_NONE;const ue=new u.sqlite3_file(Q);return ue.$pMethods=a.pointer,ue.dispose(),T.poke32(g,re),0}catch(H){return L.storeErr(H),u.SQLITE_CANTOPEN}}},d=function(D){s.capi.sqlite3_vfs_find(D)&&i("VFS name is already registered:",D);const h=new u.sqlite3_vfs,P=u.sqlite3_vfs_find(null),Q=P?new u.sqlite3_vfs(P):null;return h.$iVersion=2,h.$szOsFile=u.sqlite3_file.structInfo.sizeof,h.$mxPathname=N,h.addOnDispose(h.$zName=T.allocCString(D),()=>ye(h.pointer,0)),Q&&(h.$xRandomness=Q.$xRandomness,h.$xSleep=Q.$xSleep,Q.dispose()),!h.$xRandomness&&!_.xRandomness&&(_.xRandomness=function(re,g,L){const H=T.heap8u();let ie=0;const Z=Number(L);for(;ie<g;++ie)H[Z+ie]=Math.random()*255e3&255;return ie}),!h.$xSleep&&!_.xSleep&&(_.xSleep=(re,g)=>0),s.vfs.installVfs({vfs:{struct:h,methods:_}}),h};class E{vfsDir;#e;#r;#a;#i=new Map;#t=new Map;#s=new Set;#l=new Map;#n=new Uint8Array(z);#c;#o;#_;constructor(h=Object.create(null)){this.#_=h.verbosity??m.verbosity,this.vfsName=h.name||m.name,this.#o=d(this.vfsName),ye(this.#o.pointer,this),this.vfsDir=h.directory||"."+this.vfsName,this.#c=new DataView(this.#n.buffer,this.#n.byteOffset),this.isReady=this.reset(!!(h.clearOnInit??m.clearOnInit)).then(()=>{if(this.$error)throw this.$error;return this.getCapacity()?Promise.resolve(void 0):this.addCapacity(h.initialCapacity||m.initialCapacity)})}#u(h,...P){this.#_>h&&q[h](this.vfsName+":",...P)}log(...h){this.#u(2,...h)}warn(...h){this.#u(1,...h)}error(...h){this.#u(0,...h)}getVfs(){return this.#o}getCapacity(){return this.#i.size}getFileCount(){return this.#t.size}getFileNames(){const h=[];for(const P of this.#t.keys())h.push(P);return h}async addCapacity(h){for(let P=0;P<h;++P){const Q=w(),re=await(await this.#r.getFileHandle(Q,{create:!0})).createSyncAccessHandle();this.#i.set(re,Q),this.setAssociatedPath(re,"",0)}return this.getCapacity()}async reduceCapacity(h){let P=0;for(const Q of Array.from(this.#s)){if(P===h||this.getFileCount()===this.getCapacity())break;const re=this.#i.get(Q);Q.close(),await this.#r.removeEntry(re),this.#i.delete(Q),this.#s.delete(Q),++P}return P}releaseAccessHandles(){for(const h of this.#i.keys())h.close();this.#i.clear(),this.#t.clear(),this.#s.clear()}async acquireAccessHandles(h=!1){const P=[];for await(const[Q,re]of this.#r)re.kind==="file"&&P.push([Q,re]);return Promise.all(P.map(async([Q,re])=>{try{const g=await re.createSyncAccessHandle();if(this.#i.set(g,Q),h)g.truncate(y),this.setAssociatedPath(g,"",0);else{const L=this.getAssociatedPath(g);L?this.#t.set(L,g):this.#s.add(g)}}catch(g){throw this.storeErr(g),this.releaseAccessHandles(),g}}))}getAssociatedPath(h){h.read(this.#n,{at:0});const P=this.#c.getUint32(C);if(this.#n[0]&&(P&u.SQLITE_OPEN_DELETEONCLOSE||(P&b)===0))return j(`Removing file with unexpected flags ${P.toString(16)}`,this.#n),this.setAssociatedPath(h,"",0),"";const Q=new Uint32Array(p/4);h.read(Q,{at:te});const re=this.computeDigest(this.#n,P);if(Q.every((g,L)=>g===re[L])){const g=this.#n.findIndex(L=>L===0);return g===0&&h.truncate(y),g?O.decode(this.#n.subarray(0,g)):""}else return j("Disassociating file with bad digest."),this.setAssociatedPath(h,"",0),""}setAssociatedPath(h,P,Q){const re=f.encodeInto(P,this.#n);N<=re.written+1&&n("Path too long:",P),P&&Q&&(Q|=R),this.#n.fill(0,re.written,N),this.#c.setUint32(C,Q);const g=this.computeDigest(this.#n,Q);h.write(this.#n,{at:0}),h.write(g,{at:te}),h.flush(),P?(this.#t.set(P,h),this.#s.delete(h)):(h.truncate(y),this.#s.add(h))}computeDigest(h,P){if(P&R){let Q=3735928559,re=1103547991;for(const g of h)Q=Math.imul(Q^g,2654435761),re=Math.imul(re^g,104729);return new Uint32Array([Q>>>0,re>>>0])}else return new Uint32Array([0,0])}async reset(h){await this.isReady;let P=await navigator.storage.getDirectory(),Q;for(const re of this.vfsDir.split("/"))re&&(Q=P,P=await P.getDirectoryHandle(re,{create:!0}));return this.#e=P,this.#a=Q,this.#r=await this.#e.getDirectoryHandle(U,{create:!0}),this.releaseAccessHandles(),this.acquireAccessHandles(h)}getPath(h){return T.isPtr(h)&&(h=T.cstrToJs(h)),(h instanceof URL?h:new URL(h,"file://localhost/")).pathname}deletePath(h){const P=this.#t.get(h);return P&&(this.#t.delete(h),this.setAssociatedPath(P,"",0)),!!P}storeErr(h,P){return h&&(h.sqlite3Rc=P||u.SQLITE_IOERR,this.error(h)),this.$error=h,P}popErr(){const h=this.$error;return this.$error=void 0,h}nextAvailableSAH(){const[h]=this.#s.keys();return h}getOFileForS3File(h){return this.#l.get(h)}mapS3FileToOFile(h,P){P?(this.#l.set(h,P),V(h,this)):(this.#l.delete(h),V(h,!1))}hasFilename(h){return this.#t.has(h)}getSAHForPath(h){return this.#t.get(h)}async removeVfs(){if(!this.#o.pointer||!this.#r)return!1;u.sqlite3_vfs_unregister(this.#o.pointer),this.#o.dispose(),delete r[this.vfsName];try{this.releaseAccessHandles(),await this.#e.removeEntry(U,{recursive:!0}),this.#r=void 0,await this.#a.removeEntry(this.#e.name,{recursive:!0}),this.#e=this.#a=void 0}catch(h){s.config.error(this.vfsName,"removeVfs() failed with no recovery strategy:",h)}return!0}pauseVfs(){return this.#l.size>0&&s.SQLite3Error.toss(u.SQLITE_MISUSE,"Cannot pause VFS",this.vfsName,"because it has opened files."),this.#i.size>0&&(u.sqlite3_vfs_unregister(this.vfsName),this.releaseAccessHandles()),this}isPaused(){return this.#i.size===0}async unpauseVfs(){return this.#i.size===0?this.acquireAccessHandles(!1).then(()=>u.sqlite3_vfs_register(this.#o,0),this):this}exportFile(h){const P=this.#t.get(h)||n("File not found:",h),Q=P.getSize()-y,re=new Uint8Array(Q>0?Q:0);if(Q>0){const g=P.read(re,{at:y});g!=Q&&n("Expected to read "+Q+" bytes but read "+g+".")}return re}async importDbChunked(h,P){const Q=this.#t.get(h)||this.nextAvailableSAH()||n("No available handles to import to.");Q.truncate(0);let re=0,g,L=!1;try{for(;(g=await P())!==void 0;)g instanceof ArrayBuffer&&(g=new Uint8Array(g)),!L&&re===0&&g.byteLength>=15&&(F.affirmDbHeader(g),L=!0),Q.write(g,{at:y+re}),re+=g.byteLength;if((re<512||re%512!==0)&&n("Input size",re,"is not correct for an SQLite database."),!L){const H=new Uint8Array(20);Q.read(H,{at:0}),F.affirmDbHeader(H)}Q.write(new Uint8Array([1,1]),{at:y+18})}catch(H){throw this.setAssociatedPath(Q,"",0),H}return this.setAssociatedPath(Q,h,u.SQLITE_OPEN_MAIN_DB),re}importDb(h,P){if(P instanceof ArrayBuffer)P=new Uint8Array(P);else if(P instanceof Function)return this.importDbChunked(h,P);const Q=this.#t.get(h)||this.nextAvailableSAH()||n("No available handles to import to."),re=P.byteLength;(re<512||re%512!=0)&&n("Byte array size is invalid for an SQLite db.");const g="SQLite format 3";for(let H=0;H<15;++H)g.charCodeAt(H)!==P[H]&&n("Input does not contain an SQLite database header.");const L=Q.write(P,{at:y});return L!=re?(this.setAssociatedPath(Q,"",0),n("Expected to write "+re+" bytes but wrote "+L+".")):(Q.write(new Uint8Array([1,1]),{at:y+18}),this.setAssociatedPath(Q,h,u.SQLITE_OPEN_MAIN_DB)),L}}class W{#e;constructor(h){this.#e=h,this.vfsName=h.vfsName}async addCapacity(h){return this.#e.addCapacity(h)}async reduceCapacity(h){return this.#e.reduceCapacity(h)}getCapacity(){return this.#e.getCapacity(this.#e)}getFileCount(){return this.#e.getFileCount()}getFileNames(){return this.#e.getFileNames()}async reserveMinimumCapacity(h){const P=this.#e.getCapacity();return P<h?this.#e.addCapacity(h-P):P}exportFile(h){return this.#e.exportFile(h)}importDb(h,P){return this.#e.importDb(h,P)}async wipeFiles(){return this.#e.reset(!0)}unlink(h){return this.#e.deletePath(h)}async removeVfs(){return this.#e.removeVfs()}pauseVfs(){return this.#e.pauseVfs(),this}async unpauseVfs(){return this.#e.unpauseVfs().then(()=>this)}isPaused(){return this.#e.isPaused()}}const K=async()=>{const D=await navigator.storage.getDirectory(),h=".opfs-sahpool-sync-check-"+w(),P=(await(await D.getFileHandle(h,{create:!0})).createSyncAccessHandle()).close();return await P,await D.removeEntry(h),P?.then&&n("The local OPFS API is too old for opfs-sahpool:","it has an async FileSystemSyncAccessHandle.close() method."),!0};s.installOpfsSAHPoolVfs=async function(D=Object.create(null)){D=Object.assign(Object.create(null),m,D||{});const h=D.name;if(D.$testThrowPhase1)throw D.$testThrowPhase1;if(r[h])try{return await r[h]}catch(P){if(D.forceReinitIfPreviouslyFailed)delete r[h];else throw P}return!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle||!globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle||!navigator?.storage?.getDirectory?r[h]=Promise.reject(new Error("Missing required OPFS APIs.")):r[h]=K().then(async function(){if(D.$testThrowPhase2)throw D.$testThrowPhase2;const P=new E(D);return P.isReady.then(async()=>{const Q=new W(P);if(s.oo1){const re=s.oo1,g=P.getVfs(),L=function(...H){const ie=re.DB.dbCtorHelper.normalizeArgs(...H);ie.vfs=g.$zName,re.DB.dbCtorHelper.call(this,ie)};L.prototype=Object.create(re.DB.prototype),Q.OpfsSAHPoolDb=L}return P.log("VFS initialized."),Q}).catch(async Q=>{throw await P.removeVfs().catch(()=>{}),Q})}).catch(P=>r[h]=Promise.reject(P))}});try{const s=Object.assign(Object.create(null),{memory:typeof et<"u"?et:t.wasmMemory,exports:typeof dt<"u"?dt:Object.prototype.hasOwnProperty.call(t,"wasmExports")?t.wasmExports:t.asm},globalThis.sqlite3ApiBootstrap.defaultConfig,globalThis.sqlite3ApiConfig||{});e.debugModule("Bootstrapping lib config",s);const n=globalThis.sqlite3ApiBootstrap(s);return delete globalThis.sqlite3ApiBootstrap,n}catch(s){throw console.error("sqlite3ApiBootstrap() error:",s),s}},jt?ne=c:ne=new Promise((e,t)=>{wt=e,It=t}),ne}Pt=(function(){const we=Pt;if(!we)throw new Error("Expecting sqlite3InitModule to be defined by the Emscripten build.");const ne=globalThis.sqlite3InitModuleState=Object.assign(Object.create(null),{moduleScript:globalThis?.document?.currentScript,isWorker:typeof WorkerGlobalScope<"u",location:globalThis.location,urlParams:globalThis?.location?.href?new URL(globalThis.location.href).searchParams:new URLSearchParams,wasmFilename:"sqlite3.wasm"});if(ne.debugModule=ne.urlParams.has("sqlite3.debugModule")?(...oe)=>console.warn("sqlite3.debugModule:",...oe):()=>{},ne.urlParams.has("sqlite3.dir"))ne.sqlite3Dir=ne.urlParams.get("sqlite3.dir")+"/";else if(ne.moduleScript){const oe=ne.moduleScript.src.split("/");oe.pop(),ne.sqlite3Dir=oe.join("/")+"/"}const c=globalThis.sqlite3InitModule=function oe(...Ae){return ne.emscriptenLocateFile=Ae[0]?.locateFile,ne.emscriptenInstantiateWasm=Ae[0]?.instantiateWasm,we(...Ae).then(Ce=>{ne.debugModule("sqlite3InitModule() sIMS =",ne),ne.debugModule("sqlite3InitModule() EmscriptenModule =",Ce);const We=Ce.runSQLite3PostLoadInit(ne,Ce,!!oe.__isUnderTest);return ne.debugModule("sqlite3InitModule() sqlite3 =",We),We}).catch(Ce=>{throw console.error("Exception loading sqlite3 module:",Ce),Ce})};if(c.ready=we.ready,ne.moduleScript){let oe=ne.moduleScript.src.split("/");oe.pop(),ne.scriptDir=oe.join("/")+"/"}return ne.debugModule("extern-post-js.c-pp.js sqlite3InitModuleState =",ne),c})();var on=Pt;globalThis.sqlite3Worker1Promiser=function we(ne=we.defaultConfig){if(arguments.length===1&&typeof arguments[0]=="function"){const be=ne;ne=Object.assign(Object.create(null),we.defaultConfig),ne.onready=be}else ne=Object.assign(Object.create(null),we.defaultConfig,ne);const c=Object.create(null),oe=function(){},Ae=ne.onerror||oe,Ce=ne.debug||oe,We=ne.generateMessageId?void 0:Object.create(null),mt=ne.generateMessageId||function(be){return be.type+"#"+(We[be.type]=(We[be.type]||0)+1)},St=(...be)=>{throw new Error(be.join(" "))};ne.worker||(ne.worker=we.defaultConfig.worker),typeof ne.worker=="function"&&(ne.worker=ne.worker());let Xe,it;return ne.worker.onmessage=function(be){be=be.data,Ce("worker1.onmessage",be);let Ne=c[be.messageId];if(!Ne){if(be&&be.type==="sqlite3-api"&&be.result==="worker1-ready"){ne.onready&&ne.onready(it);return}if(Ne=c[be.type],Ne&&Ne.onrow){Ne.onrow(be);return}ne.onunhandled?ne.onunhandled(arguments[0]):Ae("sqlite3Worker1Promiser() unhandled worker message:",be);return}switch(delete c[be.messageId],be.type){case"error":Ne.reject(be);return;case"open":Xe||(Xe=be.dbId);break;case"close":be.dbId===Xe&&(Xe=void 0);break}try{Ne.resolve(be)}catch(Qe){Ne.reject(Qe)}},it=function(){let be;arguments.length===1?be=arguments[0]:arguments.length===2?(be=Object.create(null),be.type=arguments[0],be.args=arguments[1],be.dbId=be.args.dbId):St("Invalid arguments for sqlite3Worker1Promiser()-created factory."),!be.dbId&&be.type!=="open"&&(be.dbId=Xe),be.messageId=mt(be),be.departureTime=performance.now();const Ne=Object.create(null);Ne.message=be;let Qe;be.type==="exec"&&be.args&&(typeof be.args.callback=="function"?(Qe=be.messageId+":row",Ne.onrow=be.args.callback,be.args.callback=Qe,c[Qe]=Ne):typeof be.args.callback=="string"&&St("exec callback may not be a string when using the Promise interface."));let ut=new Promise(function(wt,It){Ne.resolve=wt,Ne.reject=It,c[be.messageId]=Ne,Ce("Posting",be.type,"message to Worker dbId="+(Xe||"default")+":",be),ne.worker.postMessage(be)});return Qe&&(ut=ut.finally(()=>delete c[Qe])),ut}},globalThis.sqlite3Worker1Promiser.defaultConfig={worker:function(){return new Worker(new URL("/itdashboard/assets/sqlite3-worker1-CSkTV9U_.js",self.location.href),{type:"module"})},onerror:(...we)=>console.error("sqlite3Worker1Promiser():",...we)},globalThis.sqlite3Worker1Promiser.v2=(function we(ne=we.defaultConfig){let c;typeof ne=="function"?(c=ne,ne={}):typeof ne?.onready=="function"&&(c=ne.onready,delete ne.onready);const oe=Object.create(null);ne=Object.assign(ne||Object.create(null),{onready:async function(Ce){try{c&&await c(Ce),oe.resolve(Ce)}catch(We){oe.reject(We)}}});const Ae=new Promise(function(Ce,We){oe.resolve=Ce,oe.reject=We});try{this.original(ne)}catch(Ce){oe.reject(Ce)}return Ae}).bind({original:sqlite3Worker1Promiser}),globalThis.sqlite3Worker1Promiser.v2.defaultConfig=globalThis.sqlite3Worker1Promiser.defaultConfig,sqlite3Worker1Promiser.v2,delete globalThis.sqlite3Worker1Promiser;var an=on,ln=`CREATE TABLE IF NOT EXISTS kpi_data (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  metric TEXT NOT NULL,
  value REAL NOT NULL,
  unit TEXT,
  category TEXT,
  date TEXT NOT NULL
);

CREATE TABLE IF NOT EXISTS operations_events (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  event_name TEXT NOT NULL,
  status TEXT NOT NULL,
  timestamp TEXT NOT NULL
);

CREATE TABLE IF NOT EXISTS invoice_items (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  FiscalYear INTEGER NOT NULL,
  Period TEXT NOT NULL,
  PostingDate TEXT NOT NULL,
  VendorName TEXT,
  VendorId TEXT,
  DocumentId TEXT NOT NULL,
  LineId INTEGER NOT NULL,
  CostCenter TEXT,
  GLAccount TEXT,
  Category TEXT,
  SubCategory TEXT,
  Service TEXT,
  System TEXT,
  RunChangeInnovation TEXT,
  Amount REAL NOT NULL,
  Currency TEXT NOT NULL,
  Quantity REAL,
  Unit TEXT,
  UnitPrice REAL,
  ContractId TEXT,
  POId TEXT,
  IsRecurring TEXT,
  Description TEXT,
  SourceTag TEXT
);
 
CREATE TABLE IF NOT EXISTS systems (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name TEXT NOT NULL,
  url TEXT,
  status TEXT DEFAULT 'unknown',
  category TEXT,
  is_favorite INTEGER DEFAULT 0,
  sort_order INTEGER DEFAULT 0
);

CREATE TABLE IF NOT EXISTS settings (
  key TEXT PRIMARY KEY,
  value TEXT
);
`,cn=`DROP VIEW IF EXISTS kpi_history;
CREATE VIEW kpi_history AS
WITH aggregated_invoice_costs AS (
    SELECT 
        'IT Costs' as metric, 
        SUM(Amount) as value, 
        'EUR' as unit, 
        'Actuals' as category, 
        MAX(PostingDate) as date
    FROM invoice_items
    GROUP BY Period
),
combined_kpis AS (
    SELECT metric, value, unit, category, date FROM kpi_data
    UNION ALL
    SELECT metric, value, unit, category, date FROM aggregated_invoice_costs
)
SELECT 
    metric, 
    SUM(value) as value, 
    MAX(unit) as unit, 
    MAX(category) as category, 
    date
FROM combined_kpis
GROUP BY metric, date;

DROP VIEW IF EXISTS latest_kpis;
CREATE VIEW latest_kpis AS
SELECT * FROM kpi_history
GROUP BY metric
ORDER BY date DESC;

-- Detailed summary for the IT Costs tile
DROP VIEW IF EXISTS it_costs_summary;
CREATE VIEW it_costs_summary AS
SELECT 
    SUM(Amount) as total_amount,
    COUNT(DISTINCT COALESCE(NULLIF(VendorId, ''), VendorName)) as active_vendors,
    MAX(PostingDate) as latest_date,
    MAX(FiscalYear) as latest_year,
    'EUR' as unit
FROM invoice_items;
`,pt={kpis:[{metric:"IT Costs",value:12e4,unit:"EUR",category:"Finance",date:"2023-10-01"},{metric:"IT Costs",value:115e3,unit:"EUR",category:"Finance",date:"2023-11-01"},{metric:"IT Costs",value:125e3,unit:"EUR",category:"Finance",date:"2023-12-01"},{metric:"Availability",value:99.9,unit:"%",category:"Operations",date:"2023-12-01"}],events:[{event_name:"Server Maintenance",status:"Scheduled",timestamp:"2023-12-10T02:00:00Z"},{event_name:"Incident #1234",status:"Resolved",timestamp:"2023-12-05T14:30:00Z"}],systems:[{name:"SAP ERP",url:"https://sap.example.com",status:"online",category:"Business"},{name:"Jira Service Desk",url:"https://jira.example.com",status:"online",category:"IT"},{name:"Salesforce CRM",url:"https://salesforce.com",status:"online",category:"Sales"},{name:"HR Portal",url:"https://hr.example.com",status:"offline",category:"HR"},{name:"Email (Exchange)",url:"https://outlook.com",status:"online",category:"Communication"},{name:"Legacy File Server",url:"",status:"unknown",category:"IT"}]};let ge=null,rt=null;const Ze=(...we)=>console.log("[DB Worker]",...we),ht=(...we)=>console.error("[DB Worker]",...we);async function Je(){if(!ge)try{if(Ze("Initializing SQLite..."),rt=await an({print:Ze,printErr:ht}),rt.oo1.OpfsDb)try{ge=new rt.oo1.OpfsDb("/itdashboard.sqlite3"),Ze("Opened OPFS database")}catch(oe){ht("OPFS unavailable, falling back to memory",oe),ge=new rt.oo1.DB(":memory:")}else Ze("OPFS not supported, using memory"),ge=new rt.oo1.DB(":memory:");ge.exec(ln),ge.exec(cn);try{const oe=[];ge.exec({sql:"PRAGMA table_info(systems)",rowMode:"object",callback:Ae=>oe.push(Ae.name)}),oe.length>0&&(oe.includes("is_favorite")||(Ze("Migrating systems table: adding is_favorite column"),ge.exec("ALTER TABLE systems ADD COLUMN is_favorite INTEGER DEFAULT 0"),ge.exec("UPDATE systems SET is_favorite = 1 WHERE id IN (SELECT id FROM systems LIMIT 4)")),oe.includes("sort_order")||(Ze("Migrating systems table: adding sort_order column"),ge.exec("ALTER TABLE systems ADD COLUMN sort_order INTEGER DEFAULT 0"),ge.exec("UPDATE systems SET sort_order = id"))),ge.exec("CREATE TABLE IF NOT EXISTS settings (key TEXT PRIMARY KEY, value TEXT)")}catch(oe){ht("Migration failed",oe)}Ze("Schema initialized");const ne=ge.selectValue("SELECT count(*) FROM kpi_data"),c=ge.selectValue("SELECT count(*) FROM invoice_items");ne===0&&c===0&&(Ze("Database empty, loading demo data..."),await Dt())}catch(we){throw ht("Initialization failed",we),we}}async function Dt(){ge.exec("DELETE FROM kpi_data; DELETE FROM operations_events; DELETE FROM invoice_items;");const we=ge.prepare("INSERT INTO kpi_data (metric, value, unit, category, date) VALUES (?, ?, ?, ?, ?)");try{ge.exec("BEGIN TRANSACTION");for(const ne of pt.kpis)we.bind([ne.metric,ne.value,ne.unit,ne.category,ne.date]),we.step(),we.reset();ge.exec("COMMIT")}finally{we.finalize()}if(pt.events){const ne=ge.prepare("INSERT INTO operations_events (event_name, status, timestamp) VALUES (?, ?, ?)");try{ge.exec("BEGIN TRANSACTION");for(const c of pt.events)ne.bind([c.event_name,c.status,c.timestamp]),ne.step(),ne.reset();ge.exec("COMMIT")}finally{ne.finalize()}}if(pt.systems){const ne=ge.prepare("INSERT INTO systems (name, url, status, category, is_favorite, sort_order) VALUES (?, ?, ?, ?, ?, ?)");try{ge.exec("BEGIN TRANSACTION");let c=0;for(const oe of pt.systems){const Ae=c<4?1:0;ne.bind([oe.name,oe.url,oe.status,oe.category,Ae,c]),ne.step(),ne.reset(),c++}ge.exec("COMMIT")}finally{ne.finalize()}}Ze("Demo data loaded")}async function un(we){const{id:ne,type:c,payload:oe}=we.data;try{let Ae;switch(c){case"INIT":await Je(),Ae=!0;break;case"EXEC":ge||await Je();const Ce=[];ge.exec({sql:oe.sql,bind:oe.bind,rowMode:"object",callback:We=>Ce.push(We)}),Ae=Ce;break;case"BULK_INSERT_INVOICE_ITEMS":ge||await Je(),_n(oe),Ae=!0;break;case"BULK_INSERT_KPIS":ge||await Je(),fn(oe),Ae=!0;break;case"BULK_INSERT_EVENTS":ge||await Je(),dn(oe),Ae=!0;break;case"BULK_INSERT_SYSTEMS":ge||await Je(),pn(oe),Ae=!0;break;case"EXPORT":ge||await Je(),Ae=rt.capi.sqlite3_js_db_export(ge.pointer);break;case"IMPORT":await hn(oe),Ae=!0;break;case"CLEAR":ge||await Je(),ge.exec("DELETE FROM kpi_data; DELETE FROM operations_events; DELETE FROM invoice_items;"),Ae=!0;break;case"LOAD_DEMO":ge||await Je(),await Dt(),Ae=!0;break;case"INIT_SCHEMA":ge||await Je(),Ae=!0;break}self.postMessage({id:ne,result:Ae})}catch(Ae){self.postMessage({id:ne,error:Ae.message})}}function _n(we){const c=ge.prepare(`
        INSERT INTO invoice_items (
            FiscalYear, Period, PostingDate, VendorName, VendorId, 
            DocumentId, LineId, CostCenter, GLAccount, Category, 
            SubCategory, Service, System, RunChangeInnovation, Amount, 
            Currency, Quantity, Unit, UnitPrice, ContractId, 
            POId, IsRecurring, Description, SourceTag
        ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
    `);try{ge.exec("BEGIN TRANSACTION");for(const oe of we)c.bind([oe.FiscalYear,oe.Period,oe.PostingDate,oe.VendorName,oe.VendorId,oe.DocumentId,oe.LineId,oe.CostCenter,oe.GLAccount,oe.Category,oe.SubCategory,oe.Service,oe.System,oe.RunChangeInnovation,oe.Amount,oe.Currency,oe.Quantity,oe.Unit,oe.UnitPrice,oe.ContractId,oe.POId,oe.IsRecurring,oe.Description,oe.SourceTag]),c.step(),c.reset();ge.exec("COMMIT")}catch(oe){throw ge.exec("ROLLBACK"),oe}finally{c.finalize()}}function fn(we){const ne=ge.prepare("INSERT INTO kpi_data (metric, value, unit, category, date) VALUES (?, ?, ?, ?, ?)");try{ge.exec("BEGIN TRANSACTION");for(const c of we)ne.bind([c.metric,c.value,c.unit,c.category,c.date]),ne.step(),ne.reset();ge.exec("COMMIT")}catch(c){throw ge.exec("ROLLBACK"),c}finally{ne.finalize()}}function dn(we){const ne=ge.prepare("INSERT INTO operations_events (event_name, status, timestamp) VALUES (?, ?, ?)");try{ge.exec("BEGIN TRANSACTION");for(const c of we)ne.bind([c.event_name,c.status,c.timestamp]),ne.step(),ne.reset();ge.exec("COMMIT")}catch(c){throw ge.exec("ROLLBACK"),c}finally{ne.finalize()}}function pn(we){const ne=ge.prepare("INSERT INTO systems (name, url, status, category, is_favorite, sort_order) VALUES (?, ?, ?, ?, ?, ?)");try{ge.exec("BEGIN TRANSACTION");for(const c of we)ne.bind([c.name,c.url,c.status,c.category,c.is_favorite||0,c.sort_order||0]),ne.step(),ne.reset();ge.exec("COMMIT")}catch(c){throw ge.exec("ROLLBACK"),c}finally{ne.finalize()}}async function hn(we){if(ge&&(ge.close(),ge=null),rt.oo1.OpfsDb)try{const ne=await navigator.storage.getDirectory();try{await ne.removeEntry("itdashboard.sqlite3")}catch{}const oe=await(await ne.getFileHandle("itdashboard.sqlite3",{create:!0})).createWritable();await oe.write(we),await oe.close()}catch(ne){throw ht("Import failed",ne),ne}}self.onmessage=un})();
