import{u as Ne,j as n,o as qt,e as hr,S as ae,q as Ur,c as fr,a as Yt,d as qr,P as Yr,C as Xt,M as Vt,b as ze}from"./index-7LPLAlBg.js";import{r as l,d as X,b as $e,u as ut}from"./vendor-react-D64xOC9_.js";import{u as Xr}from"./MarkdownContent-CAlm1i0z.js";import{W as Vr}from"./WidgetRenderer-DfnRWtxE.js";import{d as Hr,X as br,am as St,an as Jr,g as nt,$ as Gr,D as Fe,A as st,C as Zr,ao as Qr,O as en,m as gr,S as pr,h as at,Z as tn,z as rn,H as nn,a4 as vt,u as ke,K as wt,ad as yt,t as sn,ap as Ht,a3 as an,a9 as on,aa as ln,al as cn,a0 as dn}from"./vendor-icons-Du2dXQHa.js";import{u as un}from"./useBackupStatus-B3NnXO8r.js";import"./vendor-pdf-FXkUb51H.js";import"./vendor-ui-BNe0Xlio.js";import"./vendor-charts-BtQqxQq4.js";import"./vendor-canvas-DXEQVQnt.js";import"./DataTable-BpNqlfh8.js";import"./RecordDetailModal-BSkdUzn9.js";import"./SchemaDocumentation-CqOaykNn.js";import"./inspectorBridge-BnIEasIL.js";const ht=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Ee(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Ot(e){return"nodeType"in e}function V(e){var t,r;return e?Ee(e)?e:Ot(e)&&(t=(r=e.ownerDocument)==null?void 0:r.defaultView)!=null?t:window:window}function It(e){const{Document:t}=V(e);return e instanceof t}function Xe(e){return Ee(e)?!1:e instanceof V(e).HTMLElement}function xr(e){return e instanceof V(e).SVGElement}function Re(e){return e?Ee(e)?e.document:Ot(e)?It(e)?e:Xe(e)||xr(e)?e.ownerDocument:document:document:document}const we=ht?l.useLayoutEffect:l.useEffect;function Lt(e){const t=l.useRef(e);return we(()=>{t.current=e}),l.useCallback(function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return t.current==null?void 0:t.current(...s)},[])}function hn(){const e=l.useRef(null),t=l.useCallback((s,a)=>{e.current=setInterval(s,a)},[]),r=l.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,r]}function Ue(e,t){t===void 0&&(t=[e]);const r=l.useRef(e);return we(()=>{r.current!==e&&(r.current=e)},t),r}function Ve(e,t){const r=l.useRef();return l.useMemo(()=>{const s=e(r.current);return r.current=s,s},[...t])}function it(e){const t=Lt(e),r=l.useRef(null),s=l.useCallback(a=>{a!==r.current&&t?.(a,r.current),r.current=a},[]);return[r,s]}function Et(e){const t=l.useRef();return l.useEffect(()=>{t.current=e},[e]),t.current}let kt={};function ft(e,t){return l.useMemo(()=>{if(t)return t;const r=kt[e]==null?0:kt[e]+1;return kt[e]=r,e+"-"+r},[e,t])}function mr(e){return function(t){for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];return s.reduce((o,d)=>{const c=Object.entries(d);for(const[u,f]of c){const b=o[u];b!=null&&(o[u]=b+e*f)}return o},{...t})}}const Se=mr(1),qe=mr(-1);function fn(e){return"clientX"in e&&"clientY"in e}function vr(e){if(!e)return!1;const{KeyboardEvent:t}=V(e.target);return t&&e instanceof t}function bn(e){if(!e)return!1;const{TouchEvent:t}=V(e.target);return t&&e instanceof t}function Rt(e){if(bn(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return fn(e)?{x:e.clientX,y:e.clientY}:null}const _t=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[_t.Translate.toString(e),_t.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:s}=e;return t+" "+r+"ms "+s}}}),Jt="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function gn(e){return e.matches(Jt)?e:e.querySelector(Jt)}const pn={display:"none"};function xn(e){let{id:t,value:r}=e;return X.createElement("div",{id:t,style:pn},r)}function mn(e){let{id:t,announcement:r,ariaLiveType:s="assertive"}=e;const a={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return X.createElement("div",{id:t,style:a,role:"status","aria-live":s,"aria-atomic":!0},r)}function vn(){const[e,t]=l.useState("");return{announce:l.useCallback(s=>{s!=null&&t(s)},[]),announcement:e}}const wr=l.createContext(null);function wn(e){const t=l.useContext(wr);l.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function yn(){const[e]=l.useState(()=>new Set),t=l.useCallback(s=>(e.add(s),()=>e.delete(s)),[e]);return[l.useCallback(s=>{let{type:a,event:o}=s;e.forEach(d=>{var c;return(c=d[a])==null?void 0:c.call(d,o)})},[e]),t]}const kn={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Nn={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function jn(e){let{announcements:t=Nn,container:r,hiddenTextDescribedById:s,screenReaderInstructions:a=kn}=e;const{announce:o,announcement:d}=vn(),c=ft("DndLiveRegion"),[u,f]=l.useState(!1);if(l.useEffect(()=>{f(!0)},[]),wn(l.useMemo(()=>({onDragStart(h){let{active:v}=h;o(t.onDragStart({active:v}))},onDragMove(h){let{active:v,over:p}=h;t.onDragMove&&o(t.onDragMove({active:v,over:p}))},onDragOver(h){let{active:v,over:p}=h;o(t.onDragOver({active:v,over:p}))},onDragEnd(h){let{active:v,over:p}=h;o(t.onDragEnd({active:v,over:p}))},onDragCancel(h){let{active:v,over:p}=h;o(t.onDragCancel({active:v,over:p}))}}),[o,t])),!u)return null;const b=X.createElement(X.Fragment,null,X.createElement(xn,{id:s,value:a.draggable}),X.createElement(mn,{id:c,announcement:d}));return r?$e.createPortal(b,r):b}var F;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(F||(F={}));function lt(){}function Gt(e,t){return l.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function Cn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return l.useMemo(()=>[...t].filter(s=>s!=null),[...t])}const oe=Object.freeze({x:0,y:0});function yr(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function kr(e,t){let{data:{value:r}}=e,{data:{value:s}}=t;return r-s}function Dn(e,t){let{data:{value:r}}=e,{data:{value:s}}=t;return s-r}function Zt(e){let{left:t,top:r,height:s,width:a}=e;return[{x:t,y:r},{x:t+a,y:r},{x:t,y:r+s},{x:t+a,y:r+s}]}function Nr(e,t){if(!e||e.length===0)return null;const[r]=e;return r[t]}function Qt(e,t,r){return t===void 0&&(t=e.left),r===void 0&&(r=e.top),{x:t+e.width*.5,y:r+e.height*.5}}const Sn=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:s}=e;const a=Qt(t,t.left,t.top),o=[];for(const d of s){const{id:c}=d,u=r.get(c);if(u){const f=yr(Qt(u),a);o.push({id:c,data:{droppableContainer:d,value:f}})}}return o.sort(kr)},En=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:s}=e;const a=Zt(t),o=[];for(const d of s){const{id:c}=d,u=r.get(c);if(u){const f=Zt(u),b=a.reduce((v,p,N)=>v+yr(f[N],p),0),h=Number((b/4).toFixed(4));o.push({id:c,data:{droppableContainer:d,value:h}})}}return o.sort(kr)};function Rn(e,t){const r=Math.max(t.top,e.top),s=Math.max(t.left,e.left),a=Math.min(t.left+t.width,e.left+e.width),o=Math.min(t.top+t.height,e.top+e.height),d=a-s,c=o-r;if(s<a&&r<o){const u=t.width*t.height,f=e.width*e.height,b=d*c,h=b/(u+f-b);return Number(h.toFixed(4))}return 0}const _n=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:s}=e;const a=[];for(const o of s){const{id:d}=o,c=r.get(d);if(c){const u=Rn(c,t);u>0&&a.push({id:d,data:{droppableContainer:o,value:u}})}}return a.sort(Dn)};function Mn(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}function jr(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:oe}function An(e){return function(r){for(var s=arguments.length,a=new Array(s>1?s-1:0),o=1;o<s;o++)a[o-1]=arguments[o];return a.reduce((d,c)=>({...d,top:d.top+e*c.y,bottom:d.bottom+e*c.y,left:d.left+e*c.x,right:d.right+e*c.x}),{...r})}}const Tn=An(1);function On(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function In(e,t,r){const s=On(t);if(!s)return e;const{scaleX:a,scaleY:o,x:d,y:c}=s,u=e.left-d-(1-a)*parseFloat(r),f=e.top-c-(1-o)*parseFloat(r.slice(r.indexOf(" ")+1)),b=a?e.width/a:e.width,h=o?e.height/o:e.height;return{width:b,height:h,top:f,right:u+b,bottom:f+h,left:u}}const Ln={ignoreTransform:!1};function He(e,t){t===void 0&&(t=Ln);let r=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:f,transformOrigin:b}=V(e).getComputedStyle(e);f&&(r=In(r,f,b))}const{top:s,left:a,width:o,height:d,bottom:c,right:u}=r;return{top:s,left:a,width:o,height:d,bottom:c,right:u}}function er(e){return He(e,{ignoreTransform:!0})}function Pn(e){const t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}function zn(e,t){return t===void 0&&(t=V(e).getComputedStyle(e)),t.position==="fixed"}function $n(e,t){t===void 0&&(t=V(e).getComputedStyle(e));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(a=>{const o=t[a];return typeof o=="string"?r.test(o):!1})}function bt(e,t){const r=[];function s(a){if(t!=null&&r.length>=t||!a)return r;if(It(a)&&a.scrollingElement!=null&&!r.includes(a.scrollingElement))return r.push(a.scrollingElement),r;if(!Xe(a)||xr(a)||r.includes(a))return r;const o=V(e).getComputedStyle(a);return a!==e&&$n(a,o)&&r.push(a),zn(a,o)?r:s(a.parentNode)}return e?s(e):r}function Cr(e){const[t]=bt(e,1);return t??null}function Nt(e){return!ht||!e?null:Ee(e)?e:Ot(e)?It(e)||e===Re(e).scrollingElement?window:Xe(e)?e:null:null}function Dr(e){return Ee(e)?e.scrollX:e.scrollLeft}function Sr(e){return Ee(e)?e.scrollY:e.scrollTop}function Mt(e){return{x:Dr(e),y:Sr(e)}}var W;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(W||(W={}));function Er(e){return!ht||!e?!1:e===document.scrollingElement}function Rr(e){const t={x:0,y:0},r=Er(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},s={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},a=e.scrollTop<=t.y,o=e.scrollLeft<=t.x,d=e.scrollTop>=s.y,c=e.scrollLeft>=s.x;return{isTop:a,isLeft:o,isBottom:d,isRight:c,maxScroll:s,minScroll:t}}const Fn={x:.2,y:.2};function Bn(e,t,r,s,a){let{top:o,left:d,right:c,bottom:u}=r;s===void 0&&(s=10),a===void 0&&(a=Fn);const{isTop:f,isBottom:b,isLeft:h,isRight:v}=Rr(e),p={x:0,y:0},N={x:0,y:0},w={height:t.height*a.y,width:t.width*a.x};return!f&&o<=t.top+w.height?(p.y=W.Backward,N.y=s*Math.abs((t.top+w.height-o)/w.height)):!b&&u>=t.bottom-w.height&&(p.y=W.Forward,N.y=s*Math.abs((t.bottom-w.height-u)/w.height)),!v&&c>=t.right-w.width?(p.x=W.Forward,N.x=s*Math.abs((t.right-w.width-c)/w.width)):!h&&d<=t.left+w.width&&(p.x=W.Backward,N.x=s*Math.abs((t.left+w.width-d)/w.width)),{direction:p,speed:N}}function Wn(e){if(e===document.scrollingElement){const{innerWidth:o,innerHeight:d}=window;return{top:0,left:0,right:o,bottom:d,width:o,height:d}}const{top:t,left:r,right:s,bottom:a}=e.getBoundingClientRect();return{top:t,left:r,right:s,bottom:a,width:e.clientWidth,height:e.clientHeight}}function _r(e){return e.reduce((t,r)=>Se(t,Mt(r)),oe)}function Kn(e){return e.reduce((t,r)=>t+Dr(r),0)}function Un(e){return e.reduce((t,r)=>t+Sr(r),0)}function qn(e,t){if(t===void 0&&(t=He),!e)return;const{top:r,left:s,bottom:a,right:o}=t(e);Cr(e)&&(a<=0||o<=0||r>=window.innerHeight||s>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Yn=[["x",["left","right"],Kn],["y",["top","bottom"],Un]];class Pt{constructor(t,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const s=bt(r),a=_r(s);this.rect={...t},this.width=t.width,this.height=t.height;for(const[o,d,c]of Yn)for(const u of d)Object.defineProperty(this,u,{get:()=>{const f=c(s),b=a[o]-f;return this.rect[u]+b},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Be{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var s;return(s=this.target)==null?void 0:s.removeEventListener(...r)})},this.target=t}add(t,r,s){var a;(a=this.target)==null||a.addEventListener(t,r,s),this.listeners.push([t,r,s])}}function Xn(e){const{EventTarget:t}=V(e);return e instanceof t?e:Re(e)}function jt(e,t){const r=Math.abs(e.x),s=Math.abs(e.y);return typeof t=="number"?Math.sqrt(r**2+s**2)>t:"x"in t&&"y"in t?r>t.x&&s>t.y:"x"in t?r>t.x:"y"in t?s>t.y:!1}var se;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(se||(se={}));function tr(e){e.preventDefault()}function Vn(e){e.stopPropagation()}var C;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(C||(C={}));const Mr={start:[C.Space,C.Enter],cancel:[C.Esc],end:[C.Space,C.Enter,C.Tab]},Hn=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case C.Right:return{...r,x:r.x+25};case C.Left:return{...r,x:r.x-25};case C.Down:return{...r,y:r.y+25};case C.Up:return{...r,y:r.y-25}}};class zt{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:r}}=t;this.props=t,this.listeners=new Be(Re(r)),this.windowListeners=new Be(V(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(se.Resize,this.handleCancel),this.windowListeners.add(se.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(se.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:r}=this.props,s=t.node.current;s&&qn(s),r(oe)}handleKeyDown(t){if(vr(t)){const{active:r,context:s,options:a}=this.props,{keyboardCodes:o=Mr,coordinateGetter:d=Hn,scrollBehavior:c="smooth"}=a,{code:u}=t;if(o.end.includes(u)){this.handleEnd(t);return}if(o.cancel.includes(u)){this.handleCancel(t);return}const{collisionRect:f}=s.current,b=f?{x:f.left,y:f.top}:oe;this.referenceCoordinates||(this.referenceCoordinates=b);const h=d(t,{active:r,context:s.current,currentCoordinates:b});if(h){const v=qe(h,b),p={x:0,y:0},{scrollableAncestors:N}=s.current;for(const w of N){const k=t.code,{isTop:E,isRight:_,isLeft:D,isBottom:L,maxScroll:A,minScroll:O}=Rr(w),S=Wn(w),R={x:Math.min(k===C.Right?S.right-S.width/2:S.right,Math.max(k===C.Right?S.left:S.left+S.width/2,h.x)),y:Math.min(k===C.Down?S.bottom-S.height/2:S.bottom,Math.max(k===C.Down?S.top:S.top+S.height/2,h.y))},I=k===C.Right&&!_||k===C.Left&&!D,B=k===C.Down&&!L||k===C.Up&&!E;if(I&&R.x!==h.x){const z=w.scrollLeft+v.x,P=k===C.Right&&z<=A.x||k===C.Left&&z>=O.x;if(P&&!v.y){w.scrollTo({left:z,behavior:c});return}P?p.x=w.scrollLeft-z:p.x=k===C.Right?w.scrollLeft-A.x:w.scrollLeft-O.x,p.x&&w.scrollBy({left:-p.x,behavior:c});break}else if(B&&R.y!==h.y){const z=w.scrollTop+v.y,P=k===C.Down&&z<=A.y||k===C.Up&&z>=O.y;if(P&&!v.x){w.scrollTo({top:z,behavior:c});return}P?p.y=w.scrollTop-z:p.y=k===C.Down?w.scrollTop-A.y:w.scrollTop-O.y,p.y&&w.scrollBy({top:-p.y,behavior:c});break}}this.handleMove(t,Se(qe(h,this.referenceCoordinates),p))}}}handleMove(t,r){const{onMove:s}=this.props;t.preventDefault(),s(r)}handleEnd(t){const{onEnd:r}=this.props;t.preventDefault(),this.detach(),r()}handleCancel(t){const{onCancel:r}=this.props;t.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}zt.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:s=Mr,onActivation:a}=t,{active:o}=r;const{code:d}=e.nativeEvent;if(s.start.includes(d)){const c=o.activatorNode.current;return c&&e.target!==c?!1:(e.preventDefault(),a?.({event:e.nativeEvent}),!0)}return!1}}];function rr(e){return!!(e&&"distance"in e)}function nr(e){return!!(e&&"delay"in e)}class $t{constructor(t,r,s){var a;s===void 0&&(s=Xn(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=r;const{event:o}=t,{target:d}=o;this.props=t,this.events=r,this.document=Re(d),this.documentListeners=new Be(this.document),this.listeners=new Be(s),this.windowListeners=new Be(V(d)),this.initialCoordinates=(a=Rt(o))!=null?a:oe,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:r,bypassActivationConstraint:s}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(se.Resize,this.handleCancel),this.windowListeners.add(se.DragStart,tr),this.windowListeners.add(se.VisibilityChange,this.handleCancel),this.windowListeners.add(se.ContextMenu,tr),this.documentListeners.add(se.Keydown,this.handleKeydown),r){if(s!=null&&s({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(nr(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(rr(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,r){const{active:s,onPending:a}=this.props;a(s,t,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:t}=this,{onStart:r}=this.props;t&&(this.activated=!0,this.documentListeners.add(se.Click,Vn,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(se.SelectionChange,this.removeTextSelection),r(t))}handleMove(t){var r;const{activated:s,initialCoordinates:a,props:o}=this,{onMove:d,options:{activationConstraint:c}}=o;if(!a)return;const u=(r=Rt(t))!=null?r:oe,f=qe(a,u);if(!s&&c){if(rr(c)){if(c.tolerance!=null&&jt(f,c.tolerance))return this.handleCancel();if(jt(f,c.distance))return this.handleStart()}if(nr(c)&&jt(f,c.tolerance))return this.handleCancel();this.handlePending(c,f);return}t.cancelable&&t.preventDefault(),d(u)}handleEnd(){const{onAbort:t,onEnd:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleCancel(){const{onAbort:t,onCancel:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleKeydown(t){t.code===C.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Jn={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Ft extends $t{constructor(t){const{event:r}=t,s=Re(r.target);super(t,Jn,s)}}Ft.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:s}=t;return!r.isPrimary||r.button!==0?!1:(s?.({event:r}),!0)}}];const Gn={move:{name:"mousemove"},end:{name:"mouseup"}};var At;(function(e){e[e.RightClick=2]="RightClick"})(At||(At={}));class Zn extends $t{constructor(t){super(t,Gn,Re(t.event.target))}}Zn.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:s}=t;return r.button===At.RightClick?!1:(s?.({event:r}),!0)}}];const Ct={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Qn extends $t{constructor(t){super(t,Ct)}static setup(){return window.addEventListener(Ct.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(Ct.move.name,t)};function t(){}}}Qn.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:s}=t;const{touches:a}=r;return a.length>1?!1:(s?.({event:r}),!0)}}];var We;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(We||(We={}));var ct;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(ct||(ct={}));function es(e){let{acceleration:t,activator:r=We.Pointer,canScroll:s,draggingRect:a,enabled:o,interval:d=5,order:c=ct.TreeOrder,pointerCoordinates:u,scrollableAncestors:f,scrollableAncestorRects:b,delta:h,threshold:v}=e;const p=rs({delta:h,disabled:!o}),[N,w]=hn(),k=l.useRef({x:0,y:0}),E=l.useRef({x:0,y:0}),_=l.useMemo(()=>{switch(r){case We.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case We.DraggableRect:return a}},[r,a,u]),D=l.useRef(null),L=l.useCallback(()=>{const O=D.current;if(!O)return;const S=k.current.x*E.current.x,R=k.current.y*E.current.y;O.scrollBy(S,R)},[]),A=l.useMemo(()=>c===ct.TreeOrder?[...f].reverse():f,[c,f]);l.useEffect(()=>{if(!o||!f.length||!_){w();return}for(const O of A){if(s?.(O)===!1)continue;const S=f.indexOf(O),R=b[S];if(!R)continue;const{direction:I,speed:B}=Bn(O,R,_,t,v);for(const z of["x","y"])p[z][I[z]]||(B[z]=0,I[z]=0);if(B.x>0||B.y>0){w(),D.current=O,N(L,d),k.current=B,E.current=I;return}}k.current={x:0,y:0},E.current={x:0,y:0},w()},[t,L,s,w,o,d,JSON.stringify(_),JSON.stringify(p),N,f,A,b,JSON.stringify(v)])}const ts={x:{[W.Backward]:!1,[W.Forward]:!1},y:{[W.Backward]:!1,[W.Forward]:!1}};function rs(e){let{delta:t,disabled:r}=e;const s=Et(t);return Ve(a=>{if(r||!s||!a)return ts;const o={x:Math.sign(t.x-s.x),y:Math.sign(t.y-s.y)};return{x:{[W.Backward]:a.x[W.Backward]||o.x===-1,[W.Forward]:a.x[W.Forward]||o.x===1},y:{[W.Backward]:a.y[W.Backward]||o.y===-1,[W.Forward]:a.y[W.Forward]||o.y===1}}},[r,t,s])}function ns(e,t){const r=t!=null?e.get(t):void 0,s=r?r.node.current:null;return Ve(a=>{var o;return t==null?null:(o=s??a)!=null?o:null},[s,t])}function ss(e,t){return l.useMemo(()=>e.reduce((r,s)=>{const{sensor:a}=s,o=a.activators.map(d=>({eventName:d.eventName,handler:t(d.handler,s)}));return[...r,...o]},[]),[e,t])}var Ye;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Ye||(Ye={}));var Tt;(function(e){e.Optimized="optimized"})(Tt||(Tt={}));const sr=new Map;function as(e,t){let{dragging:r,dependencies:s,config:a}=t;const[o,d]=l.useState(null),{frequency:c,measure:u,strategy:f}=a,b=l.useRef(e),h=k(),v=Ue(h),p=l.useCallback(function(E){E===void 0&&(E=[]),!v.current&&d(_=>_===null?E:_.concat(E.filter(D=>!_.includes(D))))},[v]),N=l.useRef(null),w=Ve(E=>{if(h&&!r)return sr;if(!E||E===sr||b.current!==e||o!=null){const _=new Map;for(let D of e){if(!D)continue;if(o&&o.length>0&&!o.includes(D.id)&&D.rect.current){_.set(D.id,D.rect.current);continue}const L=D.node.current,A=L?new Pt(u(L),L):null;D.rect.current=A,A&&_.set(D.id,A)}return _}return E},[e,o,r,h,u]);return l.useEffect(()=>{b.current=e},[e]),l.useEffect(()=>{h||p()},[r,h]),l.useEffect(()=>{o&&o.length>0&&d(null)},[JSON.stringify(o)]),l.useEffect(()=>{h||typeof c!="number"||N.current!==null||(N.current=setTimeout(()=>{p(),N.current=null},c))},[c,h,p,...s]),{droppableRects:w,measureDroppableContainers:p,measuringScheduled:o!=null};function k(){switch(f){case Ye.Always:return!1;case Ye.BeforeDragging:return r;default:return!r}}}function Ar(e,t){return Ve(r=>e?r||(typeof t=="function"?t(e):e):null,[t,e])}function os(e,t){return Ar(e,t)}function is(e){let{callback:t,disabled:r}=e;const s=Lt(t),a=l.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(s)},[s,r]);return l.useEffect(()=>()=>a?.disconnect(),[a]),a}function gt(e){let{callback:t,disabled:r}=e;const s=Lt(t),a=l.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(s)},[r]);return l.useEffect(()=>()=>a?.disconnect(),[a]),a}function ls(e){return new Pt(He(e),e)}function ar(e,t,r){t===void 0&&(t=ls);const[s,a]=l.useState(null);function o(){a(u=>{if(!e)return null;if(e.isConnected===!1){var f;return(f=u??r)!=null?f:null}const b=t(e);return JSON.stringify(u)===JSON.stringify(b)?u:b})}const d=is({callback(u){if(e)for(const f of u){const{type:b,target:h}=f;if(b==="childList"&&h instanceof HTMLElement&&h.contains(e)){o();break}}}}),c=gt({callback:o});return we(()=>{o(),e?(c?.observe(e),d?.observe(document.body,{childList:!0,subtree:!0})):(c?.disconnect(),d?.disconnect())},[e]),s}function cs(e){const t=Ar(e);return jr(e,t)}const or=[];function ds(e){const t=l.useRef(e),r=Ve(s=>e?s&&s!==or&&e&&t.current&&e.parentNode===t.current.parentNode?s:bt(e):or,[e]);return l.useEffect(()=>{t.current=e},[e]),r}function us(e){const[t,r]=l.useState(null),s=l.useRef(e),a=l.useCallback(o=>{const d=Nt(o.target);d&&r(c=>c?(c.set(d,Mt(d)),new Map(c)):null)},[]);return l.useEffect(()=>{const o=s.current;if(e!==o){d(o);const c=e.map(u=>{const f=Nt(u);return f?(f.addEventListener("scroll",a,{passive:!0}),[f,Mt(f)]):null}).filter(u=>u!=null);r(c.length?new Map(c):null),s.current=e}return()=>{d(e),d(o)};function d(c){c.forEach(u=>{const f=Nt(u);f?.removeEventListener("scroll",a)})}},[a,e]),l.useMemo(()=>e.length?t?Array.from(t.values()).reduce((o,d)=>Se(o,d),oe):_r(e):oe,[e,t])}function ir(e,t){t===void 0&&(t=[]);const r=l.useRef(null);return l.useEffect(()=>{r.current=null},t),l.useEffect(()=>{const s=e!==oe;s&&!r.current&&(r.current=e),!s&&r.current&&(r.current=null)},[e]),r.current?qe(e,r.current):oe}function hs(e){l.useEffect(()=>{if(!ht)return;const t=e.map(r=>{let{sensor:s}=r;return s.setup==null?void 0:s.setup()});return()=>{for(const r of t)r?.()}},e.map(t=>{let{sensor:r}=t;return r}))}function fs(e,t){return l.useMemo(()=>e.reduce((r,s)=>{let{eventName:a,handler:o}=s;return r[a]=d=>{o(d,t)},r},{}),[e,t])}function Tr(e){return l.useMemo(()=>e?Pn(e):null,[e])}const lr=[];function bs(e,t){t===void 0&&(t=He);const[r]=e,s=Tr(r?V(r):null),[a,o]=l.useState(lr);function d(){o(()=>e.length?e.map(u=>Er(u)?s:new Pt(t(u),u)):lr)}const c=gt({callback:d});return we(()=>{c?.disconnect(),d(),e.forEach(u=>c?.observe(u))},[e]),a}function gs(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Xe(t)?t:e}function ps(e){let{measure:t}=e;const[r,s]=l.useState(null),a=l.useCallback(f=>{for(const{target:b}of f)if(Xe(b)){s(h=>{const v=t(b);return h?{...h,width:v.width,height:v.height}:v});break}},[t]),o=gt({callback:a}),d=l.useCallback(f=>{const b=gs(f);o?.disconnect(),b&&o?.observe(b),s(b?t(b):null)},[t,o]),[c,u]=it(d);return l.useMemo(()=>({nodeRef:c,rect:r,setRef:u}),[r,c,u])}const xs=[{sensor:Ft,options:{}},{sensor:zt,options:{}}],ms={current:{}},ot={draggable:{measure:er},droppable:{measure:er,strategy:Ye.WhileDragging,frequency:Tt.Optimized},dragOverlay:{measure:He}};class Ke extends Map{get(t){var r;return t!=null&&(r=super.get(t))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:r}=t;return!r})}getNodeFor(t){var r,s;return(r=(s=this.get(t))==null?void 0:s.node.current)!=null?r:void 0}}const vs={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Ke,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:lt},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:ot,measureDroppableContainers:lt,windowRect:null,measuringScheduled:!1},ws={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:lt,draggableNodes:new Map,over:null,measureDroppableContainers:lt},pt=l.createContext(ws),ys=l.createContext(vs);function ks(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Ke}}}function Ns(e,t){switch(t.type){case F.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case F.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case F.DragEnd:case F.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case F.RegisterDroppable:{const{element:r}=t,{id:s}=r,a=new Ke(e.droppable.containers);return a.set(s,r),{...e,droppable:{...e.droppable,containers:a}}}case F.SetDroppableDisabled:{const{id:r,key:s,disabled:a}=t,o=e.droppable.containers.get(r);if(!o||s!==o.key)return e;const d=new Ke(e.droppable.containers);return d.set(r,{...o,disabled:a}),{...e,droppable:{...e.droppable,containers:d}}}case F.UnregisterDroppable:{const{id:r,key:s}=t,a=e.droppable.containers.get(r);if(!a||s!==a.key)return e;const o=new Ke(e.droppable.containers);return o.delete(r),{...e,droppable:{...e.droppable,containers:o}}}default:return e}}function js(e){let{disabled:t}=e;const{active:r,activatorEvent:s,draggableNodes:a}=l.useContext(pt),o=Et(s),d=Et(r?.id);return l.useEffect(()=>{if(!t&&!s&&o&&d!=null){if(!vr(o)||document.activeElement===o.target)return;const c=a.get(d);if(!c)return;const{activatorNode:u,node:f}=c;if(!u.current&&!f.current)return;requestAnimationFrame(()=>{for(const b of[u.current,f.current]){if(!b)continue;const h=gn(b);if(h){h.focus();break}}})}},[s,t,a,d,o]),null}function Cs(e,t){let{transform:r,...s}=t;return e!=null&&e.length?e.reduce((a,o)=>o({transform:a,...s}),r):r}function Ds(e){return l.useMemo(()=>({draggable:{...ot.draggable,...e?.draggable},droppable:{...ot.droppable,...e?.droppable},dragOverlay:{...ot.dragOverlay,...e?.dragOverlay}}),[e?.draggable,e?.droppable,e?.dragOverlay])}function Ss(e){let{activeNode:t,measure:r,initialRect:s,config:a=!0}=e;const o=l.useRef(!1),{x:d,y:c}=typeof a=="boolean"?{x:a,y:a}:a;we(()=>{if(!d&&!c||!t){o.current=!1;return}if(o.current||!s)return;const f=t?.node.current;if(!f||f.isConnected===!1)return;const b=r(f),h=jr(b,s);if(d||(h.x=0),c||(h.y=0),o.current=!0,Math.abs(h.x)>0||Math.abs(h.y)>0){const v=Cr(f);v&&v.scrollBy({top:h.y,left:h.x})}},[t,d,c,s,r])}const Or=l.createContext({...oe,scaleX:1,scaleY:1});var ve;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(ve||(ve={}));const Es=l.memo(function(t){var r,s,a,o;let{id:d,accessibility:c,autoScroll:u=!0,children:f,sensors:b=xs,collisionDetection:h=_n,measuring:v,modifiers:p,...N}=t;const w=l.useReducer(Ns,void 0,ks),[k,E]=w,[_,D]=yn(),[L,A]=l.useState(ve.Uninitialized),O=L===ve.Initialized,{draggable:{active:S,nodes:R,translate:I},droppable:{containers:B}}=k,z=S!=null?R.get(S):null,P=l.useRef({initial:null,translated:null}),Q=l.useMemo(()=>{var q;return S!=null?{id:S,data:(q=z?.data)!=null?q:ms,rect:P}:null},[S,z]),ie=l.useRef(null),[Ge,ee]=l.useState(null),[te,_e]=l.useState(null),g=Ue(N,Object.values(N)),$=ft("DndDescribedBy",d),Me=l.useMemo(()=>B.getEnabled(),[B]),re=Ds(v),{droppableRects:be,measureDroppableContainers:ye,measuringScheduled:Ze}=as(Me,{dragging:O,dependencies:[I.x,I.y],config:re.droppable}),Y=ns(R,S),Qe=l.useMemo(()=>te?Rt(te):null,[te]),et=Kr(),tt=os(Y,re.draggable.measure);Ss({activeNode:S!=null?R.get(S):null,config:et.layoutShiftCompensation,initialRect:tt,measure:re.draggable.measure});const H=ar(Y,re.draggable.measure,tt),Ae=ar(Y?Y.parentElement:null),le=l.useRef({activatorEvent:null,active:null,activeNode:Y,collisionRect:null,collisions:null,droppableRects:be,draggableNodes:R,draggingNode:null,draggingNodeRect:null,droppableContainers:B,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),rt=B.getNodeFor((r=le.current.over)==null?void 0:r.id),i=ps({measure:re.dragOverlay.measure}),m=(s=i.nodeRef.current)!=null?s:Y,x=O?(a=i.rect)!=null?a:H:null,y=!!(i.nodeRef.current&&i.rect),T=cs(y?null:H),j=Tr(m?V(m):null),M=ds(O?rt??Y:null),he=bs(M),K=Cs(p,{transform:{x:I.x-T.x,y:I.y-T.y,scaleX:1,scaleY:1},activatorEvent:te,active:Q,activeNodeRect:H,containerNodeRect:Ae,draggingNodeRect:x,over:le.current.over,overlayNodeRect:i.rect,scrollableAncestors:M,scrollableAncestorRects:he,windowRect:j}),ce=Qe?Se(Qe,I):null,Te=us(M),Lr=ir(Te),Pr=ir(Te,[H]),je=Se(K,Lr),Ce=x?Tn(x,K):null,Oe=Q&&Ce?h({active:Q,collisionRect:Ce,droppableRects:be,droppableContainers:Me,pointerCoordinates:ce}):null,Bt=Nr(Oe,"id"),[ge,Wt]=l.useState(null),zr=y?K:Se(K,Pr),$r=Mn(zr,(o=ge?.rect)!=null?o:null,H),xt=l.useRef(null),Kt=l.useCallback((q,J)=>{let{sensor:G,options:pe}=J;if(ie.current==null)return;const ne=R.get(ie.current);if(!ne)return;const Z=q.nativeEvent,de=new G({active:ie.current,activeNode:ne,event:Z,options:pe,context:le,onAbort(U){if(!R.get(U))return;const{onDragAbort:ue}=g.current,fe={id:U};ue?.(fe),_({type:"onDragAbort",event:fe})},onPending(U,xe,ue,fe){if(!R.get(U))return;const{onDragPending:Le}=g.current,me={id:U,constraint:xe,initialCoordinates:ue,offset:fe};Le?.(me),_({type:"onDragPending",event:me})},onStart(U){const xe=ie.current;if(xe==null)return;const ue=R.get(xe);if(!ue)return;const{onDragStart:fe}=g.current,Ie={activatorEvent:Z,active:{id:xe,data:ue.data,rect:P}};$e.unstable_batchedUpdates(()=>{fe?.(Ie),A(ve.Initializing),E({type:F.DragStart,initialCoordinates:U,active:xe}),_({type:"onDragStart",event:Ie}),ee(xt.current),_e(Z)})},onMove(U){E({type:F.DragMove,coordinates:U})},onEnd:De(F.DragEnd),onCancel:De(F.DragCancel)});xt.current=de;function De(U){return async function(){const{active:ue,collisions:fe,over:Ie,scrollAdjustedTranslate:Le}=le.current;let me=null;if(ue&&Le){const{cancelDrop:Pe}=g.current;me={activatorEvent:Z,active:ue,collisions:fe,delta:Le,over:Ie},U===F.DragEnd&&typeof Pe=="function"&&await Promise.resolve(Pe(me))&&(U=F.DragCancel)}ie.current=null,$e.unstable_batchedUpdates(()=>{E({type:U}),A(ve.Uninitialized),Wt(null),ee(null),_e(null),xt.current=null;const Pe=U===F.DragEnd?"onDragEnd":"onDragCancel";if(me){const mt=g.current[Pe];mt?.(me),_({type:Pe,event:me})}})}}},[R]),Fr=l.useCallback((q,J)=>(G,pe)=>{const ne=G.nativeEvent,Z=R.get(pe);if(ie.current!==null||!Z||ne.dndKit||ne.defaultPrevented)return;const de={active:Z};q(G,J.options,de)===!0&&(ne.dndKit={capturedBy:J.sensor},ie.current=pe,Kt(G,J))},[R,Kt]),Ut=ss(b,Fr);hs(b),we(()=>{H&&L===ve.Initializing&&A(ve.Initialized)},[H,L]),l.useEffect(()=>{const{onDragMove:q}=g.current,{active:J,activatorEvent:G,collisions:pe,over:ne}=le.current;if(!J||!G)return;const Z={active:J,activatorEvent:G,collisions:pe,delta:{x:je.x,y:je.y},over:ne};$e.unstable_batchedUpdates(()=>{q?.(Z),_({type:"onDragMove",event:Z})})},[je.x,je.y]),l.useEffect(()=>{const{active:q,activatorEvent:J,collisions:G,droppableContainers:pe,scrollAdjustedTranslate:ne}=le.current;if(!q||ie.current==null||!J||!ne)return;const{onDragOver:Z}=g.current,de=pe.get(Bt),De=de&&de.rect.current?{id:de.id,rect:de.rect.current,data:de.data,disabled:de.disabled}:null,U={active:q,activatorEvent:J,collisions:G,delta:{x:ne.x,y:ne.y},over:De};$e.unstable_batchedUpdates(()=>{Wt(De),Z?.(U),_({type:"onDragOver",event:U})})},[Bt]),we(()=>{le.current={activatorEvent:te,active:Q,activeNode:Y,collisionRect:Ce,collisions:Oe,droppableRects:be,draggableNodes:R,draggingNode:m,draggingNodeRect:x,droppableContainers:B,over:ge,scrollableAncestors:M,scrollAdjustedTranslate:je},P.current={initial:x,translated:Ce}},[Q,Y,Oe,Ce,R,m,x,be,B,ge,M,je]),es({...et,delta:I,draggingRect:Ce,pointerCoordinates:ce,scrollableAncestors:M,scrollableAncestorRects:he});const Br=l.useMemo(()=>({active:Q,activeNode:Y,activeNodeRect:H,activatorEvent:te,collisions:Oe,containerNodeRect:Ae,dragOverlay:i,draggableNodes:R,droppableContainers:B,droppableRects:be,over:ge,measureDroppableContainers:ye,scrollableAncestors:M,scrollableAncestorRects:he,measuringConfiguration:re,measuringScheduled:Ze,windowRect:j}),[Q,Y,H,te,Oe,Ae,i,R,B,be,ge,ye,M,he,re,Ze,j]),Wr=l.useMemo(()=>({activatorEvent:te,activators:Ut,active:Q,activeNodeRect:H,ariaDescribedById:{draggable:$},dispatch:E,draggableNodes:R,over:ge,measureDroppableContainers:ye}),[te,Ut,Q,H,E,$,R,ge,ye]);return X.createElement(wr.Provider,{value:D},X.createElement(pt.Provider,{value:Wr},X.createElement(ys.Provider,{value:Br},X.createElement(Or.Provider,{value:$r},f)),X.createElement(js,{disabled:c?.restoreFocus===!1})),X.createElement(jn,{...c,hiddenTextDescribedById:$}));function Kr(){const q=Ge?.autoScrollEnabled===!1,J=typeof u=="object"?u.enabled===!1:u===!1,G=O&&!q&&!J;return typeof u=="object"?{...u,enabled:G}:{enabled:G}}}),Rs=l.createContext(null),cr="button",_s="Draggable";function Ms(e){let{id:t,data:r,disabled:s=!1,attributes:a}=e;const o=ft(_s),{activators:d,activatorEvent:c,active:u,activeNodeRect:f,ariaDescribedById:b,draggableNodes:h,over:v}=l.useContext(pt),{role:p=cr,roleDescription:N="draggable",tabIndex:w=0}=a??{},k=u?.id===t,E=l.useContext(k?Or:Rs),[_,D]=it(),[L,A]=it(),O=fs(d,t),S=Ue(r);we(()=>(h.set(t,{id:t,key:o,node:_,activatorNode:L,data:S}),()=>{const I=h.get(t);I&&I.key===o&&h.delete(t)}),[h,t]);const R=l.useMemo(()=>({role:p,tabIndex:w,"aria-disabled":s,"aria-pressed":k&&p===cr?!0:void 0,"aria-roledescription":N,"aria-describedby":b.draggable}),[s,p,w,k,N,b.draggable]);return{active:u,activatorEvent:c,activeNodeRect:f,attributes:R,isDragging:k,listeners:s?void 0:O,node:_,over:v,setNodeRef:D,setActivatorNodeRef:A,transform:E}}const As="Droppable",Ts={timeout:25};function Os(e){let{data:t,disabled:r=!1,id:s,resizeObserverConfig:a}=e;const o=ft(As),{active:d,dispatch:c,over:u,measureDroppableContainers:f}=l.useContext(pt),b=l.useRef({disabled:r}),h=l.useRef(!1),v=l.useRef(null),p=l.useRef(null),{disabled:N,updateMeasurementsFor:w,timeout:k}={...Ts,...a},E=Ue(w??s),_=l.useCallback(()=>{if(!h.current){h.current=!0;return}p.current!=null&&clearTimeout(p.current),p.current=setTimeout(()=>{f(Array.isArray(E.current)?E.current:[E.current]),p.current=null},k)},[k]),D=gt({callback:_,disabled:N||!d}),L=l.useCallback((R,I)=>{D&&(I&&(D.unobserve(I),h.current=!1),R&&D.observe(R))},[D]),[A,O]=it(L),S=Ue(t);return l.useEffect(()=>{!D||!A.current||(D.disconnect(),h.current=!1,D.observe(A.current))},[A,D]),l.useEffect(()=>(c({type:F.RegisterDroppable,element:{id:s,key:o,disabled:r,node:A,rect:v,data:S}}),()=>c({type:F.UnregisterDroppable,key:o,id:s})),[s]),l.useEffect(()=>{r!==b.current.disabled&&(c({type:F.SetDroppableDisabled,id:s,key:o,disabled:r}),b.current.disabled=r)},[s,o,r,c]),{active:d,rect:v,isOver:u?.id===s,node:A,over:u,setNodeRef:O}}function dr(e,t,r){const s=e.slice();return s.splice(r<0?s.length+r:r,0,s.splice(t,1)[0]),s}function dt(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const Is=[C.Down,C.Right,C.Up,C.Left],Ls=(e,t)=>{let{context:{active:r,collisionRect:s,droppableRects:a,droppableContainers:o,over:d,scrollableAncestors:c}}=t;if(Is.includes(e.code)){if(e.preventDefault(),!r||!s)return;const u=[];o.getEnabled().forEach(h=>{if(!h||h!=null&&h.disabled)return;const v=a.get(h.id);if(v)switch(e.code){case C.Down:s.top<v.top&&u.push(h);break;case C.Up:s.top>v.top&&u.push(h);break;case C.Left:s.left>v.left&&u.push(h);break;case C.Right:s.left<v.left&&u.push(h);break}});const f=En({collisionRect:s,droppableRects:a,droppableContainers:u});let b=Nr(f,"id");if(b===d?.id&&f.length>1&&(b=f[1].id),b!=null){const h=o.get(r.id),v=o.get(b),p=v?a.get(v.id):null,N=v?.node.current;if(N&&p&&h&&v){const k=bt(N).some((O,S)=>c[S]!==O),E=Ir(h,v),_=Ps(h,v),D=k||!E?{x:0,y:0}:{x:_?s.width-p.width:0,y:_?s.height-p.height:0},L={x:p.left,y:p.top};return D.x&&D.y?L:qe(L,D)}}}};function Ir(e,t){return!dt(e)||!dt(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function Ps(e,t){return!dt(e)||!dt(t)||!Ir(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const zs={blue:"text-blue-600 bg-blue-50 dark:bg-blue-900/20 dark:text-blue-400",emerald:"text-emerald-600 bg-emerald-50 dark:bg-emerald-900/20 dark:text-emerald-400",rose:"text-rose-600 bg-rose-50 dark:bg-rose-900/20 dark:text-rose-400",amber:"text-amber-600 bg-amber-50 dark:bg-amber-900/20 dark:text-amber-400",indigo:"text-indigo-600 bg-indigo-50 dark:bg-indigo-900/20 dark:text-indigo-400",slate:"text-slate-600 bg-slate-50 dark:bg-slate-900/20 dark:text-slate-400"},Je=({title:e,icon:t,iconColor:r="blue",children:s,onRemove:a,onClick:o,targetView:d,footerLeft:c,footerRight:u,className:f,backgroundIcon:b})=>{const{t:h}=Ne(),v=ut(),p=c||u||d,N=c||(d&&!u?n.jsxs("button",{onClick:w=>{w.stopPropagation(),v(d)},className:"flex items-center gap-1.5 text-[10px] font-black text-slate-400 hover:text-blue-600 uppercase tracking-widest transition-colors group/footer",children:[h("common.open_details"),n.jsx(Hr,{className:"w-3 h-3 transition-transform group-hover/footer:translate-x-0.5"})]}):null);return n.jsxs("div",{className:qt("group relative flex flex-col bg-white dark:bg-slate-800 rounded-xl border border-slate-300 dark:border-slate-700/50 shadow-sm hover:shadow-xl hover:shadow-slate-200/50 dark:hover:shadow-none transition-all duration-500 overflow-hidden h-full",o&&"cursor-pointer active:scale-[0.98]",f),children:[b&&n.jsx("div",{className:"absolute -right-8 -bottom-8 text-slate-50/50 dark:text-slate-900/20 group-hover:text-slate-100/50 dark:group-hover:text-slate-900/40 transition-colors duration-500",children:n.jsx(b,{size:160,strokeWidth:1})}),n.jsxs("div",{className:"relative flex items-center justify-between pt-2.5 pb-2.5 px-5 bg-slate-50/50 dark:bg-slate-900/20 border-b border-slate-200 dark:border-slate-800/50",children:[n.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[n.jsx("div",{className:qt("p-1.5 rounded-xl shrink-0 shadow-sm",zs[r]),children:n.jsx(t,{className:"w-4 h-4"})}),n.jsxs("div",{className:"min-w-0",children:[n.jsx("h3",{className:"text-xs font-bold leading-snug text-slate-800 dark:text-white truncate tracking-tight",children:e}),n.jsx("div",{className:"h-0.5 w-4 bg-slate-200 dark:bg-slate-700 rounded-full mt-0.5 group-hover:w-8 transition-all duration-500"})]})]}),n.jsx("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-all duration-300 translate-x-2 group-hover:translate-x-0",children:a&&n.jsx("button",{onClick:w=>{w.stopPropagation(),a()},className:"p-1 text-slate-400 hover:text-rose-600 hover:bg-rose-50 dark:hover:bg-rose-900/20 rounded-lg transition-colors",title:h("common.remove"),children:n.jsx(br,{className:"w-3.5 h-3.5"})})})]}),n.jsx("div",{className:"relative flex-1 p-4 px-5 pt-2 min-h-0",onClick:o,children:s}),p&&n.jsxs("div",{className:"relative p-3 px-5 border-t border-slate-200 dark:border-slate-800/50 bg-slate-50/50 dark:bg-slate-900/30 flex items-center justify-between min-h-[40px]",children:[n.jsx("div",{className:"flex-1 min-w-0",children:N}),n.jsx("div",{className:"shrink-0",children:u})]}),n.jsx("div",{className:"absolute inset-0 pointer-events-none border border-transparent group-hover:border-blue-500/10 dark:group-hover:border-blue-400/10 rounded-xl transition-colors"})]})},$s=({onRemove:e,dragHandleProps:t,onClick:r,targetView:s})=>{const{t:a,i18n:o}=Ne(),[d,c]=l.useState(new Date);l.useEffect(()=>{const h=setInterval(()=>c(new Date),1e3);return()=>clearInterval(h)},[]);const u=l.useMemo(()=>new Intl.DateTimeFormat(o.language==="de"?"de-DE":"en-US",{weekday:"long",day:"2-digit",month:"long"}).format(d),[d,o.language]),f=d.toLocaleTimeString(o.language==="de"?"de-DE":"en-US",{hour:"2-digit",minute:"2-digit"});return n.jsx(Je,{title:a("widgets.clock.title"),icon:St,iconColor:"indigo",onRemove:e,dragHandleProps:t,onClick:r,targetView:s,backgroundIcon:St,children:n.jsx("div",{className:"flex flex-col h-full items-center justify-center -mt-2",children:n.jsxs("div",{className:"text-center group-hover:scale-110 transition-transform duration-700",children:[n.jsxs("div",{className:"flex items-baseline justify-center gap-1.5",children:[n.jsx("span",{className:"text-6xl font-black text-slate-900 dark:text-white tracking-tighter tabular-nums leading-none",children:f}),n.jsx("span",{className:"text-xs font-black text-indigo-500/80 dark:text-indigo-400/80 uppercase tracking-widest tabular-nums",children:"CET"})]}),n.jsxs("div",{className:"mt-4 flex flex-col items-center",children:[n.jsx("div",{className:"h-px w-8 bg-slate-100 dark:bg-slate-800 mb-4"}),n.jsxs("div",{className:"flex items-center gap-2 px-4 py-1.5 bg-slate-50 dark:bg-slate-900/40 rounded-2xl border border-slate-100 dark:border-slate-800/50",children:[n.jsx(Jr,{className:"w-3.5 h-3.5 text-slate-400 flex-shrink-0"}),n.jsx("span",{className:"text-xs font-bold text-slate-600 dark:text-slate-300 tracking-tight whitespace-nowrap",children:u})]})]})]})})})},Fs=({className:e=""})=>n.jsx("div",{className:`animate-shimmer bg-slate-100 dark:bg-slate-800 rounded ${e}`}),Bs=({onRemove:e,dragHandleProps:t,onClick:r,targetView:s})=>{const{t:a}=Ne(),o=ut(),{data:d,loading:c,error:u}=hr(()=>ae.getDatabaseStats(),[],{cacheKey:"db-stats-tile",ttl:600*1e3});if(u)return n.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-red-200 dark:border-red-900/50 p-4 h-full flex items-center justify-center text-center",children:n.jsx("p",{className:"text-red-500 font-bold text-[10px] uppercase",children:a("common.error")})});const f=()=>{r&&r(),o("/inspector")};return n.jsx(Je,{title:a("widgets.data_inspector.title"),icon:nt,iconColor:"indigo",onClick:r||f,onRemove:e,targetView:s,dragHandleProps:t,backgroundIcon:nt,className:"cursor-pointer",footerLeft:n.jsxs("button",{onClick:b=>{b.stopPropagation(),o("/inspector")},className:"flex items-center gap-1.5 text-[10px] font-black text-slate-400 hover:text-indigo-600 uppercase tracking-widest transition-colors group/footer",children:[a("widgets.data_inspector.details"),n.jsx(nt,{className:"w-3 h-3 transition-transform group-hover/footer:scale-110"})]}),children:n.jsxs("div",{className:"flex flex-col h-full items-center justify-around py-2",children:[n.jsxs("div",{className:"text-center group-hover:scale-105 transition-transform duration-500",children:[n.jsxs("div",{className:"flex items-center justify-center gap-1.5 text-[10px] font-black text-indigo-600 dark:text-indigo-400 uppercase tracking-widest mb-1",children:[n.jsx(Gr,{className:"w-3 h-3"}),n.jsx("span",{children:a("widgets.data_inspector.records_total")})]}),n.jsx("div",{className:"text-4xl font-black text-slate-900 dark:text-white tracking-tighter tabular-nums leading-none",children:c||!d?n.jsx(Fs,{className:"h-8 w-20 mx-auto"}):d.records.toLocaleString()})]}),n.jsxs("div",{className:"w-full pt-4 border-t border-slate-200 dark:border-slate-800/50 text-center",children:[n.jsxs("div",{className:"flex items-center justify-center gap-1.5 text-[10px] font-black text-indigo-500 dark:text-indigo-400 uppercase tracking-widest mb-1",children:[n.jsx(Fe,{className:"w-3 h-3"}),n.jsx("span",{children:a("widgets.data_inspector.tables")})]}),n.jsx("div",{className:"text-2xl font-black text-slate-700 dark:text-slate-300 tabular-nums leading-none",children:c||!d?"...":d.tables})]})]})})},Ws=({onRemove:e,dragHandleProps:t,onClick:r,targetView:s})=>{const{t:a}=Ne(),[o,d]=l.useState(!1),[c,u]=l.useState(null),[f,b]=l.useState(null);X.useEffect(()=>{const v=performance.getEntriesByType("navigation")[0];v&&b(Math.round(v.duration));const p=()=>{const w=performance;if(w.memory){const k=w.memory;u({used:Math.round(k.usedJSHeapSize/1024/1024),total:Math.round(k.jsHeapSizeLimit/1024/1024)})}};p();const N=setInterval(p,5e3);return()=>clearInterval(N)},[]);const h=()=>{d(!0),r&&r()};return n.jsxs(n.Fragment,{children:[n.jsx(Je,{title:a("widgets.system_status.title"),icon:st,iconColor:"emerald",onRemove:e,dragHandleProps:t,onClick:h,targetView:s,backgroundIcon:st,className:"cursor-pointer",footerLeft:n.jsxs("button",{onClick:v=>{v.stopPropagation(),d(!0)},className:"flex items-center gap-1.5 text-[10px] font-black text-slate-400 hover:text-blue-600 uppercase tracking-widest transition-colors group/footer",children:[a("widgets.system_status.details"),n.jsx(st,{className:"w-3 h-3 transition-transform group-hover/footer:scale-110"})]}),children:n.jsxs("div",{className:"flex flex-col h-full items-center justify-around py-2",children:[n.jsxs("div",{className:"text-center group-hover:scale-105 transition-transform duration-500",children:[n.jsxs("div",{className:"flex items-center justify-center gap-1.5 text-[10px] font-black text-emerald-600 dark:text-emerald-400 uppercase tracking-widest mb-1",children:[n.jsx(Zr,{className:"w-3 h-3"}),n.jsx("span",{children:a("widgets.system_status.memory_usage")})]}),n.jsx("div",{className:"text-4xl font-black text-slate-900 dark:text-white tracking-tighter tabular-nums leading-none",children:c?`${c.used} MB`:"---"}),n.jsx("div",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-tighter mt-1",children:a("widgets.system_status.heap_from",{total:c?c.total:"---"})})]}),n.jsxs("div",{className:"w-full pt-4 border-t border-slate-200 dark:border-slate-800/50 text-center",children:[n.jsxs("div",{className:"flex items-center justify-center gap-1.5 text-[10px] font-black text-blue-500 dark:text-blue-400 uppercase tracking-widest mb-1",children:[n.jsx(Qr,{className:"w-3 h-3"}),n.jsx("span",{children:a("widgets.system_status.load_time")})]}),n.jsx("div",{className:"text-2xl font-black text-slate-700 dark:text-slate-300 tabular-nums leading-none",children:f?`${f} ms`:"---"})]})]})}),n.jsx(Ur,{isOpen:o,onClose:()=>d(!1)})]})},Ks=({onRemove:e,dragHandleProps:t,onClick:r,targetView:s,isOverlay:a})=>{const{t:o,i18n:d}=Ne(),c=ut(),{lastBackup:u,changeCount:f,isBackupRecommended:b}=un(),h=p=>p?p.toLocaleString(d.language==="de"?"de-DE":"en-US",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):o("widgets.database_status.never"),v=p=>{p.stopPropagation(),c("/datasource")};return n.jsx(Je,{title:o("widgets.database_status.title"),icon:Fe,iconColor:b?"amber":"emerald",onRemove:e,dragHandleProps:t,onClick:r,targetView:s,backgroundIcon:Fe,className:a?"opacity-90":"",footerLeft:n.jsxs("button",{onClick:v,className:"flex items-center gap-1.5 text-[10px] font-black text-slate-400 hover:text-blue-600 uppercase tracking-widest transition-colors group/footer",children:[o("widgets.database_status.data_management"),n.jsx(pr,{className:"w-3 h-3 transition-transform group-hover/footer:rotate-90"})]}),children:n.jsxs("div",{className:"flex flex-col h-full items-center justify-around py-2",children:[n.jsxs("div",{className:"text-center",children:[n.jsxs("div",{className:"flex items-center justify-center gap-1.5 text-[10px] font-black text-slate-500 dark:text-slate-400 uppercase tracking-widest mb-1",children:[n.jsx(en,{className:"w-3 h-3"}),n.jsx("span",{children:o("widgets.database_status.last_backup")})]}),n.jsx("div",{className:"text-xl font-black text-slate-900 dark:text-white tracking-tight tabular-nums leading-none",children:h(u)})]}),n.jsxs("div",{className:"w-full pt-4 border-t border-slate-100 dark:border-slate-800/50 text-center",children:[n.jsxs("div",{className:`flex items-center justify-center gap-1.5 text-[10px] font-black uppercase tracking-widest mb-1 ${b?"text-amber-600 dark:text-amber-400":"text-emerald-600 dark:text-emerald-400"}`,children:[b?n.jsx(gr,{className:"w-3 h-3"}):n.jsx(Fe,{className:"w-3 h-3"}),n.jsx("span",{children:o("widgets.database_status.modifications")})]}),n.jsx("div",{className:`text-4xl font-black tabular-nums leading-none tracking-tighter ${b?"text-amber-600 dark:text-amber-400":"text-slate-900 dark:text-white"}`,children:f}),n.jsx("div",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-tighter mt-1",children:o("widgets.database_status.records_since_backup")})]})]})})},Us=fr("WorklistComponent"),qs=({onRemove:e,dragHandleProps:t,onClick:r,targetView:s,isOverlay:a})=>{const{t:o}=Ne(),d=ut(),[c,u]=l.useState({total:0,pending:0}),[f,b]=l.useState(!0),h=async()=>{try{const p=await ae.getWorklist(),N=p.length,w=p.filter(k=>k.status==="pending"||!k.status).length;u({total:N,pending:w})}catch(p){Us.error("Failed to load worklist stats",p)}finally{b(!1)}};l.useEffect(()=>(h(),window.addEventListener("db-updated",h),window.addEventListener("db-changed",h),()=>{window.removeEventListener("db-updated",h),window.removeEventListener("db-changed",h)}),[]);const v=p=>{p.stopPropagation(),d("/worklist")};return n.jsx(Je,{title:o("widgets.worklist.title"),icon:at,iconColor:c.pending>0?"amber":"emerald",onRemove:e,dragHandleProps:t,onClick:r,targetView:s,backgroundIcon:at,className:a?"opacity-90":"",footerLeft:n.jsxs("button",{onClick:v,className:"flex items-center gap-1.5 text-[10px] font-black text-slate-400 hover:text-blue-600 uppercase tracking-widest transition-colors group/footer",children:[o("widgets.worklist.open_list"),n.jsx(rn,{className:"w-3 h-3 transition-transform group-hover/footer:translate-x-1"})]}),children:n.jsxs("div",{className:"flex flex-col h-full items-center justify-around py-2",children:[n.jsxs("div",{className:"text-center",children:[n.jsxs("div",{className:`flex items-center justify-center gap-1.5 text-[10px] font-black uppercase tracking-widest mb-1 ${c.pending>0?"text-amber-600 dark:text-amber-400":"text-emerald-600 dark:text-emerald-400"}`,children:[c.pending>0?n.jsx(gr,{className:"w-3 h-3"}):n.jsx(tn,{className:"w-3 h-3"}),n.jsx("span",{children:c.pending>0?o("widgets.worklist.open_tasks"):o("widgets.worklist.all_done")})]}),n.jsx("div",{className:`text-4xl font-black tracking-tighter tabular-nums leading-none ${c.pending>0?"text-amber-600 dark:text-amber-400":"text-slate-900 dark:text-white"}`,children:f?"---":c.pending})]}),n.jsxs("div",{className:"w-full pt-4 border-t border-slate-100 dark:border-slate-800/50 text-center",children:[n.jsxs("div",{className:"flex items-center justify-center gap-1.5 text-[10px] font-black text-slate-500 dark:text-slate-400 uppercase tracking-widest mb-1",children:[n.jsx(at,{className:"w-3 h-3"}),n.jsx("span",{children:o("widgets.worklist.total_entries")})]}),n.jsx("div",{className:"text-xl font-black text-slate-700 dark:text-slate-300 tabular-nums leading-none",children:f?"---":c.total})]})]})})},Ys={ClockComponent:$s,DataInspectorComponent:Bs,SystemStatusComponent:Ws,DatabaseStatusComponent:Ks,WorklistComponent:qs},Dt=[{id:"SystemStatusComponent",titleKey:"widgets.system_status.title",descriptionKey:"widgets.system_status.description",icon:st,defaultColSpan:1},{id:"DataInspectorComponent",titleKey:"widgets.data_inspector.title",descriptionKey:"widgets.data_inspector.description",icon:nt,defaultColSpan:1},{id:"DatabaseStatusComponent",titleKey:"widgets.database_status.title",descriptionKey:"widgets.database_status.description",icon:nn,defaultColSpan:1},{id:"ClockComponent",titleKey:"widgets.clock.title",descriptionKey:"widgets.clock.description",icon:St,defaultColSpan:1},{id:"WorklistComponent",titleKey:"widgets.worklist.title",descriptionKey:"widgets.worklist.description",icon:at,defaultColSpan:1}],Xs=e=>Ys[e]||null,Vs=fr("CustomDashboardView"),Hs="litebi:app-ready",ur=({id:e,className:t,children:r})=>{const{attributes:s,listeners:a,setNodeRef:o,transform:d,isDragging:c}=Ms({id:e}),{setNodeRef:u,isOver:f}=Os({id:e}),b=h=>{o(h),u(h)};return n.jsx("div",{ref:b,style:{transform:_t.Translate.toString(d)},className:`${t||""} ${c?"opacity-50 z-10":""} ${f&&!c?"ring-2 ring-blue-300 rounded-xl":""}`,...s,...a,children:r})},da=()=>{const{t:e}=Ne(),[t,r]=l.useState([]),[s,a]=l.useState(null),[o,d]=l.useState(!1),[c,u]=l.useState(!1),[f,b]=l.useState(!1),[h,v]=l.useState("system"),[p,N]=l.useState(""),[w,k]=l.useState(!1),[E,_]=l.useState(!1),[D,L]=Yt("dashboard_tools_open",!1),[A,O]=Yt("dashboard_tools_tab_v1","layout"),[S,R]=l.useState([]),{visibleSidebarComponentIds:I,setVisibleSidebarComponentIds:B,togglePresentationMode:z,isReadOnly:P}=qr(),{isExporting:Q,exportToPdf:ie}=Xr(),Ge=Cn(Gt(Ft,{activationConstraint:{distance:8}}),Gt(zt,{coordinateGetter:Ls})),{data:ee,refresh:te}=hr(async()=>await ae.executeRaw("SELECT * FROM sys_user_widgets ORDER BY created_at DESC"),[]),_e=X.useRef(!1);l.useEffect(()=>{(async()=>{if(_e.current)return;_e.current=!0;let x=await ae.getDashboards();const y=localStorage.getItem("custom_dashboard_layout");if(x.length===0){const K={id:crypto.randomUUID(),name:e("dashboard.default_name"),layout:y?JSON.parse(y):[],is_default:!0};await ae.saveDashboard(K,!0),y&&localStorage.removeItem("custom_dashboard_layout"),x=[K]}else x.length>0&&(x=x.map(K=>({...K,layout:typeof K.layout=="string"?JSON.parse(K.layout):K.layout})));r(x);const T=window.location.hash||"#/",j=T.includes("?")?T.slice(T.indexOf("?")+1):"",M=j?new URLSearchParams(j).get("dashboard"):null,he=M&&x.some(K=>K.id===M)?M:x[0]?.id??null;a(he),d(!0),window.__LITEBI_READY__=!0,window.dispatchEvent(new Event(Hs))})()},[e]);const g=t.find(i=>i.id===s);l.useEffect(()=>{if(!g||!ee)return;(async()=>{const m=g.layout.map(j=>j.id),x=ee.filter(j=>m.includes(j.id)),y=new Set;x.forEach(j=>{const M=j.sql_query.match(/FROM\s+([a-zA-Z0-9_]+)/i);M&&y.add(M[1])});const T=new Set;for(const j of Array.from(y))try{const M=await ae.getTableSchema(j);M&&Array.isArray(M)&&M.forEach(he=>T.add(he.name))}catch(M){Vs.error("Error fetching schema for table",j,M)}R(Array.from(T).sort())})()},[g,ee]);const $=async i=>{await ae.saveDashboard(i),r(m=>m.map(x=>x.id===i.id?i:x))},Me=async(i,m)=>{if(!g||g.layout.find(y=>y.id===i))return;const x={...g,layout:[...g.layout,{id:i,type:m}]};await $(x),u(!1)},re=async i=>{if(!g)return;const m={...g,layout:g.layout.filter(x=>x.id!==i)};await $(m)},be=async i=>{if(P||!g)return;const{active:m,over:x}=i;if(!x||m.id===x.id)return;const y=g.layout.findIndex(M=>M.id===String(m.id)),T=g.layout.findIndex(M=>M.id===String(x.id));if(y<0||T<0)return;const j=dr(g.layout,y,T);await $({...g,layout:j})},ye=async(i,m)=>{if(!g)return;const x=g.layout.findIndex(j=>j.id===i);if(x<0)return;const y=x+m;if(y<0||y>=g.layout.length)return;const T=dr(g.layout,x,y);await $({...g,layout:T})},Ze=async(i="")=>{g&&await $({...g,filters:[...g.filters||[],{column:i,operator:"=",value:""}]})},Y=async(i,m)=>{if(!g)return;const x=[...g.filters||[]];x[i]={...x[i],...m},await $({...g,filters:x})},Qe=async i=>{g&&await $({...g,filters:(g.filters||[]).filter((m,x)=>x!==i)})},et=async()=>{g&&await $({...g,filters:[]})},tt=i=>{if(i.type==="system"){const m=Dt.find(x=>x.id===i.id);return m?e(m.titleKey):i.id}return ee?.find(m=>m.id===i.id)?.name||i.id},H=async i=>{await ze.confirm(e("dashboard.confirm_delete_report"))&&(await ae.deleteUserWidget(i),te(),re(i))},Ae=async i=>{const m=(i.name||"").trim(),x=(()=>{if(typeof i.visualization_config!="string")return null;try{return JSON.parse(i.visualization_config)}catch{return null}})(),y=(i.description||"").trim()||(x?.widgetDescription||"").trim(),T=await ze.prompt2(e("dashboard.rename_report_name_label","Name des Berichts"),e("common.description","Description"),{title:e("dashboard.rename_report_title","Bericht umbenennen"),defaultValue:m,secondDefaultValue:y,secondPlaceholder:e("querybuilder.widget_description_placeholder","Kurze Einordnung oder Kontext (optional)")});if(!T)return;const j=T.value.trim(),M=T.secondValue.trim();if(!j||j===m||(ee||[]).find(ce=>ce.id!==i.id&&(ce.name||"").trim().toLowerCase()===j.toLowerCase())&&!await ze.confirm(e("dashboard.rename_report_conflict_confirm",'Ein Bericht mit dem Namen "{{name}}" existiert bereits. Trotzdem umbenennen?',{name:j})))return;const K=(ce,Te)=>{if(typeof ce!="string")return ce??Te;try{return JSON.parse(ce)}catch{return Te}};await ae.saveUserWidget({id:i.id,name:j,description:M,sql_statement_id:i.sql_statement_id||null,sql_query:i.sql_query||"",visualization_config:K(i.visualization_config,{}),visual_builder_config:K(i.visual_builder_config,null)}),te()},le=async()=>{if(!p.trim())return;const i={id:crypto.randomUUID(),name:p,layout:[],is_default:!1};await ae.saveDashboard(i),r([...t,i]),a(i.id),N(""),k(!1)},rt=async i=>{if(t.length<=1||!await ze.confirm(e("dashboard.delete_confirm")))return;await ae.deleteDashboard(i);const m=t.filter(x=>x.id!==i);r(m),s===i&&a(m[0].id)};return o?n.jsxs(Yr,{header:{title:e("dashboard.title"),subtitle:e("dashboard.subtitle"),actions:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:z,className:"p-2 text-slate-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors border border-transparent hover:border-blue-100 dark:hover:border-blue-800/40",title:e("dashboard.presentation_mode"),children:n.jsx(cn,{className:"w-5 h-5"})}),n.jsxs("button",{onClick:()=>ie("dashboard-grid",`dashboard-${g?.name||"export"}`),disabled:Q,className:"flex items-center gap-2 px-3 py-2 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-300 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors shadow-sm font-medium text-sm disabled:opacity-50",children:[n.jsx(dn,{className:"w-4 h-4"}),e(Q?"common.exporting":"common.export_pdf")]}),n.jsx("button",{onClick:()=>_(!E),className:`p-2 rounded-lg transition-colors border ${E?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800 text-blue-600 dark:text-blue-300":"text-slate-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border-transparent hover:border-blue-100 dark:hover:border-blue-800/40"}`,title:e("querybuilder.filter"),children:n.jsx(vt,{className:"w-5 h-5"})}),!P&&n.jsxs("button",{onClick:()=>u(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm font-medium text-sm",children:[n.jsx(wt,{className:"w-4 h-4"}),e("dashboard.add_title")]})]})},rightPanel:{title:e("dashboard.tools_title","Dashboard Tools"),enabled:!!g,triggerTitle:e("dashboard.tools_title","Dashboard Tools"),width:"sm",isOpen:D,onOpenChange:L,content:n.jsxs("div",{className:"h-full min-h-0 flex flex-col gap-4",children:[n.jsxs("div",{className:"inline-flex items-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 p-1 flex-shrink-0",children:[n.jsx("button",{type:"button",onClick:()=>O("layout"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${A==="layout"?"bg-blue-600 text-white":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:e("dashboard.tools_tab_layout","Layout")}),n.jsx("button",{type:"button",onClick:()=>O("filters"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${A==="filters"?"bg-blue-600 text-white":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:e("dashboard.tools_tab_filters","Filters")})]}),g?A==="layout"?n.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-2",children:[n.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:e("dashboard.tools_layout_hint","Reorder widgets and remove items without leaving the dashboard.")}),n.jsx("div",{className:"flex-1 min-h-0 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg divide-y divide-slate-100 dark:divide-slate-700",children:g.layout.length===0?n.jsx("div",{className:"p-3 text-xs text-slate-400 dark:text-slate-500",children:e("dashboard.no_reports")}):g.layout.map((i,m)=>n.jsxs("div",{className:"p-3 flex items-center justify-between gap-2",children:[n.jsxs("div",{className:"min-w-0",children:[n.jsx("div",{className:"text-xs font-semibold text-slate-700 dark:text-slate-200 truncate",children:tt(i)}),n.jsx("div",{className:"text-[10px] text-slate-400 dark:text-slate-500 uppercase",children:i.type})]}),!P&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{type:"button",onClick:()=>{ye(i.id,-1)},disabled:m===0,className:"h-7 w-7 inline-flex items-center justify-center rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300 disabled:opacity-40",title:e("dashboard.tools_move_up","Move up"),children:n.jsx(on,{className:"w-3.5 h-3.5"})}),n.jsx("button",{type:"button",onClick:()=>{ye(i.id,1)},disabled:m===g.layout.length-1,className:"h-7 w-7 inline-flex items-center justify-center rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300 disabled:opacity-40",title:e("dashboard.tools_move_down","Move down"),children:n.jsx(ln,{className:"w-3.5 h-3.5"})}),n.jsx("button",{type:"button",onClick:()=>{re(i.id)},className:"h-7 w-7 inline-flex items-center justify-center rounded border border-rose-200 dark:border-rose-800 bg-rose-50 dark:bg-rose-900/20 hover:bg-rose-100 dark:hover:bg-rose-900/30 text-rose-700 dark:text-rose-300",title:e("common.remove"),children:n.jsx(ke,{className:"w-3.5 h-3.5"})})]})]},`${i.type}:${i.id}`))})]}):n.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-2",children:[n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:e("dashboard.tools_filters_hint","Manage global dashboard filters in one place.")}),!P&&n.jsx("button",{type:"button",onClick:()=>{Ze("")},className:"h-7 px-2 rounded border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/30 text-blue-700 dark:text-blue-300 text-[11px] font-semibold",children:e("dashboard.add_filter")})]}),!P&&n.jsx("div",{className:"flex items-center justify-end",children:n.jsx("button",{type:"button",onClick:()=>{et()},className:"text-[11px] text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200",children:e("dashboard.tools_clear_filters","Clear filters")})}),n.jsx("div",{className:"flex-1 min-h-0 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg divide-y divide-slate-100 dark:divide-slate-700",children:(g.filters||[]).length===0?n.jsx("div",{className:"p-3 text-xs text-slate-400 dark:text-slate-500",children:e("dashboard.no_filters")}):(g.filters||[]).map((i,m)=>n.jsxs("div",{className:"p-3 space-y-2",children:[n.jsx("input",{list:"suggested-columns",value:i.column,onChange:x=>{Y(m,{column:x.target.value})},placeholder:e("dashboard.filter_column"),className:"w-full h-8 px-2 border border-slate-200 dark:border-slate-700 rounded bg-white dark:bg-slate-900 text-xs text-slate-700 dark:text-slate-200 outline-none"}),n.jsxs("div",{className:"grid grid-cols-[1fr_1fr_auto] gap-2",children:[n.jsxs("select",{value:i.operator,onChange:x=>{Y(m,{operator:x.target.value})},className:"h-8 px-2 border border-slate-200 dark:border-slate-700 rounded bg-white dark:bg-slate-900 text-xs text-slate-700 dark:text-slate-200 outline-none",children:[n.jsx("option",{value:"=",children:"="}),n.jsx("option",{value:"!=",children:"!="}),n.jsx("option",{value:">",children:">"}),n.jsx("option",{value:"<",children:"<"}),n.jsx("option",{value:"contains",children:e("dashboard.op_contains")}),n.jsx("option",{value:"is null",children:e("dashboard.op_is_null")})]}),n.jsx("input",{value:i.value,onChange:x=>{Y(m,{value:x.target.value})},placeholder:e("dashboard.filter_value"),className:"h-8 px-2 border border-slate-200 dark:border-slate-700 rounded bg-white dark:bg-slate-900 text-xs text-slate-700 dark:text-slate-200 outline-none"}),!P&&n.jsx("button",{type:"button",onClick:()=>{Qe(m)},className:"h-8 w-8 inline-flex items-center justify-center rounded border border-rose-200 dark:border-rose-800 bg-rose-50 dark:bg-rose-900/20 hover:bg-rose-100 dark:hover:bg-rose-900/30 text-rose-700 dark:text-rose-300",title:e("common.remove"),children:n.jsx(ke,{className:"w-3.5 h-3.5"})})]})]},m))})]}):n.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:e("common.no_data")})]})},children:[E&&g&&n.jsxs("div",{className:"mb-6 p-4 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl shadow-sm animate-in slide-in-from-top-2 duration-300",children:[n.jsx("datalist",{id:"suggested-columns",children:S.map(i=>n.jsx("option",{value:i},i))}),n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex flex-col gap-1",children:[n.jsxs("h4",{className:"text-xs font-black uppercase text-slate-400 flex items-center gap-2",children:[n.jsx(vt,{className:"w-3.5 h-3.5 text-blue-500"})," ",e("dashboard.filters_title")]}),n.jsx("p",{className:"text-[10px] text-slate-400",children:e("dashboard.filters_subtitle","Slicers that affect all dashboard charts simultaneously.")})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[S.filter(i=>["Year","FiscalYear","Date","Month","Category","Group","Type","Status"].some(m=>i.toLowerCase().includes(m.toLowerCase()))).slice(0,3).map(i=>n.jsxs("button",{onClick:()=>$({...g,filters:[...g.filters||[],{column:i,operator:"=",value:""}]}),className:"px-2 py-1 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded text-[10px] font-bold text-slate-500 hover:text-blue-600 transition-colors",children:["+ ",i]},i)),n.jsx("button",{onClick:()=>$({...g,filters:[...g.filters||[],{column:"",operator:"=",value:""}]}),className:"px-3 py-1 bg-blue-600 text-white rounded text-[10px] font-bold shadow-sm shadow-blue-100 hover:bg-blue-700 transition-colors",children:e("dashboard.add_filter")})]})]}),n.jsxs("div",{className:"space-y-2",children:[(g.filters||[]).map((i,m)=>n.jsxs("div",{className:"flex items-center gap-2 group animate-in slide-in-from-left-2 duration-200",style:{animationDelay:`${m*50}ms`},children:[n.jsxs("div",{className:"flex-1 grid grid-cols-12 gap-2 p-1 bg-slate-50 dark:bg-slate-800/50 border border-slate-100 dark:border-slate-800 rounded-lg group-hover:border-slate-200 group-hover:bg-white dark:group-hover:bg-slate-800 transition-all",children:[n.jsx("input",{placeholder:e("dashboard.filter_column"),list:"suggested-columns",className:"col-span-4 p-1.5 text-[11px] bg-transparent outline-none font-bold text-slate-700 dark:text-slate-200",value:i.column,onChange:x=>{const y=[...g.filters||[]];y[m].column=x.target.value,$({...g,filters:y})}}),n.jsxs("select",{className:"col-span-3 p-1.5 text-[11px] bg-transparent outline-none border-l border-slate-100 dark:border-slate-800 text-slate-500 font-medium cursor-pointer",value:i.operator,onChange:x=>{const y=[...g.filters||[]];y[m].operator=x.target.value,$({...g,filters:y})},children:[n.jsx("option",{value:"=",children:"="}),n.jsx("option",{value:"!=",children:"!="}),n.jsx("option",{value:">",children:">"}),n.jsx("option",{value:"<",children:"<"}),n.jsx("option",{value:"contains",children:e("dashboard.op_contains")}),n.jsx("option",{value:"is null",children:e("dashboard.op_is_null")})]}),n.jsx("input",{placeholder:e("dashboard.filter_value"),className:"col-span-5 p-1.5 text-[11px] bg-transparent outline-none border-l border-slate-100 dark:border-slate-800 font-bold text-blue-600 dark:text-blue-400 placeholder:text-blue-200",value:i.value,onChange:x=>{const y=[...g.filters||[]];y[m].value=x.target.value,$({...g,filters:y})}})]}),n.jsx("button",{onClick:()=>$({...g,filters:(g.filters||[]).filter((x,y)=>y!==m)}),className:"p-1.5 text-slate-300 hover:text-red-500 transition-colors bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-lg shadow-sm",children:n.jsx(ke,{className:"w-3.5 h-3.5"})})]},m)),(g.filters||[]).length===0&&n.jsxs("div",{className:"py-8 text-center border-2 border-dashed border-slate-50 dark:border-slate-800 rounded-xl",children:[n.jsx(vt,{className:"w-8 h-8 mx-auto mb-2 text-slate-200"}),n.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-slate-300",children:e("dashboard.no_filters")})]})]})]}),n.jsxs("div",{className:"mb-6 flex items-center justify-between border-b border-slate-200 dark:border-slate-800",children:[n.jsxs("div",{className:"flex items-center gap-1 overflow-x-auto no-scrollbar pb-px",children:[t.map(i=>n.jsx("button",{onClick:()=>a(i.id),className:`px-4 py-2.5 text-sm font-bold transition-all border-b-2 whitespace-nowrap ${s===i.id?"text-blue-600 border-blue-600":"text-slate-400 border-transparent hover:text-slate-600"}`,children:i.name},i.id)),!P&&n.jsx("button",{onClick:()=>{k(!0),N("")},className:"px-4 py-2.5 text-slate-400 hover:text-blue-600 transition-all border-b-2 border-transparent",title:e("dashboard.new_dashboard_title"),children:n.jsx(wt,{className:"w-4 h-4"})})]}),!P&&n.jsx("button",{onClick:()=>b(!0),className:"p-2 text-slate-400 hover:text-slate-600",title:e("dashboard.manage_title"),children:n.jsx(pr,{className:"w-4 h-4"})})]}),w&&n.jsxs("div",{className:"mb-6 p-4 bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-800 rounded-xl flex items-center gap-3",children:[n.jsx(yt,{className:"w-5 h-5 text-slate-400"}),n.jsx("input",{autoFocus:!0,type:"text",placeholder:e("dashboard.new_dashboard_placeholder"),className:"flex-1 bg-transparent border-none outline-none font-bold text-slate-700 dark:text-slate-200",value:p,onChange:i=>N(i.target.value),onKeyDown:i=>i.key==="Enter"&&le()}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{onClick:le,className:"p-1.5 text-green-600 hover:bg-green-50 rounded",children:n.jsx(sn,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>k(!1),className:"p-1.5 text-slate-400 hover:bg-slate-100 rounded",children:n.jsx(br,{className:"w-4 h-4"})})]})]}),g&&g.layout.length===0?n.jsxs("div",{className:"flex flex-col items-center justify-center p-12 border-2 border-dashed border-slate-200 dark:border-slate-700 rounded-xl bg-slate-50 dark:bg-slate-900/40 text-slate-400 dark:text-slate-500",children:[n.jsx(yt,{className:"w-12 h-12 mb-4 opacity-50"}),n.jsx("h3",{className:"font-bold text-lg text-slate-600 dark:text-slate-200",children:e("dashboard.empty_msg",{name:g.name})}),n.jsx("p",{className:"mb-4 text-sm text-center text-slate-500 dark:text-slate-400",children:e("dashboard.empty_hint")}),!P&&n.jsx("button",{onClick:()=>u(!0),className:"px-6 py-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-blue-600 dark:text-blue-300 font-bold hover:shadow-sm transition-all text-sm",children:e("dashboard.add_title")})]}):g?n.jsx(Es,{sensors:Ge,collisionDetection:Sn,onDragEnd:i=>{be(i)},children:n.jsx("div",{id:"dashboard-grid",className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6 auto-rows-[300px]",children:g.layout.map(i=>{if(i.type==="system"){const y=Dt.find(j=>j.id===i.id);if(!y)return null;const T=Xs(y.id);return T?n.jsxs(ur,{id:i.id,className:`relative group h-full ${y.defaultColSpan===2?"md:col-span-2":""}`,children:[!P&&n.jsx("div",{className:"absolute -top-2 -right-2 z-20 opacity-0 group-hover:opacity-100 transition-opacity",children:n.jsx("button",{onClick:j=>{j.stopPropagation(),re(i.id)},className:"p-1.5 bg-white/95 backdrop-blur-sm border border-slate-200 rounded-full text-slate-400 hover:text-red-500 shadow-sm",title:e("common.remove"),children:n.jsx(ke,{className:"w-3 h-3"})})}),n.jsx("div",{className:"h-full",children:n.jsx(T,{onRemove:void 0,targetView:Xt.find(j=>j.component===y.id)?.targetView})})]},i.id):null}const m=ee?.find(y=>y.id===i.id);if(!m)return null;let x;try{x=JSON.parse(m.visualization_config)}catch{x={type:"table"}}return n.jsxs(ur,{id:i.id,className:"relative group md:col-span-1 xl:col-span-2 h-full",children:[!P&&n.jsx("div",{className:"absolute -top-2 -right-2 z-20 opacity-0 group-hover:opacity-100 transition-opacity",children:n.jsx("button",{onClick:()=>re(i.id),className:"p-1.5 bg-white/95 backdrop-blur-sm border border-slate-200 rounded-full text-slate-400 hover:text-red-500 shadow-sm",title:"Entfernen",children:n.jsx(ke,{className:"w-3 h-3"})})}),n.jsx(Vr,{title:m.name,sql:m.sql_query,config:x,globalFilters:g.filters,showInspectorJump:!0,inspectorReturnHash:g?.id?`#/?dashboard=${encodeURIComponent(g.id)}`:"#/"})]},i.id)})})}):null,n.jsx(Vt,{isOpen:f,onClose:()=>b(!1),title:e("dashboard.manage_title"),children:n.jsxs("div",{className:"space-y-3",children:[t.map(i=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg group",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(yt,{className:"w-4 h-4 text-slate-400 dark:text-slate-500"}),n.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-200",children:i.name}),i.is_default&&n.jsx("span",{className:"text-[10px] bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-200 px-1.5 py-0.5 rounded font-black uppercase tracking-wider",children:"Default"})]}),n.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[n.jsx("button",{onClick:async()=>{const m=await ze.prompt("Name fuer Dashboard:",{defaultValue:i.name});m&&m!==i.name&&$({...i,name:m})},className:"p-1.5 text-slate-400 dark:text-slate-500 hover:text-blue-600 dark:hover:text-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded",children:n.jsx(Ht,{className:"w-3.5 h-3.5"})}),n.jsx("button",{onClick:()=>rt(i.id),disabled:t.length<=1,className:"p-1.5 text-slate-400 dark:text-slate-500 hover:text-red-600 dark:hover:text-red-300 hover:bg-red-50 dark:hover:bg-red-900/30 rounded disabled:opacity-30",children:n.jsx(ke,{className:"w-3.5 h-3.5"})})]})]},i.id)),n.jsxs("button",{onClick:()=>{b(!1),k(!0)},className:"w-full p-3 border-2 border-dashed border-slate-200 dark:border-slate-700 rounded-lg text-slate-400 dark:text-slate-500 hover:text-blue-600 dark:hover:text-blue-300 hover:border-blue-200 dark:hover:border-blue-700 text-sm font-bold transition-all flex items-center justify-center gap-2",children:[n.jsx(wt,{className:"w-4 h-4"})," Neues Dashboard"]})]})}),n.jsxs(Vt,{isOpen:c,onClose:()=>u(!1),title:e("dashboard.add_title"),children:[n.jsxs("div",{className:"flex gap-4 mb-4 border-b border-slate-200 dark:border-slate-700",children:[n.jsx("button",{onClick:()=>v("system"),className:`pb-2 text-sm font-bold ${h==="system"?"text-blue-600 dark:text-blue-400 border-b-2 border-blue-600 dark:border-blue-400":"text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300"}`,children:e("dashboard.system_widgets")}),n.jsx("button",{onClick:()=>v("custom"),className:`pb-2 text-sm font-bold ${h==="custom"?"text-blue-600 dark:text-blue-400 border-b-2 border-blue-600 dark:border-blue-400":"text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300"}`,children:e("dashboard.custom_widgets")})]}),n.jsxs("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto min-h-[300px]",children:[h==="system"&&n.jsx("div",{className:"grid grid-cols-1 gap-2",children:Dt.map(i=>{const m=g?.layout.some(j=>j.id===i.id),x=Xt.find(j=>j.component===i.id),y=!!x?.targetView,T=y&&I.includes(x.id);return n.jsxs("div",{className:"flex items-center justify-between p-3 border border-slate-200 dark:border-slate-700 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800/60",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"p-2 bg-slate-100 dark:bg-slate-800 rounded-lg text-slate-500 dark:text-slate-300",children:n.jsx(i.icon,{className:"w-5 h-5"})}),n.jsxs("div",{children:[n.jsx("div",{className:"font-bold text-slate-700 dark:text-slate-100",children:e(i.titleKey)}),n.jsx("div",{className:"text-xs text-slate-400 dark:text-slate-500",children:e(i.descriptionKey)})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[y&&n.jsx("button",{onClick:j=>{j.stopPropagation(),B(T?I.filter(M=>M!==x.id):[...I,x.id])},title:e(T?"dashboard.unpin_sidebar":"dashboard.pin_sidebar"),className:`p-1.5 rounded-md border transition-all ${T?"bg-amber-50 dark:bg-amber-900/30 border-amber-200 dark:border-amber-700 text-amber-500 dark:text-amber-300":"bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 text-slate-300 dark:text-slate-500 hover:text-amber-400 dark:hover:text-amber-300"}`,children:n.jsx(an,{className:`w-4 h-4 ${T?"fill-current":""}`})}),n.jsx("button",{onClick:()=>Me(i.id,"system"),disabled:m,className:`px-3 py-1.5 text-xs font-bold rounded ${m?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300":"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 hover:bg-blue-200 dark:hover:bg-blue-900/50"}`,children:e(m?"dashboard.active":"common.add")})]})]},i.id)})}),h==="custom"&&n.jsx("div",{className:"grid grid-cols-1 gap-2",children:ee&&ee.length>0?ee.map(i=>{const m=g?.layout.some(y=>y.id===i.id),x=(()=>{const y=(typeof i.description=="string"?i.description:"").trim();if(y)return y;if(typeof i.visualization_config!="string")return"";try{return(JSON.parse(i.visualization_config).widgetDescription||"").trim()}catch{return""}})();return n.jsxs("div",{className:"flex items-center justify-between p-3 border border-slate-200 dark:border-slate-700 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800/60",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"p-2 bg-blue-50 dark:bg-blue-900/30 rounded-lg text-blue-500 dark:text-blue-300",children:n.jsx(Fe,{className:"w-5 h-5"})}),n.jsxs("div",{children:[n.jsx("div",{className:"font-bold text-slate-700 dark:text-slate-100",children:i.name}),n.jsx("div",{className:"text-xs text-slate-400 dark:text-slate-500 truncate max-w-[260px]",title:x||i.sql_query,children:x||i.sql_query})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>{Ae(i)},className:"p-2 text-slate-400 dark:text-slate-500 hover:text-blue-500 dark:hover:text-blue-300",title:e("common.rename"),children:n.jsx(Ht,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>H(i.id),className:"p-2 text-slate-400 dark:text-slate-500 hover:text-red-500 dark:hover:text-red-300",title:e("common.delete"),children:n.jsx(ke,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>Me(i.id,"custom"),disabled:m,className:`px-3 py-1.5 text-xs font-bold rounded ${m?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300":"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 hover:bg-blue-200 dark:hover:bg-blue-900/50"}`,children:e(m?"dashboard.active":"common.add")})]})]},i.id)}):n.jsx("p",{className:"text-center text-slate-400 dark:text-slate-500 py-4",children:e("dashboard.no_reports")})})]})]})]}):null};export{da as CustomDashboardView};
