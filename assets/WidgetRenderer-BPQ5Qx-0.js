import{u as me,e as be,S as pe,j as e}from"./index-BwrLLMel.js";import{u as ue,h as he,r as B,d as y}from"./vendor-react-D64xOC9_.js";import{D as ke}from"./DataTable-CN3uIG45.js";import{R as fe}from"./RecordDetailModal-BuVEuf7b.js";import{f as c,M as je,P as Y}from"./MarkdownContent-CG2IGVkl.js";import{I as ye,a as ge}from"./inspectorBridge-BnIEasIL.js";import{aD as G,F as we,m as D,ad as ve,af as Ne,ae as H,r as Se,l as Ae}from"./vendor-icons-DtiG8Nuk.js";import{R as Le,B as _e,C as L,X as _,Y as C,T as g,L as w,a as V,b as $,c as Ce,d as X,A as $e,e as Re,P as Te,f as Ee,g as Ie,h as ze,i as De,j as Ke,k as Oe,l as We,m as Fe,S as Pe,n as Ue}from"./vendor-charts-BtQqxQq4.js";const d=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8","#82ca9d"],Qe=({title:p,sql:R,config:t,globalFilters:T,showInspectorJump:Q=!1,inspectorReturnHash:K})=>{const{t:n}=me(),O=ue(),E=he(),N=typeof document<"u"&&document.documentElement.classList.contains("dark"),k={borderRadius:"12px",border:N?"1px solid #334155":"1px solid #e2e8f0",backgroundColor:N?"#0f172a":"#ffffff",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.18)"},f={color:N?"#e2e8f0":"#0f172a",fontWeight:700,fontSize:"12px"},j={color:N?"#cbd5e1":"#334155",fontWeight:600,fontSize:"12px"},Z={fill:N?"rgba(148, 163, 184, 0.14)":"#f1f5f9"},v=B.useMemo(()=>{let s=R;if(!T||T.length===0)return s;const a=T.filter(o=>o.column&&(o.operator==="is null"||o.value));if(a.length===0)return s;const r=a.map(o=>{const b=`"${o.column.replace(/"/g,'""')}"`,S=typeof o.value=="string"?`'${o.value.replace(/'/g,"''")}'`:o.value,u=o.operator==="contains"?"LIKE":o.operator==="is null"?"IS NULL":o.operator;if(o.operator==="is null")return`${b} IS NULL`;const h=o.operator==="contains"?`'%${o.value}%'`:S;return`${b} ${u} ${h}`}).join(" AND ");return s.toUpperCase().includes("WHERE")?s=s.replace(/WHERE/i,`WHERE (${r}) AND `):s.toUpperCase().includes("GROUP BY")?s=s.replace(/GROUP BY/i,`WHERE ${r} GROUP BY `):s.toUpperCase().includes("ORDER BY")?s=s.replace(/ORDER BY/i,`WHERE ${r} ORDER BY `):s.toUpperCase().includes("LIMIT")?s=s.replace(/LIMIT/i,`WHERE ${r} LIMIT `):s+=` WHERE ${r}`,s},[R,T]),I=Q&&/^\s*SELECT\b/i.test(v),J=y.useCallback(()=>{if(!I)return;localStorage.setItem(ye,v);const s=`#${E.pathname}${E.search||""}`;localStorage.setItem(ge,K||s),O("/sql-workspace")},[I,v,K,E.pathname,E.search,O]),{data:l,loading:ee,error:W}=be(async()=>t.type==="text"||t.type==="markdown"||t.type==="status"||t.type==="section"||t.type==="kpi_manual"||t.type==="kpu_manual"||t.type==="image"?[]:v?await pe.executeRaw(v):[],[v,t.type]),F=(t.imageUrl||"").trim(),[te,P]=y.useState(!1);y.useEffect(()=>{P(!1)},[F]);const[se,U]=y.useState(!1),[ae,re]=y.useState(0),[le,ie]=y.useState(null);y.useEffect(()=>{if(l&&l.length>0){const s=R.match(/FROM\s+([a-zA-Z0-9_]+)/i),a=s?s[1]:"Dataset",r={title:p,description:`${n("widgets.data_inspector.description")}: ${a}`,type:"object",properties:Object.keys(l[0]).reduce((o,b)=>{const u=typeof l[0][b]=="number"?"number":"string";return o[b]={type:u,description:b},o},{})};ie(r)}},[l,R,p,n]);const de=B.useMemo(()=>!l||l.length===0?[]:Object.keys(l[0]).map(s=>({header:s,accessor:s,render:a=>c(a[s],s)})),[l]),q=(t.widgetDescription||"").trim(),oe=t.widgetDescriptionPosition==="top"?"top":"bottom",m=s=>!q||oe!==s?null:e.jsx("div",{className:"px-5 py-2.5 text-[11px] text-slate-600 dark:text-slate-300 bg-slate-50/70 dark:bg-slate-900/30 border-b border-slate-200 dark:border-slate-800/60",children:q}),ne={sm:"text-sm",md:"text-base",lg:"text-lg",xl:"text-xl","2xl":"text-2xl"};if(t.type==="text")return e.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-slate-800 rounded-xl border border-slate-300 dark:border-slate-700/50 shadow-sm hover:shadow-xl hover:shadow-slate-200/50 dark:hover:shadow-none transition-all duration-500 overflow-hidden",children:[e.jsx("div",{className:"flex items-center justify-between pt-2.5 pb-2.5 px-5 bg-slate-50/50 dark:bg-slate-900/20 border-b border-slate-200 dark:border-slate-800/50",children:e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"p-1.5 rounded-xl shrink-0 shadow-sm text-blue-600 bg-blue-50 dark:bg-blue-900/20 dark:text-blue-400",children:e.jsx(G,{className:"w-4 h-4"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"text-xs font-bold leading-snug text-slate-800 dark:text-white truncate tracking-tight",children:p}),e.jsx("div",{className:"h-0.5 w-4 bg-slate-200 dark:bg-slate-700 rounded-full mt-0.5"})]})]})}),m("top"),e.jsx("div",{className:`flex-1 p-4 whitespace-pre-wrap break-words text-slate-800 dark:text-slate-100 ${ne[t.textSize||"md"]} ${t.textBold?"font-bold":"font-normal"} ${t.textItalic?"italic":"not-italic"} ${t.textUnderline?"underline":"no-underline"} ${t.textAlign==="center"?"text-center":t.textAlign==="right"?"text-right":"text-left"}`,children:(t.textContent||"").trim()||n("querybuilder.text_placeholder")}),m("bottom")]});if(t.type==="markdown")return e.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-slate-800 rounded-xl border border-slate-300 dark:border-slate-700/50 shadow-sm hover:shadow-xl hover:shadow-slate-200/50 dark:hover:shadow-none transition-all duration-500 overflow-hidden",children:[e.jsx("div",{className:"flex items-center justify-between pt-2.5 pb-2.5 px-5 bg-slate-50/50 dark:bg-slate-900/20 border-b border-slate-200 dark:border-slate-800/50",children:e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"p-1.5 rounded-xl shrink-0 shadow-sm text-blue-600 bg-blue-50 dark:bg-blue-900/20 dark:text-blue-400",children:e.jsx(we,{className:"w-4 h-4"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"text-xs font-bold leading-snug text-slate-800 dark:text-white truncate tracking-tight",children:p}),e.jsx("div",{className:"h-0.5 w-4 bg-slate-200 dark:bg-slate-700 rounded-full mt-0.5"})]})]})}),m("top"),e.jsx("div",{className:"flex-1 p-4 overflow-auto text-slate-800 dark:text-slate-100",children:e.jsx(je,{markdown:(t.markdownContent||"").trim(),emptyText:n("querybuilder.markdown_placeholder",`# Titel
Text mit **Fett** und [Link](https://example.com)`),className:"text-sm leading-6"})}),m("bottom")]});if(t.type==="status"){const s=t.statusLevel||"ok",r={ok:{ring:"ring-emerald-200 bg-emerald-50 dark:bg-emerald-900/20",dot:"bg-emerald-500",title:"text-emerald-800 dark:text-emerald-300",text:"text-emerald-700/90 dark:text-emerald-200/90"},info:{ring:"ring-blue-200 bg-blue-50 dark:bg-blue-900/20",dot:"bg-blue-500",title:"text-blue-800 dark:text-blue-300",text:"text-blue-700/90 dark:text-blue-200/90"},warning:{ring:"ring-amber-200 bg-amber-50 dark:bg-amber-900/20",dot:"bg-amber-500",title:"text-amber-800 dark:text-amber-300",text:"text-amber-700/90 dark:text-amber-200/90"},critical:{ring:"ring-rose-200 bg-rose-50 dark:bg-rose-900/20",dot:"bg-rose-500",title:"text-rose-800 dark:text-rose-300",text:"text-rose-700/90 dark:text-rose-200/90"}}[s];return e.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-slate-800 rounded-xl border border-slate-300 dark:border-slate-700/50 shadow-sm hover:shadow-xl hover:shadow-slate-200/50 dark:hover:shadow-none transition-all duration-500 overflow-hidden",children:[e.jsx("div",{className:"flex items-center justify-between pt-2.5 pb-2.5 px-5 bg-slate-50/50 dark:bg-slate-900/20 border-b border-slate-200 dark:border-slate-800/50",children:e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"p-1.5 rounded-xl shrink-0 shadow-sm text-blue-600 bg-blue-50 dark:bg-blue-900/20 dark:text-blue-400",children:e.jsx(D,{className:"w-4 h-4"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"text-xs font-bold leading-snug text-slate-800 dark:text-white truncate tracking-tight",children:p}),e.jsx("div",{className:"h-0.5 w-4 bg-slate-200 dark:bg-slate-700 rounded-full mt-0.5"})]})]})}),m("top"),e.jsx("div",{className:"flex-1 p-4 flex items-center justify-center",children:e.jsxs("div",{className:`w-full rounded-xl ring-1 ${r.ring} p-5`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`relative inline-flex h-3.5 w-3.5 rounded-full ${r.dot}`,children:t.statusPulse&&e.jsx("span",{className:`absolute inline-flex h-full w-full rounded-full ${r.dot} opacity-75 animate-ping`})}),e.jsx("span",{className:`text-[11px] font-black uppercase tracking-wider ${r.title}`,children:n(`querybuilder.status_level_${s}`,s)})]}),e.jsx("div",{className:`mt-3 text-lg font-bold ${r.title}`,children:(t.statusTitle||"").trim()||n("querybuilder.status_placeholder_title","System status")}),e.jsx("p",{className:`mt-2 text-sm ${r.text}`,children:(t.statusMessage||"").trim()||n("querybuilder.status_placeholder_message","All core systems are running stable.")})]})}),m("bottom")]})}if(t.type==="section"){const s=t.sectionAlign||"left",a=s==="center"?"text-center":s==="right"?"text-right":"text-left",r=t.sectionDividerStyle||"line";return e.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-slate-800 rounded-xl border border-slate-300 dark:border-slate-700/50 shadow-sm hover:shadow-xl hover:shadow-slate-200/50 dark:hover:shadow-none transition-all duration-500 overflow-hidden",children:[e.jsx("div",{className:"flex items-center justify-between pt-2.5 pb-2.5 px-5 bg-slate-50/50 dark:bg-slate-900/20 border-b border-slate-200 dark:border-slate-800/50",children:e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"p-1.5 rounded-xl shrink-0 shadow-sm text-blue-600 bg-blue-50 dark:bg-blue-900/20 dark:text-blue-400",children:e.jsx(ve,{className:"w-4 h-4"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"text-xs font-bold leading-snug text-slate-800 dark:text-white truncate tracking-tight",children:p}),e.jsx("div",{className:"h-0.5 w-4 bg-slate-200 dark:bg-slate-700 rounded-full mt-0.5"})]})]})}),m("top"),e.jsx("div",{className:"flex-1 p-5 flex flex-col justify-center",children:e.jsxs("div",{className:`w-full ${a}`,children:[e.jsx("h2",{className:"text-2xl font-black tracking-tight text-slate-800 dark:text-slate-100",children:(t.sectionTitle||"").trim()||n("querybuilder.section_placeholder_title","Section title")}),(t.sectionSubtitle||"").trim()&&e.jsx("p",{className:"mt-1 text-sm text-slate-500 dark:text-slate-400",children:t.sectionSubtitle}),r==="line"&&e.jsx("div",{className:`mt-4 h-px bg-slate-300 dark:bg-slate-700 ${s==="center"?"mx-auto w-2/3":s==="right"?"ml-auto w-2/3":"w-2/3"}`}),r==="double"&&e.jsxs("div",{className:`mt-4 space-y-1 ${s==="center"?"mx-auto w-2/3":s==="right"?"ml-auto w-2/3":"w-2/3"}`,children:[e.jsx("div",{className:"h-px bg-slate-300 dark:bg-slate-700"}),e.jsx("div",{className:"h-px bg-slate-300 dark:bg-slate-700"})]})]})}),m("bottom")]})}if(t.type==="kpi_manual"||t.type==="kpu_manual"){const s=t.kpiTrend||t.kpuTrend||"flat",a=M=>{if(!M)return Number.NaN;const ce=M.replace(/\s+/g,"").replace(",",".").replace(/[^0-9.+-]/g,"");return Number(ce)},r=a(t.kpiValue||t.kpuValue),o=a(t.kpiTarget||t.kpuTarget),b=t.kpiAlign||t.kpuAlign||"left",S=b==="center"?"text-center":b==="right"?"text-right":"text-left",u=b==="center"?"justify-center":b==="right"?"justify-end":"justify-start",h=Number.isFinite(r)&&Number.isFinite(o)&&o!==0,A=h?r/o:Number.NaN,i=h?A>=1?"ok":A>=.95?"warn":"crit":"neutral",x=s==="up"?"text-emerald-700 dark:text-emerald-300 bg-emerald-50 dark:bg-emerald-900/20":s==="down"?"text-rose-700 dark:text-rose-300 bg-rose-50 dark:bg-rose-900/20":"text-slate-700 dark:text-slate-300 bg-slate-100 dark:bg-slate-700/40",z=i==="ok"?"text-emerald-700 dark:text-emerald-300 bg-emerald-50 dark:bg-emerald-900/20 border-emerald-200 dark:border-emerald-800":i==="warn"?"text-amber-700 dark:text-amber-300 bg-amber-50 dark:bg-amber-900/20 border-amber-200 dark:border-amber-800":i==="crit"?"text-rose-700 dark:text-rose-300 bg-rose-50 dark:bg-rose-900/20 border-rose-200 dark:border-rose-800":"text-slate-600 dark:text-slate-300 bg-slate-100 dark:bg-slate-700/40 border-slate-200 dark:border-slate-700",xe=i==="ok"?"text-emerald-700 dark:text-emerald-300":i==="warn"?"text-amber-700 dark:text-amber-300":i==="crit"?"text-rose-700 dark:text-rose-300":"text-slate-900 dark:text-slate-100";return e.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-slate-800 rounded-xl border border-slate-300 dark:border-slate-700/50 shadow-sm hover:shadow-xl hover:shadow-slate-200/50 dark:hover:shadow-none transition-all duration-500 overflow-hidden",children:[e.jsx("div",{className:"flex items-center justify-between pt-2.5 pb-2.5 px-5 bg-slate-50/50 dark:bg-slate-900/20 border-b border-slate-200 dark:border-slate-800/50",children:e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"p-1.5 rounded-xl shrink-0 shadow-sm text-blue-600 bg-blue-50 dark:bg-blue-900/20 dark:text-blue-400",children:e.jsx(Ne,{className:"w-4 h-4"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"text-xs font-bold leading-snug text-slate-800 dark:text-white truncate tracking-tight",children:p}),e.jsx("div",{className:"h-0.5 w-4 bg-slate-200 dark:bg-slate-700 rounded-full mt-0.5"})]})]})}),m("top"),e.jsx("div",{className:"flex-1 p-5 flex items-center justify-center",children:e.jsxs("div",{className:`w-full rounded-xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 p-5 ${S}`,children:[e.jsx("div",{className:"text-[10px] font-black uppercase tracking-wider text-slate-400",children:(t.kpiTitle||t.kpuTitle||"").trim()||n("querybuilder.kpi_placeholder_title","KPI")}),e.jsxs("div",{className:`mt-3 flex items-end gap-2 ${u}`,children:[e.jsx("div",{className:`text-4xl font-black tracking-tight ${xe}`,children:(t.kpiValue||t.kpuValue||"").trim()||"--"}),(t.kpiUnit||t.kpuUnit||"").trim()&&e.jsx("div",{className:"pb-1 text-sm font-bold text-slate-500 dark:text-slate-400",children:t.kpiUnit||t.kpuUnit})]}),e.jsxs("div",{className:`mt-3 flex flex-wrap items-center gap-2 ${u}`,children:[e.jsxs("span",{className:"px-2 py-1 rounded-full text-[10px] font-black uppercase tracking-wide bg-blue-50 text-blue-700 dark:bg-blue-900/20 dark:text-blue-300",children:[n("querybuilder.kpi_target","Target"),": ",(t.kpiTarget||t.kpuTarget||"").trim()||"-"]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-[10px] font-black uppercase tracking-wide ${x}`,children:n(`querybuilder.kpi_trend_${s}`,s)}),e.jsx("span",{className:`px-2 py-1 rounded-full border text-[10px] font-black uppercase tracking-wide ${z}`,children:i==="ok"?n("querybuilder.kpi_status_on_target","On target"):i==="warn"?n("querybuilder.kpi_status_near_target","Near target"):i==="crit"?n("querybuilder.kpi_status_below_target","Below target"):n("querybuilder.kpi_status_no_compare","No target comparison")})]}),(t.kpiNote||t.kpuNote||"").trim()&&e.jsx("p",{className:"mt-3 text-xs text-slate-500 dark:text-slate-400",children:t.kpiNote||t.kpuNote})]})}),m("bottom")]})}if(t.type==="image"){const s=t.imageAlign||"center",a=s==="left"?"items-start":s==="right"?"items-end":"items-center",r=F;return e.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-slate-800 rounded-xl border border-slate-300 dark:border-slate-700/50 shadow-sm hover:shadow-xl hover:shadow-slate-200/50 dark:hover:shadow-none transition-all duration-500 overflow-hidden",children:[e.jsx("div",{className:"flex items-center justify-between pt-2.5 pb-2.5 px-5 bg-slate-50/50 dark:bg-slate-900/20 border-b border-slate-200 dark:border-slate-800/50",children:e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"p-1.5 rounded-xl shrink-0 shadow-sm text-blue-600 bg-blue-50 dark:bg-blue-900/20 dark:text-blue-400",children:e.jsx(H,{className:"w-4 h-4"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"text-xs font-bold leading-snug text-slate-800 dark:text-white truncate tracking-tight",children:p}),e.jsx("div",{className:"h-0.5 w-4 bg-slate-200 dark:bg-slate-700 rounded-full mt-0.5"})]})]})}),m("top"),e.jsx("div",{className:"flex-1 p-5",children:e.jsx("div",{className:`h-full w-full flex flex-col ${a} justify-center`,children:r&&!te?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:r,alt:(t.imageAlt||"").trim()||"Image widget",referrerPolicy:"no-referrer",crossOrigin:"anonymous",onError:()=>P(!0),className:`max-h-[320px] w-full rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 ${t.imageFit==="cover"?"object-cover":"object-contain"}`}),(t.imageCaption||"").trim()&&e.jsx("p",{className:"mt-2 text-xs text-slate-500 dark:text-slate-400",children:t.imageCaption})]}):r?e.jsx("div",{className:"w-full rounded-lg border border-amber-300 bg-amber-50 dark:bg-amber-900/20 dark:border-amber-700 p-3 text-amber-900 dark:text-amber-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(D,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-xs font-bold",children:n("querybuilder.image_load_error_title","Image could not be loaded.")}),e.jsx("p",{className:"text-[11px] mt-1",children:n("querybuilder.image_load_error_hint","Please check URL access and CORS/hotlink protection.")}),e.jsx("p",{className:"text-[10px] mt-1 font-mono break-all opacity-80",children:r})]})]})}):e.jsxs("div",{className:"h-[220px] w-full rounded-lg border border-dashed border-slate-300 dark:border-slate-700 flex flex-col items-center justify-center text-slate-400",children:[e.jsx(H,{className:"w-8 h-8 mb-2 opacity-60"}),e.jsx("p",{className:"text-xs font-semibold text-center",children:n("querybuilder.image_empty_hint","Please provide an image URL.")})]})})}),m("bottom")]})}return ee?e.jsx("div",{className:"h-full flex items-center justify-center text-slate-400",children:e.jsx(Se,{className:"w-6 h-6 animate-spin"})}):W?e.jsx("div",{className:"h-full flex items-center justify-center text-red-400 p-4 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(D,{className:"w-6 h-6"}),e.jsx("span",{className:"text-xs",children:W.message})]})}):!l||l.length===0?e.jsx("div",{className:"h-full flex items-center justify-center text-slate-400 text-sm",children:n("common.no_data")}):e.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-slate-800 rounded-xl border border-slate-300 dark:border-slate-700/50 shadow-sm hover:shadow-xl hover:shadow-slate-200/50 dark:hover:shadow-none transition-all duration-500 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between pt-2.5 pb-2.5 px-5 bg-slate-50/50 dark:bg-slate-900/20 border-b border-slate-200 dark:border-slate-800/50",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"p-1.5 rounded-xl shrink-0 shadow-sm text-blue-600 bg-blue-50 dark:bg-blue-900/20 dark:text-blue-400",children:e.jsx(G,{className:"w-4 h-4"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"text-xs font-bold leading-snug text-slate-800 dark:text-white truncate tracking-tight",children:p}),e.jsx("div",{className:"h-0.5 w-4 bg-slate-200 dark:bg-slate-700 rounded-full mt-0.5"})]})]}),I&&e.jsxs("button",{type:"button",onClick:J,className:"inline-flex items-center gap-1.5 px-2 py-1 text-[10px] font-bold uppercase tracking-wider rounded-md border border-slate-200 dark:border-slate-700 text-slate-500 hover:text-blue-600 hover:border-blue-300 dark:hover:border-blue-600 transition-colors",title:n("common.open_in_inspector"),children:[e.jsx(Ae,{className:"w-3 h-3"}),n("common.open")]})]}),m("top"),e.jsx("div",{className:"flex-1 min-h-0 p-2",children:t.type==="table"?e.jsx("div",{className:"h-full overflow-auto",children:e.jsx(ke,{columns:de,data:l,onRowClick:s=>{const a=l.indexOf(s);re(a>=0?a:0),U(!0)}})}):t.type==="pivot"?e.jsx(Y,{data:l,rows:t.pivotRows||[],cols:t.pivotCols||[],measures:t.pivotMeasures||[]}):t.type==="kpi"?e.jsx("div",{className:"h-full flex flex-col items-center justify-center p-4",children:l&&l.length>0?(()=>{const s=l[0],a=Object.keys(s),r=(t.yAxes||[])[0]||t.yAxis||"",o=a.includes(r)?r:a.find(i=>{const x=s[i];if(typeof x=="number")return Number.isFinite(x);if(typeof x=="string"){const z=x.replace(/\s+/g,"").replace(",",".");return Number.isFinite(Number(z))}return!1})||a[0],b=s[o],u=(i=>{if(typeof i=="number")return i;if(typeof i=="string"){const x=i.replace(/\s+/g,"").replace(",",".");return Number(x)}return Number.NaN})(b);let h="text-slate-900 dark:text-white",A;if(t.rules&&!isNaN(u))for(const i of t.rules){let x=!1;switch(i.operator){case">":x=u>i.value;break;case"<":x=u<i.value;break;case">=":x=u>=i.value;break;case"<=":x=u<=i.value;break;case"==":x=u===i.value;break}if(x){i.color==="green"?h="text-emerald-500":i.color==="red"?h="text-rose-500":i.color==="yellow"?h="text-amber-500":i.color==="blue"?h="text-blue-500":A={color:i.color};break}}return e.jsxs("div",{className:"flex flex-col items-center text-center animate-in zoom-in-95 duration-500",children:[e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx("div",{className:`text-4xl md:text-5xl lg:text-6xl font-black tracking-widest break-all transition-colors duration-300 ${h}`,style:A,children:c(b,o)}),(t.kpiUnit||"").trim()&&e.jsx("div",{className:"pb-1 text-base md:text-lg font-bold text-slate-500 dark:text-slate-400",children:t.kpiUnit})]}),e.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-[0.3em] mt-3",children:o})]})})():e.jsx("div",{className:"text-slate-300 text-[10px] font-bold uppercase tracking-widest",children:n("common.no_data")})}):e.jsx(Le,{width:"100%",height:"100%",minWidth:0,children:t.type==="bar"?e.jsxs(_e,{data:l,children:[e.jsx(L,{strokeDasharray:"3 3",vertical:!1,stroke:"#e2e8f0"}),e.jsx(_,{dataKey:t.xAxis,axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#64748b"}}),e.jsx(C,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#64748b"},tickFormatter:s=>c(s,(t.yAxes||[])[0])}),e.jsx(g,{contentStyle:k,labelStyle:f,itemStyle:j,cursor:Z,formatter:(s,a)=>[c(s,a),a]}),e.jsx(w,{verticalAlign:"top",height:36,iconType:"circle",wrapperStyle:{fontSize:"10px",fontWeight:"bold",textTransform:"uppercase"}}),(t.yAxes||(t.yAxis?[t.yAxis]:[])).map((s,a)=>e.jsx(V,{dataKey:s,fill:a===0?t.color||d[0]:d[a%d.length],radius:[4,4,0,0],children:t.showLabels&&e.jsx($,{dataKey:s,position:"top",style:{fontSize:"10px",fontWeight:"bold",fill:"#64748b"},formatter:r=>c(r,s)})},s))]}):t.type==="line"?e.jsxs(Ce,{data:l,children:[e.jsx(L,{strokeDasharray:"3 3",vertical:!1,stroke:"#e2e8f0"}),e.jsx(_,{dataKey:t.xAxis,axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#64748b"}}),e.jsx(C,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#64748b"},tickFormatter:s=>c(s,(t.yAxes||[])[0])}),e.jsx(g,{contentStyle:k,labelStyle:f,itemStyle:j,formatter:(s,a)=>[c(s,a),a]}),e.jsx(w,{verticalAlign:"top",height:36,iconType:"circle",wrapperStyle:{fontSize:"10px",fontWeight:"bold",textTransform:"uppercase"}}),(t.yAxes||(t.yAxis?[t.yAxis]:[])).map((s,a)=>e.jsx(X,{type:"monotone",dataKey:s,stroke:a===0?t.color||d[0]:d[a%d.length],strokeWidth:3,dot:{r:4},activeDot:{r:6},children:t.showLabels&&e.jsx($,{dataKey:s,position:"top",offset:10,style:{fontSize:"10px",fontWeight:"bold",fill:"#64748b"},formatter:r=>c(r,s)})},s))]}):t.type==="area"?e.jsxs($e,{data:l,children:[e.jsx("defs",{children:(t.yAxes||(t.yAxis?[t.yAxis]:[])).map((s,a)=>e.jsxs("linearGradient",{id:`color-${s}-${p.replace(/\s+/g,"")}`,x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:a===0?t.color||d[0]:d[a%d.length],stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:a===0?t.color||d[0]:d[a%d.length],stopOpacity:0})]},`grad-${s}`))}),e.jsx(_,{dataKey:t.xAxis,axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#64748b"}}),e.jsx(C,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#64748b"},tickFormatter:s=>c(s,(t.yAxes||[])[0])}),e.jsx(L,{strokeDasharray:"3 3",vertical:!1,stroke:"#e2e8f0"}),e.jsx(g,{contentStyle:k,labelStyle:f,itemStyle:j,formatter:(s,a)=>[c(s,a),a]}),e.jsx(w,{verticalAlign:"top",height:36,iconType:"circle",wrapperStyle:{fontSize:"10px",fontWeight:"bold"}}),(t.yAxes||(t.yAxis?[t.yAxis]:[])).map((s,a)=>e.jsx(Re,{type:"monotone",dataKey:s,stroke:a===0?t.color||d[0]:d[a%d.length],strokeWidth:3,fillOpacity:1,fill:`url(#color-${s}-${p.replace(/\s+/g,"")})`,children:t.showLabels&&e.jsx($,{dataKey:s,position:"top",style:{fontSize:"10px",fontWeight:"bold",fill:"#64748b"},formatter:r=>c(r,s)})},s))]}):t.type==="pie"?e.jsxs(Te,{children:[e.jsx(Ee,{data:l,cx:"50%",cy:"50%",labelLine:!1,label:({name:s,percent:a})=>`${s??""} ${(a?a*100:0).toFixed(0)}%`,outerRadius:80,innerRadius:50,paddingAngle:5,dataKey:(t.yAxes||(t.yAxis?[t.yAxis]:[]))[0]||"",nameKey:t.xAxis,children:l.map((s,a)=>e.jsx(Ie,{fill:d[a%d.length],stroke:"white",strokeWidth:2},`cell-${a}`))}),e.jsx(g,{contentStyle:k,labelStyle:f,itemStyle:j}),e.jsx(w,{verticalAlign:"bottom",height:36,iconSize:8,wrapperStyle:{fontSize:"10px",fontWeight:"bold"}})]}):t.type==="composed"?e.jsxs(ze,{data:l,children:[e.jsx(L,{strokeDasharray:"3 3",vertical:!1,stroke:"#e2e8f0"}),e.jsx(_,{dataKey:t.xAxis,axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#64748b"}}),e.jsx(C,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#64748b"},tickFormatter:s=>c(s,(t.yAxes||[])[0])}),e.jsx(g,{contentStyle:k,labelStyle:f,itemStyle:j,formatter:(s,a)=>[c(s,a),a]}),e.jsx(w,{verticalAlign:"top",height:36,iconType:"circle"}),(t.yAxes||[]).map((s,a)=>t.lineSeries?.includes(s)?e.jsx(X,{type:"monotone",dataKey:s,stroke:d[a%d.length],strokeWidth:3,children:t.showLabels&&e.jsx($,{dataKey:s,position:"top",style:{fontSize:"10px",fontWeight:"bold",fill:"#64748b"},formatter:r=>c(r,s)})},s):e.jsx(V,{dataKey:s,fill:d[a%d.length],radius:[4,4,0,0],children:t.showLabels&&e.jsx($,{dataKey:s,position:"top",style:{fontSize:"10px",fontWeight:"bold",fill:"#64748b"},formatter:r=>c(r,s)})},s))]}):t.type==="radar"?e.jsxs(De,{cx:"50%",cy:"50%",outerRadius:"80%",data:l,children:[e.jsx(Ke,{stroke:"#e2e8f0"}),e.jsx(Oe,{dataKey:t.xAxis,tick:{fontSize:10,fill:"#64748b"}}),e.jsx(We,{angle:30,domain:[0,"auto"],tick:{fontSize:8}}),(t.yAxes||[]).map((s,a)=>e.jsx(Fe,{name:s,dataKey:s,stroke:d[a%d.length],fill:d[a%d.length],fillOpacity:.6},s)),e.jsx(w,{iconType:"circle",wrapperStyle:{fontSize:"10px"}}),e.jsx(g,{contentStyle:k,labelStyle:f,itemStyle:j})]}):t.type==="scatter"?e.jsxs(Pe,{children:[e.jsx(L,{strokeDasharray:"3 3",vertical:!1,stroke:"#e2e8f0"}),e.jsx(_,{type:"number",dataKey:t.xAxis,name:t.xAxis,axisLine:!1,tickLine:!1,tick:{fontSize:10}}),e.jsx(C,{type:"number",dataKey:(t.yAxes||[])[0],name:(t.yAxes||[])[0],axisLine:!1,tickLine:!1,tick:{fontSize:10}}),e.jsx(g,{contentStyle:k,labelStyle:f,itemStyle:j,cursor:{strokeDasharray:"3 3"}}),e.jsx(w,{verticalAlign:"top",height:36}),e.jsx(Ue,{name:p,data:l,fill:t.color||d[0]})]}):t.type==="pivot"?e.jsx(Y,{data:l,rows:t.pivotRows||[],cols:t.pivotCols||[],measures:t.pivotMeasures||[]}):null})}),m("bottom"),l&&l.length>0&&e.jsx(fe,{isOpen:se,onClose:()=>U(!1),items:l,initialIndex:ae,title:p,schema:le||void 0,tableName:void 0})]})};export{Qe as W};
