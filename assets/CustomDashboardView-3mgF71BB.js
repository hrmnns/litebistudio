import{u as ke,j as n,n as Yt,e as ur,S as de,o as Ur,c as hr,a as Xt,d as Kr,P as Yr,C as qt,M as Ht,b as xt}from"./index-CXLGbupS.js";import{r as l,d as q,b as Le,u as it}from"./vendor-react-D64xOC9_.js";import{u as Xr}from"./MarkdownContent-BGVa9k9h.js";import{W as qr}from"./WidgetRenderer-CxgVOkaZ.js";import{d as Hr,X as fr,am as Ct,an as Vr,g as et,$ as Jr,D as Pe,A as tt,C as Gr,ao as Zr,O as Qr,m as br,S as gr,h as rt,Z as en,z as tn,H as rn,a4 as pt,u as ye,K as mt,ad as vt,t as nn,ap as sn,a3 as an,a9 as on,aa as ln,al as cn,a0 as dn}from"./vendor-icons-Du2dXQHa.js";import{u as un}from"./useBackupStatus-CY1ybykp.js";import"./vendor-pdf-FXkUb51H.js";import"./vendor-ui-BNe0Xlio.js";import"./vendor-charts-BtQqxQq4.js";import"./vendor-canvas-DXEQVQnt.js";import"./DataTable-JvBUXwRw.js";import"./RecordDetailModal-a3bacUuN.js";import"./SchemaDocumentation-SnubHkls.js";import"./inspectorBridge-BnIEasIL.js";const ct=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Ee(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function At(e){return"nodeType"in e}function H(e){var t,r;return e?Ee(e)?e:At(e)&&(t=(r=e.ownerDocument)==null?void 0:r.defaultView)!=null?t:window:window}function Tt(e){const{Document:t}=H(e);return e instanceof t}function Ke(e){return Ee(e)?!1:e instanceof H(e).HTMLElement}function xr(e){return e instanceof H(e).SVGElement}function Re(e){return e?Ee(e)?e.document:At(e)?Tt(e)?e:Ke(e)||xr(e)?e.ownerDocument:document:document:document}const ve=ct?l.useLayoutEffect:l.useEffect;function Ot(e){const t=l.useRef(e);return ve(()=>{t.current=e}),l.useCallback(function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return t.current==null?void 0:t.current(...s)},[])}function hn(){const e=l.useRef(null),t=l.useCallback((s,a)=>{e.current=setInterval(s,a)},[]),r=l.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,r]}function Be(e,t){t===void 0&&(t=[e]);const r=l.useRef(e);return ve(()=>{r.current!==e&&(r.current=e)},t),r}function Ye(e,t){const r=l.useRef();return l.useMemo(()=>{const s=e(r.current);return r.current=s,s},[...t])}function st(e){const t=Ot(e),r=l.useRef(null),s=l.useCallback(a=>{a!==r.current&&t?.(a,r.current),r.current=a},[]);return[r,s]}function Dt(e){const t=l.useRef();return l.useEffect(()=>{t.current=e},[e]),t.current}let wt={};function dt(e,t){return l.useMemo(()=>{if(t)return t;const r=wt[e]==null?0:wt[e]+1;return wt[e]=r,e+"-"+r},[e,t])}function pr(e){return function(t){for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];return s.reduce((o,c)=>{const i=Object.entries(c);for(const[u,f]of i){const b=o[u];b!=null&&(o[u]=b+e*f)}return o},{...t})}}const Se=pr(1),We=pr(-1);function fn(e){return"clientX"in e&&"clientY"in e}function mr(e){if(!e)return!1;const{KeyboardEvent:t}=H(e.target);return t&&e instanceof t}function bn(e){if(!e)return!1;const{TouchEvent:t}=H(e.target);return t&&e instanceof t}function St(e){if(bn(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return fn(e)?{x:e.clientX,y:e.clientY}:null}const Et=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[Et.Translate.toString(e),Et.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:s}=e;return t+" "+r+"ms "+s}}}),Vt="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function gn(e){return e.matches(Vt)?e:e.querySelector(Vt)}const xn={display:"none"};function pn(e){let{id:t,value:r}=e;return q.createElement("div",{id:t,style:xn},r)}function mn(e){let{id:t,announcement:r,ariaLiveType:s="assertive"}=e;const a={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return q.createElement("div",{id:t,style:a,role:"status","aria-live":s,"aria-atomic":!0},r)}function vn(){const[e,t]=l.useState("");return{announce:l.useCallback(s=>{s!=null&&t(s)},[]),announcement:e}}const vr=l.createContext(null);function wn(e){const t=l.useContext(vr);l.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function yn(){const[e]=l.useState(()=>new Set),t=l.useCallback(s=>(e.add(s),()=>e.delete(s)),[e]);return[l.useCallback(s=>{let{type:a,event:o}=s;e.forEach(c=>{var i;return(i=c[a])==null?void 0:i.call(c,o)})},[e]),t]}const kn={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Nn={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function jn(e){let{announcements:t=Nn,container:r,hiddenTextDescribedById:s,screenReaderInstructions:a=kn}=e;const{announce:o,announcement:c}=vn(),i=dt("DndLiveRegion"),[u,f]=l.useState(!1);if(l.useEffect(()=>{f(!0)},[]),wn(l.useMemo(()=>({onDragStart(h){let{active:m}=h;o(t.onDragStart({active:m}))},onDragMove(h){let{active:m,over:x}=h;t.onDragMove&&o(t.onDragMove({active:m,over:x}))},onDragOver(h){let{active:m,over:x}=h;o(t.onDragOver({active:m,over:x}))},onDragEnd(h){let{active:m,over:x}=h;o(t.onDragEnd({active:m,over:x}))},onDragCancel(h){let{active:m,over:x}=h;o(t.onDragCancel({active:m,over:x}))}}),[o,t])),!u)return null;const b=q.createElement(q.Fragment,null,q.createElement(pn,{id:s,value:a.draggable}),q.createElement(mn,{id:i,announcement:c}));return r?Le.createPortal(b,r):b}var F;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(F||(F={}));function at(){}function Jt(e,t){return l.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function Cn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return l.useMemo(()=>[...t].filter(s=>s!=null),[...t])}const oe=Object.freeze({x:0,y:0});function wr(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function yr(e,t){let{data:{value:r}}=e,{data:{value:s}}=t;return r-s}function Dn(e,t){let{data:{value:r}}=e,{data:{value:s}}=t;return s-r}function Gt(e){let{left:t,top:r,height:s,width:a}=e;return[{x:t,y:r},{x:t+a,y:r},{x:t,y:r+s},{x:t+a,y:r+s}]}function kr(e,t){if(!e||e.length===0)return null;const[r]=e;return r[t]}function Zt(e,t,r){return t===void 0&&(t=e.left),r===void 0&&(r=e.top),{x:t+e.width*.5,y:r+e.height*.5}}const Sn=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:s}=e;const a=Zt(t,t.left,t.top),o=[];for(const c of s){const{id:i}=c,u=r.get(i);if(u){const f=wr(Zt(u),a);o.push({id:i,data:{droppableContainer:c,value:f}})}}return o.sort(yr)},En=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:s}=e;const a=Gt(t),o=[];for(const c of s){const{id:i}=c,u=r.get(i);if(u){const f=Gt(u),b=a.reduce((m,x,N)=>m+wr(f[N],x),0),h=Number((b/4).toFixed(4));o.push({id:i,data:{droppableContainer:c,value:h}})}}return o.sort(yr)};function Rn(e,t){const r=Math.max(t.top,e.top),s=Math.max(t.left,e.left),a=Math.min(t.left+t.width,e.left+e.width),o=Math.min(t.top+t.height,e.top+e.height),c=a-s,i=o-r;if(s<a&&r<o){const u=t.width*t.height,f=e.width*e.height,b=c*i,h=b/(u+f-b);return Number(h.toFixed(4))}return 0}const Mn=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:s}=e;const a=[];for(const o of s){const{id:c}=o,i=r.get(c);if(i){const u=Rn(i,t);u>0&&a.push({id:c,data:{droppableContainer:o,value:u}})}}return a.sort(Dn)};function _n(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}function Nr(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:oe}function An(e){return function(r){for(var s=arguments.length,a=new Array(s>1?s-1:0),o=1;o<s;o++)a[o-1]=arguments[o];return a.reduce((c,i)=>({...c,top:c.top+e*i.y,bottom:c.bottom+e*i.y,left:c.left+e*i.x,right:c.right+e*i.x}),{...r})}}const Tn=An(1);function On(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function In(e,t,r){const s=On(t);if(!s)return e;const{scaleX:a,scaleY:o,x:c,y:i}=s,u=e.left-c-(1-a)*parseFloat(r),f=e.top-i-(1-o)*parseFloat(r.slice(r.indexOf(" ")+1)),b=a?e.width/a:e.width,h=o?e.height/o:e.height;return{width:b,height:h,top:f,right:u+b,bottom:f+h,left:u}}const Ln={ignoreTransform:!1};function Xe(e,t){t===void 0&&(t=Ln);let r=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:f,transformOrigin:b}=H(e).getComputedStyle(e);f&&(r=In(r,f,b))}const{top:s,left:a,width:o,height:c,bottom:i,right:u}=r;return{top:s,left:a,width:o,height:c,bottom:i,right:u}}function Qt(e){return Xe(e,{ignoreTransform:!0})}function Pn(e){const t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}function zn(e,t){return t===void 0&&(t=H(e).getComputedStyle(e)),t.position==="fixed"}function $n(e,t){t===void 0&&(t=H(e).getComputedStyle(e));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(a=>{const o=t[a];return typeof o=="string"?r.test(o):!1})}function ut(e,t){const r=[];function s(a){if(t!=null&&r.length>=t||!a)return r;if(Tt(a)&&a.scrollingElement!=null&&!r.includes(a.scrollingElement))return r.push(a.scrollingElement),r;if(!Ke(a)||xr(a)||r.includes(a))return r;const o=H(e).getComputedStyle(a);return a!==e&&$n(a,o)&&r.push(a),zn(a,o)?r:s(a.parentNode)}return e?s(e):r}function jr(e){const[t]=ut(e,1);return t??null}function yt(e){return!ct||!e?null:Ee(e)?e:At(e)?Tt(e)||e===Re(e).scrollingElement?window:Ke(e)?e:null:null}function Cr(e){return Ee(e)?e.scrollX:e.scrollLeft}function Dr(e){return Ee(e)?e.scrollY:e.scrollTop}function Rt(e){return{x:Cr(e),y:Dr(e)}}var W;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(W||(W={}));function Sr(e){return!ct||!e?!1:e===document.scrollingElement}function Er(e){const t={x:0,y:0},r=Sr(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},s={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},a=e.scrollTop<=t.y,o=e.scrollLeft<=t.x,c=e.scrollTop>=s.y,i=e.scrollLeft>=s.x;return{isTop:a,isLeft:o,isBottom:c,isRight:i,maxScroll:s,minScroll:t}}const Fn={x:.2,y:.2};function Bn(e,t,r,s,a){let{top:o,left:c,right:i,bottom:u}=r;s===void 0&&(s=10),a===void 0&&(a=Fn);const{isTop:f,isBottom:b,isLeft:h,isRight:m}=Er(e),x={x:0,y:0},N={x:0,y:0},w={height:t.height*a.y,width:t.width*a.x};return!f&&o<=t.top+w.height?(x.y=W.Backward,N.y=s*Math.abs((t.top+w.height-o)/w.height)):!b&&u>=t.bottom-w.height&&(x.y=W.Forward,N.y=s*Math.abs((t.bottom-w.height-u)/w.height)),!m&&i>=t.right-w.width?(x.x=W.Forward,N.x=s*Math.abs((t.right-w.width-i)/w.width)):!h&&c<=t.left+w.width&&(x.x=W.Backward,N.x=s*Math.abs((t.left+w.width-c)/w.width)),{direction:x,speed:N}}function Wn(e){if(e===document.scrollingElement){const{innerWidth:o,innerHeight:c}=window;return{top:0,left:0,right:o,bottom:c,width:o,height:c}}const{top:t,left:r,right:s,bottom:a}=e.getBoundingClientRect();return{top:t,left:r,right:s,bottom:a,width:e.clientWidth,height:e.clientHeight}}function Rr(e){return e.reduce((t,r)=>Se(t,Rt(r)),oe)}function Un(e){return e.reduce((t,r)=>t+Cr(r),0)}function Kn(e){return e.reduce((t,r)=>t+Dr(r),0)}function Yn(e,t){if(t===void 0&&(t=Xe),!e)return;const{top:r,left:s,bottom:a,right:o}=t(e);jr(e)&&(a<=0||o<=0||r>=window.innerHeight||s>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Xn=[["x",["left","right"],Un],["y",["top","bottom"],Kn]];class It{constructor(t,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const s=ut(r),a=Rr(s);this.rect={...t},this.width=t.width,this.height=t.height;for(const[o,c,i]of Xn)for(const u of c)Object.defineProperty(this,u,{get:()=>{const f=i(s),b=a[o]-f;return this.rect[u]+b},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class ze{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var s;return(s=this.target)==null?void 0:s.removeEventListener(...r)})},this.target=t}add(t,r,s){var a;(a=this.target)==null||a.addEventListener(t,r,s),this.listeners.push([t,r,s])}}function qn(e){const{EventTarget:t}=H(e);return e instanceof t?e:Re(e)}function kt(e,t){const r=Math.abs(e.x),s=Math.abs(e.y);return typeof t=="number"?Math.sqrt(r**2+s**2)>t:"x"in t&&"y"in t?r>t.x&&s>t.y:"x"in t?r>t.x:"y"in t?s>t.y:!1}var ne;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(ne||(ne={}));function er(e){e.preventDefault()}function Hn(e){e.stopPropagation()}var j;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(j||(j={}));const Mr={start:[j.Space,j.Enter],cancel:[j.Esc],end:[j.Space,j.Enter,j.Tab]},Vn=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case j.Right:return{...r,x:r.x+25};case j.Left:return{...r,x:r.x-25};case j.Down:return{...r,y:r.y+25};case j.Up:return{...r,y:r.y-25}}};class Lt{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:r}}=t;this.props=t,this.listeners=new ze(Re(r)),this.windowListeners=new ze(H(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(ne.Resize,this.handleCancel),this.windowListeners.add(ne.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(ne.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:r}=this.props,s=t.node.current;s&&Yn(s),r(oe)}handleKeyDown(t){if(mr(t)){const{active:r,context:s,options:a}=this.props,{keyboardCodes:o=Mr,coordinateGetter:c=Vn,scrollBehavior:i="smooth"}=a,{code:u}=t;if(o.end.includes(u)){this.handleEnd(t);return}if(o.cancel.includes(u)){this.handleCancel(t);return}const{collisionRect:f}=s.current,b=f?{x:f.left,y:f.top}:oe;this.referenceCoordinates||(this.referenceCoordinates=b);const h=c(t,{active:r,context:s.current,currentCoordinates:b});if(h){const m=We(h,b),x={x:0,y:0},{scrollableAncestors:N}=s.current;for(const w of N){const y=t.code,{isTop:S,isRight:R,isLeft:C,isBottom:L,maxScroll:_,minScroll:A}=Er(w),D=Wn(w),E={x:Math.min(y===j.Right?D.right-D.width/2:D.right,Math.max(y===j.Right?D.left:D.left+D.width/2,h.x)),y:Math.min(y===j.Down?D.bottom-D.height/2:D.bottom,Math.max(y===j.Down?D.top:D.top+D.height/2,h.y))},T=y===j.Right&&!R||y===j.Left&&!C,B=y===j.Down&&!L||y===j.Up&&!S;if(T&&E.x!==h.x){const z=w.scrollLeft+m.x,P=y===j.Right&&z<=_.x||y===j.Left&&z>=A.x;if(P&&!m.y){w.scrollTo({left:z,behavior:i});return}P?x.x=w.scrollLeft-z:x.x=y===j.Right?w.scrollLeft-_.x:w.scrollLeft-A.x,x.x&&w.scrollBy({left:-x.x,behavior:i});break}else if(B&&E.y!==h.y){const z=w.scrollTop+m.y,P=y===j.Down&&z<=_.y||y===j.Up&&z>=A.y;if(P&&!m.x){w.scrollTo({top:z,behavior:i});return}P?x.y=w.scrollTop-z:x.y=y===j.Down?w.scrollTop-_.y:w.scrollTop-A.y,x.y&&w.scrollBy({top:-x.y,behavior:i});break}}this.handleMove(t,Se(We(h,this.referenceCoordinates),x))}}}handleMove(t,r){const{onMove:s}=this.props;t.preventDefault(),s(r)}handleEnd(t){const{onEnd:r}=this.props;t.preventDefault(),this.detach(),r()}handleCancel(t){const{onCancel:r}=this.props;t.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Lt.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:s=Mr,onActivation:a}=t,{active:o}=r;const{code:c}=e.nativeEvent;if(s.start.includes(c)){const i=o.activatorNode.current;return i&&e.target!==i?!1:(e.preventDefault(),a?.({event:e.nativeEvent}),!0)}return!1}}];function tr(e){return!!(e&&"distance"in e)}function rr(e){return!!(e&&"delay"in e)}class Pt{constructor(t,r,s){var a;s===void 0&&(s=qn(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=r;const{event:o}=t,{target:c}=o;this.props=t,this.events=r,this.document=Re(c),this.documentListeners=new ze(this.document),this.listeners=new ze(s),this.windowListeners=new ze(H(c)),this.initialCoordinates=(a=St(o))!=null?a:oe,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:r,bypassActivationConstraint:s}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(ne.Resize,this.handleCancel),this.windowListeners.add(ne.DragStart,er),this.windowListeners.add(ne.VisibilityChange,this.handleCancel),this.windowListeners.add(ne.ContextMenu,er),this.documentListeners.add(ne.Keydown,this.handleKeydown),r){if(s!=null&&s({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(rr(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(tr(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,r){const{active:s,onPending:a}=this.props;a(s,t,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:t}=this,{onStart:r}=this.props;t&&(this.activated=!0,this.documentListeners.add(ne.Click,Hn,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(ne.SelectionChange,this.removeTextSelection),r(t))}handleMove(t){var r;const{activated:s,initialCoordinates:a,props:o}=this,{onMove:c,options:{activationConstraint:i}}=o;if(!a)return;const u=(r=St(t))!=null?r:oe,f=We(a,u);if(!s&&i){if(tr(i)){if(i.tolerance!=null&&kt(f,i.tolerance))return this.handleCancel();if(kt(f,i.distance))return this.handleStart()}if(rr(i)&&kt(f,i.tolerance))return this.handleCancel();this.handlePending(i,f);return}t.cancelable&&t.preventDefault(),c(u)}handleEnd(){const{onAbort:t,onEnd:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleCancel(){const{onAbort:t,onCancel:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleKeydown(t){t.code===j.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Jn={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class zt extends Pt{constructor(t){const{event:r}=t,s=Re(r.target);super(t,Jn,s)}}zt.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:s}=t;return!r.isPrimary||r.button!==0?!1:(s?.({event:r}),!0)}}];const Gn={move:{name:"mousemove"},end:{name:"mouseup"}};var Mt;(function(e){e[e.RightClick=2]="RightClick"})(Mt||(Mt={}));class Zn extends Pt{constructor(t){super(t,Gn,Re(t.event.target))}}Zn.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:s}=t;return r.button===Mt.RightClick?!1:(s?.({event:r}),!0)}}];const Nt={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Qn extends Pt{constructor(t){super(t,Nt)}static setup(){return window.addEventListener(Nt.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(Nt.move.name,t)};function t(){}}}Qn.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:s}=t;const{touches:a}=r;return a.length>1?!1:(s?.({event:r}),!0)}}];var $e;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})($e||($e={}));var ot;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(ot||(ot={}));function es(e){let{acceleration:t,activator:r=$e.Pointer,canScroll:s,draggingRect:a,enabled:o,interval:c=5,order:i=ot.TreeOrder,pointerCoordinates:u,scrollableAncestors:f,scrollableAncestorRects:b,delta:h,threshold:m}=e;const x=rs({delta:h,disabled:!o}),[N,w]=hn(),y=l.useRef({x:0,y:0}),S=l.useRef({x:0,y:0}),R=l.useMemo(()=>{switch(r){case $e.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case $e.DraggableRect:return a}},[r,a,u]),C=l.useRef(null),L=l.useCallback(()=>{const A=C.current;if(!A)return;const D=y.current.x*S.current.x,E=y.current.y*S.current.y;A.scrollBy(D,E)},[]),_=l.useMemo(()=>i===ot.TreeOrder?[...f].reverse():f,[i,f]);l.useEffect(()=>{if(!o||!f.length||!R){w();return}for(const A of _){if(s?.(A)===!1)continue;const D=f.indexOf(A),E=b[D];if(!E)continue;const{direction:T,speed:B}=Bn(A,E,R,t,m);for(const z of["x","y"])x[z][T[z]]||(B[z]=0,T[z]=0);if(B.x>0||B.y>0){w(),C.current=A,N(L,c),y.current=B,S.current=T;return}}y.current={x:0,y:0},S.current={x:0,y:0},w()},[t,L,s,w,o,c,JSON.stringify(R),JSON.stringify(x),N,f,_,b,JSON.stringify(m)])}const ts={x:{[W.Backward]:!1,[W.Forward]:!1},y:{[W.Backward]:!1,[W.Forward]:!1}};function rs(e){let{delta:t,disabled:r}=e;const s=Dt(t);return Ye(a=>{if(r||!s||!a)return ts;const o={x:Math.sign(t.x-s.x),y:Math.sign(t.y-s.y)};return{x:{[W.Backward]:a.x[W.Backward]||o.x===-1,[W.Forward]:a.x[W.Forward]||o.x===1},y:{[W.Backward]:a.y[W.Backward]||o.y===-1,[W.Forward]:a.y[W.Forward]||o.y===1}}},[r,t,s])}function ns(e,t){const r=t!=null?e.get(t):void 0,s=r?r.node.current:null;return Ye(a=>{var o;return t==null?null:(o=s??a)!=null?o:null},[s,t])}function ss(e,t){return l.useMemo(()=>e.reduce((r,s)=>{const{sensor:a}=s,o=a.activators.map(c=>({eventName:c.eventName,handler:t(c.handler,s)}));return[...r,...o]},[]),[e,t])}var Ue;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Ue||(Ue={}));var _t;(function(e){e.Optimized="optimized"})(_t||(_t={}));const nr=new Map;function as(e,t){let{dragging:r,dependencies:s,config:a}=t;const[o,c]=l.useState(null),{frequency:i,measure:u,strategy:f}=a,b=l.useRef(e),h=y(),m=Be(h),x=l.useCallback(function(S){S===void 0&&(S=[]),!m.current&&c(R=>R===null?S:R.concat(S.filter(C=>!R.includes(C))))},[m]),N=l.useRef(null),w=Ye(S=>{if(h&&!r)return nr;if(!S||S===nr||b.current!==e||o!=null){const R=new Map;for(let C of e){if(!C)continue;if(o&&o.length>0&&!o.includes(C.id)&&C.rect.current){R.set(C.id,C.rect.current);continue}const L=C.node.current,_=L?new It(u(L),L):null;C.rect.current=_,_&&R.set(C.id,_)}return R}return S},[e,o,r,h,u]);return l.useEffect(()=>{b.current=e},[e]),l.useEffect(()=>{h||x()},[r,h]),l.useEffect(()=>{o&&o.length>0&&c(null)},[JSON.stringify(o)]),l.useEffect(()=>{h||typeof i!="number"||N.current!==null||(N.current=setTimeout(()=>{x(),N.current=null},i))},[i,h,x,...s]),{droppableRects:w,measureDroppableContainers:x,measuringScheduled:o!=null};function y(){switch(f){case Ue.Always:return!1;case Ue.BeforeDragging:return r;default:return!r}}}function _r(e,t){return Ye(r=>e?r||(typeof t=="function"?t(e):e):null,[t,e])}function os(e,t){return _r(e,t)}function ls(e){let{callback:t,disabled:r}=e;const s=Ot(t),a=l.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(s)},[s,r]);return l.useEffect(()=>()=>a?.disconnect(),[a]),a}function ht(e){let{callback:t,disabled:r}=e;const s=Ot(t),a=l.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(s)},[r]);return l.useEffect(()=>()=>a?.disconnect(),[a]),a}function is(e){return new It(Xe(e),e)}function sr(e,t,r){t===void 0&&(t=is);const[s,a]=l.useState(null);function o(){a(u=>{if(!e)return null;if(e.isConnected===!1){var f;return(f=u??r)!=null?f:null}const b=t(e);return JSON.stringify(u)===JSON.stringify(b)?u:b})}const c=ls({callback(u){if(e)for(const f of u){const{type:b,target:h}=f;if(b==="childList"&&h instanceof HTMLElement&&h.contains(e)){o();break}}}}),i=ht({callback:o});return ve(()=>{o(),e?(i?.observe(e),c?.observe(document.body,{childList:!0,subtree:!0})):(i?.disconnect(),c?.disconnect())},[e]),s}function cs(e){const t=_r(e);return Nr(e,t)}const ar=[];function ds(e){const t=l.useRef(e),r=Ye(s=>e?s&&s!==ar&&e&&t.current&&e.parentNode===t.current.parentNode?s:ut(e):ar,[e]);return l.useEffect(()=>{t.current=e},[e]),r}function us(e){const[t,r]=l.useState(null),s=l.useRef(e),a=l.useCallback(o=>{const c=yt(o.target);c&&r(i=>i?(i.set(c,Rt(c)),new Map(i)):null)},[]);return l.useEffect(()=>{const o=s.current;if(e!==o){c(o);const i=e.map(u=>{const f=yt(u);return f?(f.addEventListener("scroll",a,{passive:!0}),[f,Rt(f)]):null}).filter(u=>u!=null);r(i.length?new Map(i):null),s.current=e}return()=>{c(e),c(o)};function c(i){i.forEach(u=>{const f=yt(u);f?.removeEventListener("scroll",a)})}},[a,e]),l.useMemo(()=>e.length?t?Array.from(t.values()).reduce((o,c)=>Se(o,c),oe):Rr(e):oe,[e,t])}function or(e,t){t===void 0&&(t=[]);const r=l.useRef(null);return l.useEffect(()=>{r.current=null},t),l.useEffect(()=>{const s=e!==oe;s&&!r.current&&(r.current=e),!s&&r.current&&(r.current=null)},[e]),r.current?We(e,r.current):oe}function hs(e){l.useEffect(()=>{if(!ct)return;const t=e.map(r=>{let{sensor:s}=r;return s.setup==null?void 0:s.setup()});return()=>{for(const r of t)r?.()}},e.map(t=>{let{sensor:r}=t;return r}))}function fs(e,t){return l.useMemo(()=>e.reduce((r,s)=>{let{eventName:a,handler:o}=s;return r[a]=c=>{o(c,t)},r},{}),[e,t])}function Ar(e){return l.useMemo(()=>e?Pn(e):null,[e])}const lr=[];function bs(e,t){t===void 0&&(t=Xe);const[r]=e,s=Ar(r?H(r):null),[a,o]=l.useState(lr);function c(){o(()=>e.length?e.map(u=>Sr(u)?s:new It(t(u),u)):lr)}const i=ht({callback:c});return ve(()=>{i?.disconnect(),c(),e.forEach(u=>i?.observe(u))},[e]),a}function gs(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Ke(t)?t:e}function xs(e){let{measure:t}=e;const[r,s]=l.useState(null),a=l.useCallback(f=>{for(const{target:b}of f)if(Ke(b)){s(h=>{const m=t(b);return h?{...h,width:m.width,height:m.height}:m});break}},[t]),o=ht({callback:a}),c=l.useCallback(f=>{const b=gs(f);o?.disconnect(),b&&o?.observe(b),s(b?t(b):null)},[t,o]),[i,u]=st(c);return l.useMemo(()=>({nodeRef:i,rect:r,setRef:u}),[r,i,u])}const ps=[{sensor:zt,options:{}},{sensor:Lt,options:{}}],ms={current:{}},nt={draggable:{measure:Qt},droppable:{measure:Qt,strategy:Ue.WhileDragging,frequency:_t.Optimized},dragOverlay:{measure:Xe}};class Fe extends Map{get(t){var r;return t!=null&&(r=super.get(t))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:r}=t;return!r})}getNodeFor(t){var r,s;return(r=(s=this.get(t))==null?void 0:s.node.current)!=null?r:void 0}}const vs={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Fe,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:at},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:nt,measureDroppableContainers:at,windowRect:null,measuringScheduled:!1},ws={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:at,draggableNodes:new Map,over:null,measureDroppableContainers:at},ft=l.createContext(ws),ys=l.createContext(vs);function ks(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Fe}}}function Ns(e,t){switch(t.type){case F.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case F.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case F.DragEnd:case F.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case F.RegisterDroppable:{const{element:r}=t,{id:s}=r,a=new Fe(e.droppable.containers);return a.set(s,r),{...e,droppable:{...e.droppable,containers:a}}}case F.SetDroppableDisabled:{const{id:r,key:s,disabled:a}=t,o=e.droppable.containers.get(r);if(!o||s!==o.key)return e;const c=new Fe(e.droppable.containers);return c.set(r,{...o,disabled:a}),{...e,droppable:{...e.droppable,containers:c}}}case F.UnregisterDroppable:{const{id:r,key:s}=t,a=e.droppable.containers.get(r);if(!a||s!==a.key)return e;const o=new Fe(e.droppable.containers);return o.delete(r),{...e,droppable:{...e.droppable,containers:o}}}default:return e}}function js(e){let{disabled:t}=e;const{active:r,activatorEvent:s,draggableNodes:a}=l.useContext(ft),o=Dt(s),c=Dt(r?.id);return l.useEffect(()=>{if(!t&&!s&&o&&c!=null){if(!mr(o)||document.activeElement===o.target)return;const i=a.get(c);if(!i)return;const{activatorNode:u,node:f}=i;if(!u.current&&!f.current)return;requestAnimationFrame(()=>{for(const b of[u.current,f.current]){if(!b)continue;const h=gn(b);if(h){h.focus();break}}})}},[s,t,a,c,o]),null}function Cs(e,t){let{transform:r,...s}=t;return e!=null&&e.length?e.reduce((a,o)=>o({transform:a,...s}),r):r}function Ds(e){return l.useMemo(()=>({draggable:{...nt.draggable,...e?.draggable},droppable:{...nt.droppable,...e?.droppable},dragOverlay:{...nt.dragOverlay,...e?.dragOverlay}}),[e?.draggable,e?.droppable,e?.dragOverlay])}function Ss(e){let{activeNode:t,measure:r,initialRect:s,config:a=!0}=e;const o=l.useRef(!1),{x:c,y:i}=typeof a=="boolean"?{x:a,y:a}:a;ve(()=>{if(!c&&!i||!t){o.current=!1;return}if(o.current||!s)return;const f=t?.node.current;if(!f||f.isConnected===!1)return;const b=r(f),h=Nr(b,s);if(c||(h.x=0),i||(h.y=0),o.current=!0,Math.abs(h.x)>0||Math.abs(h.y)>0){const m=jr(f);m&&m.scrollBy({top:h.y,left:h.x})}},[t,c,i,s,r])}const Tr=l.createContext({...oe,scaleX:1,scaleY:1});var me;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(me||(me={}));const Es=l.memo(function(t){var r,s,a,o;let{id:c,accessibility:i,autoScroll:u=!0,children:f,sensors:b=ps,collisionDetection:h=Mn,measuring:m,modifiers:x,...N}=t;const w=l.useReducer(Ns,void 0,ks),[y,S]=w,[R,C]=yn(),[L,_]=l.useState(me.Uninitialized),A=L===me.Initialized,{draggable:{active:D,nodes:E,translate:T},droppable:{containers:B}}=y,z=D!=null?E.get(D):null,P=l.useRef({initial:null,translated:null}),Q=l.useMemo(()=>{var K;return D!=null?{id:D,data:(K=z?.data)!=null?K:ms,rect:P}:null},[D,z]),le=l.useRef(null),[He,se]=l.useState(null),[ae,Me]=l.useState(null),g=Be(N,Object.values(N)),$=dt("DndDescribedBy",c),_e=l.useMemo(()=>B.getEnabled(),[B]),ee=Ds(m),{droppableRects:fe,measureDroppableContainers:we,measuringScheduled:Ve}=as(_e,{dragging:A,dependencies:[T.x,T.y],config:ee.droppable}),Y=ns(E,D),Je=l.useMemo(()=>ae?St(ae):null,[ae]),Ge=Wr(),Ze=os(Y,ee.draggable.measure);Ss({activeNode:D!=null?E.get(D):null,config:Ge.layoutShiftCompensation,initialRect:Ze,measure:ee.draggable.measure});const V=sr(Y,ee.draggable.measure,Ze),Ne=sr(Y?Y.parentElement:null),ue=l.useRef({activatorEvent:null,active:null,activeNode:Y,collisionRect:null,collisions:null,droppableRects:fe,draggableNodes:E,draggingNode:null,draggingNodeRect:null,droppableContainers:B,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),d=B.getNodeFor((r=ue.current.over)==null?void 0:r.id),p=xs({measure:ee.dragOverlay.measure}),v=(s=p.nodeRef.current)!=null?s:Y,k=A?(a=p.rect)!=null?a:V:null,O=!!(p.nodeRef.current&&p.rect),M=cs(O?null:V),I=Ar(v?H(v):null),te=ds(A?d??Y:null),X=bs(te),Qe=Cs(x,{transform:{x:T.x-M.x,y:T.y-M.y,scaleX:1,scaleY:1},activatorEvent:ae,active:Q,activeNodeRect:V,containerNodeRect:Ne,draggingNodeRect:k,over:ue.current.over,overlayNodeRect:p.rect,scrollableAncestors:te,scrollableAncestorRects:X,windowRect:I}),$t=Je?Se(Je,T):null,Ft=us(te),Ir=or(Ft),Lr=or(Ft,[V]),je=Se(Qe,Ir),Ce=k?Tn(k,Qe):null,Ae=Q&&Ce?h({active:Q,collisionRect:Ce,droppableRects:fe,droppableContainers:_e,pointerCoordinates:$t}):null,Bt=kr(Ae,"id"),[be,Wt]=l.useState(null),Pr=O?Qe:Se(Qe,Lr),zr=_n(Pr,(o=be?.rect)!=null?o:null,V),bt=l.useRef(null),Ut=l.useCallback((K,J)=>{let{sensor:G,options:ge}=J;if(le.current==null)return;const re=E.get(le.current);if(!re)return;const Z=K.nativeEvent,ie=new G({active:le.current,activeNode:re,event:Z,options:ge,context:ue,onAbort(U){if(!E.get(U))return;const{onDragAbort:ce}=g.current,he={id:U};ce?.(he),R({type:"onDragAbort",event:he})},onPending(U,xe,ce,he){if(!E.get(U))return;const{onDragPending:Oe}=g.current,pe={id:U,constraint:xe,initialCoordinates:ce,offset:he};Oe?.(pe),R({type:"onDragPending",event:pe})},onStart(U){const xe=le.current;if(xe==null)return;const ce=E.get(xe);if(!ce)return;const{onDragStart:he}=g.current,Te={activatorEvent:Z,active:{id:xe,data:ce.data,rect:P}};Le.unstable_batchedUpdates(()=>{he?.(Te),_(me.Initializing),S({type:F.DragStart,initialCoordinates:U,active:xe}),R({type:"onDragStart",event:Te}),se(bt.current),Me(Z)})},onMove(U){S({type:F.DragMove,coordinates:U})},onEnd:De(F.DragEnd),onCancel:De(F.DragCancel)});bt.current=ie;function De(U){return async function(){const{active:ce,collisions:he,over:Te,scrollAdjustedTranslate:Oe}=ue.current;let pe=null;if(ce&&Oe){const{cancelDrop:Ie}=g.current;pe={activatorEvent:Z,active:ce,collisions:he,delta:Oe,over:Te},U===F.DragEnd&&typeof Ie=="function"&&await Promise.resolve(Ie(pe))&&(U=F.DragCancel)}le.current=null,Le.unstable_batchedUpdates(()=>{S({type:U}),_(me.Uninitialized),Wt(null),se(null),Me(null),bt.current=null;const Ie=U===F.DragEnd?"onDragEnd":"onDragCancel";if(pe){const gt=g.current[Ie];gt?.(pe),R({type:Ie,event:pe})}})}}},[E]),$r=l.useCallback((K,J)=>(G,ge)=>{const re=G.nativeEvent,Z=E.get(ge);if(le.current!==null||!Z||re.dndKit||re.defaultPrevented)return;const ie={active:Z};K(G,J.options,ie)===!0&&(re.dndKit={capturedBy:J.sensor},le.current=ge,Ut(G,J))},[E,Ut]),Kt=ss(b,$r);hs(b),ve(()=>{V&&L===me.Initializing&&_(me.Initialized)},[V,L]),l.useEffect(()=>{const{onDragMove:K}=g.current,{active:J,activatorEvent:G,collisions:ge,over:re}=ue.current;if(!J||!G)return;const Z={active:J,activatorEvent:G,collisions:ge,delta:{x:je.x,y:je.y},over:re};Le.unstable_batchedUpdates(()=>{K?.(Z),R({type:"onDragMove",event:Z})})},[je.x,je.y]),l.useEffect(()=>{const{active:K,activatorEvent:J,collisions:G,droppableContainers:ge,scrollAdjustedTranslate:re}=ue.current;if(!K||le.current==null||!J||!re)return;const{onDragOver:Z}=g.current,ie=ge.get(Bt),De=ie&&ie.rect.current?{id:ie.id,rect:ie.rect.current,data:ie.data,disabled:ie.disabled}:null,U={active:K,activatorEvent:J,collisions:G,delta:{x:re.x,y:re.y},over:De};Le.unstable_batchedUpdates(()=>{Wt(De),Z?.(U),R({type:"onDragOver",event:U})})},[Bt]),ve(()=>{ue.current={activatorEvent:ae,active:Q,activeNode:Y,collisionRect:Ce,collisions:Ae,droppableRects:fe,draggableNodes:E,draggingNode:v,draggingNodeRect:k,droppableContainers:B,over:be,scrollableAncestors:te,scrollAdjustedTranslate:je},P.current={initial:k,translated:Ce}},[Q,Y,Ae,Ce,E,v,k,fe,B,be,te,je]),es({...Ge,delta:T,draggingRect:Ce,pointerCoordinates:$t,scrollableAncestors:te,scrollableAncestorRects:X});const Fr=l.useMemo(()=>({active:Q,activeNode:Y,activeNodeRect:V,activatorEvent:ae,collisions:Ae,containerNodeRect:Ne,dragOverlay:p,draggableNodes:E,droppableContainers:B,droppableRects:fe,over:be,measureDroppableContainers:we,scrollableAncestors:te,scrollableAncestorRects:X,measuringConfiguration:ee,measuringScheduled:Ve,windowRect:I}),[Q,Y,V,ae,Ae,Ne,p,E,B,fe,be,we,te,X,ee,Ve,I]),Br=l.useMemo(()=>({activatorEvent:ae,activators:Kt,active:Q,activeNodeRect:V,ariaDescribedById:{draggable:$},dispatch:S,draggableNodes:E,over:be,measureDroppableContainers:we}),[ae,Kt,Q,V,S,$,E,be,we]);return q.createElement(vr.Provider,{value:C},q.createElement(ft.Provider,{value:Br},q.createElement(ys.Provider,{value:Fr},q.createElement(Tr.Provider,{value:zr},f)),q.createElement(js,{disabled:i?.restoreFocus===!1})),q.createElement(jn,{...i,hiddenTextDescribedById:$}));function Wr(){const K=He?.autoScrollEnabled===!1,J=typeof u=="object"?u.enabled===!1:u===!1,G=A&&!K&&!J;return typeof u=="object"?{...u,enabled:G}:{enabled:G}}}),Rs=l.createContext(null),ir="button",Ms="Draggable";function _s(e){let{id:t,data:r,disabled:s=!1,attributes:a}=e;const o=dt(Ms),{activators:c,activatorEvent:i,active:u,activeNodeRect:f,ariaDescribedById:b,draggableNodes:h,over:m}=l.useContext(ft),{role:x=ir,roleDescription:N="draggable",tabIndex:w=0}=a??{},y=u?.id===t,S=l.useContext(y?Tr:Rs),[R,C]=st(),[L,_]=st(),A=fs(c,t),D=Be(r);ve(()=>(h.set(t,{id:t,key:o,node:R,activatorNode:L,data:D}),()=>{const T=h.get(t);T&&T.key===o&&h.delete(t)}),[h,t]);const E=l.useMemo(()=>({role:x,tabIndex:w,"aria-disabled":s,"aria-pressed":y&&x===ir?!0:void 0,"aria-roledescription":N,"aria-describedby":b.draggable}),[s,x,w,y,N,b.draggable]);return{active:u,activatorEvent:i,activeNodeRect:f,attributes:E,isDragging:y,listeners:s?void 0:A,node:R,over:m,setNodeRef:C,setActivatorNodeRef:_,transform:S}}const As="Droppable",Ts={timeout:25};function Os(e){let{data:t,disabled:r=!1,id:s,resizeObserverConfig:a}=e;const o=dt(As),{active:c,dispatch:i,over:u,measureDroppableContainers:f}=l.useContext(ft),b=l.useRef({disabled:r}),h=l.useRef(!1),m=l.useRef(null),x=l.useRef(null),{disabled:N,updateMeasurementsFor:w,timeout:y}={...Ts,...a},S=Be(w??s),R=l.useCallback(()=>{if(!h.current){h.current=!0;return}x.current!=null&&clearTimeout(x.current),x.current=setTimeout(()=>{f(Array.isArray(S.current)?S.current:[S.current]),x.current=null},y)},[y]),C=ht({callback:R,disabled:N||!c}),L=l.useCallback((E,T)=>{C&&(T&&(C.unobserve(T),h.current=!1),E&&C.observe(E))},[C]),[_,A]=st(L),D=Be(t);return l.useEffect(()=>{!C||!_.current||(C.disconnect(),h.current=!1,C.observe(_.current))},[_,C]),l.useEffect(()=>(i({type:F.RegisterDroppable,element:{id:s,key:o,disabled:r,node:_,rect:m,data:D}}),()=>i({type:F.UnregisterDroppable,key:o,id:s})),[s]),l.useEffect(()=>{r!==b.current.disabled&&(i({type:F.SetDroppableDisabled,id:s,key:o,disabled:r}),b.current.disabled=r)},[s,o,r,i]),{active:c,rect:m,isOver:u?.id===s,node:_,over:u,setNodeRef:A}}function cr(e,t,r){const s=e.slice();return s.splice(r<0?s.length+r:r,0,s.splice(t,1)[0]),s}function lt(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const Is=[j.Down,j.Right,j.Up,j.Left],Ls=(e,t)=>{let{context:{active:r,collisionRect:s,droppableRects:a,droppableContainers:o,over:c,scrollableAncestors:i}}=t;if(Is.includes(e.code)){if(e.preventDefault(),!r||!s)return;const u=[];o.getEnabled().forEach(h=>{if(!h||h!=null&&h.disabled)return;const m=a.get(h.id);if(m)switch(e.code){case j.Down:s.top<m.top&&u.push(h);break;case j.Up:s.top>m.top&&u.push(h);break;case j.Left:s.left>m.left&&u.push(h);break;case j.Right:s.left<m.left&&u.push(h);break}});const f=En({collisionRect:s,droppableRects:a,droppableContainers:u});let b=kr(f,"id");if(b===c?.id&&f.length>1&&(b=f[1].id),b!=null){const h=o.get(r.id),m=o.get(b),x=m?a.get(m.id):null,N=m?.node.current;if(N&&x&&h&&m){const y=ut(N).some((A,D)=>i[D]!==A),S=Or(h,m),R=Ps(h,m),C=y||!S?{x:0,y:0}:{x:R?s.width-x.width:0,y:R?s.height-x.height:0},L={x:x.left,y:x.top};return C.x&&C.y?L:We(L,C)}}}};function Or(e,t){return!lt(e)||!lt(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function Ps(e,t){return!lt(e)||!lt(t)||!Or(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const zs={blue:"text-blue-600 bg-blue-50 dark:bg-blue-900/20 dark:text-blue-400",emerald:"text-emerald-600 bg-emerald-50 dark:bg-emerald-900/20 dark:text-emerald-400",rose:"text-rose-600 bg-rose-50 dark:bg-rose-900/20 dark:text-rose-400",amber:"text-amber-600 bg-amber-50 dark:bg-amber-900/20 dark:text-amber-400",indigo:"text-indigo-600 bg-indigo-50 dark:bg-indigo-900/20 dark:text-indigo-400",slate:"text-slate-600 bg-slate-50 dark:bg-slate-900/20 dark:text-slate-400"},qe=({title:e,icon:t,iconColor:r="blue",children:s,onRemove:a,onClick:o,targetView:c,footerLeft:i,footerRight:u,className:f,backgroundIcon:b})=>{const{t:h}=ke(),m=it(),x=i||u||c,N=i||(c&&!u?n.jsxs("button",{onClick:w=>{w.stopPropagation(),m(c)},className:"flex items-center gap-1.5 text-[10px] font-black text-slate-400 hover:text-blue-600 uppercase tracking-widest transition-colors group/footer",children:[h("common.open_details"),n.jsx(Hr,{className:"w-3 h-3 transition-transform group-hover/footer:translate-x-0.5"})]}):null);return n.jsxs("div",{className:Yt("group relative flex flex-col bg-white dark:bg-slate-800 rounded-xl border border-slate-300 dark:border-slate-700/50 shadow-sm hover:shadow-xl hover:shadow-slate-200/50 dark:hover:shadow-none transition-all duration-500 overflow-hidden h-full",o&&"cursor-pointer active:scale-[0.98]",f),children:[b&&n.jsx("div",{className:"absolute -right-8 -bottom-8 text-slate-50/50 dark:text-slate-900/20 group-hover:text-slate-100/50 dark:group-hover:text-slate-900/40 transition-colors duration-500",children:n.jsx(b,{size:160,strokeWidth:1})}),n.jsxs("div",{className:"relative flex items-center justify-between pt-2.5 pb-2.5 px-5 bg-slate-50/50 dark:bg-slate-900/20 border-b border-slate-200 dark:border-slate-800/50",children:[n.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[n.jsx("div",{className:Yt("p-1.5 rounded-xl shrink-0 shadow-sm",zs[r]),children:n.jsx(t,{className:"w-4 h-4"})}),n.jsxs("div",{className:"min-w-0",children:[n.jsx("h3",{className:"text-xs font-bold leading-snug text-slate-800 dark:text-white truncate tracking-tight",children:e}),n.jsx("div",{className:"h-0.5 w-4 bg-slate-200 dark:bg-slate-700 rounded-full mt-0.5 group-hover:w-8 transition-all duration-500"})]})]}),n.jsx("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-all duration-300 translate-x-2 group-hover:translate-x-0",children:a&&n.jsx("button",{onClick:w=>{w.stopPropagation(),a()},className:"p-1 text-slate-400 hover:text-rose-600 hover:bg-rose-50 dark:hover:bg-rose-900/20 rounded-lg transition-colors",title:h("common.remove"),children:n.jsx(fr,{className:"w-3.5 h-3.5"})})})]}),n.jsx("div",{className:"relative flex-1 p-4 px-5 pt-2 min-h-0",onClick:o,children:s}),x&&n.jsxs("div",{className:"relative p-3 px-5 border-t border-slate-200 dark:border-slate-800/50 bg-slate-50/50 dark:bg-slate-900/30 flex items-center justify-between min-h-[40px]",children:[n.jsx("div",{className:"flex-1 min-w-0",children:N}),n.jsx("div",{className:"shrink-0",children:u})]}),n.jsx("div",{className:"absolute inset-0 pointer-events-none border border-transparent group-hover:border-blue-500/10 dark:group-hover:border-blue-400/10 rounded-xl transition-colors"})]})},$s=({onRemove:e,dragHandleProps:t,onClick:r,targetView:s})=>{const{t:a,i18n:o}=ke(),[c,i]=l.useState(new Date);l.useEffect(()=>{const h=setInterval(()=>i(new Date),1e3);return()=>clearInterval(h)},[]);const u=l.useMemo(()=>new Intl.DateTimeFormat(o.language==="de"?"de-DE":"en-US",{weekday:"long",day:"2-digit",month:"long"}).format(c),[c,o.language]),f=c.toLocaleTimeString(o.language==="de"?"de-DE":"en-US",{hour:"2-digit",minute:"2-digit"});return n.jsx(qe,{title:a("widgets.clock.title"),icon:Ct,iconColor:"indigo",onRemove:e,dragHandleProps:t,onClick:r,targetView:s,backgroundIcon:Ct,children:n.jsx("div",{className:"flex flex-col h-full items-center justify-center -mt-2",children:n.jsxs("div",{className:"text-center group-hover:scale-110 transition-transform duration-700",children:[n.jsxs("div",{className:"flex items-baseline justify-center gap-1.5",children:[n.jsx("span",{className:"text-6xl font-black text-slate-900 dark:text-white tracking-tighter tabular-nums leading-none",children:f}),n.jsx("span",{className:"text-xs font-black text-indigo-500/80 dark:text-indigo-400/80 uppercase tracking-widest tabular-nums",children:"CET"})]}),n.jsxs("div",{className:"mt-4 flex flex-col items-center",children:[n.jsx("div",{className:"h-px w-8 bg-slate-100 dark:bg-slate-800 mb-4"}),n.jsxs("div",{className:"flex items-center gap-2 px-4 py-1.5 bg-slate-50 dark:bg-slate-900/40 rounded-2xl border border-slate-100 dark:border-slate-800/50",children:[n.jsx(Vr,{className:"w-3.5 h-3.5 text-slate-400 flex-shrink-0"}),n.jsx("span",{className:"text-xs font-bold text-slate-600 dark:text-slate-300 tracking-tight whitespace-nowrap",children:u})]})]})]})})})},Fs=({className:e=""})=>n.jsx("div",{className:`animate-shimmer bg-slate-100 dark:bg-slate-800 rounded ${e}`}),Bs=({onRemove:e,dragHandleProps:t,onClick:r,targetView:s})=>{const{t:a}=ke(),o=it(),{data:c,loading:i,error:u}=ur(()=>de.getDatabaseStats(),[],{cacheKey:"db-stats-tile",ttl:600*1e3});if(u)return n.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-red-200 dark:border-red-900/50 p-4 h-full flex items-center justify-center text-center",children:n.jsx("p",{className:"text-red-500 font-bold text-[10px] uppercase",children:a("common.error")})});const f=()=>{r&&r(),o("/inspector")};return n.jsx(qe,{title:a("widgets.data_inspector.title"),icon:et,iconColor:"indigo",onClick:r||f,onRemove:e,targetView:s,dragHandleProps:t,backgroundIcon:et,className:"cursor-pointer",footerLeft:n.jsxs("button",{onClick:b=>{b.stopPropagation(),o("/inspector")},className:"flex items-center gap-1.5 text-[10px] font-black text-slate-400 hover:text-indigo-600 uppercase tracking-widest transition-colors group/footer",children:[a("widgets.data_inspector.details"),n.jsx(et,{className:"w-3 h-3 transition-transform group-hover/footer:scale-110"})]}),children:n.jsxs("div",{className:"flex flex-col h-full items-center justify-around py-2",children:[n.jsxs("div",{className:"text-center group-hover:scale-105 transition-transform duration-500",children:[n.jsxs("div",{className:"flex items-center justify-center gap-1.5 text-[10px] font-black text-indigo-600 dark:text-indigo-400 uppercase tracking-widest mb-1",children:[n.jsx(Jr,{className:"w-3 h-3"}),n.jsx("span",{children:a("widgets.data_inspector.records_total")})]}),n.jsx("div",{className:"text-4xl font-black text-slate-900 dark:text-white tracking-tighter tabular-nums leading-none",children:i||!c?n.jsx(Fs,{className:"h-8 w-20 mx-auto"}):c.records.toLocaleString()})]}),n.jsxs("div",{className:"w-full pt-4 border-t border-slate-200 dark:border-slate-800/50 text-center",children:[n.jsxs("div",{className:"flex items-center justify-center gap-1.5 text-[10px] font-black text-indigo-500 dark:text-indigo-400 uppercase tracking-widest mb-1",children:[n.jsx(Pe,{className:"w-3 h-3"}),n.jsx("span",{children:a("widgets.data_inspector.tables")})]}),n.jsx("div",{className:"text-2xl font-black text-slate-700 dark:text-slate-300 tabular-nums leading-none",children:i||!c?"...":c.tables})]})]})})},Ws=({onRemove:e,dragHandleProps:t,onClick:r,targetView:s})=>{const{t:a}=ke(),[o,c]=l.useState(!1),[i,u]=l.useState(null),[f,b]=l.useState(null);q.useEffect(()=>{const m=performance.getEntriesByType("navigation")[0];m&&b(Math.round(m.duration));const x=()=>{const w=performance;if(w.memory){const y=w.memory;u({used:Math.round(y.usedJSHeapSize/1024/1024),total:Math.round(y.jsHeapSizeLimit/1024/1024)})}};x();const N=setInterval(x,5e3);return()=>clearInterval(N)},[]);const h=()=>{c(!0),r&&r()};return n.jsxs(n.Fragment,{children:[n.jsx(qe,{title:a("widgets.system_status.title"),icon:tt,iconColor:"emerald",onRemove:e,dragHandleProps:t,onClick:h,targetView:s,backgroundIcon:tt,className:"cursor-pointer",footerLeft:n.jsxs("button",{onClick:m=>{m.stopPropagation(),c(!0)},className:"flex items-center gap-1.5 text-[10px] font-black text-slate-400 hover:text-blue-600 uppercase tracking-widest transition-colors group/footer",children:[a("widgets.system_status.details"),n.jsx(tt,{className:"w-3 h-3 transition-transform group-hover/footer:scale-110"})]}),children:n.jsxs("div",{className:"flex flex-col h-full items-center justify-around py-2",children:[n.jsxs("div",{className:"text-center group-hover:scale-105 transition-transform duration-500",children:[n.jsxs("div",{className:"flex items-center justify-center gap-1.5 text-[10px] font-black text-emerald-600 dark:text-emerald-400 uppercase tracking-widest mb-1",children:[n.jsx(Gr,{className:"w-3 h-3"}),n.jsx("span",{children:a("widgets.system_status.memory_usage")})]}),n.jsx("div",{className:"text-4xl font-black text-slate-900 dark:text-white tracking-tighter tabular-nums leading-none",children:i?`${i.used} MB`:"---"}),n.jsx("div",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-tighter mt-1",children:a("widgets.system_status.heap_from",{total:i?i.total:"---"})})]}),n.jsxs("div",{className:"w-full pt-4 border-t border-slate-200 dark:border-slate-800/50 text-center",children:[n.jsxs("div",{className:"flex items-center justify-center gap-1.5 text-[10px] font-black text-blue-500 dark:text-blue-400 uppercase tracking-widest mb-1",children:[n.jsx(Zr,{className:"w-3 h-3"}),n.jsx("span",{children:a("widgets.system_status.load_time")})]}),n.jsx("div",{className:"text-2xl font-black text-slate-700 dark:text-slate-300 tabular-nums leading-none",children:f?`${f} ms`:"---"})]})]})}),n.jsx(Ur,{isOpen:o,onClose:()=>c(!1)})]})},Us=({onRemove:e,dragHandleProps:t,onClick:r,targetView:s,isOverlay:a})=>{const{t:o,i18n:c}=ke(),i=it(),{lastBackup:u,changeCount:f,isBackupRecommended:b}=un(),h=x=>x?x.toLocaleString(c.language==="de"?"de-DE":"en-US",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):o("widgets.database_status.never"),m=x=>{x.stopPropagation(),i("/datasource")};return n.jsx(qe,{title:o("widgets.database_status.title"),icon:Pe,iconColor:b?"amber":"emerald",onRemove:e,dragHandleProps:t,onClick:r,targetView:s,backgroundIcon:Pe,className:a?"opacity-90":"",footerLeft:n.jsxs("button",{onClick:m,className:"flex items-center gap-1.5 text-[10px] font-black text-slate-400 hover:text-blue-600 uppercase tracking-widest transition-colors group/footer",children:[o("widgets.database_status.data_management"),n.jsx(gr,{className:"w-3 h-3 transition-transform group-hover/footer:rotate-90"})]}),children:n.jsxs("div",{className:"flex flex-col h-full items-center justify-around py-2",children:[n.jsxs("div",{className:"text-center",children:[n.jsxs("div",{className:"flex items-center justify-center gap-1.5 text-[10px] font-black text-slate-500 dark:text-slate-400 uppercase tracking-widest mb-1",children:[n.jsx(Qr,{className:"w-3 h-3"}),n.jsx("span",{children:o("widgets.database_status.last_backup")})]}),n.jsx("div",{className:"text-xl font-black text-slate-900 dark:text-white tracking-tight tabular-nums leading-none",children:h(u)})]}),n.jsxs("div",{className:"w-full pt-4 border-t border-slate-100 dark:border-slate-800/50 text-center",children:[n.jsxs("div",{className:`flex items-center justify-center gap-1.5 text-[10px] font-black uppercase tracking-widest mb-1 ${b?"text-amber-600 dark:text-amber-400":"text-emerald-600 dark:text-emerald-400"}`,children:[b?n.jsx(br,{className:"w-3 h-3"}):n.jsx(Pe,{className:"w-3 h-3"}),n.jsx("span",{children:o("widgets.database_status.modifications")})]}),n.jsx("div",{className:`text-4xl font-black tabular-nums leading-none tracking-tighter ${b?"text-amber-600 dark:text-amber-400":"text-slate-900 dark:text-white"}`,children:f}),n.jsx("div",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-tighter mt-1",children:o("widgets.database_status.records_since_backup")})]})]})})},Ks=hr("WorklistComponent"),Ys=({onRemove:e,dragHandleProps:t,onClick:r,targetView:s,isOverlay:a})=>{const{t:o}=ke(),c=it(),[i,u]=l.useState({total:0,pending:0}),[f,b]=l.useState(!0),h=async()=>{try{const x=await de.getWorklist(),N=x.length,w=x.filter(y=>y.status==="pending"||!y.status).length;u({total:N,pending:w})}catch(x){Ks.error("Failed to load worklist stats",x)}finally{b(!1)}};l.useEffect(()=>(h(),window.addEventListener("db-updated",h),window.addEventListener("db-changed",h),()=>{window.removeEventListener("db-updated",h),window.removeEventListener("db-changed",h)}),[]);const m=x=>{x.stopPropagation(),c("/worklist")};return n.jsx(qe,{title:o("widgets.worklist.title"),icon:rt,iconColor:i.pending>0?"amber":"emerald",onRemove:e,dragHandleProps:t,onClick:r,targetView:s,backgroundIcon:rt,className:a?"opacity-90":"",footerLeft:n.jsxs("button",{onClick:m,className:"flex items-center gap-1.5 text-[10px] font-black text-slate-400 hover:text-blue-600 uppercase tracking-widest transition-colors group/footer",children:[o("widgets.worklist.open_list"),n.jsx(tn,{className:"w-3 h-3 transition-transform group-hover/footer:translate-x-1"})]}),children:n.jsxs("div",{className:"flex flex-col h-full items-center justify-around py-2",children:[n.jsxs("div",{className:"text-center",children:[n.jsxs("div",{className:`flex items-center justify-center gap-1.5 text-[10px] font-black uppercase tracking-widest mb-1 ${i.pending>0?"text-amber-600 dark:text-amber-400":"text-emerald-600 dark:text-emerald-400"}`,children:[i.pending>0?n.jsx(br,{className:"w-3 h-3"}):n.jsx(en,{className:"w-3 h-3"}),n.jsx("span",{children:i.pending>0?o("widgets.worklist.open_tasks"):o("widgets.worklist.all_done")})]}),n.jsx("div",{className:`text-4xl font-black tracking-tighter tabular-nums leading-none ${i.pending>0?"text-amber-600 dark:text-amber-400":"text-slate-900 dark:text-white"}`,children:f?"---":i.pending})]}),n.jsxs("div",{className:"w-full pt-4 border-t border-slate-100 dark:border-slate-800/50 text-center",children:[n.jsxs("div",{className:"flex items-center justify-center gap-1.5 text-[10px] font-black text-slate-500 dark:text-slate-400 uppercase tracking-widest mb-1",children:[n.jsx(rt,{className:"w-3 h-3"}),n.jsx("span",{children:o("widgets.worklist.total_entries")})]}),n.jsx("div",{className:"text-xl font-black text-slate-700 dark:text-slate-300 tabular-nums leading-none",children:f?"---":i.total})]})]})})},Xs={ClockComponent:$s,DataInspectorComponent:Bs,SystemStatusComponent:Ws,DatabaseStatusComponent:Us,WorklistComponent:Ys},jt=[{id:"SystemStatusComponent",titleKey:"widgets.system_status.title",descriptionKey:"widgets.system_status.description",icon:tt,defaultColSpan:1},{id:"DataInspectorComponent",titleKey:"widgets.data_inspector.title",descriptionKey:"widgets.data_inspector.description",icon:et,defaultColSpan:1},{id:"DatabaseStatusComponent",titleKey:"widgets.database_status.title",descriptionKey:"widgets.database_status.description",icon:rn,defaultColSpan:1},{id:"ClockComponent",titleKey:"widgets.clock.title",descriptionKey:"widgets.clock.description",icon:Ct,defaultColSpan:1},{id:"WorklistComponent",titleKey:"widgets.worklist.title",descriptionKey:"widgets.worklist.description",icon:rt,defaultColSpan:1}],qs=e=>Xs[e]||null,Hs=hr("CustomDashboardView"),Vs="litebi:app-ready",dr=({id:e,className:t,children:r})=>{const{attributes:s,listeners:a,setNodeRef:o,transform:c,isDragging:i}=_s({id:e}),{setNodeRef:u,isOver:f}=Os({id:e}),b=h=>{o(h),u(h)};return n.jsx("div",{ref:b,style:{transform:Et.Translate.toString(c)},className:`${t||""} ${i?"opacity-50 z-10":""} ${f&&!i?"ring-2 ring-blue-300 rounded-xl":""}`,...s,...a,children:r})},da=()=>{const{t:e}=ke(),[t,r]=l.useState([]),[s,a]=l.useState(null),[o,c]=l.useState(!1),[i,u]=l.useState(!1),[f,b]=l.useState(!1),[h,m]=l.useState("system"),[x,N]=l.useState(""),[w,y]=l.useState(!1),[S,R]=l.useState(!1),[C,L]=Xt("dashboard_tools_open",!1),[_,A]=Xt("dashboard_tools_tab_v1","layout"),[D,E]=l.useState([]),{visibleSidebarComponentIds:T,setVisibleSidebarComponentIds:B,togglePresentationMode:z,isReadOnly:P}=Kr(),{isExporting:Q,exportToPdf:le}=Xr(),He=Cn(Jt(zt,{activationConstraint:{distance:8}}),Jt(Lt,{coordinateGetter:Ls})),{data:se,refresh:ae}=ur(async()=>await de.executeRaw("SELECT * FROM sys_user_widgets ORDER BY created_at DESC"),[]),Me=q.useRef(!1);l.useEffect(()=>{(async()=>{if(Me.current)return;Me.current=!0;let v=await de.getDashboards();const k=localStorage.getItem("custom_dashboard_layout");if(v.length===0){const X={id:crypto.randomUUID(),name:e("dashboard.default_name"),layout:k?JSON.parse(k):[],is_default:!0};await de.saveDashboard(X,!0),k&&localStorage.removeItem("custom_dashboard_layout"),v=[X]}else v.length>0&&(v=v.map(X=>({...X,layout:typeof X.layout=="string"?JSON.parse(X.layout):X.layout})));r(v);const O=window.location.hash||"#/",M=O.includes("?")?O.slice(O.indexOf("?")+1):"",I=M?new URLSearchParams(M).get("dashboard"):null,te=I&&v.some(X=>X.id===I)?I:v[0]?.id??null;a(te),c(!0),window.__LITEBI_READY__=!0,window.dispatchEvent(new Event(Vs))})()},[e]);const g=t.find(d=>d.id===s);l.useEffect(()=>{if(!g||!se)return;(async()=>{const p=g.layout.map(M=>M.id),v=se.filter(M=>p.includes(M.id)),k=new Set;v.forEach(M=>{const I=M.sql_query.match(/FROM\s+([a-zA-Z0-9_]+)/i);I&&k.add(I[1])});const O=new Set;for(const M of Array.from(k))try{const I=await de.getTableSchema(M);I&&Array.isArray(I)&&I.forEach(te=>O.add(te.name))}catch(I){Hs.error("Error fetching schema for table",M,I)}E(Array.from(O).sort())})()},[g,se]);const $=async d=>{await de.saveDashboard(d),r(p=>p.map(v=>v.id===d.id?d:v))},_e=async(d,p)=>{if(!g||g.layout.find(k=>k.id===d))return;const v={...g,layout:[...g.layout,{id:d,type:p}]};await $(v),u(!1)},ee=async d=>{if(!g)return;const p={...g,layout:g.layout.filter(v=>v.id!==d)};await $(p)},fe=async d=>{if(P||!g)return;const{active:p,over:v}=d;if(!v||p.id===v.id)return;const k=g.layout.findIndex(I=>I.id===String(p.id)),O=g.layout.findIndex(I=>I.id===String(v.id));if(k<0||O<0)return;const M=cr(g.layout,k,O);await $({...g,layout:M})},we=async(d,p)=>{if(!g)return;const v=g.layout.findIndex(M=>M.id===d);if(v<0)return;const k=v+p;if(k<0||k>=g.layout.length)return;const O=cr(g.layout,v,k);await $({...g,layout:O})},Ve=async(d="")=>{g&&await $({...g,filters:[...g.filters||[],{column:d,operator:"=",value:""}]})},Y=async(d,p)=>{if(!g)return;const v=[...g.filters||[]];v[d]={...v[d],...p},await $({...g,filters:v})},Je=async d=>{g&&await $({...g,filters:(g.filters||[]).filter((p,v)=>v!==d)})},Ge=async()=>{g&&await $({...g,filters:[]})},Ze=d=>{if(d.type==="system"){const p=jt.find(v=>v.id===d.id);return p?e(p.titleKey):d.id}return se?.find(p=>p.id===d.id)?.name||d.id},V=async d=>{await xt.confirm(e("dashboard.confirm_delete_report"))&&(await de.deleteUserWidget(d),ae(),ee(d))},Ne=async()=>{if(!x.trim())return;const d={id:crypto.randomUUID(),name:x,layout:[],is_default:!1};await de.saveDashboard(d),r([...t,d]),a(d.id),N(""),y(!1)},ue=async d=>{if(t.length<=1||!await xt.confirm(e("dashboard.delete_confirm")))return;await de.deleteDashboard(d);const p=t.filter(v=>v.id!==d);r(p),s===d&&a(p[0].id)};return o?n.jsxs(Yr,{header:{title:e("dashboard.title"),subtitle:e("dashboard.subtitle"),actions:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:z,className:"p-2 text-slate-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors border border-transparent hover:border-blue-100 dark:hover:border-blue-800/40",title:e("dashboard.presentation_mode"),children:n.jsx(cn,{className:"w-5 h-5"})}),n.jsxs("button",{onClick:()=>le("dashboard-grid",`dashboard-${g?.name||"export"}`),disabled:Q,className:"flex items-center gap-2 px-3 py-2 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-300 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors shadow-sm font-medium text-sm disabled:opacity-50",children:[n.jsx(dn,{className:"w-4 h-4"}),e(Q?"common.exporting":"common.export_pdf")]}),n.jsx("button",{onClick:()=>R(!S),className:`p-2 rounded-lg transition-colors border ${S?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800 text-blue-600 dark:text-blue-300":"text-slate-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border-transparent hover:border-blue-100 dark:hover:border-blue-800/40"}`,title:e("querybuilder.filter"),children:n.jsx(pt,{className:"w-5 h-5"})}),!P&&n.jsxs("button",{onClick:()=>u(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm font-medium text-sm",children:[n.jsx(mt,{className:"w-4 h-4"}),e("dashboard.add_title")]})]})},rightPanel:{title:e("dashboard.tools_title","Dashboard Tools"),enabled:!!g,triggerTitle:e("dashboard.tools_title","Dashboard Tools"),width:"sm",isOpen:C,onOpenChange:L,content:n.jsxs("div",{className:"h-full min-h-0 flex flex-col gap-4",children:[n.jsxs("div",{className:"inline-flex items-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 p-1 flex-shrink-0",children:[n.jsx("button",{type:"button",onClick:()=>A("layout"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${_==="layout"?"bg-blue-600 text-white":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:e("dashboard.tools_tab_layout","Layout")}),n.jsx("button",{type:"button",onClick:()=>A("filters"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${_==="filters"?"bg-blue-600 text-white":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:e("dashboard.tools_tab_filters","Filters")})]}),g?_==="layout"?n.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-2",children:[n.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:e("dashboard.tools_layout_hint","Reorder widgets and remove items without leaving the dashboard.")}),n.jsx("div",{className:"flex-1 min-h-0 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg divide-y divide-slate-100 dark:divide-slate-700",children:g.layout.length===0?n.jsx("div",{className:"p-3 text-xs text-slate-400 dark:text-slate-500",children:e("dashboard.no_reports")}):g.layout.map((d,p)=>n.jsxs("div",{className:"p-3 flex items-center justify-between gap-2",children:[n.jsxs("div",{className:"min-w-0",children:[n.jsx("div",{className:"text-xs font-semibold text-slate-700 dark:text-slate-200 truncate",children:Ze(d)}),n.jsx("div",{className:"text-[10px] text-slate-400 dark:text-slate-500 uppercase",children:d.type})]}),!P&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{type:"button",onClick:()=>{we(d.id,-1)},disabled:p===0,className:"h-7 w-7 inline-flex items-center justify-center rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300 disabled:opacity-40",title:e("dashboard.tools_move_up","Move up"),children:n.jsx(on,{className:"w-3.5 h-3.5"})}),n.jsx("button",{type:"button",onClick:()=>{we(d.id,1)},disabled:p===g.layout.length-1,className:"h-7 w-7 inline-flex items-center justify-center rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300 disabled:opacity-40",title:e("dashboard.tools_move_down","Move down"),children:n.jsx(ln,{className:"w-3.5 h-3.5"})}),n.jsx("button",{type:"button",onClick:()=>{ee(d.id)},className:"h-7 w-7 inline-flex items-center justify-center rounded border border-rose-200 dark:border-rose-800 bg-rose-50 dark:bg-rose-900/20 hover:bg-rose-100 dark:hover:bg-rose-900/30 text-rose-700 dark:text-rose-300",title:e("common.remove"),children:n.jsx(ye,{className:"w-3.5 h-3.5"})})]})]},`${d.type}:${d.id}`))})]}):n.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-2",children:[n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:e("dashboard.tools_filters_hint","Manage global dashboard filters in one place.")}),!P&&n.jsx("button",{type:"button",onClick:()=>{Ve("")},className:"h-7 px-2 rounded border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/30 text-blue-700 dark:text-blue-300 text-[11px] font-semibold",children:e("dashboard.add_filter")})]}),!P&&n.jsx("div",{className:"flex items-center justify-end",children:n.jsx("button",{type:"button",onClick:()=>{Ge()},className:"text-[11px] text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200",children:e("dashboard.tools_clear_filters","Clear filters")})}),n.jsx("div",{className:"flex-1 min-h-0 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg divide-y divide-slate-100 dark:divide-slate-700",children:(g.filters||[]).length===0?n.jsx("div",{className:"p-3 text-xs text-slate-400 dark:text-slate-500",children:e("dashboard.no_filters")}):(g.filters||[]).map((d,p)=>n.jsxs("div",{className:"p-3 space-y-2",children:[n.jsx("input",{list:"suggested-columns",value:d.column,onChange:v=>{Y(p,{column:v.target.value})},placeholder:e("dashboard.filter_column"),className:"w-full h-8 px-2 border border-slate-200 dark:border-slate-700 rounded bg-white dark:bg-slate-900 text-xs text-slate-700 dark:text-slate-200 outline-none"}),n.jsxs("div",{className:"grid grid-cols-[1fr_1fr_auto] gap-2",children:[n.jsxs("select",{value:d.operator,onChange:v=>{Y(p,{operator:v.target.value})},className:"h-8 px-2 border border-slate-200 dark:border-slate-700 rounded bg-white dark:bg-slate-900 text-xs text-slate-700 dark:text-slate-200 outline-none",children:[n.jsx("option",{value:"=",children:"="}),n.jsx("option",{value:"!=",children:"!="}),n.jsx("option",{value:">",children:">"}),n.jsx("option",{value:"<",children:"<"}),n.jsx("option",{value:"contains",children:e("dashboard.op_contains")}),n.jsx("option",{value:"is null",children:e("dashboard.op_is_null")})]}),n.jsx("input",{value:d.value,onChange:v=>{Y(p,{value:v.target.value})},placeholder:e("dashboard.filter_value"),className:"h-8 px-2 border border-slate-200 dark:border-slate-700 rounded bg-white dark:bg-slate-900 text-xs text-slate-700 dark:text-slate-200 outline-none"}),!P&&n.jsx("button",{type:"button",onClick:()=>{Je(p)},className:"h-8 w-8 inline-flex items-center justify-center rounded border border-rose-200 dark:border-rose-800 bg-rose-50 dark:bg-rose-900/20 hover:bg-rose-100 dark:hover:bg-rose-900/30 text-rose-700 dark:text-rose-300",title:e("common.remove"),children:n.jsx(ye,{className:"w-3.5 h-3.5"})})]})]},p))})]}):n.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:e("common.no_data")})]})},children:[S&&g&&n.jsxs("div",{className:"mb-6 p-4 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl shadow-sm animate-in slide-in-from-top-2 duration-300",children:[n.jsx("datalist",{id:"suggested-columns",children:D.map(d=>n.jsx("option",{value:d},d))}),n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex flex-col gap-1",children:[n.jsxs("h4",{className:"text-xs font-black uppercase text-slate-400 flex items-center gap-2",children:[n.jsx(pt,{className:"w-3.5 h-3.5 text-blue-500"})," ",e("dashboard.filters_title")]}),n.jsx("p",{className:"text-[10px] text-slate-400",children:e("dashboard.filters_subtitle","Slicers that affect all dashboard charts simultaneously.")})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[D.filter(d=>["Year","FiscalYear","Date","Month","Category","Group","Type","Status"].some(p=>d.toLowerCase().includes(p.toLowerCase()))).slice(0,3).map(d=>n.jsxs("button",{onClick:()=>$({...g,filters:[...g.filters||[],{column:d,operator:"=",value:""}]}),className:"px-2 py-1 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded text-[10px] font-bold text-slate-500 hover:text-blue-600 transition-colors",children:["+ ",d]},d)),n.jsx("button",{onClick:()=>$({...g,filters:[...g.filters||[],{column:"",operator:"=",value:""}]}),className:"px-3 py-1 bg-blue-600 text-white rounded text-[10px] font-bold shadow-sm shadow-blue-100 hover:bg-blue-700 transition-colors",children:e("dashboard.add_filter")})]})]}),n.jsxs("div",{className:"space-y-2",children:[(g.filters||[]).map((d,p)=>n.jsxs("div",{className:"flex items-center gap-2 group animate-in slide-in-from-left-2 duration-200",style:{animationDelay:`${p*50}ms`},children:[n.jsxs("div",{className:"flex-1 grid grid-cols-12 gap-2 p-1 bg-slate-50 dark:bg-slate-800/50 border border-slate-100 dark:border-slate-800 rounded-lg group-hover:border-slate-200 group-hover:bg-white dark:group-hover:bg-slate-800 transition-all",children:[n.jsx("input",{placeholder:e("dashboard.filter_column"),list:"suggested-columns",className:"col-span-4 p-1.5 text-[11px] bg-transparent outline-none font-bold text-slate-700 dark:text-slate-200",value:d.column,onChange:v=>{const k=[...g.filters||[]];k[p].column=v.target.value,$({...g,filters:k})}}),n.jsxs("select",{className:"col-span-3 p-1.5 text-[11px] bg-transparent outline-none border-l border-slate-100 dark:border-slate-800 text-slate-500 font-medium cursor-pointer",value:d.operator,onChange:v=>{const k=[...g.filters||[]];k[p].operator=v.target.value,$({...g,filters:k})},children:[n.jsx("option",{value:"=",children:"="}),n.jsx("option",{value:"!=",children:"!="}),n.jsx("option",{value:">",children:">"}),n.jsx("option",{value:"<",children:"<"}),n.jsx("option",{value:"contains",children:e("dashboard.op_contains")}),n.jsx("option",{value:"is null",children:e("dashboard.op_is_null")})]}),n.jsx("input",{placeholder:e("dashboard.filter_value"),className:"col-span-5 p-1.5 text-[11px] bg-transparent outline-none border-l border-slate-100 dark:border-slate-800 font-bold text-blue-600 dark:text-blue-400 placeholder:text-blue-200",value:d.value,onChange:v=>{const k=[...g.filters||[]];k[p].value=v.target.value,$({...g,filters:k})}})]}),n.jsx("button",{onClick:()=>$({...g,filters:(g.filters||[]).filter((v,k)=>k!==p)}),className:"p-1.5 text-slate-300 hover:text-red-500 transition-colors bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-lg shadow-sm",children:n.jsx(ye,{className:"w-3.5 h-3.5"})})]},p)),(g.filters||[]).length===0&&n.jsxs("div",{className:"py-8 text-center border-2 border-dashed border-slate-50 dark:border-slate-800 rounded-xl",children:[n.jsx(pt,{className:"w-8 h-8 mx-auto mb-2 text-slate-200"}),n.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-slate-300",children:e("dashboard.no_filters")})]})]})]}),n.jsxs("div",{className:"mb-6 flex items-center justify-between border-b border-slate-200 dark:border-slate-800",children:[n.jsxs("div",{className:"flex items-center gap-1 overflow-x-auto no-scrollbar pb-px",children:[t.map(d=>n.jsx("button",{onClick:()=>a(d.id),className:`px-4 py-2.5 text-sm font-bold transition-all border-b-2 whitespace-nowrap ${s===d.id?"text-blue-600 border-blue-600":"text-slate-400 border-transparent hover:text-slate-600"}`,children:d.name},d.id)),!P&&n.jsx("button",{onClick:()=>{y(!0),N("")},className:"px-4 py-2.5 text-slate-400 hover:text-blue-600 transition-all border-b-2 border-transparent",title:e("dashboard.new_dashboard_title"),children:n.jsx(mt,{className:"w-4 h-4"})})]}),!P&&n.jsx("button",{onClick:()=>b(!0),className:"p-2 text-slate-400 hover:text-slate-600",title:e("dashboard.manage_title"),children:n.jsx(gr,{className:"w-4 h-4"})})]}),w&&n.jsxs("div",{className:"mb-6 p-4 bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-800 rounded-xl flex items-center gap-3",children:[n.jsx(vt,{className:"w-5 h-5 text-slate-400"}),n.jsx("input",{autoFocus:!0,type:"text",placeholder:e("dashboard.new_dashboard_placeholder"),className:"flex-1 bg-transparent border-none outline-none font-bold text-slate-700 dark:text-slate-200",value:x,onChange:d=>N(d.target.value),onKeyDown:d=>d.key==="Enter"&&Ne()}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{onClick:Ne,className:"p-1.5 text-green-600 hover:bg-green-50 rounded",children:n.jsx(nn,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>y(!1),className:"p-1.5 text-slate-400 hover:bg-slate-100 rounded",children:n.jsx(fr,{className:"w-4 h-4"})})]})]}),g&&g.layout.length===0?n.jsxs("div",{className:"flex flex-col items-center justify-center p-12 border-2 border-dashed border-slate-200 dark:border-slate-700 rounded-xl bg-slate-50 dark:bg-slate-900/40 text-slate-400 dark:text-slate-500",children:[n.jsx(vt,{className:"w-12 h-12 mb-4 opacity-50"}),n.jsx("h3",{className:"font-bold text-lg text-slate-600 dark:text-slate-200",children:e("dashboard.empty_msg",{name:g.name})}),n.jsx("p",{className:"mb-4 text-sm text-center text-slate-500 dark:text-slate-400",children:e("dashboard.empty_hint")}),!P&&n.jsx("button",{onClick:()=>u(!0),className:"px-6 py-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-blue-600 dark:text-blue-300 font-bold hover:shadow-sm transition-all text-sm",children:e("dashboard.add_title")})]}):g?n.jsx(Es,{sensors:He,collisionDetection:Sn,onDragEnd:d=>{fe(d)},children:n.jsx("div",{id:"dashboard-grid",className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6 auto-rows-[300px]",children:g.layout.map(d=>{if(d.type==="system"){const k=jt.find(M=>M.id===d.id);if(!k)return null;const O=qs(k.id);return O?n.jsxs(dr,{id:d.id,className:`relative group h-full ${k.defaultColSpan===2?"md:col-span-2":""}`,children:[!P&&n.jsx("div",{className:"absolute -top-2 -right-2 z-20 opacity-0 group-hover:opacity-100 transition-opacity",children:n.jsx("button",{onClick:M=>{M.stopPropagation(),ee(d.id)},className:"p-1.5 bg-white/95 backdrop-blur-sm border border-slate-200 rounded-full text-slate-400 hover:text-red-500 shadow-sm",title:e("common.remove"),children:n.jsx(ye,{className:"w-3 h-3"})})}),n.jsx("div",{className:"h-full",children:n.jsx(O,{onRemove:void 0,targetView:qt.find(M=>M.component===k.id)?.targetView})})]},d.id):null}const p=se?.find(k=>k.id===d.id);if(!p)return null;let v;try{v=JSON.parse(p.visualization_config)}catch{v={type:"table"}}return n.jsxs(dr,{id:d.id,className:"relative group md:col-span-1 xl:col-span-2 h-full",children:[!P&&n.jsx("div",{className:"absolute -top-2 -right-2 z-20 opacity-0 group-hover:opacity-100 transition-opacity",children:n.jsx("button",{onClick:()=>ee(d.id),className:"p-1.5 bg-white/95 backdrop-blur-sm border border-slate-200 rounded-full text-slate-400 hover:text-red-500 shadow-sm",title:"Entfernen",children:n.jsx(ye,{className:"w-3 h-3"})})}),n.jsx(qr,{title:p.name,sql:p.sql_query,config:v,globalFilters:g.filters,showInspectorJump:!0,inspectorReturnHash:g?.id?`#/?dashboard=${encodeURIComponent(g.id)}`:"#/"})]},d.id)})})}):null,n.jsx(Ht,{isOpen:f,onClose:()=>b(!1),title:e("dashboard.manage_title"),children:n.jsxs("div",{className:"space-y-3",children:[t.map(d=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg group",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(vt,{className:"w-4 h-4 text-slate-400 dark:text-slate-500"}),n.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-200",children:d.name}),d.is_default&&n.jsx("span",{className:"text-[10px] bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-200 px-1.5 py-0.5 rounded font-black uppercase tracking-wider",children:"Default"})]}),n.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[n.jsx("button",{onClick:async()=>{const p=await xt.prompt("Name fuer Dashboard:",{defaultValue:d.name});p&&p!==d.name&&$({...d,name:p})},className:"p-1.5 text-slate-400 dark:text-slate-500 hover:text-blue-600 dark:hover:text-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded",children:n.jsx(sn,{className:"w-3.5 h-3.5"})}),n.jsx("button",{onClick:()=>ue(d.id),disabled:t.length<=1,className:"p-1.5 text-slate-400 dark:text-slate-500 hover:text-red-600 dark:hover:text-red-300 hover:bg-red-50 dark:hover:bg-red-900/30 rounded disabled:opacity-30",children:n.jsx(ye,{className:"w-3.5 h-3.5"})})]})]},d.id)),n.jsxs("button",{onClick:()=>{b(!1),y(!0)},className:"w-full p-3 border-2 border-dashed border-slate-200 dark:border-slate-700 rounded-lg text-slate-400 dark:text-slate-500 hover:text-blue-600 dark:hover:text-blue-300 hover:border-blue-200 dark:hover:border-blue-700 text-sm font-bold transition-all flex items-center justify-center gap-2",children:[n.jsx(mt,{className:"w-4 h-4"})," Neues Dashboard"]})]})}),n.jsxs(Ht,{isOpen:i,onClose:()=>u(!1),title:e("dashboard.add_title"),children:[n.jsxs("div",{className:"flex gap-4 mb-4 border-b border-slate-200 dark:border-slate-700",children:[n.jsx("button",{onClick:()=>m("system"),className:`pb-2 text-sm font-bold ${h==="system"?"text-blue-600 dark:text-blue-400 border-b-2 border-blue-600 dark:border-blue-400":"text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300"}`,children:e("dashboard.system_widgets")}),n.jsx("button",{onClick:()=>m("custom"),className:`pb-2 text-sm font-bold ${h==="custom"?"text-blue-600 dark:text-blue-400 border-b-2 border-blue-600 dark:border-blue-400":"text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300"}`,children:e("dashboard.custom_widgets")})]}),n.jsxs("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto min-h-[300px]",children:[h==="system"&&n.jsx("div",{className:"grid grid-cols-1 gap-2",children:jt.map(d=>{const p=g?.layout.some(M=>M.id===d.id),v=qt.find(M=>M.component===d.id),k=!!v?.targetView,O=k&&T.includes(v.id);return n.jsxs("div",{className:"flex items-center justify-between p-3 border border-slate-200 dark:border-slate-700 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800/60",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"p-2 bg-slate-100 dark:bg-slate-800 rounded-lg text-slate-500 dark:text-slate-300",children:n.jsx(d.icon,{className:"w-5 h-5"})}),n.jsxs("div",{children:[n.jsx("div",{className:"font-bold text-slate-700 dark:text-slate-100",children:e(d.titleKey)}),n.jsx("div",{className:"text-xs text-slate-400 dark:text-slate-500",children:e(d.descriptionKey)})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[k&&n.jsx("button",{onClick:M=>{M.stopPropagation(),B(O?T.filter(I=>I!==v.id):[...T,v.id])},title:e(O?"dashboard.unpin_sidebar":"dashboard.pin_sidebar"),className:`p-1.5 rounded-md border transition-all ${O?"bg-amber-50 dark:bg-amber-900/30 border-amber-200 dark:border-amber-700 text-amber-500 dark:text-amber-300":"bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 text-slate-300 dark:text-slate-500 hover:text-amber-400 dark:hover:text-amber-300"}`,children:n.jsx(an,{className:`w-4 h-4 ${O?"fill-current":""}`})}),n.jsx("button",{onClick:()=>_e(d.id,"system"),disabled:p,className:`px-3 py-1.5 text-xs font-bold rounded ${p?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300":"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 hover:bg-blue-200 dark:hover:bg-blue-900/50"}`,children:e(p?"dashboard.active":"common.add")})]})]},d.id)})}),h==="custom"&&n.jsx("div",{className:"grid grid-cols-1 gap-2",children:se&&se.length>0?se.map(d=>{const p=g?.layout.some(v=>v.id===d.id);return n.jsxs("div",{className:"flex items-center justify-between p-3 border border-slate-200 dark:border-slate-700 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800/60",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"p-2 bg-blue-50 dark:bg-blue-900/30 rounded-lg text-blue-500 dark:text-blue-300",children:n.jsx(Pe,{className:"w-5 h-5"})}),n.jsxs("div",{children:[n.jsx("div",{className:"font-bold text-slate-700 dark:text-slate-100",children:d.name}),n.jsx("div",{className:"text-xs text-slate-400 dark:text-slate-500 truncate max-w-[200px]",children:d.sql_query})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>V(d.id),className:"p-2 text-slate-400 dark:text-slate-500 hover:text-red-500 dark:hover:text-red-300",title:e("common.delete"),children:n.jsx(ye,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>_e(d.id,"custom"),disabled:p,className:`px-3 py-1.5 text-xs font-bold rounded ${p?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300":"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 hover:bg-blue-200 dark:hover:bg-blue-900/50"}`,children:e(p?"dashboard.active":"common.add")})]})]},d.id)}):n.jsx("p",{className:"text-center text-slate-400 dark:text-slate-500 py-4",children:e("dashboard.no_reports")})})]})]})]}):null};export{da as CustomDashboardView};
