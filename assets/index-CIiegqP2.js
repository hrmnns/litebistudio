const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.es-CGVu7kzj.js","assets/vendor-react-DL62D7An.js","assets/vendor-ui-BNe0Xlio.js","assets/vendor-icons-1F9nZmcf.js","assets/vendor-charts-Cy8x3J51.js"])))=>i.map(i=>d[i]);
import{a as l8,c as o8,r as X,d as ar,b as k0,N as Y5,O as A8,L as c8,u as u8,H as d8,e as f8,f as Tc}from"./vendor-react-DL62D7An.js";import{t as h8,c as p8}from"./vendor-ui-BNe0Xlio.js";import{X as nl,C as f2,H as BS,I as qc,a as Eb,T as Ou,b as $v,R as $5,W as g8,A as Ru,L as J5,D as _i,P as Zd,F as Hh,S as kS,M as CS,c as Ul,d as SS,G as Xm,e as cp,f as E0,g as fo,h as nf,i as m8,j as x8,k as b8,E as v8,l as Nu,m as il,n as ES,o as h2,p as w8,q as y8,U as NS,r as Ym,s as _8,t as Px,u as ds,v as Z5,w as Jv,x as FS,B as B8,y as k8,z as p2,J as eB,K as Io,N as C8,O as g2,Q as Im,V as Ic,Y as TS,Z as Bf,_ as $m,$ as Oc,a0 as jp,a1 as LS,a2 as sf,a3 as S8,a4 as tB,a5 as Nb,a6 as Qm,a7 as E8,a8 as N8,a9 as lf,aa as F8,ab as T8,ac as L8,ad as U8,ae as m2,af as US,ag as Fb,ah as j8,ai as D8,aj as xi,ak as Kg,al as rB,am as aB,an as Jm,ao as I8,ap as nB,aq as Zm,ar as Q8,as as jS,at as O8,au as R8,av as M8,aw as H8,ax as P8,ay as K8,az as Zv,aA as q8,aB as z8,aC as V8,aD as G8}from"./vendor-icons-1F9nZmcf.js";import{r as W8,R as DS,B as IS,C as VA,X as GA,Y as WA,T as jl,L as Dl,a as ex,b as XA,c as QS,d as tx,A as OS,e as RS,P as MS,f as HS,g as PS,h as KS,i as qS,j as zS,k as VS,l as GS,m as WS,S as XS,n as YS}from"./vendor-charts-Cy8x3J51.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();var Tb={exports:{}},gh={};var sB;function X8(){if(sB)return gh;sB=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(a,n,s){var l=null;if(s!==void 0&&(l=""+s),n.key!==void 0&&(l=""+n.key),"key"in n){s={};for(var A in n)A!=="key"&&(s[A]=n[A])}else s=n;return n=s.ref,{$$typeof:e,type:a,key:l,ref:n!==void 0?n:null,props:s}}return gh.Fragment=t,gh.jsx=r,gh.jsxs=r,gh}var iB;function Y8(){return iB||(iB=1,Tb.exports=X8()),Tb.exports}var c=Y8(),Lb={exports:{}},mh={},Ub={exports:{}},jb={};var lB;function $8(){return lB||(lB=1,(function(e){function t(Z,Ae){var ve=Z.length;Z.push(Ae);e:for(;0<ve;){var G=ve-1>>>1,Se=Z[G];if(0<n(Se,Ae))Z[G]=Ae,Z[ve]=Se,ve=G;else break e}}function r(Z){return Z.length===0?null:Z[0]}function a(Z){if(Z.length===0)return null;var Ae=Z[0],ve=Z.pop();if(ve!==Ae){Z[0]=ve;e:for(var G=0,Se=Z.length,we=Se>>>1;G<we;){var F=2*(G+1)-1,R=Z[F],M=F+1,P=Z[M];if(0>n(R,ve))M<Se&&0>n(P,R)?(Z[G]=P,Z[M]=ve,G=M):(Z[G]=R,Z[F]=ve,G=F);else if(M<Se&&0>n(P,ve))Z[G]=P,Z[M]=ve,G=M;else break e}}return Ae}function n(Z,Ae){var ve=Z.sortIndex-Ae.sortIndex;return ve!==0?ve:Z.id-Ae.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var l=Date,A=l.now();e.unstable_now=function(){return l.now()-A}}var u=[],f=[],h=1,g=null,x=3,m=!1,w=!1,v=!1,B=!1,k=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function O(Z){for(var Ae=r(f);Ae!==null;){if(Ae.callback===null)a(f);else if(Ae.startTime<=Z)a(f),Ae.sortIndex=Ae.expirationTime,t(u,Ae);else break;Ae=r(f)}}function T(Z){if(v=!1,O(Z),!w)if(r(u)!==null)w=!0,U||(U=!0,Q());else{var Ae=r(f);Ae!==null&&ue(T,Ae.startTime-Z)}}var U=!1,D=-1,H=5,j=-1;function W(){return B?!0:!(e.unstable_now()-j<H)}function I(){if(B=!1,U){var Z=e.unstable_now();j=Z;var Ae=!0;try{e:{w=!1,v&&(v=!1,N(D),D=-1),m=!0;var ve=x;try{t:{for(O(Z),g=r(u);g!==null&&!(g.expirationTime>Z&&W());){var G=g.callback;if(typeof G=="function"){g.callback=null,x=g.priorityLevel;var Se=G(g.expirationTime<=Z);if(Z=e.unstable_now(),typeof Se=="function"){g.callback=Se,O(Z),Ae=!0;break t}g===r(u)&&a(u),O(Z)}else a(u);g=r(u)}if(g!==null)Ae=!0;else{var we=r(f);we!==null&&ue(T,we.startTime-Z),Ae=!1}}break e}finally{g=null,x=ve,m=!1}Ae=void 0}}finally{Ae?Q():U=!1}}}var Q;if(typeof S=="function")Q=function(){S(I)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,z=Y.port2;Y.port1.onmessage=I,Q=function(){z.postMessage(null)}}else Q=function(){k(I,0)};function ue(Z,Ae){D=k(function(){Z(e.unstable_now())},Ae)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Z){Z.callback=null},e.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):H=0<Z?Math.floor(1e3/Z):5},e.unstable_getCurrentPriorityLevel=function(){return x},e.unstable_next=function(Z){switch(x){case 1:case 2:case 3:var Ae=3;break;default:Ae=x}var ve=x;x=Ae;try{return Z()}finally{x=ve}},e.unstable_requestPaint=function(){B=!0},e.unstable_runWithPriority=function(Z,Ae){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var ve=x;x=Z;try{return Ae()}finally{x=ve}},e.unstable_scheduleCallback=function(Z,Ae,ve){var G=e.unstable_now();switch(typeof ve=="object"&&ve!==null?(ve=ve.delay,ve=typeof ve=="number"&&0<ve?G+ve:G):ve=G,Z){case 1:var Se=-1;break;case 2:Se=250;break;case 5:Se=1073741823;break;case 4:Se=1e4;break;default:Se=5e3}return Se=ve+Se,Z={id:h++,callback:Ae,priorityLevel:Z,startTime:ve,expirationTime:Se,sortIndex:-1},ve>G?(Z.sortIndex=ve,t(f,Z),r(u)===null&&Z===r(f)&&(v?(N(D),D=-1):v=!0,ue(T,ve-G))):(Z.sortIndex=Se,t(u,Z),w||m||(w=!0,U||(U=!0,Q()))),Z},e.unstable_shouldYield=W,e.unstable_wrapCallback=function(Z){var Ae=x;return function(){var ve=x;x=Ae;try{return Z.apply(this,arguments)}finally{x=ve}}}})(jb)),jb}var oB;function J8(){return oB||(oB=1,Ub.exports=$8()),Ub.exports}var AB;function Z8(){if(AB)return mh;AB=1;var e=J8(),t=l8(),r=o8();function a(i){var o="https://react.dev/errors/"+i;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)o+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function s(i){var o=i,d=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(d=o.return),i=o.return;while(i)}return o.tag===3?d:null}function l(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function A(i){if(i.tag===31){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function u(i){if(s(i)!==i)throw Error(a(188))}function f(i){var o=i.alternate;if(!o){if(o=s(i),o===null)throw Error(a(188));return o!==i?null:i}for(var d=i,p=o;;){var y=d.return;if(y===null)break;var C=y.alternate;if(C===null){if(p=y.return,p!==null){d=p;continue}break}if(y.child===C.child){for(C=y.child;C;){if(C===d)return u(y),i;if(C===p)return u(y),o;C=C.sibling}throw Error(a(188))}if(d.return!==p.return)d=y,p=C;else{for(var V=!1,ce=y.child;ce;){if(ce===d){V=!0,d=y,p=C;break}if(ce===p){V=!0,p=y,d=C;break}ce=ce.sibling}if(!V){for(ce=C.child;ce;){if(ce===d){V=!0,d=C,p=y;break}if(ce===p){V=!0,p=C,d=y;break}ce=ce.sibling}if(!V)throw Error(a(189))}}if(d.alternate!==p)throw Error(a(190))}if(d.tag!==3)throw Error(a(188));return d.stateNode.current===d?i:o}function h(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i;for(i=i.child;i!==null;){if(o=h(i),o!==null)return o;i=i.sibling}return null}var g=Object.assign,x=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),B=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),N=Symbol.for("react.consumer"),S=Symbol.for("react.context"),O=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),U=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),H=Symbol.for("react.lazy"),j=Symbol.for("react.activity"),W=Symbol.for("react.memo_cache_sentinel"),I=Symbol.iterator;function Q(i){return i===null||typeof i!="object"?null:(i=I&&i[I]||i["@@iterator"],typeof i=="function"?i:null)}var Y=Symbol.for("react.client.reference");function z(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===Y?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case v:return"Fragment";case k:return"Profiler";case B:return"StrictMode";case T:return"Suspense";case U:return"SuspenseList";case j:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case w:return"Portal";case S:return i.displayName||"Context";case N:return(i._context.displayName||"Context")+".Consumer";case O:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case D:return o=i.displayName||null,o!==null?o:z(i.type)||"Memo";case H:o=i._payload,i=i._init;try{return z(i(o))}catch{}}return null}var ue=Array.isArray,Z=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ae=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ve={pending:!1,data:null,method:null,action:null},G=[],Se=-1;function we(i){return{current:i}}function F(i){0>Se||(i.current=G[Se],G[Se]=null,Se--)}function R(i,o){Se++,G[Se]=i.current,i.current=o}var M=we(null),P=we(null),re=we(null),ge=we(null);function Ce(i,o){switch(R(re,o),R(P,i),R(M,null),o.nodeType){case 9:case 11:i=(i=o.documentElement)&&(i=i.namespaceURI)?b5(i):0;break;default:if(i=o.tagName,o=o.namespaceURI)o=b5(o),i=v5(o,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}F(M),R(M,i)}function de(){F(M),F(P),F(re)}function be(i){i.memoizedState!==null&&R(ge,i);var o=M.current,d=v5(o,i.type);o!==d&&(R(P,i),R(M,d))}function Le(i){P.current===i&&(F(M),F(P)),ge.current===i&&(F(ge),dh._currentValue=ve)}var ie,_e;function je(i){if(ie===void 0)try{throw Error()}catch(d){var o=d.stack.trim().match(/\n( *(at )?)/);ie=o&&o[1]||"",_e=-1<d.stack.indexOf(`
    at`)?" (<anonymous>)":-1<d.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ie+i+_e}var J=!1;function ze(i,o){if(!i||J)return"";J=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(o){var gt=function(){throw Error()};if(Object.defineProperty(gt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(gt,[])}catch(rt){var Ze=rt}Reflect.construct(i,[],gt)}else{try{gt.call()}catch(rt){Ze=rt}i.call(gt.prototype)}}else{try{throw Error()}catch(rt){Ze=rt}(gt=i())&&typeof gt.catch=="function"&&gt.catch(function(){})}}catch(rt){if(rt&&Ze&&typeof rt.stack=="string")return[rt.stack,Ze.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var C=p.DetermineComponentFrameRoot(),V=C[0],ce=C[1];if(V&&ce){var Te=V.split(`
`),Je=ce.split(`
`);for(y=p=0;p<Te.length&&!Te[p].includes("DetermineComponentFrameRoot");)p++;for(;y<Je.length&&!Je[y].includes("DetermineComponentFrameRoot");)y++;if(p===Te.length||y===Je.length)for(p=Te.length-1,y=Je.length-1;1<=p&&0<=y&&Te[p]!==Je[y];)y--;for(;1<=p&&0<=y;p--,y--)if(Te[p]!==Je[y]){if(p!==1||y!==1)do if(p--,y--,0>y||Te[p]!==Je[y]){var ot=`
`+Te[p].replace(" at new "," at ");return i.displayName&&ot.includes("<anonymous>")&&(ot=ot.replace("<anonymous>",i.displayName)),ot}while(1<=p&&0<=y);break}}}finally{J=!1,Error.prepareStackTrace=d}return(d=i?i.displayName||i.name:"")?je(d):""}function He(i,o){switch(i.tag){case 26:case 27:case 5:return je(i.type);case 16:return je("Lazy");case 13:return i.child!==o&&o!==null?je("Suspense Fallback"):je("Suspense");case 19:return je("SuspenseList");case 0:case 15:return ze(i.type,!1);case 11:return ze(i.type.render,!1);case 1:return ze(i.type,!0);case 31:return je("Activity");default:return""}}function ct(i){try{var o="",d=null;do o+=He(i,d),d=i,i=i.return;while(i);return o}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}var Xe=Object.prototype.hasOwnProperty,Ut=e.unstable_scheduleCallback,yt=e.unstable_cancelCallback,qt=e.unstable_shouldYield,Lt=e.unstable_requestPaint,jt=e.unstable_now,Pt=e.unstable_getCurrentPriorityLevel,zt=e.unstable_ImmediatePriority,Jt=e.unstable_UserBlockingPriority,It=e.unstable_NormalPriority,xt=e.unstable_LowPriority,ht=e.unstable_IdlePriority,Bt=e.log,pr=e.unstable_setDisableYieldValue,$t=null,Ee=null;function at(i){if(typeof Bt=="function"&&pr(i),Ee&&typeof Ee.setStrictMode=="function")try{Ee.setStrictMode($t,i)}catch{}}var it=Math.clz32?Math.clz32:mt,bt=Math.log,Et=Math.LN2;function mt(i){return i>>>=0,i===0?32:31-(bt(i)/Et|0)|0}var Ot=256,Ur=262144,Vt=4194304;function tt(i){var o=i&42;if(o!==0)return o;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Wt(i,o,d){var p=i.pendingLanes;if(p===0)return 0;var y=0,C=i.suspendedLanes,V=i.pingedLanes;i=i.warmLanes;var ce=p&134217727;return ce!==0?(p=ce&~C,p!==0?y=tt(p):(V&=ce,V!==0?y=tt(V):d||(d=ce&~i,d!==0&&(y=tt(d))))):(ce=p&~C,ce!==0?y=tt(ce):V!==0?y=tt(V):d||(d=p&~i,d!==0&&(y=tt(d)))),y===0?0:o!==0&&o!==y&&(o&C)===0&&(C=y&-y,d=o&-o,C>=d||C===32&&(d&4194048)!==0)?o:y}function Me(i,o){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&o)===0}function kt(i,o){switch(i){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Tt(){var i=Vt;return Vt<<=1,(Vt&62914560)===0&&(Vt=4194304),i}function ir(i){for(var o=[],d=0;31>d;d++)o.push(i);return o}function Nt(i,o){i.pendingLanes|=o,o!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function Sr(i,o,d,p,y,C){var V=i.pendingLanes;i.pendingLanes=d,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=d,i.entangledLanes&=d,i.errorRecoveryDisabledLanes&=d,i.shellSuspendCounter=0;var ce=i.entanglements,Te=i.expirationTimes,Je=i.hiddenUpdates;for(d=V&~d;0<d;){var ot=31-it(d),gt=1<<ot;ce[ot]=0,Te[ot]=-1;var Ze=Je[ot];if(Ze!==null)for(Je[ot]=null,ot=0;ot<Ze.length;ot++){var rt=Ze[ot];rt!==null&&(rt.lane&=-536870913)}d&=~gt}p!==0&&ca(i,p,0),C!==0&&y===0&&i.tag!==0&&(i.suspendedLanes|=C&~(V&~o))}function ca(i,o,d){i.pendingLanes|=o,i.suspendedLanes&=~o;var p=31-it(o);i.entangledLanes|=o,i.entanglements[p]=i.entanglements[p]|1073741824|d&261930}function Hr(i,o){var d=i.entangledLanes|=o;for(i=i.entanglements;d;){var p=31-it(d),y=1<<p;y&o|i[p]&o&&(i[p]|=o),d&=~y}}function Br(i,o){var d=o&-o;return d=(d&42)!==0?1:jr(d),(d&(i.suspendedLanes|o))!==0?0:d}function jr(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Er(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function ae(){var i=Ae.p;return i!==0?i:(i=window.event,i===void 0?32:K5(i.type))}function xe(i,o){var d=Ae.p;try{return Ae.p=i,o()}finally{Ae.p=d}}var fe=Math.random().toString(36).slice(2),pe="__reactFiber$"+fe,K="__reactProps$"+fe,se="__reactContainer$"+fe,Fe="__reactEvents$"+fe,Re="__reactListeners$"+fe,Qe="__reactHandles$"+fe,Pe="__reactResources$"+fe,qe="__reactMarker$"+fe;function pt(i){delete i[pe],delete i[K],delete i[Fe],delete i[Re],delete i[Qe]}function et(i){var o=i[pe];if(o)return o;for(var d=i.parentNode;d;){if(o=d[se]||d[pe]){if(d=o.alternate,o.child!==null||d!==null&&d.child!==null)for(i=S5(i);i!==null;){if(d=i[pe])return d;i=S5(i)}return o}i=d,d=i.parentNode}return null}function Rt(i){if(i=i[pe]||i[se]){var o=i.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return i}return null}function Ct(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i.stateNode;throw Error(a(33))}function Qt(i){var o=i[Pe];return o||(o=i[Pe]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Gt(i){i[qe]=!0}var wa=new Set,Pr={};function sa(i,o){vs(i,o),vs(i+"Capture",o)}function vs(i,o){for(Pr[i]=o,i=0;i<o.length;i++)wa.add(o[i])}var Bi=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Wi={},rn={};function ki(i){return Xe.call(rn,i)?!0:Xe.call(Wi,i)?!1:Bi.test(i)?rn[i]=!0:(Wi[i]=!0,!1)}function Ca(i,o,d){if(ki(o))if(d===null)i.removeAttribute(o);else{switch(typeof d){case"undefined":case"function":case"symbol":i.removeAttribute(o);return;case"boolean":var p=o.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){i.removeAttribute(o);return}}i.setAttribute(o,""+d)}}function Vs(i,o,d){if(d===null)i.removeAttribute(o);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(o);return}i.setAttribute(o,""+d)}}function ii(i,o,d,p){if(p===null)i.removeAttribute(d);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(d);return}i.setAttributeNS(o,d,""+p)}}function ia(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function li(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Xi(i,o,d){var p=Object.getOwnPropertyDescriptor(i.constructor.prototype,o);if(!i.hasOwnProperty(o)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var y=p.get,C=p.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return y.call(this)},set:function(V){d=""+V,C.call(this,V)}}),Object.defineProperty(i,o,{enumerable:p.enumerable}),{getValue:function(){return d},setValue:function(V){d=""+V},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function Pl(i){if(!i._valueTracker){var o=li(i)?"checked":"value";i._valueTracker=Xi(i,o,""+i[o])}}function Ko(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var d=o.getValue(),p="";return i&&(p=li(i)?i.checked?"true":"false":i.value),i=p,i!==d?(o.setValue(i),!0):!1}function ws(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var Fa=/[\n"\\]/g;function an(i){return i.replace(Fa,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function mA(i,o,d,p,y,C,V,ce){i.name="",V!=null&&typeof V!="function"&&typeof V!="symbol"&&typeof V!="boolean"?i.type=V:i.removeAttribute("type"),o!=null?V==="number"?(o===0&&i.value===""||i.value!=o)&&(i.value=""+ia(o)):i.value!==""+ia(o)&&(i.value=""+ia(o)):V!=="submit"&&V!=="reset"||i.removeAttribute("value"),o!=null?xA(i,V,ia(o)):d!=null?xA(i,V,ia(d)):p!=null&&i.removeAttribute("value"),y==null&&C!=null&&(i.defaultChecked=!!C),y!=null&&(i.checked=y&&typeof y!="function"&&typeof y!="symbol"),ce!=null&&typeof ce!="function"&&typeof ce!="symbol"&&typeof ce!="boolean"?i.name=""+ia(ce):i.removeAttribute("name")}function oi(i,o,d,p,y,C,V,ce){if(C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(i.type=C),o!=null||d!=null){if(!(C!=="submit"&&C!=="reset"||o!=null)){Pl(i);return}d=d!=null?""+ia(d):"",o=o!=null?""+ia(o):d,ce||o===i.value||(i.value=o),i.defaultValue=o}p=p??y,p=typeof p!="function"&&typeof p!="symbol"&&!!p,i.checked=ce?i.checked:!!p,i.defaultChecked=!!p,V!=null&&typeof V!="function"&&typeof V!="symbol"&&typeof V!="boolean"&&(i.name=V),Pl(i)}function xA(i,o,d){o==="number"&&ws(i.ownerDocument)===i||i.defaultValue===""+d||(i.defaultValue=""+d)}function hn(i,o,d,p){if(i=i.options,o){o={};for(var y=0;y<d.length;y++)o["$"+d[y]]=!0;for(d=0;d<i.length;d++)y=o.hasOwnProperty("$"+i[d].value),i[d].selected!==y&&(i[d].selected=y),y&&p&&(i[d].defaultSelected=!0)}else{for(d=""+ia(d),o=null,y=0;y<i.length;y++){if(i[y].value===d){i[y].selected=!0,p&&(i[y].defaultSelected=!0);return}o!==null||i[y].disabled||(o=i[y])}o!==null&&(o.selected=!0)}}function qo(i,o,d){if(o!=null&&(o=""+ia(o),o!==i.value&&(i.value=o),d==null)){i.defaultValue!==o&&(i.defaultValue=o);return}i.defaultValue=d!=null?""+ia(d):""}function Kl(i,o,d,p){if(o==null){if(p!=null){if(d!=null)throw Error(a(92));if(ue(p)){if(1<p.length)throw Error(a(93));p=p[0]}d=p}d==null&&(d=""),o=d}d=ia(o),i.defaultValue=d,p=i.textContent,p===d&&p!==""&&p!==null&&(i.value=p),Pl(i)}function Ci(i,o){if(o){var d=i.firstChild;if(d&&d===i.lastChild&&d.nodeType===3){d.nodeValue=o;return}}i.textContent=o}var ql=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function bA(i,o,d){var p=o.indexOf("--")===0;d==null||typeof d=="boolean"||d===""?p?i.setProperty(o,""):o==="float"?i.cssFloat="":i[o]="":p?i.setProperty(o,d):typeof d!="number"||d===0||ql.has(o)?o==="float"?i.cssFloat=d:i[o]=(""+d).trim():i[o]=d+"px"}function oc(i,o,d){if(o!=null&&typeof o!="object")throw Error(a(62));if(i=i.style,d!=null){for(var p in d)!d.hasOwnProperty(p)||o!=null&&o.hasOwnProperty(p)||(p.indexOf("--")===0?i.setProperty(p,""):p==="float"?i.cssFloat="":i[p]="");for(var y in o)p=o[y],o.hasOwnProperty(y)&&d[y]!==p&&bA(i,y,p)}else for(var C in o)o.hasOwnProperty(C)&&bA(i,C,o[C])}function vA(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ac=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Yi=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ta(i){return Yi.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function Us(){}var ys=null;function _s(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var po=null,_r=null;function ma(i){var o=Rt(i);if(o&&(i=o.stateNode)){var d=i[K]||null;e:switch(i=o.stateNode,o.type){case"input":if(mA(i,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name),o=d.name,d.type==="radio"&&o!=null){for(d=i;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll('input[name="'+an(""+o)+'"][type="radio"]'),o=0;o<d.length;o++){var p=d[o];if(p!==i&&p.form===i.form){var y=p[K]||null;if(!y)throw Error(a(90));mA(p,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(o=0;o<d.length;o++)p=d[o],p.form===i.form&&Ko(p)}break e;case"textarea":qo(i,d.value,d.defaultValue);break e;case"select":o=d.value,o!=null&&hn(i,!!d.multiple,o,!1)}}}var $i=!1;function cc(i,o,d){if($i)return i(o,d);$i=!0;try{var p=i(o);return p}finally{if($i=!1,(po!==null||_r!==null)&&(wg(),po&&(o=po,i=_r,_r=po=null,ma(o),i)))for(o=0;o<i.length;o++)ma(i[o])}}function Ga(i,o){var d=i.stateNode;if(d===null)return null;var p=d[K]||null;if(p===null)return null;d=p[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(i=i.type,p=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!p;break e;default:i=!1}if(i)return null;if(d&&typeof d!="function")throw Error(a(231,o,typeof d));return d}var Kn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),go=!1;if(Kn)try{var jn={};Object.defineProperty(jn,"passive",{get:function(){go=!0}}),window.addEventListener("test",jn,jn),window.removeEventListener("test",jn,jn)}catch{go=!1}var Bs=null,zl=null,qn=null;function Yc(){if(qn)return qn;var i,o=zl,d=o.length,p,y="value"in Bs?Bs.value:Bs.textContent,C=y.length;for(i=0;i<d&&o[i]===y[i];i++);var V=d-i;for(p=1;p<=V&&o[d-p]===y[C-p];p++);return qn=y.slice(i,1<p?1-p:void 0)}function Si(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function zo(){return!0}function wA(){return!1}function zn(i){function o(d,p,y,C,V){this._reactName=d,this._targetInst=y,this.type=p,this.nativeEvent=C,this.target=V,this.currentTarget=null;for(var ce in i)i.hasOwnProperty(ce)&&(d=i[ce],this[ce]=d?d(C):C[ce]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?zo:wA,this.isPropagationStopped=wA,this}return g(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=zo)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=zo)},persist:function(){},isPersistent:zo}),o}var Al={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ai=zn(Al),cl=g({},Al,{view:0,detail:0}),Vn=zn(cl),mo,Vl,ul,Vo=g({},cl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kr,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==ul&&(ul&&i.type==="mousemove"?(mo=i.screenX-ul.screenX,Vl=i.screenY-ul.screenY):Vl=mo=0,ul=i),mo)},movementY:function(i){return"movementY"in i?i.movementY:Vl}}),yA=zn(Vo),dl=g({},Vo,{dataTransfer:0}),Gl=zn(dl),$c=g({},cl,{relatedTarget:0}),Wl=zn($c),uc=g({},Al,{animationName:0,elapsedTime:0,pseudoElement:0}),E=zn(uc),ee=g({},Al,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Be=zn(ee),Ne=g({},Al,{data:0}),Ke=zn(Ne),At={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wt={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ar(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=tr[i])?!!o[i]:!1}function kr(){return Ar}var Dr=g({},cl,{key:function(i){if(i.key){var o=At[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=Si(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?wt[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kr,charCode:function(i){return i.type==="keypress"?Si(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Si(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),ea=zn(Dr),nn=g({},Vo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),un=zn(nn),La=g({},cl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kr}),pn=zn(La),Cn=g({},Al,{propertyName:0,elapsedTime:0,pseudoElement:0}),ss=zn(Cn),fl=g({},Vo,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Ji=zn(fl),Xl=g({},Al,{newState:0,oldState:0}),dc=zn(Xl),_A=[9,13,27,32],Ei=Kn&&"CompositionEvent"in window,Ni=null;Kn&&"documentMode"in document&&(Ni=document.documentMode);var Go=Kn&&"TextEvent"in window&&!Ni,Yl=Kn&&(!Ei||Ni&&8<Ni&&11>=Ni),gn=" ",Dn=!1;function hl(i,o){switch(i){case"keyup":return _A.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function BA(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Fi=!1;function Sn(i,o){switch(i){case"compositionend":return BA(o);case"keypress":return o.which!==32?null:(Dn=!0,gn);case"textInput":return i=o.data,i===gn&&Dn?null:i;default:return null}}function $l(i,o){if(Fi)return i==="compositionend"||!Ei&&hl(i,o)?(i=Yc(),qn=zl=Bs=null,Fi=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Yl&&o.locale!=="ko"?null:o.data;default:return null}}var kA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ne(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!kA[i.type]:o==="textarea"}function De(i,o,d,p){po?_r?_r.push(p):_r=[p]:po=p,o=Eg(o,"onChange"),0<o.length&&(d=new Ai("onChange","change",null,d,p),i.push({event:d,listeners:o}))}var ut=null,Ft=null;function ur(i){f5(i,0)}function dr(i){var o=Ct(i);if(Ko(o))return i}function qr(i,o){if(i==="change")return o}var Fr=!1;if(Kn){var mr;if(Kn){var $r="oninput"in document;if(!$r){var sn=document.createElement("div");sn.setAttribute("oninput","return;"),$r=typeof sn.oninput=="function"}mr=$r}else mr=!1;Fr=mr&&(!document.documentMode||9<document.documentMode)}function Tr(){ut&&(ut.detachEvent("onpropertychange",xr),Ft=ut=null)}function xr(i){if(i.propertyName==="value"&&dr(Ft)){var o=[];De(o,Ft,i,_s(i)),cc(ur,o)}}function ta(i,o,d){i==="focusin"?(Tr(),ut=o,Ft=d,ut.attachEvent("onpropertychange",xr)):i==="focusout"&&Tr()}function ra(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return dr(Ft)}function js(i,o){if(i==="click")return dr(o)}function mn(i,o){if(i==="input"||i==="change")return dr(o)}function pl(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var is=typeof Object.is=="function"?Object.is:pl;function gl(i,o){if(is(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var d=Object.keys(i),p=Object.keys(o);if(d.length!==p.length)return!1;for(p=0;p<d.length;p++){var y=d[p];if(!Xe.call(o,y)||!is(i[y],o[y]))return!1}return!0}function CA(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function ml(i,o){var d=CA(i);i=0;for(var p;d;){if(d.nodeType===3){if(p=i+d.textContent.length,i<=o&&p>=o)return{node:d,offset:o-i};i=p}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=CA(d)}}function Jl(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?Jl(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function ci(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var o=ws(i.document);o instanceof i.HTMLIFrameElement;){try{var d=typeof o.contentWindow.location.href=="string"}catch{d=!1}if(d)i=o.contentWindow;else break;o=ws(i.document)}return o}function Ti(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}var Wo=Kn&&"documentMode"in document&&11>=document.documentMode,ui=null,di=null,cr=null,In=!1;function ya(i,o,d){var p=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;In||ui==null||ui!==ws(p)||(p=ui,"selectionStart"in p&&Ti(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),cr&&gl(cr,p)||(cr=p,p=Eg(di,"onSelect"),0<p.length&&(o=new Ai("onSelect","select",null,o,d),i.push({event:o,listeners:p}),o.target=ui)))}function ha(i,o){var d={};return d[i.toLowerCase()]=o.toLowerCase(),d["Webkit"+i]="webkit"+o,d["Moz"+i]="moz"+o,d}var Wa={animationend:ha("Animation","AnimationEnd"),animationiteration:ha("Animation","AnimationIteration"),animationstart:ha("Animation","AnimationStart"),transitionrun:ha("Transition","TransitionRun"),transitionstart:ha("Transition","TransitionStart"),transitioncancel:ha("Transition","TransitionCancel"),transitionend:ha("Transition","TransitionEnd")},Qn={},xo={};Kn&&(xo=document.createElement("div").style,"AnimationEvent"in window||(delete Wa.animationend.animation,delete Wa.animationiteration.animation,delete Wa.animationstart.animation),"TransitionEvent"in window||delete Wa.transitionend.transition);function Zl(i){if(Qn[i])return Qn[i];if(!Wa[i])return i;var o=Wa[i],d;for(d in o)if(o.hasOwnProperty(d)&&d in xo)return Qn[i]=o[d];return i}var fc=Zl("animationend"),r0=Zl("animationiteration"),Df=Zl("animationstart"),$p=Zl("transitionrun"),Jp=Zl("transitionstart"),Zp=Zl("transitioncancel"),If=Zl("transitionend"),Qf=new Map,hc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");hc.push("scrollEnd");function xl(i,o){Qf.set(i,o),sa(o,[i])}var a0=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},Zi=[],pc=0,Z0=0;function n0(){for(var i=pc,o=Z0=pc=0;o<i;){var d=Zi[o];Zi[o++]=null;var p=Zi[o];Zi[o++]=null;var y=Zi[o];Zi[o++]=null;var C=Zi[o];if(Zi[o++]=null,p!==null&&y!==null){var V=p.pending;V===null?y.next=y:(y.next=V.next,V.next=y),p.pending=y}C!==0&&i0(d,y,C)}}function s0(i,o,d,p){Zi[pc++]=i,Zi[pc++]=o,Zi[pc++]=d,Zi[pc++]=p,Z0|=p,i.lanes|=p,i=i.alternate,i!==null&&(i.lanes|=p)}function ed(i,o,d,p){return s0(i,o,d,p),Gs(i)}function Xo(i,o){return s0(i,null,null,o),Gs(i)}function i0(i,o,d){i.lanes|=d;var p=i.alternate;p!==null&&(p.lanes|=d);for(var y=!1,C=i.return;C!==null;)C.childLanes|=d,p=C.alternate,p!==null&&(p.childLanes|=d),C.tag===22&&(i=C.stateNode,i===null||i._visibility&1||(y=!0)),i=C,C=C.return;return i.tag===3?(C=i.stateNode,y&&o!==null&&(y=31-it(d),i=C.hiddenUpdates,p=i[y],p===null?i[y]=[o]:p.push(o),o.lane=d|536870912),C):null}function Gs(i){if(50<sh)throw sh=0,J1=null,Error(a(185));for(var o=i.return;o!==null;)i=o,o=i.return;return i.tag===3?i.stateNode:null}var Ds={};function td(i,o,d,p){this.tag=i,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ws(i,o,d,p){return new td(i,o,d,p)}function rd(i){return i=i.prototype,!(!i||!i.isReactComponent)}function bl(i,o){var d=i.alternate;return d===null?(d=Ws(i.tag,o,i.key,i.mode),d.elementType=i.elementType,d.type=i.type,d.stateNode=i.stateNode,d.alternate=i,i.alternate=d):(d.pendingProps=o,d.type=i.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=i.flags&65011712,d.childLanes=i.childLanes,d.lanes=i.lanes,d.child=i.child,d.memoizedProps=i.memoizedProps,d.memoizedState=i.memoizedState,d.updateQueue=i.updateQueue,o=i.dependencies,d.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},d.sibling=i.sibling,d.index=i.index,d.ref=i.ref,d.refCleanup=i.refCleanup,d}function l0(i,o){i.flags&=65011714;var d=i.alternate;return d===null?(i.childLanes=0,i.lanes=o,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=d.childLanes,i.lanes=d.lanes,i.child=d.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=d.memoizedProps,i.memoizedState=d.memoizedState,i.updateQueue=d.updateQueue,i.type=d.type,o=d.dependencies,i.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),i}function Jc(i,o,d,p,y,C){var V=0;if(p=i,typeof i=="function")rd(i)&&(V=1);else if(typeof i=="string")V=X6(i,d,M.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case j:return i=Ws(31,d,o,y),i.elementType=j,i.lanes=C,i;case v:return SA(d.children,y,C,o);case B:V=8,y|=24;break;case k:return i=Ws(12,d,o,y|2),i.elementType=k,i.lanes=C,i;case T:return i=Ws(13,d,o,y),i.elementType=T,i.lanes=C,i;case U:return i=Ws(19,d,o,y),i.elementType=U,i.lanes=C,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case S:V=10;break e;case N:V=9;break e;case O:V=11;break e;case D:V=14;break e;case H:V=16,p=null;break e}V=29,d=Error(a(130,i===null?"null":typeof i,"")),p=null}return o=Ws(V,d,o,y),o.elementType=i,o.type=p,o.lanes=C,o}function SA(i,o,d,p){return i=Ws(7,i,p,o),i.lanes=d,i}function o0(i,o,d){return i=Ws(6,i,null,o),i.lanes=d,i}function ad(i){var o=Ws(18,null,null,0);return o.stateNode=i,o}function Zc(i,o,d){return o=Ws(4,i.children!==null?i.children:[],i.key,o),o.lanes=d,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}var nd=new WeakMap;function vl(i,o){if(typeof i=="object"&&i!==null){var d=nd.get(i);return d!==void 0?d:(o={value:i,source:o,stack:ct(o)},nd.set(i,o),o)}return{value:i,source:o,stack:ct(o)}}var eu=[],gc=0,sd=null,A0=0,wl=[],yl=0,EA=null,_l=1,Bl="";function el(i,o){eu[gc++]=A0,eu[gc++]=sd,sd=i,A0=o}function eg(i,o,d){wl[yl++]=_l,wl[yl++]=Bl,wl[yl++]=EA,EA=i;var p=_l;i=Bl;var y=32-it(p)-1;p&=~(1<<y),d+=1;var C=32-it(o)+y;if(30<C){var V=y-y%5;C=(p&(1<<V)-1).toString(32),p>>=V,y-=V,_l=1<<32-it(o)+y|d<<y|p,Bl=C+i}else _l=1<<C|d<<y|p,Bl=i}function Of(i){i.return!==null&&(el(i,1),eg(i,1,0))}function id(i){for(;i===sd;)sd=eu[--gc],eu[gc]=null,A0=eu[--gc],eu[gc]=null;for(;i===EA;)EA=wl[--yl],wl[yl]=null,Bl=wl[--yl],wl[yl]=null,_l=wl[--yl],wl[yl]=null}function tg(i,o){wl[yl++]=_l,wl[yl++]=Bl,wl[yl++]=EA,_l=o.id,Bl=o.overflow,EA=i}var Is=null,ln=null,la=!1,fi=null,En=!1,eo=Error(a(519));function NA(i){var o=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw tu(vl(o,i)),eo}function Rf(i){var o=i.stateNode,d=i.type,p=i.memoizedProps;switch(o[pe]=i,o[K]=p,d){case"dialog":Aa("cancel",o),Aa("close",o);break;case"iframe":case"object":case"embed":Aa("load",o);break;case"video":case"audio":for(d=0;d<lh.length;d++)Aa(lh[d],o);break;case"source":Aa("error",o);break;case"img":case"image":case"link":Aa("error",o),Aa("load",o);break;case"details":Aa("toggle",o);break;case"input":Aa("invalid",o),oi(o,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0);break;case"select":Aa("invalid",o);break;case"textarea":Aa("invalid",o),Kl(o,p.value,p.defaultValue,p.children)}d=p.children,typeof d!="string"&&typeof d!="number"&&typeof d!="bigint"||o.textContent===""+d||p.suppressHydrationWarning===!0||m5(o.textContent,d)?(p.popover!=null&&(Aa("beforetoggle",o),Aa("toggle",o)),p.onScroll!=null&&Aa("scroll",o),p.onScrollEnd!=null&&Aa("scrollend",o),p.onClick!=null&&(o.onclick=Us),o=!0):o=!1,o||NA(i,!0)}function Yo(i){for(Is=i.return;Is;)switch(Is.tag){case 5:case 31:case 13:En=!1;return;case 27:case 3:En=!0;return;default:Is=Is.return}}function Qs(i){if(i!==Is)return!1;if(!la)return Yo(i),la=!0,!1;var o=i.tag,d;if((d=o!==3&&o!==27)&&((d=o===5)&&(d=i.type,d=!(d!=="form"&&d!=="button")||fb(i.type,i.memoizedProps)),d=!d),d&&ln&&NA(i),Yo(i),o===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(317));ln=C5(i)}else if(o===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(317));ln=C5(i)}else o===27?(o=ln,pu(i.type)?(i=xb,xb=null,ln=i):ln=o):ln=Is?yo(i.stateNode.nextSibling):null;return!0}function mc(){ln=Is=null,la=!1}function Mf(){var i=fi;return i!==null&&(Fl===null?Fl=i:Fl.push.apply(Fl,i),fi=null),i}function tu(i){fi===null?fi=[i]:fi.push(i)}var ld=we(null),FA=null,bo=null;function TA(i,o,d){R(ld,o._currentValue),o._currentValue=d}function kl(i){i._currentValue=ld.current,F(ld)}function ru(i,o,d){for(;i!==null;){var p=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,p!==null&&(p.childLanes|=o)):p!==null&&(p.childLanes&o)!==o&&(p.childLanes|=o),i===d)break;i=i.return}}function xc(i,o,d,p){var y=i.child;for(y!==null&&(y.return=i);y!==null;){var C=y.dependencies;if(C!==null){var V=y.child;C=C.firstContext;e:for(;C!==null;){var ce=C;C=y;for(var Te=0;Te<o.length;Te++)if(ce.context===o[Te]){C.lanes|=d,ce=C.alternate,ce!==null&&(ce.lanes|=d),ru(C.return,d,i),p||(V=null);break e}C=ce.next}}else if(y.tag===18){if(V=y.return,V===null)throw Error(a(341));V.lanes|=d,C=V.alternate,C!==null&&(C.lanes|=d),ru(V,d,i),V=null}else V=y.child;if(V!==null)V.return=y;else for(V=y;V!==null;){if(V===i){V=null;break}if(y=V.sibling,y!==null){y.return=V.return,V=y;break}V=V.return}y=V}}function LA(i,o,d,p){i=null;for(var y=o,C=!1;y!==null;){if(!C){if((y.flags&524288)!==0)C=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var V=y.alternate;if(V===null)throw Error(a(387));if(V=V.memoizedProps,V!==null){var ce=y.type;is(y.pendingProps.value,V.value)||(i!==null?i.push(ce):i=[ce])}}else if(y===ge.current){if(V=y.alternate,V===null)throw Error(a(387));V.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(i!==null?i.push(dh):i=[dh])}y=y.return}i!==null&&xc(o,i,d,p),o.flags|=262144}function od(i){for(i=i.firstContext;i!==null;){if(!is(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function UA(i){FA=i,bo=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Os(i){return rg(FA,i)}function Ad(i,o){return FA===null&&UA(i),rg(i,o)}function rg(i,o){var d=o._currentValue;if(o={context:o,memoizedValue:d,next:null},bo===null){if(i===null)throw Error(a(308));bo=o,i.dependencies={lanes:0,firstContext:o},i.flags|=524288}else bo=bo.next=o;return d}var m1=typeof AbortController<"u"?AbortController:function(){var i=[],o=this.signal={aborted:!1,addEventListener:function(d,p){i.push(p)}};this.abort=function(){o.aborted=!0,i.forEach(function(d){return d()})}},x1=e.unstable_scheduleCallback,b1=e.unstable_NormalPriority,On={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function au(){return{controller:new m1,data:new Map,refCount:0}}function c0(i){i.refCount--,i.refCount===0&&x1(b1,function(){i.controller.abort()})}var u0=null,cd=0,b=0,_=null;function L(i,o){if(u0===null){var d=u0=[];cd=0,b=nb(),_={status:"pending",value:void 0,then:function(p){d.push(p)}}}return cd++,o.then(q,q),o}function q(){if(--cd===0&&u0!==null){_!==null&&(_.status="fulfilled");var i=u0;u0=null,b=0,_=null;for(var o=0;o<i.length;o++)(0,i[o])()}}function te(i,o){var d=[],p={status:"pending",value:null,reason:null,then:function(y){d.push(y)}};return i.then(function(){p.status="fulfilled",p.value=o;for(var y=0;y<d.length;y++)(0,d[y])(o)},function(y){for(p.status="rejected",p.reason=y,y=0;y<d.length;y++)(0,d[y])(void 0)}),p}var le=Z.S;Z.S=function(i,o){H_=jt(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&L(i,o),le!==null&&le(i,o)};var oe=we(null);function he(){var i=oe.current;return i!==null?i:An.pooledCache}function me(i,o){o===null?R(oe,oe.current):R(oe,o.pool)}function ke(){var i=he();return i===null?null:{parent:On._currentValue,pool:i}}var Ue=Error(a(460)),Ye=Error(a(474)),ye=Error(a(542)),Oe={then:function(){}};function Ge(i){return i=i.status,i==="fulfilled"||i==="rejected"}function st(i,o,d){switch(d=i[d],d===void 0?i.push(o):d!==o&&(o.then(Us,Us),o=d),o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,St(i),i;default:if(typeof o.status=="string")o.then(Us,Us);else{if(i=An,i!==null&&100<i.shellSuspendCounter)throw Error(a(482));i=o,i.status="pending",i.then(function(p){if(o.status==="pending"){var y=o;y.status="fulfilled",y.value=p}},function(p){if(o.status==="pending"){var y=o;y.status="rejected",y.reason=p}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,St(i),i}throw nt=o,Ue}}function We(i){try{var o=i._init;return o(i._payload)}catch(d){throw d!==null&&typeof d=="object"&&typeof d.then=="function"?(nt=d,Ue):d}}var nt=null;function dt(){if(nt===null)throw Error(a(459));var i=nt;return nt=null,i}function St(i){if(i===Ue||i===ye)throw Error(a(483))}var vt=null,lr=0;function Zt(i){var o=lr;return lr+=1,vt===null&&(vt=[]),st(vt,i,o)}function Or(i,o){o=o.props.ref,i.ref=o!==void 0?o:null}function nr(i,o){throw o.$$typeof===x?Error(a(525)):(i=Object.prototype.toString.call(o),Error(a(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i)))}function aa(i){function o(Ve,Ie){if(i){var $e=Ve.deletions;$e===null?(Ve.deletions=[Ie],Ve.flags|=16):$e.push(Ie)}}function d(Ve,Ie){if(!i)return null;for(;Ie!==null;)o(Ve,Ie),Ie=Ie.sibling;return null}function p(Ve){for(var Ie=new Map;Ve!==null;)Ve.key!==null?Ie.set(Ve.key,Ve):Ie.set(Ve.index,Ve),Ve=Ve.sibling;return Ie}function y(Ve,Ie){return Ve=bl(Ve,Ie),Ve.index=0,Ve.sibling=null,Ve}function C(Ve,Ie,$e){return Ve.index=$e,i?($e=Ve.alternate,$e!==null?($e=$e.index,$e<Ie?(Ve.flags|=67108866,Ie):$e):(Ve.flags|=67108866,Ie)):(Ve.flags|=1048576,Ie)}function V(Ve){return i&&Ve.alternate===null&&(Ve.flags|=67108866),Ve}function ce(Ve,Ie,$e,ft){return Ie===null||Ie.tag!==6?(Ie=o0($e,Ve.mode,ft),Ie.return=Ve,Ie):(Ie=y(Ie,$e),Ie.return=Ve,Ie)}function Te(Ve,Ie,$e,ft){var wr=$e.type;return wr===v?ot(Ve,Ie,$e.props.children,ft,$e.key):Ie!==null&&(Ie.elementType===wr||typeof wr=="object"&&wr!==null&&wr.$$typeof===H&&We(wr)===Ie.type)?(Ie=y(Ie,$e.props),Or(Ie,$e),Ie.return=Ve,Ie):(Ie=Jc($e.type,$e.key,$e.props,null,Ve.mode,ft),Or(Ie,$e),Ie.return=Ve,Ie)}function Je(Ve,Ie,$e,ft){return Ie===null||Ie.tag!==4||Ie.stateNode.containerInfo!==$e.containerInfo||Ie.stateNode.implementation!==$e.implementation?(Ie=Zc($e,Ve.mode,ft),Ie.return=Ve,Ie):(Ie=y(Ie,$e.children||[]),Ie.return=Ve,Ie)}function ot(Ve,Ie,$e,ft,wr){return Ie===null||Ie.tag!==7?(Ie=SA($e,Ve.mode,ft,wr),Ie.return=Ve,Ie):(Ie=y(Ie,$e),Ie.return=Ve,Ie)}function gt(Ve,Ie,$e){if(typeof Ie=="string"&&Ie!==""||typeof Ie=="number"||typeof Ie=="bigint")return Ie=o0(""+Ie,Ve.mode,$e),Ie.return=Ve,Ie;if(typeof Ie=="object"&&Ie!==null){switch(Ie.$$typeof){case m:return $e=Jc(Ie.type,Ie.key,Ie.props,null,Ve.mode,$e),Or($e,Ie),$e.return=Ve,$e;case w:return Ie=Zc(Ie,Ve.mode,$e),Ie.return=Ve,Ie;case H:return Ie=We(Ie),gt(Ve,Ie,$e)}if(ue(Ie)||Q(Ie))return Ie=SA(Ie,Ve.mode,$e,null),Ie.return=Ve,Ie;if(typeof Ie.then=="function")return gt(Ve,Zt(Ie),$e);if(Ie.$$typeof===S)return gt(Ve,Ad(Ve,Ie),$e);nr(Ve,Ie)}return null}function Ze(Ve,Ie,$e,ft){var wr=Ie!==null?Ie.key:null;if(typeof $e=="string"&&$e!==""||typeof $e=="number"||typeof $e=="bigint")return wr!==null?null:ce(Ve,Ie,""+$e,ft);if(typeof $e=="object"&&$e!==null){switch($e.$$typeof){case m:return $e.key===wr?Te(Ve,Ie,$e,ft):null;case w:return $e.key===wr?Je(Ve,Ie,$e,ft):null;case H:return $e=We($e),Ze(Ve,Ie,$e,ft)}if(ue($e)||Q($e))return wr!==null?null:ot(Ve,Ie,$e,ft,null);if(typeof $e.then=="function")return Ze(Ve,Ie,Zt($e),ft);if($e.$$typeof===S)return Ze(Ve,Ie,Ad(Ve,$e),ft);nr(Ve,$e)}return null}function rt(Ve,Ie,$e,ft,wr){if(typeof ft=="string"&&ft!==""||typeof ft=="number"||typeof ft=="bigint")return Ve=Ve.get($e)||null,ce(Ie,Ve,""+ft,wr);if(typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case m:return Ve=Ve.get(ft.key===null?$e:ft.key)||null,Te(Ie,Ve,ft,wr);case w:return Ve=Ve.get(ft.key===null?$e:ft.key)||null,Je(Ie,Ve,ft,wr);case H:return ft=We(ft),rt(Ve,Ie,$e,ft,wr)}if(ue(ft)||Q(ft))return Ve=Ve.get($e)||null,ot(Ie,Ve,ft,wr,null);if(typeof ft.then=="function")return rt(Ve,Ie,$e,Zt(ft),wr);if(ft.$$typeof===S)return rt(Ve,Ie,$e,Ad(Ie,ft),wr);nr(Ie,ft)}return null}function sr(Ve,Ie,$e,ft){for(var wr=null,Sa=null,fr=Ie,Xr=Ie=0,da=null;fr!==null&&Xr<$e.length;Xr++){fr.index>Xr?(da=fr,fr=null):da=fr.sibling;var Ea=Ze(Ve,fr,$e[Xr],ft);if(Ea===null){fr===null&&(fr=da);break}i&&fr&&Ea.alternate===null&&o(Ve,fr),Ie=C(Ea,Ie,Xr),Sa===null?wr=Ea:Sa.sibling=Ea,Sa=Ea,fr=da}if(Xr===$e.length)return d(Ve,fr),la&&el(Ve,Xr),wr;if(fr===null){for(;Xr<$e.length;Xr++)fr=gt(Ve,$e[Xr],ft),fr!==null&&(Ie=C(fr,Ie,Xr),Sa===null?wr=fr:Sa.sibling=fr,Sa=fr);return la&&el(Ve,Xr),wr}for(fr=p(fr);Xr<$e.length;Xr++)da=rt(fr,Ve,Xr,$e[Xr],ft),da!==null&&(i&&da.alternate!==null&&fr.delete(da.key===null?Xr:da.key),Ie=C(da,Ie,Xr),Sa===null?wr=da:Sa.sibling=da,Sa=da);return i&&fr.forEach(function(vu){return o(Ve,vu)}),la&&el(Ve,Xr),wr}function Nr(Ve,Ie,$e,ft){if($e==null)throw Error(a(151));for(var wr=null,Sa=null,fr=Ie,Xr=Ie=0,da=null,Ea=$e.next();fr!==null&&!Ea.done;Xr++,Ea=$e.next()){fr.index>Xr?(da=fr,fr=null):da=fr.sibling;var vu=Ze(Ve,fr,Ea.value,ft);if(vu===null){fr===null&&(fr=da);break}i&&fr&&vu.alternate===null&&o(Ve,fr),Ie=C(vu,Ie,Xr),Sa===null?wr=vu:Sa.sibling=vu,Sa=vu,fr=da}if(Ea.done)return d(Ve,fr),la&&el(Ve,Xr),wr;if(fr===null){for(;!Ea.done;Xr++,Ea=$e.next())Ea=gt(Ve,Ea.value,ft),Ea!==null&&(Ie=C(Ea,Ie,Xr),Sa===null?wr=Ea:Sa.sibling=Ea,Sa=Ea);return la&&el(Ve,Xr),wr}for(fr=p(fr);!Ea.done;Xr++,Ea=$e.next())Ea=rt(fr,Ve,Xr,Ea.value,ft),Ea!==null&&(i&&Ea.alternate!==null&&fr.delete(Ea.key===null?Xr:Ea.key),Ie=C(Ea,Ie,Xr),Sa===null?wr=Ea:Sa.sibling=Ea,Sa=Ea);return i&&fr.forEach(function(i8){return o(Ve,i8)}),la&&el(Ve,Xr),wr}function Ja(Ve,Ie,$e,ft){if(typeof $e=="object"&&$e!==null&&$e.type===v&&$e.key===null&&($e=$e.props.children),typeof $e=="object"&&$e!==null){switch($e.$$typeof){case m:e:{for(var wr=$e.key;Ie!==null;){if(Ie.key===wr){if(wr=$e.type,wr===v){if(Ie.tag===7){d(Ve,Ie.sibling),ft=y(Ie,$e.props.children),ft.return=Ve,Ve=ft;break e}}else if(Ie.elementType===wr||typeof wr=="object"&&wr!==null&&wr.$$typeof===H&&We(wr)===Ie.type){d(Ve,Ie.sibling),ft=y(Ie,$e.props),Or(ft,$e),ft.return=Ve,Ve=ft;break e}d(Ve,Ie);break}else o(Ve,Ie);Ie=Ie.sibling}$e.type===v?(ft=SA($e.props.children,Ve.mode,ft,$e.key),ft.return=Ve,Ve=ft):(ft=Jc($e.type,$e.key,$e.props,null,Ve.mode,ft),Or(ft,$e),ft.return=Ve,Ve=ft)}return V(Ve);case w:e:{for(wr=$e.key;Ie!==null;){if(Ie.key===wr)if(Ie.tag===4&&Ie.stateNode.containerInfo===$e.containerInfo&&Ie.stateNode.implementation===$e.implementation){d(Ve,Ie.sibling),ft=y(Ie,$e.children||[]),ft.return=Ve,Ve=ft;break e}else{d(Ve,Ie);break}else o(Ve,Ie);Ie=Ie.sibling}ft=Zc($e,Ve.mode,ft),ft.return=Ve,Ve=ft}return V(Ve);case H:return $e=We($e),Ja(Ve,Ie,$e,ft)}if(ue($e))return sr(Ve,Ie,$e,ft);if(Q($e)){if(wr=Q($e),typeof wr!="function")throw Error(a(150));return $e=wr.call($e),Nr(Ve,Ie,$e,ft)}if(typeof $e.then=="function")return Ja(Ve,Ie,Zt($e),ft);if($e.$$typeof===S)return Ja(Ve,Ie,Ad(Ve,$e),ft);nr(Ve,$e)}return typeof $e=="string"&&$e!==""||typeof $e=="number"||typeof $e=="bigint"?($e=""+$e,Ie!==null&&Ie.tag===6?(d(Ve,Ie.sibling),ft=y(Ie,$e),ft.return=Ve,Ve=ft):(d(Ve,Ie),ft=o0($e,Ve.mode,ft),ft.return=Ve,Ve=ft),V(Ve)):d(Ve,Ie)}return function(Ve,Ie,$e,ft){try{lr=0;var wr=Ja(Ve,Ie,$e,ft);return vt=null,wr}catch(fr){if(fr===Ue||fr===ye)throw fr;var Sa=Ws(29,fr,null,Ve.mode);return Sa.lanes=ft,Sa.return=Ve,Sa}}}var on=aa(!0),zr=aa(!1),er=!1;function Kt(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function xn(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Cr(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Gr(i,o,d){var p=i.updateQueue;if(p===null)return null;if(p=p.shared,(Da&2)!==0){var y=p.pending;return y===null?o.next=o:(o.next=y.next,y.next=o),p.pending=o,o=Gs(i),i0(i,null,d),o}return s0(i,p,o,d),Gs(i)}function Ua(i,o,d){if(o=o.updateQueue,o!==null&&(o=o.shared,(d&4194048)!==0)){var p=o.lanes;p&=i.pendingLanes,d|=p,o.lanes=d,Hr(i,d)}}function ls(i,o){var d=i.updateQueue,p=i.alternate;if(p!==null&&(p=p.updateQueue,d===p)){var y=null,C=null;if(d=d.firstBaseUpdate,d!==null){do{var V={lane:d.lane,tag:d.tag,payload:d.payload,callback:null,next:null};C===null?y=C=V:C=C.next=V,d=d.next}while(d!==null);C===null?y=C=o:C=C.next=o}else y=C=o;d={baseState:p.baseState,firstBaseUpdate:y,lastBaseUpdate:C,shared:p.shared,callbacks:p.callbacks},i.updateQueue=d;return}i=d.lastBaseUpdate,i===null?d.firstBaseUpdate=o:i.next=o,d.lastBaseUpdate=o}var Rs=!1;function Xa(){if(Rs){var i=_;if(i!==null)throw i}}function Gn(i,o,d,p){Rs=!1;var y=i.updateQueue;er=!1;var C=y.firstBaseUpdate,V=y.lastBaseUpdate,ce=y.shared.pending;if(ce!==null){y.shared.pending=null;var Te=ce,Je=Te.next;Te.next=null,V===null?C=Je:V.next=Je,V=Te;var ot=i.alternate;ot!==null&&(ot=ot.updateQueue,ce=ot.lastBaseUpdate,ce!==V&&(ce===null?ot.firstBaseUpdate=Je:ce.next=Je,ot.lastBaseUpdate=Te))}if(C!==null){var gt=y.baseState;V=0,ot=Je=Te=null,ce=C;do{var Ze=ce.lane&-536870913,rt=Ze!==ce.lane;if(rt?(ua&Ze)===Ze:(p&Ze)===Ze){Ze!==0&&Ze===b&&(Rs=!0),ot!==null&&(ot=ot.next={lane:0,tag:ce.tag,payload:ce.payload,callback:null,next:null});e:{var sr=i,Nr=ce;Ze=o;var Ja=d;switch(Nr.tag){case 1:if(sr=Nr.payload,typeof sr=="function"){gt=sr.call(Ja,gt,Ze);break e}gt=sr;break e;case 3:sr.flags=sr.flags&-65537|128;case 0:if(sr=Nr.payload,Ze=typeof sr=="function"?sr.call(Ja,gt,Ze):sr,Ze==null)break e;gt=g({},gt,Ze);break e;case 2:er=!0}}Ze=ce.callback,Ze!==null&&(i.flags|=64,rt&&(i.flags|=8192),rt=y.callbacks,rt===null?y.callbacks=[Ze]:rt.push(Ze))}else rt={lane:Ze,tag:ce.tag,payload:ce.payload,callback:ce.callback,next:null},ot===null?(Je=ot=rt,Te=gt):ot=ot.next=rt,V|=Ze;if(ce=ce.next,ce===null){if(ce=y.shared.pending,ce===null)break;rt=ce,ce=rt.next,rt.next=null,y.lastBaseUpdate=rt,y.shared.pending=null}}while(!0);ot===null&&(Te=gt),y.baseState=Te,y.firstBaseUpdate=Je,y.lastBaseUpdate=ot,C===null&&(y.shared.lanes=0),cu|=V,i.lanes=V,i.memoizedState=gt}}function Xs(i,o){if(typeof i!="function")throw Error(a(191,i));i.call(o)}function Wn(i,o){var d=i.callbacks;if(d!==null)for(i.callbacks=null,i=0;i<d.length;i++)Xs(d[i],o)}var Jr=we(null),xa=we(0);function bn(i,o){i=Ec,R(xa,i),R(Jr,o),Ec=i|o.baseLanes}function _a(){R(xa,Ec),R(Jr,Jr.current)}function os(){Ec=xa.current,F(Jr),F(xa)}var vn=we(null),ba=null;function Rn(i){var o=i.alternate;R(pa,pa.current&1),R(vn,i),ba===null&&(o===null||Jr.current!==null||o.memoizedState!==null)&&(ba=i)}function ja(i){R(pa,pa.current),R(vn,i),ba===null&&(ba=i)}function Xn(i){i.tag===22?(R(pa,pa.current),R(vn,i),ba===null&&(ba=i)):Yn()}function Yn(){R(pa,pa.current),R(vn,vn.current)}function Ra(i){F(vn),ba===i&&(ba=null),F(pa)}var pa=we(0);function Ys(i){for(var o=i;o!==null;){if(o.tag===13){var d=o.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||gb(d)||mb(d)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Nn=0,br=null,vr=null,va=null,Li=!1,Cl=!1,hi=!1,$n=0,jA=0,DA=null,ud=0;function Ya(){throw Error(a(321))}function Hf(i,o){if(o===null)return!1;for(var d=0;d<o.length&&d<i.length;d++)if(!is(i[d],o[d]))return!1;return!0}function Pf(i,o,d,p,y,C){return Nn=C,br=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Z.H=i===null||i.memoizedState===null?Jy:S1,hi=!1,C=d(p,y),hi=!1,Cl&&(C=$o(o,d,p,y)),dd(i),C}function dd(i){Z.H=Yf;var o=vr!==null&&vr.next!==null;if(Nn=0,va=vr=br=null,Li=!1,jA=0,DA=null,o)throw Error(a(300));i===null||Cs||(i=i.dependencies,i!==null&&od(i)&&(Cs=!0))}function $o(i,o,d,p){br=i;var y=0;do{if(Cl&&(DA=null),jA=0,Cl=!1,25<=y)throw Error(a(301));if(y+=1,va=vr=null,i.updateQueue!=null){var C=i.updateQueue;C.lastEffect=null,C.events=null,C.stores=null,C.memoCache!=null&&(C.memoCache.index=0)}Z.H=Zy,C=o(d,p)}while(Cl);return C}function v1(){var i=Z.H,o=i.useState()[0];return o=typeof o.then=="function"?IA(o):o,i=i.useState()[0],(vr!==null?vr.memoizedState:null)!==i&&(br.flags|=1024),o}function Kf(){var i=$n!==0;return $n=0,i}function qf(i,o,d){o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~d}function fd(i){if(Li){for(i=i.memoizedState;i!==null;){var o=i.queue;o!==null&&(o.pending=null),i=i.next}Li=!1}Nn=0,va=vr=br=null,Cl=!1,jA=$n=0,DA=null}function ks(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return va===null?br.memoizedState=va=i:va=va.next=i,va}function Fn(){if(vr===null){var i=br.alternate;i=i!==null?i.memoizedState:null}else i=vr.next;var o=va===null?br.memoizedState:va.next;if(o!==null)va=o,vr=i;else{if(i===null)throw br.alternate===null?Error(a(467)):Error(a(310));vr=i,i={memoizedState:vr.memoizedState,baseState:vr.baseState,baseQueue:vr.baseQueue,queue:vr.queue,next:null},va===null?br.memoizedState=va=i:va=va.next=i}return va}function d0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function IA(i){var o=jA;return jA+=1,DA===null&&(DA=[]),i=st(DA,i,o),o=br,(va===null?o.memoizedState:va.next)===null&&(o=o.alternate,Z.H=o===null||o.memoizedState===null?Jy:S1),i}function nu(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return IA(i);if(i.$$typeof===S)return Os(i)}throw Error(a(438,String(i)))}function bc(i){var o=null,d=br.updateQueue;if(d!==null&&(o=d.memoCache),o==null){var p=br.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(o={data:p.data.map(function(y){return y.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),d===null&&(d=d0(),br.updateQueue=d),d.memoCache=o,d=o.data[o.index],d===void 0)for(d=o.data[o.index]=Array(i),p=0;p<i;p++)d[p]=W;return o.index++,d}function vo(i,o){return typeof o=="function"?o(i):o}function hd(i){var o=Fn();return su(o,vr,i)}function su(i,o,d){var p=i.queue;if(p===null)throw Error(a(311));p.lastRenderedReducer=d;var y=i.baseQueue,C=p.pending;if(C!==null){if(y!==null){var V=y.next;y.next=C.next,C.next=V}o.baseQueue=y=C,p.pending=null}if(C=i.baseState,y===null)i.memoizedState=C;else{o=y.next;var ce=V=null,Te=null,Je=o,ot=!1;do{var gt=Je.lane&-536870913;if(gt!==Je.lane?(ua&gt)===gt:(Nn&gt)===gt){var Ze=Je.revertLane;if(Ze===0)Te!==null&&(Te=Te.next={lane:0,revertLane:0,gesture:null,action:Je.action,hasEagerState:Je.hasEagerState,eagerState:Je.eagerState,next:null}),gt===b&&(ot=!0);else if((Nn&Ze)===Ze){Je=Je.next,Ze===b&&(ot=!0);continue}else gt={lane:0,revertLane:Je.revertLane,gesture:null,action:Je.action,hasEagerState:Je.hasEagerState,eagerState:Je.eagerState,next:null},Te===null?(ce=Te=gt,V=C):Te=Te.next=gt,br.lanes|=Ze,cu|=Ze;gt=Je.action,hi&&d(C,gt),C=Je.hasEagerState?Je.eagerState:d(C,gt)}else Ze={lane:gt,revertLane:Je.revertLane,gesture:Je.gesture,action:Je.action,hasEagerState:Je.hasEagerState,eagerState:Je.eagerState,next:null},Te===null?(ce=Te=Ze,V=C):Te=Te.next=Ze,br.lanes|=gt,cu|=gt;Je=Je.next}while(Je!==null&&Je!==o);if(Te===null?V=C:Te.next=ce,!is(C,i.memoizedState)&&(Cs=!0,ot&&(d=_,d!==null)))throw d;i.memoizedState=C,i.baseState=V,i.baseQueue=Te,p.lastRenderedState=C}return y===null&&(p.lanes=0),[i.memoizedState,p.dispatch]}function pd(i){var o=Fn(),d=o.queue;if(d===null)throw Error(a(311));d.lastRenderedReducer=i;var p=d.dispatch,y=d.pending,C=o.memoizedState;if(y!==null){d.pending=null;var V=y=y.next;do C=i(C,V.action),V=V.next;while(V!==y);is(C,o.memoizedState)||(Cs=!0),o.memoizedState=C,o.baseQueue===null&&(o.baseState=C),d.lastRenderedState=C}return[C,p]}function gd(i,o,d){var p=br,y=Fn(),C=la;if(C){if(d===void 0)throw Error(a(407));d=d()}else d=o();var V=!is((vr||y).memoizedState,d);if(V&&(y.memoizedState=d,Cs=!0),y=y.queue,w1(Vf.bind(null,p,y,i),[i]),y.getSnapshot!==o||V||va!==null&&va.memoizedState.tag&1){if(p.flags|=2048,wc(9,{destroy:void 0},zf.bind(null,p,y,d,o),null),An===null)throw Error(a(349));C||(Nn&127)!==0||Jo(p,o,d)}return d}function Jo(i,o,d){i.flags|=16384,i={getSnapshot:o,value:d},o=br.updateQueue,o===null?(o=d0(),br.updateQueue=o,o.stores=[i]):(d=o.stores,d===null?o.stores=[i]:d.push(i))}function zf(i,o,d,p){o.value=d,o.getSnapshot=p,ag(o)&&Gf(i)}function Vf(i,o,d){return d(function(){ag(o)&&Gf(i)})}function ag(i){var o=i.getSnapshot;i=i.value;try{var d=o();return!is(i,d)}catch{return!0}}function Gf(i){var o=Xo(i,2);o!==null&&Tl(o,i,2)}function QA(i){var o=ks();if(typeof i=="function"){var d=i;if(i=d(),hi){at(!0);try{d()}finally{at(!1)}}}return o.memoizedState=o.baseState=i,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:vo,lastRenderedState:i},o}function ng(i,o,d,p){return i.baseState=d,su(i,vr,typeof p=="function"?p:vo)}function sg(i,o,d,p,y){if(Ag(i))throw Error(a(485));if(i=o.action,i!==null){var C={payload:y,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(V){C.listeners.push(V)}};Z.T!==null?d(!0):C.isTransition=!1,p(C),d=o.pending,d===null?(C.next=o.pending=C,ig(o,C)):(C.next=d.next,o.pending=d.next=C)}}function ig(i,o){var d=o.action,p=o.payload,y=i.state;if(o.isTransition){var C=Z.T,V={};Z.T=V;try{var ce=d(y,p),Te=Z.S;Te!==null&&Te(V,ce),Wf(i,o,ce)}catch(Je){vc(i,o,Je)}finally{C!==null&&V.types!==null&&(C.types=V.types),Z.T=C}}else try{C=d(y,p),Wf(i,o,C)}catch(Je){vc(i,o,Je)}}function Wf(i,o,d){d!==null&&typeof d=="object"&&typeof d.then=="function"?d.then(function(p){lg(i,o,p)},function(p){return vc(i,o,p)}):lg(i,o,d)}function lg(i,o,d){o.status="fulfilled",o.value=d,md(o),i.state=d,o=i.pending,o!==null&&(d=o.next,d===o?i.pending=null:(d=d.next,o.next=d,ig(i,d)))}function vc(i,o,d){var p=i.pending;if(i.pending=null,p!==null){p=p.next;do o.status="rejected",o.reason=d,md(o),o=o.next;while(o!==p)}i.action=null}function md(i){i=i.listeners;for(var o=0;o<i.length;o++)(0,i[o])()}function f0(i,o){return o}function wo(i,o){if(la){var d=An.formState;if(d!==null){e:{var p=br;if(la){if(ln){t:{for(var y=ln,C=En;y.nodeType!==8;){if(!C){y=null;break t}if(y=yo(y.nextSibling),y===null){y=null;break t}}C=y.data,y=C==="F!"||C==="F"?y:null}if(y){ln=yo(y.nextSibling),p=y.data==="F!";break e}}NA(p)}p=!1}p&&(o=d[0])}}return d=ks(),d.memoizedState=d.baseState=o,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:f0,lastRenderedState:o},d.queue=p,d=Xy.bind(null,br,p),p.dispatch=d,p=QA(!1),C=C1.bind(null,br,!1,p.queue),p=ks(),y={state:o,dispatch:null,action:i,pending:null},p.queue=y,d=sg.bind(null,br,y,C,d),y.dispatch=d,p.memoizedState=i,[o,d,!1]}function Zo(i){var o=Fn();return eA(o,vr,i)}function eA(i,o,d){if(o=su(i,o,f0)[0],i=hd(vo)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var p=IA(o)}catch(V){throw V===Ue?ye:V}else p=o;o=Fn();var y=o.queue,C=y.dispatch;return d!==o.memoizedState&&(br.flags|=2048,wc(9,{destroy:void 0},xd.bind(null,y,d),null)),[p,C,i]}function xd(i,o){i.action=o}function bd(i){var o=Fn(),d=vr;if(d!==null)return eA(o,d,i);Fn(),o=o.memoizedState,d=Fn();var p=d.queue.dispatch;return d.memoizedState=i,[o,p,!1]}function wc(i,o,d,p){return i={tag:i,create:d,deps:p,inst:o,next:null},o=br.updateQueue,o===null&&(o=d0(),br.updateQueue=o),d=o.lastEffect,d===null?o.lastEffect=i.next=i:(p=d.next,d.next=i,i.next=p,o.lastEffect=i),i}function og(){return Fn().memoizedState}function iu(i,o,d,p){var y=ks();br.flags|=i,y.memoizedState=wc(1|o,{destroy:void 0},d,p===void 0?null:p)}function lu(i,o,d,p){var y=Fn();p=p===void 0?null:p;var C=y.memoizedState.inst;vr!==null&&p!==null&&Hf(p,vr.memoizedState.deps)?y.memoizedState=wc(o,C,d,p):(br.flags|=i,y.memoizedState=wc(1|o,C,d,p))}function Dy(i,o){iu(8390656,8,i,o)}function w1(i,o){lu(2048,8,i,o)}function e6(i){br.flags|=4;var o=br.updateQueue;if(o===null)o=d0(),br.updateQueue=o,o.events=[i];else{var d=o.events;d===null?o.events=[i]:d.push(i)}}function Iy(i){var o=Fn().memoizedState;return e6({ref:o,nextImpl:i}),function(){if((Da&2)!==0)throw Error(a(440));return o.impl.apply(void 0,arguments)}}function Qy(i,o){return lu(4,2,i,o)}function Oy(i,o){return lu(4,4,i,o)}function Ry(i,o){if(typeof o=="function"){i=i();var d=o(i);return function(){typeof d=="function"?d():o(null)}}if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function My(i,o,d){d=d!=null?d.concat([i]):null,lu(4,4,Ry.bind(null,o,i),d)}function y1(){}function Hy(i,o){var d=Fn();o=o===void 0?null:o;var p=d.memoizedState;return o!==null&&Hf(o,p[1])?p[0]:(d.memoizedState=[i,o],i)}function Py(i,o){var d=Fn();o=o===void 0?null:o;var p=d.memoizedState;if(o!==null&&Hf(o,p[1]))return p[0];if(p=i(),hi){at(!0);try{i()}finally{at(!1)}}return d.memoizedState=[p,o],p}function _1(i,o,d){return d===void 0||(Nn&1073741824)!==0&&(ua&261930)===0?i.memoizedState=o:(i.memoizedState=d,i=K_(),br.lanes|=i,cu|=i,d)}function Ky(i,o,d,p){return is(d,o)?d:Jr.current!==null?(i=_1(i,d,p),is(i,o)||(Cs=!0),i):(Nn&42)===0||(Nn&1073741824)!==0&&(ua&261930)===0?(Cs=!0,i.memoizedState=d):(i=K_(),br.lanes|=i,cu|=i,o)}function qy(i,o,d,p,y){var C=Ae.p;Ae.p=C!==0&&8>C?C:8;var V=Z.T,ce={};Z.T=ce,C1(i,!1,o,d);try{var Te=y(),Je=Z.S;if(Je!==null&&Je(ce,Te),Te!==null&&typeof Te=="object"&&typeof Te.then=="function"){var ot=te(Te,p);Xf(i,o,ot,ao(i))}else Xf(i,o,p,ao(i))}catch(gt){Xf(i,o,{then:function(){},status:"rejected",reason:gt},ao())}finally{Ae.p=C,V!==null&&ce.types!==null&&(V.types=ce.types),Z.T=V}}function t6(){}function B1(i,o,d,p){if(i.tag!==5)throw Error(a(476));var y=zy(i).queue;qy(i,y,o,ve,d===null?t6:function(){return Vy(i),d(p)})}function zy(i){var o=i.memoizedState;if(o!==null)return o;o={memoizedState:ve,baseState:ve,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:vo,lastRenderedState:ve},next:null};var d={};return o.next={memoizedState:d,baseState:d,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:vo,lastRenderedState:d},next:null},i.memoizedState=o,i=i.alternate,i!==null&&(i.memoizedState=o),o}function Vy(i){var o=zy(i);o.next===null&&(o=i.alternate.memoizedState),Xf(i,o.next.queue,{},ao())}function k1(){return Os(dh)}function Gy(){return Fn().memoizedState}function Wy(){return Fn().memoizedState}function r6(i){for(var o=i.return;o!==null;){switch(o.tag){case 24:case 3:var d=ao();i=Cr(d);var p=Gr(o,i,d);p!==null&&(Tl(p,o,d),Ua(p,o,d)),o={cache:au()},i.payload=o;return}o=o.return}}function a6(i,o,d){var p=ao();d={lane:p,revertLane:0,gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},Ag(i)?Yy(o,d):(d=ed(i,o,d,p),d!==null&&(Tl(d,i,p),$y(d,o,p)))}function Xy(i,o,d){var p=ao();Xf(i,o,d,p)}function Xf(i,o,d,p){var y={lane:p,revertLane:0,gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null};if(Ag(i))Yy(o,y);else{var C=i.alternate;if(i.lanes===0&&(C===null||C.lanes===0)&&(C=o.lastRenderedReducer,C!==null))try{var V=o.lastRenderedState,ce=C(V,d);if(y.hasEagerState=!0,y.eagerState=ce,is(ce,V))return s0(i,o,y,0),An===null&&n0(),!1}catch{}if(d=ed(i,o,y,p),d!==null)return Tl(d,i,p),$y(d,o,p),!0}return!1}function C1(i,o,d,p){if(p={lane:2,revertLane:nb(),gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},Ag(i)){if(o)throw Error(a(479))}else o=ed(i,d,p,2),o!==null&&Tl(o,i,2)}function Ag(i){var o=i.alternate;return i===br||o!==null&&o===br}function Yy(i,o){Cl=Li=!0;var d=i.pending;d===null?o.next=o:(o.next=d.next,d.next=o),i.pending=o}function $y(i,o,d){if((d&4194048)!==0){var p=o.lanes;p&=i.pendingLanes,d|=p,o.lanes=d,Hr(i,d)}}var Yf={readContext:Os,use:nu,useCallback:Ya,useContext:Ya,useEffect:Ya,useImperativeHandle:Ya,useLayoutEffect:Ya,useInsertionEffect:Ya,useMemo:Ya,useReducer:Ya,useRef:Ya,useState:Ya,useDebugValue:Ya,useDeferredValue:Ya,useTransition:Ya,useSyncExternalStore:Ya,useId:Ya,useHostTransitionStatus:Ya,useFormState:Ya,useActionState:Ya,useOptimistic:Ya,useMemoCache:Ya,useCacheRefresh:Ya};Yf.useEffectEvent=Ya;var Jy={readContext:Os,use:nu,useCallback:function(i,o){return ks().memoizedState=[i,o===void 0?null:o],i},useContext:Os,useEffect:Dy,useImperativeHandle:function(i,o,d){d=d!=null?d.concat([i]):null,iu(4194308,4,Ry.bind(null,o,i),d)},useLayoutEffect:function(i,o){return iu(4194308,4,i,o)},useInsertionEffect:function(i,o){iu(4,2,i,o)},useMemo:function(i,o){var d=ks();o=o===void 0?null:o;var p=i();if(hi){at(!0);try{i()}finally{at(!1)}}return d.memoizedState=[p,o],p},useReducer:function(i,o,d){var p=ks();if(d!==void 0){var y=d(o);if(hi){at(!0);try{d(o)}finally{at(!1)}}}else y=o;return p.memoizedState=p.baseState=y,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:y},p.queue=i,i=i.dispatch=a6.bind(null,br,i),[p.memoizedState,i]},useRef:function(i){var o=ks();return i={current:i},o.memoizedState=i},useState:function(i){i=QA(i);var o=i.queue,d=Xy.bind(null,br,o);return o.dispatch=d,[i.memoizedState,d]},useDebugValue:y1,useDeferredValue:function(i,o){var d=ks();return _1(d,i,o)},useTransition:function(){var i=QA(!1);return i=qy.bind(null,br,i.queue,!0,!1),ks().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,o,d){var p=br,y=ks();if(la){if(d===void 0)throw Error(a(407));d=d()}else{if(d=o(),An===null)throw Error(a(349));(ua&127)!==0||Jo(p,o,d)}y.memoizedState=d;var C={value:d,getSnapshot:o};return y.queue=C,Dy(Vf.bind(null,p,C,i),[i]),p.flags|=2048,wc(9,{destroy:void 0},zf.bind(null,p,C,d,o),null),d},useId:function(){var i=ks(),o=An.identifierPrefix;if(la){var d=Bl,p=_l;d=(p&~(1<<32-it(p)-1)).toString(32)+d,o="_"+o+"R_"+d,d=$n++,0<d&&(o+="H"+d.toString(32)),o+="_"}else d=ud++,o="_"+o+"r_"+d.toString(32)+"_";return i.memoizedState=o},useHostTransitionStatus:k1,useFormState:wo,useActionState:wo,useOptimistic:function(i){var o=ks();o.memoizedState=o.baseState=i;var d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=d,o=C1.bind(null,br,!0,d),d.dispatch=o,[i,o]},useMemoCache:bc,useCacheRefresh:function(){return ks().memoizedState=r6.bind(null,br)},useEffectEvent:function(i){var o=ks(),d={impl:i};return o.memoizedState=d,function(){if((Da&2)!==0)throw Error(a(440));return d.impl.apply(void 0,arguments)}}},S1={readContext:Os,use:nu,useCallback:Hy,useContext:Os,useEffect:w1,useImperativeHandle:My,useInsertionEffect:Qy,useLayoutEffect:Oy,useMemo:Py,useReducer:hd,useRef:og,useState:function(){return hd(vo)},useDebugValue:y1,useDeferredValue:function(i,o){var d=Fn();return Ky(d,vr.memoizedState,i,o)},useTransition:function(){var i=hd(vo)[0],o=Fn().memoizedState;return[typeof i=="boolean"?i:IA(i),o]},useSyncExternalStore:gd,useId:Gy,useHostTransitionStatus:k1,useFormState:Zo,useActionState:Zo,useOptimistic:function(i,o){var d=Fn();return ng(d,vr,i,o)},useMemoCache:bc,useCacheRefresh:Wy};S1.useEffectEvent=Iy;var Zy={readContext:Os,use:nu,useCallback:Hy,useContext:Os,useEffect:w1,useImperativeHandle:My,useInsertionEffect:Qy,useLayoutEffect:Oy,useMemo:Py,useReducer:pd,useRef:og,useState:function(){return pd(vo)},useDebugValue:y1,useDeferredValue:function(i,o){var d=Fn();return vr===null?_1(d,i,o):Ky(d,vr.memoizedState,i,o)},useTransition:function(){var i=pd(vo)[0],o=Fn().memoizedState;return[typeof i=="boolean"?i:IA(i),o]},useSyncExternalStore:gd,useId:Gy,useHostTransitionStatus:k1,useFormState:bd,useActionState:bd,useOptimistic:function(i,o){var d=Fn();return vr!==null?ng(d,vr,i,o):(d.baseState=i,[i,d.queue.dispatch])},useMemoCache:bc,useCacheRefresh:Wy};Zy.useEffectEvent=Iy;function E1(i,o,d,p){o=i.memoizedState,d=d(p,o),d=d==null?o:g({},o,d),i.memoizedState=d,i.lanes===0&&(i.updateQueue.baseState=d)}var N1={enqueueSetState:function(i,o,d){i=i._reactInternals;var p=ao(),y=Cr(p);y.payload=o,d!=null&&(y.callback=d),o=Gr(i,y,p),o!==null&&(Tl(o,i,p),Ua(o,i,p))},enqueueReplaceState:function(i,o,d){i=i._reactInternals;var p=ao(),y=Cr(p);y.tag=1,y.payload=o,d!=null&&(y.callback=d),o=Gr(i,y,p),o!==null&&(Tl(o,i,p),Ua(o,i,p))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var d=ao(),p=Cr(d);p.tag=2,o!=null&&(p.callback=o),o=Gr(i,p,d),o!==null&&(Tl(o,i,d),Ua(o,i,d))}};function e_(i,o,d,p,y,C,V){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(p,C,V):o.prototype&&o.prototype.isPureReactComponent?!gl(d,p)||!gl(y,C):!0}function t_(i,o,d,p){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(d,p),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(d,p),o.state!==i&&N1.enqueueReplaceState(o,o.state,null)}function h0(i,o){var d=o;if("ref"in o){d={};for(var p in o)p!=="ref"&&(d[p]=o[p])}if(i=i.defaultProps){d===o&&(d=g({},d));for(var y in i)d[y]===void 0&&(d[y]=i[y])}return d}function r_(i){a0(i)}function a_(i){console.error(i)}function n_(i){a0(i)}function cg(i,o){try{var d=i.onUncaughtError;d(o.value,{componentStack:o.stack})}catch(p){setTimeout(function(){throw p})}}function s_(i,o,d){try{var p=i.onCaughtError;p(d.value,{componentStack:d.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function F1(i,o,d){return d=Cr(d),d.tag=3,d.payload={element:null},d.callback=function(){cg(i,o)},d}function i_(i){return i=Cr(i),i.tag=3,i}function l_(i,o,d,p){var y=d.type.getDerivedStateFromError;if(typeof y=="function"){var C=p.value;i.payload=function(){return y(C)},i.callback=function(){s_(o,d,p)}}var V=d.stateNode;V!==null&&typeof V.componentDidCatch=="function"&&(i.callback=function(){s_(o,d,p),typeof y!="function"&&(uu===null?uu=new Set([this]):uu.add(this));var ce=p.stack;this.componentDidCatch(p.value,{componentStack:ce!==null?ce:""})})}function n6(i,o,d,p,y){if(d.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(o=d.alternate,o!==null&&LA(o,d,y,!0),d=vn.current,d!==null){switch(d.tag){case 31:case 13:return ba===null?yg():d.alternate===null&&Jn===0&&(Jn=3),d.flags&=-257,d.flags|=65536,d.lanes=y,p===Oe?d.flags|=16384:(o=d.updateQueue,o===null?d.updateQueue=new Set([p]):o.add(p),tb(i,p,y)),!1;case 22:return d.flags|=65536,p===Oe?d.flags|=16384:(o=d.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([p])},d.updateQueue=o):(d=o.retryQueue,d===null?o.retryQueue=new Set([p]):d.add(p)),tb(i,p,y)),!1}throw Error(a(435,d.tag))}return tb(i,p,y),yg(),!1}if(la)return o=vn.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=y,p!==eo&&(i=Error(a(422),{cause:p}),tu(vl(i,d)))):(p!==eo&&(o=Error(a(423),{cause:p}),tu(vl(o,d))),i=i.current.alternate,i.flags|=65536,y&=-y,i.lanes|=y,p=vl(p,d),y=F1(i.stateNode,p,y),ls(i,y),Jn!==4&&(Jn=2)),!1;var C=Error(a(520),{cause:p});if(C=vl(C,d),nh===null?nh=[C]:nh.push(C),Jn!==4&&(Jn=2),o===null)return!0;p=vl(p,d),d=o;do{switch(d.tag){case 3:return d.flags|=65536,i=y&-y,d.lanes|=i,i=F1(d.stateNode,p,i),ls(d,i),!1;case 1:if(o=d.type,C=d.stateNode,(d.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(uu===null||!uu.has(C))))return d.flags|=65536,y&=-y,d.lanes|=y,y=i_(y),l_(y,i,d,p),ls(d,y),!1}d=d.return}while(d!==null);return!1}var T1=Error(a(461)),Cs=!1;function pi(i,o,d,p){o.child=i===null?zr(o,null,d,p):on(o,i.child,d,p)}function o_(i,o,d,p,y){d=d.render;var C=o.ref;if("ref"in p){var V={};for(var ce in p)ce!=="ref"&&(V[ce]=p[ce])}else V=p;return UA(o),p=Pf(i,o,d,V,C,y),ce=Kf(),i!==null&&!Cs?(qf(i,o,y),yc(i,o,y)):(la&&ce&&Of(o),o.flags|=1,pi(i,o,p,y),o.child)}function A_(i,o,d,p,y){if(i===null){var C=d.type;return typeof C=="function"&&!rd(C)&&C.defaultProps===void 0&&d.compare===null?(o.tag=15,o.type=C,c_(i,o,C,p,y)):(i=Jc(d.type,null,p,o,o.mode,y),i.ref=o.ref,i.return=o,o.child=i)}if(C=i.child,!R1(i,y)){var V=C.memoizedProps;if(d=d.compare,d=d!==null?d:gl,d(V,p)&&i.ref===o.ref)return yc(i,o,y)}return o.flags|=1,i=bl(C,p),i.ref=o.ref,i.return=o,o.child=i}function c_(i,o,d,p,y){if(i!==null){var C=i.memoizedProps;if(gl(C,p)&&i.ref===o.ref)if(Cs=!1,o.pendingProps=p=C,R1(i,y))(i.flags&131072)!==0&&(Cs=!0);else return o.lanes=i.lanes,yc(i,o,y)}return L1(i,o,d,p,y)}function u_(i,o,d,p){var y=p.children,C=i!==null?i.memoizedState:null;if(i===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),p.mode==="hidden"){if((o.flags&128)!==0){if(C=C!==null?C.baseLanes|d:d,i!==null){for(p=o.child=i.child,y=0;p!==null;)y=y|p.lanes|p.childLanes,p=p.sibling;p=y&~C}else p=0,o.child=null;return d_(i,o,C,d,p)}if((d&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},i!==null&&me(o,C!==null?C.cachePool:null),C!==null?bn(o,C):_a(),Xn(o);else return p=o.lanes=536870912,d_(i,o,C!==null?C.baseLanes|d:d,d,p)}else C!==null?(me(o,C.cachePool),bn(o,C),Yn(),o.memoizedState=null):(i!==null&&me(o,null),_a(),Yn());return pi(i,o,y,d),o.child}function $f(i,o){return i!==null&&i.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function d_(i,o,d,p,y){var C=he();return C=C===null?null:{parent:On._currentValue,pool:C},o.memoizedState={baseLanes:d,cachePool:C},i!==null&&me(o,null),_a(),Xn(o),i!==null&&LA(i,o,p,!0),o.childLanes=y,null}function ug(i,o){return o=fg({mode:o.mode,children:o.children},i.mode),o.ref=i.ref,i.child=o,o.return=i,o}function f_(i,o,d){return on(o,i.child,null,d),i=ug(o,o.pendingProps),i.flags|=2,Ra(o),o.memoizedState=null,i}function s6(i,o,d){var p=o.pendingProps,y=(o.flags&128)!==0;if(o.flags&=-129,i===null){if(la){if(p.mode==="hidden")return i=ug(o,p),o.lanes=536870912,$f(null,i);if(ja(o),(i=ln)?(i=k5(i,En),i=i!==null&&i.data==="&"?i:null,i!==null&&(o.memoizedState={dehydrated:i,treeContext:EA!==null?{id:_l,overflow:Bl}:null,retryLane:536870912,hydrationErrors:null},d=ad(i),d.return=o,o.child=d,Is=o,ln=null)):i=null,i===null)throw NA(o);return o.lanes=536870912,null}return ug(o,p)}var C=i.memoizedState;if(C!==null){var V=C.dehydrated;if(ja(o),y)if(o.flags&256)o.flags&=-257,o=f_(i,o,d);else if(o.memoizedState!==null)o.child=i.child,o.flags|=128,o=null;else throw Error(a(558));else if(Cs||LA(i,o,d,!1),y=(d&i.childLanes)!==0,Cs||y){if(p=An,p!==null&&(V=Br(p,d),V!==0&&V!==C.retryLane))throw C.retryLane=V,Xo(i,V),Tl(p,i,V),T1;yg(),o=f_(i,o,d)}else i=C.treeContext,ln=yo(V.nextSibling),Is=o,la=!0,fi=null,En=!1,i!==null&&tg(o,i),o=ug(o,p),o.flags|=4096;return o}return i=bl(i.child,{mode:p.mode,children:p.children}),i.ref=o.ref,o.child=i,i.return=o,i}function dg(i,o){var d=o.ref;if(d===null)i!==null&&i.ref!==null&&(o.flags|=4194816);else{if(typeof d!="function"&&typeof d!="object")throw Error(a(284));(i===null||i.ref!==d)&&(o.flags|=4194816)}}function L1(i,o,d,p,y){return UA(o),d=Pf(i,o,d,p,void 0,y),p=Kf(),i!==null&&!Cs?(qf(i,o,y),yc(i,o,y)):(la&&p&&Of(o),o.flags|=1,pi(i,o,d,y),o.child)}function h_(i,o,d,p,y,C){return UA(o),o.updateQueue=null,d=$o(o,p,d,y),dd(i),p=Kf(),i!==null&&!Cs?(qf(i,o,C),yc(i,o,C)):(la&&p&&Of(o),o.flags|=1,pi(i,o,d,C),o.child)}function p_(i,o,d,p,y){if(UA(o),o.stateNode===null){var C=Ds,V=d.contextType;typeof V=="object"&&V!==null&&(C=Os(V)),C=new d(p,C),o.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,C.updater=N1,o.stateNode=C,C._reactInternals=o,C=o.stateNode,C.props=p,C.state=o.memoizedState,C.refs={},Kt(o),V=d.contextType,C.context=typeof V=="object"&&V!==null?Os(V):Ds,C.state=o.memoizedState,V=d.getDerivedStateFromProps,typeof V=="function"&&(E1(o,d,V,p),C.state=o.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof C.getSnapshotBeforeUpdate=="function"||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(V=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),V!==C.state&&N1.enqueueReplaceState(C,C.state,null),Gn(o,p,C,y),Xa(),C.state=o.memoizedState),typeof C.componentDidMount=="function"&&(o.flags|=4194308),p=!0}else if(i===null){C=o.stateNode;var ce=o.memoizedProps,Te=h0(d,ce);C.props=Te;var Je=C.context,ot=d.contextType;V=Ds,typeof ot=="object"&&ot!==null&&(V=Os(ot));var gt=d.getDerivedStateFromProps;ot=typeof gt=="function"||typeof C.getSnapshotBeforeUpdate=="function",ce=o.pendingProps!==ce,ot||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(ce||Je!==V)&&t_(o,C,p,V),er=!1;var Ze=o.memoizedState;C.state=Ze,Gn(o,p,C,y),Xa(),Je=o.memoizedState,ce||Ze!==Je||er?(typeof gt=="function"&&(E1(o,d,gt,p),Je=o.memoizedState),(Te=er||e_(o,d,Te,p,Ze,Je,V))?(ot||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount()),typeof C.componentDidMount=="function"&&(o.flags|=4194308)):(typeof C.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=p,o.memoizedState=Je),C.props=p,C.state=Je,C.context=V,p=Te):(typeof C.componentDidMount=="function"&&(o.flags|=4194308),p=!1)}else{C=o.stateNode,xn(i,o),V=o.memoizedProps,ot=h0(d,V),C.props=ot,gt=o.pendingProps,Ze=C.context,Je=d.contextType,Te=Ds,typeof Je=="object"&&Je!==null&&(Te=Os(Je)),ce=d.getDerivedStateFromProps,(Je=typeof ce=="function"||typeof C.getSnapshotBeforeUpdate=="function")||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(V!==gt||Ze!==Te)&&t_(o,C,p,Te),er=!1,Ze=o.memoizedState,C.state=Ze,Gn(o,p,C,y),Xa();var rt=o.memoizedState;V!==gt||Ze!==rt||er||i!==null&&i.dependencies!==null&&od(i.dependencies)?(typeof ce=="function"&&(E1(o,d,ce,p),rt=o.memoizedState),(ot=er||e_(o,d,ot,p,Ze,rt,Te)||i!==null&&i.dependencies!==null&&od(i.dependencies))?(Je||typeof C.UNSAFE_componentWillUpdate!="function"&&typeof C.componentWillUpdate!="function"||(typeof C.componentWillUpdate=="function"&&C.componentWillUpdate(p,rt,Te),typeof C.UNSAFE_componentWillUpdate=="function"&&C.UNSAFE_componentWillUpdate(p,rt,Te)),typeof C.componentDidUpdate=="function"&&(o.flags|=4),typeof C.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof C.componentDidUpdate!="function"||V===i.memoizedProps&&Ze===i.memoizedState||(o.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||V===i.memoizedProps&&Ze===i.memoizedState||(o.flags|=1024),o.memoizedProps=p,o.memoizedState=rt),C.props=p,C.state=rt,C.context=Te,p=ot):(typeof C.componentDidUpdate!="function"||V===i.memoizedProps&&Ze===i.memoizedState||(o.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||V===i.memoizedProps&&Ze===i.memoizedState||(o.flags|=1024),p=!1)}return C=p,dg(i,o),p=(o.flags&128)!==0,C||p?(C=o.stateNode,d=p&&typeof d.getDerivedStateFromError!="function"?null:C.render(),o.flags|=1,i!==null&&p?(o.child=on(o,i.child,null,y),o.child=on(o,null,d,y)):pi(i,o,d,y),o.memoizedState=C.state,i=o.child):i=yc(i,o,y),i}function g_(i,o,d,p){return mc(),o.flags|=256,pi(i,o,d,p),o.child}var U1={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function j1(i){return{baseLanes:i,cachePool:ke()}}function D1(i,o,d){return i=i!==null?i.childLanes&~d:0,o&&(i|=ro),i}function m_(i,o,d){var p=o.pendingProps,y=!1,C=(o.flags&128)!==0,V;if((V=C)||(V=i!==null&&i.memoizedState===null?!1:(pa.current&2)!==0),V&&(y=!0,o.flags&=-129),V=(o.flags&32)!==0,o.flags&=-33,i===null){if(la){if(y?Rn(o):Yn(),(i=ln)?(i=k5(i,En),i=i!==null&&i.data!=="&"?i:null,i!==null&&(o.memoizedState={dehydrated:i,treeContext:EA!==null?{id:_l,overflow:Bl}:null,retryLane:536870912,hydrationErrors:null},d=ad(i),d.return=o,o.child=d,Is=o,ln=null)):i=null,i===null)throw NA(o);return mb(i)?o.lanes=32:o.lanes=536870912,null}var ce=p.children;return p=p.fallback,y?(Yn(),y=o.mode,ce=fg({mode:"hidden",children:ce},y),p=SA(p,y,d,null),ce.return=o,p.return=o,ce.sibling=p,o.child=ce,p=o.child,p.memoizedState=j1(d),p.childLanes=D1(i,V,d),o.memoizedState=U1,$f(null,p)):(Rn(o),I1(o,ce))}var Te=i.memoizedState;if(Te!==null&&(ce=Te.dehydrated,ce!==null)){if(C)o.flags&256?(Rn(o),o.flags&=-257,o=Q1(i,o,d)):o.memoizedState!==null?(Yn(),o.child=i.child,o.flags|=128,o=null):(Yn(),ce=p.fallback,y=o.mode,p=fg({mode:"visible",children:p.children},y),ce=SA(ce,y,d,null),ce.flags|=2,p.return=o,ce.return=o,p.sibling=ce,o.child=p,on(o,i.child,null,d),p=o.child,p.memoizedState=j1(d),p.childLanes=D1(i,V,d),o.memoizedState=U1,o=$f(null,p));else if(Rn(o),mb(ce)){if(V=ce.nextSibling&&ce.nextSibling.dataset,V)var Je=V.dgst;V=Je,p=Error(a(419)),p.stack="",p.digest=V,tu({value:p,source:null,stack:null}),o=Q1(i,o,d)}else if(Cs||LA(i,o,d,!1),V=(d&i.childLanes)!==0,Cs||V){if(V=An,V!==null&&(p=Br(V,d),p!==0&&p!==Te.retryLane))throw Te.retryLane=p,Xo(i,p),Tl(V,i,p),T1;gb(ce)||yg(),o=Q1(i,o,d)}else gb(ce)?(o.flags|=192,o.child=i.child,o=null):(i=Te.treeContext,ln=yo(ce.nextSibling),Is=o,la=!0,fi=null,En=!1,i!==null&&tg(o,i),o=I1(o,p.children),o.flags|=4096);return o}return y?(Yn(),ce=p.fallback,y=o.mode,Te=i.child,Je=Te.sibling,p=bl(Te,{mode:"hidden",children:p.children}),p.subtreeFlags=Te.subtreeFlags&65011712,Je!==null?ce=bl(Je,ce):(ce=SA(ce,y,d,null),ce.flags|=2),ce.return=o,p.return=o,p.sibling=ce,o.child=p,$f(null,p),p=o.child,ce=i.child.memoizedState,ce===null?ce=j1(d):(y=ce.cachePool,y!==null?(Te=On._currentValue,y=y.parent!==Te?{parent:Te,pool:Te}:y):y=ke(),ce={baseLanes:ce.baseLanes|d,cachePool:y}),p.memoizedState=ce,p.childLanes=D1(i,V,d),o.memoizedState=U1,$f(i.child,p)):(Rn(o),d=i.child,i=d.sibling,d=bl(d,{mode:"visible",children:p.children}),d.return=o,d.sibling=null,i!==null&&(V=o.deletions,V===null?(o.deletions=[i],o.flags|=16):V.push(i)),o.child=d,o.memoizedState=null,d)}function I1(i,o){return o=fg({mode:"visible",children:o},i.mode),o.return=i,i.child=o}function fg(i,o){return i=Ws(22,i,null,o),i.lanes=0,i}function Q1(i,o,d){return on(o,i.child,null,d),i=I1(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function x_(i,o,d){i.lanes|=o;var p=i.alternate;p!==null&&(p.lanes|=o),ru(i.return,o,d)}function O1(i,o,d,p,y,C){var V=i.memoizedState;V===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:p,tail:d,tailMode:y,treeForkCount:C}:(V.isBackwards=o,V.rendering=null,V.renderingStartTime=0,V.last=p,V.tail=d,V.tailMode=y,V.treeForkCount=C)}function b_(i,o,d){var p=o.pendingProps,y=p.revealOrder,C=p.tail;p=p.children;var V=pa.current,ce=(V&2)!==0;if(ce?(V=V&1|2,o.flags|=128):V&=1,R(pa,V),pi(i,o,p,d),p=la?A0:0,!ce&&i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&x_(i,d,o);else if(i.tag===19)x_(i,d,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(y){case"forwards":for(d=o.child,y=null;d!==null;)i=d.alternate,i!==null&&Ys(i)===null&&(y=d),d=d.sibling;d=y,d===null?(y=o.child,o.child=null):(y=d.sibling,d.sibling=null),O1(o,!1,y,d,C,p);break;case"backwards":case"unstable_legacy-backwards":for(d=null,y=o.child,o.child=null;y!==null;){if(i=y.alternate,i!==null&&Ys(i)===null){o.child=y;break}i=y.sibling,y.sibling=d,d=y,y=i}O1(o,!0,d,null,C,p);break;case"together":O1(o,!1,null,null,void 0,p);break;default:o.memoizedState=null}return o.child}function yc(i,o,d){if(i!==null&&(o.dependencies=i.dependencies),cu|=o.lanes,(d&o.childLanes)===0)if(i!==null){if(LA(i,o,d,!1),(d&o.childLanes)===0)return null}else return null;if(i!==null&&o.child!==i.child)throw Error(a(153));if(o.child!==null){for(i=o.child,d=bl(i,i.pendingProps),o.child=d,d.return=o;i.sibling!==null;)i=i.sibling,d=d.sibling=bl(i,i.pendingProps),d.return=o;d.sibling=null}return o.child}function R1(i,o){return(i.lanes&o)!==0?!0:(i=i.dependencies,!!(i!==null&&od(i)))}function i6(i,o,d){switch(o.tag){case 3:Ce(o,o.stateNode.containerInfo),TA(o,On,i.memoizedState.cache),mc();break;case 27:case 5:be(o);break;case 4:Ce(o,o.stateNode.containerInfo);break;case 10:TA(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,ja(o),null;break;case 13:var p=o.memoizedState;if(p!==null)return p.dehydrated!==null?(Rn(o),o.flags|=128,null):(d&o.child.childLanes)!==0?m_(i,o,d):(Rn(o),i=yc(i,o,d),i!==null?i.sibling:null);Rn(o);break;case 19:var y=(i.flags&128)!==0;if(p=(d&o.childLanes)!==0,p||(LA(i,o,d,!1),p=(d&o.childLanes)!==0),y){if(p)return b_(i,o,d);o.flags|=128}if(y=o.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),R(pa,pa.current),p)break;return null;case 22:return o.lanes=0,u_(i,o,d,o.pendingProps);case 24:TA(o,On,i.memoizedState.cache)}return yc(i,o,d)}function v_(i,o,d){if(i!==null)if(i.memoizedProps!==o.pendingProps)Cs=!0;else{if(!R1(i,d)&&(o.flags&128)===0)return Cs=!1,i6(i,o,d);Cs=(i.flags&131072)!==0}else Cs=!1,la&&(o.flags&1048576)!==0&&eg(o,A0,o.index);switch(o.lanes=0,o.tag){case 16:e:{var p=o.pendingProps;if(i=We(o.elementType),o.type=i,typeof i=="function")rd(i)?(p=h0(i,p),o.tag=1,o=p_(null,o,i,p,d)):(o.tag=0,o=L1(null,o,i,p,d));else{if(i!=null){var y=i.$$typeof;if(y===O){o.tag=11,o=o_(null,o,i,p,d);break e}else if(y===D){o.tag=14,o=A_(null,o,i,p,d);break e}}throw o=z(i)||i,Error(a(306,o,""))}}return o;case 0:return L1(i,o,o.type,o.pendingProps,d);case 1:return p=o.type,y=h0(p,o.pendingProps),p_(i,o,p,y,d);case 3:e:{if(Ce(o,o.stateNode.containerInfo),i===null)throw Error(a(387));p=o.pendingProps;var C=o.memoizedState;y=C.element,xn(i,o),Gn(o,p,null,d);var V=o.memoizedState;if(p=V.cache,TA(o,On,p),p!==C.cache&&xc(o,[On],d,!0),Xa(),p=V.element,C.isDehydrated)if(C={element:p,isDehydrated:!1,cache:V.cache},o.updateQueue.baseState=C,o.memoizedState=C,o.flags&256){o=g_(i,o,p,d);break e}else if(p!==y){y=vl(Error(a(424)),o),tu(y),o=g_(i,o,p,d);break e}else for(i=o.stateNode.containerInfo,i.nodeType===9?i=i.body:i=i.nodeName==="HTML"?i.ownerDocument.body:i,ln=yo(i.firstChild),Is=o,la=!0,fi=null,En=!0,d=zr(o,null,p,d),o.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(mc(),p===y){o=yc(i,o,d);break e}pi(i,o,p,d)}o=o.child}return o;case 26:return dg(i,o),i===null?(d=T5(o.type,null,o.pendingProps,null))?o.memoizedState=d:la||(d=o.type,i=o.pendingProps,p=Ng(re.current).createElement(d),p[pe]=o,p[K]=i,gi(p,d,i),Gt(p),o.stateNode=p):o.memoizedState=T5(o.type,i.memoizedProps,o.pendingProps,i.memoizedState),null;case 27:return be(o),i===null&&la&&(p=o.stateNode=E5(o.type,o.pendingProps,re.current),Is=o,En=!0,y=ln,pu(o.type)?(xb=y,ln=yo(p.firstChild)):ln=y),pi(i,o,o.pendingProps.children,d),dg(i,o),i===null&&(o.flags|=4194304),o.child;case 5:return i===null&&la&&((y=p=ln)&&(p=I6(p,o.type,o.pendingProps,En),p!==null?(o.stateNode=p,Is=o,ln=yo(p.firstChild),En=!1,y=!0):y=!1),y||NA(o)),be(o),y=o.type,C=o.pendingProps,V=i!==null?i.memoizedProps:null,p=C.children,fb(y,C)?p=null:V!==null&&fb(y,V)&&(o.flags|=32),o.memoizedState!==null&&(y=Pf(i,o,v1,null,null,d),dh._currentValue=y),dg(i,o),pi(i,o,p,d),o.child;case 6:return i===null&&la&&((i=d=ln)&&(d=Q6(d,o.pendingProps,En),d!==null?(o.stateNode=d,Is=o,ln=null,i=!0):i=!1),i||NA(o)),null;case 13:return m_(i,o,d);case 4:return Ce(o,o.stateNode.containerInfo),p=o.pendingProps,i===null?o.child=on(o,null,p,d):pi(i,o,p,d),o.child;case 11:return o_(i,o,o.type,o.pendingProps,d);case 7:return pi(i,o,o.pendingProps,d),o.child;case 8:return pi(i,o,o.pendingProps.children,d),o.child;case 12:return pi(i,o,o.pendingProps.children,d),o.child;case 10:return p=o.pendingProps,TA(o,o.type,p.value),pi(i,o,p.children,d),o.child;case 9:return y=o.type._context,p=o.pendingProps.children,UA(o),y=Os(y),p=p(y),o.flags|=1,pi(i,o,p,d),o.child;case 14:return A_(i,o,o.type,o.pendingProps,d);case 15:return c_(i,o,o.type,o.pendingProps,d);case 19:return b_(i,o,d);case 31:return s6(i,o,d);case 22:return u_(i,o,d,o.pendingProps);case 24:return UA(o),p=Os(On),i===null?(y=he(),y===null&&(y=An,C=au(),y.pooledCache=C,C.refCount++,C!==null&&(y.pooledCacheLanes|=d),y=C),o.memoizedState={parent:p,cache:y},Kt(o),TA(o,On,y)):((i.lanes&d)!==0&&(xn(i,o),Gn(o,null,null,d),Xa()),y=i.memoizedState,C=o.memoizedState,y.parent!==p?(y={parent:p,cache:p},o.memoizedState=y,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=y),TA(o,On,p)):(p=C.cache,TA(o,On,p),p!==y.cache&&xc(o,[On],d,!0))),pi(i,o,o.pendingProps.children,d),o.child;case 29:throw o.pendingProps}throw Error(a(156,o.tag))}function _c(i){i.flags|=4}function M1(i,o,d,p,y){if((o=(i.mode&32)!==0)&&(o=!1),o){if(i.flags|=16777216,(y&335544128)===y)if(i.stateNode.complete)i.flags|=8192;else if(G_())i.flags|=8192;else throw nt=Oe,Ye}else i.flags&=-16777217}function w_(i,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!I5(o))if(G_())i.flags|=8192;else throw nt=Oe,Ye}function hg(i,o){o!==null&&(i.flags|=4),i.flags&16384&&(o=i.tag!==22?Tt():536870912,i.lanes|=o,_d|=o)}function Jf(i,o){if(!la)switch(i.tailMode){case"hidden":o=i.tail;for(var d=null;o!==null;)o.alternate!==null&&(d=o),o=o.sibling;d===null?i.tail=null:d.sibling=null;break;case"collapsed":d=i.tail;for(var p=null;d!==null;)d.alternate!==null&&(p=d),d=d.sibling;p===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:p.sibling=null}}function wn(i){var o=i.alternate!==null&&i.alternate.child===i.child,d=0,p=0;if(o)for(var y=i.child;y!==null;)d|=y.lanes|y.childLanes,p|=y.subtreeFlags&65011712,p|=y.flags&65011712,y.return=i,y=y.sibling;else for(y=i.child;y!==null;)d|=y.lanes|y.childLanes,p|=y.subtreeFlags,p|=y.flags,y.return=i,y=y.sibling;return i.subtreeFlags|=p,i.childLanes=d,o}function l6(i,o,d){var p=o.pendingProps;switch(id(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return wn(o),null;case 1:return wn(o),null;case 3:return d=o.stateNode,p=null,i!==null&&(p=i.memoizedState.cache),o.memoizedState.cache!==p&&(o.flags|=2048),kl(On),de(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(i===null||i.child===null)&&(Qs(o)?_c(o):i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Mf())),wn(o),null;case 26:var y=o.type,C=o.memoizedState;return i===null?(_c(o),C!==null?(wn(o),w_(o,C)):(wn(o),M1(o,y,null,p,d))):C?C!==i.memoizedState?(_c(o),wn(o),w_(o,C)):(wn(o),o.flags&=-16777217):(i=i.memoizedProps,i!==p&&_c(o),wn(o),M1(o,y,i,p,d)),null;case 27:if(Le(o),d=re.current,y=o.type,i!==null&&o.stateNode!=null)i.memoizedProps!==p&&_c(o);else{if(!p){if(o.stateNode===null)throw Error(a(166));return wn(o),null}i=M.current,Qs(o)?Rf(o):(i=E5(y,p,d),o.stateNode=i,_c(o))}return wn(o),null;case 5:if(Le(o),y=o.type,i!==null&&o.stateNode!=null)i.memoizedProps!==p&&_c(o);else{if(!p){if(o.stateNode===null)throw Error(a(166));return wn(o),null}if(C=M.current,Qs(o))Rf(o);else{var V=Ng(re.current);switch(C){case 1:C=V.createElementNS("http://www.w3.org/2000/svg",y);break;case 2:C=V.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;default:switch(y){case"svg":C=V.createElementNS("http://www.w3.org/2000/svg",y);break;case"math":C=V.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;case"script":C=V.createElement("div"),C.innerHTML="<script><\/script>",C=C.removeChild(C.firstChild);break;case"select":C=typeof p.is=="string"?V.createElement("select",{is:p.is}):V.createElement("select"),p.multiple?C.multiple=!0:p.size&&(C.size=p.size);break;default:C=typeof p.is=="string"?V.createElement(y,{is:p.is}):V.createElement(y)}}C[pe]=o,C[K]=p;e:for(V=o.child;V!==null;){if(V.tag===5||V.tag===6)C.appendChild(V.stateNode);else if(V.tag!==4&&V.tag!==27&&V.child!==null){V.child.return=V,V=V.child;continue}if(V===o)break e;for(;V.sibling===null;){if(V.return===null||V.return===o)break e;V=V.return}V.sibling.return=V.return,V=V.sibling}o.stateNode=C;e:switch(gi(C,y,p),y){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&_c(o)}}return wn(o),M1(o,o.type,i===null?null:i.memoizedProps,o.pendingProps,d),null;case 6:if(i&&o.stateNode!=null)i.memoizedProps!==p&&_c(o);else{if(typeof p!="string"&&o.stateNode===null)throw Error(a(166));if(i=re.current,Qs(o)){if(i=o.stateNode,d=o.memoizedProps,p=null,y=Is,y!==null)switch(y.tag){case 27:case 5:p=y.memoizedProps}i[pe]=o,i=!!(i.nodeValue===d||p!==null&&p.suppressHydrationWarning===!0||m5(i.nodeValue,d)),i||NA(o,!0)}else i=Ng(i).createTextNode(p),i[pe]=o,o.stateNode=i}return wn(o),null;case 31:if(d=o.memoizedState,i===null||i.memoizedState!==null){if(p=Qs(o),d!==null){if(i===null){if(!p)throw Error(a(318));if(i=o.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(557));i[pe]=o}else mc(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;wn(o),i=!1}else d=Mf(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=d),i=!0;if(!i)return o.flags&256?(Ra(o),o):(Ra(o),null);if((o.flags&128)!==0)throw Error(a(558))}return wn(o),null;case 13:if(p=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(y=Qs(o),p!==null&&p.dehydrated!==null){if(i===null){if(!y)throw Error(a(318));if(y=o.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(a(317));y[pe]=o}else mc(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;wn(o),y=!1}else y=Mf(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=y),y=!0;if(!y)return o.flags&256?(Ra(o),o):(Ra(o),null)}return Ra(o),(o.flags&128)!==0?(o.lanes=d,o):(d=p!==null,i=i!==null&&i.memoizedState!==null,d&&(p=o.child,y=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(y=p.alternate.memoizedState.cachePool.pool),C=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(C=p.memoizedState.cachePool.pool),C!==y&&(p.flags|=2048)),d!==i&&d&&(o.child.flags|=8192),hg(o,o.updateQueue),wn(o),null);case 4:return de(),i===null&&ob(o.stateNode.containerInfo),wn(o),null;case 10:return kl(o.type),wn(o),null;case 19:if(F(pa),p=o.memoizedState,p===null)return wn(o),null;if(y=(o.flags&128)!==0,C=p.rendering,C===null)if(y)Jf(p,!1);else{if(Jn!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(C=Ys(i),C!==null){for(o.flags|=128,Jf(p,!1),i=C.updateQueue,o.updateQueue=i,hg(o,i),o.subtreeFlags=0,i=d,d=o.child;d!==null;)l0(d,i),d=d.sibling;return R(pa,pa.current&1|2),la&&el(o,p.treeForkCount),o.child}i=i.sibling}p.tail!==null&&jt()>bg&&(o.flags|=128,y=!0,Jf(p,!1),o.lanes=4194304)}else{if(!y)if(i=Ys(C),i!==null){if(o.flags|=128,y=!0,i=i.updateQueue,o.updateQueue=i,hg(o,i),Jf(p,!0),p.tail===null&&p.tailMode==="hidden"&&!C.alternate&&!la)return wn(o),null}else 2*jt()-p.renderingStartTime>bg&&d!==536870912&&(o.flags|=128,y=!0,Jf(p,!1),o.lanes=4194304);p.isBackwards?(C.sibling=o.child,o.child=C):(i=p.last,i!==null?i.sibling=C:o.child=C,p.last=C)}return p.tail!==null?(i=p.tail,p.rendering=i,p.tail=i.sibling,p.renderingStartTime=jt(),i.sibling=null,d=pa.current,R(pa,y?d&1|2:d&1),la&&el(o,p.treeForkCount),i):(wn(o),null);case 22:case 23:return Ra(o),os(),p=o.memoizedState!==null,i!==null?i.memoizedState!==null!==p&&(o.flags|=8192):p&&(o.flags|=8192),p?(d&536870912)!==0&&(o.flags&128)===0&&(wn(o),o.subtreeFlags&6&&(o.flags|=8192)):wn(o),d=o.updateQueue,d!==null&&hg(o,d.retryQueue),d=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(d=i.memoizedState.cachePool.pool),p=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(p=o.memoizedState.cachePool.pool),p!==d&&(o.flags|=2048),i!==null&&F(oe),null;case 24:return d=null,i!==null&&(d=i.memoizedState.cache),o.memoizedState.cache!==d&&(o.flags|=2048),kl(On),wn(o),null;case 25:return null;case 30:return null}throw Error(a(156,o.tag))}function o6(i,o){switch(id(o),o.tag){case 1:return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return kl(On),de(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 26:case 27:case 5:return Le(o),null;case 31:if(o.memoizedState!==null){if(Ra(o),o.alternate===null)throw Error(a(340));mc()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 13:if(Ra(o),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(a(340));mc()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return F(pa),null;case 4:return de(),null;case 10:return kl(o.type),null;case 22:case 23:return Ra(o),os(),i!==null&&F(oe),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 24:return kl(On),null;case 25:return null;default:return null}}function y_(i,o){switch(id(o),o.tag){case 3:kl(On),de();break;case 26:case 27:case 5:Le(o);break;case 4:de();break;case 31:o.memoizedState!==null&&Ra(o);break;case 13:Ra(o);break;case 19:F(pa);break;case 10:kl(o.type);break;case 22:case 23:Ra(o),os(),i!==null&&F(oe);break;case 24:kl(On)}}function Zf(i,o){try{var d=o.updateQueue,p=d!==null?d.lastEffect:null;if(p!==null){var y=p.next;d=y;do{if((d.tag&i)===i){p=void 0;var C=d.create,V=d.inst;p=C(),V.destroy=p}d=d.next}while(d!==y)}}catch(ce){Ha(o,o.return,ce)}}function ou(i,o,d){try{var p=o.updateQueue,y=p!==null?p.lastEffect:null;if(y!==null){var C=y.next;p=C;do{if((p.tag&i)===i){var V=p.inst,ce=V.destroy;if(ce!==void 0){V.destroy=void 0,y=o;var Te=d,Je=ce;try{Je()}catch(ot){Ha(y,Te,ot)}}}p=p.next}while(p!==C)}}catch(ot){Ha(o,o.return,ot)}}function __(i){var o=i.updateQueue;if(o!==null){var d=i.stateNode;try{Wn(o,d)}catch(p){Ha(i,i.return,p)}}}function B_(i,o,d){d.props=h0(i.type,i.memoizedProps),d.state=i.memoizedState;try{d.componentWillUnmount()}catch(p){Ha(i,o,p)}}function eh(i,o){try{var d=i.ref;if(d!==null){switch(i.tag){case 26:case 27:case 5:var p=i.stateNode;break;case 30:p=i.stateNode;break;default:p=i.stateNode}typeof d=="function"?i.refCleanup=d(p):d.current=p}}catch(y){Ha(i,o,y)}}function OA(i,o){var d=i.ref,p=i.refCleanup;if(d!==null)if(typeof p=="function")try{p()}catch(y){Ha(i,o,y)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof d=="function")try{d(null)}catch(y){Ha(i,o,y)}else d.current=null}function k_(i){var o=i.type,d=i.memoizedProps,p=i.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":d.autoFocus&&p.focus();break e;case"img":d.src?p.src=d.src:d.srcSet&&(p.srcset=d.srcSet)}}catch(y){Ha(i,i.return,y)}}function H1(i,o,d){try{var p=i.stateNode;F6(p,i.type,d,o),p[K]=o}catch(y){Ha(i,i.return,y)}}function C_(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&pu(i.type)||i.tag===4}function P1(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||C_(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&pu(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function K1(i,o,d){var p=i.tag;if(p===5||p===6)i=i.stateNode,o?(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d).insertBefore(i,o):(o=d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,o.appendChild(i),d=d._reactRootContainer,d!=null||o.onclick!==null||(o.onclick=Us));else if(p!==4&&(p===27&&pu(i.type)&&(d=i.stateNode,o=null),i=i.child,i!==null))for(K1(i,o,d),i=i.sibling;i!==null;)K1(i,o,d),i=i.sibling}function pg(i,o,d){var p=i.tag;if(p===5||p===6)i=i.stateNode,o?d.insertBefore(i,o):d.appendChild(i);else if(p!==4&&(p===27&&pu(i.type)&&(d=i.stateNode),i=i.child,i!==null))for(pg(i,o,d),i=i.sibling;i!==null;)pg(i,o,d),i=i.sibling}function S_(i){var o=i.stateNode,d=i.memoizedProps;try{for(var p=i.type,y=o.attributes;y.length;)o.removeAttributeNode(y[0]);gi(o,p,d),o[pe]=i,o[K]=d}catch(C){Ha(i,i.return,C)}}var Bc=!1,Ss=!1,q1=!1,E_=typeof WeakSet=="function"?WeakSet:Set,$s=null;function A6(i,o){if(i=i.containerInfo,ub=Ig,i=ci(i),Ti(i)){if("selectionStart"in i)var d={start:i.selectionStart,end:i.selectionEnd};else e:{d=(d=i.ownerDocument)&&d.defaultView||window;var p=d.getSelection&&d.getSelection();if(p&&p.rangeCount!==0){d=p.anchorNode;var y=p.anchorOffset,C=p.focusNode;p=p.focusOffset;try{d.nodeType,C.nodeType}catch{d=null;break e}var V=0,ce=-1,Te=-1,Je=0,ot=0,gt=i,Ze=null;t:for(;;){for(var rt;gt!==d||y!==0&&gt.nodeType!==3||(ce=V+y),gt!==C||p!==0&&gt.nodeType!==3||(Te=V+p),gt.nodeType===3&&(V+=gt.nodeValue.length),(rt=gt.firstChild)!==null;)Ze=gt,gt=rt;for(;;){if(gt===i)break t;if(Ze===d&&++Je===y&&(ce=V),Ze===C&&++ot===p&&(Te=V),(rt=gt.nextSibling)!==null)break;gt=Ze,Ze=gt.parentNode}gt=rt}d=ce===-1||Te===-1?null:{start:ce,end:Te}}else d=null}d=d||{start:0,end:0}}else d=null;for(db={focusedElem:i,selectionRange:d},Ig=!1,$s=o;$s!==null;)if(o=$s,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,$s=i;else for(;$s!==null;){switch(o=$s,C=o.alternate,i=o.flags,o.tag){case 0:if((i&4)!==0&&(i=o.updateQueue,i=i!==null?i.events:null,i!==null))for(d=0;d<i.length;d++)y=i[d],y.ref.impl=y.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&C!==null){i=void 0,d=o,y=C.memoizedProps,C=C.memoizedState,p=d.stateNode;try{var sr=h0(d.type,y);i=p.getSnapshotBeforeUpdate(sr,C),p.__reactInternalSnapshotBeforeUpdate=i}catch(Nr){Ha(d,d.return,Nr)}}break;case 3:if((i&1024)!==0){if(i=o.stateNode.containerInfo,d=i.nodeType,d===9)pb(i);else if(d===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":pb(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(a(163))}if(i=o.sibling,i!==null){i.return=o.return,$s=i;break}$s=o.return}}function N_(i,o,d){var p=d.flags;switch(d.tag){case 0:case 11:case 15:Cc(i,d),p&4&&Zf(5,d);break;case 1:if(Cc(i,d),p&4)if(i=d.stateNode,o===null)try{i.componentDidMount()}catch(V){Ha(d,d.return,V)}else{var y=h0(d.type,o.memoizedProps);o=o.memoizedState;try{i.componentDidUpdate(y,o,i.__reactInternalSnapshotBeforeUpdate)}catch(V){Ha(d,d.return,V)}}p&64&&__(d),p&512&&eh(d,d.return);break;case 3:if(Cc(i,d),p&64&&(i=d.updateQueue,i!==null)){if(o=null,d.child!==null)switch(d.child.tag){case 27:case 5:o=d.child.stateNode;break;case 1:o=d.child.stateNode}try{Wn(i,o)}catch(V){Ha(d,d.return,V)}}break;case 27:o===null&&p&4&&S_(d);case 26:case 5:Cc(i,d),o===null&&p&4&&k_(d),p&512&&eh(d,d.return);break;case 12:Cc(i,d);break;case 31:Cc(i,d),p&4&&L_(i,d);break;case 13:Cc(i,d),p&4&&U_(i,d),p&64&&(i=d.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(d=x6.bind(null,d),O6(i,d))));break;case 22:if(p=d.memoizedState!==null||Bc,!p){o=o!==null&&o.memoizedState!==null||Ss,y=Bc;var C=Ss;Bc=p,(Ss=o)&&!C?Sc(i,d,(d.subtreeFlags&8772)!==0):Cc(i,d),Bc=y,Ss=C}break;case 30:break;default:Cc(i,d)}}function F_(i){var o=i.alternate;o!==null&&(i.alternate=null,F_(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&pt(o)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Tn=null,Sl=!1;function kc(i,o,d){for(d=d.child;d!==null;)T_(i,o,d),d=d.sibling}function T_(i,o,d){if(Ee&&typeof Ee.onCommitFiberUnmount=="function")try{Ee.onCommitFiberUnmount($t,d)}catch{}switch(d.tag){case 26:Ss||OA(d,o),kc(i,o,d),d.memoizedState?d.memoizedState.count--:d.stateNode&&(d=d.stateNode,d.parentNode.removeChild(d));break;case 27:Ss||OA(d,o);var p=Tn,y=Sl;pu(d.type)&&(Tn=d.stateNode,Sl=!1),kc(i,o,d),Ah(d.stateNode),Tn=p,Sl=y;break;case 5:Ss||OA(d,o);case 6:if(p=Tn,y=Sl,Tn=null,kc(i,o,d),Tn=p,Sl=y,Tn!==null)if(Sl)try{(Tn.nodeType===9?Tn.body:Tn.nodeName==="HTML"?Tn.ownerDocument.body:Tn).removeChild(d.stateNode)}catch(C){Ha(d,o,C)}else try{Tn.removeChild(d.stateNode)}catch(C){Ha(d,o,C)}break;case 18:Tn!==null&&(Sl?(i=Tn,_5(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,d.stateNode),Td(i)):_5(Tn,d.stateNode));break;case 4:p=Tn,y=Sl,Tn=d.stateNode.containerInfo,Sl=!0,kc(i,o,d),Tn=p,Sl=y;break;case 0:case 11:case 14:case 15:ou(2,d,o),Ss||ou(4,d,o),kc(i,o,d);break;case 1:Ss||(OA(d,o),p=d.stateNode,typeof p.componentWillUnmount=="function"&&B_(d,o,p)),kc(i,o,d);break;case 21:kc(i,o,d);break;case 22:Ss=(p=Ss)||d.memoizedState!==null,kc(i,o,d),Ss=p;break;default:kc(i,o,d)}}function L_(i,o){if(o.memoizedState===null&&(i=o.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{Td(i)}catch(d){Ha(o,o.return,d)}}}function U_(i,o){if(o.memoizedState===null&&(i=o.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Td(i)}catch(d){Ha(o,o.return,d)}}function c6(i){switch(i.tag){case 31:case 13:case 19:var o=i.stateNode;return o===null&&(o=i.stateNode=new E_),o;case 22:return i=i.stateNode,o=i._retryCache,o===null&&(o=i._retryCache=new E_),o;default:throw Error(a(435,i.tag))}}function gg(i,o){var d=c6(i);o.forEach(function(p){if(!d.has(p)){d.add(p);var y=b6.bind(null,i,p);p.then(y,y)}})}function El(i,o){var d=o.deletions;if(d!==null)for(var p=0;p<d.length;p++){var y=d[p],C=i,V=o,ce=V;e:for(;ce!==null;){switch(ce.tag){case 27:if(pu(ce.type)){Tn=ce.stateNode,Sl=!1;break e}break;case 5:Tn=ce.stateNode,Sl=!1;break e;case 3:case 4:Tn=ce.stateNode.containerInfo,Sl=!0;break e}ce=ce.return}if(Tn===null)throw Error(a(160));T_(C,V,y),Tn=null,Sl=!1,C=y.alternate,C!==null&&(C.return=null),y.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)j_(o,i),o=o.sibling}var tA=null;function j_(i,o){var d=i.alternate,p=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:El(o,i),Nl(i),p&4&&(ou(3,i,i.return),Zf(3,i),ou(5,i,i.return));break;case 1:El(o,i),Nl(i),p&512&&(Ss||d===null||OA(d,d.return)),p&64&&Bc&&(i=i.updateQueue,i!==null&&(p=i.callbacks,p!==null&&(d=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=d===null?p:d.concat(p))));break;case 26:var y=tA;if(El(o,i),Nl(i),p&512&&(Ss||d===null||OA(d,d.return)),p&4){var C=d!==null?d.memoizedState:null;if(p=i.memoizedState,d===null)if(p===null)if(i.stateNode===null){e:{p=i.type,d=i.memoizedProps,y=y.ownerDocument||y;t:switch(p){case"title":C=y.getElementsByTagName("title")[0],(!C||C[qe]||C[pe]||C.namespaceURI==="http://www.w3.org/2000/svg"||C.hasAttribute("itemprop"))&&(C=y.createElement(p),y.head.insertBefore(C,y.querySelector("head > title"))),gi(C,p,d),C[pe]=i,Gt(C),p=C;break e;case"link":var V=j5("link","href",y).get(p+(d.href||""));if(V){for(var ce=0;ce<V.length;ce++)if(C=V[ce],C.getAttribute("href")===(d.href==null||d.href===""?null:d.href)&&C.getAttribute("rel")===(d.rel==null?null:d.rel)&&C.getAttribute("title")===(d.title==null?null:d.title)&&C.getAttribute("crossorigin")===(d.crossOrigin==null?null:d.crossOrigin)){V.splice(ce,1);break t}}C=y.createElement(p),gi(C,p,d),y.head.appendChild(C);break;case"meta":if(V=j5("meta","content",y).get(p+(d.content||""))){for(ce=0;ce<V.length;ce++)if(C=V[ce],C.getAttribute("content")===(d.content==null?null:""+d.content)&&C.getAttribute("name")===(d.name==null?null:d.name)&&C.getAttribute("property")===(d.property==null?null:d.property)&&C.getAttribute("http-equiv")===(d.httpEquiv==null?null:d.httpEquiv)&&C.getAttribute("charset")===(d.charSet==null?null:d.charSet)){V.splice(ce,1);break t}}C=y.createElement(p),gi(C,p,d),y.head.appendChild(C);break;default:throw Error(a(468,p))}C[pe]=i,Gt(C),p=C}i.stateNode=p}else D5(y,i.type,i.stateNode);else i.stateNode=U5(y,p,i.memoizedProps);else C!==p?(C===null?d.stateNode!==null&&(d=d.stateNode,d.parentNode.removeChild(d)):C.count--,p===null?D5(y,i.type,i.stateNode):U5(y,p,i.memoizedProps)):p===null&&i.stateNode!==null&&H1(i,i.memoizedProps,d.memoizedProps)}break;case 27:El(o,i),Nl(i),p&512&&(Ss||d===null||OA(d,d.return)),d!==null&&p&4&&H1(i,i.memoizedProps,d.memoizedProps);break;case 5:if(El(o,i),Nl(i),p&512&&(Ss||d===null||OA(d,d.return)),i.flags&32){y=i.stateNode;try{Ci(y,"")}catch(sr){Ha(i,i.return,sr)}}p&4&&i.stateNode!=null&&(y=i.memoizedProps,H1(i,y,d!==null?d.memoizedProps:y)),p&1024&&(q1=!0);break;case 6:if(El(o,i),Nl(i),p&4){if(i.stateNode===null)throw Error(a(162));p=i.memoizedProps,d=i.stateNode;try{d.nodeValue=p}catch(sr){Ha(i,i.return,sr)}}break;case 3:if(Lg=null,y=tA,tA=Fg(o.containerInfo),El(o,i),tA=y,Nl(i),p&4&&d!==null&&d.memoizedState.isDehydrated)try{Td(o.containerInfo)}catch(sr){Ha(i,i.return,sr)}q1&&(q1=!1,D_(i));break;case 4:p=tA,tA=Fg(i.stateNode.containerInfo),El(o,i),Nl(i),tA=p;break;case 12:El(o,i),Nl(i);break;case 31:El(o,i),Nl(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,gg(i,p)));break;case 13:El(o,i),Nl(i),i.child.flags&8192&&i.memoizedState!==null!=(d!==null&&d.memoizedState!==null)&&(xg=jt()),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,gg(i,p)));break;case 22:y=i.memoizedState!==null;var Te=d!==null&&d.memoizedState!==null,Je=Bc,ot=Ss;if(Bc=Je||y,Ss=ot||Te,El(o,i),Ss=ot,Bc=Je,Nl(i),p&8192)e:for(o=i.stateNode,o._visibility=y?o._visibility&-2:o._visibility|1,y&&(d===null||Te||Bc||Ss||p0(i)),d=null,o=i;;){if(o.tag===5||o.tag===26){if(d===null){Te=d=o;try{if(C=Te.stateNode,y)V=C.style,typeof V.setProperty=="function"?V.setProperty("display","none","important"):V.display="none";else{ce=Te.stateNode;var gt=Te.memoizedProps.style,Ze=gt!=null&&gt.hasOwnProperty("display")?gt.display:null;ce.style.display=Ze==null||typeof Ze=="boolean"?"":(""+Ze).trim()}}catch(sr){Ha(Te,Te.return,sr)}}}else if(o.tag===6){if(d===null){Te=o;try{Te.stateNode.nodeValue=y?"":Te.memoizedProps}catch(sr){Ha(Te,Te.return,sr)}}}else if(o.tag===18){if(d===null){Te=o;try{var rt=Te.stateNode;y?B5(rt,!0):B5(Te.stateNode,!1)}catch(sr){Ha(Te,Te.return,sr)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===i)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break e;for(;o.sibling===null;){if(o.return===null||o.return===i)break e;d===o&&(d=null),o=o.return}d===o&&(d=null),o.sibling.return=o.return,o=o.sibling}p&4&&(p=i.updateQueue,p!==null&&(d=p.retryQueue,d!==null&&(p.retryQueue=null,gg(i,d))));break;case 19:El(o,i),Nl(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,gg(i,p)));break;case 30:break;case 21:break;default:El(o,i),Nl(i)}}function Nl(i){var o=i.flags;if(o&2){try{for(var d,p=i.return;p!==null;){if(C_(p)){d=p;break}p=p.return}if(d==null)throw Error(a(160));switch(d.tag){case 27:var y=d.stateNode,C=P1(i);pg(i,C,y);break;case 5:var V=d.stateNode;d.flags&32&&(Ci(V,""),d.flags&=-33);var ce=P1(i);pg(i,ce,V);break;case 3:case 4:var Te=d.stateNode.containerInfo,Je=P1(i);K1(i,Je,Te);break;default:throw Error(a(161))}}catch(ot){Ha(i,i.return,ot)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function D_(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var o=i;D_(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),i=i.sibling}}function Cc(i,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)N_(i,o.alternate,o),o=o.sibling}function p0(i){for(i=i.child;i!==null;){var o=i;switch(o.tag){case 0:case 11:case 14:case 15:ou(4,o,o.return),p0(o);break;case 1:OA(o,o.return);var d=o.stateNode;typeof d.componentWillUnmount=="function"&&B_(o,o.return,d),p0(o);break;case 27:Ah(o.stateNode);case 26:case 5:OA(o,o.return),p0(o);break;case 22:o.memoizedState===null&&p0(o);break;case 30:p0(o);break;default:p0(o)}i=i.sibling}}function Sc(i,o,d){for(d=d&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var p=o.alternate,y=i,C=o,V=C.flags;switch(C.tag){case 0:case 11:case 15:Sc(y,C,d),Zf(4,C);break;case 1:if(Sc(y,C,d),p=C,y=p.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(Je){Ha(p,p.return,Je)}if(p=C,y=p.updateQueue,y!==null){var ce=p.stateNode;try{var Te=y.shared.hiddenCallbacks;if(Te!==null)for(y.shared.hiddenCallbacks=null,y=0;y<Te.length;y++)Xs(Te[y],ce)}catch(Je){Ha(p,p.return,Je)}}d&&V&64&&__(C),eh(C,C.return);break;case 27:S_(C);case 26:case 5:Sc(y,C,d),d&&p===null&&V&4&&k_(C),eh(C,C.return);break;case 12:Sc(y,C,d);break;case 31:Sc(y,C,d),d&&V&4&&L_(y,C);break;case 13:Sc(y,C,d),d&&V&4&&U_(y,C);break;case 22:C.memoizedState===null&&Sc(y,C,d),eh(C,C.return);break;case 30:break;default:Sc(y,C,d)}o=o.sibling}}function z1(i,o){var d=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(d=i.memoizedState.cachePool.pool),i=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(i=o.memoizedState.cachePool.pool),i!==d&&(i!=null&&i.refCount++,d!=null&&c0(d))}function V1(i,o){i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&c0(i))}function rA(i,o,d,p){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)I_(i,o,d,p),o=o.sibling}function I_(i,o,d,p){var y=o.flags;switch(o.tag){case 0:case 11:case 15:rA(i,o,d,p),y&2048&&Zf(9,o);break;case 1:rA(i,o,d,p);break;case 3:rA(i,o,d,p),y&2048&&(i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&c0(i)));break;case 12:if(y&2048){rA(i,o,d,p),i=o.stateNode;try{var C=o.memoizedProps,V=C.id,ce=C.onPostCommit;typeof ce=="function"&&ce(V,o.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(Te){Ha(o,o.return,Te)}}else rA(i,o,d,p);break;case 31:rA(i,o,d,p);break;case 13:rA(i,o,d,p);break;case 23:break;case 22:C=o.stateNode,V=o.alternate,o.memoizedState!==null?C._visibility&2?rA(i,o,d,p):th(i,o):C._visibility&2?rA(i,o,d,p):(C._visibility|=2,vd(i,o,d,p,(o.subtreeFlags&10256)!==0||!1)),y&2048&&z1(V,o);break;case 24:rA(i,o,d,p),y&2048&&V1(o.alternate,o);break;default:rA(i,o,d,p)}}function vd(i,o,d,p,y){for(y=y&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var C=i,V=o,ce=d,Te=p,Je=V.flags;switch(V.tag){case 0:case 11:case 15:vd(C,V,ce,Te,y),Zf(8,V);break;case 23:break;case 22:var ot=V.stateNode;V.memoizedState!==null?ot._visibility&2?vd(C,V,ce,Te,y):th(C,V):(ot._visibility|=2,vd(C,V,ce,Te,y)),y&&Je&2048&&z1(V.alternate,V);break;case 24:vd(C,V,ce,Te,y),y&&Je&2048&&V1(V.alternate,V);break;default:vd(C,V,ce,Te,y)}o=o.sibling}}function th(i,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var d=i,p=o,y=p.flags;switch(p.tag){case 22:th(d,p),y&2048&&z1(p.alternate,p);break;case 24:th(d,p),y&2048&&V1(p.alternate,p);break;default:th(d,p)}o=o.sibling}}var rh=8192;function wd(i,o,d){if(i.subtreeFlags&rh)for(i=i.child;i!==null;)Q_(i,o,d),i=i.sibling}function Q_(i,o,d){switch(i.tag){case 26:wd(i,o,d),i.flags&rh&&i.memoizedState!==null&&Y6(d,tA,i.memoizedState,i.memoizedProps);break;case 5:wd(i,o,d);break;case 3:case 4:var p=tA;tA=Fg(i.stateNode.containerInfo),wd(i,o,d),tA=p;break;case 22:i.memoizedState===null&&(p=i.alternate,p!==null&&p.memoizedState!==null?(p=rh,rh=16777216,wd(i,o,d),rh=p):wd(i,o,d));break;default:wd(i,o,d)}}function O_(i){var o=i.alternate;if(o!==null&&(i=o.child,i!==null)){o.child=null;do o=i.sibling,i.sibling=null,i=o;while(i!==null)}}function ah(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var d=0;d<o.length;d++){var p=o[d];$s=p,M_(p,i)}O_(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)R_(i),i=i.sibling}function R_(i){switch(i.tag){case 0:case 11:case 15:ah(i),i.flags&2048&&ou(9,i,i.return);break;case 3:ah(i);break;case 12:ah(i);break;case 22:var o=i.stateNode;i.memoizedState!==null&&o._visibility&2&&(i.return===null||i.return.tag!==13)?(o._visibility&=-3,mg(i)):ah(i);break;default:ah(i)}}function mg(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var d=0;d<o.length;d++){var p=o[d];$s=p,M_(p,i)}O_(i)}for(i=i.child;i!==null;){switch(o=i,o.tag){case 0:case 11:case 15:ou(8,o,o.return),mg(o);break;case 22:d=o.stateNode,d._visibility&2&&(d._visibility&=-3,mg(o));break;default:mg(o)}i=i.sibling}}function M_(i,o){for(;$s!==null;){var d=$s;switch(d.tag){case 0:case 11:case 15:ou(8,d,o);break;case 23:case 22:if(d.memoizedState!==null&&d.memoizedState.cachePool!==null){var p=d.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:c0(d.memoizedState.cache)}if(p=d.child,p!==null)p.return=d,$s=p;else e:for(d=i;$s!==null;){p=$s;var y=p.sibling,C=p.return;if(F_(p),p===d){$s=null;break e}if(y!==null){y.return=C,$s=y;break e}$s=C}}}var u6={getCacheForType:function(i){var o=Os(On),d=o.data.get(i);return d===void 0&&(d=i(),o.data.set(i,d)),d},cacheSignal:function(){return Os(On).controller.signal}},d6=typeof WeakMap=="function"?WeakMap:Map,Da=0,An=null,oa=null,ua=0,Ma=0,to=null,Au=!1,yd=!1,G1=!1,Ec=0,Jn=0,cu=0,g0=0,W1=0,ro=0,_d=0,nh=null,Fl=null,X1=!1,xg=0,H_=0,bg=1/0,vg=null,uu=null,Ms=0,du=null,Bd=null,Nc=0,Y1=0,$1=null,P_=null,sh=0,J1=null;function ao(){return(Da&2)!==0&&ua!==0?ua&-ua:Z.T!==null?nb():ae()}function K_(){if(ro===0)if((ua&536870912)===0||la){var i=Ur;Ur<<=1,(Ur&3932160)===0&&(Ur=262144),ro=i}else ro=536870912;return i=vn.current,i!==null&&(i.flags|=32),ro}function Tl(i,o,d){(i===An&&(Ma===2||Ma===9)||i.cancelPendingCommit!==null)&&(kd(i,0),fu(i,ua,ro,!1)),Nt(i,d),((Da&2)===0||i!==An)&&(i===An&&((Da&2)===0&&(g0|=d),Jn===4&&fu(i,ua,ro,!1)),RA(i))}function q_(i,o,d){if((Da&6)!==0)throw Error(a(327));var p=!d&&(o&127)===0&&(o&i.expiredLanes)===0||Me(i,o),y=p?p6(i,o):eb(i,o,!0),C=p;do{if(y===0){yd&&!p&&fu(i,o,0,!1);break}else{if(d=i.current.alternate,C&&!f6(d)){y=eb(i,o,!1),C=!1;continue}if(y===2){if(C=o,i.errorRecoveryDisabledLanes&C)var V=0;else V=i.pendingLanes&-536870913,V=V!==0?V:V&536870912?536870912:0;if(V!==0){o=V;e:{var ce=i;y=nh;var Te=ce.current.memoizedState.isDehydrated;if(Te&&(kd(ce,V).flags|=256),V=eb(ce,V,!1),V!==2){if(G1&&!Te){ce.errorRecoveryDisabledLanes|=C,g0|=C,y=4;break e}C=Fl,Fl=y,C!==null&&(Fl===null?Fl=C:Fl.push.apply(Fl,C))}y=V}if(C=!1,y!==2)continue}}if(y===1){kd(i,0),fu(i,o,0,!0);break}e:{switch(p=i,C=y,C){case 0:case 1:throw Error(a(345));case 4:if((o&4194048)!==o)break;case 6:fu(p,o,ro,!Au);break e;case 2:Fl=null;break;case 3:case 5:break;default:throw Error(a(329))}if((o&62914560)===o&&(y=xg+300-jt(),10<y)){if(fu(p,o,ro,!Au),Wt(p,0,!0)!==0)break e;Nc=o,p.timeoutHandle=w5(z_.bind(null,p,d,Fl,vg,X1,o,ro,g0,_d,Au,C,"Throttled",-0,0),y);break e}z_(p,d,Fl,vg,X1,o,ro,g0,_d,Au,C,null,-0,0)}}break}while(!0);RA(i)}function z_(i,o,d,p,y,C,V,ce,Te,Je,ot,gt,Ze,rt){if(i.timeoutHandle=-1,gt=o.subtreeFlags,gt&8192||(gt&16785408)===16785408){gt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Us},Q_(o,C,gt);var sr=(C&62914560)===C?xg-jt():(C&4194048)===C?H_-jt():0;if(sr=$6(gt,sr),sr!==null){Nc=C,i.cancelPendingCommit=sr(Z_.bind(null,i,o,C,d,p,y,V,ce,Te,ot,gt,null,Ze,rt)),fu(i,C,V,!Je);return}}Z_(i,o,C,d,p,y,V,ce,Te)}function f6(i){for(var o=i;;){var d=o.tag;if((d===0||d===11||d===15)&&o.flags&16384&&(d=o.updateQueue,d!==null&&(d=d.stores,d!==null)))for(var p=0;p<d.length;p++){var y=d[p],C=y.getSnapshot;y=y.value;try{if(!is(C(),y))return!1}catch{return!1}}if(d=o.child,o.subtreeFlags&16384&&d!==null)d.return=o,o=d;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function fu(i,o,d,p){o&=~W1,o&=~g0,i.suspendedLanes|=o,i.pingedLanes&=~o,p&&(i.warmLanes|=o),p=i.expirationTimes;for(var y=o;0<y;){var C=31-it(y),V=1<<C;p[C]=-1,y&=~V}d!==0&&ca(i,d,o)}function wg(){return(Da&6)===0?(ih(0),!1):!0}function Z1(){if(oa!==null){if(Ma===0)var i=oa.return;else i=oa,bo=FA=null,fd(i),vt=null,lr=0,i=oa;for(;i!==null;)y_(i.alternate,i),i=i.return;oa=null}}function kd(i,o){var d=i.timeoutHandle;d!==-1&&(i.timeoutHandle=-1,U6(d)),d=i.cancelPendingCommit,d!==null&&(i.cancelPendingCommit=null,d()),Nc=0,Z1(),An=i,oa=d=bl(i.current,null),ua=o,Ma=0,to=null,Au=!1,yd=Me(i,o),G1=!1,_d=ro=W1=g0=cu=Jn=0,Fl=nh=null,X1=!1,(o&8)!==0&&(o|=o&32);var p=i.entangledLanes;if(p!==0)for(i=i.entanglements,p&=o;0<p;){var y=31-it(p),C=1<<y;o|=i[y],p&=~C}return Ec=o,n0(),d}function V_(i,o){br=null,Z.H=Yf,o===Ue||o===ye?(o=dt(),Ma=3):o===Ye?(o=dt(),Ma=4):Ma=o===T1?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,to=o,oa===null&&(Jn=1,cg(i,vl(o,i.current)))}function G_(){var i=vn.current;return i===null?!0:(ua&4194048)===ua?ba===null:(ua&62914560)===ua||(ua&536870912)!==0?i===ba:!1}function W_(){var i=Z.H;return Z.H=Yf,i===null?Yf:i}function X_(){var i=Z.A;return Z.A=u6,i}function yg(){Jn=4,Au||(ua&4194048)!==ua&&vn.current!==null||(yd=!0),(cu&134217727)===0&&(g0&134217727)===0||An===null||fu(An,ua,ro,!1)}function eb(i,o,d){var p=Da;Da|=2;var y=W_(),C=X_();(An!==i||ua!==o)&&(vg=null,kd(i,o)),o=!1;var V=Jn;e:do try{if(Ma!==0&&oa!==null){var ce=oa,Te=to;switch(Ma){case 8:Z1(),V=6;break e;case 3:case 2:case 9:case 6:vn.current===null&&(o=!0);var Je=Ma;if(Ma=0,to=null,Cd(i,ce,Te,Je),d&&yd){V=0;break e}break;default:Je=Ma,Ma=0,to=null,Cd(i,ce,Te,Je)}}h6(),V=Jn;break}catch(ot){V_(i,ot)}while(!0);return o&&i.shellSuspendCounter++,bo=FA=null,Da=p,Z.H=y,Z.A=C,oa===null&&(An=null,ua=0,n0()),V}function h6(){for(;oa!==null;)Y_(oa)}function p6(i,o){var d=Da;Da|=2;var p=W_(),y=X_();An!==i||ua!==o?(vg=null,bg=jt()+500,kd(i,o)):yd=Me(i,o);e:do try{if(Ma!==0&&oa!==null){o=oa;var C=to;t:switch(Ma){case 1:Ma=0,to=null,Cd(i,o,C,1);break;case 2:case 9:if(Ge(C)){Ma=0,to=null,$_(o);break}o=function(){Ma!==2&&Ma!==9||An!==i||(Ma=7),RA(i)},C.then(o,o);break e;case 3:Ma=7;break e;case 4:Ma=5;break e;case 7:Ge(C)?(Ma=0,to=null,$_(o)):(Ma=0,to=null,Cd(i,o,C,7));break;case 5:var V=null;switch(oa.tag){case 26:V=oa.memoizedState;case 5:case 27:var ce=oa;if(V?I5(V):ce.stateNode.complete){Ma=0,to=null;var Te=ce.sibling;if(Te!==null)oa=Te;else{var Je=ce.return;Je!==null?(oa=Je,_g(Je)):oa=null}break t}}Ma=0,to=null,Cd(i,o,C,5);break;case 6:Ma=0,to=null,Cd(i,o,C,6);break;case 8:Z1(),Jn=6;break e;default:throw Error(a(462))}}g6();break}catch(ot){V_(i,ot)}while(!0);return bo=FA=null,Z.H=p,Z.A=y,Da=d,oa!==null?0:(An=null,ua=0,n0(),Jn)}function g6(){for(;oa!==null&&!qt();)Y_(oa)}function Y_(i){var o=v_(i.alternate,i,Ec);i.memoizedProps=i.pendingProps,o===null?_g(i):oa=o}function $_(i){var o=i,d=o.alternate;switch(o.tag){case 15:case 0:o=h_(d,o,o.pendingProps,o.type,void 0,ua);break;case 11:o=h_(d,o,o.pendingProps,o.type.render,o.ref,ua);break;case 5:fd(o);default:y_(d,o),o=oa=l0(o,Ec),o=v_(d,o,Ec)}i.memoizedProps=i.pendingProps,o===null?_g(i):oa=o}function Cd(i,o,d,p){bo=FA=null,fd(o),vt=null,lr=0;var y=o.return;try{if(n6(i,y,o,d,ua)){Jn=1,cg(i,vl(d,i.current)),oa=null;return}}catch(C){if(y!==null)throw oa=y,C;Jn=1,cg(i,vl(d,i.current)),oa=null;return}o.flags&32768?(la||p===1?i=!0:yd||(ua&536870912)!==0?i=!1:(Au=i=!0,(p===2||p===9||p===3||p===6)&&(p=vn.current,p!==null&&p.tag===13&&(p.flags|=16384))),J_(o,i)):_g(o)}function _g(i){var o=i;do{if((o.flags&32768)!==0){J_(o,Au);return}i=o.return;var d=l6(o.alternate,o,Ec);if(d!==null){oa=d;return}if(o=o.sibling,o!==null){oa=o;return}oa=o=i}while(o!==null);Jn===0&&(Jn=5)}function J_(i,o){do{var d=o6(i.alternate,i);if(d!==null){d.flags&=32767,oa=d;return}if(d=i.return,d!==null&&(d.flags|=32768,d.subtreeFlags=0,d.deletions=null),!o&&(i=i.sibling,i!==null)){oa=i;return}oa=i=d}while(i!==null);Jn=6,oa=null}function Z_(i,o,d,p,y,C,V,ce,Te){i.cancelPendingCommit=null;do Bg();while(Ms!==0);if((Da&6)!==0)throw Error(a(327));if(o!==null){if(o===i.current)throw Error(a(177));if(C=o.lanes|o.childLanes,C|=Z0,Sr(i,d,C,V,ce,Te),i===An&&(oa=An=null,ua=0),Bd=o,du=i,Nc=d,Y1=C,$1=y,P_=p,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,v6(It,function(){return n5(),null})):(i.callbackNode=null,i.callbackPriority=0),p=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||p){p=Z.T,Z.T=null,y=Ae.p,Ae.p=2,V=Da,Da|=4;try{A6(i,o,d)}finally{Da=V,Ae.p=y,Z.T=p}}Ms=1,e5(),t5(),r5()}}function e5(){if(Ms===1){Ms=0;var i=du,o=Bd,d=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||d){d=Z.T,Z.T=null;var p=Ae.p;Ae.p=2;var y=Da;Da|=4;try{j_(o,i);var C=db,V=ci(i.containerInfo),ce=C.focusedElem,Te=C.selectionRange;if(V!==ce&&ce&&ce.ownerDocument&&Jl(ce.ownerDocument.documentElement,ce)){if(Te!==null&&Ti(ce)){var Je=Te.start,ot=Te.end;if(ot===void 0&&(ot=Je),"selectionStart"in ce)ce.selectionStart=Je,ce.selectionEnd=Math.min(ot,ce.value.length);else{var gt=ce.ownerDocument||document,Ze=gt&&gt.defaultView||window;if(Ze.getSelection){var rt=Ze.getSelection(),sr=ce.textContent.length,Nr=Math.min(Te.start,sr),Ja=Te.end===void 0?Nr:Math.min(Te.end,sr);!rt.extend&&Nr>Ja&&(V=Ja,Ja=Nr,Nr=V);var Ve=ml(ce,Nr),Ie=ml(ce,Ja);if(Ve&&Ie&&(rt.rangeCount!==1||rt.anchorNode!==Ve.node||rt.anchorOffset!==Ve.offset||rt.focusNode!==Ie.node||rt.focusOffset!==Ie.offset)){var $e=gt.createRange();$e.setStart(Ve.node,Ve.offset),rt.removeAllRanges(),Nr>Ja?(rt.addRange($e),rt.extend(Ie.node,Ie.offset)):($e.setEnd(Ie.node,Ie.offset),rt.addRange($e))}}}}for(gt=[],rt=ce;rt=rt.parentNode;)rt.nodeType===1&&gt.push({element:rt,left:rt.scrollLeft,top:rt.scrollTop});for(typeof ce.focus=="function"&&ce.focus(),ce=0;ce<gt.length;ce++){var ft=gt[ce];ft.element.scrollLeft=ft.left,ft.element.scrollTop=ft.top}}Ig=!!ub,db=ub=null}finally{Da=y,Ae.p=p,Z.T=d}}i.current=o,Ms=2}}function t5(){if(Ms===2){Ms=0;var i=du,o=Bd,d=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||d){d=Z.T,Z.T=null;var p=Ae.p;Ae.p=2;var y=Da;Da|=4;try{N_(i,o.alternate,o)}finally{Da=y,Ae.p=p,Z.T=d}}Ms=3}}function r5(){if(Ms===4||Ms===3){Ms=0,Lt();var i=du,o=Bd,d=Nc,p=P_;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Ms=5:(Ms=0,Bd=du=null,a5(i,i.pendingLanes));var y=i.pendingLanes;if(y===0&&(uu=null),Er(d),o=o.stateNode,Ee&&typeof Ee.onCommitFiberRoot=="function")try{Ee.onCommitFiberRoot($t,o,void 0,(o.current.flags&128)===128)}catch{}if(p!==null){o=Z.T,y=Ae.p,Ae.p=2,Z.T=null;try{for(var C=i.onRecoverableError,V=0;V<p.length;V++){var ce=p[V];C(ce.value,{componentStack:ce.stack})}}finally{Z.T=o,Ae.p=y}}(Nc&3)!==0&&Bg(),RA(i),y=i.pendingLanes,(d&261930)!==0&&(y&42)!==0?i===J1?sh++:(sh=0,J1=i):sh=0,ih(0)}}function a5(i,o){(i.pooledCacheLanes&=o)===0&&(o=i.pooledCache,o!=null&&(i.pooledCache=null,c0(o)))}function Bg(){return e5(),t5(),r5(),n5()}function n5(){if(Ms!==5)return!1;var i=du,o=Y1;Y1=0;var d=Er(Nc),p=Z.T,y=Ae.p;try{Ae.p=32>d?32:d,Z.T=null,d=$1,$1=null;var C=du,V=Nc;if(Ms=0,Bd=du=null,Nc=0,(Da&6)!==0)throw Error(a(331));var ce=Da;if(Da|=4,R_(C.current),I_(C,C.current,V,d),Da=ce,ih(0,!1),Ee&&typeof Ee.onPostCommitFiberRoot=="function")try{Ee.onPostCommitFiberRoot($t,C)}catch{}return!0}finally{Ae.p=y,Z.T=p,a5(i,o)}}function s5(i,o,d){o=vl(d,o),o=F1(i.stateNode,o,2),i=Gr(i,o,2),i!==null&&(Nt(i,2),RA(i))}function Ha(i,o,d){if(i.tag===3)s5(i,i,d);else for(;o!==null;){if(o.tag===3){s5(o,i,d);break}else if(o.tag===1){var p=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(uu===null||!uu.has(p))){i=vl(d,i),d=i_(2),p=Gr(o,d,2),p!==null&&(l_(d,p,o,i),Nt(p,2),RA(p));break}}o=o.return}}function tb(i,o,d){var p=i.pingCache;if(p===null){p=i.pingCache=new d6;var y=new Set;p.set(o,y)}else y=p.get(o),y===void 0&&(y=new Set,p.set(o,y));y.has(d)||(G1=!0,y.add(d),i=m6.bind(null,i,o,d),o.then(i,i))}function m6(i,o,d){var p=i.pingCache;p!==null&&p.delete(o),i.pingedLanes|=i.suspendedLanes&d,i.warmLanes&=~d,An===i&&(ua&d)===d&&(Jn===4||Jn===3&&(ua&62914560)===ua&&300>jt()-xg?(Da&2)===0&&kd(i,0):W1|=d,_d===ua&&(_d=0)),RA(i)}function i5(i,o){o===0&&(o=Tt()),i=Xo(i,o),i!==null&&(Nt(i,o),RA(i))}function x6(i){var o=i.memoizedState,d=0;o!==null&&(d=o.retryLane),i5(i,d)}function b6(i,o){var d=0;switch(i.tag){case 31:case 13:var p=i.stateNode,y=i.memoizedState;y!==null&&(d=y.retryLane);break;case 19:p=i.stateNode;break;case 22:p=i.stateNode._retryCache;break;default:throw Error(a(314))}p!==null&&p.delete(o),i5(i,d)}function v6(i,o){return Ut(i,o)}var kg=null,Sd=null,rb=!1,Cg=!1,ab=!1,hu=0;function RA(i){i!==Sd&&i.next===null&&(Sd===null?kg=Sd=i:Sd=Sd.next=i),Cg=!0,rb||(rb=!0,y6())}function ih(i,o){if(!ab&&Cg){ab=!0;do for(var d=!1,p=kg;p!==null;){if(i!==0){var y=p.pendingLanes;if(y===0)var C=0;else{var V=p.suspendedLanes,ce=p.pingedLanes;C=(1<<31-it(42|i)+1)-1,C&=y&~(V&~ce),C=C&201326741?C&201326741|1:C?C|2:0}C!==0&&(d=!0,c5(p,C))}else C=ua,C=Wt(p,p===An?C:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(C&3)===0||Me(p,C)||(d=!0,c5(p,C));p=p.next}while(d);ab=!1}}function w6(){l5()}function l5(){Cg=rb=!1;var i=0;hu!==0&&L6()&&(i=hu);for(var o=jt(),d=null,p=kg;p!==null;){var y=p.next,C=o5(p,o);C===0?(p.next=null,d===null?kg=y:d.next=y,y===null&&(Sd=d)):(d=p,(i!==0||(C&3)!==0)&&(Cg=!0)),p=y}Ms!==0&&Ms!==5||ih(i),hu!==0&&(hu=0)}function o5(i,o){for(var d=i.suspendedLanes,p=i.pingedLanes,y=i.expirationTimes,C=i.pendingLanes&-62914561;0<C;){var V=31-it(C),ce=1<<V,Te=y[V];Te===-1?((ce&d)===0||(ce&p)!==0)&&(y[V]=kt(ce,o)):Te<=o&&(i.expiredLanes|=ce),C&=~ce}if(o=An,d=ua,d=Wt(i,i===o?d:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p=i.callbackNode,d===0||i===o&&(Ma===2||Ma===9)||i.cancelPendingCommit!==null)return p!==null&&p!==null&&yt(p),i.callbackNode=null,i.callbackPriority=0;if((d&3)===0||Me(i,d)){if(o=d&-d,o===i.callbackPriority)return o;switch(p!==null&&yt(p),Er(d)){case 2:case 8:d=Jt;break;case 32:d=It;break;case 268435456:d=ht;break;default:d=It}return p=A5.bind(null,i),d=Ut(d,p),i.callbackPriority=o,i.callbackNode=d,o}return p!==null&&p!==null&&yt(p),i.callbackPriority=2,i.callbackNode=null,2}function A5(i,o){if(Ms!==0&&Ms!==5)return i.callbackNode=null,i.callbackPriority=0,null;var d=i.callbackNode;if(Bg()&&i.callbackNode!==d)return null;var p=ua;return p=Wt(i,i===An?p:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p===0?null:(q_(i,p,o),o5(i,jt()),i.callbackNode!=null&&i.callbackNode===d?A5.bind(null,i):null)}function c5(i,o){if(Bg())return null;q_(i,o,!0)}function y6(){j6(function(){(Da&6)!==0?Ut(zt,w6):l5()})}function nb(){if(hu===0){var i=b;i===0&&(i=Ot,Ot<<=1,(Ot&261888)===0&&(Ot=256)),hu=i}return hu}function u5(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:Ta(""+i)}function d5(i,o){var d=o.ownerDocument.createElement("input");return d.name=o.name,d.value=o.value,i.id&&d.setAttribute("form",i.id),o.parentNode.insertBefore(d,o),i=new FormData(i),d.parentNode.removeChild(d),i}function _6(i,o,d,p,y){if(o==="submit"&&d&&d.stateNode===y){var C=u5((y[K]||null).action),V=p.submitter;V&&(o=(o=V[K]||null)?u5(o.formAction):V.getAttribute("formAction"),o!==null&&(C=o,V=null));var ce=new Ai("action","action",null,p,y);i.push({event:ce,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(hu!==0){var Te=V?d5(y,V):new FormData(y);B1(d,{pending:!0,data:Te,method:y.method,action:C},null,Te)}}else typeof C=="function"&&(ce.preventDefault(),Te=V?d5(y,V):new FormData(y),B1(d,{pending:!0,data:Te,method:y.method,action:C},C,Te))},currentTarget:y}]})}}for(var sb=0;sb<hc.length;sb++){var ib=hc[sb],B6=ib.toLowerCase(),k6=ib[0].toUpperCase()+ib.slice(1);xl(B6,"on"+k6)}xl(fc,"onAnimationEnd"),xl(r0,"onAnimationIteration"),xl(Df,"onAnimationStart"),xl("dblclick","onDoubleClick"),xl("focusin","onFocus"),xl("focusout","onBlur"),xl($p,"onTransitionRun"),xl(Jp,"onTransitionStart"),xl(Zp,"onTransitionCancel"),xl(If,"onTransitionEnd"),vs("onMouseEnter",["mouseout","mouseover"]),vs("onMouseLeave",["mouseout","mouseover"]),vs("onPointerEnter",["pointerout","pointerover"]),vs("onPointerLeave",["pointerout","pointerover"]),sa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),sa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),sa("onBeforeInput",["compositionend","keypress","textInput","paste"]),sa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),sa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),sa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),C6=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(lh));function f5(i,o){o=(o&4)!==0;for(var d=0;d<i.length;d++){var p=i[d],y=p.event;p=p.listeners;e:{var C=void 0;if(o)for(var V=p.length-1;0<=V;V--){var ce=p[V],Te=ce.instance,Je=ce.currentTarget;if(ce=ce.listener,Te!==C&&y.isPropagationStopped())break e;C=ce,y.currentTarget=Je;try{C(y)}catch(ot){a0(ot)}y.currentTarget=null,C=Te}else for(V=0;V<p.length;V++){if(ce=p[V],Te=ce.instance,Je=ce.currentTarget,ce=ce.listener,Te!==C&&y.isPropagationStopped())break e;C=ce,y.currentTarget=Je;try{C(y)}catch(ot){a0(ot)}y.currentTarget=null,C=Te}}}}function Aa(i,o){var d=o[Fe];d===void 0&&(d=o[Fe]=new Set);var p=i+"__bubble";d.has(p)||(h5(o,i,2,!1),d.add(p))}function lb(i,o,d){var p=0;o&&(p|=4),h5(d,i,p,o)}var Sg="_reactListening"+Math.random().toString(36).slice(2);function ob(i){if(!i[Sg]){i[Sg]=!0,wa.forEach(function(d){d!=="selectionchange"&&(C6.has(d)||lb(d,!1,i),lb(d,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[Sg]||(o[Sg]=!0,lb("selectionchange",!1,o))}}function h5(i,o,d,p){switch(K5(o)){case 2:var y=e8;break;case 8:y=t8;break;default:y=_b}d=y.bind(null,o,d,i),y=void 0,!go||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(y=!0),p?y!==void 0?i.addEventListener(o,d,{capture:!0,passive:y}):i.addEventListener(o,d,!0):y!==void 0?i.addEventListener(o,d,{passive:y}):i.addEventListener(o,d,!1)}function Ab(i,o,d,p,y){var C=p;if((o&1)===0&&(o&2)===0&&p!==null)e:for(;;){if(p===null)return;var V=p.tag;if(V===3||V===4){var ce=p.stateNode.containerInfo;if(ce===y)break;if(V===4)for(V=p.return;V!==null;){var Te=V.tag;if((Te===3||Te===4)&&V.stateNode.containerInfo===y)return;V=V.return}for(;ce!==null;){if(V=et(ce),V===null)return;if(Te=V.tag,Te===5||Te===6||Te===26||Te===27){p=C=V;continue e}ce=ce.parentNode}}p=p.return}cc(function(){var Je=C,ot=_s(d),gt=[];e:{var Ze=Qf.get(i);if(Ze!==void 0){var rt=Ai,sr=i;switch(i){case"keypress":if(Si(d)===0)break e;case"keydown":case"keyup":rt=ea;break;case"focusin":sr="focus",rt=Wl;break;case"focusout":sr="blur",rt=Wl;break;case"beforeblur":case"afterblur":rt=Wl;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":rt=yA;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":rt=Gl;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":rt=pn;break;case fc:case r0:case Df:rt=E;break;case If:rt=ss;break;case"scroll":case"scrollend":rt=Vn;break;case"wheel":rt=Ji;break;case"copy":case"cut":case"paste":rt=Be;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":rt=un;break;case"toggle":case"beforetoggle":rt=dc}var Nr=(o&4)!==0,Ja=!Nr&&(i==="scroll"||i==="scrollend"),Ve=Nr?Ze!==null?Ze+"Capture":null:Ze;Nr=[];for(var Ie=Je,$e;Ie!==null;){var ft=Ie;if($e=ft.stateNode,ft=ft.tag,ft!==5&&ft!==26&&ft!==27||$e===null||Ve===null||(ft=Ga(Ie,Ve),ft!=null&&Nr.push(oh(Ie,ft,$e))),Ja)break;Ie=Ie.return}0<Nr.length&&(Ze=new rt(Ze,sr,null,d,ot),gt.push({event:Ze,listeners:Nr}))}}if((o&7)===0){e:{if(Ze=i==="mouseover"||i==="pointerover",rt=i==="mouseout"||i==="pointerout",Ze&&d!==ys&&(sr=d.relatedTarget||d.fromElement)&&(et(sr)||sr[se]))break e;if((rt||Ze)&&(Ze=ot.window===ot?ot:(Ze=ot.ownerDocument)?Ze.defaultView||Ze.parentWindow:window,rt?(sr=d.relatedTarget||d.toElement,rt=Je,sr=sr?et(sr):null,sr!==null&&(Ja=s(sr),Nr=sr.tag,sr!==Ja||Nr!==5&&Nr!==27&&Nr!==6)&&(sr=null)):(rt=null,sr=Je),rt!==sr)){if(Nr=yA,ft="onMouseLeave",Ve="onMouseEnter",Ie="mouse",(i==="pointerout"||i==="pointerover")&&(Nr=un,ft="onPointerLeave",Ve="onPointerEnter",Ie="pointer"),Ja=rt==null?Ze:Ct(rt),$e=sr==null?Ze:Ct(sr),Ze=new Nr(ft,Ie+"leave",rt,d,ot),Ze.target=Ja,Ze.relatedTarget=$e,ft=null,et(ot)===Je&&(Nr=new Nr(Ve,Ie+"enter",sr,d,ot),Nr.target=$e,Nr.relatedTarget=Ja,ft=Nr),Ja=ft,rt&&sr)t:{for(Nr=S6,Ve=rt,Ie=sr,$e=0,ft=Ve;ft;ft=Nr(ft))$e++;ft=0;for(var wr=Ie;wr;wr=Nr(wr))ft++;for(;0<$e-ft;)Ve=Nr(Ve),$e--;for(;0<ft-$e;)Ie=Nr(Ie),ft--;for(;$e--;){if(Ve===Ie||Ie!==null&&Ve===Ie.alternate){Nr=Ve;break t}Ve=Nr(Ve),Ie=Nr(Ie)}Nr=null}else Nr=null;rt!==null&&p5(gt,Ze,rt,Nr,!1),sr!==null&&Ja!==null&&p5(gt,Ja,sr,Nr,!0)}}e:{if(Ze=Je?Ct(Je):window,rt=Ze.nodeName&&Ze.nodeName.toLowerCase(),rt==="select"||rt==="input"&&Ze.type==="file")var Sa=qr;else if(ne(Ze))if(Fr)Sa=mn;else{Sa=ra;var fr=ta}else rt=Ze.nodeName,!rt||rt.toLowerCase()!=="input"||Ze.type!=="checkbox"&&Ze.type!=="radio"?Je&&vA(Je.elementType)&&(Sa=qr):Sa=js;if(Sa&&(Sa=Sa(i,Je))){De(gt,Sa,d,ot);break e}fr&&fr(i,Ze,Je),i==="focusout"&&Je&&Ze.type==="number"&&Je.memoizedProps.value!=null&&xA(Ze,"number",Ze.value)}switch(fr=Je?Ct(Je):window,i){case"focusin":(ne(fr)||fr.contentEditable==="true")&&(ui=fr,di=Je,cr=null);break;case"focusout":cr=di=ui=null;break;case"mousedown":In=!0;break;case"contextmenu":case"mouseup":case"dragend":In=!1,ya(gt,d,ot);break;case"selectionchange":if(Wo)break;case"keydown":case"keyup":ya(gt,d,ot)}var Xr;if(Ei)e:{switch(i){case"compositionstart":var da="onCompositionStart";break e;case"compositionend":da="onCompositionEnd";break e;case"compositionupdate":da="onCompositionUpdate";break e}da=void 0}else Fi?hl(i,d)&&(da="onCompositionEnd"):i==="keydown"&&d.keyCode===229&&(da="onCompositionStart");da&&(Yl&&d.locale!=="ko"&&(Fi||da!=="onCompositionStart"?da==="onCompositionEnd"&&Fi&&(Xr=Yc()):(Bs=ot,zl="value"in Bs?Bs.value:Bs.textContent,Fi=!0)),fr=Eg(Je,da),0<fr.length&&(da=new Ke(da,i,null,d,ot),gt.push({event:da,listeners:fr}),Xr?da.data=Xr:(Xr=BA(d),Xr!==null&&(da.data=Xr)))),(Xr=Go?Sn(i,d):$l(i,d))&&(da=Eg(Je,"onBeforeInput"),0<da.length&&(fr=new Ke("onBeforeInput","beforeinput",null,d,ot),gt.push({event:fr,listeners:da}),fr.data=Xr)),_6(gt,i,Je,d,ot)}f5(gt,o)})}function oh(i,o,d){return{instance:i,listener:o,currentTarget:d}}function Eg(i,o){for(var d=o+"Capture",p=[];i!==null;){var y=i,C=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||C===null||(y=Ga(i,d),y!=null&&p.unshift(oh(i,y,C)),y=Ga(i,o),y!=null&&p.push(oh(i,y,C))),i.tag===3)return p;i=i.return}return[]}function S6(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function p5(i,o,d,p,y){for(var C=o._reactName,V=[];d!==null&&d!==p;){var ce=d,Te=ce.alternate,Je=ce.stateNode;if(ce=ce.tag,Te!==null&&Te===p)break;ce!==5&&ce!==26&&ce!==27||Je===null||(Te=Je,y?(Je=Ga(d,C),Je!=null&&V.unshift(oh(d,Je,Te))):y||(Je=Ga(d,C),Je!=null&&V.push(oh(d,Je,Te)))),d=d.return}V.length!==0&&i.push({event:o,listeners:V})}var E6=/\r\n?/g,N6=/\u0000|\uFFFD/g;function g5(i){return(typeof i=="string"?i:""+i).replace(E6,`
`).replace(N6,"")}function m5(i,o){return o=g5(o),g5(i)===o}function $a(i,o,d,p,y,C){switch(d){case"children":typeof p=="string"?o==="body"||o==="textarea"&&p===""||Ci(i,p):(typeof p=="number"||typeof p=="bigint")&&o!=="body"&&Ci(i,""+p);break;case"className":Vs(i,"class",p);break;case"tabIndex":Vs(i,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":Vs(i,d,p);break;case"style":oc(i,p,C);break;case"data":if(o!=="object"){Vs(i,"data",p);break}case"src":case"href":if(p===""&&(o!=="a"||d!=="href")){i.removeAttribute(d);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(d);break}p=Ta(""+p),i.setAttribute(d,p);break;case"action":case"formAction":if(typeof p=="function"){i.setAttribute(d,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof C=="function"&&(d==="formAction"?(o!=="input"&&$a(i,o,"name",y.name,y,null),$a(i,o,"formEncType",y.formEncType,y,null),$a(i,o,"formMethod",y.formMethod,y,null),$a(i,o,"formTarget",y.formTarget,y,null)):($a(i,o,"encType",y.encType,y,null),$a(i,o,"method",y.method,y,null),$a(i,o,"target",y.target,y,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(d);break}p=Ta(""+p),i.setAttribute(d,p);break;case"onClick":p!=null&&(i.onclick=Us);break;case"onScroll":p!=null&&Aa("scroll",i);break;case"onScrollEnd":p!=null&&Aa("scrollend",i);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(a(61));if(d=p.__html,d!=null){if(y.children!=null)throw Error(a(60));i.innerHTML=d}}break;case"multiple":i.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":i.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){i.removeAttribute("xlink:href");break}d=Ta(""+p),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",d);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(d,""+p):i.removeAttribute(d);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(d,""):i.removeAttribute(d);break;case"capture":case"download":p===!0?i.setAttribute(d,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(d,p):i.removeAttribute(d);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?i.setAttribute(d,p):i.removeAttribute(d);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?i.removeAttribute(d):i.setAttribute(d,p);break;case"popover":Aa("beforetoggle",i),Aa("toggle",i),Ca(i,"popover",p);break;case"xlinkActuate":ii(i,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":ii(i,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":ii(i,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":ii(i,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":ii(i,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":ii(i,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":ii(i,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":ii(i,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":ii(i,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":Ca(i,"is",p);break;case"innerText":case"textContent":break;default:(!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(d=Ac.get(d)||d,Ca(i,d,p))}}function cb(i,o,d,p,y,C){switch(d){case"style":oc(i,p,C);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(a(61));if(d=p.__html,d!=null){if(y.children!=null)throw Error(a(60));i.innerHTML=d}}break;case"children":typeof p=="string"?Ci(i,p):(typeof p=="number"||typeof p=="bigint")&&Ci(i,""+p);break;case"onScroll":p!=null&&Aa("scroll",i);break;case"onScrollEnd":p!=null&&Aa("scrollend",i);break;case"onClick":p!=null&&(i.onclick=Us);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Pr.hasOwnProperty(d))e:{if(d[0]==="o"&&d[1]==="n"&&(y=d.endsWith("Capture"),o=d.slice(2,y?d.length-7:void 0),C=i[K]||null,C=C!=null?C[d]:null,typeof C=="function"&&i.removeEventListener(o,C,y),typeof p=="function")){typeof C!="function"&&C!==null&&(d in i?i[d]=null:i.hasAttribute(d)&&i.removeAttribute(d)),i.addEventListener(o,p,y);break e}d in i?i[d]=p:p===!0?i.setAttribute(d,""):Ca(i,d,p)}}}function gi(i,o,d){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Aa("error",i),Aa("load",i);var p=!1,y=!1,C;for(C in d)if(d.hasOwnProperty(C)){var V=d[C];if(V!=null)switch(C){case"src":p=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,o));default:$a(i,o,C,V,d,null)}}y&&$a(i,o,"srcSet",d.srcSet,d,null),p&&$a(i,o,"src",d.src,d,null);return;case"input":Aa("invalid",i);var ce=C=V=y=null,Te=null,Je=null;for(p in d)if(d.hasOwnProperty(p)){var ot=d[p];if(ot!=null)switch(p){case"name":y=ot;break;case"type":V=ot;break;case"checked":Te=ot;break;case"defaultChecked":Je=ot;break;case"value":C=ot;break;case"defaultValue":ce=ot;break;case"children":case"dangerouslySetInnerHTML":if(ot!=null)throw Error(a(137,o));break;default:$a(i,o,p,ot,d,null)}}oi(i,C,ce,Te,Je,V,y,!1);return;case"select":Aa("invalid",i),p=V=C=null;for(y in d)if(d.hasOwnProperty(y)&&(ce=d[y],ce!=null))switch(y){case"value":C=ce;break;case"defaultValue":V=ce;break;case"multiple":p=ce;default:$a(i,o,y,ce,d,null)}o=C,d=V,i.multiple=!!p,o!=null?hn(i,!!p,o,!1):d!=null&&hn(i,!!p,d,!0);return;case"textarea":Aa("invalid",i),C=y=p=null;for(V in d)if(d.hasOwnProperty(V)&&(ce=d[V],ce!=null))switch(V){case"value":p=ce;break;case"defaultValue":y=ce;break;case"children":C=ce;break;case"dangerouslySetInnerHTML":if(ce!=null)throw Error(a(91));break;default:$a(i,o,V,ce,d,null)}Kl(i,p,y,C);return;case"option":for(Te in d)d.hasOwnProperty(Te)&&(p=d[Te],p!=null)&&(Te==="selected"?i.selected=p&&typeof p!="function"&&typeof p!="symbol":$a(i,o,Te,p,d,null));return;case"dialog":Aa("beforetoggle",i),Aa("toggle",i),Aa("cancel",i),Aa("close",i);break;case"iframe":case"object":Aa("load",i);break;case"video":case"audio":for(p=0;p<lh.length;p++)Aa(lh[p],i);break;case"image":Aa("error",i),Aa("load",i);break;case"details":Aa("toggle",i);break;case"embed":case"source":case"link":Aa("error",i),Aa("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Je in d)if(d.hasOwnProperty(Je)&&(p=d[Je],p!=null))switch(Je){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,o));default:$a(i,o,Je,p,d,null)}return;default:if(vA(o)){for(ot in d)d.hasOwnProperty(ot)&&(p=d[ot],p!==void 0&&cb(i,o,ot,p,d,void 0));return}}for(ce in d)d.hasOwnProperty(ce)&&(p=d[ce],p!=null&&$a(i,o,ce,p,d,null))}function F6(i,o,d,p){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,C=null,V=null,ce=null,Te=null,Je=null,ot=null;for(rt in d){var gt=d[rt];if(d.hasOwnProperty(rt)&&gt!=null)switch(rt){case"checked":break;case"value":break;case"defaultValue":Te=gt;default:p.hasOwnProperty(rt)||$a(i,o,rt,null,p,gt)}}for(var Ze in p){var rt=p[Ze];if(gt=d[Ze],p.hasOwnProperty(Ze)&&(rt!=null||gt!=null))switch(Ze){case"type":C=rt;break;case"name":y=rt;break;case"checked":Je=rt;break;case"defaultChecked":ot=rt;break;case"value":V=rt;break;case"defaultValue":ce=rt;break;case"children":case"dangerouslySetInnerHTML":if(rt!=null)throw Error(a(137,o));break;default:rt!==gt&&$a(i,o,Ze,rt,p,gt)}}mA(i,V,ce,Te,Je,ot,C,y);return;case"select":rt=V=ce=Ze=null;for(C in d)if(Te=d[C],d.hasOwnProperty(C)&&Te!=null)switch(C){case"value":break;case"multiple":rt=Te;default:p.hasOwnProperty(C)||$a(i,o,C,null,p,Te)}for(y in p)if(C=p[y],Te=d[y],p.hasOwnProperty(y)&&(C!=null||Te!=null))switch(y){case"value":Ze=C;break;case"defaultValue":ce=C;break;case"multiple":V=C;default:C!==Te&&$a(i,o,y,C,p,Te)}o=ce,d=V,p=rt,Ze!=null?hn(i,!!d,Ze,!1):!!p!=!!d&&(o!=null?hn(i,!!d,o,!0):hn(i,!!d,d?[]:"",!1));return;case"textarea":rt=Ze=null;for(ce in d)if(y=d[ce],d.hasOwnProperty(ce)&&y!=null&&!p.hasOwnProperty(ce))switch(ce){case"value":break;case"children":break;default:$a(i,o,ce,null,p,y)}for(V in p)if(y=p[V],C=d[V],p.hasOwnProperty(V)&&(y!=null||C!=null))switch(V){case"value":Ze=y;break;case"defaultValue":rt=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(a(91));break;default:y!==C&&$a(i,o,V,y,p,C)}qo(i,Ze,rt);return;case"option":for(var sr in d)Ze=d[sr],d.hasOwnProperty(sr)&&Ze!=null&&!p.hasOwnProperty(sr)&&(sr==="selected"?i.selected=!1:$a(i,o,sr,null,p,Ze));for(Te in p)Ze=p[Te],rt=d[Te],p.hasOwnProperty(Te)&&Ze!==rt&&(Ze!=null||rt!=null)&&(Te==="selected"?i.selected=Ze&&typeof Ze!="function"&&typeof Ze!="symbol":$a(i,o,Te,Ze,p,rt));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Nr in d)Ze=d[Nr],d.hasOwnProperty(Nr)&&Ze!=null&&!p.hasOwnProperty(Nr)&&$a(i,o,Nr,null,p,Ze);for(Je in p)if(Ze=p[Je],rt=d[Je],p.hasOwnProperty(Je)&&Ze!==rt&&(Ze!=null||rt!=null))switch(Je){case"children":case"dangerouslySetInnerHTML":if(Ze!=null)throw Error(a(137,o));break;default:$a(i,o,Je,Ze,p,rt)}return;default:if(vA(o)){for(var Ja in d)Ze=d[Ja],d.hasOwnProperty(Ja)&&Ze!==void 0&&!p.hasOwnProperty(Ja)&&cb(i,o,Ja,void 0,p,Ze);for(ot in p)Ze=p[ot],rt=d[ot],!p.hasOwnProperty(ot)||Ze===rt||Ze===void 0&&rt===void 0||cb(i,o,ot,Ze,p,rt);return}}for(var Ve in d)Ze=d[Ve],d.hasOwnProperty(Ve)&&Ze!=null&&!p.hasOwnProperty(Ve)&&$a(i,o,Ve,null,p,Ze);for(gt in p)Ze=p[gt],rt=d[gt],!p.hasOwnProperty(gt)||Ze===rt||Ze==null&&rt==null||$a(i,o,gt,Ze,p,rt)}function x5(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function T6(){if(typeof performance.getEntriesByType=="function"){for(var i=0,o=0,d=performance.getEntriesByType("resource"),p=0;p<d.length;p++){var y=d[p],C=y.transferSize,V=y.initiatorType,ce=y.duration;if(C&&ce&&x5(V)){for(V=0,ce=y.responseEnd,p+=1;p<d.length;p++){var Te=d[p],Je=Te.startTime;if(Je>ce)break;var ot=Te.transferSize,gt=Te.initiatorType;ot&&x5(gt)&&(Te=Te.responseEnd,V+=ot*(Te<ce?1:(ce-Je)/(Te-Je)))}if(--p,o+=8*(C+V)/(y.duration/1e3),i++,10<i)break}}if(0<i)return o/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var ub=null,db=null;function Ng(i){return i.nodeType===9?i:i.ownerDocument}function b5(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function v5(i,o){if(i===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&o==="foreignObject"?0:i}function fb(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var hb=null;function L6(){var i=window.event;return i&&i.type==="popstate"?i===hb?!1:(hb=i,!0):(hb=null,!1)}var w5=typeof setTimeout=="function"?setTimeout:void 0,U6=typeof clearTimeout=="function"?clearTimeout:void 0,y5=typeof Promise=="function"?Promise:void 0,j6=typeof queueMicrotask=="function"?queueMicrotask:typeof y5<"u"?function(i){return y5.resolve(null).then(i).catch(D6)}:w5;function D6(i){setTimeout(function(){throw i})}function pu(i){return i==="head"}function _5(i,o){var d=o,p=0;do{var y=d.nextSibling;if(i.removeChild(d),y&&y.nodeType===8)if(d=y.data,d==="/$"||d==="/&"){if(p===0){i.removeChild(y),Td(o);return}p--}else if(d==="$"||d==="$?"||d==="$~"||d==="$!"||d==="&")p++;else if(d==="html")Ah(i.ownerDocument.documentElement);else if(d==="head"){d=i.ownerDocument.head,Ah(d);for(var C=d.firstChild;C;){var V=C.nextSibling,ce=C.nodeName;C[qe]||ce==="SCRIPT"||ce==="STYLE"||ce==="LINK"&&C.rel.toLowerCase()==="stylesheet"||d.removeChild(C),C=V}}else d==="body"&&Ah(i.ownerDocument.body);d=y}while(d);Td(o)}function B5(i,o){var d=i;i=0;do{var p=d.nextSibling;if(d.nodeType===1?o?(d._stashedDisplay=d.style.display,d.style.display="none"):(d.style.display=d._stashedDisplay||"",d.getAttribute("style")===""&&d.removeAttribute("style")):d.nodeType===3&&(o?(d._stashedText=d.nodeValue,d.nodeValue=""):d.nodeValue=d._stashedText||""),p&&p.nodeType===8)if(d=p.data,d==="/$"){if(i===0)break;i--}else d!=="$"&&d!=="$?"&&d!=="$~"&&d!=="$!"||i++;d=p}while(d)}function pb(i){var o=i.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var d=o;switch(o=o.nextSibling,d.nodeName){case"HTML":case"HEAD":case"BODY":pb(d),pt(d);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(d.rel.toLowerCase()==="stylesheet")continue}i.removeChild(d)}}function I6(i,o,d,p){for(;i.nodeType===1;){var y=d;if(i.nodeName.toLowerCase()!==o.toLowerCase()){if(!p&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(p){if(!i[qe])switch(o){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(C=i.getAttribute("rel"),C==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(C!==y.rel||i.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||i.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||i.getAttribute("title")!==(y.title==null?null:y.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(C=i.getAttribute("src"),(C!==(y.src==null?null:y.src)||i.getAttribute("type")!==(y.type==null?null:y.type)||i.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&C&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(o==="input"&&i.type==="hidden"){var C=y.name==null?null:""+y.name;if(y.type==="hidden"&&i.getAttribute("name")===C)return i}else return i;if(i=yo(i.nextSibling),i===null)break}return null}function Q6(i,o,d){if(o==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!d||(i=yo(i.nextSibling),i===null))return null;return i}function k5(i,o){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!o||(i=yo(i.nextSibling),i===null))return null;return i}function gb(i){return i.data==="$?"||i.data==="$~"}function mb(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function O6(i,o){var d=i.ownerDocument;if(i.data==="$~")i._reactRetry=o;else if(i.data!=="$?"||d.readyState!=="loading")o();else{var p=function(){o(),d.removeEventListener("DOMContentLoaded",p)};d.addEventListener("DOMContentLoaded",p),i._reactRetry=p}}function yo(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return i}var xb=null;function C5(i){i=i.nextSibling;for(var o=0;i;){if(i.nodeType===8){var d=i.data;if(d==="/$"||d==="/&"){if(o===0)return yo(i.nextSibling);o--}else d!=="$"&&d!=="$!"&&d!=="$?"&&d!=="$~"&&d!=="&"||o++}i=i.nextSibling}return null}function S5(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var d=i.data;if(d==="$"||d==="$!"||d==="$?"||d==="$~"||d==="&"){if(o===0)return i;o--}else d!=="/$"&&d!=="/&"||o++}i=i.previousSibling}return null}function E5(i,o,d){switch(o=Ng(d),i){case"html":if(i=o.documentElement,!i)throw Error(a(452));return i;case"head":if(i=o.head,!i)throw Error(a(453));return i;case"body":if(i=o.body,!i)throw Error(a(454));return i;default:throw Error(a(451))}}function Ah(i){for(var o=i.attributes;o.length;)i.removeAttributeNode(o[0]);pt(i)}var _o=new Map,N5=new Set;function Fg(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Fc=Ae.d;Ae.d={f:R6,r:M6,D:H6,C:P6,L:K6,m:q6,X:V6,S:z6,M:G6};function R6(){var i=Fc.f(),o=wg();return i||o}function M6(i){var o=Rt(i);o!==null&&o.tag===5&&o.type==="form"?Vy(o):Fc.r(i)}var Ed=typeof document>"u"?null:document;function F5(i,o,d){var p=Ed;if(p&&typeof o=="string"&&o){var y=an(o);y='link[rel="'+i+'"][href="'+y+'"]',typeof d=="string"&&(y+='[crossorigin="'+d+'"]'),N5.has(y)||(N5.add(y),i={rel:i,crossOrigin:d,href:o},p.querySelector(y)===null&&(o=p.createElement("link"),gi(o,"link",i),Gt(o),p.head.appendChild(o)))}}function H6(i){Fc.D(i),F5("dns-prefetch",i,null)}function P6(i,o){Fc.C(i,o),F5("preconnect",i,o)}function K6(i,o,d){Fc.L(i,o,d);var p=Ed;if(p&&i&&o){var y='link[rel="preload"][as="'+an(o)+'"]';o==="image"&&d&&d.imageSrcSet?(y+='[imagesrcset="'+an(d.imageSrcSet)+'"]',typeof d.imageSizes=="string"&&(y+='[imagesizes="'+an(d.imageSizes)+'"]')):y+='[href="'+an(i)+'"]';var C=y;switch(o){case"style":C=Nd(i);break;case"script":C=Fd(i)}_o.has(C)||(i=g({rel:"preload",href:o==="image"&&d&&d.imageSrcSet?void 0:i,as:o},d),_o.set(C,i),p.querySelector(y)!==null||o==="style"&&p.querySelector(ch(C))||o==="script"&&p.querySelector(uh(C))||(o=p.createElement("link"),gi(o,"link",i),Gt(o),p.head.appendChild(o)))}}function q6(i,o){Fc.m(i,o);var d=Ed;if(d&&i){var p=o&&typeof o.as=="string"?o.as:"script",y='link[rel="modulepreload"][as="'+an(p)+'"][href="'+an(i)+'"]',C=y;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":C=Fd(i)}if(!_o.has(C)&&(i=g({rel:"modulepreload",href:i},o),_o.set(C,i),d.querySelector(y)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(d.querySelector(uh(C)))return}p=d.createElement("link"),gi(p,"link",i),Gt(p),d.head.appendChild(p)}}}function z6(i,o,d){Fc.S(i,o,d);var p=Ed;if(p&&i){var y=Qt(p).hoistableStyles,C=Nd(i);o=o||"default";var V=y.get(C);if(!V){var ce={loading:0,preload:null};if(V=p.querySelector(ch(C)))ce.loading=5;else{i=g({rel:"stylesheet",href:i,"data-precedence":o},d),(d=_o.get(C))&&bb(i,d);var Te=V=p.createElement("link");Gt(Te),gi(Te,"link",i),Te._p=new Promise(function(Je,ot){Te.onload=Je,Te.onerror=ot}),Te.addEventListener("load",function(){ce.loading|=1}),Te.addEventListener("error",function(){ce.loading|=2}),ce.loading|=4,Tg(V,o,p)}V={type:"stylesheet",instance:V,count:1,state:ce},y.set(C,V)}}}function V6(i,o){Fc.X(i,o);var d=Ed;if(d&&i){var p=Qt(d).hoistableScripts,y=Fd(i),C=p.get(y);C||(C=d.querySelector(uh(y)),C||(i=g({src:i,async:!0},o),(o=_o.get(y))&&vb(i,o),C=d.createElement("script"),Gt(C),gi(C,"link",i),d.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},p.set(y,C))}}function G6(i,o){Fc.M(i,o);var d=Ed;if(d&&i){var p=Qt(d).hoistableScripts,y=Fd(i),C=p.get(y);C||(C=d.querySelector(uh(y)),C||(i=g({src:i,async:!0,type:"module"},o),(o=_o.get(y))&&vb(i,o),C=d.createElement("script"),Gt(C),gi(C,"link",i),d.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},p.set(y,C))}}function T5(i,o,d,p){var y=(y=re.current)?Fg(y):null;if(!y)throw Error(a(446));switch(i){case"meta":case"title":return null;case"style":return typeof d.precedence=="string"&&typeof d.href=="string"?(o=Nd(d.href),d=Qt(y).hoistableStyles,p=d.get(o),p||(p={type:"style",instance:null,count:0,state:null},d.set(o,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(d.rel==="stylesheet"&&typeof d.href=="string"&&typeof d.precedence=="string"){i=Nd(d.href);var C=Qt(y).hoistableStyles,V=C.get(i);if(V||(y=y.ownerDocument||y,V={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},C.set(i,V),(C=y.querySelector(ch(i)))&&!C._p&&(V.instance=C,V.state.loading=5),_o.has(i)||(d={rel:"preload",as:"style",href:d.href,crossOrigin:d.crossOrigin,integrity:d.integrity,media:d.media,hrefLang:d.hrefLang,referrerPolicy:d.referrerPolicy},_o.set(i,d),C||W6(y,i,d,V.state))),o&&p===null)throw Error(a(528,""));return V}if(o&&p!==null)throw Error(a(529,""));return null;case"script":return o=d.async,d=d.src,typeof d=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Fd(d),d=Qt(y).hoistableScripts,p=d.get(o),p||(p={type:"script",instance:null,count:0,state:null},d.set(o,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,i))}}function Nd(i){return'href="'+an(i)+'"'}function ch(i){return'link[rel="stylesheet"]['+i+"]"}function L5(i){return g({},i,{"data-precedence":i.precedence,precedence:null})}function W6(i,o,d,p){i.querySelector('link[rel="preload"][as="style"]['+o+"]")?p.loading=1:(o=i.createElement("link"),p.preload=o,o.addEventListener("load",function(){return p.loading|=1}),o.addEventListener("error",function(){return p.loading|=2}),gi(o,"link",d),Gt(o),i.head.appendChild(o))}function Fd(i){return'[src="'+an(i)+'"]'}function uh(i){return"script[async]"+i}function U5(i,o,d){if(o.count++,o.instance===null)switch(o.type){case"style":var p=i.querySelector('style[data-href~="'+an(d.href)+'"]');if(p)return o.instance=p,Gt(p),p;var y=g({},d,{"data-href":d.href,"data-precedence":d.precedence,href:null,precedence:null});return p=(i.ownerDocument||i).createElement("style"),Gt(p),gi(p,"style",y),Tg(p,d.precedence,i),o.instance=p;case"stylesheet":y=Nd(d.href);var C=i.querySelector(ch(y));if(C)return o.state.loading|=4,o.instance=C,Gt(C),C;p=L5(d),(y=_o.get(y))&&bb(p,y),C=(i.ownerDocument||i).createElement("link"),Gt(C);var V=C;return V._p=new Promise(function(ce,Te){V.onload=ce,V.onerror=Te}),gi(C,"link",p),o.state.loading|=4,Tg(C,d.precedence,i),o.instance=C;case"script":return C=Fd(d.src),(y=i.querySelector(uh(C)))?(o.instance=y,Gt(y),y):(p=d,(y=_o.get(C))&&(p=g({},d),vb(p,y)),i=i.ownerDocument||i,y=i.createElement("script"),Gt(y),gi(y,"link",p),i.head.appendChild(y),o.instance=y);case"void":return null;default:throw Error(a(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(p=o.instance,o.state.loading|=4,Tg(p,d.precedence,i));return o.instance}function Tg(i,o,d){for(var p=d.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=p.length?p[p.length-1]:null,C=y,V=0;V<p.length;V++){var ce=p[V];if(ce.dataset.precedence===o)C=ce;else if(C!==y)break}C?C.parentNode.insertBefore(i,C.nextSibling):(o=d.nodeType===9?d.head:d,o.insertBefore(i,o.firstChild))}function bb(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.title==null&&(i.title=o.title)}function vb(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.integrity==null&&(i.integrity=o.integrity)}var Lg=null;function j5(i,o,d){if(Lg===null){var p=new Map,y=Lg=new Map;y.set(d,p)}else y=Lg,p=y.get(d),p||(p=new Map,y.set(d,p));if(p.has(i))return p;for(p.set(i,null),d=d.getElementsByTagName(i),y=0;y<d.length;y++){var C=d[y];if(!(C[qe]||C[pe]||i==="link"&&C.getAttribute("rel")==="stylesheet")&&C.namespaceURI!=="http://www.w3.org/2000/svg"){var V=C.getAttribute(o)||"";V=i+V;var ce=p.get(V);ce?ce.push(C):p.set(V,[C])}}return p}function D5(i,o,d){i=i.ownerDocument||i,i.head.insertBefore(d,o==="title"?i.querySelector("head > title"):null)}function X6(i,o,d){if(d===1||o.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;return o.rel==="stylesheet"?(i=o.disabled,typeof o.precedence=="string"&&i==null):!0;case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function I5(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function Y6(i,o,d,p){if(d.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(d.state.loading&4)===0){if(d.instance===null){var y=Nd(p.href),C=o.querySelector(ch(y));if(C){o=C._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(i.count++,i=Ug.bind(i),o.then(i,i)),d.state.loading|=4,d.instance=C,Gt(C);return}C=o.ownerDocument||o,p=L5(p),(y=_o.get(y))&&bb(p,y),C=C.createElement("link"),Gt(C);var V=C;V._p=new Promise(function(ce,Te){V.onload=ce,V.onerror=Te}),gi(C,"link",p),d.instance=C}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(d,o),(o=d.state.preload)&&(d.state.loading&3)===0&&(i.count++,d=Ug.bind(i),o.addEventListener("load",d),o.addEventListener("error",d))}}var wb=0;function $6(i,o){return i.stylesheets&&i.count===0&&Dg(i,i.stylesheets),0<i.count||0<i.imgCount?function(d){var p=setTimeout(function(){if(i.stylesheets&&Dg(i,i.stylesheets),i.unsuspend){var C=i.unsuspend;i.unsuspend=null,C()}},6e4+o);0<i.imgBytes&&wb===0&&(wb=62500*T6());var y=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&Dg(i,i.stylesheets),i.unsuspend)){var C=i.unsuspend;i.unsuspend=null,C()}},(i.imgBytes>wb?50:800)+o);return i.unsuspend=d,function(){i.unsuspend=null,clearTimeout(p),clearTimeout(y)}}:null}function Ug(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Dg(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var jg=null;function Dg(i,o){i.stylesheets=null,i.unsuspend!==null&&(i.count++,jg=new Map,o.forEach(J6,i),jg=null,Ug.call(i))}function J6(i,o){if(!(o.state.loading&4)){var d=jg.get(i);if(d)var p=d.get(null);else{d=new Map,jg.set(i,d);for(var y=i.querySelectorAll("link[data-precedence],style[data-precedence]"),C=0;C<y.length;C++){var V=y[C];(V.nodeName==="LINK"||V.getAttribute("media")!=="not all")&&(d.set(V.dataset.precedence,V),p=V)}p&&d.set(null,p)}y=o.instance,V=y.getAttribute("data-precedence"),C=d.get(V)||p,C===p&&d.set(null,y),d.set(V,y),this.count++,p=Ug.bind(this),y.addEventListener("load",p),y.addEventListener("error",p),C?C.parentNode.insertBefore(y,C.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(y,i.firstChild)),o.state.loading|=4}}var dh={$$typeof:S,Provider:null,Consumer:null,_currentValue:ve,_currentValue2:ve,_threadCount:0};function Z6(i,o,d,p,y,C,V,ce,Te){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ir(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ir(0),this.hiddenUpdates=ir(null),this.identifierPrefix=p,this.onUncaughtError=y,this.onCaughtError=C,this.onRecoverableError=V,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Te,this.incompleteTransitions=new Map}function Q5(i,o,d,p,y,C,V,ce,Te,Je,ot,gt){return i=new Z6(i,o,d,V,Te,Je,ot,gt,ce),o=1,C===!0&&(o|=24),C=Ws(3,null,null,o),i.current=C,C.stateNode=i,o=au(),o.refCount++,i.pooledCache=o,o.refCount++,C.memoizedState={element:p,isDehydrated:d,cache:o},Kt(C),i}function O5(i){return i?(i=Ds,i):Ds}function R5(i,o,d,p,y,C){y=O5(y),p.context===null?p.context=y:p.pendingContext=y,p=Cr(o),p.payload={element:d},C=C===void 0?null:C,C!==null&&(p.callback=C),d=Gr(i,p,o),d!==null&&(Tl(d,i,o),Ua(d,i,o))}function M5(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var d=i.retryLane;i.retryLane=d!==0&&d<o?d:o}}function yb(i,o){M5(i,o),(i=i.alternate)&&M5(i,o)}function H5(i){if(i.tag===13||i.tag===31){var o=Xo(i,67108864);o!==null&&Tl(o,i,67108864),yb(i,67108864)}}function P5(i){if(i.tag===13||i.tag===31){var o=ao();o=jr(o);var d=Xo(i,o);d!==null&&Tl(d,i,o),yb(i,o)}}var Ig=!0;function e8(i,o,d,p){var y=Z.T;Z.T=null;var C=Ae.p;try{Ae.p=2,_b(i,o,d,p)}finally{Ae.p=C,Z.T=y}}function t8(i,o,d,p){var y=Z.T;Z.T=null;var C=Ae.p;try{Ae.p=8,_b(i,o,d,p)}finally{Ae.p=C,Z.T=y}}function _b(i,o,d,p){if(Ig){var y=Bb(p);if(y===null)Ab(i,o,p,Qg,d),q5(i,p);else if(a8(y,i,o,d,p))p.stopPropagation();else if(q5(i,p),o&4&&-1<r8.indexOf(i)){for(;y!==null;){var C=Rt(y);if(C!==null)switch(C.tag){case 3:if(C=C.stateNode,C.current.memoizedState.isDehydrated){var V=tt(C.pendingLanes);if(V!==0){var ce=C;for(ce.pendingLanes|=2,ce.entangledLanes|=2;V;){var Te=1<<31-it(V);ce.entanglements[1]|=Te,V&=~Te}RA(C),(Da&6)===0&&(bg=jt()+500,ih(0))}}break;case 31:case 13:ce=Xo(C,2),ce!==null&&Tl(ce,C,2),wg(),yb(C,2)}if(C=Bb(p),C===null&&Ab(i,o,p,Qg,d),C===y)break;y=C}y!==null&&p.stopPropagation()}else Ab(i,o,p,null,d)}}function Bb(i){return i=_s(i),kb(i)}var Qg=null;function kb(i){if(Qg=null,i=et(i),i!==null){var o=s(i);if(o===null)i=null;else{var d=o.tag;if(d===13){if(i=l(o),i!==null)return i;i=null}else if(d===31){if(i=A(o),i!==null)return i;i=null}else if(d===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null)}}return Qg=i,null}function K5(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Pt()){case zt:return 2;case Jt:return 8;case It:case xt:return 32;case ht:return 268435456;default:return 32}default:return 32}}var Cb=!1,gu=null,mu=null,xu=null,fh=new Map,hh=new Map,bu=[],r8="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function q5(i,o){switch(i){case"focusin":case"focusout":gu=null;break;case"dragenter":case"dragleave":mu=null;break;case"mouseover":case"mouseout":xu=null;break;case"pointerover":case"pointerout":fh.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":hh.delete(o.pointerId)}}function ph(i,o,d,p,y,C){return i===null||i.nativeEvent!==C?(i={blockedOn:o,domEventName:d,eventSystemFlags:p,nativeEvent:C,targetContainers:[y]},o!==null&&(o=Rt(o),o!==null&&H5(o)),i):(i.eventSystemFlags|=p,o=i.targetContainers,y!==null&&o.indexOf(y)===-1&&o.push(y),i)}function a8(i,o,d,p,y){switch(o){case"focusin":return gu=ph(gu,i,o,d,p,y),!0;case"dragenter":return mu=ph(mu,i,o,d,p,y),!0;case"mouseover":return xu=ph(xu,i,o,d,p,y),!0;case"pointerover":var C=y.pointerId;return fh.set(C,ph(fh.get(C)||null,i,o,d,p,y)),!0;case"gotpointercapture":return C=y.pointerId,hh.set(C,ph(hh.get(C)||null,i,o,d,p,y)),!0}return!1}function z5(i){var o=et(i.target);if(o!==null){var d=s(o);if(d!==null){if(o=d.tag,o===13){if(o=l(d),o!==null){i.blockedOn=o,xe(i.priority,function(){P5(d)});return}}else if(o===31){if(o=A(d),o!==null){i.blockedOn=o,xe(i.priority,function(){P5(d)});return}}else if(o===3&&d.stateNode.current.memoizedState.isDehydrated){i.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Og(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var d=Bb(i.nativeEvent);if(d===null){d=i.nativeEvent;var p=new d.constructor(d.type,d);ys=p,d.target.dispatchEvent(p),ys=null}else return o=Rt(d),o!==null&&H5(o),i.blockedOn=d,!1;o.shift()}return!0}function V5(i,o,d){Og(i)&&d.delete(o)}function n8(){Cb=!1,gu!==null&&Og(gu)&&(gu=null),mu!==null&&Og(mu)&&(mu=null),xu!==null&&Og(xu)&&(xu=null),fh.forEach(V5),hh.forEach(V5)}function Rg(i,o){i.blockedOn===o&&(i.blockedOn=null,Cb||(Cb=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,n8)))}var Mg=null;function G5(i){Mg!==i&&(Mg=i,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Mg===i&&(Mg=null);for(var o=0;o<i.length;o+=3){var d=i[o],p=i[o+1],y=i[o+2];if(typeof p!="function"){if(kb(p||d)===null)continue;break}var C=Rt(d);C!==null&&(i.splice(o,3),o-=3,B1(C,{pending:!0,data:y,method:d.method,action:p},p,y))}}))}function Td(i){function o(Te){return Rg(Te,i)}gu!==null&&Rg(gu,i),mu!==null&&Rg(mu,i),xu!==null&&Rg(xu,i),fh.forEach(o),hh.forEach(o);for(var d=0;d<bu.length;d++){var p=bu[d];p.blockedOn===i&&(p.blockedOn=null)}for(;0<bu.length&&(d=bu[0],d.blockedOn===null);)z5(d),d.blockedOn===null&&bu.shift();if(d=(i.ownerDocument||i).$$reactFormReplay,d!=null)for(p=0;p<d.length;p+=3){var y=d[p],C=d[p+1],V=y[K]||null;if(typeof C=="function")V||G5(d);else if(V){var ce=null;if(C&&C.hasAttribute("formAction")){if(y=C,V=C[K]||null)ce=V.formAction;else if(kb(y)!==null)continue}else ce=V.action;typeof ce=="function"?d[p+1]=ce:(d.splice(p,3),p-=3),G5(d)}}}function W5(){function i(C){C.canIntercept&&C.info==="react-transition"&&C.intercept({handler:function(){return new Promise(function(V){return y=V})},focusReset:"manual",scroll:"manual"})}function o(){y!==null&&(y(),y=null),p||setTimeout(d,20)}function d(){if(!p&&!navigation.transition){var C=navigation.currentEntry;C&&C.url!=null&&navigation.navigate(C.url,{state:C.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var p=!1,y=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(d,100),function(){p=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),y!==null&&(y(),y=null)}}}function Sb(i){this._internalRoot=i}Hg.prototype.render=Sb.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(a(409));var d=o.current,p=ao();R5(d,p,i,o,null,null)},Hg.prototype.unmount=Sb.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;R5(i.current,2,null,i,null,null),wg(),o[se]=null}};function Hg(i){this._internalRoot=i}Hg.prototype.unstable_scheduleHydration=function(i){if(i){var o=ae();i={blockedOn:null,target:i,priority:o};for(var d=0;d<bu.length&&o!==0&&o<bu[d].priority;d++);bu.splice(d,0,i),d===0&&z5(i)}};var X5=t.version;if(X5!=="19.2.4")throw Error(a(527,X5,"19.2.4"));Ae.findDOMNode=function(i){var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(a(188)):(i=Object.keys(i).join(","),Error(a(268,i)));return i=f(o),i=i!==null?h(i):null,i=i===null?null:i.stateNode,i};var s8={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:Z,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Pg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pg.isDisabled&&Pg.supportsFiber)try{$t=Pg.inject(s8),Ee=Pg}catch{}}return mh.createRoot=function(i,o){if(!n(i))throw Error(a(299));var d=!1,p="",y=r_,C=a_,V=n_;return o!=null&&(o.unstable_strictMode===!0&&(d=!0),o.identifierPrefix!==void 0&&(p=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(C=o.onCaughtError),o.onRecoverableError!==void 0&&(V=o.onRecoverableError)),o=Q5(i,1,!1,null,null,d,p,null,y,C,V,W5),i[se]=o.current,ob(i),new Sb(o)},mh.hydrateRoot=function(i,o,d){if(!n(i))throw Error(a(299));var p=!1,y="",C=r_,V=a_,ce=n_,Te=null;return d!=null&&(d.unstable_strictMode===!0&&(p=!0),d.identifierPrefix!==void 0&&(y=d.identifierPrefix),d.onUncaughtError!==void 0&&(C=d.onUncaughtError),d.onCaughtError!==void 0&&(V=d.onCaughtError),d.onRecoverableError!==void 0&&(ce=d.onRecoverableError),d.formState!==void 0&&(Te=d.formState)),o=Q5(i,1,!0,o,d??null,p,y,Te,C,V,ce,W5),o.context=O5(null),d=o.current,p=ao(),p=jr(p),y=Cr(p),y.callback=null,Gr(d,y,p),d=p,o.current.lanes=d,Nt(o,d),RA(o),i[se]=o.current,ob(i),new Hg(o)},mh.version="19.2.4",mh}var cB;function eL(){if(cB)return Lb.exports;cB=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Lb.exports=Z8(),Lb.exports}var tL=eL();const Mr=e=>typeof e=="string",xh=()=>{let e,t;const r=new Promise((a,n)=>{e=a,t=n});return r.resolve=e,r.reject=t,r},uB=e=>e==null?"":""+e,rL=(e,t,r)=>{e.forEach(a=>{t[a]&&(r[a]=t[a])})},aL=/###/g,dB=e=>e&&e.indexOf("###")>-1?e.replace(aL,"."):e,fB=e=>!e||Mr(e),Ph=(e,t,r)=>{const a=Mr(t)?t.split("."):t;let n=0;for(;n<a.length-1;){if(fB(e))return{};const s=dB(a[n]);!e[s]&&r&&(e[s]=new r),Object.prototype.hasOwnProperty.call(e,s)?e=e[s]:e={},++n}return fB(e)?{}:{obj:e,k:dB(a[n])}},hB=(e,t,r)=>{const{obj:a,k:n}=Ph(e,t,Object);if(a!==void 0||t.length===1){a[n]=r;return}let s=t[t.length-1],l=t.slice(0,t.length-1),A=Ph(e,l,Object);for(;A.obj===void 0&&l.length;)s=`${l[l.length-1]}.${s}`,l=l.slice(0,l.length-1),A=Ph(e,l,Object),A?.obj&&typeof A.obj[`${A.k}.${s}`]<"u"&&(A.obj=void 0);A.obj[`${A.k}.${s}`]=r},nL=(e,t,r,a)=>{const{obj:n,k:s}=Ph(e,t,Object);n[s]=n[s]||[],n[s].push(r)},rx=(e,t)=>{const{obj:r,k:a}=Ph(e,t);if(r&&Object.prototype.hasOwnProperty.call(r,a))return r[a]},sL=(e,t,r)=>{const a=rx(e,r);return a!==void 0?a:rx(t,r)},$S=(e,t,r)=>{for(const a in t)a!=="__proto__"&&a!=="constructor"&&(a in e?Mr(e[a])||e[a]instanceof String||Mr(t[a])||t[a]instanceof String?r&&(e[a]=t[a]):$S(e[a],t[a],r):e[a]=t[a]);return e},m0=e=>e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var iL={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const lL=e=>Mr(e)?e.replace(/[&<>"'\/]/g,t=>iL[t]):e;class oL{constructor(t){this.capacity=t,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(t){const r=this.regExpMap.get(t);if(r!==void 0)return r;const a=new RegExp(t);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(t,a),this.regExpQueue.push(t),a}}const AL=[" ",",","?","!",";"],cL=new oL(20),uL=(e,t,r)=>{t=t||"",r=r||"";const a=AL.filter(l=>t.indexOf(l)<0&&r.indexOf(l)<0);if(a.length===0)return!0;const n=cL.getRegExp(`(${a.map(l=>l==="?"?"\\?":l).join("|")})`);let s=!n.test(e);if(!s){const l=e.indexOf(r);l>0&&!n.test(e.substring(0,l))&&(s=!0)}return s},ew=(e,t,r=".")=>{if(!e)return;if(e[t])return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0;const a=t.split(r);let n=e;for(let s=0;s<a.length;){if(!n||typeof n!="object")return;let l,A="";for(let u=s;u<a.length;++u)if(u!==s&&(A+=r),A+=a[u],l=n[A],l!==void 0){if(["string","number","boolean"].indexOf(typeof l)>-1&&u<a.length-1)continue;s+=u-s+1;break}n=l}return n},up=e=>e?.replace("_","-"),dL={type:"logger",log(e){this.output("log",e)},warn(e){this.output("warn",e)},error(e){this.output("error",e)},output(e,t){console?.[e]?.apply?.(console,t)}};let fL=class tw{constructor(t,r={}){this.init(t,r)}init(t,r={}){this.prefix=r.prefix||"i18next:",this.logger=t||dL,this.options=r,this.debug=r.debug}log(...t){return this.forward(t,"log","",!0)}warn(...t){return this.forward(t,"warn","",!0)}error(...t){return this.forward(t,"error","")}deprecate(...t){return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}forward(t,r,a,n){return n&&!this.debug?null:(Mr(t[0])&&(t[0]=`${a}${this.prefix} ${t[0]}`),this.logger[r](t))}create(t){return new tw(this.logger,{prefix:`${this.prefix}:${t}:`,...this.options})}clone(t){return t=t||this.options,t.prefix=t.prefix||this.prefix,new tw(this.logger,t)}};var ZA=new fL;class Kx{constructor(){this.observers={}}on(t,r){return t.split(" ").forEach(a=>{this.observers[a]||(this.observers[a]=new Map);const n=this.observers[a].get(r)||0;this.observers[a].set(r,n+1)}),this}off(t,r){if(this.observers[t]){if(!r){delete this.observers[t];return}this.observers[t].delete(r)}}emit(t,...r){this.observers[t]&&Array.from(this.observers[t].entries()).forEach(([n,s])=>{for(let l=0;l<s;l++)n(...r)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([n,s])=>{for(let l=0;l<s;l++)n.apply(n,[t,...r])})}}class pB extends Kx{constructor(t,r={ns:["translation"],defaultNS:"translation"}){super(),this.data=t||{},this.options=r,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}removeNamespaces(t){const r=this.options.ns.indexOf(t);r>-1&&this.options.ns.splice(r,1)}getResource(t,r,a,n={}){const s=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator,l=n.ignoreJSONStructure!==void 0?n.ignoreJSONStructure:this.options.ignoreJSONStructure;let A;t.indexOf(".")>-1?A=t.split("."):(A=[t,r],a&&(Array.isArray(a)?A.push(...a):Mr(a)&&s?A.push(...a.split(s)):A.push(a)));const u=rx(this.data,A);return!u&&!r&&!a&&t.indexOf(".")>-1&&(t=A[0],r=A[1],a=A.slice(2).join(".")),u||!l||!Mr(a)?u:ew(this.data?.[t]?.[r],a,s)}addResource(t,r,a,n,s={silent:!1}){const l=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator;let A=[t,r];a&&(A=A.concat(l?a.split(l):a)),t.indexOf(".")>-1&&(A=t.split("."),n=r,r=A[1]),this.addNamespaces(r),hB(this.data,A,n),s.silent||this.emit("added",t,r,a,n)}addResources(t,r,a,n={silent:!1}){for(const s in a)(Mr(a[s])||Array.isArray(a[s]))&&this.addResource(t,r,s,a[s],{silent:!0});n.silent||this.emit("added",t,r,a)}addResourceBundle(t,r,a,n,s,l={silent:!1,skipCopy:!1}){let A=[t,r];t.indexOf(".")>-1&&(A=t.split("."),n=a,a=r,r=A[1]),this.addNamespaces(r);let u=rx(this.data,A)||{};l.skipCopy||(a=JSON.parse(JSON.stringify(a))),n?$S(u,a,s):u={...u,...a},hB(this.data,A,u),l.silent||this.emit("added",t,r,a)}removeResourceBundle(t,r){this.hasResourceBundle(t,r)&&delete this.data[t][r],this.removeNamespaces(r),this.emit("removed",t,r)}hasResourceBundle(t,r){return this.getResource(t,r)!==void 0}getResourceBundle(t,r){return r||(r=this.options.defaultNS),this.getResource(t,r)}getDataByLanguage(t){return this.data[t]}hasLanguageSomeTranslations(t){const r=this.getDataByLanguage(t);return!!(r&&Object.keys(r)||[]).find(n=>r[n]&&Object.keys(r[n]).length>0)}toJSON(){return this.data}}var JS={processors:{},addPostProcessor(e){this.processors[e.name]=e},handle(e,t,r,a,n){return e.forEach(s=>{t=this.processors[s]?.process(t,r,a,n)??t}),t}};const ZS=Symbol("i18next/PATH_KEY");function hL(){const e=[],t=Object.create(null);let r;return t.get=(a,n)=>(r?.revoke?.(),n===ZS?e:(e.push(n),r=Proxy.revocable(a,t),r.proxy)),Proxy.revocable(Object.create(null),t).proxy}function rw(e,t){const{[ZS]:r}=e(hL());return r.join(t?.keySeparator??".")}const gB={},Db=e=>!Mr(e)&&typeof e!="boolean"&&typeof e!="number";class ax extends Kx{constructor(t,r={}){super(),rL(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],t,this),this.options=r,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=ZA.create("translator")}changeLanguage(t){t&&(this.language=t)}exists(t,r={interpolation:{}}){const a={...r};if(t==null)return!1;const n=this.resolve(t,a);if(n?.res===void 0)return!1;const s=Db(n.res);return!(a.returnObjects===!1&&s)}extractFromKey(t,r){let a=r.nsSeparator!==void 0?r.nsSeparator:this.options.nsSeparator;a===void 0&&(a=":");const n=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator;let s=r.ns||this.options.defaultNS||[];const l=a&&t.indexOf(a)>-1,A=!this.options.userDefinedKeySeparator&&!r.keySeparator&&!this.options.userDefinedNsSeparator&&!r.nsSeparator&&!uL(t,a,n);if(l&&!A){const u=t.match(this.interpolator.nestingRegexp);if(u&&u.length>0)return{key:t,namespaces:Mr(s)?[s]:s};const f=t.split(a);(a!==n||a===n&&this.options.ns.indexOf(f[0])>-1)&&(s=f.shift()),t=f.join(n)}return{key:t,namespaces:Mr(s)?[s]:s}}translate(t,r,a){let n=typeof r=="object"?{...r}:r;if(typeof n!="object"&&this.options.overloadTranslationOptionHandler&&(n=this.options.overloadTranslationOptionHandler(arguments)),typeof n=="object"&&(n={...n}),n||(n={}),t==null)return"";typeof t=="function"&&(t=rw(t,{...this.options,...n})),Array.isArray(t)||(t=[String(t)]);const s=n.returnDetails!==void 0?n.returnDetails:this.options.returnDetails,l=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator,{key:A,namespaces:u}=this.extractFromKey(t[t.length-1],n),f=u[u.length-1];let h=n.nsSeparator!==void 0?n.nsSeparator:this.options.nsSeparator;h===void 0&&(h=":");const g=n.lng||this.language,x=n.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(g?.toLowerCase()==="cimode")return x?s?{res:`${f}${h}${A}`,usedKey:A,exactUsedKey:A,usedLng:g,usedNS:f,usedParams:this.getUsedParamsDetails(n)}:`${f}${h}${A}`:s?{res:A,usedKey:A,exactUsedKey:A,usedLng:g,usedNS:f,usedParams:this.getUsedParamsDetails(n)}:A;const m=this.resolve(t,n);let w=m?.res;const v=m?.usedKey||A,B=m?.exactUsedKey||A,k=["[object Number]","[object Function]","[object RegExp]"],N=n.joinArrays!==void 0?n.joinArrays:this.options.joinArrays,S=!this.i18nFormat||this.i18nFormat.handleAsObject,O=n.count!==void 0&&!Mr(n.count),T=ax.hasDefaultValue(n),U=O?this.pluralResolver.getSuffix(g,n.count,n):"",D=n.ordinal&&O?this.pluralResolver.getSuffix(g,n.count,{ordinal:!1}):"",H=O&&!n.ordinal&&n.count===0,j=H&&n[`defaultValue${this.options.pluralSeparator}zero`]||n[`defaultValue${U}`]||n[`defaultValue${D}`]||n.defaultValue;let W=w;S&&!w&&T&&(W=j);const I=Db(W),Q=Object.prototype.toString.apply(W);if(S&&W&&I&&k.indexOf(Q)<0&&!(Mr(N)&&Array.isArray(W))){if(!n.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const Y=this.options.returnedObjectHandler?this.options.returnedObjectHandler(v,W,{...n,ns:u}):`key '${A} (${this.language})' returned an object instead of string.`;return s?(m.res=Y,m.usedParams=this.getUsedParamsDetails(n),m):Y}if(l){const Y=Array.isArray(W),z=Y?[]:{},ue=Y?B:v;for(const Z in W)if(Object.prototype.hasOwnProperty.call(W,Z)){const Ae=`${ue}${l}${Z}`;T&&!w?z[Z]=this.translate(Ae,{...n,defaultValue:Db(j)?j[Z]:void 0,joinArrays:!1,ns:u}):z[Z]=this.translate(Ae,{...n,joinArrays:!1,ns:u}),z[Z]===Ae&&(z[Z]=W[Z])}w=z}}else if(S&&Mr(N)&&Array.isArray(w))w=w.join(N),w&&(w=this.extendTranslation(w,t,n,a));else{let Y=!1,z=!1;!this.isValidLookup(w)&&T&&(Y=!0,w=j),this.isValidLookup(w)||(z=!0,w=A);const Z=(n.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&z?void 0:w,Ae=T&&j!==w&&this.options.updateMissing;if(z||Y||Ae){if(this.logger.log(Ae?"updateKey":"missingKey",g,f,A,Ae?j:w),l){const we=this.resolve(A,{...n,keySeparator:!1});we&&we.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let ve=[];const G=this.languageUtils.getFallbackCodes(this.options.fallbackLng,n.lng||this.language);if(this.options.saveMissingTo==="fallback"&&G&&G[0])for(let we=0;we<G.length;we++)ve.push(G[we]);else this.options.saveMissingTo==="all"?ve=this.languageUtils.toResolveHierarchy(n.lng||this.language):ve.push(n.lng||this.language);const Se=(we,F,R)=>{const M=T&&R!==w?R:Z;this.options.missingKeyHandler?this.options.missingKeyHandler(we,f,F,M,Ae,n):this.backendConnector?.saveMissing&&this.backendConnector.saveMissing(we,f,F,M,Ae,n),this.emit("missingKey",we,f,F,w)};this.options.saveMissing&&(this.options.saveMissingPlurals&&O?ve.forEach(we=>{const F=this.pluralResolver.getSuffixes(we,n);H&&n[`defaultValue${this.options.pluralSeparator}zero`]&&F.indexOf(`${this.options.pluralSeparator}zero`)<0&&F.push(`${this.options.pluralSeparator}zero`),F.forEach(R=>{Se([we],A+R,n[`defaultValue${R}`]||j)})}):Se(ve,A,j))}w=this.extendTranslation(w,t,n,m,a),z&&w===A&&this.options.appendNamespaceToMissingKey&&(w=`${f}${h}${A}`),(z||Y)&&this.options.parseMissingKeyHandler&&(w=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${f}${h}${A}`:A,Y?w:void 0,n))}return s?(m.res=w,m.usedParams=this.getUsedParamsDetails(n),m):w}extendTranslation(t,r,a,n,s){if(this.i18nFormat?.parse)t=this.i18nFormat.parse(t,{...this.options.interpolation.defaultVariables,...a},a.lng||this.language||n.usedLng,n.usedNS,n.usedKey,{resolved:n});else if(!a.skipInterpolation){a.interpolation&&this.interpolator.init({...a,interpolation:{...this.options.interpolation,...a.interpolation}});const u=Mr(t)&&(a?.interpolation?.skipOnVariables!==void 0?a.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let f;if(u){const g=t.match(this.interpolator.nestingRegexp);f=g&&g.length}let h=a.replace&&!Mr(a.replace)?a.replace:a;if(this.options.interpolation.defaultVariables&&(h={...this.options.interpolation.defaultVariables,...h}),t=this.interpolator.interpolate(t,h,a.lng||this.language||n.usedLng,a),u){const g=t.match(this.interpolator.nestingRegexp),x=g&&g.length;f<x&&(a.nest=!1)}!a.lng&&n&&n.res&&(a.lng=this.language||n.usedLng),a.nest!==!1&&(t=this.interpolator.nest(t,(...g)=>s?.[0]===g[0]&&!a.context?(this.logger.warn(`It seems you are nesting recursively key: ${g[0]} in key: ${r[0]}`),null):this.translate(...g,r),a)),a.interpolation&&this.interpolator.reset()}const l=a.postProcess||this.options.postProcess,A=Mr(l)?[l]:l;return t!=null&&A?.length&&a.applyPostProcessor!==!1&&(t=JS.handle(A,t,r,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...n,usedParams:this.getUsedParamsDetails(a)},...a}:a,this)),t}resolve(t,r={}){let a,n,s,l,A;return Mr(t)&&(t=[t]),t.forEach(u=>{if(this.isValidLookup(a))return;const f=this.extractFromKey(u,r),h=f.key;n=h;let g=f.namespaces;this.options.fallbackNS&&(g=g.concat(this.options.fallbackNS));const x=r.count!==void 0&&!Mr(r.count),m=x&&!r.ordinal&&r.count===0,w=r.context!==void 0&&(Mr(r.context)||typeof r.context=="number")&&r.context!=="",v=r.lngs?r.lngs:this.languageUtils.toResolveHierarchy(r.lng||this.language,r.fallbackLng);g.forEach(B=>{this.isValidLookup(a)||(A=B,!gB[`${v[0]}-${B}`]&&this.utils?.hasLoadedNamespace&&!this.utils?.hasLoadedNamespace(A)&&(gB[`${v[0]}-${B}`]=!0,this.logger.warn(`key "${n}" for languages "${v.join(", ")}" won't get resolved as namespace "${A}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),v.forEach(k=>{if(this.isValidLookup(a))return;l=k;const N=[h];if(this.i18nFormat?.addLookupKeys)this.i18nFormat.addLookupKeys(N,h,k,B,r);else{let O;x&&(O=this.pluralResolver.getSuffix(k,r.count,r));const T=`${this.options.pluralSeparator}zero`,U=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(x&&(r.ordinal&&O.indexOf(U)===0&&N.push(h+O.replace(U,this.options.pluralSeparator)),N.push(h+O),m&&N.push(h+T)),w){const D=`${h}${this.options.contextSeparator||"_"}${r.context}`;N.push(D),x&&(r.ordinal&&O.indexOf(U)===0&&N.push(D+O.replace(U,this.options.pluralSeparator)),N.push(D+O),m&&N.push(D+T))}}let S;for(;S=N.pop();)this.isValidLookup(a)||(s=S,a=this.getResource(k,B,S,r))}))})}),{res:a,usedKey:n,exactUsedKey:s,usedLng:l,usedNS:A}}isValidLookup(t){return t!==void 0&&!(!this.options.returnNull&&t===null)&&!(!this.options.returnEmptyString&&t==="")}getResource(t,r,a,n={}){return this.i18nFormat?.getResource?this.i18nFormat.getResource(t,r,a,n):this.resourceStore.getResource(t,r,a,n)}getUsedParamsDetails(t={}){const r=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],a=t.replace&&!Mr(t.replace);let n=a?t.replace:t;if(a&&typeof t.count<"u"&&(n.count=t.count),this.options.interpolation.defaultVariables&&(n={...this.options.interpolation.defaultVariables,...n}),!a){n={...n};for(const s of r)delete n[s]}return n}static hasDefaultValue(t){const r="defaultValue";for(const a in t)if(Object.prototype.hasOwnProperty.call(t,a)&&r===a.substring(0,r.length)&&t[a]!==void 0)return!0;return!1}}class mB{constructor(t){this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=ZA.create("languageUtils")}getScriptPartFromCode(t){if(t=up(t),!t||t.indexOf("-")<0)return null;const r=t.split("-");return r.length===2||(r.pop(),r[r.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(r.join("-"))}getLanguagePartFromCode(t){if(t=up(t),!t||t.indexOf("-")<0)return t;const r=t.split("-");return this.formatLanguageCode(r[0])}formatLanguageCode(t){if(Mr(t)&&t.indexOf("-")>-1){let r;try{r=Intl.getCanonicalLocales(t)[0]}catch{}return r&&this.options.lowerCaseLng&&(r=r.toLowerCase()),r||(this.options.lowerCaseLng?t.toLowerCase():t)}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}isSupportedCode(t){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}getBestMatchFromCodes(t){if(!t)return null;let r;return t.forEach(a=>{if(r)return;const n=this.formatLanguageCode(a);(!this.options.supportedLngs||this.isSupportedCode(n))&&(r=n)}),!r&&this.options.supportedLngs&&t.forEach(a=>{if(r)return;const n=this.getScriptPartFromCode(a);if(this.isSupportedCode(n))return r=n;const s=this.getLanguagePartFromCode(a);if(this.isSupportedCode(s))return r=s;r=this.options.supportedLngs.find(l=>{if(l===s)return l;if(!(l.indexOf("-")<0&&s.indexOf("-")<0)&&(l.indexOf("-")>0&&s.indexOf("-")<0&&l.substring(0,l.indexOf("-"))===s||l.indexOf(s)===0&&s.length>1))return l})}),r||(r=this.getFallbackCodes(this.options.fallbackLng)[0]),r}getFallbackCodes(t,r){if(!t)return[];if(typeof t=="function"&&(t=t(r)),Mr(t)&&(t=[t]),Array.isArray(t))return t;if(!r)return t.default||[];let a=t[r];return a||(a=t[this.getScriptPartFromCode(r)]),a||(a=t[this.formatLanguageCode(r)]),a||(a=t[this.getLanguagePartFromCode(r)]),a||(a=t.default),a||[]}toResolveHierarchy(t,r){const a=this.getFallbackCodes((r===!1?[]:r)||this.options.fallbackLng||[],t),n=[],s=l=>{l&&(this.isSupportedCode(l)?n.push(l):this.logger.warn(`rejecting language code not found in supportedLngs: ${l}`))};return Mr(t)&&(t.indexOf("-")>-1||t.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&s(this.formatLanguageCode(t)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&s(this.getScriptPartFromCode(t)),this.options.load!=="currentOnly"&&s(this.getLanguagePartFromCode(t))):Mr(t)&&s(this.formatLanguageCode(t)),a.forEach(l=>{n.indexOf(l)<0&&s(this.formatLanguageCode(l))}),n}}const xB={zero:0,one:1,two:2,few:3,many:4,other:5},bB={select:e=>e===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class pL{constructor(t,r={}){this.languageUtils=t,this.options=r,this.logger=ZA.create("pluralResolver"),this.pluralRulesCache={}}clearCache(){this.pluralRulesCache={}}getRule(t,r={}){const a=up(t==="dev"?"en":t),n=r.ordinal?"ordinal":"cardinal",s=JSON.stringify({cleanedCode:a,type:n});if(s in this.pluralRulesCache)return this.pluralRulesCache[s];let l;try{l=new Intl.PluralRules(a,{type:n})}catch{if(typeof Intl>"u")return this.logger.error("No Intl support, please use an Intl polyfill!"),bB;if(!t.match(/-|_/))return bB;const u=this.languageUtils.getLanguagePartFromCode(t);l=this.getRule(u,r)}return this.pluralRulesCache[s]=l,l}needsPlural(t,r={}){let a=this.getRule(t,r);return a||(a=this.getRule("dev",r)),a?.resolvedOptions().pluralCategories.length>1}getPluralFormsOfKey(t,r,a={}){return this.getSuffixes(t,a).map(n=>`${r}${n}`)}getSuffixes(t,r={}){let a=this.getRule(t,r);return a||(a=this.getRule("dev",r)),a?a.resolvedOptions().pluralCategories.sort((n,s)=>xB[n]-xB[s]).map(n=>`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${n}`):[]}getSuffix(t,r,a={}){const n=this.getRule(t,a);return n?`${this.options.prepend}${a.ordinal?`ordinal${this.options.prepend}`:""}${n.select(r)}`:(this.logger.warn(`no plural rule found for: ${t}`),this.getSuffix("dev",r,a))}}const vB=(e,t,r,a=".",n=!0)=>{let s=sL(e,t,r);return!s&&n&&Mr(r)&&(s=ew(e,r,a),s===void 0&&(s=ew(t,r,a))),s},Ib=e=>e.replace(/\$/g,"$$$$");class wB{constructor(t={}){this.logger=ZA.create("interpolator"),this.options=t,this.format=t?.interpolation?.format||(r=>r),this.init(t)}init(t={}){t.interpolation||(t.interpolation={escapeValue:!0});const{escape:r,escapeValue:a,useRawValueToEscape:n,prefix:s,prefixEscaped:l,suffix:A,suffixEscaped:u,formatSeparator:f,unescapeSuffix:h,unescapePrefix:g,nestingPrefix:x,nestingPrefixEscaped:m,nestingSuffix:w,nestingSuffixEscaped:v,nestingOptionsSeparator:B,maxReplaces:k,alwaysFormat:N}=t.interpolation;this.escape=r!==void 0?r:lL,this.escapeValue=a!==void 0?a:!0,this.useRawValueToEscape=n!==void 0?n:!1,this.prefix=s?m0(s):l||"{{",this.suffix=A?m0(A):u||"}}",this.formatSeparator=f||",",this.unescapePrefix=h?"":g||"-",this.unescapeSuffix=this.unescapePrefix?"":h||"",this.nestingPrefix=x?m0(x):m||m0("$t("),this.nestingSuffix=w?m0(w):v||m0(")"),this.nestingOptionsSeparator=B||",",this.maxReplaces=k||1e3,this.alwaysFormat=N!==void 0?N:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const t=(r,a)=>r?.source===a?(r.lastIndex=0,r):new RegExp(a,"g");this.regexp=t(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=t(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=t(this.nestingRegexp,`${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`)}interpolate(t,r,a,n){let s,l,A;const u=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},f=m=>{if(m.indexOf(this.formatSeparator)<0){const k=vB(r,u,m,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(k,void 0,a,{...n,...r,interpolationkey:m}):k}const w=m.split(this.formatSeparator),v=w.shift().trim(),B=w.join(this.formatSeparator).trim();return this.format(vB(r,u,v,this.options.keySeparator,this.options.ignoreJSONStructure),B,a,{...n,...r,interpolationkey:v})};this.resetRegExp();const h=n?.missingInterpolationHandler||this.options.missingInterpolationHandler,g=n?.interpolation?.skipOnVariables!==void 0?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:m=>Ib(m)},{regex:this.regexp,safeValue:m=>this.escapeValue?Ib(this.escape(m)):Ib(m)}].forEach(m=>{for(A=0;s=m.regex.exec(t);){const w=s[1].trim();if(l=f(w),l===void 0)if(typeof h=="function"){const B=h(t,s,n);l=Mr(B)?B:""}else if(n&&Object.prototype.hasOwnProperty.call(n,w))l="";else if(g){l=s[0];continue}else this.logger.warn(`missed to pass in variable ${w} for interpolating ${t}`),l="";else!Mr(l)&&!this.useRawValueToEscape&&(l=uB(l));const v=m.safeValue(l);if(t=t.replace(s[0],v),g?(m.regex.lastIndex+=l.length,m.regex.lastIndex-=s[0].length):m.regex.lastIndex=0,A++,A>=this.maxReplaces)break}}),t}nest(t,r,a={}){let n,s,l;const A=(u,f)=>{const h=this.nestingOptionsSeparator;if(u.indexOf(h)<0)return u;const g=u.split(new RegExp(`${m0(h)}[ ]*{`));let x=`{${g[1]}`;u=g[0],x=this.interpolate(x,l);const m=x.match(/'/g),w=x.match(/"/g);((m?.length??0)%2===0&&!w||(w?.length??0)%2!==0)&&(x=x.replace(/'/g,'"'));try{l=JSON.parse(x),f&&(l={...f,...l})}catch(v){return this.logger.warn(`failed parsing options string in nesting for key ${u}`,v),`${u}${h}${x}`}return l.defaultValue&&l.defaultValue.indexOf(this.prefix)>-1&&delete l.defaultValue,u};for(;n=this.nestingRegexp.exec(t);){let u=[];l={...a},l=l.replace&&!Mr(l.replace)?l.replace:l,l.applyPostProcessor=!1,delete l.defaultValue;const f=/{.*}/.test(n[1])?n[1].lastIndexOf("}")+1:n[1].indexOf(this.formatSeparator);if(f!==-1&&(u=n[1].slice(f).split(this.formatSeparator).map(h=>h.trim()).filter(Boolean),n[1]=n[1].slice(0,f)),s=r(A.call(this,n[1].trim(),l),l),s&&n[0]===t&&!Mr(s))return s;Mr(s)||(s=uB(s)),s||(this.logger.warn(`missed to resolve ${n[1]} for nesting ${t}`),s=""),u.length&&(s=u.reduce((h,g)=>this.format(h,g,a.lng,{...a,interpolationkey:n[1].trim()}),s.trim())),t=t.replace(n[0],s),this.regexp.lastIndex=0}return t}}const gL=e=>{let t=e.toLowerCase().trim();const r={};if(e.indexOf("(")>-1){const a=e.split("(");t=a[0].toLowerCase().trim();const n=a[1].substring(0,a[1].length-1);t==="currency"&&n.indexOf(":")<0?r.currency||(r.currency=n.trim()):t==="relativetime"&&n.indexOf(":")<0?r.range||(r.range=n.trim()):n.split(";").forEach(l=>{if(l){const[A,...u]=l.split(":"),f=u.join(":").trim().replace(/^'+|'+$/g,""),h=A.trim();r[h]||(r[h]=f),f==="false"&&(r[h]=!1),f==="true"&&(r[h]=!0),isNaN(f)||(r[h]=parseInt(f,10))}})}return{formatName:t,formatOptions:r}},yB=e=>{const t={};return(r,a,n)=>{let s=n;n&&n.interpolationkey&&n.formatParams&&n.formatParams[n.interpolationkey]&&n[n.interpolationkey]&&(s={...s,[n.interpolationkey]:void 0});const l=a+JSON.stringify(s);let A=t[l];return A||(A=e(up(a),n),t[l]=A),A(r)}},mL=e=>(t,r,a)=>e(up(r),a)(t);class xL{constructor(t={}){this.logger=ZA.create("formatter"),this.options=t,this.init(t)}init(t,r={interpolation:{}}){this.formatSeparator=r.interpolation.formatSeparator||",";const a=r.cacheInBuiltFormats?yB:mL;this.formats={number:a((n,s)=>{const l=new Intl.NumberFormat(n,{...s});return A=>l.format(A)}),currency:a((n,s)=>{const l=new Intl.NumberFormat(n,{...s,style:"currency"});return A=>l.format(A)}),datetime:a((n,s)=>{const l=new Intl.DateTimeFormat(n,{...s});return A=>l.format(A)}),relativetime:a((n,s)=>{const l=new Intl.RelativeTimeFormat(n,{...s});return A=>l.format(A,s.range||"day")}),list:a((n,s)=>{const l=new Intl.ListFormat(n,{...s});return A=>l.format(A)})}}add(t,r){this.formats[t.toLowerCase().trim()]=r}addCached(t,r){this.formats[t.toLowerCase().trim()]=yB(r)}format(t,r,a,n={}){const s=r.split(this.formatSeparator);if(s.length>1&&s[0].indexOf("(")>1&&s[0].indexOf(")")<0&&s.find(A=>A.indexOf(")")>-1)){const A=s.findIndex(u=>u.indexOf(")")>-1);s[0]=[s[0],...s.splice(1,A)].join(this.formatSeparator)}return s.reduce((A,u)=>{const{formatName:f,formatOptions:h}=gL(u);if(this.formats[f]){let g=A;try{const x=n?.formatParams?.[n.interpolationkey]||{},m=x.locale||x.lng||n.locale||n.lng||a;g=this.formats[f](A,m,{...h,...n,...x})}catch(x){this.logger.warn(x)}return g}else this.logger.warn(`there was no format function for ${f}`);return A},t)}}const bL=(e,t)=>{e.pending[t]!==void 0&&(delete e.pending[t],e.pendingCount--)};class vL extends Kx{constructor(t,r,a,n={}){super(),this.backend=t,this.store=r,this.services=a,this.languageUtils=a.languageUtils,this.options=n,this.logger=ZA.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=n.maxParallelReads||10,this.readingCalls=0,this.maxRetries=n.maxRetries>=0?n.maxRetries:5,this.retryTimeout=n.retryTimeout>=1?n.retryTimeout:350,this.state={},this.queue=[],this.backend?.init?.(a,n.backend,n)}queueLoad(t,r,a,n){const s={},l={},A={},u={};return t.forEach(f=>{let h=!0;r.forEach(g=>{const x=`${f}|${g}`;!a.reload&&this.store.hasResourceBundle(f,g)?this.state[x]=2:this.state[x]<0||(this.state[x]===1?l[x]===void 0&&(l[x]=!0):(this.state[x]=1,h=!1,l[x]===void 0&&(l[x]=!0),s[x]===void 0&&(s[x]=!0),u[g]===void 0&&(u[g]=!0)))}),h||(A[f]=!0)}),(Object.keys(s).length||Object.keys(l).length)&&this.queue.push({pending:l,pendingCount:Object.keys(l).length,loaded:{},errors:[],callback:n}),{toLoad:Object.keys(s),pending:Object.keys(l),toLoadLanguages:Object.keys(A),toLoadNamespaces:Object.keys(u)}}loaded(t,r,a){const n=t.split("|"),s=n[0],l=n[1];r&&this.emit("failedLoading",s,l,r),!r&&a&&this.store.addResourceBundle(s,l,a,void 0,void 0,{skipCopy:!0}),this.state[t]=r?-1:2,r&&a&&(this.state[t]=0);const A={};this.queue.forEach(u=>{nL(u.loaded,[s],l),bL(u,t),r&&u.errors.push(r),u.pendingCount===0&&!u.done&&(Object.keys(u.loaded).forEach(f=>{A[f]||(A[f]={});const h=u.loaded[f];h.length&&h.forEach(g=>{A[f][g]===void 0&&(A[f][g]=!0)})}),u.done=!0,u.errors.length?u.callback(u.errors):u.callback())}),this.emit("loaded",A),this.queue=this.queue.filter(u=>!u.done)}read(t,r,a,n=0,s=this.retryTimeout,l){if(!t.length)return l(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:t,ns:r,fcName:a,tried:n,wait:s,callback:l});return}this.readingCalls++;const A=(f,h)=>{if(this.readingCalls--,this.waitingReads.length>0){const g=this.waitingReads.shift();this.read(g.lng,g.ns,g.fcName,g.tried,g.wait,g.callback)}if(f&&h&&n<this.maxRetries){setTimeout(()=>{this.read.call(this,t,r,a,n+1,s*2,l)},s);return}l(f,h)},u=this.backend[a].bind(this.backend);if(u.length===2){try{const f=u(t,r);f&&typeof f.then=="function"?f.then(h=>A(null,h)).catch(A):A(null,f)}catch(f){A(f)}return}return u(t,r,A)}prepareLoading(t,r,a={},n){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),n&&n();Mr(t)&&(t=this.languageUtils.toResolveHierarchy(t)),Mr(r)&&(r=[r]);const s=this.queueLoad(t,r,a,n);if(!s.toLoad.length)return s.pending.length||n(),null;s.toLoad.forEach(l=>{this.loadOne(l)})}load(t,r,a){this.prepareLoading(t,r,{},a)}reload(t,r,a){this.prepareLoading(t,r,{reload:!0},a)}loadOne(t,r=""){const a=t.split("|"),n=a[0],s=a[1];this.read(n,s,"read",void 0,void 0,(l,A)=>{l&&this.logger.warn(`${r}loading namespace ${s} for language ${n} failed`,l),!l&&A&&this.logger.log(`${r}loaded namespace ${s} for language ${n}`,A),this.loaded(t,l,A)})}saveMissing(t,r,a,n,s,l={},A=()=>{}){if(this.services?.utils?.hasLoadedNamespace&&!this.services?.utils?.hasLoadedNamespace(r)){this.logger.warn(`did not save key "${a}" as the namespace "${r}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(a==null||a==="")){if(this.backend?.create){const u={...l,isUpdate:s},f=this.backend.create.bind(this.backend);if(f.length<6)try{let h;f.length===5?h=f(t,r,a,n,u):h=f(t,r,a,n),h&&typeof h.then=="function"?h.then(g=>A(null,g)).catch(A):A(null,h)}catch(h){A(h)}else f(t,r,a,n,A,u)}!t||!t[0]||this.store.addResource(t[0],r,a,n)}}}const Qb=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:e=>{let t={};if(typeof e[1]=="object"&&(t=e[1]),Mr(e[1])&&(t.defaultValue=e[1]),Mr(e[2])&&(t.tDescription=e[2]),typeof e[2]=="object"||typeof e[3]=="object"){const r=e[3]||e[2];Object.keys(r).forEach(a=>{t[a]=r[a]})}return t},interpolation:{escapeValue:!0,format:e=>e,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),_B=e=>(Mr(e.ns)&&(e.ns=[e.ns]),Mr(e.fallbackLng)&&(e.fallbackLng=[e.fallbackLng]),Mr(e.fallbackNS)&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs?.indexOf?.("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),typeof e.initImmediate=="boolean"&&(e.initAsync=e.initImmediate),e),qg=()=>{},wL=e=>{Object.getOwnPropertyNames(Object.getPrototypeOf(e)).forEach(r=>{typeof e[r]=="function"&&(e[r]=e[r].bind(e))})};let BB=!1;const yL=e=>!!(e?.modules?.backend?.name?.indexOf("Locize")>0||e?.modules?.backend?.constructor?.name?.indexOf("Locize")>0||e?.options?.backend?.backends&&e.options.backend.backends.some(t=>t?.name?.indexOf("Locize")>0||t?.constructor?.name?.indexOf("Locize")>0));class Kh extends Kx{constructor(t={},r){if(super(),this.options=_B(t),this.services={},this.logger=ZA,this.modules={external:[]},wL(this),r&&!this.isInitialized&&!t.isClone){if(!this.options.initAsync)return this.init(t,r),this;setTimeout(()=>{this.init(t,r)},0)}}init(t={},r){this.isInitializing=!0,typeof t=="function"&&(r=t,t={}),t.defaultNS==null&&t.ns&&(Mr(t.ns)?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));const a=Qb();this.options={...a,...this.options,..._B(t)},this.options.interpolation={...a.interpolation,...this.options.interpolation},t.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=t.keySeparator),t.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=t.nsSeparator),typeof this.options.overloadTranslationOptionHandler!="function"&&(this.options.overloadTranslationOptionHandler=a.overloadTranslationOptionHandler),this.options.showSupportNotice!==!1&&!yL(this)&&!BB&&(typeof console<"u"&&typeof console.info<"u"&&console.info(" i18next is maintained with support from Locize  consider powering your project with managed localization (AI, CDN, integrations): https://locize.com "),BB=!0);const n=f=>f?typeof f=="function"?new f:f:null;if(!this.options.isClone){this.modules.logger?ZA.init(n(this.modules.logger),this.options):ZA.init(null,this.options);let f;this.modules.formatter?f=this.modules.formatter:f=xL;const h=new mB(this.options);this.store=new pB(this.options.resources,this.options);const g=this.services;g.logger=ZA,g.resourceStore=this.store,g.languageUtils=h,g.pluralResolver=new pL(h,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==a.interpolation.format&&this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),f&&(!this.options.interpolation.format||this.options.interpolation.format===a.interpolation.format)&&(g.formatter=n(f),g.formatter.init&&g.formatter.init(g,this.options),this.options.interpolation.format=g.formatter.format.bind(g.formatter)),g.interpolator=new wB(this.options),g.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},g.backendConnector=new vL(n(this.modules.backend),g.resourceStore,g,this.options),g.backendConnector.on("*",(m,...w)=>{this.emit(m,...w)}),this.modules.languageDetector&&(g.languageDetector=n(this.modules.languageDetector),g.languageDetector.init&&g.languageDetector.init(g,this.options.detection,this.options)),this.modules.i18nFormat&&(g.i18nFormat=n(this.modules.i18nFormat),g.i18nFormat.init&&g.i18nFormat.init(this)),this.translator=new ax(this.services,this.options),this.translator.on("*",(m,...w)=>{this.emit(m,...w)}),this.modules.external.forEach(m=>{m.init&&m.init(this)})}if(this.format=this.options.interpolation.format,r||(r=qg),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const f=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);f.length>0&&f[0]!=="dev"&&(this.options.lng=f[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(f=>{this[f]=(...h)=>this.store[f](...h)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(f=>{this[f]=(...h)=>(this.store[f](...h),this)});const A=xh(),u=()=>{const f=(h,g)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),A.resolve(g),r(h,g)};if(this.languages&&!this.isInitialized)return f(null,this.t.bind(this));this.changeLanguage(this.options.lng,f)};return this.options.resources||!this.options.initAsync?u():setTimeout(u,0),A}loadResources(t,r=qg){let a=r;const n=Mr(t)?t:this.language;if(typeof t=="function"&&(a=t),!this.options.resources||this.options.partialBundledLanguages){if(n?.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return a();const s=[],l=A=>{if(!A||A==="cimode")return;this.services.languageUtils.toResolveHierarchy(A).forEach(f=>{f!=="cimode"&&s.indexOf(f)<0&&s.push(f)})};n?l(n):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(u=>l(u)),this.options.preload?.forEach?.(A=>l(A)),this.services.backendConnector.load(s,this.options.ns,A=>{!A&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),a(A)})}else a(null)}reloadResources(t,r,a){const n=xh();return typeof t=="function"&&(a=t,t=void 0),typeof r=="function"&&(a=r,r=void 0),t||(t=this.languages),r||(r=this.options.ns),a||(a=qg),this.services.backendConnector.reload(t,r,s=>{n.resolve(),a(s)}),n}use(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return t.type==="backend"&&(this.modules.backend=t),(t.type==="logger"||t.log&&t.warn&&t.error)&&(this.modules.logger=t),t.type==="languageDetector"&&(this.modules.languageDetector=t),t.type==="i18nFormat"&&(this.modules.i18nFormat=t),t.type==="postProcessor"&&JS.addPostProcessor(t),t.type==="formatter"&&(this.modules.formatter=t),t.type==="3rdParty"&&this.modules.external.push(t),this}setResolvedLanguage(t){if(!(!t||!this.languages)&&!(["cimode","dev"].indexOf(t)>-1)){for(let r=0;r<this.languages.length;r++){const a=this.languages[r];if(!(["cimode","dev"].indexOf(a)>-1)&&this.store.hasLanguageSomeTranslations(a)){this.resolvedLanguage=a;break}}!this.resolvedLanguage&&this.languages.indexOf(t)<0&&this.store.hasLanguageSomeTranslations(t)&&(this.resolvedLanguage=t,this.languages.unshift(t))}}changeLanguage(t,r){this.isLanguageChangingTo=t;const a=xh();this.emit("languageChanging",t);const n=A=>{this.language=A,this.languages=this.services.languageUtils.toResolveHierarchy(A),this.resolvedLanguage=void 0,this.setResolvedLanguage(A)},s=(A,u)=>{u?this.isLanguageChangingTo===t&&(n(u),this.translator.changeLanguage(u),this.isLanguageChangingTo=void 0,this.emit("languageChanged",u),this.logger.log("languageChanged",u)):this.isLanguageChangingTo=void 0,a.resolve((...f)=>this.t(...f)),r&&r(A,(...f)=>this.t(...f))},l=A=>{!t&&!A&&this.services.languageDetector&&(A=[]);const u=Mr(A)?A:A&&A[0],f=this.store.hasLanguageSomeTranslations(u)?u:this.services.languageUtils.getBestMatchFromCodes(Mr(A)?[A]:A);f&&(this.language||n(f),this.translator.language||this.translator.changeLanguage(f),this.services.languageDetector?.cacheUserLanguage?.(f)),this.loadResources(f,h=>{s(h,f)})};return!t&&this.services.languageDetector&&!this.services.languageDetector.async?l(this.services.languageDetector.detect()):!t&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(l):this.services.languageDetector.detect(l):l(t),a}getFixedT(t,r,a){const n=(s,l,...A)=>{let u;typeof l!="object"?u=this.options.overloadTranslationOptionHandler([s,l].concat(A)):u={...l},u.lng=u.lng||n.lng,u.lngs=u.lngs||n.lngs,u.ns=u.ns||n.ns,u.keyPrefix!==""&&(u.keyPrefix=u.keyPrefix||a||n.keyPrefix);const f=this.options.keySeparator||".";let h;return u.keyPrefix&&Array.isArray(s)?h=s.map(g=>(typeof g=="function"&&(g=rw(g,{...this.options,...l})),`${u.keyPrefix}${f}${g}`)):(typeof s=="function"&&(s=rw(s,{...this.options,...l})),h=u.keyPrefix?`${u.keyPrefix}${f}${s}`:s),this.t(h,u)};return Mr(t)?n.lng=t:n.lngs=t,n.ns=r,n.keyPrefix=a,n}t(...t){return this.translator?.translate(...t)}exists(...t){return this.translator?.exists(...t)}setDefaultNamespace(t){this.options.defaultNS=t}hasLoadedNamespace(t,r={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const a=r.lng||this.resolvedLanguage||this.languages[0],n=this.options?this.options.fallbackLng:!1,s=this.languages[this.languages.length-1];if(a.toLowerCase()==="cimode")return!0;const l=(A,u)=>{const f=this.services.backendConnector.state[`${A}|${u}`];return f===-1||f===0||f===2};if(r.precheck){const A=r.precheck(this,l);if(A!==void 0)return A}return!!(this.hasResourceBundle(a,t)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||l(a,t)&&(!n||l(s,t)))}loadNamespaces(t,r){const a=xh();return this.options.ns?(Mr(t)&&(t=[t]),t.forEach(n=>{this.options.ns.indexOf(n)<0&&this.options.ns.push(n)}),this.loadResources(n=>{a.resolve(),r&&r(n)}),a):(r&&r(),Promise.resolve())}loadLanguages(t,r){const a=xh();Mr(t)&&(t=[t]);const n=this.options.preload||[],s=t.filter(l=>n.indexOf(l)<0&&this.services.languageUtils.isSupportedCode(l));return s.length?(this.options.preload=n.concat(s),this.loadResources(l=>{a.resolve(),r&&r(l)}),a):(r&&r(),Promise.resolve())}dir(t){if(t||(t=this.resolvedLanguage||(this.languages?.length>0?this.languages[0]:this.language)),!t)return"rtl";try{const n=new Intl.Locale(t);if(n&&n.getTextInfo){const s=n.getTextInfo();if(s&&s.direction)return s.direction}}catch{}const r=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],a=this.services?.languageUtils||new mB(Qb());return t.toLowerCase().indexOf("-latn")>1?"ltr":r.indexOf(a.getLanguagePartFromCode(t))>-1||t.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(t={},r){const a=new Kh(t,r);return a.createInstance=Kh.createInstance,a}cloneInstance(t={},r=qg){const a=t.forkResourceStore;a&&delete t.forkResourceStore;const n={...this.options,...t,isClone:!0},s=new Kh(n);if((t.debug!==void 0||t.prefix!==void 0)&&(s.logger=s.logger.clone(t)),["store","services","language"].forEach(A=>{s[A]=this[A]}),s.services={...this.services},s.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},a){const A=Object.keys(this.store.data).reduce((u,f)=>(u[f]={...this.store.data[f]},u[f]=Object.keys(u[f]).reduce((h,g)=>(h[g]={...u[f][g]},h),u[f]),u),{});s.store=new pB(A,n),s.services.resourceStore=s.store}if(t.interpolation){const u={...Qb().interpolation,...this.options.interpolation,...t.interpolation},f={...n,interpolation:u};s.services.interpolator=new wB(f)}return s.translator=new ax(s.services,n),s.translator.on("*",(A,...u)=>{s.emit(A,...u)}),s.init(n,r),s.translator.options=n,s.translator.backendConnector.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},s}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const ll=Kh.createInstance();ll.createInstance;ll.dir;ll.init;ll.loadResources;ll.reloadResources;ll.use;ll.changeLanguage;ll.getFixedT;ll.t;ll.exists;ll.setDefaultNamespace;ll.hasLoadedNamespace;ll.loadNamespaces;ll.loadLanguages;const _L=(e,t,r,a)=>{const n=[r,{code:t,...a||{}}];if(e?.services?.logger?.forward)return e.services.logger.forward(n,"warn","react-i18next::",!0);I0(n[0])&&(n[0]=`react-i18next:: ${n[0]}`),e?.services?.logger?.warn?e.services.logger.warn(...n):console?.warn&&console.warn(...n)},kB={},e3=(e,t,r,a)=>{I0(r)&&kB[r]||(I0(r)&&(kB[r]=new Date),_L(e,t,r,a))},t3=(e,t)=>()=>{if(e.isInitialized)t();else{const r=()=>{setTimeout(()=>{e.off("initialized",r)},0),t()};e.on("initialized",r)}},aw=(e,t,r)=>{e.loadNamespaces(t,t3(e,r))},CB=(e,t,r,a)=>{if(I0(r)&&(r=[r]),e.options.preload&&e.options.preload.indexOf(t)>-1)return aw(e,r,a);r.forEach(n=>{e.options.ns.indexOf(n)<0&&e.options.ns.push(n)}),e.loadLanguages(t,t3(e,a))},BL=(e,t,r={})=>!t.languages||!t.languages.length?(e3(t,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:t.languages}),!0):t.hasLoadedNamespace(e,{lng:r.lng,precheck:(a,n)=>{if(r.bindI18n&&r.bindI18n.indexOf("languageChanging")>-1&&a.services.backendConnector.backend&&a.isLanguageChangingTo&&!n(a.isLanguageChangingTo,e))return!1}}),I0=e=>typeof e=="string",kL=e=>typeof e=="object"&&e!==null,CL=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,SL={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},EL=e=>SL[e],NL=e=>e.replace(CL,EL);let nw={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:NL,transDefaultProps:void 0};const FL=(e={})=>{nw={...nw,...e}},TL=()=>nw;let r3;const LL=e=>{r3=e},UL=()=>r3,jL={type:"3rdParty",init(e){FL(e.options.react),LL(e)}},DL=X.createContext();class IL{constructor(){this.usedNamespaces={}}addUsedNamespaces(t){t.forEach(r=>{this.usedNamespaces[r]||(this.usedNamespaces[r]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}var QL=W8();const OL=(e,t)=>I0(t)?t:kL(t)&&I0(t.defaultValue)?t.defaultValue:Array.isArray(e)?e[e.length-1]:e,RL={t:OL,ready:!1},ML=()=>()=>{},tn=(e,t={})=>{const{i18n:r}=t,{i18n:a,defaultNS:n}=X.useContext(DL)||{},s=r||a||UL();s&&!s.reportNamespaces&&(s.reportNamespaces=new IL),s||e3(s,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const l=X.useMemo(()=>({...TL(),...s?.options?.react,...t}),[s,t]),{useSuspense:A,keyPrefix:u}=l,f=n||s?.options?.defaultNS,h=I0(f)?[f]:f||["translation"],g=X.useMemo(()=>h,h);s?.reportNamespaces?.addUsedNamespaces?.(g);const x=X.useRef(0),m=X.useCallback(j=>{if(!s)return ML;const{bindI18n:W,bindI18nStore:I}=l,Q=()=>{x.current+=1,j()};return W&&s.on(W,Q),I&&s.store.on(I,Q),()=>{W&&W.split(" ").forEach(Y=>s.off(Y,Q)),I&&I.split(" ").forEach(Y=>s.store.off(Y,Q))}},[s,l]),w=X.useRef(),v=X.useCallback(()=>{if(!s)return RL;const j=!!(s.isInitialized||s.initializedStoreOnce)&&g.every(ue=>BL(ue,s,l)),W=t.lng||s.language,I=x.current,Q=w.current;if(Q&&Q.ready===j&&Q.lng===W&&Q.keyPrefix===u&&Q.revision===I)return Q;const z={t:s.getFixedT(W,l.nsMode==="fallback"?g:g[0],u),ready:j,lng:W,keyPrefix:u,revision:I};return w.current=z,z},[s,g,u,l,t.lng]),[B,k]=X.useState(0),{t:N,ready:S}=QL.useSyncExternalStore(m,v,v);X.useEffect(()=>{if(s&&!S&&!A){const j=()=>k(W=>W+1);t.lng?CB(s,t.lng,g,j):aw(s,g,j)}},[s,t.lng,g,S,A,B]);const O=s||{},T=X.useRef(null),U=X.useRef(),D=j=>{const W=Object.getOwnPropertyDescriptors(j);W.__original&&delete W.__original;const I=Object.create(Object.getPrototypeOf(j),W);if(!Object.prototype.hasOwnProperty.call(I,"__original"))try{Object.defineProperty(I,"__original",{value:j,writable:!1,enumerable:!1,configurable:!1})}catch{}return I},H=X.useMemo(()=>{const j=O,W=j?.language;let I=j;j&&(T.current&&T.current.__original===j?U.current!==W?(I=D(j),T.current=I,U.current=W):I=T.current:(I=D(j),T.current=I,U.current=W));const Q=[N,I,S];return Q.t=N,Q.i18n=I,Q.ready=S,Q},[N,O,S,O.resolvedLanguage,O.language,O.languages]);if(s&&A&&!S)throw new Promise(j=>{const W=()=>j();t.lng?CB(s,t.lng,g,W):aw(s,g,W)});return H},{slice:HL,forEach:PL}=[];function KL(e){return PL.call(HL.call(arguments,1),t=>{if(t)for(const r in t)e[r]===void 0&&(e[r]=t[r])}),e}function qL(e){return typeof e!="string"?!1:[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some(r=>r.test(e))}const SB=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,zL=function(e,t){const a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},n=encodeURIComponent(t);let s=`${e}=${n}`;if(a.maxAge>0){const l=a.maxAge-0;if(Number.isNaN(l))throw new Error("maxAge should be a Number");s+=`; Max-Age=${Math.floor(l)}`}if(a.domain){if(!SB.test(a.domain))throw new TypeError("option domain is invalid");s+=`; Domain=${a.domain}`}if(a.path){if(!SB.test(a.path))throw new TypeError("option path is invalid");s+=`; Path=${a.path}`}if(a.expires){if(typeof a.expires.toUTCString!="function")throw new TypeError("option expires is invalid");s+=`; Expires=${a.expires.toUTCString()}`}if(a.httpOnly&&(s+="; HttpOnly"),a.secure&&(s+="; Secure"),a.sameSite)switch(typeof a.sameSite=="string"?a.sameSite.toLowerCase():a.sameSite){case!0:s+="; SameSite=Strict";break;case"lax":s+="; SameSite=Lax";break;case"strict":s+="; SameSite=Strict";break;case"none":s+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return a.partitioned&&(s+="; Partitioned"),s},EB={create(e,t,r,a){let n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};r&&(n.expires=new Date,n.expires.setTime(n.expires.getTime()+r*60*1e3)),a&&(n.domain=a),document.cookie=zL(e,t,n)},read(e){const t=`${e}=`,r=document.cookie.split(";");for(let a=0;a<r.length;a++){let n=r[a];for(;n.charAt(0)===" ";)n=n.substring(1,n.length);if(n.indexOf(t)===0)return n.substring(t.length,n.length)}return null},remove(e,t){this.create(e,"",-1,t)}};var VL={name:"cookie",lookup(e){let{lookupCookie:t}=e;if(t&&typeof document<"u")return EB.read(t)||void 0},cacheUserLanguage(e,t){let{lookupCookie:r,cookieMinutes:a,cookieDomain:n,cookieOptions:s}=t;r&&typeof document<"u"&&EB.create(r,e,a,n,s)}},GL={name:"querystring",lookup(e){let{lookupQuerystring:t}=e,r;if(typeof window<"u"){let{search:a}=window.location;!window.location.search&&window.location.hash?.indexOf("?")>-1&&(a=window.location.hash.substring(window.location.hash.indexOf("?")));const s=a.substring(1).split("&");for(let l=0;l<s.length;l++){const A=s[l].indexOf("=");A>0&&s[l].substring(0,A)===t&&(r=s[l].substring(A+1))}}return r}},WL={name:"hash",lookup(e){let{lookupHash:t,lookupFromHashIndex:r}=e,a;if(typeof window<"u"){const{hash:n}=window.location;if(n&&n.length>2){const s=n.substring(1);if(t){const l=s.split("&");for(let A=0;A<l.length;A++){const u=l[A].indexOf("=");u>0&&l[A].substring(0,u)===t&&(a=l[A].substring(u+1))}}if(a)return a;if(!a&&r>-1){const l=n.match(/\/([a-zA-Z-]*)/g);return Array.isArray(l)?l[typeof r=="number"?r:0]?.replace("/",""):void 0}}}return a}};let Ld=null;const NB=()=>{if(Ld!==null)return Ld;try{if(Ld=typeof window<"u"&&window.localStorage!==null,!Ld)return!1;const e="i18next.translate.boo";window.localStorage.setItem(e,"foo"),window.localStorage.removeItem(e)}catch{Ld=!1}return Ld};var XL={name:"localStorage",lookup(e){let{lookupLocalStorage:t}=e;if(t&&NB())return window.localStorage.getItem(t)||void 0},cacheUserLanguage(e,t){let{lookupLocalStorage:r}=t;r&&NB()&&window.localStorage.setItem(r,e)}};let Ud=null;const FB=()=>{if(Ud!==null)return Ud;try{if(Ud=typeof window<"u"&&window.sessionStorage!==null,!Ud)return!1;const e="i18next.translate.boo";window.sessionStorage.setItem(e,"foo"),window.sessionStorage.removeItem(e)}catch{Ud=!1}return Ud};var YL={name:"sessionStorage",lookup(e){let{lookupSessionStorage:t}=e;if(t&&FB())return window.sessionStorage.getItem(t)||void 0},cacheUserLanguage(e,t){let{lookupSessionStorage:r}=t;r&&FB()&&window.sessionStorage.setItem(r,e)}},$L={name:"navigator",lookup(e){const t=[];if(typeof navigator<"u"){const{languages:r,userLanguage:a,language:n}=navigator;if(r)for(let s=0;s<r.length;s++)t.push(r[s]);a&&t.push(a),n&&t.push(n)}return t.length>0?t:void 0}},JL={name:"htmlTag",lookup(e){let{htmlTag:t}=e,r;const a=t||(typeof document<"u"?document.documentElement:null);return a&&typeof a.getAttribute=="function"&&(r=a.getAttribute("lang")),r}},ZL={name:"path",lookup(e){let{lookupFromPathIndex:t}=e;if(typeof window>"u")return;const r=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(r)?r[typeof t=="number"?t:0]?.replace("/",""):void 0}},eU={name:"subdomain",lookup(e){let{lookupFromSubdomainIndex:t}=e;const r=typeof t=="number"?t+1:1,a=typeof window<"u"&&window.location?.hostname?.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i);if(a)return a[r]}};let a3=!1;try{document.cookie,a3=!0}catch{}const n3=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];a3||n3.splice(1,1);const tU=()=>({order:n3,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:e=>e});class s3{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(t,r)}init(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=t,this.options=KL(r,this.options||{},tU()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=n=>n.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=a,this.addDetector(VL),this.addDetector(GL),this.addDetector(XL),this.addDetector(YL),this.addDetector($L),this.addDetector(JL),this.addDetector(ZL),this.addDetector(eU),this.addDetector(WL)}addDetector(t){return this.detectors[t.name]=t,this}detect(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,r=[];return t.forEach(a=>{if(this.detectors[a]){let n=this.detectors[a].lookup(this.options);n&&typeof n=="string"&&(n=[n]),n&&(r=r.concat(n))}}),r=r.filter(a=>a!=null&&!qL(a)).map(a=>this.options.convertDetectedLanguage(a)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?r:r.length>0?r[0]:null}cacheUserLanguage(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;r&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(t)>-1||r.forEach(a=>{this.detectors[a]&&this.detectors[a].cacheUserLanguage(t,this.options)}))}}s3.type="languageDetector";const rU={loading:"Loading...",save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",search:"Search...",no_data:"No data available",back:"Back",confirm_title:"Are you sure?",success:"Success",error:"Error",warning:"Warning",info:"Information",input:"Input",remove:"Remove",add:"Add",export_pdf:"PDF",exporting:"Export...",deleted:"Deleted",pinned:"Pinned",unpinned:"Unpinned",details:"Details",results_count:"{{count}} results",apply:"Apply",new:"New",expand:"Expand",collapse:"Collapse",all:"All",settings:"Settings",done:"Done",default:"Default",rename:"Rename",confirm_delete:"Delete this item?",read_only:"Read-Only",open_details:"Open details",refresh:"Refresh",show:"Show",hide:"Hide",open:"Open",open_in_inspector:"Open in Data Inspector",stop_sql:"Stop",storage_memory_warning:"Local persistence is currently unavailable. The database runs in memory and changes may be lost after reload.",storage_memory_reason:"Reason",name:"Name",description:"Description",saving:"Saving...",ok:"OK",not_available:"Not available"},aU={dashboard:"Overview",worklist:"Worklist",data_inspector:"Data Inspector",query_builder:"Query Builder",datasource:"Data Management",settings:"Settings",analytics_platform:"Analytics Platform",clock:"Status & Clock",database_status:"Database Status",system_status:"System Status",records_count:"{{count}}k Records",reports:"Report Packages",about:"About"},nU={title:"My Dashboard",subtitle:"Categorized evaluations and tiles.",add_widget:"Add Widget",manage_dashboards:"Manage Dashboards",presentation_mode:"Presentation Mode",system_widgets:"System Widgets",custom_widgets:"My Reports",default_name:"My Dashboard",add_title:"Add Widget",manage_title:"Manage Dashboards",new_dashboard:"New Dashboard",new_dashboard_title:"Create new dashboard",new_dashboard_placeholder:"Dashboard name (e.g., Costs for Customer X)",rename:"Rename",delete_confirm:"Delete dashboard?",empty_msg:'"{{name}}" is still empty',empty_hint:"Add tiles to customize this dashboard.",confirm_delete_report:"Are you sure you want to remove this report from the dashboard?",filters_title:"Global Dashboard Filters",filters_subtitle:"Slicers that affect all dashboard charts simultaneously.",add_filter:"Add Filter",filter_column:"Column...",filter_value:"Value...",no_filters:"No active filters. Click 'Add Filter' to constrain the dashboard.",op_contains:"contains",op_is_null:"is empty",pin_sidebar:"Add to menu",unpin_sidebar:"Remove from menu",active:"Active",no_reports:"No saved reports found.",tools_title:"Dashboard Tools",tools_tab_layout:"Layout",tools_tab_filters:"Filters",tools_layout_hint:"Reorder widgets and remove items without leaving the dashboard.",tools_filters_hint:"Manage global dashboard filters in one place.",tools_move_up:"Move up",tools_move_down:"Move down",tools_clear_filters:"Clear filters"},sU={subtitle:"Bookmarked records and verification results",filter_all:"All",filter_open:"New / Open",filter_in_progress:"In Progress",filter_done:"Done",filter_closed:"Closed",status_label:"Status",element_label:"Element",table_label:"Table",context_label:"Comment",created_label:"Created At",status_open:"New / Open",status_in_progress:"In Progress",status_done:"Done",status_closed:"Closed",found_count:"{{count}} entries found",empty_msg:"No entries",empty_hint:"Your worklist is currently empty or restricted by filters.",details_btn:"Open details",remove_btn:"Remove from worklist",entry_id:"Entry #{{id}}",comment_present:"Comment"},iU={subtitle:"{{count}} Results  {{mode}}",table_mode:"Table",sql_mode:"SQL",output_results:"Results",output_explain:"Explain",result_tab_data:"Data",result_tab_profile:"Profiling",saved_views:"Saved views",profiling_settings:"Profiling settings",refresh_title:"Refresh data",export_excel:"Export Excel",search_placeholder:"Search in visible columns...",auto_limit:"Auto-Limit: {{limit}}",page_size:"Page Size",page_size_value:"{{size}} / page",prev_page:"Prev",next_page:"Next",page_info:"Page {{page}} / {{pages}} ({{total}} rows)",page_number_placeholder:"Page",go:"Go",sql_placeholder:"SELECT * FROM ...",back_to_dashboard:"Back to Dashboard",clear_sql:"Clear",run_sql:"Run",stop_sql:"Stop",cancel_not_available:"No cancellable SQL query is currently running in this tab.",limit_confirm_prompt:"This SELECT has no LIMIT. Continue anyway? The result will be capped to {{limit}} rows.",limit_applied_notice:"Safety limit active: maximum {{limit}} rows are returned in SQL mode.",autocomplete_toggle_title:"Toggle SQL autocomplete",autocomplete_on:"Autocomplete on",autocomplete_off:"Autocomplete off",explain:"Explain",explain_mode:"Enable query explain plan",explain_title:"Explain Query Plan",explain_hint:"SQLite execution strategy",explain_empty:"Run a SQL query to see the explain plan.",empty_sql:"Enter and run SQL query.",sql_error:"SQL Error",write_confirm:"This SQL statement may modify data. Continue?",templates:"Templates",template_top10:"Top 10",template_count:"Count Rows",template_nullscan:"Null Scan",template_duplicates:"Find Duplicates",template_outliers:"Find Outliers",recent_queries:"Recent Queries",pick_recent:"Select recent query...",clear_history:"Clear History",favorite_queries:"Favorite Queries",pick_favorite:"Select favorite query...",clear_favorites:"Clear Favorites",pin_query:"Pin query",unpin_query:"Unpin query",pin:"Pin",unpin:"Unpin",save_template:"Save Template",custom_templates:"Custom Templates",pick_custom_template:"Select custom template...",rename_template:"Rename Template",delete_template:"Delete Template",clear_templates:"Clear Templates",custom_template_prompt:"Template name:",rename_template_prompt:"New template name:",custom_template_overwrite_confirm:'A template named "{{name}}" already exists. Overwrite?',custom_template_delete_confirm:"Delete selected custom template?",clear_templates_confirm:"Delete all custom templates?",sql_assist:"SQL Workspace",sql_manager_tab:"SQL Manager",assistant_tab:"SQL Builder",sql_manager_search_placeholder:"Search patterns...",sql_manager_no_results:"No matches",assistant_hint:"Build SQL by selecting table, columns and optional aggregation.",assistant_table:"Table",assistant_columns:"Columns",assistant_select_all:"Select all",assistant_aggregation:"Aggregation",assistant_none:"None",assistant_aggregation_field:"Aggregation Field",assistant_group_by:"Group by",assistant_metric_alias:"Metric Alias",assistant_where:"WHERE",assistant_where_placeholder:"status = 'active'",assistant_order_by:"Order by",assistant_auto:"Auto",assistant_direction:"Direction",assistant_limit:"Limit",assistant_generated_sql:"Generated SQL",assistant_replace_editor:"Replace Editor",assistant_append:"Append",profiling_title:"Data Profiling",profiling_subtitle:"Calculated from {{count}} loaded rows",profiling_issues:"Issues: {{count}}",thresholds:"Thresholds",null_threshold:"Null",cardinality_threshold:"Cardinality",reset_thresholds:"Reset",type:"Type",issues:"Issues",type_number:"Number",type_text:"Text",type_date:"Date",type_mixed:"Mixed",type_unknown:"Unknown",issue_high_null:"High Null",issue_mixed_types:"Mixed Types",issue_high_cardinality:"High Cardinality",issue_suspicious_values:"Suspicious Values",patterns:"Patterns",suspicious_values:"Suspicious",pattern_email:"Email",pattern_uuid:"UUID",pattern_iban:"IBAN",pattern_url:"URL",pattern_date:"Date",distinct_values:"Distinct",null_rate:"Null Rate",min:"Min",max:"Max",top_values:"Top Values",no_profile:"No profile data available.",show_profile:"Show Profile",hide_profile:"Hide Profile",resize_profile:"Resize profile panel",resize_sql_split:"Resize SQL and results panes",select_view:"Select view...",save_view:"Save View",update_view:"Update View",delete_view:"Delete View",new_view_prompt:"View name:",delete_view_confirm:"Delete this saved view?",table_tools:"Table Tools",table_tools_tab_columns:"Columns",table_tools_tab_filters:"Filters",table_tools_tab_actions:"Actions",table_tools_columns_hint:"Inspect schema and set sorting per column.",table_tools_filters_hint:"Manage global search and column filters.",table_tools_actions_hint:"Quick actions for current table context.",table_tools_column:"Column",table_tools_filter_value:"Filter",table_tools_filter_apply:"Apply",table_tools_toggle_filter_row:"Show filter row in table",table_tools_clear_all:"Clear all",table_tools_no_filters:"No active column filters",table_tools_global_search:"Global Search",table_tools_sort_asc:"Sort ascending",table_tools_sort_desc:"Sort descending",table_tools_export_rows:"Export current rows",table_tools_open_sql:"Open as SQL",table_tools_create_index:"Create index",table_tools_field_picker:"Field Picker",table_tools_selected_count:"{{count}} selected",table_tools_select_all_fields:"Select all",table_tools_clear_field_selection:"Clear",table_tools_to_sql_workspace:"To SQL Workspace",table_tools_apply_to_table:"Apply to Table",table_tools_run_selected_sql:"Run",table_tools_pick_fields_required:"Select at least one field.",index_suggestions_title:"Index Suggestions",index_suggestions_generate:"Generate",index_suggestions_hint:"Based on active filters, sorting, cardinality and existing indexes.",index_suggestions_empty:"No suggestions yet. Generate to analyze this table.",index_suggestions_columns:"Columns",index_suggestions_apply:"Create",index_suggestion_reason_filter:"Used in active table filter",index_suggestion_reason_sort:"Used as active sort column",index_suggestion_reason_composite:"Composite index for combined filters",index_suggestion_reason_filter_sort:"Composite index for filter + sort",index_suggestion_reason_cardinality:"High cardinality column"},lU={subtitle:"Create and visualize your own data queries.",visual_builder:"Visual Builder",direct_editor:"Direct Editor",sql_query:"SQL Query",apply:"Apply",preview:"Preview ({{count}} results)",graph_type:"Visualization Type",graph:"Graph",archive:"Archive",table:"Table",bar:"Bar",line:"Line",area:"Area",pie:"Pie",kpi:"KPI",composed:"Composed",radar:"Radar",scatter:"Scatter",text:"Text",x_axis:"X-Axis",y_axis:"Y-Axis",label:"Label",value:"Value",please_select:"Please select...",save_as_widget:"Save as Widget",update_widget:"Update Widget",new_report:"New Widget",saved_reports:"Saved Widgets",search_saved_reports:"Search saved widgets...",no_saved_reports_filtered:"No matching widgets found.",editing:"Editing: {{name}}",query:"Query",focus:"Focus",centered:"Centered",no_data_prompt:`No data
Run query`,save_title:"Save Report",update_title:"Update Report",archive_name:"Archive Name",archive_placeholder:"e.g., Monthly Hardware Costs",save_new:"Save as New",success_save:"Widget saved!",success_update:"Widget updated!",error_save:"Error saving: ",labels:"Labels",label_on:"ON",label_off:"OFF",select_column:"Select column...",add_y_axis:"Add Y-Axis",y_axes:"Y-Axes",pivot:"Pivot Table",pivot_rows:"Rows",pivot_cols:"Columns",pivot_measures:"Measures",pivot_add_row:"Add Row",pivot_add_col:"Add Column",pivot_add_measure:"Add Measure",pivot_agg_sum:"Sum",pivot_agg_count:"Count",pivot_agg_avg:"Average",pivot_agg_min:"Min",pivot_agg_max:"Max",kpi_rules:"KPI Alerts / Thresholds",add_rule:"Add Rule",rule_operator:"Operator",rule_value:"Value",rule_color:"Color",hint_run_query_before_export:"Run a query first to export.",hint_run_query_before_save:"Run a query or create text content first to save.",hint_save_shortcut:"Shortcut: Ctrl/Cmd + S",hint_export_shortcut:"Export current preview",workflow_guided:"Guided",workflow_advanced:"Advanced",guided_panel:"Guided Panel",current_step:"Current step",step_start:"Start",step_source:"Source",step_source_run:"Query",step_run:"Run",step_visualize:"Visualize",step_finalize:"Finalize",step_help_start:"Choose whether you want to create a new query or continue working on a saved one.",step_help_source_run:"Define your source/query and run it to load data for visualization.",step_help_visualize:"Pick a chart type and configure axes or display options.",step_help_finalize:"Review your result and save it as a new or updated report.",mode_new_active:"Mode: New query",mode_new_text_active:"Mode: New Text-Widget",mode_editing_active:"Mode: Editing {{name}}",start_new_query:"New Query",start_existing_query:"Edit Existing",new_query_card_title:"New Query",new_query_card_subtitle:"Define a new query",new_query_card_type:"< new type >",new_text_card_title:"New Text",new_text_card_subtitle:"Define a text message",new_text_card_type:"TEXT",next:"Next",back:"Back",finish:"Finish",unsaved_changes:"Unsaved changes",confirm_discard_changes:"You have unsaved changes. Discard them and continue?",check_start_ready:"Start option selected",check_source_ready:"Source selected",check_run_ready:"Query executed",check_visual_ready:"Visualization configured",check_save_ready:"Ready to save",text_content:"Text Content",text_placeholder:"Enter your text here...",text_size:"Text Size",text_size_sm:"Small",text_size_md:"Medium",text_size_lg:"Large",text_size_xl:"Extra Large",text_size_2xl:"2x Large",text_align:"Alignment",text_align_left:"Left",text_align_center:"Center",text_align_right:"Right",text_style:"Style",text_bold:"Bold",text_italic:"Italic",text_underline:"Underline",finalize_mode:"Mode",finalize_source:"Source",finalize_chart:"Visualization",finalize_axes:"X: {{x}}  Y series: {{count}}",finalize_text_length:"Characters: {{count}}",finalize_ready:"Preview is ready for saving.",preview_not_renderable_title:"Preview cannot be rendered with current settings.",preview_not_renderable_hint:"Please check required axes and fields for this visualization type, then click Apply again."},oU={title:"Report Packages",subtitle:"Build and export multi-page management reports.",new_pack_name:"New Report Package",default_category:"General",category:"Category",new_category:"New category",new_category_placeholder:"Category name (e.g. Management)",manage_categories:"Manage categories",expand_all_packs:"Expand all reports",collapse_all_packs:"Collapse all reports",move_category:"Move to category",move_category_unavailable:"No other category available",rename_category_prompt:"New category name:",category_exists:"A category with this name already exists.",delete_category_confirm:"Delete this category?",delete_category_with_packs_confirm:'Delete category "{{category}}" and all {{count}} report packages in it?',delete_empty_category:"Delete empty category",delete_with_content:"Delete category and its report packages",default_category_protected:"Default category cannot be deleted",no_categories:"No categories yet.",no_packages_in_category:"No packages in this category yet.",packages:"packages",pages:"Pages",export_batch:"Start Export",export_failed:"Export failed.",add_page:"Add Page",pack_settings:"Package Settings",pick_content:"Select Content",select_pack:"Please select a package",cover_page:"Cover Page",author:"Author",subtitle_label:"Subtitle",title_label:"Title",logo_url:"Logo URL",upload_logo:"Upload logo",logo_upload_failed:"Logo upload failed.",theme_color:"Theme color",toc:"Table of Contents",no_packages:"No Packages",general:"General",export_options:"Header / Footer",show_header:"Show header",show_footer:"Show footer",header_text:"Header text (optional)",footer_text:"Footer text (optional)",page_options:"Per-Page Options",no_pages:"No pages in this package yet.",page_title_override:"Page title override (optional)",landscape:"Landscape",portrait:"Portrait",preview:"Live Preview",content_page_preview:"Content Page Preview",page_content:"Page content",pack_name_placeholder:"Package Name",page:"Page",generated_on:"Generated on",author_prefix:"Author"},AU={title:"Settings",subtitle:"Dashboard configuration and notifications",tab_appearance:"General",tab_security:"Security",tab_apps:"Apps",tab_controls:"Controls",tab_inspector:"Inspector",tab_querybuilder:"Query Builder",tab_import:"Import",tab_datatable:"Data Table",tab_notifications:"Notifications",tab_about:"About",appearance:"Appearance",appearance_hint:"Customize the dashboard look.",language_panel_title:"Language",language_panel_hint:"Configure app language and visibility of the sidebar language switch.",language:"Language",language_de:"German",language_en:"English",show_sidebar_language_switch:"Show language switch in sidebar",health_link_title:"Diagnostics",health_link_hint:"Open the system health check and diagnostics overview.",health_link_open:"Open Health Check",show_sidebar_system_status:"Show 'System Status' in sidebar",theme_light:"Light",theme_dark:"Dark",theme_system:"System",inspector_title:"Data Inspector",inspector_hint:"Central defaults for Data Inspector behavior.",inspector_autocomplete:"SQL autocomplete",inspector_explain:"Enable explain mode by default",inspector_sql_assist:"Open SQL assist by default",inspector_profiling:"Show data profiling by default",inspector_page_size:"Default page size",inspector_thresholds:"Profiling thresholds",inspector_null_threshold:"Null threshold (%)",inspector_cardinality_threshold:"Cardinality threshold (%)",inspector_sql_safety:"SQL safety",inspector_sql_confirm_without_limit:"Confirm SELECT statements without LIMIT",inspector_sql_max_rows:"Maximum rows returned per SQL run",inspector_reset_title:"Reset",inspector_reset_layout:"Reset layout and views",inspector_reset_sql:"Clear SQL history and templates",inspector_reset_layout_confirm:"Reset Data Inspector layout and saved views?",inspector_reset_layout_done:"Data Inspector layout and saved views were reset.",inspector_reset_sql_confirm:"Clear SQL history, favorites and custom templates?",inspector_reset_sql_done:"SQL history, favorites and templates were cleared.",querybuilder_title:"Query Builder",querybuilder_hint:"Default behavior for entering Query Builder.",querybuilder_default_mode:"Default start mode",querybuilder_sql_height:"SQL editor height (px)",import_title:"Import",import_hint:"Default behavior for Excel imports.",backup_hint:"Default behavior for backup and restore.",import_default_mode:"Default import mode",import_auto_save_mappings:"Auto-save mappings",backup_name_pattern:"Backup filename pattern",backup_name_pattern_hint:"Tokens: {date}, {time}, {datetime}, {mode}.",backup_use_saved_location:"Use saved backup folder",backup_use_saved_location_hint:"Default: try the selected backup folder first, then fall back to file picker.",backup_folder:"Backup folder",backup_folder_none:"No folder selected",backup_folder_choose:"Choose folder",backup_folder_not_supported:"Your browser does not support persistent folder access.",backup_folder_select_error:"Folder could not be selected.",datatable_title:"Data Table",datatable_hint:"Central display defaults for data tables.",datatable_density:"Row density",datatable_density_normal:"Normal",datatable_density_compact:"Compact",datatable_wrap_cells:"Wrap long cell content",datatable_default_filters:"Show filter row by default",notifications_title:"Notifications",notifications_hint:"Behavior for safety and confirmation prompts.",notifications_confirm_destructive:"Confirm destructive actions",log_level:"Log level",log_level_off:"Off",log_level_error:"Errors only",log_level_warn:"Warnings + errors",log_level_info:"Info + warnings + errors",log_level_debug:"Debug (verbose)",security:"Security",security_hint:"Protect access to the dashboard.",access_restriction_title:"Access Restriction",access_restriction_hint:"Configure lock protection for application access.",enable_pin:"Enable PIN protection",pin_placeholder:"New PIN (min. 4 digits)",pin_error_min:"PIN must be at least 4 digits.",pin_success:"PIN protection enabled.",pin_confirm_remove:"Do you really want to remove PIN protection?",pin_active:"PIN protection active",pin_active_hint:"Dashboard is locked on restart",admin_mode:"Admin Mode",admin_mode_hint:"Show system tables (sys_) in selections.",admin_mode_panel_hint:"Control visibility of advanced system structures.",admin_mode_active:"Admin Mode active",user_mode:"User Mode",last_update:"Last update: {{date}}, {{time}}"},cU={subtitle:"Central management for imports, structures and system maintenance.",tab_import:"Data Import",tab_structure:"Structure & Schema",tab_system:"Maintenance & Backup",smart_import_title:"Create New Table (Smart Import)",smart_import_hint:"Analyzes Excel files and automatically creates matching tables.",or_separator:"OR",append_data_title:"Append Data",append_data_hint:"Import data into an existing table.",select_target_table:"Select target table...",user_tables:"Custom Tables",user_tables_hint:"Manage your own table structures.",new_table:"New Table",no_user_tables:"No custom tables found.",user_views:"Views",user_views_hint:"SQL views available in the local database.",no_user_views:"No views available.",view_type:"VIEW",show_schema:"Show Schema",append_data_short:"Append Data",system_tables:"System Tables (Read-Only)",backup_restore:"Backup & Restore",backup_recommended:"{{count}} unsaved changes. Backup recommended.",encryption_active:"Encryption enabled",encryption_standard:"Standard Backup (Unencrypted)",encryption_active_hint:"File will be protected with a password.",encryption_standard_hint:"File is readable by everyone.",backup_password_placeholder:"Set backup password...",backup_password_error:"Please provide a secure password (min. 4 characters).",save_backup_secure:"Save Protected",save_backup_standard:"Save Backup",restore_backup:"Restore Backup",restore_from_saved_location:"From backup folder",restore_confirm:"Warning: This overwrites ALL local data! Continue?",restore_invalid:"The backup file is invalid or corrupted.",restore_missing_tables:"The following system tables are missing:",restore_missing_columns:"The following columns are missing in the tables:",restore_success_reload:"Backup successfully validated and imported. The page will now reload.",restore_warning_title:"Compatibility Warning",restore_warning_hint:"The backup seems to be from an older version. Some features might be limited.",restore_encrypted_prompt:"This file seems to be encrypted. Please enter password:",restore_failed:"Decryption failed! Wrong password or corrupted file.",danger_zone:"Danger Zone",danger_zone_hint:"Destructive actions  changes cannot be undone.",clear_reset:"Clear Data (Reset)",clear_reset_hint:"Removes all rows from the selected table but keeps the structure.",clear_btn:"Clear",factory_reset_title:"Factory settings",factory_reset_confirm:"Are you sure? All data (including tables, views, and indexes), dashboards, widgets, and local settings will be permanently deleted. This cannot be undone.",factory_reset_prompt:'Please type "RESET" to continue:',factory_reset_success:"Database and local settings were reset to factory defaults. Reloading...",factory_reset_aborted:"Canceled: Wrong input.",factory_reset_btn:"Reset completely",factory_reset_hint:"Deletes the entire database including tables, views, and indexes, resets local settings, and recreates a fresh empty schema at the latest version.",sql_manager_reset_title:"SQL Manager reset",sql_manager_reset_confirm:"Reset SQL Manager? All saved SQL statements and favorites will be deleted.",sql_manager_reset_prompt:'Please type "RESET" to continue:',sql_manager_reset_success:"SQL Manager was reset.",sql_manager_reset_aborted:"Canceled: Wrong input.",sql_manager_reset_btn:"Reset SQL Manager",sql_manager_reset_hint:"Deletes all saved SQL statements in the SQL Manager, including favorites and usage counters.",clear_confirm:'Irrevocably delete all data in table "{{name}}"?',cleared_success:"Table cleared.",drop_table_title:"Remove Table",drop_table_hint:"Deletes the entire table including structure. Only possible for custom tables.",drop_confirm:'Really delete table "{{name}}"?',drop_view_title:"Delete view",drop_view_confirm:'Really delete view "{{name}}"?',create_table_title:"New Table",assistant:"Assistant",create_btn:"Create",table_created:"Table created!",schema_not_available:"No schema available",name_label:"Name",columns_label:"Columns",add_column:"+ Column",records_label:"Records ({{name}})",table_meta_rows:"{{count}} rows",table_meta_indexes:"{{count}} indexes",view_invalid:"Invalid view",mappings_saved:"{{count}} Mappings saved",export_mappings:"Export mappings (JSON)",import_mappings:"Import mappings (JSON)",clear_mappings:"Clear all mappings",clear_mappings_confirm:"Are you sure you want to delete ALL saved mappings? This cannot be undone.",drop_btn:"Delete",create_index_title:"Create index",create_index_btn:"Create index",index_create_for_table:"Table",index_name:"Index name",index_unique:"Unique index",index_columns:"Columns",index_order:"Column order",index_where_optional:"WHERE (optional)",index_create_name_required:"Please provide an index name.",index_create_columns_required:"Please select at least one column.",index_create_success:"Index created.",indexes_title:"Indexes",indexes_empty:"No indexes available.",indexes_columns:"Columns",smart_import:{step_upload:"Upload",step_config:"Preview & Config",step_import:"Import",upload_label:"Select Excel File",upload_hint:"We analyze the structure automatically.",found_tables:"Found Tables",found_tables_hint:"Select which sheets should be imported and check the names.",sheet_label:"Sheet:",table_label:"Table:",invalid_prefix:"Reserved prefix 'sys_' not allowed.",invalid_sheet:"Invalid",columns_count:"{{count}} columns detected",rows_count:"{{count}} rows",more_columns:"+{{count}} more",import_running:"Importing data...",done_btn:"Done",back_btn:"Back",start_import:"Start Import",error_analyzing:"Error analyzing file.",step_success:"Completed",import_success_title:"Import successful!",import_success_hint:"{{count}} tables have been successfully created and populated.",finish_btn:"Finish"},excel_import:{processing_file:"Processing file...",error_reading:"Error reading file: {{error}}",error_loading:"File could not be loaded: {{error}}",no_config:"No import configuration available.",no_data:"No data found in file.",no_valid_data:"No valid data found to import.",import_failed:"Import failed: {{error}}",success_msg:"Successfully imported {{count}} records.",append:"Add",overwrite:"Overwrite",drop_hint:"Click or drag file here",none_selected:"No table selected"}},uU={title:"About LiteBI Studio",subtitle:"Information about the project and system",tagline:"The lightweight business intelligence platform directly in your browser.",status_stable:"Stable (Local)",philosophy_title:"Our Philosophy",philosophy_description:"LiteBI Studio was developed with the goal of making data analysis as simple and secure as possible. Unlike traditional BI tools, your data never leaves your browser with LiteBI Studio.",point_privacy_title:"Privacy First",point_privacy_desc:"No server storage, no cloud constraints.",point_speed_title:"Speed",point_speed_desc:"Local processing using SQLite WASM technology.",point_offline_title:"Offline-Ready",point_offline_desc:"Works even without an active internet connection.",tech_stack_title:"Tech Stack",tech_ui_framework:"UI Framework",tech_language:"Language",tech_build_tool:"Build Tool",tech_styling:"Styling",tech_local_database:"Local Database",tech_visualization:"Visualization",tech_i18n:"Internationalization",tech_pdf_export:"PDF Export",tech_icon_system:"Icon System",links_title:"Links",link_github:"GitHub Repository",link_readme:"README",link_changelog:"Changelog",link_docs:"Documentation",link_website:"Website",support_title:"Support",support_text:"Do you have questions or feedback? We look forward to your message.",contact_cta:"Contact us",copyright_prefix:" {{year}} LiteBI Studio Project. Released under ",settings_hint:"Learn more about the project, the version and the vision behind LiteBI Studio.",view_info:"Project Information"},dU={title:"Record Details",navigation:"Navigate",schema_definition:"Show Schema Definition",add_worklist:"Add to worklist",remove_worklist:"Remove from worklist",set_reference:"Set as reference for comparison",clear_reference:"Stop reference mode",deleted_badge:"DELETED",status_label:"Processing Status",status_pending:"Open / New",status_in_progress:"In Progress",status_error:"Error",status_obsolete:"Obsolete",status_done:"Completed (OK)",comment_label:"Remark / Note",comment_placeholder:"Enter your notes or verification results here...",comparison_active:"Comparison active:",differences_relative:"Differences are shown relative to {{id}}.",empty_value:"<empty>",pattern_email:"Email",pattern_uuid:"UUID",pattern_iban:"IBAN",pattern_url:"URL",pattern_date:"Date",suspicious:"Suspicious",close:"Close"},fU={system_status:{title:"System Status",description:"Platform health status",memory_usage:"Memory Usage",load_time:"Load Time",heap_from:"of {{total}} MB Heap",details:"Details"},data_inspector:{title:"Data Inspector",description:"Direct access to table data",records_total:"Records Total",tables:"Tables",details:"Details"},database_status:{title:"Database Status",description:"Storage usage and statistics",last_backup:"Last Backup",modifications:"Changes",records_since_backup:"Records since backup",data_management:"Data Management",never:"Never"},clock:{title:"Time",description:"Simple clock"},worklist:{title:"Worklist",description:"Statistics of bookmarked records",open_tasks:"Open Tasks",all_done:"All Done",total_entries:"Total Entries",open_list:"Open List"},system_health:{title:"System Diagnostics & Health",tab_overview:"Overview",tab_storage:"Storage",tab_database:"Database",app_environment:"Application Environment",version:"Version",build_date:"Build Date",environment:"Environment",user_agent:"User Agent",cpu_cores:"CPU Cores",device_memory:"Device Memory",memory_limit_hint:"Browser limits display to max. 8GB",used_storage:"Used Storage",max_available:"Max Available (Quota)",quota_used:"{{percent}}% of quota used",no_storage_info:"No storage information available.",overview_db_health:"DB Health",overview_storage_health:"Storage Health",overview_last_backup:"Last Backup",overview_not_available:"Not available",overview_quick_actions:"Quick Actions",overview_action_run_health:"Run Health Check",overview_action_open_storage:"Open Storage",overview_action_backup:"Backup Center",overview_action_inspector:"Open Inspector",opfs_title:"Origin Private File System (OPFS)",opfs_description:"The database is stored in an isolated, high-performance area of the browser. This storage is persistent but managed by the browser.",analyzing_db:"Analyzing database...",db_size:"Logical DB Size",connected:"Connected",worker_active:"SQLite Worker active",table_stats:"Table Statistics",health_check_title:"Database Health Check",health_status_ok:"Healthy",health_status_warning:"Needs attention",health_status_error:"Critical issues",health_score:"Score: {{score}} / 100",health_meta:"Checks: {{checks}} | Last run: {{timestamp}}",severity_error:"Error",severity_warning:"Warning",severity_info:"Info",recommendation_prefix:"Recommendation:",show_details:"Show details",hide_details:"Hide details",quick_fix:"Quick fix",quick_fix_running:"Applying...",quick_fix_confirm:"Apply suggested index fixes now?",quick_fix_success:"Quick fix completed. {{count}} index(es) created or confirmed.",quick_fix_failed:"Quick fix failed:",quick_fix_none:"No automatic fix could be generated for this finding.",client_health_title:"Environment & Settings Health",client_health_meta:"Checks: {{checks}}",client_storage_quota_critical:"Storage quota critically high",client_storage_quota_high:"Storage quota high",client_storage_quota_ok:"Storage quota in healthy range",client_storage_quota_unknown:"Storage quota unavailable",client_local_storage_large:"Local storage usage is high",client_local_storage_ok:"Local storage usage is normal",client_session_storage_large:"Session storage usage is high",client_session_storage_ok:"Session storage usage is normal",client_destructive_confirm_off:"Destructive confirmations disabled",client_destructive_confirm_off_detail:"Delete/reset confirmations are turned off.",client_destructive_confirm_on:"Destructive confirmations enabled",client_destructive_confirm_on_detail:"Safety confirmations are active.",client_log_level_debug:"Debug logging enabled",client_log_level_debug_detail:"Verbose browser logging may affect performance.",client_log_level_ok:"Log level is suitable",client_backup_missing:"No backup timestamp found",client_backup_missing_detail:"Create a backup to improve recovery readiness.",client_backup_exists:"Backup information available",user_tables:"User Tables",system_tables:"System Tables",refresh_diag:"Refresh Diagnostics",diag_failed:"Diagnostics failed",retry:"Retry"}},hU={common:rU,sidebar:aU,dashboard:nU,worklist:sU,datainspector:iU,querybuilder:lU,reports:oU,settings:AU,datasource:cU,about:uU,record_detail:dU,widgets:fU},pU={loading:"Laden...",save:"Speichern",cancel:"Abbrechen",delete:"Lschen",edit:"Bearbeiten",search:"Suchen...",no_data:"Keine Daten verfgbar",back:"Zurck",confirm_title:"Sind Sie sicher?",success:"Erfolgreich",error:"Fehler",warning:"Warnung",info:"Information",input:"Eingabe",remove:"Entfernen",add:"Hinzufgen",export_pdf:"PDF",exporting:"Exportieren...",deleted:"Gelscht",pinned:"Angeheftet",unpinned:"Gelst",details:"Details",results_count:"{{count}} Ergebnisse",apply:"bernehmen",new:"Neu",expand:"Vergrern",collapse:"Einklappen",all:"Alle",settings:"Einstellungen",done:"Fertig",default:"Standard",rename:"Umbenennen",confirm_delete:"Wirklich lschen?",read_only:"Lese-Modus",open_details:"Detailansicht",refresh:"Aktualisieren",show:"Anzeigen",hide:"Ausblenden",open:"Oeffnen",open_in_inspector:"Im Data Inspector oeffnen",stop_sql:"Stop",storage_memory_warning:"Persistenter lokaler Speicher ist aktuell nicht verfuegbar. Die Datenbank laeuft im Arbeitsspeicher und Aenderungen gehen nach einem Neuladen moeglicherweise verloren.",storage_memory_reason:"Grund",name:"Name",description:"Beschreibung",saving:"Speichern...",ok:"OK",not_available:"Nicht verfuegbar"},gU={dashboard:"bersicht",worklist:"Arbeitsvorrat",data_inspector:"Data Inspector",query_builder:"Query Builder",datasource:"Datenverwaltung",settings:"Einstellungen",analytics_platform:"Analyse-Plattform",clock:"Status & Uhr",database_status:"Datenbank-Status",system_status:"System-Status",records_count:"{{count}}k Datenstze",reports:"Berichtspakete",about:"ber"},mU={title:"Mein Dashboard",subtitle:"Kategorisierte Auswertungen und Kacheln.",add_widget:"Widget hinzufgen",manage_dashboards:"Dashboards verwalten",presentation_mode:"Prsentationsmodus",system_widgets:"System-Kacheln",custom_widgets:"Meine Berichte",default_name:"Mein Dashboard",add_title:"Widget hinzufgen",manage_title:"Dashboards verwalten",new_dashboard:"Neues Dashboard",new_dashboard_title:"Neues Dashboard erstellen",new_dashboard_placeholder:"Dashboard Name (z.B. Kosten fr Kunde X)",rename:"Umbenennen",delete_confirm:"Dashboard lschen?",empty_msg:'"{{name}}" ist noch leer',empty_hint:"Fge Kacheln hinzu, um dieses Dashboard anzupassen.",confirm_delete_report:"Mchten Sie diesen Bericht wirklich vom Dashboard entfernen?",filters_title:"Globale Dashboard-Filter",filters_subtitle:"Filter, die alle Dashboard-Grafiken gleichzeitig beeinflussen.",add_filter:"Filter hinzufgen",filter_column:"Spalte...",filter_value:"Wert...",no_filters:"Keine aktiven Filter. Klicke auf 'Filter hinzufgen', um das Dashboard einzuschrnken.",op_contains:"enthlt",op_is_null:"ist leer",pin_sidebar:"Zum Men hinzufgen",unpin_sidebar:"Vom Men entfernen",active:"Aktiv",no_reports:"Keine gespeicherten Berichte gefunden.",tools_title:"Dashboard Tools",tools_tab_layout:"Layout",tools_tab_filters:"Filter",tools_layout_hint:"Widgets umsortieren und entfernen, ohne die Uebersicht zu verlassen.",tools_filters_hint:"Globale Dashboard-Filter zentral verwalten.",tools_move_up:"Nach oben",tools_move_down:"Nach unten",tools_clear_filters:"Filter leeren"},xU={subtitle:"Gemerkte Datenstze und Prfergebnisse",filter_all:"Alle",filter_open:"Neu / Offen",filter_in_progress:"In Bearbeitung",filter_done:"Erledigt",filter_closed:"Geschlossen",status_label:"Status",element_label:"Element",table_label:"Tabelle",context_label:"Kommentar",created_label:"Erstellt am",status_open:"Neu / Offen",status_in_progress:"In Bearbeitung",status_done:"Erledigt",status_closed:"Geschlossen",found_count:"{{count}} Eintrge gefunden",empty_msg:"Keine Eintrge",empty_hint:"Dein Arbeitsvorrat ist aktuell leer oder durch Filter eingeschrnkt.",details_btn:"Details ffnen",remove_btn:"Vom Arbeitsvorrat entfernen",entry_id:"Eintrag #{{id}}",comment_present:"Kommentar"},bU={subtitle:"{{count}} Ergebnisse  {{mode}}",table_mode:"Tabelle",sql_mode:"SQL",output_results:"Ergebnisse",output_explain:"Explain",result_tab_data:"Daten",result_tab_profile:"Profiling",saved_views:"Gespeicherte Ansichten",profiling_settings:"Profiling-Einstellungen",refresh_title:"Daten aktualisieren",export_excel:"Excel Export",search_placeholder:"In sichtbaren Spalten suchen...",auto_limit:"Auto-Limit: {{limit}}",page_size:"Seitengre",page_size_value:"{{size}} / Seite",prev_page:"Zurck",next_page:"Weiter",page_info:"Seite {{page}} / {{pages}} ({{total}} Zeilen)",page_number_placeholder:"Seite",go:"Los",sql_placeholder:"SELECT * FROM ...",back_to_dashboard:"Zurueck zum Dashboard",clear_sql:"Leeren",run_sql:"Ausfhren",stop_sql:"Stop",cancel_not_available:"In diesem Tab luft aktuell keine abbrechbare SQL-Abfrage.",limit_confirm_prompt:"Dieses SELECT hat kein LIMIT. Trotzdem ausfuehren? Das Ergebnis wird auf {{limit}} Zeilen begrenzt.",limit_applied_notice:"Sicherheitslimit aktiv: Im SQL-Modus werden maximal {{limit}} Zeilen zurueckgegeben.",autocomplete_toggle_title:"SQL-Autocomplete umschalten",autocomplete_on:"Autocomplete an",autocomplete_off:"Autocomplete aus",explain:"Explain",explain_mode:"Abfrage-Ausfhrungsplan anzeigen",explain_title:"Explain Query Plan",explain_hint:"SQLite Ausfhrungsstrategie",explain_empty:"Fhren Sie eine SQL-Abfrage aus, um den Ausfhrungsplan zu sehen.",empty_sql:"SQL-Abfrage eingeben und ausfhren.",sql_error:"SQL Fehler",write_confirm:"Diese SQL-Anweisung kann Daten ndern. Trotzdem ausfhren?",templates:"Vorlagen",template_top10:"Top 10",template_count:"Zeilen zhlen",template_nullscan:"Null-Scan",template_duplicates:"Duplikate finden",template_outliers:"Ausreier finden",recent_queries:"Letzte Abfragen",pick_recent:"Letzte Abfrage whlen...",clear_history:"Verlauf lschen",favorite_queries:"Favorisierte Abfragen",pick_favorite:"Favorisierte Abfrage whlen...",clear_favorites:"Favoriten lschen",pin_query:"Abfrage anheften",unpin_query:"Abfrage lsen",pin:"Anheften",unpin:"Lsen",save_template:"Vorlage speichern",custom_templates:"Eigene Vorlagen",pick_custom_template:"Eigene Vorlage whlen...",rename_template:"Vorlage umbenennen",delete_template:"Vorlage lschen",clear_templates:"Vorlagen lschen",custom_template_prompt:"Name der Vorlage:",rename_template_prompt:"Neuer Vorlagenname:",custom_template_overwrite_confirm:'Eine Vorlage mit dem Namen "{{name}}" existiert bereits. berschreiben?',custom_template_delete_confirm:"Ausgewhlte eigene Vorlage lschen?",clear_templates_confirm:"Alle eigenen Vorlagen lschen?",sql_assist:"SQL Workspace",sql_manager_tab:"SQL Manager",assistant_tab:"SQL Builder",sql_manager_search_placeholder:"Muster suchen...",sql_manager_no_results:"Keine Treffer",assistant_hint:"SQL per Auswahl von Tabelle, Spalten und optionaler Aggregation erstellen.",assistant_table:"Tabelle",assistant_columns:"Spalten",assistant_select_all:"Alle waehlen",assistant_aggregation:"Aggregation",assistant_none:"Keine",assistant_aggregation_field:"Aggregationsfeld",assistant_group_by:"Gruppieren nach",assistant_metric_alias:"Metrik-Alias",assistant_where:"WHERE",assistant_where_placeholder:"status = 'active'",assistant_order_by:"Sortieren nach",assistant_auto:"Auto",assistant_direction:"Richtung",assistant_limit:"Limit",assistant_generated_sql:"Generiertes SQL",assistant_replace_editor:"Editor ersetzen",assistant_append:"Anhaengen",profiling_title:"Datenprofil",profiling_subtitle:"Berechnet auf Basis von {{count}} geladenen Zeilen",profiling_issues:"Hinweise: {{count}}",thresholds:"Schwellwerte",null_threshold:"Null",cardinality_threshold:"Kardinalitt",reset_thresholds:"Zurcksetzen",type:"Typ",issues:"Hinweise",type_number:"Zahl",type_text:"Text",type_date:"Datum",type_mixed:"Gemischt",type_unknown:"Unbekannt",issue_high_null:"Hohe Nullquote",issue_mixed_types:"Gemischte Typen",issue_high_cardinality:"Hohe Kardinalitt",issue_suspicious_values:"Auffllige Werte",patterns:"Muster",suspicious_values:"Auffllig",pattern_email:"E-Mail",pattern_uuid:"UUID",pattern_iban:"IBAN",pattern_url:"URL",pattern_date:"Datum",distinct_values:"Unikate",null_rate:"Null-Quote",min:"Min",max:"Max",top_values:"Hufigste Werte",no_profile:"Keine Profildaten verfgbar.",show_profile:"Profil anzeigen",hide_profile:"Profil ausblenden",resize_profile:"Profilbereich in der Hhe anpassen",resize_sql_split:"SQL- und Ergebnisbereich in der Hhe anpassen",select_view:"Ansicht whlen...",save_view:"Ansicht speichern",update_view:"Ansicht aktualisieren",delete_view:"Ansicht lschen",new_view_prompt:"Name der Ansicht:",delete_view_confirm:"Diese gespeicherte Ansicht lschen?",table_tools:"Table Tools",table_tools_tab_columns:"Spalten",table_tools_tab_filters:"Filter",table_tools_tab_actions:"Aktionen",table_tools_columns_hint:"Schema einsehen und Sortierung pro Spalte setzen.",table_tools_filters_hint:"Globale Suche und Spaltenfilter verwalten.",table_tools_actions_hint:"Schnellaktionen fuer den aktuellen Tabellenkontext.",table_tools_column:"Spalte",table_tools_filter_value:"Filter",table_tools_filter_apply:"Anwenden",table_tools_toggle_filter_row:"Filterzeile in der Tabelle anzeigen",table_tools_clear_all:"Alles zuruecksetzen",table_tools_no_filters:"Keine aktiven Spaltenfilter",table_tools_global_search:"Globale Suche",table_tools_sort_asc:"Aufsteigend sortieren",table_tools_sort_desc:"Absteigend sortieren",table_tools_export_rows:"Aktuelle Zeilen exportieren",table_tools_open_sql:"Als SQL oeffnen",table_tools_create_index:"Index erstellen",table_tools_field_picker:"Feld-Auswahl",table_tools_selected_count:"{{count}} ausgewaehlt",table_tools_select_all_fields:"Alle waehlen",table_tools_clear_field_selection:"Leeren",table_tools_to_sql_workspace:"In SQL Workspace",table_tools_apply_to_table:"Auf Tabelle anwenden",table_tools_run_selected_sql:"Ausfuehren",table_tools_pick_fields_required:"Bitte mindestens ein Feld waehlen.",index_suggestions_title:"Index-Vorschlaege",index_suggestions_generate:"Erzeugen",index_suggestions_hint:"Basiert auf aktiven Filtern, Sortierung, Kardinalitaet und vorhandenen Indizes.",index_suggestions_empty:"Noch keine Vorschlaege. Erzeugen startet die Analyse dieser Tabelle.",index_suggestions_columns:"Spalten",index_suggestions_apply:"Erstellen",index_suggestion_reason_filter:"In aktivem Tabellenfilter verwendet",index_suggestion_reason_sort:"Als aktive Sortierspalte verwendet",index_suggestion_reason_composite:"Kombinierter Index fuer gemeinsame Filter",index_suggestion_reason_filter_sort:"Kombinierter Index fuer Filter + Sortierung",index_suggestion_reason_cardinality:"Spalte mit hoher Kardinalitaet"},vU={subtitle:"SQL- und visueller Abfrage-Builder fr fortgeschrittene Datenanalyse",new_report:"Neues Widget",save_as_widget:"Als Widget speichern",update_widget:"Aktualisieren",archive:"Archiv",query:"Abfrage",graph:"Grafik",saved_reports:"Gespeicherte Widgets",search_saved_reports:"Gespeicherte Widgets durchsuchen...",no_saved_reports_filtered:"Keine passenden Widgets gefunden.",editing:"Bearbeiten: {{name}}",visual_builder:"Visueller Builder",direct_editor:"Direkt-Editor",sql_query:"SQL-Abfrage",apply:"Anwenden",graph_type:"Grafik-Typ",table:"Tabelle",bar:"Balken",line:"Linie",area:"Flche",pie:"Kreis",kpi:"Kennzahl",composed:"Kombiniert",radar:"Radar",scatter:"Streuung",text:"Text",x_axis:"X-Achse",y_axis:"Y-Achsen",label:"Beschriftung",value:"Wert",please_select:"Bitte whlen...",preview:"Vorschau ({{count}})",focus:"Fokus",centered:"Zentriert",no_data_prompt:`Keine Daten
Abfrage ausfhren`,save_title:"Bericht speichern",update_title:"Bericht aktualisieren",archive_name:"Archivierungs-Name",archive_placeholder:"z.B. Monatliche Hardware-Kosten",save_new:"Neu speichern",success_save:"Widget gespeichert!",success_update:"Widget aktualisiert!",error_save:"Fehler beim Speichern: ",labels:"Beschriftungen",label_on:"AN",label_off:"AUS",select_column:"Spalte whlen...",add_y_axis:"Y-Achse hinzufgen",y_axes:"Y-Achsen",pivot:"Pivot-Tabelle",pivot_rows:"Zeilen",pivot_cols:"Spalten",pivot_measures:"Messwerte",pivot_add_row:"Zeile hinzufgen",pivot_add_col:"Spalte hinzufgen",pivot_add_measure:"Messwert hinzufgen",pivot_agg_sum:"Summe",pivot_agg_count:"Anzahl",pivot_agg_avg:"Mittelwert",pivot_agg_min:"Min",pivot_agg_max:"Max",kpi_rules:"KPI-Alerts / Schwellenwerte",add_rule:"Regel hinzufgen",rule_operator:"Operator",rule_value:"Wert",rule_color:"Farbe",hint_run_query_before_export:"Fhren Sie zuerst eine Abfrage aus, um zu exportieren.",hint_run_query_before_save:"Fhren Sie zuerst eine Abfrage aus oder erstellen Sie Textinhalt, um zu speichern.",hint_save_shortcut:"Shortcut: Strg/Cmd + S",hint_export_shortcut:"Aktuelle Vorschau exportieren",workflow_guided:"Gefhrt",workflow_advanced:"Erweitert",guided_panel:"Gefhrtes Panel",current_step:"Aktueller Schritt",step_start:"Start",step_source:"Quelle",step_source_run:"Abfrage",step_run:"Ausfhren",step_visualize:"Visualisieren",step_finalize:"Abschlieen",step_help_start:"Whlen Sie, ob Sie eine neue Query erstellen oder eine gespeicherte Query weiterbearbeiten mchten.",step_help_source_run:"Definieren Sie Quelle/Query und fhren Sie sie aus, um Daten fr die Visualisierung zu laden.",step_help_visualize:"Whlen Sie einen Diagrammtyp und konfigurieren Sie Achsen bzw. Anzeigeoptionen.",step_help_finalize:"Prfen Sie das Ergebnis und speichern Sie es als neuen oder aktualisierten Bericht.",mode_new_active:"Modus: Neue Query",mode_new_text_active:"Modus: New Text-Widget",mode_editing_active:"Modus: Bearbeitung {{name}}",start_new_query:"Neue Query",start_existing_query:"Bestehende bearbeiten",new_query_card_title:"New Query",new_query_card_subtitle:"Neue zu definierende Query",new_query_card_type:"< neuer Typ >",new_text_card_title:"New Text",new_text_card_subtitle:"Define a text message",new_text_card_type:"TEXT",next:"Weiter",back:"Zurck",finish:"Fertig",unsaved_changes:"Ungespeicherte nderungen",confirm_discard_changes:"Es gibt ungespeicherte nderungen. Verwerfen und fortfahren?",check_start_ready:"Startoption ausgewhlt",check_source_ready:"Quelle ausgewhlt",check_run_ready:"Abfrage ausgefhrt",check_visual_ready:"Visualisierung konfiguriert",check_save_ready:"Bereit zum Speichern",text_content:"Textinhalt",text_placeholder:"Geben Sie hier Ihren Text ein...",text_size:"Textgre",text_size_sm:"Klein",text_size_md:"Mittel",text_size_lg:"Gro",text_size_xl:"Sehr gro",text_size_2xl:"2x gro",text_align:"Ausrichtung",text_align_left:"Links",text_align_center:"Zentriert",text_align_right:"Rechts",text_style:"Stil",text_bold:"Fett",text_italic:"Kursiv",text_underline:"Unterstrichen",finalize_mode:"Modus",finalize_source:"Quelle",finalize_chart:"Visualisierung",finalize_axes:"X: {{x}}  Y-Serien: {{count}}",finalize_text_length:"Zeichen: {{count}}",finalize_ready:"Vorschau ist bereit zum Speichern.",preview_not_renderable_title:"Die Vorschau kann mit den aktuellen Einstellungen nicht dargestellt werden.",preview_not_renderable_hint:"Bitte prfen Sie die bentigten Achsen und Felder fr diesen Visualisierungstyp und klicken Sie erneut auf Anwenden."},wU={title:"Berichtspakete",subtitle:"Erstellen und exportieren Sie mehrseitige Management-Berichte.",new_pack_name:"Neues Berichtspaket",default_category:"General",category:"Kategorie",new_category:"Neue Kategorie",new_category_placeholder:"Kategoriename (z.B. Management)",manage_categories:"Kategorien verwalten",expand_all_packs:"Alle Berichte aufklappen",collapse_all_packs:"Alle Berichte zuklappen",move_category:"In Kategorie verschieben",move_category_unavailable:"Keine weitere Kategorie vorhanden",rename_category_prompt:"Neuer Kategoriename:",category_exists:"Eine Kategorie mit diesem Namen existiert bereits.",delete_category_confirm:"Diese Kategorie lschen?",delete_category_with_packs_confirm:'Kategorie "{{category}}" und alle {{count}} enthaltenen Berichtspakete lschen?',delete_empty_category:"Leere Kategorie lschen",delete_with_content:"Kategorie und enthaltene Berichtspakete lschen",default_category_protected:"Die Standard-Kategorie kann nicht gelscht werden",no_categories:"Noch keine Kategorien vorhanden.",no_packages_in_category:"In dieser Kategorie sind noch keine Pakete vorhanden.",packages:"Pakete",pages:"Seiten",export_batch:"Export starten",export_failed:"Export fehlgeschlagen.",add_page:"Seite hinzufgen",pack_settings:"Paket-Einstellungen",pick_content:"Inhalt auswhlen",select_pack:"Bitte whlen Sie ein Paket",cover_page:"Deckblatt",author:"Autor",subtitle_label:"Untertitel",title_label:"Titel",logo_url:"Logo-URL",upload_logo:"Logo hochladen",logo_upload_failed:"Logo-Upload fehlgeschlagen.",theme_color:"Farbthema",toc:"Inhaltsverzeichnis",no_packages:"Keine Pakete",general:"Allgemein",export_options:"Kopf- / Fuzeile",show_header:"Kopfzeile anzeigen",show_footer:"Fuzeile anzeigen",header_text:"Kopfzeilentext (optional)",footer_text:"Fuzeilentext (optional)",page_options:"Seitenoptionen",no_pages:"Noch keine Seiten in diesem Paket.",page_title_override:"Seitentitel-Override (optional)",landscape:"Querformat",portrait:"Hochformat",preview:"Live-Vorschau",content_page_preview:"Inhaltsseite Vorschau",page_content:"Seiteninhalt",pack_name_placeholder:"Paket Name",page:"Seite",generated_on:"Erstellt am",author_prefix:"Erstellt von"},yU={title:"Einstellungen",subtitle:"Dashboard-Konfiguration und Benachrichtigungen",tab_appearance:"Allgemein",tab_security:"Sicherheit",tab_apps:"Apps",tab_controls:"Controls",tab_inspector:"Inspector",tab_querybuilder:"Query Builder",tab_import:"Import",tab_datatable:"Data Table",tab_notifications:"Hinweise",tab_about:"Info",appearance:"Darstellung",appearance_hint:"Passe das Erscheinungsbild des Dashboards an.",language_panel_title:"Sprache",language_panel_hint:"Konfigurieren Sie die App-Sprache und die Sichtbarkeit des Sprachumschalters in der Sidebar.",language:"Sprache",language_de:"Deutsch",language_en:"Englisch",show_sidebar_language_switch:"Sprachumschalter in der Sidebar anzeigen",health_link_title:"Diagnose",health_link_hint:"Oeffnen Sie den System-Health-Check und die Diagnose-Uebersicht.",health_link_open:"Health Check oeffnen",show_sidebar_system_status:"'System-Status' in der Sidebar anzeigen",theme_light:"Hell",theme_dark:"Dunkel",theme_system:"System",inspector_title:"Data Inspector",inspector_hint:"Zentrale Standardwerte fuer den Data Inspector.",inspector_autocomplete:"SQL Autocomplete",inspector_explain:"Explain-Modus standardmaessig",inspector_sql_assist:"SQL Assist standardmaessig offen",inspector_profiling:"Datenprofil standardmaessig anzeigen",inspector_page_size:"Standard Seitengroesse",inspector_thresholds:"Profiling Schwellwerte",inspector_null_threshold:"Null-Schwelle (%)",inspector_cardinality_threshold:"Kardinalitaetsschwelle (%)",inspector_sql_safety:"SQL Sicherheit",inspector_sql_confirm_without_limit:"SELECT ohne LIMIT bestaetigen",inspector_sql_max_rows:"Maximale Zeilen pro SQL-Ausfuehrung",inspector_reset_title:"Zuruecksetzen",inspector_reset_layout:"Layout und Ansichten zuruecksetzen",inspector_reset_sql:"SQL-Verlauf und Vorlagen loeschen",inspector_reset_layout_confirm:"Data-Inspector-Layout und gespeicherte Ansichten zuruecksetzen?",inspector_reset_layout_done:"Data-Inspector-Layout und Ansichten wurden zurueckgesetzt.",inspector_reset_sql_confirm:"SQL-Verlauf, Favoriten und eigene Vorlagen loeschen?",inspector_reset_sql_done:"SQL-Verlauf, Favoriten und Vorlagen wurden geloescht.",querybuilder_title:"Query Builder",querybuilder_hint:"Standardwerte fuer den Einstieg in den Query Builder.",querybuilder_default_mode:"Standard Startmodus",querybuilder_sql_height:"SQL-Editor Hoehe (px)",import_title:"Import",import_hint:"Standardverhalten fuer Excel-Importe.",backup_hint:"Standardverhalten fuer Backup und Wiederherstellung.",import_default_mode:"Standard Importmodus",import_auto_save_mappings:"Mappings automatisch speichern",backup_name_pattern:"Backup-Dateinamenmuster",backup_name_pattern_hint:"Platzhalter: {date}, {time}, {datetime}, {mode}.",backup_use_saved_location:"Gemerkten Backup-Ordner verwenden",backup_use_saved_location_hint:"Standard: zuerst den gewhlten Backup-Ordner nutzen, danach auf Dateiauswahl zurckfallen.",backup_folder:"Backup-Ordner",backup_folder_none:"Kein Ordner ausgewhlt",backup_folder_choose:"Ordner whlen",backup_folder_not_supported:"Ihr Browser untersttzt keinen persistenten Ordnerzugriff.",backup_folder_select_error:"Ordner konnte nicht ausgewhlt werden.",datatable_title:"Data Table",datatable_hint:"Zentrale Darstellungseinstellungen fuer Tabellen.",datatable_density:"Zeilendichte",datatable_density_normal:"Normal",datatable_density_compact:"Kompakt",datatable_wrap_cells:"Lange Zellinhalte umbrechen",datatable_default_filters:"Filterzeile standardmaessig anzeigen",notifications_title:"Benachrichtigungen",notifications_hint:"Verhalten fuer Sicherheits- und Bestaetigungsdialoge.",notifications_confirm_destructive:"Destruktive Aktionen bestaetigen",log_level:"Log-Level",log_level_off:"Aus",log_level_error:"Nur Fehler",log_level_warn:"Warnungen + Fehler",log_level_info:"Info + Warnungen + Fehler",log_level_debug:"Debug (ausfuehrlich)",security:"Sicherheit",security_hint:"Schtzen Sie den Zugriff auf das Dashboard.",access_restriction_title:"Zugriffsbeschraenkung",access_restriction_hint:"Konfigurieren Sie den Sperrschutz fuer den Zugriff auf die Anwendung.",enable_pin:"PIN-Schutz aktivieren",pin_placeholder:"Neue PIN (min. 4 Stellen)",pin_error_min:"Die PIN muss mindestens 4 Stellen haben.",pin_success:"PIN-Schutz aktiviert.",pin_confirm_remove:"Mchten Sie den PIN-Schutz wirklich entfernen?",pin_active:"PIN-Schutz aktiv",pin_active_hint:"Dashboard ist gesperrt beim Neustart",admin_mode:"Admin-Modus",admin_mode_hint:"System-Tabellen (sys_) in der Auswahl anzeigen.",admin_mode_panel_hint:"Steuern Sie die Sichtbarkeit erweiterter Systemstrukturen.",admin_mode_active:"Admin-Modus aktiv",user_mode:"User-Modus",last_update:"Letzte Aktualisierung: {{date}}, {{time}}"},_U={subtitle:"Zentrale Verwaltung fr Importe, Strukturen und Systemwartung.",tab_import:"Daten-Import",tab_structure:"Struktur & Schema",tab_system:"Wartung & Backup",smart_import_title:"Neue Tabelle erstellen (Smart Import)",smart_import_hint:"Analysiert Excel-Dateien und erstellt automatisch die passenden Tabellen.",or_separator:"ODER",append_data_title:"Daten anfgen",append_data_hint:"Importieren Sie Daten in eine bestehende Tabelle.",select_target_table:"Ziel-Tabelle whlen...",user_tables:"Benutzerdefinierte Tabellen",user_tables_hint:"Verwalten Sie Ihre eigenen Tabellenstrukturen.",new_table:"Neue Tabelle",no_user_tables:"Keine eigenen Tabellen vorhanden.",user_views:"Views",user_views_hint:"SQL-Views in der lokalen Datenbank.",no_user_views:"Keine Views vorhanden.",view_type:"VIEW",show_schema:"Schema anzeigen",append_data_short:"Daten anfgen",system_tables:"System-Tabellen (Read-Only)",backup_restore:"Backup & Restore",backup_recommended:"{{count}} ungesicherte nderungen. Backup empfohlen.",encryption_active:"Verschlsselung aktiviert",encryption_standard:"Standard-Backup (Unverschlsselt)",encryption_active_hint:"Datei wird mit Passwort geschtzt.",encryption_standard_hint:"Datei ist fr jeden lesbar.",backup_password_placeholder:"Passwort fr Backup setzen...",backup_password_error:"Bitte ein sicheres Passwort angeben (min. 4 Zeichen).",save_backup_secure:"Geschtzt speichern",save_backup_standard:"Backup speichern",restore_backup:"Backup wiederherstellen",restore_from_saved_location:"Aus Backup-Ordner",restore_confirm:"Achtung: Dies berschreibt ALLE lokalen Daten! Fortfahren?",restore_invalid:"Die Backup-Datei ist ungltig oder beschdigt.",restore_missing_tables:"Folgende System-Tabellen fehlen:",restore_missing_columns:"Folgende Spalten fehlen in den Tabellen:",restore_success_reload:"Backup erfolgreich validiert und eingespielt. Die Seite wird nun neu geladen.",restore_warning_title:"Kompatibilitts-Warnung",restore_warning_hint:"Das Backup scheint aus einer lteren Version zu sein. Einige Funktionen knnten eingeschrnkt sein.",restore_encrypted_prompt:"Diese Datei scheint verschlsselt zu sein. Bitte Passwort eingeben:",restore_failed:"Entschlsselung fehlgeschlagen! Falsches Passwort oder beschdigte Datei.",danger_zone:"Gefahrenzone",danger_zone_hint:"Destruktive Aktionen  nderungen knnen nicht rckgngig gemacht werden.",clear_reset:"Daten lschen (Reset)",clear_reset_hint:"Entfernt alle Zeilen aus der gewhlten Tabelle, behlt aber die Struktur bei.",clear_btn:"Leeren",factory_reset_title:"Werkseinstellungen",factory_reset_confirm:"Bist du sicher? Alle Daten (inkl. Tabellen, Views und Indizes), Dashboards, Widgets und lokale Einstellungen werden endgueltig geloescht. Dies kann nicht rueckgaengig gemacht werden!",factory_reset_prompt:'Bitte tippe "RESET" ein, um fortzufahren:',factory_reset_success:"Datenbank und lokale Einstellungen wurden auf Werkseinstellungen zurueckgesetzt. Lade neu...",factory_reset_aborted:"Abgebrochen: Falsche Eingabe.",factory_reset_btn:"Komplett zuruecksetzen",factory_reset_hint:"Loescht die gesamte Datenbank inklusive Tabellen, Views und Indizes, setzt lokale Einstellungen zurueck und erstellt ein frisches, leeres Schema der neuesten Version.",sql_manager_reset_title:"SQL Manager zuruecksetzen",sql_manager_reset_confirm:"SQL Manager zuruecksetzen? Alle gespeicherten SQL-Statements und Favoriten werden geloescht.",sql_manager_reset_prompt:'Bitte tippe "RESET" ein, um fortzufahren:',sql_manager_reset_success:"SQL Manager wurde zurueckgesetzt.",sql_manager_reset_aborted:"Abgebrochen: Falsche Eingabe.",sql_manager_reset_btn:"SQL Manager zuruecksetzen",sql_manager_reset_hint:"Loescht alle gespeicherten SQL-Statements im SQL Manager inklusive Favoriten und Nutzungszaehlern.",clear_confirm:'Alle Daten in Tabelle "{{name}}" unwiderruflich lschen?',cleared_success:"Tabelle geleert.",drop_table_title:"Tabelle entfernen",drop_table_hint:"Lscht die komplette Tabelle inklusive Struktur. Nur fr eigene Tabellen mglich.",drop_confirm:'Tabelle "{{name}}" wirklich lschen?',drop_view_title:"View lschen",drop_view_confirm:'View "{{name}}" wirklich lschen?',create_table_title:"Neue Tabelle",assistant:"Assistent",create_btn:"Erstellen",table_created:"Tabelle erstellt!",schema_not_available:"Kein Schema verfgbar",name_label:"Name",columns_label:"Spalten",add_column:"+ Spalte",records_label:"Datenstze ({{name}})",table_meta_rows:"{{count}} Eintrge",table_meta_indexes:"{{count}} Indizes",view_invalid:"Defekter View",mappings_saved:"{{count}} Mappings gespeichert",export_mappings:"Mappings exportieren (JSON)",import_mappings:"Mappings importieren (JSON)",clear_mappings:"Alle Mappings lschen",clear_mappings_confirm:"Sind Sie sicher, dass Sie ALLE gespeicherten Mappings lschen mchten? Dies kann nicht rckgngig gemacht werden.",drop_btn:"Lschen",create_index_title:"Index erstellen",create_index_btn:"Index erstellen",index_create_for_table:"Tabelle",index_name:"Indexname",index_unique:"Eindeutiger Index (UNIQUE)",index_columns:"Spalten",index_order:"Spaltenreihenfolge",index_where_optional:"WHERE (optional)",index_create_name_required:"Bitte einen Indexnamen angeben.",index_create_columns_required:"Bitte mindestens eine Spalte auswhlen.",index_create_success:"Index erstellt.",indexes_title:"Indizes",indexes_empty:"Keine Indizes vorhanden.",indexes_columns:"Spalten",smart_import:{step_upload:"Upload",step_config:"Vorschau & Config",step_import:"Import",upload_label:"Excel-Datei auswhlen",upload_hint:"Wir analysieren die Struktur automatisch.",found_tables:"Gefundene Tabellen",found_tables_hint:"Whlen Sie aus, welche Bltter importiert werden sollen und prfen Sie die Namen.",sheet_label:"Blatt:",table_label:"Tabelle:",invalid_prefix:"Reserviertes Prfix 'sys_' nicht erlaubt.",invalid_sheet:"Ungltig",columns_count:"{{count}} Spalten erkannt",rows_count:"{{count}} Zeilen",more_columns:"+{{count}} weitere",import_running:"Importiere Daten...",done_btn:"Fertig",back_btn:"Zurck",start_import:"Import Starten",error_analyzing:"Fehler beim Analysieren der Datei.",step_success:"Abgeschlossen",import_success_title:"Import erfolgreich!",import_success_hint:"{{count}} Tabellen wurden erfolgreich angelegt und befllt.",finish_btn:"Abschlieen"},excel_import:{processing_file:"Datei wird verarbeitet...",error_reading:"Fehler beim Lesen der Datei: {{error}}",error_loading:"Datei konnte nicht geladen werden: {{error}}",no_config:"Keine Import-Konfiguration vorhanden.",no_data:"Keine Daten in der Datei gefunden.",no_valid_data:"Keine gltigen Daten zum Importieren gefunden.",import_failed:"Import fehlgeschlagen: {{error}}",success_msg:"Erfolgreich {{count}} Datenstze importiert.",append:"Hinzufgen",overwrite:"berschreiben",drop_hint:"Klicken oder Datei hierher ziehen",none_selected:"Keine Tabelle gewhlt"}},BU={title:"ber LiteBI Studio",subtitle:"Informationen zum Projekt und System",tagline:"Die leichtgewichtige Business Intelligence Plattform direkt im Browser.",status_stable:"Stabil (Lokal)",philosophy_title:"Unsere Philosophie",philosophy_description:"LiteBI Studio wurde mit dem Ziel entwickelt, Datenanalyse so einfach und sicher wie mglich zu machen. Im Gegensatz zu herkmmlichen BI-Tools verlassen Ihre Daten bei LiteBI Studio niemals Ihren Browser.",point_privacy_title:"Privacy First",point_privacy_desc:"Keine Server-Speicherung, keine Cloud-Zwnge.",point_speed_title:"Speed",point_speed_desc:"Lokale Verarbeitung mittels SQLite WASM Technologie.",point_offline_title:"Offline-Ready",point_offline_desc:"Funktioniert auch ohne aktive Internetverbindung.",tech_stack_title:"Technologie-Stack",tech_ui_framework:"UI-Framework",tech_language:"Sprache",tech_build_tool:"Build-Tool",tech_styling:"Styling",tech_local_database:"Lokale Datenbank",tech_visualization:"Visualisierung",tech_i18n:"Internationalisierung",tech_pdf_export:"PDF-Export",tech_icon_system:"Icon-System",links_title:"Links",link_github:"GitHub Repository",link_readme:"README",link_changelog:"Changelog",link_docs:"Dokumentation",link_website:"Webseite",support_title:"Support",support_text:"Haben Sie Fragen oder Feedback? Wir freuen uns ber Ihre Nachricht.",contact_cta:"Kontakt aufnehmen",copyright_prefix:"(c) {{year}} LiteBI Studio Projekt. Freigegeben unter ",settings_hint:"Erfahren Sie mehr ber das Projekt, die Version und die Vision hinter LiteBI Studio.",view_info:"Projekt-Informationen"},kU={title:"Datensatz-Details",navigation:"Navigieren",schema_definition:"Schema-Definition anzeigen",add_worklist:"Zum Arbeitsvorrat hinzufgen",remove_worklist:"Vom Arbeitsvorrat entfernen",set_reference:"Als Referenz fr Vergleich setzen",clear_reference:"Referenz-Modus beenden",deleted_badge:"GELOESCHT",status_label:"Bearbeitungsstatus",status_pending:"Offen / Neu",status_in_progress:"In Arbeit",status_error:"Fehlerhaft",status_obsolete:"Obsolet",status_done:"Abgeschlossen (OK)",comment_label:"Bemerkung / Notiz",comment_placeholder:"Geben Sie hier Ihre Notizen oder Prfungsergebnisse ein...",comparison_active:"Vergleich aktiv:",differences_relative:"Unterschiede werden relativ zu {{id}} angezeigt.",empty_value:"<leer>",pattern_email:"E-Mail",pattern_uuid:"UUID",pattern_iban:"IBAN",pattern_url:"URL",pattern_date:"Datum",suspicious:"Auffllig",close:"Schlieen"},CU={system_status:{title:"System-Status",description:"Gesundheitsstatus der Plattform",memory_usage:"Speichernutzung",load_time:"Ladezeit",heap_from:"von {{total}} MB Heap",details:"Details"},data_inspector:{title:"Data Inspector",description:"Direkter Zugriff auf Tabellendaten",records_total:"Records Gesamt",tables:"Tabellen",details:"Details"},database_status:{title:"Datenbank-Status",description:"Speichernutzung und Statistiken",last_backup:"Letztes Backup",modifications:"nderungen",records_since_backup:"Datenstze seit Backup",data_management:"Datenverwaltung",never:"Nie"},clock:{title:"Uhrzeit",description:"Einfache Uhr"},worklist:{title:"Arbeitsvorrat",description:"Statistik gemerkter Datenstze",open_tasks:"Offene Aufgaben",all_done:"Alles Erledigt",total_entries:"Gesamteintrge",open_list:"Liste ffnen"},system_health:{title:"System Diagnose & Health",tab_overview:"bersicht",tab_storage:"Speicher",tab_database:"Datenbank",app_environment:"Anwendungs-Umgebung",version:"Version",build_date:"Build-Datum",environment:"Umgebung",user_agent:"User Agent",cpu_cores:"CPU Kerne",device_memory:"Gertespeicher",memory_limit_hint:"Browser limitiert Anzeige auf max. 8GB",used_storage:"Belegter Speicher",max_available:"Maximal Verfgbar (Quota)",quota_used:"{{percent}}% des Kontingents genutzt",no_storage_info:"Keine Speicherinformationen verfgbar.",overview_db_health:"DB-Health",overview_storage_health:"Storage-Health",overview_last_backup:"Letztes Backup",overview_not_available:"Nicht verfuegbar",overview_quick_actions:"Quick Actions",overview_action_run_health:"Health Check starten",overview_action_open_storage:"Storage oeffnen",overview_action_backup:"Backup-Zentrum",overview_action_inspector:"Inspector oeffnen",opfs_title:"Origin Private File System (OPFS)",opfs_description:"Die Datenbank wird in einem isolierten, hoch-performanten Bereich des Browsers gespeichert. Dieser Speicher ist persistent, wird aber vom Browser verwaltet. Lschen von Browserdaten kann diese Datenbank entfernen.",analyzing_db:"Analysiere Datenbank...",db_size:"Logische DB-Gre",connected:"Verbunden",worker_active:"SQLite Worker aktiv",table_stats:"Tabellen-Statistik",health_check_title:"Datenbank-Health-Check",health_status_ok:"Gesund",health_status_warning:"Handlungsbedarf",health_status_error:"Kritische Probleme",health_score:"Score: {{score}} / 100",health_meta:"Checks: {{checks}} | Letzter Lauf: {{timestamp}}",severity_error:"Fehler",severity_warning:"Warnung",severity_info:"Info",recommendation_prefix:"Empfehlung:",show_details:"Details anzeigen",hide_details:"Details ausblenden",quick_fix:"Quick Fix",quick_fix_running:"Wird angewendet...",quick_fix_confirm:"Vorgeschlagene Index-Fixes jetzt anwenden?",quick_fix_success:"Quick Fix abgeschlossen. {{count}} Index(e) erstellt oder bestaetigt.",quick_fix_failed:"Quick Fix fehlgeschlagen:",quick_fix_none:"Fuer dieses Finding konnte kein automatischer Fix erzeugt werden.",client_health_title:"Umgebungs- & Einstellungs-Health",client_health_meta:"Checks: {{checks}}",client_storage_quota_critical:"Speicherkontingent kritisch hoch",client_storage_quota_high:"Speicherkontingent hoch",client_storage_quota_ok:"Speicherkontingent im gruenen Bereich",client_storage_quota_unknown:"Speicherkontingent nicht verfuegbar",client_local_storage_large:"Local-Storage-Nutzung ist hoch",client_local_storage_ok:"Local-Storage-Nutzung ist normal",client_session_storage_large:"Session-Storage-Nutzung ist hoch",client_session_storage_ok:"Session-Storage-Nutzung ist normal",client_destructive_confirm_off:"Bestaetigungen fuer destruktive Aktionen deaktiviert",client_destructive_confirm_off_detail:"Loeschen/Reset-Bestaetigungen sind ausgeschaltet.",client_destructive_confirm_on:"Bestaetigungen fuer destruktive Aktionen aktiviert",client_destructive_confirm_on_detail:"Sicherheitsbestaetigungen sind aktiv.",client_log_level_debug:"Debug-Logging aktiviert",client_log_level_debug_detail:"Ausfuehrliches Browser-Logging kann Performance kosten.",client_log_level_ok:"Log-Level ist geeignet",client_backup_missing:"Kein Backup-Zeitstempel gefunden",client_backup_missing_detail:"Erstellen Sie ein Backup, um die Wiederherstellbarkeit zu verbessern.",client_backup_exists:"Backup-Information vorhanden",user_tables:"User Tabellen",system_tables:"System Tabellen",refresh_diag:"Diagnose aktualisieren",diag_failed:"Diagnose fehlgeschlagen",retry:"Erneut versuchen"}},SU={common:pU,sidebar:gU,dashboard:mU,worklist:xU,datainspector:bU,querybuilder:vU,reports:wU,settings:yU,datasource:_U,about:BU,record_detail:kU,widgets:CU};ll.use(s3).use(jL).init({resources:{en:{translation:hU},de:{translation:SU}},fallbackLng:"en",interpolation:{escapeValue:!1},detection:{order:["localStorage","navigator"],caches:["localStorage"]}});const i3="app_log_level",sw="error",TB={off:0,error:1,warn:2,info:3,debug:4};function EU(e){return e&&(e==="off"||e==="error"||e==="warn"||e==="info"||e==="debug")?e:sw}function NU(e,t){return TB[e]>=TB[t]}function x2(){return typeof window>"u"?sw:EU(window.localStorage.getItem(i3))}function zg(e){return NU(x2(),e)}function fA(e){return{error:(...t)=>{zg("error")&&console.error(`[${e}]`,...t)},warn:(...t)=>{zg("warn")&&console.warn(`[${e}]`,...t)},info:(...t)=>{zg("info")&&console.info(`[${e}]`,...t)},debug:(...t)=>{zg("debug")&&console.debug(`[${e}]`,...t)}}}const Ob=fA("useLocalStorage");function hr(e,t){const[r,a]=X.useState(()=>{if(typeof window>"u")return t;try{const s=window.localStorage.getItem(e);if(s===null)return t;try{return JSON.parse(s)}catch{return s}}catch(s){return Ob.error("Initial read error:",s),t}});X.useEffect(()=>{const s=l=>{if(l.key===e&&l.newValue!==null)try{const A=JSON.parse(l.newValue);a(A),Ob.debug(`Synced ${e} from other tab:`,A)}catch{a(l.newValue)}};return window.addEventListener("storage",s),()=>window.removeEventListener("storage",s)},[e]);const n=X.useCallback(s=>{a(l=>{try{const A=s instanceof Function?s(l):s;if(typeof window<"u"){const u=typeof A=="string"?A:JSON.stringify(A);window.localStorage.setItem(e,u)}return A}catch(A){return Ob.error("Write error:",A),l}})},[e]);return[r,n]}const Fu=[{id:"clock",title:"Status & Uhrzeit",component:"ClockComponent",defaultSize:"small"},{id:"data-inspector",title:"Data Inspector",component:"DataInspectorComponent",targetView:"/inspector",defaultSize:"small"},{id:"system-status",title:"System Status",component:"SystemStatusComponent",defaultSize:"small"},{id:"database-status",title:"Datenbank Status",component:"DatabaseStatusComponent",defaultSize:"small"},{id:"worklist",title:"Arbeitsvorrat",component:"WorklistComponent",targetView:"/worklist",defaultSize:"medium"}],Rb=fA("DashboardContext"),l3=X.createContext(void 0),FU=({children:e})=>{const r=Array.from({length:60},(I,Q)=>`slot-${Q}`);Fu.forEach((I,Q)=>{Q<60&&(r[Q]=I.id)});const[a,n]=hr("visibleComponentIds",Fu.map(I=>I.id)),[s,l]=hr("visibleSidebarComponentIds",Fu.filter(I=>I.targetView).map(I=>I.id)),[A,u]=hr("componentOrder",r),[f,h]=hr("isSidebarCollapsed",!1),[g,x]=hr("litebistudio_last_backup",null),[m,w]=hr("litebistudio_changes_since_backup",0),v=ar.useCallback(()=>{x(new Date().toISOString()),w(0)},[x,w]);ar.useEffect(()=>{const I=Q=>{const Y=Q.detail||{};if(Y.type==="restore")Rb.debug("DB Restore detected. Resetting count to 0."),w(0),x(new Date().toISOString());else if(Y.type==="clear")Rb.debug("DB Clear detected. Incrementing count."),w(z=>z+1);else{const z=Y.count||1;Rb.debug(`DB Change detected (${Y.type}, count=${z}). New count will be based on current state.`),w(ue=>ue+z)}};return window.addEventListener("db-changed",I),()=>window.removeEventListener("db-changed",I)},[w,x]),ar.useEffect(()=>{const Q=Fu.map(Y=>Y.id).filter(Y=>!A.includes(Y));if(Q.length>0){u(z=>{const ue=[...z];let Z=0;for(let Ae=0;Ae<ue.length&&Z<Q.length;Ae++)ue[Ae].startsWith("slot-")&&(ue[Ae]=Q[Z++]);return[...ue,...Q.slice(Z)]}),n(z=>[...new Set([...z,...Q])]);const Y=Q.filter(z=>Fu.find(ue=>ue.id===z)?.targetView);Y.length>0&&l(z=>[...new Set([...z,...Y])])}},[A,u,a,n,l]);const[B,k]=ar.useState(()=>!!localStorage.getItem("litebistudio_app_pin")),N=ar.useCallback(()=>k(!0),[]),S=ar.useCallback(()=>k(!1),[]),[O,T]=ar.useState(!1),U=ar.useCallback(()=>T(I=>!I),[]),[D,H]=ar.useState(!1),[j,W]=hr("litebistudio_admin_mode",!1);return c.jsx(l3.Provider,{value:{visibleComponentIds:a,setVisibleComponentIds:n,visibleSidebarComponentIds:s,setVisibleSidebarComponentIds:l,componentOrder:A,setComponentOrder:u,isSidebarCollapsed:f,setSidebarCollapsed:h,changeCount:m,lastBackup:g,markBackupComplete:v,isLocked:B,lockApp:N,unlockApp:S,isPresentationMode:O,togglePresentationMode:U,isReadOnly:D,setIsReadOnly:H,isAdminMode:j,setIsAdminMode:W},children:e})},Mo=()=>{const e=X.useContext(l3);if(!e)throw new Error("useDashboard must be used within a DashboardProvider");return e};class TU{cache=new Map;listeners=new Map;set(t,r,a=60*1e3){this.cache.set(t,{data:r,timestamp:Date.now(),ttl:a}),this.notify(t)}get(t){const r=this.cache.get(t);return r?Date.now()-r.timestamp>r.ttl?(this.cache.delete(t),null):r.data:null}invalidate(t){this.cache.delete(t),this.notify(t)}subscribe(t,r){const a=this.listeners.get(t)||new Set;return a.add(r),this.listeners.set(t,a),()=>{const n=this.listeners.get(t);n&&(n.delete(r),n.size===0&&this.listeners.delete(t))}}notify(t){this.listeners.get(t)?.forEach(r=>r())}getStats(){return{size:this.cache.size,keys:Array.from(this.cache.keys())}}}const bh=new TU;function LU(e){if(e===null)return"null";if(e===void 0)return"undefined";if(typeof e=="string")return`str:${e}`;if(typeof e=="number")return`num:${e}`;if(typeof e=="boolean")return`bool:${e}`;if(typeof e=="bigint")return`bigint:${e.toString()}`;if(typeof e=="function")return`fn:${e.name||"anonymous"}`;try{return`json:${JSON.stringify(e)}`}catch{return`obj:${String(e)}`}}function ri(e,t=[],r={}){const{cacheKey:a,ttl:n}=r,[s,l]=X.useState(()=>a&&bh.get(a)||null),[A,u]=X.useState(()=>!(a&&bh.get(a))),[f,h]=X.useState(null),[g,x]=X.useState(0),m=X.useRef(0),w=t.map(LU).join("|"),v=X.useRef(e);X.useEffect(()=>{v.current=e});const B=X.useCallback(()=>{x(k=>k+1)},[]);return X.useEffect(()=>{let k=!0;const N=++m.current,S=async()=>{try{a&&bh.get(a)!==null||u(!0);const U=await v.current();k&&N===m.current&&(l(U),h(null),a&&bh.set(a,U,n))}catch(T){k&&N===m.current&&h(T instanceof Error?T:new Error(String(T)))}finally{k&&N===m.current&&u(!1)}};S();const O=()=>{a&&bh.invalidate(a),S()};return window.addEventListener("db-updated",O),()=>{k=!1,window.removeEventListener("db-updated",O)}},[w,g,a,n]),{data:s,loading:A,error:f,refresh:B}}function Hs(...e){return h8(p8(e))}function x0(e){return e?/^[a-zA-Z0-9_]+$/.test(e):!1}var nx={};nx.version="0.18.5";var o3=1252,UU=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],b2={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},v2=function(e){UU.indexOf(e)!=-1&&(o3=b2[0]=e)};function jU(){v2(1252)}var lA=function(e){v2(e)};function w2(){lA(1200),jU()}function LB(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function DU(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function A3(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Th=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?DU(e.slice(2)):t==254&&r==255?A3(e.slice(2)):t==65279?e.slice(1):e},Vg=function(t){return String.fromCharCode(t)},UB=function(t){return String.fromCharCode(t)},dp,Lu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function fp(e){for(var t="",r=0,a=0,n=0,s=0,l=0,A=0,u=0,f=0;f<e.length;)r=e.charCodeAt(f++),s=r>>2,a=e.charCodeAt(f++),l=(r&3)<<4|a>>4,n=e.charCodeAt(f++),A=(a&15)<<2|n>>6,u=n&63,isNaN(a)?A=u=64:isNaN(n)&&(u=64),t+=Lu.charAt(s)+Lu.charAt(l)+Lu.charAt(A)+Lu.charAt(u);return t}function ho(e){var t="",r=0,a=0,n=0,s=0,l=0,A=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)s=Lu.indexOf(e.charAt(f++)),l=Lu.indexOf(e.charAt(f++)),r=s<<2|l>>4,t+=String.fromCharCode(r),A=Lu.indexOf(e.charAt(f++)),a=(l&15)<<4|A>>2,A!==64&&(t+=String.fromCharCode(a)),u=Lu.indexOf(e.charAt(f++)),n=(A&3)<<6|u,u!==64&&(t+=String.fromCharCode(n));return t}var Zr=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Gc=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Ku(e){return Zr?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function jB(e){return Zr?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var oo=function(t){return Zr?Gc(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function qx(e){if(typeof ArrayBuffer>"u")return oo(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function Ju(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function IU(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function y2(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return y2(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var ai=Zr?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Gc(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function QU(e){for(var t=[],r=0,a=e.length+250,n=Ku(e.length+255),s=0;s<e.length;++s){var l=e.charCodeAt(s);if(l<128)n[r++]=l;else if(l<2048)n[r++]=192|l>>6&31,n[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var A=e.charCodeAt(++s)&1023;n[r++]=240|l>>8&7,n[r++]=128|l>>2&63,n[r++]=128|A>>6&15|(l&3)<<4,n[r++]=128|A&63}else n[r++]=224|l>>12&15,n[r++]=128|l>>6&63,n[r++]=128|l&63;r>a&&(t.push(n.slice(0,r)),r=0,n=Ku(65535),a=65530)}return t.push(n.slice(0,r)),ai(t)}var sl=/\u0000/g,Lh=/[\u0001-\u0006]/g;function of(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function oA(e,t){var r=""+e;return r.length>=t?r:ts("0",t-r.length)+r}function _2(e,t){var r=""+e;return r.length>=t?r:ts(" ",t-r.length)+r}function sx(e,t){var r=""+e;return r.length>=t?r:r+ts(" ",t-r.length)}function OU(e,t){var r=""+Math.round(e);return r.length>=t?r:ts("0",t-r.length)+r}function RU(e,t){var r=""+e;return r.length>=t?r:ts("0",t-r.length)+r}var DB=Math.pow(2,32);function jd(e,t){if(e>DB||e<-DB)return OU(e,t);var r=Math.round(e);return RU(r,t)}function ix(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var IB=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Mb=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function MU(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Lr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},QB={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},HU={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function lx(e,t,r){for(var a=e<0?-1:1,n=e*a,s=0,l=1,A=0,u=1,f=0,h=0,g=Math.floor(n);f<t&&(g=Math.floor(n),A=g*l+s,h=g*f+u,!(n-g<5e-8));)n=1/(n-g),s=l,l=A,u=f,f=h;if(h>t&&(f>t?(h=u,A=s):(h=f,A=l)),!r)return[0,a*A,h];var x=Math.floor(a*A/h);return[x,a*A-x*h,h]}function C0(e,t,r){if(e>2958465||e<0)return null;var a=e|0,n=Math.floor(86400*(e-a)),s=0,l=[],A={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(A.u)<1e-6&&(A.u=0),t&&t.date1904&&(a+=1462),A.u>.9999&&(A.u=0,++n==86400&&(A.T=n=0,++a,++A.D)),a===60)l=r?[1317,10,29]:[1900,2,29],s=3;else if(a===0)l=r?[1317,8,29]:[1900,1,0],s=6;else{a>60&&--a;var u=new Date(1900,0,1);u.setDate(u.getDate()+a-1),l=[u.getFullYear(),u.getMonth()+1,u.getDate()],s=u.getDay(),a<60&&(s=(s+6)%7),r&&(s=GU(u,l))}return A.y=l[0],A.m=l[1],A.d=l[2],A.S=n%60,n=Math.floor(n/60),A.M=n%60,n=Math.floor(n/60),A.H=n,A.q=s,A}var c3=new Date(1899,11,31,0,0,0),PU=c3.getTime(),KU=new Date(1900,2,1,0,0,0);function u3(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=KU&&(r+=1440*60*1e3),(r-(PU+(e.getTimezoneOffset()-c3.getTimezoneOffset())*6e4))/(1440*60*1e3)}function B2(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function qU(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function zU(e){var t=e<0?12:11,r=B2(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function VU(e){var t=B2(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function hp(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=zU(e):t===10?r=e.toFixed(10).substr(0,12):r=VU(e),B2(qU(r.toUpperCase()))}function Q0(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):hp(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Oo(14,u3(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function GU(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function WU(e,t,r,a){var n="",s=0,l=0,A=r.y,u,f=0;switch(e){case 98:A=r.y+543;case 121:switch(t.length){case 1:case 2:u=A%100,f=2;break;default:u=A%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:u=r.m,f=t.length;break;case 3:return Mb[r.m-1][1];case 5:return Mb[r.m-1][0];default:return Mb[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:u=r.d,f=t.length;break;case 3:return IB[r.q][0];default:return IB[r.q][1]}break;case 104:switch(t.length){case 1:case 2:u=1+(r.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:u=r.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:u=r.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?oA(r.S,t.length):(a>=2?l=a===3?1e3:100:l=a===1?10:1,s=Math.round(l*(r.S+r.u)),s>=60*l&&(s=0),t==="s"?s===0?"0":""+s/l:(n=oA(s,2+a),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":u=r.D*24+r.H;break;case"[m]":case"[mm]":u=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":u=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:u=A,f=1;break}var h=f>0?oA(u,f):"";return h}function Uu(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var d3=/%/g;function XU(e,t,r){var a=t.replace(d3,""),n=t.length-a.length;return Mc(e,a,r*Math.pow(10,2*n))+ts("%",n)}function YU(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Mc(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function f3(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+f3(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%n;if(s<0&&(s+=n),r=(t/Math.pow(10,s)).toPrecision(a+1+(n+s)%n),r.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(A,u,f,h){return u+f+h.substr(0,(n+s)%n)+"."+h.substr(s)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var h3=/# (\?+)( ?)\/( ?)(\d+)/;function $U(e,t,r){var a=parseInt(e[4],10),n=Math.round(t*a),s=Math.floor(n/a),l=n-s*a,A=a;return r+(s===0?"":""+s)+" "+(l===0?ts(" ",e[1].length+1+e[4].length):_2(l,e[1].length)+e[2]+"/"+e[3]+oA(A,e[4].length))}function JU(e,t,r){return r+(t===0?"":""+t)+ts(" ",e[1].length+2+e[4].length)}var p3=/^#*0*\.([0#]+)/,g3=/\).*[0#]/,m3=/\(###\) ###\\?-####/;function rl(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function OB(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function RB(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function ZU(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function ej(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Co(e,t,r){if(e.charCodeAt(0)===40&&!t.match(g3)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Co("n",a,r):"("+Co("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return YU(e,t,r);if(t.indexOf("%")!==-1)return XU(e,t,r);if(t.indexOf("E")!==-1)return f3(t,r);if(t.charCodeAt(0)===36)return"$"+Co(e,t.substr(t.charAt(1)==" "?2:1),r);var n,s,l,A,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+jd(u,t.length);if(t.match(/^[#?]+$/))return n=jd(r,0),n==="0"&&(n=""),n.length>t.length?n:rl(t.substr(0,t.length-n.length))+n;if(s=t.match(h3))return $U(s,u,f);if(t.match(/^#+0+$/))return f+jd(u,t.length-t.indexOf("0"));if(s=t.match(p3))return n=OB(r,s[1].length).replace(/^([^\.]+)$/,"$1."+rl(s[1])).replace(/\.$/,"."+rl(s[1])).replace(/\.(\d*)$/,function(w,v){return"."+v+ts("0",rl(s[1]).length-v.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return f+OB(u,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return f+Uu(jd(u,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Co(e,t,-r):Uu(""+(Math.floor(r)+ZU(r,s[1].length)))+"."+oA(RB(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Co(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=of(Co(e,t.replace(/[\\-]/g,""),r)),l=0,of(of(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return l<n.length?n.charAt(l++):w==="0"?"0":""}));if(t.match(m3))return n=Co(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var h="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),A=lx(u,Math.pow(10,l)-1,!1),n=""+f,h=Mc("n",s[1],A[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),n+=h+s[2]+"/"+s[3],h=sx(A[2],l),h.length<s[4].length&&(h=rl(s[4].substr(s[4].length-h.length))+h),n+=h,n;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),A=lx(u,Math.pow(10,l)-1,!0),f+(A[0]||(A[1]?"":"0"))+" "+(A[1]?_2(A[1],l)+s[2]+"/"+s[3]+sx(A[2],l):ts(" ",2*l+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return n=jd(r,0),t.length<=n.length?n:rl(t.substr(0,t.length-n.length))+n;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=n.indexOf(".");var g=t.indexOf(".")-l,x=t.length-n.length-g;return rl(t.substr(0,g)+n+t.substr(t.length-x))}if(s=t.match(/^00,000\.([#0]*0)$/))return l=RB(r,s[1].length),r<0?"-"+Co(e,t,-r):Uu(ej(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?oA(0,3-w.length):"")+w})+"."+oA(l,s[1].length);switch(t){case"###,##0.00":return Co(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Uu(jd(u,0));return m!=="0"?f+m:"";case"###,###.00":return Co(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Co(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function tj(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Mc(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function rj(e,t,r){var a=t.replace(d3,""),n=t.length-a.length;return Mc(e,a,r*Math.pow(10,2*n))+ts("%",n)}function x3(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+x3(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%n;if(s<0&&(s+=n),r=(t/Math.pow(10,s)).toPrecision(a+1+(n+s)%n),!r.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(A,u,f,h){return u+f+h.substr(0,(n+s)%n)+"."+h.substr(s)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function KA(e,t,r){if(e.charCodeAt(0)===40&&!t.match(g3)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?KA("n",a,r):"("+KA("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return tj(e,t,r);if(t.indexOf("%")!==-1)return rj(e,t,r);if(t.indexOf("E")!==-1)return x3(t,r);if(t.charCodeAt(0)===36)return"$"+KA(e,t.substr(t.charAt(1)==" "?2:1),r);var n,s,l,A,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+oA(u,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:rl(t.substr(0,t.length-n.length))+n;if(s=t.match(h3))return JU(s,u,f);if(t.match(/^#+0+$/))return f+oA(u,t.length-t.indexOf("0"));if(s=t.match(p3))return n=(""+r).replace(/^([^\.]+)$/,"$1."+rl(s[1])).replace(/\.$/,"."+rl(s[1])),n=n.replace(/\.(\d*)$/,function(w,v){return"."+v+ts("0",rl(s[1]).length-v.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return f+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return f+Uu(""+u);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+KA(e,t,-r):Uu(""+r)+"."+ts("0",s[1].length);if(s=t.match(/^#,#*,#0/))return KA(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=of(KA(e,t.replace(/[\\-]/g,""),r)),l=0,of(of(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return l<n.length?n.charAt(l++):w==="0"?"0":""}));if(t.match(m3))return n=KA(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var h="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),A=lx(u,Math.pow(10,l)-1,!1),n=""+f,h=Mc("n",s[1],A[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),n+=h+s[2]+"/"+s[3],h=sx(A[2],l),h.length<s[4].length&&(h=rl(s[4].substr(s[4].length-h.length))+h),n+=h,n;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),A=lx(u,Math.pow(10,l)-1,!0),f+(A[0]||(A[1]?"":"0"))+" "+(A[1]?_2(A[1],l)+s[2]+"/"+s[3]+sx(A[2],l):ts(" ",2*l+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:rl(t.substr(0,t.length-n.length))+n;if(s=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=n.indexOf(".");var g=t.indexOf(".")-l,x=t.length-n.length-g;return rl(t.substr(0,g)+n+t.substr(t.length-x))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+KA(e,t,-r):Uu(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?oA(0,3-w.length):"")+w})+"."+oA(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=Uu(""+u);return m!=="0"?f+m:"";default:if(t.match(/\.[0#?]*$/))return KA(e,t.slice(0,t.lastIndexOf(".")),r)+rl(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Mc(e,t,r){return(r|0)===r?KA(e,t,r):Co(e,t,r)}function aj(e){for(var t=[],r=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(n,a-n),n=a+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var b3=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function kf(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":ix(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(b3))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function nj(e,t,r,a){for(var n=[],s="",l=0,A="",u="t",f,h,g,x="H";l<e.length;)switch(A=e.charAt(l)){case"G":if(!ix(e,l))throw new Error("unrecognized character "+A+" in "+e);n[n.length]={t:"G",v:"General"},l+=7;break;case'"':for(s="";(g=e.charCodeAt(++l))!==34&&l<e.length;)s+=String.fromCharCode(g);n[n.length]={t:"t",v:s},++l;break;case"\\":var m=e.charAt(++l),w=m==="("||m===")"?m:"t";n[n.length]={t:w,v:m},++l;break;case"_":n[n.length]={t:"t",v:" "},l+=2;break;case"@":n[n.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(f==null&&(f=C0(t,r,e.charAt(l+1)==="2"),f==null))return"";n[n.length]={t:"X",v:e.substr(l,2)},u=A,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":A=A.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=C0(t,r),f==null))return"";for(s=A;++l<e.length&&e.charAt(l).toLowerCase()===A;)s+=A;A==="m"&&u.toLowerCase()==="h"&&(A="M"),A==="h"&&(A=x),n[n.length]={t:A,v:s},u=A;break;case"A":case"a":case"":var v={t:A,v:A};if(f==null&&(f=C0(t,r)),e.substr(l,3).toUpperCase()==="A/P"?(f!=null&&(v.v=f.H>=12?"P":"A"),v.t="T",x="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(f!=null&&(v.v=f.H>=12?"PM":"AM"),v.t="T",l+=5,x="h"):e.substr(l,5).toUpperCase()==="/"?(f!=null&&(v.v=f.H>=12?"":""),v.t="T",l+=5,x="h"):(v.t="t",++l),f==null&&v.t==="T")return"";n[n.length]=v,u=A;break;case"[":for(s=A;e.charAt(l++)!=="]"&&l<e.length;)s+=e.charAt(l);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(b3)){if(f==null&&(f=C0(t,r),f==null))return"";n[n.length]={t:"Z",v:s.toLowerCase()},u=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",kf(e)||(n[n.length]={t:"t",v:s}));break;case".":if(f!=null){for(s=A;++l<e.length&&(A=e.charAt(l))==="0";)s+=A;n[n.length]={t:"s",v:s};break}case"0":case"#":for(s=A;++l<e.length&&"0#?.,E+-%".indexOf(A=e.charAt(l))>-1;)s+=A;n[n.length]={t:"n",v:s};break;case"?":for(s=A;e.charAt(++l)===A;)s+=A;n[n.length]={t:A,v:s},u=A;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":n[n.length]={t:a===1?"t":A,v:A},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=A;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)s+=e.charAt(l);n[n.length]={t:"D",v:s};break;case" ":n[n.length]={t:A,v:A},++l;break;case"$":n[n.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(A)===-1)throw new Error("unrecognized character "+A+" in "+e);n[n.length]={t:"t",v:A},++l;break}var B=0,k=0,N;for(l=n.length-1,u="t";l>=0;--l)switch(n[l].t){case"h":case"H":n[l].t=x,u="h",B<1&&(B=1);break;case"s":(N=n[l].v.match(/\.0+$/))&&(k=Math.max(k,N[0].length-1)),B<3&&(B=3);case"d":case"y":case"M":case"e":u=n[l].t;break;case"m":u==="s"&&(n[l].t="M",B<2&&(B=2));break;case"X":break;case"Z":B<1&&n[l].v.match(/[Hh]/)&&(B=1),B<2&&n[l].v.match(/[Mm]/)&&(B=2),B<3&&n[l].v.match(/[Ss]/)&&(B=3)}switch(B){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var S="",O;for(l=0;l<n.length;++l)switch(n[l].t){case"t":case"T":case" ":case"D":break;case"X":n[l].v="",n[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[l].v=WU(n[l].t.charCodeAt(0),n[l].v,f,k),n[l].t="t";break;case"n":case"?":for(O=l+1;n[O]!=null&&((A=n[O].t)==="?"||A==="D"||(A===" "||A==="t")&&n[O+1]!=null&&(n[O+1].t==="?"||n[O+1].t==="t"&&n[O+1].v==="/")||n[l].t==="("&&(A===" "||A==="n"||A===")")||A==="t"&&(n[O].v==="/"||n[O].v===" "&&n[O+1]!=null&&n[O+1].t=="?"));)n[l].v+=n[O].v,n[O]={v:"",t:";"},++O;S+=n[l].v,l=O-1;break;case"G":n[l].t="t",n[l].v=Q0(t,r);break}var T="",U,D;if(S.length>0){S.charCodeAt(0)==40?(U=t<0&&S.charCodeAt(0)===45?-t:t,D=Mc("n",S,U)):(U=t<0&&a>1?-t:t,D=Mc("n",S,U),U<0&&n[0]&&n[0].t=="t"&&(D=D.substr(1),n[0].v="-"+n[0].v)),O=D.length-1;var H=n.length;for(l=0;l<n.length;++l)if(n[l]!=null&&n[l].t!="t"&&n[l].v.indexOf(".")>-1){H=l;break}var j=n.length;if(H===n.length&&D.indexOf("E")===-1){for(l=n.length-1;l>=0;--l)n[l]==null||"n?".indexOf(n[l].t)===-1||(O>=n[l].v.length-1?(O-=n[l].v.length,n[l].v=D.substr(O+1,n[l].v.length)):O<0?n[l].v="":(n[l].v=D.substr(0,O+1),O=-1),n[l].t="t",j=l);O>=0&&j<n.length&&(n[j].v=D.substr(0,O+1)+n[j].v)}else if(H!==n.length&&D.indexOf("E")===-1){for(O=D.indexOf(".")-1,l=H;l>=0;--l)if(!(n[l]==null||"n?".indexOf(n[l].t)===-1)){for(h=n[l].v.indexOf(".")>-1&&l===H?n[l].v.indexOf(".")-1:n[l].v.length-1,T=n[l].v.substr(h+1);h>=0;--h)O>=0&&(n[l].v.charAt(h)==="0"||n[l].v.charAt(h)==="#")&&(T=D.charAt(O--)+T);n[l].v=T,n[l].t="t",j=l}for(O>=0&&j<n.length&&(n[j].v=D.substr(0,O+1)+n[j].v),O=D.indexOf(".")+1,l=H;l<n.length;++l)if(!(n[l]==null||"n?(".indexOf(n[l].t)===-1&&l!==H)){for(h=n[l].v.indexOf(".")>-1&&l===H?n[l].v.indexOf(".")+1:0,T=n[l].v.substr(0,h);h<n[l].v.length;++h)O<D.length&&(T+=D.charAt(O++));n[l].v=T,n[l].t="t",j=l}}}for(l=0;l<n.length;++l)n[l]!=null&&"n?".indexOf(n[l].t)>-1&&(U=a>1&&t<0&&l>0&&n[l-1].v==="-"?-t:t,n[l].v=Mc(n[l].t,n[l].v,U),n[l].t="t");var W="";for(l=0;l!==n.length;++l)n[l]!=null&&(W+=n[l].v);return W}var MB=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function HB(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function sj(e,t){var r=aj(e),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(MB),A=r[1].match(MB);return HB(t,l)?[a,r[0]]:HB(t,A)?[a,r[1]]:[a,r[l!=null&&A!=null?2:1]]}return[a,s]}function Oo(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:Lr)[e],a==null&&(a=r.table&&r.table[QB[e]]||Lr[QB[e]]),a==null&&(a=HU[e]||"General");break}if(ix(a,0))return Q0(t,r);t instanceof Date&&(t=u3(t,r.date1904));var n=sj(a,t);if(ix(n[1]))return Q0(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return nj(n[1],t,r,n[0])}function Hc(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Lr[r]==null){t<0&&(t=r);continue}if(Lr[r]==e){t=r;break}}t<0&&(t=391)}return Lr[t]=e,t}function zx(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Hc(e[t],t)}function Cf(){Lr=MU()}var ij={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},v3=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function lj(e){var t=typeof e=="number"?Lr[e]:e;return t=t.replace(v3,"(\\d+)"),new RegExp("^"+t+"$")}function oj(e,t,r){var a=-1,n=-1,s=-1,l=-1,A=-1,u=-1;(t.match(v3)||[]).forEach(function(g,x){var m=parseInt(r[x+1],10);switch(g.toLowerCase().charAt(0)){case"y":a=m;break;case"d":s=m;break;case"h":l=m;break;case"s":u=m;break;case"m":l>=0?A=m:n=m;break}}),u>=0&&A==-1&&n>=0&&(A=n,n=-1);var f=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var h=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(A>=0?A:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return l==-1&&A==-1&&u==-1?f:a==-1&&n==-1&&s==-1?h:f+"T"+h}var Aj=(function(){var e={};e.version="1.2.0";function t(){for(var D=0,H=new Array(256),j=0;j!=256;++j)D=j,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,H[j]=D;return typeof Int32Array<"u"?new Int32Array(H):H}var r=t();function a(D){var H=0,j=0,W=0,I=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(W=0;W!=256;++W)I[W]=D[W];for(W=0;W!=256;++W)for(j=D[W],H=256+W;H<4096;H+=256)j=I[H]=j>>>8^D[j&255];var Q=[];for(W=1;W!=16;++W)Q[W-1]=typeof Int32Array<"u"?I.subarray(W*256,W*256+256):I.slice(W*256,W*256+256);return Q}var n=a(r),s=n[0],l=n[1],A=n[2],u=n[3],f=n[4],h=n[5],g=n[6],x=n[7],m=n[8],w=n[9],v=n[10],B=n[11],k=n[12],N=n[13],S=n[14];function O(D,H){for(var j=H^-1,W=0,I=D.length;W<I;)j=j>>>8^r[(j^D.charCodeAt(W++))&255];return~j}function T(D,H){for(var j=H^-1,W=D.length-15,I=0;I<W;)j=S[D[I++]^j&255]^N[D[I++]^j>>8&255]^k[D[I++]^j>>16&255]^B[D[I++]^j>>>24]^v[D[I++]]^w[D[I++]]^m[D[I++]]^x[D[I++]]^g[D[I++]]^h[D[I++]]^f[D[I++]]^u[D[I++]]^A[D[I++]]^l[D[I++]]^s[D[I++]]^r[D[I++]];for(W+=15;I<W;)j=j>>>8^r[(j^D[I++])&255];return~j}function U(D,H){for(var j=H^-1,W=0,I=D.length,Q=0,Y=0;W<I;)Q=D.charCodeAt(W++),Q<128?j=j>>>8^r[(j^Q)&255]:Q<2048?(j=j>>>8^r[(j^(192|Q>>6&31))&255],j=j>>>8^r[(j^(128|Q&63))&255]):Q>=55296&&Q<57344?(Q=(Q&1023)+64,Y=D.charCodeAt(W++)&1023,j=j>>>8^r[(j^(240|Q>>8&7))&255],j=j>>>8^r[(j^(128|Q>>2&63))&255],j=j>>>8^r[(j^(128|Y>>6&15|(Q&3)<<4))&255],j=j>>>8^r[(j^(128|Y&63))&255]):(j=j>>>8^r[(j^(224|Q>>12&15))&255],j=j>>>8^r[(j^(128|Q>>6&63))&255],j=j>>>8^r[(j^(128|Q&63))&255]);return~j}return e.table=r,e.bstr=O,e.buf=T,e.str=U,e})(),yr=(function(){var t={};t.version="1.2.1";function r(ae,xe){for(var fe=ae.split("/"),pe=xe.split("/"),K=0,se=0,Fe=Math.min(fe.length,pe.length);K<Fe;++K){if(se=fe[K].length-pe[K].length)return se;if(fe[K]!=pe[K])return fe[K]<pe[K]?-1:1}return fe.length-pe.length}function a(ae){if(ae.charAt(ae.length-1)=="/")return ae.slice(0,-1).indexOf("/")===-1?ae:a(ae.slice(0,-1));var xe=ae.lastIndexOf("/");return xe===-1?ae:ae.slice(0,xe+1)}function n(ae){if(ae.charAt(ae.length-1)=="/")return n(ae.slice(0,-1));var xe=ae.lastIndexOf("/");return xe===-1?ae:ae.slice(xe+1)}function s(ae,xe){typeof xe=="string"&&(xe=new Date(xe));var fe=xe.getHours();fe=fe<<6|xe.getMinutes(),fe=fe<<5|xe.getSeconds()>>>1,ae.write_shift(2,fe);var pe=xe.getFullYear()-1980;pe=pe<<4|xe.getMonth()+1,pe=pe<<5|xe.getDate(),ae.write_shift(2,pe)}function l(ae){var xe=ae.read_shift(2)&65535,fe=ae.read_shift(2)&65535,pe=new Date,K=fe&31;fe>>>=5;var se=fe&15;fe>>>=4,pe.setMilliseconds(0),pe.setFullYear(fe+1980),pe.setMonth(se-1),pe.setDate(K);var Fe=xe&31;xe>>>=5;var Re=xe&63;return xe>>>=6,pe.setHours(xe),pe.setMinutes(Re),pe.setSeconds(Fe<<1),pe}function A(ae){vi(ae,0);for(var xe={},fe=0;ae.l<=ae.length-4;){var pe=ae.read_shift(2),K=ae.read_shift(2),se=ae.l+K,Fe={};pe===21589&&(fe=ae.read_shift(1),fe&1&&(Fe.mtime=ae.read_shift(4)),K>5&&(fe&2&&(Fe.atime=ae.read_shift(4)),fe&4&&(Fe.ctime=ae.read_shift(4))),Fe.mtime&&(Fe.mt=new Date(Fe.mtime*1e3))),ae.l=se,xe[pe]=Fe}return xe}var u;function f(){return u||(u={})}function h(ae,xe){if(ae[0]==80&&ae[1]==75)return Ot(ae,xe);if((ae[0]|32)==109&&(ae[1]|32)==105)return Nt(ae,xe);if(ae.length<512)throw new Error("CFB file size "+ae.length+" < 512");var fe=3,pe=512,K=0,se=0,Fe=0,Re=0,Qe=0,Pe=[],qe=ae.slice(0,512);vi(qe,0);var pt=g(qe);switch(fe=pt[0],fe){case 3:pe=512;break;case 4:pe=4096;break;case 0:if(pt[1]==0)return Ot(ae,xe);default:throw new Error("Major Version: Expected 3 or 4 saw "+fe)}pe!==512&&(qe=ae.slice(0,pe),vi(qe,28));var et=ae.slice(0,pe);x(qe,fe);var Rt=qe.read_shift(4,"i");if(fe===3&&Rt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Rt);qe.l+=4,Fe=qe.read_shift(4,"i"),qe.l+=4,qe.chk("00100000","Mini Stream Cutoff Size: "),Re=qe.read_shift(4,"i"),K=qe.read_shift(4,"i"),Qe=qe.read_shift(4,"i"),se=qe.read_shift(4,"i");for(var Ct=-1,Qt=0;Qt<109&&(Ct=qe.read_shift(4,"i"),!(Ct<0));++Qt)Pe[Qt]=Ct;var Gt=m(ae,pe);B(Qe,se,Gt,pe,Pe);var wa=N(Gt,Fe,Pe,pe);wa[Fe].name="!Directory",K>0&&Re!==Y&&(wa[Re].name="!MiniFAT"),wa[Pe[0]].name="!FAT",wa.fat_addrs=Pe,wa.ssz=pe;var Pr={},sa=[],vs=[],Bi=[];S(Fe,wa,Gt,sa,K,Pr,vs,Re),w(vs,Bi,sa),sa.shift();var Wi={FileIndex:vs,FullPaths:Bi};return xe&&xe.raw&&(Wi.raw={header:et,sectors:Gt}),Wi}function g(ae){if(ae[ae.l]==80&&ae[ae.l+1]==75)return[0,0];ae.chk(z,"Header Signature: "),ae.l+=16;var xe=ae.read_shift(2,"u");return[ae.read_shift(2,"u"),xe]}function x(ae,xe){var fe=9;switch(ae.l+=2,fe=ae.read_shift(2)){case 9:if(xe!=3)throw new Error("Sector Shift: Expected 9 saw "+fe);break;case 12:if(xe!=4)throw new Error("Sector Shift: Expected 12 saw "+fe);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+fe)}ae.chk("0600","Mini Sector Shift: "),ae.chk("000000000000","Reserved: ")}function m(ae,xe){for(var fe=Math.ceil(ae.length/xe)-1,pe=[],K=1;K<fe;++K)pe[K-1]=ae.slice(K*xe,(K+1)*xe);return pe[fe-1]=ae.slice(fe*xe),pe}function w(ae,xe,fe){for(var pe=0,K=0,se=0,Fe=0,Re=0,Qe=fe.length,Pe=[],qe=[];pe<Qe;++pe)Pe[pe]=qe[pe]=pe,xe[pe]=fe[pe];for(;Re<qe.length;++Re)pe=qe[Re],K=ae[pe].L,se=ae[pe].R,Fe=ae[pe].C,Pe[pe]===pe&&(K!==-1&&Pe[K]!==K&&(Pe[pe]=Pe[K]),se!==-1&&Pe[se]!==se&&(Pe[pe]=Pe[se])),Fe!==-1&&(Pe[Fe]=pe),K!==-1&&pe!=Pe[pe]&&(Pe[K]=Pe[pe],qe.lastIndexOf(K)<Re&&qe.push(K)),se!==-1&&pe!=Pe[pe]&&(Pe[se]=Pe[pe],qe.lastIndexOf(se)<Re&&qe.push(se));for(pe=1;pe<Qe;++pe)Pe[pe]===pe&&(se!==-1&&Pe[se]!==se?Pe[pe]=Pe[se]:K!==-1&&Pe[K]!==K&&(Pe[pe]=Pe[K]));for(pe=1;pe<Qe;++pe)if(ae[pe].type!==0){if(Re=pe,Re!=Pe[Re])do Re=Pe[Re],xe[pe]=xe[Re]+"/"+xe[pe];while(Re!==0&&Pe[Re]!==-1&&Re!=Pe[Re]);Pe[pe]=-1}for(xe[0]+="/",pe=1;pe<Qe;++pe)ae[pe].type!==2&&(xe[pe]+="/")}function v(ae,xe,fe){for(var pe=ae.start,K=ae.size,se=[],Fe=pe;fe&&K>0&&Fe>=0;)se.push(xe.slice(Fe*Q,Fe*Q+Q)),K-=Q,Fe=y0(fe,Fe*4);return se.length===0?lt(0):ai(se).slice(0,ae.size)}function B(ae,xe,fe,pe,K){var se=Y;if(ae===Y){if(xe!==0)throw new Error("DIFAT chain shorter than expected")}else if(ae!==-1){var Fe=fe[ae],Re=(pe>>>2)-1;if(!Fe)return;for(var Qe=0;Qe<Re&&(se=y0(Fe,Qe*4))!==Y;++Qe)K.push(se);B(y0(Fe,pe-4),xe-1,fe,pe,K)}}function k(ae,xe,fe,pe,K){var se=[],Fe=[];K||(K=[]);var Re=pe-1,Qe=0,Pe=0;for(Qe=xe;Qe>=0;){K[Qe]=!0,se[se.length]=Qe,Fe.push(ae[Qe]);var qe=fe[Math.floor(Qe*4/pe)];if(Pe=Qe*4&Re,pe<4+Pe)throw new Error("FAT boundary crossed: "+Qe+" 4 "+pe);if(!ae[qe])break;Qe=y0(ae[qe],Pe)}return{nodes:se,data:ZB([Fe])}}function N(ae,xe,fe,pe){var K=ae.length,se=[],Fe=[],Re=[],Qe=[],Pe=pe-1,qe=0,pt=0,et=0,Rt=0;for(qe=0;qe<K;++qe)if(Re=[],et=qe+xe,et>=K&&(et-=K),!Fe[et]){Qe=[];var Ct=[];for(pt=et;pt>=0;){Ct[pt]=!0,Fe[pt]=!0,Re[Re.length]=pt,Qe.push(ae[pt]);var Qt=fe[Math.floor(pt*4/pe)];if(Rt=pt*4&Pe,pe<4+Rt)throw new Error("FAT boundary crossed: "+pt+" 4 "+pe);if(!ae[Qt]||(pt=y0(ae[Qt],Rt),Ct[pt]))break}se[et]={nodes:Re,data:ZB([Qe])}}return se}function S(ae,xe,fe,pe,K,se,Fe,Re){for(var Qe=0,Pe=pe.length?2:0,qe=xe[ae].data,pt=0,et=0,Rt;pt<qe.length;pt+=128){var Ct=qe.slice(pt,pt+128);vi(Ct,64),et=Ct.read_shift(2),Rt=T2(Ct,0,et-Pe),pe.push(Rt);var Qt={name:Rt,type:Ct.read_shift(1),color:Ct.read_shift(1),L:Ct.read_shift(4,"i"),R:Ct.read_shift(4,"i"),C:Ct.read_shift(4,"i"),clsid:Ct.read_shift(16),state:Ct.read_shift(4,"i"),start:0,size:0},Gt=Ct.read_shift(2)+Ct.read_shift(2)+Ct.read_shift(2)+Ct.read_shift(2);Gt!==0&&(Qt.ct=O(Ct,Ct.l-8));var wa=Ct.read_shift(2)+Ct.read_shift(2)+Ct.read_shift(2)+Ct.read_shift(2);wa!==0&&(Qt.mt=O(Ct,Ct.l-8)),Qt.start=Ct.read_shift(4,"i"),Qt.size=Ct.read_shift(4,"i"),Qt.size<0&&Qt.start<0&&(Qt.size=Qt.type=0,Qt.start=Y,Qt.name=""),Qt.type===5?(Qe=Qt.start,K>0&&Qe!==Y&&(xe[Qe].name="!StreamData")):Qt.size>=4096?(Qt.storage="fat",xe[Qt.start]===void 0&&(xe[Qt.start]=k(fe,Qt.start,xe.fat_addrs,xe.ssz)),xe[Qt.start].name=Qt.name,Qt.content=xe[Qt.start].data.slice(0,Qt.size)):(Qt.storage="minifat",Qt.size<0?Qt.size=0:Qe!==Y&&Qt.start!==Y&&xe[Qe]&&(Qt.content=v(Qt,xe[Qe].data,(xe[Re]||{}).data))),Qt.content&&vi(Qt.content,0),se[Rt]=Qt,Fe.push(Qt)}}function O(ae,xe){return new Date((lo(ae,xe+4)/1e7*Math.pow(2,32)+lo(ae,xe)/1e7-11644473600)*1e3)}function T(ae,xe){return f(),h(u.readFileSync(ae),xe)}function U(ae,xe){var fe=xe&&xe.type;switch(fe||Zr&&Buffer.isBuffer(ae)&&(fe="buffer"),fe||"base64"){case"file":return T(ae,xe);case"base64":return h(oo(ho(ae)),xe);case"binary":return h(oo(ae),xe)}return h(ae,xe)}function D(ae,xe){var fe=xe||{},pe=fe.root||"Root Entry";if(ae.FullPaths||(ae.FullPaths=[]),ae.FileIndex||(ae.FileIndex=[]),ae.FullPaths.length!==ae.FileIndex.length)throw new Error("inconsistent CFB structure");ae.FullPaths.length===0&&(ae.FullPaths[0]=pe+"/",ae.FileIndex[0]={name:pe,type:5}),fe.CLSID&&(ae.FileIndex[0].clsid=fe.CLSID),H(ae)}function H(ae){var xe="Sh33tJ5";if(!yr.find(ae,"/"+xe)){var fe=lt(4);fe[0]=55,fe[1]=fe[3]=50,fe[2]=54,ae.FileIndex.push({name:xe,type:2,content:fe,size:4,L:69,R:69,C:69}),ae.FullPaths.push(ae.FullPaths[0]+xe),j(ae)}}function j(ae,xe){D(ae);for(var fe=!1,pe=!1,K=ae.FullPaths.length-1;K>=0;--K){var se=ae.FileIndex[K];switch(se.type){case 0:pe?fe=!0:(ae.FileIndex.pop(),ae.FullPaths.pop());break;case 1:case 2:case 5:pe=!0,isNaN(se.R*se.L*se.C)&&(fe=!0),se.R>-1&&se.L>-1&&se.R==se.L&&(fe=!0);break;default:fe=!0;break}}if(!(!fe&&!xe)){var Fe=new Date(1987,1,19),Re=0,Qe=Object.create?Object.create(null):{},Pe=[];for(K=0;K<ae.FullPaths.length;++K)Qe[ae.FullPaths[K]]=!0,ae.FileIndex[K].type!==0&&Pe.push([ae.FullPaths[K],ae.FileIndex[K]]);for(K=0;K<Pe.length;++K){var qe=a(Pe[K][0]);pe=Qe[qe],pe||(Pe.push([qe,{name:n(qe).replace("/",""),type:1,clsid:Z,ct:Fe,mt:Fe,content:null}]),Qe[qe]=!0)}for(Pe.sort(function(Rt,Ct){return r(Rt[0],Ct[0])}),ae.FullPaths=[],ae.FileIndex=[],K=0;K<Pe.length;++K)ae.FullPaths[K]=Pe[K][0],ae.FileIndex[K]=Pe[K][1];for(K=0;K<Pe.length;++K){var pt=ae.FileIndex[K],et=ae.FullPaths[K];if(pt.name=n(et).replace("/",""),pt.L=pt.R=pt.C=-(pt.color=1),pt.size=pt.content?pt.content.length:0,pt.start=0,pt.clsid=pt.clsid||Z,K===0)pt.C=Pe.length>1?1:-1,pt.size=0,pt.type=5;else if(et.slice(-1)=="/"){for(Re=K+1;Re<Pe.length&&a(ae.FullPaths[Re])!=et;++Re);for(pt.C=Re>=Pe.length?-1:Re,Re=K+1;Re<Pe.length&&a(ae.FullPaths[Re])!=a(et);++Re);pt.R=Re>=Pe.length?-1:Re,pt.type=1}else a(ae.FullPaths[K+1]||"")==a(et)&&(pt.R=K+1),pt.type=2}}}function W(ae,xe){var fe=xe||{};if(fe.fileType=="mad")return Sr(ae,fe);if(j(ae),fe.fileType==="zip")return Vt(ae,fe);var pe=(function(Rt){for(var Ct=0,Qt=0,Gt=0;Gt<Rt.FileIndex.length;++Gt){var wa=Rt.FileIndex[Gt];if(wa.content){var Pr=wa.content.length;Pr>0&&(Pr<4096?Ct+=Pr+63>>6:Qt+=Pr+511>>9)}}for(var sa=Rt.FullPaths.length+3>>2,vs=Ct+7>>3,Bi=Ct+127>>7,Wi=vs+Qt+sa+Bi,rn=Wi+127>>7,ki=rn<=109?0:Math.ceil((rn-109)/127);Wi+rn+ki+127>>7>rn;)ki=++rn<=109?0:Math.ceil((rn-109)/127);var Ca=[1,ki,rn,Bi,sa,Qt,Ct,0];return Rt.FileIndex[0].size=Ct<<6,Ca[7]=(Rt.FileIndex[0].start=Ca[0]+Ca[1]+Ca[2]+Ca[3]+Ca[4]+Ca[5])+(Ca[6]+7>>3),Ca})(ae),K=lt(pe[7]<<9),se=0,Fe=0;{for(se=0;se<8;++se)K.write_shift(1,ue[se]);for(se=0;se<8;++se)K.write_shift(2,0);for(K.write_shift(2,62),K.write_shift(2,3),K.write_shift(2,65534),K.write_shift(2,9),K.write_shift(2,6),se=0;se<3;++se)K.write_shift(2,0);for(K.write_shift(4,0),K.write_shift(4,pe[2]),K.write_shift(4,pe[0]+pe[1]+pe[2]+pe[3]-1),K.write_shift(4,0),K.write_shift(4,4096),K.write_shift(4,pe[3]?pe[0]+pe[1]+pe[2]-1:Y),K.write_shift(4,pe[3]),K.write_shift(-4,pe[1]?pe[0]-1:Y),K.write_shift(4,pe[1]),se=0;se<109;++se)K.write_shift(-4,se<pe[2]?pe[1]+se:-1)}if(pe[1])for(Fe=0;Fe<pe[1];++Fe){for(;se<236+Fe*127;++se)K.write_shift(-4,se<pe[2]?pe[1]+se:-1);K.write_shift(-4,Fe===pe[1]-1?Y:Fe+1)}var Re=function(Rt){for(Fe+=Rt;se<Fe-1;++se)K.write_shift(-4,se+1);Rt&&(++se,K.write_shift(-4,Y))};for(Fe=se=0,Fe+=pe[1];se<Fe;++se)K.write_shift(-4,Ae.DIFSECT);for(Fe+=pe[2];se<Fe;++se)K.write_shift(-4,Ae.FATSECT);Re(pe[3]),Re(pe[4]);for(var Qe=0,Pe=0,qe=ae.FileIndex[0];Qe<ae.FileIndex.length;++Qe)qe=ae.FileIndex[Qe],qe.content&&(Pe=qe.content.length,!(Pe<4096)&&(qe.start=Fe,Re(Pe+511>>9)));for(Re(pe[6]+7>>3);K.l&511;)K.write_shift(-4,Ae.ENDOFCHAIN);for(Fe=se=0,Qe=0;Qe<ae.FileIndex.length;++Qe)qe=ae.FileIndex[Qe],qe.content&&(Pe=qe.content.length,!(!Pe||Pe>=4096)&&(qe.start=Fe,Re(Pe+63>>6)));for(;K.l&511;)K.write_shift(-4,Ae.ENDOFCHAIN);for(se=0;se<pe[4]<<2;++se){var pt=ae.FullPaths[se];if(!pt||pt.length===0){for(Qe=0;Qe<17;++Qe)K.write_shift(4,0);for(Qe=0;Qe<3;++Qe)K.write_shift(4,-1);for(Qe=0;Qe<12;++Qe)K.write_shift(4,0);continue}qe=ae.FileIndex[se],se===0&&(qe.start=qe.size?qe.start-1:Y);var et=se===0&&fe.root||qe.name;if(Pe=2*(et.length+1),K.write_shift(64,et,"utf16le"),K.write_shift(2,Pe),K.write_shift(1,qe.type),K.write_shift(1,qe.color),K.write_shift(-4,qe.L),K.write_shift(-4,qe.R),K.write_shift(-4,qe.C),qe.clsid)K.write_shift(16,qe.clsid,"hex");else for(Qe=0;Qe<4;++Qe)K.write_shift(4,0);K.write_shift(4,qe.state||0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,qe.start),K.write_shift(4,qe.size),K.write_shift(4,0)}for(se=1;se<ae.FileIndex.length;++se)if(qe=ae.FileIndex[se],qe.size>=4096)if(K.l=qe.start+1<<9,Zr&&Buffer.isBuffer(qe.content))qe.content.copy(K,K.l,0,qe.size),K.l+=qe.size+511&-512;else{for(Qe=0;Qe<qe.size;++Qe)K.write_shift(1,qe.content[Qe]);for(;Qe&511;++Qe)K.write_shift(1,0)}for(se=1;se<ae.FileIndex.length;++se)if(qe=ae.FileIndex[se],qe.size>0&&qe.size<4096)if(Zr&&Buffer.isBuffer(qe.content))qe.content.copy(K,K.l,0,qe.size),K.l+=qe.size+63&-64;else{for(Qe=0;Qe<qe.size;++Qe)K.write_shift(1,qe.content[Qe]);for(;Qe&63;++Qe)K.write_shift(1,0)}if(Zr)K.l=K.length;else for(;K.l<K.length;)K.write_shift(1,0);return K}function I(ae,xe){var fe=ae.FullPaths.map(function(Qe){return Qe.toUpperCase()}),pe=fe.map(function(Qe){var Pe=Qe.split("/");return Pe[Pe.length-(Qe.slice(-1)=="/"?2:1)]}),K=!1;xe.charCodeAt(0)===47?(K=!0,xe=fe[0].slice(0,-1)+xe):K=xe.indexOf("/")!==-1;var se=xe.toUpperCase(),Fe=K===!0?fe.indexOf(se):pe.indexOf(se);if(Fe!==-1)return ae.FileIndex[Fe];var Re=!se.match(Lh);for(se=se.replace(sl,""),Re&&(se=se.replace(Lh,"!")),Fe=0;Fe<fe.length;++Fe)if((Re?fe[Fe].replace(Lh,"!"):fe[Fe]).replace(sl,"")==se||(Re?pe[Fe].replace(Lh,"!"):pe[Fe]).replace(sl,"")==se)return ae.FileIndex[Fe];return null}var Q=64,Y=-2,z="d0cf11e0a1b11ae1",ue=[208,207,17,224,161,177,26,225],Z="00000000000000000000000000000000",Ae={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Y,FREESECT:-1,HEADER_SIGNATURE:z,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Z,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ve(ae,xe,fe){f();var pe=W(ae,fe);u.writeFileSync(xe,pe)}function G(ae){for(var xe=new Array(ae.length),fe=0;fe<ae.length;++fe)xe[fe]=String.fromCharCode(ae[fe]);return xe.join("")}function Se(ae,xe){var fe=W(ae,xe);switch(xe&&xe.type||"buffer"){case"file":return f(),u.writeFileSync(xe.filename,fe),fe;case"binary":return typeof fe=="string"?fe:G(fe);case"base64":return fp(typeof fe=="string"?fe:G(fe));case"buffer":if(Zr)return Buffer.isBuffer(fe)?fe:Gc(fe);case"array":return typeof fe=="string"?oo(fe):fe}return fe}var we;function F(ae){try{var xe=ae.InflateRaw,fe=new xe;if(fe._processChunk(new Uint8Array([3,0]),fe._finishFlushFlag),fe.bytesRead)we=ae;else throw new Error("zlib does not expose bytesRead")}catch(pe){console.error("cannot use native zlib: "+(pe.message||pe))}}function R(ae,xe){if(!we)return Et(ae,xe);var fe=we.InflateRaw,pe=new fe,K=pe._processChunk(ae.slice(ae.l),pe._finishFlushFlag);return ae.l+=pe.bytesRead,K}function M(ae){return we?we.deflateRawSync(ae):ht(ae)}var P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],re=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ge=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ce(ae){var xe=(ae<<1|ae<<11)&139536|(ae<<5|ae<<15)&558144;return(xe>>16|xe>>8|xe)&255}for(var de=typeof Uint8Array<"u",be=de?new Uint8Array(256):[],Le=0;Le<256;++Le)be[Le]=Ce(Le);function ie(ae,xe){var fe=be[ae&255];return xe<=8?fe>>>8-xe:(fe=fe<<8|be[ae>>8&255],xe<=16?fe>>>16-xe:(fe=fe<<8|be[ae>>16&255],fe>>>24-xe))}function _e(ae,xe){var fe=xe&7,pe=xe>>>3;return(ae[pe]|(fe<=6?0:ae[pe+1]<<8))>>>fe&3}function je(ae,xe){var fe=xe&7,pe=xe>>>3;return(ae[pe]|(fe<=5?0:ae[pe+1]<<8))>>>fe&7}function J(ae,xe){var fe=xe&7,pe=xe>>>3;return(ae[pe]|(fe<=4?0:ae[pe+1]<<8))>>>fe&15}function ze(ae,xe){var fe=xe&7,pe=xe>>>3;return(ae[pe]|(fe<=3?0:ae[pe+1]<<8))>>>fe&31}function He(ae,xe){var fe=xe&7,pe=xe>>>3;return(ae[pe]|(fe<=1?0:ae[pe+1]<<8))>>>fe&127}function ct(ae,xe,fe){var pe=xe&7,K=xe>>>3,se=(1<<fe)-1,Fe=ae[K]>>>pe;return fe<8-pe||(Fe|=ae[K+1]<<8-pe,fe<16-pe)||(Fe|=ae[K+2]<<16-pe,fe<24-pe)||(Fe|=ae[K+3]<<24-pe),Fe&se}function Xe(ae,xe,fe){var pe=xe&7,K=xe>>>3;return pe<=5?ae[K]|=(fe&7)<<pe:(ae[K]|=fe<<pe&255,ae[K+1]=(fe&7)>>8-pe),xe+3}function Ut(ae,xe,fe){var pe=xe&7,K=xe>>>3;return fe=(fe&1)<<pe,ae[K]|=fe,xe+1}function yt(ae,xe,fe){var pe=xe&7,K=xe>>>3;return fe<<=pe,ae[K]|=fe&255,fe>>>=8,ae[K+1]=fe,xe+8}function qt(ae,xe,fe){var pe=xe&7,K=xe>>>3;return fe<<=pe,ae[K]|=fe&255,fe>>>=8,ae[K+1]=fe&255,ae[K+2]=fe>>>8,xe+16}function Lt(ae,xe){var fe=ae.length,pe=2*fe>xe?2*fe:xe+5,K=0;if(fe>=xe)return ae;if(Zr){var se=jB(pe);if(ae.copy)ae.copy(se);else for(;K<ae.length;++K)se[K]=ae[K];return se}else if(de){var Fe=new Uint8Array(pe);if(Fe.set)Fe.set(ae);else for(;K<fe;++K)Fe[K]=ae[K];return Fe}return ae.length=pe,ae}function jt(ae){for(var xe=new Array(ae),fe=0;fe<ae;++fe)xe[fe]=0;return xe}function Pt(ae,xe,fe){var pe=1,K=0,se=0,Fe=0,Re=0,Qe=ae.length,Pe=de?new Uint16Array(32):jt(32);for(se=0;se<32;++se)Pe[se]=0;for(se=Qe;se<fe;++se)ae[se]=0;Qe=ae.length;var qe=de?new Uint16Array(Qe):jt(Qe);for(se=0;se<Qe;++se)Pe[K=ae[se]]++,pe<K&&(pe=K),qe[se]=0;for(Pe[0]=0,se=1;se<=pe;++se)Pe[se+16]=Re=Re+Pe[se-1]<<1;for(se=0;se<Qe;++se)Re=ae[se],Re!=0&&(qe[se]=Pe[Re+16]++);var pt=0;for(se=0;se<Qe;++se)if(pt=ae[se],pt!=0)for(Re=ie(qe[se],pe)>>pe-pt,Fe=(1<<pe+4-pt)-1;Fe>=0;--Fe)xe[Re|Fe<<pt]=pt&15|se<<4;return pe}var zt=de?new Uint16Array(512):jt(512),Jt=de?new Uint16Array(32):jt(32);if(!de){for(var It=0;It<512;++It)zt[It]=0;for(It=0;It<32;++It)Jt[It]=0}(function(){for(var ae=[],xe=0;xe<32;xe++)ae.push(5);Pt(ae,Jt,32);var fe=[];for(xe=0;xe<=143;xe++)fe.push(8);for(;xe<=255;xe++)fe.push(9);for(;xe<=279;xe++)fe.push(7);for(;xe<=287;xe++)fe.push(8);Pt(fe,zt,288)})();var xt=(function(){for(var xe=de?new Uint8Array(32768):[],fe=0,pe=0;fe<ge.length-1;++fe)for(;pe<ge[fe+1];++pe)xe[pe]=fe;for(;pe<32768;++pe)xe[pe]=29;var K=de?new Uint8Array(259):[];for(fe=0,pe=0;fe<re.length-1;++fe)for(;pe<re[fe+1];++pe)K[pe]=fe;function se(Re,Qe){for(var Pe=0;Pe<Re.length;){var qe=Math.min(65535,Re.length-Pe),pt=Pe+qe==Re.length;for(Qe.write_shift(1,+pt),Qe.write_shift(2,qe),Qe.write_shift(2,~qe&65535);qe-- >0;)Qe[Qe.l++]=Re[Pe++]}return Qe.l}function Fe(Re,Qe){for(var Pe=0,qe=0,pt=de?new Uint16Array(32768):[];qe<Re.length;){var et=Math.min(65535,Re.length-qe);if(et<10){for(Pe=Xe(Qe,Pe,+(qe+et==Re.length)),Pe&7&&(Pe+=8-(Pe&7)),Qe.l=Pe/8|0,Qe.write_shift(2,et),Qe.write_shift(2,~et&65535);et-- >0;)Qe[Qe.l++]=Re[qe++];Pe=Qe.l*8;continue}Pe=Xe(Qe,Pe,+(qe+et==Re.length)+2);for(var Rt=0;et-- >0;){var Ct=Re[qe];Rt=(Rt<<5^Ct)&32767;var Qt=-1,Gt=0;if((Qt=pt[Rt])&&(Qt|=qe&-32768,Qt>qe&&(Qt-=32768),Qt<qe))for(;Re[Qt+Gt]==Re[qe+Gt]&&Gt<250;)++Gt;if(Gt>2){Ct=K[Gt],Ct<=22?Pe=yt(Qe,Pe,be[Ct+1]>>1)-1:(yt(Qe,Pe,3),Pe+=5,yt(Qe,Pe,be[Ct-23]>>5),Pe+=3);var wa=Ct<8?0:Ct-4>>2;wa>0&&(qt(Qe,Pe,Gt-re[Ct]),Pe+=wa),Ct=xe[qe-Qt],Pe=yt(Qe,Pe,be[Ct]>>3),Pe-=3;var Pr=Ct<4?0:Ct-2>>1;Pr>0&&(qt(Qe,Pe,qe-Qt-ge[Ct]),Pe+=Pr);for(var sa=0;sa<Gt;++sa)pt[Rt]=qe&32767,Rt=(Rt<<5^Re[qe])&32767,++qe;et-=Gt-1}else Ct<=143?Ct=Ct+48:Pe=Ut(Qe,Pe,1),Pe=yt(Qe,Pe,be[Ct]),pt[Rt]=qe&32767,++qe}Pe=yt(Qe,Pe,0)-1}return Qe.l=(Pe+7)/8|0,Qe.l}return function(Qe,Pe){return Qe.length<8?se(Qe,Pe):Fe(Qe,Pe)}})();function ht(ae){var xe=lt(50+Math.floor(ae.length*1.1)),fe=xt(ae,xe);return xe.slice(0,fe)}var Bt=de?new Uint16Array(32768):jt(32768),pr=de?new Uint16Array(32768):jt(32768),$t=de?new Uint16Array(128):jt(128),Ee=1,at=1;function it(ae,xe){var fe=ze(ae,xe)+257;xe+=5;var pe=ze(ae,xe)+1;xe+=5;var K=J(ae,xe)+4;xe+=4;for(var se=0,Fe=de?new Uint8Array(19):jt(19),Re=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Qe=1,Pe=de?new Uint8Array(8):jt(8),qe=de?new Uint8Array(8):jt(8),pt=Fe.length,et=0;et<K;++et)Fe[P[et]]=se=je(ae,xe),Qe<se&&(Qe=se),Pe[se]++,xe+=3;var Rt=0;for(Pe[0]=0,et=1;et<=Qe;++et)qe[et]=Rt=Rt+Pe[et-1]<<1;for(et=0;et<pt;++et)(Rt=Fe[et])!=0&&(Re[et]=qe[Rt]++);var Ct=0;for(et=0;et<pt;++et)if(Ct=Fe[et],Ct!=0){Rt=be[Re[et]]>>8-Ct;for(var Qt=(1<<7-Ct)-1;Qt>=0;--Qt)$t[Rt|Qt<<Ct]=Ct&7|et<<3}var Gt=[];for(Qe=1;Gt.length<fe+pe;)switch(Rt=$t[He(ae,xe)],xe+=Rt&7,Rt>>>=3){case 16:for(se=3+_e(ae,xe),xe+=2,Rt=Gt[Gt.length-1];se-- >0;)Gt.push(Rt);break;case 17:for(se=3+je(ae,xe),xe+=3;se-- >0;)Gt.push(0);break;case 18:for(se=11+He(ae,xe),xe+=7;se-- >0;)Gt.push(0);break;default:Gt.push(Rt),Qe<Rt&&(Qe=Rt);break}var wa=Gt.slice(0,fe),Pr=Gt.slice(fe);for(et=fe;et<286;++et)wa[et]=0;for(et=pe;et<30;++et)Pr[et]=0;return Ee=Pt(wa,Bt,286),at=Pt(Pr,pr,30),xe}function bt(ae,xe){if(ae[0]==3&&!(ae[1]&3))return[Ku(xe),2];for(var fe=0,pe=0,K=jB(xe||1<<18),se=0,Fe=K.length>>>0,Re=0,Qe=0;(pe&1)==0;){if(pe=je(ae,fe),fe+=3,pe>>>1)pe>>1==1?(Re=9,Qe=5):(fe=it(ae,fe),Re=Ee,Qe=at);else{fe&7&&(fe+=8-(fe&7));var Pe=ae[fe>>>3]|ae[(fe>>>3)+1]<<8;if(fe+=32,Pe>0)for(!xe&&Fe<se+Pe&&(K=Lt(K,se+Pe),Fe=K.length);Pe-- >0;)K[se++]=ae[fe>>>3],fe+=8;continue}for(;;){!xe&&Fe<se+32767&&(K=Lt(K,se+32767),Fe=K.length);var qe=ct(ae,fe,Re),pt=pe>>>1==1?zt[qe]:Bt[qe];if(fe+=pt&15,pt>>>=4,(pt>>>8&255)===0)K[se++]=pt;else{if(pt==256)break;pt-=257;var et=pt<8?0:pt-4>>2;et>5&&(et=0);var Rt=se+re[pt];et>0&&(Rt+=ct(ae,fe,et),fe+=et),qe=ct(ae,fe,Qe),pt=pe>>>1==1?Jt[qe]:pr[qe],fe+=pt&15,pt>>>=4;var Ct=pt<4?0:pt-2>>1,Qt=ge[pt];for(Ct>0&&(Qt+=ct(ae,fe,Ct),fe+=Ct),!xe&&Fe<Rt&&(K=Lt(K,Rt+100),Fe=K.length);se<Rt;)K[se]=K[se-Qt],++se}}}return xe?[K,fe+7>>>3]:[K.slice(0,se),fe+7>>>3]}function Et(ae,xe){var fe=ae.slice(ae.l||0),pe=bt(fe,xe);return ae.l+=pe[1],pe[0]}function mt(ae,xe){if(ae)typeof console<"u"&&console.error(xe);else throw new Error(xe)}function Ot(ae,xe){var fe=ae;vi(fe,0);var pe=[],K=[],se={FileIndex:pe,FullPaths:K};D(se,{root:xe.root});for(var Fe=fe.length-4;(fe[Fe]!=80||fe[Fe+1]!=75||fe[Fe+2]!=5||fe[Fe+3]!=6)&&Fe>=0;)--Fe;fe.l=Fe+4,fe.l+=4;var Re=fe.read_shift(2);fe.l+=6;var Qe=fe.read_shift(4);for(fe.l=Qe,Fe=0;Fe<Re;++Fe){fe.l+=20;var Pe=fe.read_shift(4),qe=fe.read_shift(4),pt=fe.read_shift(2),et=fe.read_shift(2),Rt=fe.read_shift(2);fe.l+=8;var Ct=fe.read_shift(4),Qt=A(fe.slice(fe.l+pt,fe.l+pt+et));fe.l+=pt+et+Rt;var Gt=fe.l;fe.l=Ct+4,Ur(fe,Pe,qe,se,Qt),fe.l=Gt}return se}function Ur(ae,xe,fe,pe,K){ae.l+=2;var se=ae.read_shift(2),Fe=ae.read_shift(2),Re=l(ae);if(se&8257)throw new Error("Unsupported ZIP encryption");for(var Qe=ae.read_shift(4),Pe=ae.read_shift(4),qe=ae.read_shift(4),pt=ae.read_shift(2),et=ae.read_shift(2),Rt="",Ct=0;Ct<pt;++Ct)Rt+=String.fromCharCode(ae[ae.l++]);if(et){var Qt=A(ae.slice(ae.l,ae.l+et));(Qt[21589]||{}).mt&&(Re=Qt[21589].mt),((K||{})[21589]||{}).mt&&(Re=K[21589].mt)}ae.l+=et;var Gt=ae.slice(ae.l,ae.l+Pe);switch(Fe){case 8:Gt=R(ae,qe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Fe)}var wa=!1;se&8&&(Qe=ae.read_shift(4),Qe==134695760&&(Qe=ae.read_shift(4),wa=!0),Pe=ae.read_shift(4),qe=ae.read_shift(4)),Pe!=xe&&mt(wa,"Bad compressed size: "+xe+" != "+Pe),qe!=fe&&mt(wa,"Bad uncompressed size: "+fe+" != "+qe),Hr(pe,Rt,Gt,{unsafe:!0,mt:Re})}function Vt(ae,xe){var fe=xe||{},pe=[],K=[],se=lt(1),Fe=fe.compression?8:0,Re=0,Qe=0,Pe=0,qe=0,pt=0,et=ae.FullPaths[0],Rt=et,Ct=ae.FileIndex[0],Qt=[],Gt=0;for(Qe=1;Qe<ae.FullPaths.length;++Qe)if(Rt=ae.FullPaths[Qe].slice(et.length),Ct=ae.FileIndex[Qe],!(!Ct.size||!Ct.content||Rt=="Sh33tJ5")){var wa=qe,Pr=lt(Rt.length);for(Pe=0;Pe<Rt.length;++Pe)Pr.write_shift(1,Rt.charCodeAt(Pe)&127);Pr=Pr.slice(0,Pr.l),Qt[pt]=Aj.buf(Ct.content,0);var sa=Ct.content;Fe==8&&(sa=M(sa)),se=lt(30),se.write_shift(4,67324752),se.write_shift(2,20),se.write_shift(2,Re),se.write_shift(2,Fe),Ct.mt?s(se,Ct.mt):se.write_shift(4,0),se.write_shift(-4,Qt[pt]),se.write_shift(4,sa.length),se.write_shift(4,Ct.content.length),se.write_shift(2,Pr.length),se.write_shift(2,0),qe+=se.length,pe.push(se),qe+=Pr.length,pe.push(Pr),qe+=sa.length,pe.push(sa),se=lt(46),se.write_shift(4,33639248),se.write_shift(2,0),se.write_shift(2,20),se.write_shift(2,Re),se.write_shift(2,Fe),se.write_shift(4,0),se.write_shift(-4,Qt[pt]),se.write_shift(4,sa.length),se.write_shift(4,Ct.content.length),se.write_shift(2,Pr.length),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(4,0),se.write_shift(4,wa),Gt+=se.l,K.push(se),Gt+=Pr.length,K.push(Pr),++pt}return se=lt(22),se.write_shift(4,101010256),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,pt),se.write_shift(2,pt),se.write_shift(4,Gt),se.write_shift(4,qe),se.write_shift(2,0),ai([ai(pe),ai(K),se])}var tt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Wt(ae,xe){if(ae.ctype)return ae.ctype;var fe=ae.name||"",pe=fe.match(/\.([^\.]+)$/);return pe&&tt[pe[1]]||xe&&(pe=(fe=xe).match(/[\.\\]([^\.\\])+$/),pe&&tt[pe[1]])?tt[pe[1]]:"application/octet-stream"}function Me(ae){for(var xe=fp(ae),fe=[],pe=0;pe<xe.length;pe+=76)fe.push(xe.slice(pe,pe+76));return fe.join(`\r
`)+`\r
`}function kt(ae){var xe=ae.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Pe){var qe=Pe.charCodeAt(0).toString(16).toUpperCase();return"="+(qe.length==1?"0"+qe:qe)});xe=xe.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),xe.charAt(0)==`
`&&(xe="=0D"+xe.slice(1)),xe=xe.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var fe=[],pe=xe.split(`\r
`),K=0;K<pe.length;++K){var se=pe[K];if(se.length==0){fe.push("");continue}for(var Fe=0;Fe<se.length;){var Re=76,Qe=se.slice(Fe,Fe+Re);Qe.charAt(Re-1)=="="?Re--:Qe.charAt(Re-2)=="="?Re-=2:Qe.charAt(Re-3)=="="&&(Re-=3),Qe=se.slice(Fe,Fe+Re),Fe+=Re,Fe<se.length&&(Qe+="="),fe.push(Qe)}}return fe.join(`\r
`)}function Tt(ae){for(var xe=[],fe=0;fe<ae.length;++fe){for(var pe=ae[fe];fe<=ae.length&&pe.charAt(pe.length-1)=="=";)pe=pe.slice(0,pe.length-1)+ae[++fe];xe.push(pe)}for(var K=0;K<xe.length;++K)xe[K]=xe[K].replace(/[=][0-9A-Fa-f]{2}/g,function(se){return String.fromCharCode(parseInt(se.slice(1),16))});return oo(xe.join(`\r
`))}function ir(ae,xe,fe){for(var pe="",K="",se="",Fe,Re=0;Re<10;++Re){var Qe=xe[Re];if(!Qe||Qe.match(/^\s*$/))break;var Pe=Qe.match(/^(.*?):\s*([^\s].*)$/);if(Pe)switch(Pe[1].toLowerCase()){case"content-location":pe=Pe[2].trim();break;case"content-type":se=Pe[2].trim();break;case"content-transfer-encoding":K=Pe[2].trim();break}}switch(++Re,K.toLowerCase()){case"base64":Fe=oo(ho(xe.slice(Re).join("")));break;case"quoted-printable":Fe=Tt(xe.slice(Re));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+K)}var qe=Hr(ae,pe.slice(fe.length),Fe,{unsafe:!0});se&&(qe.ctype=se)}function Nt(ae,xe){if(G(ae.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var fe=xe&&xe.root||"",pe=(Zr&&Buffer.isBuffer(ae)?ae.toString("binary"):G(ae)).split(`\r
`),K=0,se="";for(K=0;K<pe.length;++K)if(se=pe[K],!!/^Content-Location:/i.test(se)&&(se=se.slice(se.indexOf("file")),fe||(fe=se.slice(0,se.lastIndexOf("/")+1)),se.slice(0,fe.length)!=fe))for(;fe.length>0&&(fe=fe.slice(0,fe.length-1),fe=fe.slice(0,fe.lastIndexOf("/")+1),se.slice(0,fe.length)!=fe););var Fe=(pe[1]||"").match(/boundary="(.*?)"/);if(!Fe)throw new Error("MAD cannot find boundary");var Re="--"+(Fe[1]||""),Qe=[],Pe=[],qe={FileIndex:Qe,FullPaths:Pe};D(qe);var pt,et=0;for(K=0;K<pe.length;++K){var Rt=pe[K];Rt!==Re&&Rt!==Re+"--"||(et++&&ir(qe,pe.slice(pt,K),fe),pt=K)}return qe}function Sr(ae,xe){var fe=xe||{},pe=fe.boundary||"SheetJS";pe="------="+pe;for(var K=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+pe.slice(2)+'"',"","",""],se=ae.FullPaths[0],Fe=se,Re=ae.FileIndex[0],Qe=1;Qe<ae.FullPaths.length;++Qe)if(Fe=ae.FullPaths[Qe].slice(se.length),Re=ae.FileIndex[Qe],!(!Re.size||!Re.content||Fe=="Sh33tJ5")){Fe=Fe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Gt){return"_x"+Gt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Gt){return"_u"+Gt.charCodeAt(0).toString(16)+"_"});for(var Pe=Re.content,qe=Zr&&Buffer.isBuffer(Pe)?Pe.toString("binary"):G(Pe),pt=0,et=Math.min(1024,qe.length),Rt=0,Ct=0;Ct<=et;++Ct)(Rt=qe.charCodeAt(Ct))>=32&&Rt<128&&++pt;var Qt=pt>=et*4/5;K.push(pe),K.push("Content-Location: "+(fe.root||"file:///C:/SheetJS/")+Fe),K.push("Content-Transfer-Encoding: "+(Qt?"quoted-printable":"base64")),K.push("Content-Type: "+Wt(Re,Fe)),K.push(""),K.push(Qt?kt(qe):Me(qe))}return K.push(pe+`--\r
`),K.join(`\r
`)}function ca(ae){var xe={};return D(xe,ae),xe}function Hr(ae,xe,fe,pe){var K=pe&&pe.unsafe;K||D(ae);var se=!K&&yr.find(ae,xe);if(!se){var Fe=ae.FullPaths[0];xe.slice(0,Fe.length)==Fe?Fe=xe:(Fe.slice(-1)!="/"&&(Fe+="/"),Fe=(Fe+xe).replace("//","/")),se={name:n(xe),type:2},ae.FileIndex.push(se),ae.FullPaths.push(Fe),K||yr.utils.cfb_gc(ae)}return se.content=fe,se.size=fe?fe.length:0,pe&&(pe.CLSID&&(se.clsid=pe.CLSID),pe.mt&&(se.mt=pe.mt),pe.ct&&(se.ct=pe.ct)),se}function Br(ae,xe){D(ae);var fe=yr.find(ae,xe);if(fe){for(var pe=0;pe<ae.FileIndex.length;++pe)if(ae.FileIndex[pe]==fe)return ae.FileIndex.splice(pe,1),ae.FullPaths.splice(pe,1),!0}return!1}function jr(ae,xe,fe){D(ae);var pe=yr.find(ae,xe);if(pe){for(var K=0;K<ae.FileIndex.length;++K)if(ae.FileIndex[K]==pe)return ae.FileIndex[K].name=n(fe),ae.FullPaths[K]=fe,!0}return!1}function Er(ae){j(ae,!0)}return t.find=I,t.read=U,t.parse=h,t.write=Se,t.writeFile=ve,t.utils={cfb_new:ca,cfb_add:Hr,cfb_del:Br,cfb_mov:jr,cfb_gc:Er,ReadShift:qh,CheckField:P3,prep_blob:vi,bconcat:ai,use_zlib:F,_deflateRaw:ht,_inflateRaw:Et,consts:Ae},t})();function cj(e){return typeof e=="string"?qx(e):Array.isArray(e)?IU(e):e}function Dp(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=qx(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?ec(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var n=new Blob([cj(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs<"u")return saveAs(n,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=s,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var A=File(e);return A.open("w"),A.encoding="binary",Array.isArray(t)&&(t=Ju(t)),A.write(t),A.close(),t}catch(u){if(!u.message||!u.message.match(/onstruct/))throw u}throw new Error("cannot save file "+e)}function uj(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function as(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function PB(e,t){for(var r=[],a=as(e),n=0;n!==a.length;++n)r[e[a[n]][t]]==null&&(r[e[a[n]][t]]=a[n]);return r}function Vx(e){for(var t=[],r=as(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function Gx(e){for(var t=[],r=as(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function dj(e){for(var t=[],r=as(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var ox=new Date(1899,11,30,0,0,0);function zs(e,t){var r=e.getTime(),a=ox.getTime()+(e.getTimezoneOffset()-ox.getTimezoneOffset())*6e4;return(r-a)/(1440*60*1e3)}var w3=new Date,fj=ox.getTime()+(w3.getTimezoneOffset()-ox.getTimezoneOffset())*6e4,KB=w3.getTimezoneOffset();function Wx(e){var t=new Date;return t.setTime(e*24*60*60*1e3+fj),t.getTimezoneOffset()!==KB&&t.setTime(t.getTime()+(t.getTimezoneOffset()-KB)*6e4),t}function hj(e){var t=0,r=0,a=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=n.length;++s)if(n[s]){switch(r=1,s>3&&(a=!0),n[s].slice(n[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[s].slice(n[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(n[s],10)}return t}var qB=new Date("2017-02-19T19:06:09.000Z"),y3=isNaN(qB.getFullYear())?new Date("2/19/17"):qB,pj=y3.getFullYear()==2017;function Bn(e,t){var r=new Date(e);if(pj)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(y3.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function O0(e,t){if(Zr&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return ec(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return ec(A3(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return ec(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return ec(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function kn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=kn(e[r]));return t}function ts(e,t){for(var r="";r.length<t;)r+=e;return r}function AA(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,s){return r=-r,s}),!isNaN(t=Number(a)))?t/r:t}var gj=["january","february","march","april","may","june","july","august","september","october","november","december"];function xf(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),n=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&gj.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||s>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var mj=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,n){if(e||typeof a=="string")return r.split(a);for(var s=r.split(a),l=[s[0]],A=1;A<s.length;++A)l.push(n),l.push(s[A]);return l}})();function _3(e){return e?e.content&&e.type?O0(e.content,!0):e.data?Th(e.data):e.asNodeBuffer&&Zr?Th(e.asNodeBuffer().toString("binary")):e.asBinary?Th(e.asBinary()):e._data&&e._data.getContent?Th(O0(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function B3(e){if(!e)return null;if(e.data)return LB(e.data);if(e.asNodeBuffer&&Zr)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?LB(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function xj(e){return e&&e.name.slice(-4)===".bin"?B3(e):_3(e)}function No(e,t){for(var r=e.FullPaths||as(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),s=0;s<r.length;++s){var l=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==l||n==l)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function k2(e,t){var r=No(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Ns(e,t,r){if(!r)return xj(k2(e,t));if(!t)return null;try{return Ns(e,t)}catch{return null}}function Ao(e,t,r){if(!r)return _3(k2(e,t));if(!t)return null;try{return Ao(e,t)}catch{return null}}function bj(e,t,r){return B3(k2(e,t))}function zB(e){for(var t=e.FullPaths||as(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function Yr(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return Zr?a=Gc(r):a=QU(r),yr.utils.cfb_add(e,t,a)}yr.utils.cfb_add(e,t,r)}else e.file(t,r)}function C2(){return yr.utils.cfb_new()}function k3(e,t){switch(t.type){case"base64":return yr.read(e,{type:"base64"});case"binary":return yr.read(e,{type:"binary"});case"buffer":case"array":return yr.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Uh(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var n=a.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var bs=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,vj=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,VB=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,wj=/<[^>]*>/g,Gi=bs.match(VB)?VB:wj,yj=/<\w*:/,_j=/<(\/?)\w+:/;function Qr(e,t,r){for(var a={},n=0,s=0;n!==e.length&&!((s=e.charCodeAt(n))===32||s===10||s===13);++n);if(t||(a[0]=e.slice(0,n)),n===e.length)return a;var l=e.match(vj),A=0,u="",f=0,h="",g="",x=1;if(l)for(f=0;f!=l.length;++f){for(g=l[f],s=0;s!=g.length&&g.charCodeAt(s)!==61;++s);for(h=g.slice(0,s).trim();g.charCodeAt(s+1)==32;)++s;for(x=(n=g.charCodeAt(s+1))==34||n==39?1:0,u=g.slice(s+1+x,g.length-x),A=0;A!=h.length&&h.charCodeAt(A)!==58;++A);if(A===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),a[h]=u,a[h.toLowerCase()]=u;else{var m=(A===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(A+1);if(a[m]&&h.slice(A-3,A)=="ext")continue;a[m]=u,a[m.toLowerCase()]=u}}return a}function ac(e){return e.replace(_j,"<$1")}var C3={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},S2=Vx(C3),Ba=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var n=a+"",s=n.indexOf("<![CDATA[");if(s==-1)return n.replace(e,function(A,u){return C3[A]||String.fromCharCode(parseInt(u,A.indexOf("x")>-1?16:10))||A}).replace(t,function(A,u){return String.fromCharCode(parseInt(u,16))});var l=n.indexOf("]]>");return r(n.slice(0,s))+n.slice(s+9,l)+r(n.slice(l+3))}})(),E2=/[&<>'"]/g,Bj=/[\u0000-\u0008\u000b-\u001f]/g;function Va(e){var t=e+"";return t.replace(E2,function(r){return S2[r]}).replace(Bj,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function GB(e){return Va(e).replace(/ /g,"_x0020_")}var S3=/[\u0000-\u001f]/g;function N2(e){var t=e+"";return t.replace(E2,function(r){return S2[r]}).replace(/\n/g,"<br/>").replace(S3,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function kj(e){var t=e+"";return t.replace(E2,function(r){return S2[r]}).replace(S3,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var WB=(function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}})();function Cj(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function yn(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Hb(e){for(var t="",r=0,a=0,n=0,s=0,l=0,A=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(n=e.charCodeAt(r++),a>191&&a<224){l=(a&31)<<6,l|=n&63,t+=String.fromCharCode(l);continue}if(s=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(n&63)<<6|s&63);continue}l=e.charCodeAt(r++),A=((a&7)<<18|(n&63)<<12|(s&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(A>>>10&1023)),t+=String.fromCharCode(56320+(A&1023))}return t}function XB(e){var t=Ku(2*e.length),r,a,n=1,s=0,l=0,A;for(a=0;a<e.length;a+=n)n=1,(A=e.charCodeAt(a))<128?r=A:A<224?(r=(A&31)*64+(e.charCodeAt(a+1)&63),n=2):A<240?(r=(A&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),n=3):(n=4,r=(A&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(t[s++]=l&255,t[s++]=l>>>8,l=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function YB(e){return Gc(e,"binary").toString("utf8")}var Gg="foo bar baz",en=Zr&&(YB(Gg)==Hb(Gg)&&YB||XB(Gg)==Hb(Gg)&&XB)||Hb,ec=Zr?function(e){return Gc(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,n=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},pp=(function(){var e={};return function(r,a){var n=r+"|"+(a||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}})(),E3=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}})(),Sj=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),Ej=/<\/?(?:vt:)?variant>/g,Nj=/<(?:vt:)([^>]*)>([\s\S]*)</;function $B(e,t){var r=Qr(e),a=e.match(Sj(r.baseType))||[],n=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return n}return a.forEach(function(s){var l=s.replace(Ej,"").match(Nj);l&&n.push({v:en(l[2]),t:l[1]})}),n}var N3=/(^\s|\s$|\n)/;function wi(e,t){return"<"+e+(t.match(N3)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function gp(e){return as(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Mt(e,t,r){return"<"+e+(r!=null?gp(r):"")+(t!=null?(t.match(N3)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function iw(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function Fj(e,t){switch(typeof e){case"string":var r=Mt("vt:lpwstr",Va(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Mt((e|0)==e?"vt:i4":"vt:r8",Va(String(e)));case"boolean":return Mt("vt:bool",e?"true":"false")}if(e instanceof Date)return Mt("vt:filetime",iw(e));throw new Error("Unable to serialize "+e)}function F2(e){if(Zr&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return en(Ju(y2(e)));throw new Error("Bad input format: expected Buffer or string")}var mp=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,qs={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},z0=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],io={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Tj(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,s=5;s>=0;--s)n=n*256+e[t+s];return a==2047?n==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),r*Math.pow(2,a-52)*n)}function Lj(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,n=0,s=0,l=a?-t:t;isFinite(l)?l==0?n=s=0:(n=Math.floor(Math.log(l)/Math.LN2),s=l*Math.pow(2,52-n),n<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?n=-1022:(s-=Math.pow(2,52),n+=1023)):(n=2047,s=isNaN(t)?26985:0);for(var A=0;A<=5;++A,s/=256)e[r+A]=s&255;e[r+6]=(n&15)<<4|s&15,e[r+7]=n>>4|a}var JB=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,s=e[0][a].length;n<s;n+=r)t.push.apply(t,e[0][a].slice(n,n+r));return t},ZB=Zr?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Gc(t)})):JB(e)}:JB,e4=function(e,t,r){for(var a=[],n=t;n<r;n+=2)a.push(String.fromCharCode(Rc(e,n)));return a.join("").replace(sl,"")},T2=Zr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(sl,""):e4(e,t,r)}:e4,t4=function(e,t,r){for(var a=[],n=t;n<t+r;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},F3=Zr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):t4(e,t,r)}:t4,r4=function(e,t,r){for(var a=[],n=t;n<r;n++)a.push(String.fromCharCode(Wd(e,n)));return a.join("")},Ip=Zr?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):r4(t,r,a)}:r4,T3=function(e,t){var r=lo(e,t);return r>0?Ip(e,t+4,t+4+r-1):""},L3=T3,U3=function(e,t){var r=lo(e,t);return r>0?Ip(e,t+4,t+4+r-1):""},j3=U3,D3=function(e,t){var r=2*lo(e,t);return r>0?Ip(e,t+4,t+4+r-1):""},I3=D3,Q3=function(t,r){var a=lo(t,r);return a>0?T2(t,r+4,r+4+a):""},O3=Q3,R3=function(e,t){var r=lo(e,t);return r>0?Ip(e,t+4,t+4+r):""},M3=R3,H3=function(e,t){return Tj(e,t)},Ax=H3,L2=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Zr&&(L3=function(t,r){if(!Buffer.isBuffer(t))return T3(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},j3=function(t,r){if(!Buffer.isBuffer(t))return U3(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},I3=function(t,r){if(!Buffer.isBuffer(t))return D3(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},O3=function(t,r){if(!Buffer.isBuffer(t))return Q3(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},M3=function(t,r){if(!Buffer.isBuffer(t))return R3(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},Ax=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):H3(t,r)},L2=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Wd=function(e,t){return e[t]},Rc=function(e,t){return e[t+1]*256+e[t]},Uj=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},lo=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},y0=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},jj=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function qh(e,t){var r="",a,n,s=[],l,A,u,f;switch(t){case"dbcs":if(f=this.l,Zr&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)r+=String.fromCharCode(Rc(this,f)),f+=2;e*=2;break;case"utf8":r=Ip(this,this.l,this.l+e);break;case"utf16le":e*=2,r=T2(this,this.l,this.l+e);break;case"wstr":return qh.call(this,e,"dbcs");case"lpstr-ansi":r=L3(this,this.l),e=4+lo(this,this.l);break;case"lpstr-cp":r=j3(this,this.l),e=4+lo(this,this.l);break;case"lpwstr":r=I3(this,this.l),e=4+2*lo(this,this.l);break;case"lpp4":e=4+lo(this,this.l),r=O3(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+lo(this,this.l),r=M3(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(l=Wd(this,this.l+e++))!==0;)s.push(Vg(l));r=s.join("");break;case"_wstr":for(e=0,r="";(l=Rc(this,this.l+e))!==0;)s.push(Vg(l)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",f=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return l=Wd(this,f),this.l=f+1,A=qh.call(this,e-u,l?"dbcs-cont":"sbcs-cont"),s.join("")+A;s.push(Vg(Rc(this,f))),f+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",f=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return l=Wd(this,f),this.l=f+1,A=qh.call(this,e-u,l?"dbcs-cont":"sbcs-cont"),s.join("")+A;s.push(Vg(Wd(this,f))),f+=1}r=s.join("");break;default:switch(e){case 1:return a=Wd(this,this.l),this.l++,a;case 2:return a=(t==="i"?Uj:Rc)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(a=(e>0?y0:jj)(this,this.l),this.l+=4,a):(n=lo(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=Ax(this,this.l):n=Ax([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=F3(this,this.l,e);break}}return this.l+=e,r}var Dj=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Ij=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Qj=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Oj(e,t,r){var a=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)Qj(this,t.charCodeAt(n),this.l+2*n);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;a=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var l=t.charCodeAt(n);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,Dj(this,t,this.l);break;case 8:if(a=8,r==="f"){Lj(this,t,this.l);break}case 16:break;case-4:a=4,Ij(this,t,this.l);break}return this.l+=a,this}function P3(e,t){var r=F3(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function vi(e,t){e.l=t,e.read_shift=qh,e.chk=P3,e.write_shift=Oj}function Vi(e,t){e.l+=t}function lt(e){var t=Ku(e);return vi(t,0),t}function Wc(e,t,r){if(e){var a,n,s;vi(e,e.l||0);for(var l=e.length,A=0,u=0;e.l<l;){A=e.read_shift(1),A&128&&(A=(A&127)+((e.read_shift(1)&127)<<7));var f=_p[A]||_p[65535];for(a=e.read_shift(1),s=a&127,n=1;n<4&&a&128;++n)s+=((a=e.read_shift(1))&127)<<7*n;u=e.l+s;var h=f.f&&f.f(e,s,r);if(e.l=u,t(h,f,A))return}}}function Ql(){var e=[],t=Zr?256:2048,r=function(f){var h=lt(f);return vi(h,0),h},a=r(t),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},s=function(f){return a&&f<a.length-a.l?a:(n(),a=r(Math.max(f+1,t)))},l=function(){return n(),ai(e)},A=function(f){n(),a=f,a.l==null&&(a.l=a.length),s(t)};return{next:s,push:A,end:l,_bufs:e}}function _t(e,t,r,a){var n=+t,s;if(!isNaN(n)){a||(a=_p[n].p||(r||[]).length||0),s=1+(n>=128?1:0)+1,a>=128&&++s,a>=16384&&++s,a>=2097152&&++s;var l=e.next(s);n<=127?l.write_shift(1,n):(l.write_shift(1,(n&127)+128),l.write_shift(1,n>>7));for(var A=0;A!=4;++A)if(a>=128)l.write_shift(1,(a&127)+128),a>>=7;else{l.write_shift(1,a);break}a>0&&L2(r)&&e.push(r)}}function zh(e,t,r){var a=kn(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function a4(e,t,r){var a=kn(e);return a.s=zh(a.s,t.s,r),a.e=zh(a.e,t.s,r),a}function Vh(e,t){if(e.cRel&&e.c<0)for(e=kn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=kn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ir(e);return!e.cRel&&e.cRel!=null&&(r=Hj(r)),!e.rRel&&e.rRel!=null&&(r=Rj(r)),r}function Pb(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Hn(e.s.c)+":"+(e.e.cRel?"":"$")+Hn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+xs(e.s.r)+":"+(e.e.rRel?"":"$")+xs(e.e.r):Vh(e.s,t.biff)+":"+Vh(e.e,t.biff)}function U2(e){return parseInt(Mj(e),10)-1}function xs(e){return""+(e+1)}function Rj(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Mj(e){return e.replace(/\$(\d+)$/,"$1")}function j2(e){for(var t=Pj(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function Hn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Hj(e){return e.replace(/^([A-Z])/,"$$$1")}function Pj(e){return e.replace(/^\$([A-Z])/,"$1")}function Kj(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Pn(e){for(var t=0,r=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function Ir(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Rl(e){var t=e.indexOf(":");return t==-1?{s:Pn(e),e:Pn(e)}:{s:Pn(e.slice(0,t)),e:Pn(e.slice(t+1))}}function Wr(e,t){return typeof t>"u"||typeof t=="number"?Wr(e.s,e.e):(typeof e!="string"&&(e=Ir(e)),typeof t!="string"&&(t=Ir(t)),e==t?e:e+":"+t)}function ka(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,s=e.length;for(r=0;a<s&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.s.c=--r,r=0;a<s&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(t.s.r=--r,a===s||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=s&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.e.c=--r,r=0;a!=s&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return t.e.r=--r,t}function n4(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Oo(e.z,r?zs(t):t)}catch{}try{return e.w=Oo((e.XF||{}).numFmtId||(r?14:0),r?zs(t):t)}catch{return""+t}}function zc(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Xc[e.v]||e.v:t==null?n4(e,e.v):n4(e,t))}function Zu(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function K3(e,t,r){var a=r||{},n=e?Array.isArray(e):a.dense,s=e||(n?[]:{}),l=0,A=0;if(s&&a.origin!=null){if(typeof a.origin=="number")l=a.origin;else{var u=typeof a.origin=="string"?Pn(a.origin):a.origin;l=u.r,A=u.c}s["!ref"]||(s["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var h=ka(s["!ref"]);f.s.c=h.s.c,f.s.r=h.s.r,f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),l==-1&&(f.e.r=l=h.e.r+1)}for(var g=0;g!=t.length;++g)if(t[g]){if(!Array.isArray(t[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=t[g].length;++x)if(!(typeof t[g][x]>"u")){var m={v:t[g][x]},w=l+g,v=A+x;if(f.s.r>w&&(f.s.r=w),f.s.c>v&&(f.s.c=v),f.e.r<w&&(f.e.r=w),f.e.c<v&&(f.e.c=v),t[g][x]&&typeof t[g][x]=="object"&&!Array.isArray(t[g][x])&&!(t[g][x]instanceof Date))m=t[g][x];else if(Array.isArray(m.v)&&(m.f=t[g][x][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(a.nullError)m.t="e",m.v=0;else if(a.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=a.dateNF||Lr[14],a.cellDates?(m.t="d",m.w=Oo(m.z,zs(m.v))):(m.t="n",m.v=zs(m.v),m.w=Oo(m.z,m.v))):m.t="s";if(n)s[w]||(s[w]=[]),s[w][v]&&s[w][v].z&&(m.z=s[w][v].z),s[w][v]=m;else{var B=Ir({c:v,r:w});s[B]&&s[B].z&&(m.z=s[B].z),s[B]=m}}}return f.s.c<1e7&&(s["!ref"]=Wr(f)),s}function Sf(e,t){return K3(null,e,t)}function qj(e){return e.read_shift(4,"i")}function cA(e,t){return t||(t=lt(4)),t.write_shift(4,e),t}function zi(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function ni(e,t){var r=!1;return t==null&&(r=!0,t=lt(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function zj(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Vj(e,t){return t||(t=lt(4)),t.write_shift(2,0),t.write_shift(2,0),t}function D2(e,t){var r=e.l,a=e.read_shift(1),n=zi(e),s=[],l={t:n,h:n};if((a&1)!==0){for(var A=e.read_shift(4),u=0;u!=A;++u)s.push(zj(e));l.r=s}else l.r=[{ich:0,ifnt:0}];return e.l=r+t,l}function Gj(e,t){var r=!1;return t==null&&(r=!0,t=lt(15+4*e.t.length)),t.write_shift(1,0),ni(e.t,t),r?t.slice(0,t.l):t}var Wj=D2;function Xj(e,t){var r=!1;return t==null&&(r=!0,t=lt(23+4*e.t.length)),t.write_shift(1,1),ni(e.t,t),t.write_shift(4,1),Vj({},t),r?t.slice(0,t.l):t}function Ho(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function V0(e,t){return t==null&&(t=lt(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function G0(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function W0(e,t){return t==null&&(t=lt(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Yj=zi,q3=ni;function I2(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function cx(e,t){var r=!1;return t==null&&(r=!0,t=lt(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var $j=zi,lw=I2,Q2=cx;function O2(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var n=a===0?Ax([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):y0(t,0)>>2;return r?n/100:n}function z3(e,t){t==null&&(t=lt(4));var r=0,a=0,n=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?a=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?n:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function V3(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function Jj(e,t){return t||(t=lt(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var X0=V3,Ef=Jj;function qi(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function R0(e,t){return(t||lt(8)).write_shift(8,e,"f")}function Zj(e){var t={},r=e.read_shift(1),a=r>>>1,n=e.read_shift(1),s=e.read_shift(2,"i"),l=e.read_shift(1),A=e.read_shift(1),u=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=n;var f=N0[n];f&&(t.rgb=bp(f));break;case 2:t.rgb=bp([l,A,u]);break;case 3:t.theme=n;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function ux(e,t){if(t||(t=lt(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function eD(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function tD(e,t){t||(t=lt(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function G3(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function rD(e){return G3(e,1)}function aD(e){return G3(e,2)}var R2=2,Ll=3,Wg=11,s4=12,dx=19,Xg=64,nD=65,sD=71,iD=4108,lD=4126,Zs=80,W3=81,oD=[Zs,W3],ow={1:{n:"CodePage",t:R2},2:{n:"Category",t:Zs},3:{n:"PresentationFormat",t:Zs},4:{n:"ByteCount",t:Ll},5:{n:"LineCount",t:Ll},6:{n:"ParagraphCount",t:Ll},7:{n:"SlideCount",t:Ll},8:{n:"NoteCount",t:Ll},9:{n:"HiddenCount",t:Ll},10:{n:"MultimediaClipCount",t:Ll},11:{n:"ScaleCrop",t:Wg},12:{n:"HeadingPairs",t:iD},13:{n:"TitlesOfParts",t:lD},14:{n:"Manager",t:Zs},15:{n:"Company",t:Zs},16:{n:"LinksUpToDate",t:Wg},17:{n:"CharacterCount",t:Ll},19:{n:"SharedDoc",t:Wg},22:{n:"HyperlinksChanged",t:Wg},23:{n:"AppVersion",t:Ll,p:"version"},24:{n:"DigSig",t:nD},26:{n:"ContentType",t:Zs},27:{n:"ContentStatus",t:Zs},28:{n:"Language",t:Zs},29:{n:"Version",t:Zs},255:{},2147483648:{n:"Locale",t:dx},2147483651:{n:"Behavior",t:dx},1919054434:{}},Aw={1:{n:"CodePage",t:R2},2:{n:"Title",t:Zs},3:{n:"Subject",t:Zs},4:{n:"Author",t:Zs},5:{n:"Keywords",t:Zs},6:{n:"Comments",t:Zs},7:{n:"Template",t:Zs},8:{n:"LastAuthor",t:Zs},9:{n:"RevNumber",t:Zs},10:{n:"EditTime",t:Xg},11:{n:"LastPrinted",t:Xg},12:{n:"CreatedDate",t:Xg},13:{n:"ModifiedDate",t:Xg},14:{n:"PageCount",t:Ll},15:{n:"WordCount",t:Ll},16:{n:"CharCount",t:Ll},17:{n:"Thumbnail",t:sD},18:{n:"Application",t:Zs},19:{n:"DocSecurity",t:Ll},255:{},2147483648:{n:"Locale",t:dx},2147483651:{n:"Behavior",t:dx},1919054434:{}},i4={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},AD=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function cD(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var uD=cD([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),N0=kn(uD),Xc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},X3={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},cw={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Yg={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function M2(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function dD(e){var t=M2();if(!e||!e.match)return t;var r={};if((e.match(Gi)||[]).forEach(function(a){var n=Qr(a);switch(n[0].replace(yj,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":t[cw[n.ContentType]]!==void 0&&t[cw[n.ContentType]].push(n.PartName);break}}),t.xmlns!==qs.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function Y3(e,t){var r=dj(cw),a=[],n;a[a.length]=bs,a[a.length]=Mt("Types",null,{xmlns:qs.CT,"xmlns:xsd":qs.xsd,"xmlns:xsi":qs.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(u){return Mt("Default",null,{Extension:u[0],ContentType:u[1]})}));var s=function(u){e[u]&&e[u].length>0&&(n=e[u][0],a[a.length]=Mt("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:Yg[u][t.bookType]||Yg[u].xlsx}))},l=function(u){(e[u]||[]).forEach(function(f){a[a.length]=Mt("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:Yg[u][t.bookType]||Yg[u].xlsx})})},A=function(u){(e[u]||[]).forEach(function(f){a[a.length]=Mt("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:r[u][0]})})};return s("workbooks"),l("sheets"),l("charts"),A("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(A),A("vba"),A("comments"),A("threadedcomments"),A("drawings"),l("metadata"),A("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var na={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function xp(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Gh(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(Gi)||[]).forEach(function(n){var s=Qr(n);if(s[0]==="<Relationship"){var l={};l.Type=s.Type,l.Target=s.Target,l.Id=s.Id,s.TargetMode&&(l.TargetMode=s.TargetMode);var A=s.TargetMode==="External"?s.Target:Uh(s.Target,t);r[A]=l,a[s.Id]=l}}),r["!id"]=a,r}function Af(e){var t=[bs,Mt("Relationships",null,{xmlns:qs.RELS})];return as(e["!id"]).forEach(function(r){t[t.length]=Mt("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function qa(e,t,r,a,n,s){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=a,n.Target=r,[na.HLINK,na.XPATH,na.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}var fD="application/vnd.oasis.opendocument.spreadsheet";function hD(e,t){for(var r=F2(e),a,n;a=mp.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(n=Qr(a[0],!1),n.path=="/"&&n.type!==fD)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}function pD(e){var t=[bs];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function l4(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function gD(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function mD(e){var t=[bs];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(l4(e[r][0],e[r][1])),t.push(gD("",e[r][0]));return t.push(l4("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function $3(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+nx.version+"</meta:generator></office:meta></office:document-meta>"}var Qo=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],xD=(function(){for(var e=new Array(Qo.length),t=0;t<Qo.length;++t){var r=Qo[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e})();function J3(e){var t={};e=en(e);for(var r=0;r<Qo.length;++r){var a=Qo[r],n=e.match(xD[r]);n!=null&&n.length>0&&(t[a[1]]=Ba(n[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=Bn(t[a[1]]))}return t}function Kb(e,t,r,a,n){n[e]!=null||t==null||t===""||(n[e]=t,t=Va(t),a[a.length]=r?Mt(e,t,r):wi(e,t))}function Z3(e,t){var r=t||{},a=[bs,Mt("cp:coreProperties",null,{"xmlns:cp":qs.CORE_PROPS,"xmlns:dc":qs.dc,"xmlns:dcterms":qs.dcterms,"xmlns:dcmitype":qs.dcmitype,"xmlns:xsi":qs.xsi})],n={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&Kb("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:iw(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),e.ModifiedDate!=null&&Kb("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:iw(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var s=0;s!=Qo.length;++s){var l=Qo[s],A=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:e?e[l[1]]:null;A===!0?A="1":A===!1?A="0":typeof A=="number"&&(A=String(A)),A!=null&&Kb(l[0],A,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var F0=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],eE=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function tE(e,t,r,a){var n=[];if(typeof e=="string")n=$B(e,a);else for(var s=0;s<e.length;++s)n=n.concat(e[s].map(function(h){return{v:h}}));var l=typeof t=="string"?$B(t,a).map(function(h){return h.v}):t,A=0,u=0;if(l.length>0)for(var f=0;f!==n.length;f+=2){switch(u=+n[f+1].v,n[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=u,r.SheetNames=l.slice(A,A+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=u,r.DefinedNames=l.slice(A,A+u);break;case"Charts":case"Diagramme":r.Chartsheets=u,r.ChartNames=l.slice(A,A+u);break}A+=u}}function bD(e,t,r){var a={};return t||(t={}),e=en(e),F0.forEach(function(n){var s=(e.match(pp(n[0]))||[])[1];switch(n[2]){case"string":s&&(t[n[1]]=Ba(s));break;case"bool":t[n[1]]=s==="true";break;case"raw":var l=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));l&&l.length>0&&(a[n[1]]=l[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&tE(a.HeadingPairs,a.TitlesOfParts,t,r),t}function rE(e){var t=[],r=Mt;return e||(e={}),e.Application="SheetJS",t[t.length]=bs,t[t.length]=Mt("Properties",null,{xmlns:qs.EXT_PROPS,"xmlns:vt":qs.vt}),F0.forEach(function(a){if(e[a[1]]!==void 0){var n;switch(a[2]){case"string":n=Va(String(e[a[1]]));break;case"bool":n=e[a[1]]?"true":"false";break}n!==void 0&&(t[t.length]=r(a[0],n))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+Va(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var vD=/<[^>]+>[^<]*/g;function wD(e,t){var r={},a="",n=e.match(vD);if(n)for(var s=0;s!=n.length;++s){var l=n[s],A=Qr(l);switch(A[0]){case"<?xml":break;case"<Properties":break;case"<property":a=Ba(A.name);break;case"</property>":a=null;break;default:if(l.indexOf("<vt:")===0){var u=l.split(">"),f=u[0].slice(4),h=u[1];switch(f){case"lpstr":case"bstr":case"lpwstr":r[a]=Ba(h);break;case"bool":r[a]=yn(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(h,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(h);break;case"filetime":case"date":r[a]=Bn(h);break;case"cy":case"error":r[a]=Ba(h);break;default:if(f.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",l,f,u)}}else if(l.slice(0,2)!=="</"){if(t.WTF)throw new Error(l)}}}return r}function aE(e){var t=[bs,Mt("Properties",null,{xmlns:qs.CUST_PROPS,"xmlns:vt":qs.vt})];if(!e)return t.join("");var r=1;return as(e).forEach(function(n){++r,t[t.length]=Mt("property",Fj(e[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Va(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var uw={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},qb;function yD(e,t,r){qb||(qb=Vx(uw)),t=qb[t]||t,e[t]=r}function _D(e,t){var r=[];return as(uw).map(function(a){for(var n=0;n<Qo.length;++n)if(Qo[n][1]==a)return Qo[n];for(n=0;n<F0.length;++n)if(F0[n][1]==a)return F0[n];throw a}).forEach(function(a){if(e[a[1]]!=null){var n=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];a[2]==="date"&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"Z")),typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(wi(uw[a[1]]||a[1],n))}}),Mt("DocumentProperties",r.join(""),{xmlns:io.o})}function BD(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return e&&as(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var l=0;l<Qo.length;++l)if(s==Qo[l][1])return;for(l=0;l<F0.length;++l)if(s==F0[l][1])return;for(l=0;l<r.length;++l)if(s==r[l])return;var A=e[s],u="string";typeof A=="number"?(u="float",A=String(A)):A===!0||A===!1?(u="boolean",A=A?"1":"0"):A=String(A),n.push(Mt(GB(s),A,{"dt:dt":u}))}}),t&&as(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var l=t[s],A="string";typeof l=="number"?(A="float",l=String(l)):l===!0||l===!1?(A="boolean",l=l?"1":"0"):l instanceof Date?(A="dateTime.tz",l=l.toISOString()):l=String(l),n.push(Mt(GB(s),l,{"dt:dt":A}))}}),"<"+a+' xmlns="'+io.o+'">'+n.join("")+"</"+a+">"}function H2(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function kD(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),n=(r-a)/Math.pow(2,32);a*=1e7,n*=1e7;var s=a/Math.pow(2,32)|0;s>0&&(a=a%Math.pow(2,32),n+=s);var l=lt(8);return l.write_shift(4,a),l.write_shift(4,n),l}function nE(e,t,r){var a=e.l,n=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return n}function sE(e,t,r){var a=e.read_shift(0,"lpwstr");return a}function iE(e,t,r){return t===31?sE(e):nE(e,t,r)}function dw(e,t,r){return iE(e,t,r===!1?0:4)}function CD(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return iE(e,t,0)}function SD(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var n=e.l;r[a]=e.read_shift(0,"lpwstr").replace(sl,""),e.l-n&2&&(e.l+=2)}return r}function ED(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(sl,"");return r}function ND(e){var t=e.l,r=fx(e,W3);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=fx(e,Ll);return[r,a]}function FD(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(ND(e));return r}function o4(e,t){for(var r=e.read_shift(4),a={},n=0;n!=r;++n){var s=e.read_shift(4),l=e.read_shift(4);a[s]=e.read_shift(l,t===1200?"utf16le":"utf8").replace(sl,"").replace(Lh,"!"),t===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function lE(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function TD(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function fx(e,t,r){var a=e.read_shift(2),n,s=r||{};if(e.l+=2,t!==s4&&a!==t&&oD.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===s4?a:t){case 2:return n=e.read_shift(2,"i"),s.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return nE(e,a,4).replace(sl,"");case 31:return sE(e);case 64:return H2(e);case 65:return lE(e);case 71:return TD(e);case 80:return dw(e,a,!s.raw).replace(sl,"");case 81:return CD(e,a).replace(sl,"");case 4108:return FD(e);case 4126:case 4127:return a==4127?SD(e):ED(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function A4(e,t){var r=lt(4),a=lt(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=lt(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=kD(t);break;case 31:case 80:for(a=lt(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return ai([r,a])}function c4(e,t){var r=e.l,a=e.read_shift(4),n=e.read_shift(4),s=[],l=0,A=0,u=-1,f={};for(l=0;l!=n;++l){var h=e.read_shift(4),g=e.read_shift(4);s[l]=[h,g+r]}s.sort(function(N,S){return N[1]-S[1]});var x={};for(l=0;l!=n;++l){if(e.l!==s[l][1]){var m=!0;if(l>0&&t)switch(t[s[l-1][0]].t){case 2:e.l+2===s[l][1]&&(e.l+=2,m=!1);break;case 80:e.l<=s[l][1]&&(e.l=s[l][1],m=!1);break;case 4108:e.l<=s[l][1]&&(e.l=s[l][1],m=!1);break}if((!t||l==0)&&e.l<=s[l][1]&&(m=!1,e.l=s[l][1]),m)throw new Error("Read Error: Expected address "+s[l][1]+" at "+e.l+" :"+l)}if(t){var w=t[s[l][0]];if(x[w.n]=fx(e,w.t,{raw:!0}),w.p==="version"&&(x[w.n]=String(x[w.n]>>16)+"."+("0000"+String(x[w.n]&65535)).slice(-4)),w.n=="CodePage")switch(x[w.n]){case 0:x[w.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:lA(A=x[w.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+x[w.n])}}else if(s[l][0]===1){if(A=x.CodePage=fx(e,R2),lA(A),u!==-1){var v=e.l;e.l=s[u][1],f=o4(e,A),e.l=v}}else if(s[l][0]===0){if(A===0){u=l,e.l=s[l+1][1];continue}f=o4(e,A)}else{var B=f[s[l][0]],k;switch(e[e.l]){case 65:e.l+=4,k=lE(e);break;case 30:e.l+=4,k=dw(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,k=dw(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,k=e.read_shift(4,"i");break;case 19:e.l+=4,k=e.read_shift(4);break;case 5:e.l+=4,k=e.read_shift(8,"f");break;case 11:e.l+=4,k=cs(e,4);break;case 64:e.l+=4,k=Bn(H2(e));break;default:throw new Error("unparsed value: "+e[e.l])}x[B]=k}}return e.l=r+a,x}var oE=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function LD(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function u4(e,t,r){var a=lt(8),n=[],s=[],l=8,A=0,u=lt(8),f=lt(8);if(u.write_shift(4,2),u.write_shift(4,1200),f.write_shift(4,1),s.push(u),n.push(f),l+=8+u.length,!t){f=lt(8),f.write_shift(4,0),n.unshift(f);var h=[lt(4)];for(h[0].write_shift(4,e.length),A=0;A<e.length;++A){var g=e[A][0];for(u=lt(8+2*(g.length+1)+(g.length%2?0:2)),u.write_shift(4,A+2),u.write_shift(4,g.length+1),u.write_shift(0,g,"dbcs");u.l!=u.length;)u.write_shift(1,0);h.push(u)}u=ai(h),s.unshift(u),l+=8+u.length}for(A=0;A<e.length;++A)if(!(t&&!t[e[A][0]])&&!(oE.indexOf(e[A][0])>-1||eE.indexOf(e[A][0])>-1)&&e[A][1]!=null){var x=e[A][1],m=0;if(t){m=+t[e[A][0]];var w=r[m];if(w.p=="version"&&typeof x=="string"){var v=x.split(".");x=(+v[0]<<16)+(+v[1]||0)}u=A4(w.t,x)}else{var B=LD(x);B==-1&&(B=31,x=String(x)),u=A4(B,x)}s.push(u),f=lt(8),f.write_shift(4,t?m:2+A),n.push(f),l+=8+u.length}var k=8*(s.length+1);for(A=0;A<s.length;++A)n[A].write_shift(4,k),k+=s[A].length;return a.write_shift(4,l),a.write_shift(4,s.length),ai([a].concat(n).concat(s))}function d4(e,t,r){var a=e.content;if(!a)return{};vi(a,0);var n,s,l,A,u=0;a.chk("feff","Byte Order: "),a.read_shift(2);var f=a.read_shift(4),h=a.read_shift(16);if(h!==yr.utils.consts.HEADER_CLSID&&h!==r)throw new Error("Bad PropertySet CLSID "+h);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(s=a.read_shift(16),A=a.read_shift(4),n===1&&A!==a.l)throw new Error("Length mismatch: "+A+" !== "+a.l);n===2&&(l=a.read_shift(16),u=a.read_shift(4));var g=c4(a,t),x={SystemIdentifier:f};for(var m in g)x[m]=g[m];if(x.FMTID=s,n===1)return x;if(u-a.l==2&&(a.l+=2),a.l!==u)throw new Error("Length mismatch 2: "+a.l+" !== "+u);var w;try{w=c4(a,null)}catch{}for(m in w)x[m]=w[m];return x.FMTID=[s,l],x}function f4(e,t,r,a,n,s){var l=lt(n?68:48),A=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,yr.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,n?2:1),l.write_shift(16,t,"hex"),l.write_shift(4,n?68:48);var u=u4(e,r,a);if(A.push(u),n){var f=u4(n,null,null);l.write_shift(16,s,"hex"),l.write_shift(4,68+u.length),A.push(f)}return ai(A)}function wu(e,t){return e.read_shift(t),null}function UD(e,t){t||(t=lt(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function jD(e,t,r){for(var a=[],n=e.l+t;e.l<n;)a.push(r(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return a}function cs(e,t){return e.read_shift(t)===1}function al(e,t){return t||(t=lt(2)),t.write_shift(2,+!!e),t}function Fs(e){return e.read_shift(2,"u")}function To(e,t){return t||(t=lt(2)),t.write_shift(2,e),t}function AE(e,t){return jD(e,t,Fs)}function DD(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function cE(e,t,r){return r||(r=lt(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Qp(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var l=a?e.read_shift(a,n):"";return l}function ID(e){var t=e.read_shift(2),r=e.read_shift(1),a=r&4,n=r&8,s=1+(r&1),l=0,A,u={};n&&(l=e.read_shift(2)),a&&(A=e.read_shift(4));var f=s==2?"dbcs-cont":"sbcs-cont",h=t===0?"":e.read_shift(t,f);return n&&(e.l+=4*l),a&&(e.l+=A),u.t=h,n||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function QD(e){var t=e.t||"",r=lt(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=lt(2*t.length);a.write_shift(2*t.length,t,"utf16le");var n=[r,a];return ai(n)}function M0(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function Op(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):M0(e,a,r)}function Y0(e,t,r){if(r.biff>5)return Op(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function uE(e,t,r){return r||(r=lt(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function OD(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function RD(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var n=e.read_shift((a?t-24:t)>>1,"utf16le").replace(sl,"");return a&&(e.l+=24),n}function MD(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return r+a.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(s>>1,"utf16le").replace(sl,"");return r+l}function HD(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return RD(e);case"0303000000000000c000000000000046":return MD(e);default:throw new Error("Unsupported Moniker "+r)}}function $g(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(sl,""):"";return r}function h4(e,t){t||(t=lt(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function PD(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=e.read_shift(2);e.l+=2;var s,l,A,u,f="",h,g;n&16&&(s=$g(e,r-e.l)),n&128&&(l=$g(e,r-e.l)),(n&257)===257&&(A=$g(e,r-e.l)),(n&257)===1&&(u=HD(e,r-e.l)),n&8&&(f=$g(e,r-e.l)),n&32&&(h=e.read_shift(16)),n&64&&(g=H2(e)),e.l=r;var x=l||A||u||"";x&&f&&(x+="#"+f),x||(x="#"+f),n&2&&x.charAt(0)=="/"&&x.charAt(1)!="/"&&(x="file://"+x);var m={Target:x};return h&&(m.guid=h),g&&(m.time=g),s&&(m.Tooltip=s),m}function KD(e){var t=lt(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var n=a.indexOf("#"),s=n>-1?31:23;switch(a.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)t.write_shift(4,l[r]);if(s==28)a=a.slice(1),h4(a,t);else if(s&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));var A=n>-1?a.slice(0,n):a;for(t.write_shift(4,2*(A.length+1)),r=0;r<A.length;++r)t.write_shift(2,A.charCodeAt(r));t.write_shift(2,0),s&8&&h4(n>-1?a.slice(n+1):"",t)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));for(var u=0;a.slice(u*3,u*3+3)=="../"||a.slice(u*3,u*3+3)=="..\\";)++u;for(t.write_shift(2,u),t.write_shift(4,a.length-3*u+1),r=0;r<a.length-3*u;++r)t.write_shift(1,a.charCodeAt(r+3*u)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function dE(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),n=e.read_shift(1);return[t,r,a,n]}function fE(e,t){var r=dE(e);return r[3]=0,r}function nc(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function H0(e,t,r,a){return a||(a=lt(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function qD(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function zD(e,t,r){return t===0?"":Y0(e,t,r)}function VD(e,t,r){var a=r.biff>8?4:2,n=e.read_shift(a),s=e.read_shift(a,"i"),l=e.read_shift(a,"i");return[n,s,l]}function hE(e){var t=e.read_shift(2),r=O2(e);return[t,r]}function GD(e,t,r){e.l+=4,t-=4;var a=e.l+t,n=Qp(e,t,r),s=e.read_shift(2);if(a-=e.l,s!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+s);return e.l+=s,n}function Xx(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return{s:{c:a,r:t},e:{c:n,r}}}function pE(e,t){return t||(t=lt(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function gE(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),n=e.read_shift(1);return{s:{c:a,r:t},e:{c:n,r}}}var WD=gE;function mE(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function XD(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function YD(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Ui(e){e.l+=2,e.l+=e.read_shift(2)}var $D={0:Ui,4:Ui,5:Ui,6:Ui,7:YD,8:Ui,9:Ui,10:Ui,11:Ui,12:Ui,13:XD,14:Ui,15:Ui,16:Ui,17:Ui,18:Ui,19:Ui,20:Ui,21:mE};function JD(e,t){for(var r=e.l+t,a=[];e.l<r;){var n=e.read_shift(2);e.l-=2;try{a.push($D[n](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function Jg(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function P2(e,t,r){var a=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=lt(n);return s.write_shift(2,a),s.write_shift(2,t),n>4&&s.write_shift(2,29282),n>6&&s.write_shift(2,1997),n>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function ZD(e,t){return t===0||e.read_shift(2),1200}function eI(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,n=Y0(e,0,r);return e.read_shift(t+a-e.l),n}function tI(e,t){var r=!t||t.biff==8,a=lt(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function rI(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function aI(e,t,r){var a=e.read_shift(4),n=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var l=Qp(e,0,r);return l.length===0&&(l="Sheet1"),{pos:a,hs:n,dt:s,name:l}}function nI(e,t){var r=!t||t.biff>=8?2:1,a=lt(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function sI(e,t){for(var r=e.l+t,a=e.read_shift(4),n=e.read_shift(4),s=[],l=0;l!=n&&e.l<r;++l)s.push(ID(e));return s.Count=a,s.Unique=n,s}function iI(e,t){var r=lt(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],n=0;n<e.length;++n)a[n]=QD(e[n]);var s=ai([r].concat(a));return s.parts=[r.length].concat(a.map(function(l){return l.length})),s}function lI(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function oI(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function AI(e){var t=qD(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function cI(e){return e.read_shift(2),e.read_shift(4)}function p4(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var n=e.read_shift(2);r&&r.biff==2&&(a=1-(n>>15),n&=32767);var s={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[s,n]}function uI(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),A=e.read_shift(2),u=e.read_shift(2),f=e.read_shift(2);return{Pos:[t,r],Dim:[a,n],Flags:s,CurTab:l,FirstTab:A,Selected:u,TabRatio:f}}function dI(){var e=lt(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function fI(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function hI(e){var t=lt(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function pI(){}function gI(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=Qp(e,0,r),a}function mI(e,t){var r=e.name||"Arial",a=t&&t.biff==5,n=a?15+r.length:16+2*r.length,s=lt(n);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),a||s.write_shift(1,1),s.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),s}function xI(e){var t=nc(e);return t.isst=e.read_shift(4),t}function bI(e,t,r,a){var n=lt(10);return H0(e,t,a,n),n.write_shift(4,r),n}function vI(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,n=nc(e);r.biff==2&&e.l++;var s=Op(e,a-e.l,r);return n.val=s,n}function wI(e,t,r,a,n){var s=!n||n.biff==8,l=lt(8+ +s+(1+s)*r.length);return H0(e,t,a,l),l.write_shift(2,r.length),s&&l.write_shift(1,1),l.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),l}function yI(e,t,r){var a=e.read_shift(2),n=Y0(e,0,r);return[a,n]}function _I(e,t,r,a){var n=r&&r.biff==5;a||(a=lt(n?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(n?1:2,t.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var s=a.length>a.l?a.slice(0,a.l):a;return s.l==null&&(s.l=s.length),s}var BI=Y0;function g4(e,t,r){var a=e.l+t,n=r.biff==8||!r.biff?4:2,s=e.read_shift(n),l=e.read_shift(n),A=e.read_shift(2),u=e.read_shift(2);return e.l=a,{s:{r:s,c:A},e:{r:l,c:u}}}function kI(e,t){var r=t.biff==8||!t.biff?4:2,a=lt(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function CI(e){var t=e.read_shift(2),r=e.read_shift(2),a=hE(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function SI(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),s=[];e.l<r;)s.push(hE(e));if(e.l!==r)throw new Error("MulRK read error");var l=e.read_shift(2);if(s.length!=l-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:l,rkrec:s}}function EI(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var l=e.read_shift(2);if(s.length!=l-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:l,ixfe:s}}function NI(e,t,r,a){var n={},s=e.read_shift(4),l=e.read_shift(4),A=e.read_shift(4),u=e.read_shift(2);return n.patternType=AD[A>>26],a.cellStyles&&(n.alc=s&7,n.fWrap=s>>3&1,n.alcV=s>>4&7,n.fJustLast=s>>7&1,n.trot=s>>8&255,n.cIndent=s>>16&15,n.fShrinkToFit=s>>20&1,n.iReadOrder=s>>22&2,n.fAtrNum=s>>26&1,n.fAtrFnt=s>>27&1,n.fAtrAlc=s>>28&1,n.fAtrBdr=s>>29&1,n.fAtrPat=s>>30&1,n.fAtrProt=s>>31&1,n.dgLeft=l&15,n.dgRight=l>>4&15,n.dgTop=l>>8&15,n.dgBottom=l>>12&15,n.icvLeft=l>>16&127,n.icvRight=l>>23&127,n.grbitDiag=l>>30&3,n.icvTop=A&127,n.icvBottom=A>>7&127,n.icvDiag=A>>14&127,n.dgDiag=A>>21&15,n.icvFore=u&127,n.icvBack=u>>7&127,n.fsxButton=u>>14&1),n}function FI(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=NI(e,t,a.fStyle,r),a}function m4(e,t,r,a){var n=r&&r.biff==5;a||(a=lt(n?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&n&&(s|=1024),a.write_shift(4,s),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function TI(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function LI(e){var t=lt(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function x4(e,t,r){var a=nc(e);(r.biff==2||t==9)&&++e.l;var n=DD(e);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function UI(e,t,r,a,n,s){var l=lt(8);return H0(e,t,a,l),cE(r,s,l),l}function jI(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=nc(e),n=qi(e);return a.val=n,a}function DI(e,t,r,a){var n=lt(14);return H0(e,t,a,n),R0(r,n),n}var b4=zD;function II(e,t,r){var a=e.l+t,n=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,n];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var l=M0(e,s),A=[];a>e.l;)A.push(Op(e));return[s,n,l,A]}function v4(e,t,r){var a=e.read_shift(2),n,s={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(n=GD(e,t-2,r)),s.body=n||e.read_shift(t-2),typeof n=="string"&&(s.Name=n),s}var QI=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function w4(e,t,r){var a=e.l+t,n=e.read_shift(2),s=e.read_shift(1),l=e.read_shift(1),A=e.read_shift(r&&r.biff==2?1:2),u=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),u=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var f=M0(e,l,r);n&32&&(f=QI[f.charCodeAt(0)]);var h=a-e.l;r&&r.biff==2&&--h;var g=a==e.l||A===0||!(h>0)?[]:JR(e,h,r,A);return{chKey:s,Name:f,itab:u,rgce:g}}function xE(e,t,r){if(r.biff<8)return OI(e,t,r);for(var a=[],n=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)a.push(VD(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function OI(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=Qp(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function RI(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),n=e.read_shift(2),s=M0(e,a,r),l=M0(e,n,r);return[s,l]}function MI(e,t,r){var a=gE(e);e.l++;var n=e.read_shift(1);return t-=8,[ZR(e,t,r),n,a]}function y4(e,t,r){var a=WD(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,YR(e,t,r)]}function HI(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function PI(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),A=Y0(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:n},A,l,s]}}function KI(e,t,r){return PI(e,t,r)}function qI(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(Xx(e));return r}function zI(e){var t=lt(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)pE(e[r],t);return t}function VI(e,t,r){if(r&&r.biff<8)return WI(e,t,r);var a=mE(e),n=JD(e,t-22,a[1]);return{cmo:a,ft:n}}var GI={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=r,{fmt:a}}};function WI(e,t,r){e.l+=4;var a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var l=[];return l.push((GI[a]||Vi)(e,t,r)),{cmo:[n,a,s],ft:l}}function XI(e,t,r){var a=e.l,n="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:l=OD(e,6,r);var A=e.read_shift(2);e.read_shift(2),Fs(e,2);var u=e.read_shift(2);e.l+=u;for(var f=1;f<e.lens.length-1;++f){if(e.l-a!=e.lens[f])throw new Error("TxO: bad continue record");var h=e[e.l],g=M0(e,e.lens[f+1]-e.lens[f]-1);if(n+=g,n.length>=(h?A:2*A))break}if(n.length!==A&&n.length!==A*2)throw new Error("cchText: "+A+" != "+n.length);return e.l=a+t,{t:n}}catch{return e.l=a+t,{t:n}}}function YI(e,t){var r=Xx(e);e.l+=16;var a=PD(e,t-24);return[r,a]}function $I(e){var t=lt(24),r=Pn(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(a[n],16));return ai([t,KD(e[1])])}function JI(e,t){e.read_shift(2);var r=Xx(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(sl,""),[r,a]}function ZI(e){var t=e[1].Tooltip,r=lt(10+2*(t.length+1));r.write_shift(2,2048);var a=Pn(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}function eQ(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=i4[r]||r,r=e.read_shift(2),t[1]=i4[r]||r,t}function tQ(e){return e||(e=lt(4)),e.write_shift(2,1),e.write_shift(2,1),e}function rQ(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(fE(e));return r}function aQ(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(fE(e));return r}function nQ(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function bE(e,t,r){if(!r.cellStyles)return Vi(e,t);var a=r&&r.biff>=12?4:2,n=e.read_shift(a),s=e.read_shift(a),l=e.read_shift(a),A=e.read_shift(a),u=e.read_shift(2);a==2&&(e.l+=2);var f={s:n,e:s,w:l,ixfe:A,flags:u};return(r.biff>=5||!r.biff)&&(f.level=u>>8&7),f}function sQ(e,t){var r=lt(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function iQ(e,t){var r={};return t<32||(e.l+=16,r.header=qi(e),r.footer=qi(e),e.l+=2),r}function lQ(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var n=e.read_shift(1);return e.l+=3,n&16&&(a.area=!0),a}function oQ(e){for(var t=lt(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var AQ=nc,cQ=AE,uQ=Op;function dQ(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,n}function fQ(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=nc(e);++e.l;var n=Y0(e,t-7,r);return a.t="str",a.val=n,a}function hQ(e){var t=nc(e);++e.l;var r=qi(e);return t.t="n",t.val=r,t}function pQ(e,t,r){var a=lt(15);return Pp(a,e,t),a.write_shift(8,r,"f"),a}function gQ(e){var t=nc(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function mQ(e,t,r){var a=lt(9);return Pp(a,e,t),a.write_shift(2,r),a}function xQ(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function bQ(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function vQ(e,t,r){var a=e.l+t,n=nc(e),s=e.read_shift(2),l=M0(e,s,r);return e.l=a,n.t="str",n.val=l,n}var wQ=[2,3,48,49,131,139,140,245],fw=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Vx({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(A,u){var f=[],h=Ku(1);switch(u.type){case"base64":h=oo(ho(A));break;case"binary":h=oo(A);break;case"buffer":case"array":h=A;break}vi(h,0);var g=h.read_shift(1),x=!!(g&136),m=!1,w=!1;switch(g){case 2:break;case 3:break;case 48:m=!0,x=!0;break;case 49:m=!0,x=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var v=0,B=521;g==2&&(v=h.read_shift(2)),h.l+=3,g!=2&&(v=h.read_shift(4)),v>1048576&&(v=1e6),g!=2&&(B=h.read_shift(2));var k=h.read_shift(2),N=u.codepage||1252;g!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(N=e[h[h.l]]),h.l+=1,h.l+=2),w&&(h.l+=36);for(var S=[],O={},T=Math.min(h.length,g==2?521:B-10-(m?264:0)),U=w?32:11;h.l<T&&h[h.l]!=13;)switch(O={},O.name=dp.utils.decode(N,h.slice(h.l,h.l+U)).replace(/[\u0000\r\n].*$/g,""),h.l+=U,O.type=String.fromCharCode(h.read_shift(1)),g!=2&&!w&&(O.offset=h.read_shift(4)),O.len=h.read_shift(1),g==2&&(O.offset=h.read_shift(2)),O.dec=h.read_shift(1),O.name.length&&S.push(O),g!=2&&(h.l+=w?13:14),O.type){case"B":(!m||O.len!=8)&&u.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+O.type)}if(h[h.l]!==13&&(h.l=B-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=B;var D=0,H=0;for(f[0]=[],H=0;H!=S.length;++H)f[0][H]=S[H].name;for(;v-- >0;){if(h[h.l]===42){h.l+=k;continue}for(++h.l,f[++D]=[],H=0,H=0;H!=S.length;++H){var j=h.slice(h.l,h.l+S[H].len);h.l+=S[H].len,vi(j,0);var W=dp.utils.decode(N,j);switch(S[H].type){case"C":W.trim().length&&(f[D][H]=W.replace(/\s+$/,""));break;case"D":W.length===8?f[D][H]=new Date(+W.slice(0,4),+W.slice(4,6)-1,+W.slice(6,8)):f[D][H]=W;break;case"F":f[D][H]=parseFloat(W.trim());break;case"+":case"I":f[D][H]=w?j.read_shift(-4,"i")^2147483648:j.read_shift(4,"i");break;case"L":switch(W.trim().toUpperCase()){case"Y":case"T":f[D][H]=!0;break;case"N":case"F":f[D][H]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+W+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));f[D][H]="##MEMO##"+(w?parseInt(W.trim(),10):j.read_shift(4));break;case"N":W=W.replace(/\u0000/g,"").trim(),W&&W!="."&&(f[D][H]=+W||0);break;case"@":f[D][H]=new Date(j.read_shift(-8,"f")-621356832e5);break;case"T":f[D][H]=new Date((j.read_shift(4)-2440588)*864e5+j.read_shift(4));break;case"Y":f[D][H]=j.read_shift(4,"i")/1e4+j.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[D][H]=-j.read_shift(-8,"f");break;case"B":if(m&&S[H].len==8){f[D][H]=j.read_shift(8,"f");break}case"G":case"P":j.l+=S[H].len;break;case"0":if(S[H].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[H].type)}}}if(g!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return u&&u.sheetRows&&(f=f.slice(0,u.sheetRows)),u.DBF=S,f}function a(A,u){var f=u||{};f.dateNF||(f.dateNF="yyyymmdd");var h=Sf(r(A,f),f);return h["!cols"]=f.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete f.DBF,h}function n(A,u){try{return Zu(a(A,u),u)}catch(f){if(u&&u.WTF)throw f}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function l(A,u){var f=u||{};if(+f.codepage>=0&&lA(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var h=Ql(),g=mx(A,{header:1,raw:!0,cellDates:!0}),x=g[0],m=g.slice(1),w=A["!cols"]||[],v=0,B=0,k=0,N=1;for(v=0;v<x.length;++v){if(((w[v]||{}).DBF||{}).name){x[v]=w[v].DBF.name,++k;continue}if(x[v]!=null){if(++k,typeof x[v]=="number"&&(x[v]=x[v].toString(10)),typeof x[v]!="string")throw new Error("DBF Invalid column name "+x[v]+" |"+typeof x[v]+"|");if(x.indexOf(x[v])!==v){for(B=0;B<1024;++B)if(x.indexOf(x[v]+"_"+B)==-1){x[v]+="_"+B;break}}}}var S=ka(A["!ref"]),O=[],T=[],U=[];for(v=0;v<=S.e.c-S.s.c;++v){var D="",H="",j=0,W=[];for(B=0;B<m.length;++B)m[B][v]!=null&&W.push(m[B][v]);if(W.length==0||x[v]==null){O[v]="?";continue}for(B=0;B<W.length;++B){switch(typeof W[B]){case"number":H="B";break;case"string":H="C";break;case"boolean":H="L";break;case"object":H=W[B]instanceof Date?"D":"C";break;default:H="C"}j=Math.max(j,String(W[B]).length),D=D&&D!=H?"C":H}j>250&&(j=250),H=((w[v]||{}).DBF||{}).type,H=="C"&&w[v].DBF.len>j&&(j=w[v].DBF.len),D=="B"&&H=="N"&&(D="N",U[v]=w[v].DBF.dec,j=w[v].DBF.len),T[v]=D=="C"||H=="N"?j:s[D]||0,N+=T[v],O[v]=D}var I=h.next(32);for(I.write_shift(4,318902576),I.write_shift(4,m.length),I.write_shift(2,296+32*k),I.write_shift(2,N),v=0;v<4;++v)I.write_shift(4,0);for(I.write_shift(4,0|(+t[o3]||3)<<8),v=0,B=0;v<x.length;++v)if(x[v]!=null){var Q=h.next(32),Y=(x[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Q.write_shift(1,Y,"sbcs"),Q.write_shift(1,O[v]=="?"?"C":O[v],"sbcs"),Q.write_shift(4,B),Q.write_shift(1,T[v]||s[O[v]]||0),Q.write_shift(1,U[v]||0),Q.write_shift(1,2),Q.write_shift(4,0),Q.write_shift(1,0),Q.write_shift(4,0),Q.write_shift(4,0),B+=T[v]||s[O[v]]||0}var z=h.next(264);for(z.write_shift(4,13),v=0;v<65;++v)z.write_shift(4,0);for(v=0;v<m.length;++v){var ue=h.next(N);for(ue.write_shift(1,0),B=0;B<x.length;++B)if(x[B]!=null)switch(O[B]){case"L":ue.write_shift(1,m[v][B]==null?63:m[v][B]?84:70);break;case"B":ue.write_shift(8,m[v][B]||0,"f");break;case"N":var Z="0";for(typeof m[v][B]=="number"&&(Z=m[v][B].toFixed(U[B]||0)),k=0;k<T[B]-Z.length;++k)ue.write_shift(1,32);ue.write_shift(1,Z,"sbcs");break;case"D":m[v][B]?(ue.write_shift(4,("0000"+m[v][B].getFullYear()).slice(-4),"sbcs"),ue.write_shift(2,("00"+(m[v][B].getMonth()+1)).slice(-2),"sbcs"),ue.write_shift(2,("00"+m[v][B].getDate()).slice(-2),"sbcs")):ue.write_shift(8,"00000000","sbcs");break;case"C":var Ae=String(m[v][B]!=null?m[v][B]:"").slice(0,T[B]);for(ue.write_shift(1,Ae,"sbcs"),k=0;k<T[B]-Ae.length;++k)ue.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:n,to_sheet:a,from_sheet:l}})(),vE=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+as(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(x,m){var w=e[m];return typeof w=="number"?UB(w):w},a=function(x,m,w){var v=m.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return v==59?x:UB(v)};e["|"]=254;function n(x,m){switch(m.type){case"base64":return s(ho(x),m);case"binary":return s(x,m);case"buffer":return s(Zr&&Buffer.isBuffer(x)?x.toString("binary"):Ju(x),m);case"array":return s(O0(x),m)}throw new Error("Unrecognized type "+m.type)}function s(x,m){var w=x.split(/[\n\r]+/),v=-1,B=-1,k=0,N=0,S=[],O=[],T=null,U={},D=[],H=[],j=[],W=0,I;for(+m.codepage>=0&&lA(+m.codepage);k!==w.length;++k){W=0;var Q=w[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),Y=Q.replace(/;;/g,"\0").split(";").map(function(P){return P.replace(/\u0000/g,";")}),z=Y[0],ue;if(Q.length>0)switch(z){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Y[1].charAt(0)=="P"&&O.push(Q.slice(3).replace(/;;/g,";"));break;case"C":var Z=!1,Ae=!1,ve=!1,G=!1,Se=-1,we=-1;for(N=1;N<Y.length;++N)switch(Y[N].charAt(0)){case"A":break;case"X":B=parseInt(Y[N].slice(1))-1,Ae=!0;break;case"Y":for(v=parseInt(Y[N].slice(1))-1,Ae||(B=0),I=S.length;I<=v;++I)S[I]=[];break;case"K":ue=Y[N].slice(1),ue.charAt(0)==='"'?ue=ue.slice(1,ue.length-1):ue==="TRUE"?ue=!0:ue==="FALSE"?ue=!1:isNaN(AA(ue))?isNaN(xf(ue).getDate())||(ue=Bn(ue)):(ue=AA(ue),T!==null&&kf(T)&&(ue=Wx(ue))),Z=!0;break;case"E":G=!0;var F=cf(Y[N].slice(1),{r:v,c:B});S[v][B]=[S[v][B],F];break;case"S":ve=!0,S[v][B]=[S[v][B],"S5S"];break;case"G":break;case"R":Se=parseInt(Y[N].slice(1))-1;break;case"C":we=parseInt(Y[N].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+Q)}if(Z&&(S[v][B]&&S[v][B].length==2?S[v][B][0]=ue:S[v][B]=ue,T=null),ve){if(G)throw new Error("SYLK shared formula cannot have own formula");var R=Se>-1&&S[Se][we];if(!R||!R[1])throw new Error("SYLK shared formula cannot find base");S[v][B][1]=OE(R[1],{r:v-Se,c:B-we})}break;case"F":var M=0;for(N=1;N<Y.length;++N)switch(Y[N].charAt(0)){case"X":B=parseInt(Y[N].slice(1))-1,++M;break;case"Y":for(v=parseInt(Y[N].slice(1))-1,I=S.length;I<=v;++I)S[I]=[];break;case"M":W=parseInt(Y[N].slice(1))/20;break;case"F":break;case"G":break;case"P":T=O[parseInt(Y[N].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(j=Y[N].slice(1).split(" "),I=parseInt(j[0],10);I<=parseInt(j[1],10);++I)W=parseInt(j[2],10),H[I-1]=W===0?{hidden:!0}:{wch:W},qu(H[I-1]);break;case"C":B=parseInt(Y[N].slice(1))-1,H[B]||(H[B]={});break;case"R":v=parseInt(Y[N].slice(1))-1,D[v]||(D[v]={}),W>0?(D[v].hpt=W,D[v].hpx=vf(W)):W===0&&(D[v].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+Q)}M<1&&(T=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+Q)}}return D.length>0&&(U["!rows"]=D),H.length>0&&(U["!cols"]=H),m&&m.sheetRows&&(S=S.slice(0,m.sheetRows)),[S,U]}function l(x,m){var w=n(x,m),v=w[0],B=w[1],k=Sf(v,m);return as(B).forEach(function(N){k[N]=B[N]}),k}function A(x,m){return Zu(l(x,m),m)}function u(x,m,w,v){var B="C;Y"+(w+1)+";X"+(v+1)+";K";switch(x.t){case"n":B+=x.v||0,x.f&&!x.F&&(B+=";E"+W2(x.f,{r:w,c:v}));break;case"b":B+=x.v?"TRUE":"FALSE";break;case"e":B+=x.w||x.v;break;case"d":B+='"'+(x.w||x.v)+'"';break;case"s":B+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return B}function f(x,m){m.forEach(function(w,v){var B="F;W"+(v+1)+" "+(v+1)+" ";w.hidden?B+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=vp(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=wp(w.wpx)),typeof w.wch=="number"&&(B+=Math.round(w.wch))),B.charAt(B.length-1)!=" "&&x.push(B)})}function h(x,m){m.forEach(function(w,v){var B="F;";w.hidden?B+="M0;":w.hpt?B+="M"+20*w.hpt+";":w.hpx&&(B+="M"+20*yp(w.hpx)+";"),B.length>2&&x.push(B+"R"+(v+1))})}function g(x,m){var w=["ID;PWXL;N;E"],v=[],B=ka(x["!ref"]),k,N=Array.isArray(x),S=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),x["!cols"]&&f(w,x["!cols"]),x["!rows"]&&h(w,x["!rows"]),w.push("B;Y"+(B.e.r-B.s.r+1)+";X"+(B.e.c-B.s.c+1)+";D"+[B.s.c,B.s.r,B.e.c,B.e.r].join(" "));for(var O=B.s.r;O<=B.e.r;++O)for(var T=B.s.c;T<=B.e.c;++T){var U=Ir({r:O,c:T});k=N?(x[O]||[])[T]:x[U],!(!k||k.v==null&&(!k.f||k.F))&&v.push(u(k,x,O,T))}return w.join(S)+S+v.join(S)+S+"E"+S}return{to_workbook:A,to_sheet:l,from_sheet:g}})(),wE=(function(){function e(s,l){switch(l.type){case"base64":return t(ho(s),l);case"binary":return t(s,l);case"buffer":return t(Zr&&Buffer.isBuffer(s)?s.toString("binary"):Ju(s),l);case"array":return t(O0(s),l)}throw new Error("Unrecognized type "+l.type)}function t(s,l){for(var A=s.split(`
`),u=-1,f=-1,h=0,g=[];h!==A.length;++h){if(A[h].trim()==="BOT"){g[++u]=[],f=0;continue}if(!(u<0)){var x=A[h].trim().split(","),m=x[0],w=x[1];++h;for(var v=A[h]||"";(v.match(/["]/g)||[]).length&1&&h<A.length-1;)v+=`
`+A[++h];switch(v=v.trim(),+m){case-1:if(v==="BOT"){g[++u]=[],f=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?g[u][f]=!0:v==="FALSE"?g[u][f]=!1:isNaN(AA(w))?isNaN(xf(w).getDate())?g[u][f]=w:g[u][f]=Bn(w):g[u][f]=AA(w),++f;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),g[u][f++]=v!==""?v:null;break}if(v==="EOD")break}}return l&&l.sheetRows&&(g=g.slice(0,l.sheetRows)),g}function r(s,l){return Sf(e(s,l),l)}function a(s,l){return Zu(r(s,l),l)}var n=(function(){var s=function(u,f,h,g,x){u.push(f),u.push(h+","+g),u.push('"'+x.replace(/"/g,'""')+'"')},l=function(u,f,h,g){u.push(f+","+h),u.push(f==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(u){var f=[],h=ka(u["!ref"]),g,x=Array.isArray(u);s(f,"TABLE",0,1,"sheetjs"),s(f,"VECTORS",0,h.e.r-h.s.r+1,""),s(f,"TUPLES",0,h.e.c-h.s.c+1,""),s(f,"DATA",0,0,"");for(var m=h.s.r;m<=h.e.r;++m){l(f,-1,0,"BOT");for(var w=h.s.c;w<=h.e.c;++w){var v=Ir({r:m,c:w});if(g=x?(u[m]||[])[w]:u[v],!g){l(f,1,0,"");continue}switch(g.t){case"n":var B=g.w;!B&&g.v!=null&&(B=g.v),B==null?g.f&&!g.F?l(f,1,0,"="+g.f):l(f,1,0,""):l(f,0,B,"V");break;case"b":l(f,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":l(f,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=Oo(g.z||Lr[14],zs(Bn(g.v)))),l(f,0,g.w,"V");break;default:l(f,1,0,"")}}}l(f,-1,0,"EOD");var k=`\r
`,N=f.join(k);return N}})();return{to_workbook:a,to_sheet:r,from_sheet:n}})(),yE=(function(){function e(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(g,x){for(var m=g.split(`
`),w=-1,v=-1,B=0,k=[];B!==m.length;++B){var N=m[B].trim().split(":");if(N[0]==="cell"){var S=Pn(N[1]);if(k.length<=S.r)for(w=k.length;w<=S.r;++w)k[w]||(k[w]=[]);switch(w=S.r,v=S.c,N[2]){case"t":k[w][v]=e(N[3]);break;case"v":k[w][v]=+N[3];break;case"vtf":var O=N[N.length-1];case"vtc":N[3]==="nl"?k[w][v]=!!+N[4]:k[w][v]=+N[4],N[2]=="vtf"&&(k[w][v]=[k[w][v],O])}}}return x&&x.sheetRows&&(k=k.slice(0,x.sheetRows)),k}function a(g,x){return Sf(r(g,x),x)}function n(g,x){return Zu(a(g,x),x)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,A=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function f(g){if(!g||!g["!ref"])return"";for(var x=[],m=[],w,v="",B=Rl(g["!ref"]),k=Array.isArray(g),N=B.s.r;N<=B.e.r;++N)for(var S=B.s.c;S<=B.e.c;++S)if(v=Ir({r:N,c:S}),w=k?(g[N]||[])[S]:g[v],!(!w||w.v==null||w.t==="z")){switch(m=["cell",v,"t"],w.t){case"s":case"str":m.push(t(w.v));break;case"n":w.f?(m[2]="vtf",m[3]="n",m[4]=w.v,m[5]=t(w.f)):(m[2]="v",m[3]=w.v);break;case"b":m[2]="vt"+(w.f?"f":"c"),m[3]="nl",m[4]=w.v?"1":"0",m[5]=t(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var O=zs(Bn(w.v));m[2]="vtc",m[3]="nd",m[4]=""+O,m[5]=w.w||Oo(w.z||Lr[14],O);break;case"e":continue}x.push(m.join(":"))}return x.push("sheet:c:"+(B.e.c-B.s.c+1)+":r:"+(B.e.r-B.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function h(g){return[s,l,A,l,f(g),u].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:h}})(),bf=(function(){function e(h,g,x,m,w){w.raw?g[x][m]=h:h===""||(h==="TRUE"?g[x][m]=!0:h==="FALSE"?g[x][m]=!1:isNaN(AA(h))?isNaN(xf(h).getDate())?g[x][m]=h:g[x][m]=Bn(h):g[x][m]=AA(h))}function t(h,g){var x=g||{},m=[];if(!h||h.length===0)return m;for(var w=h.split(/[\r\n]/),v=w.length-1;v>=0&&w[v].length===0;)--v;for(var B=10,k=0,N=0;N<=v;++N)k=w[N].indexOf(" "),k==-1?k=w[N].length:k++,B=Math.max(B,k);for(N=0;N<=v;++N){m[N]=[];var S=0;for(e(w[N].slice(0,B).trim(),m,N,S,x),S=1;S<=(w[N].length-B)/10+1;++S)e(w[N].slice(B+(S-1)*10,B+S*10).trim(),m,N,S,x)}return x.sheetRows&&(m=m.slice(0,x.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(h){for(var g={},x=!1,m=0,w=0;m<h.length;++m)(w=h.charCodeAt(m))==34?x=!x:!x&&w in r&&(g[w]=(g[w]||0)+1);w=[];for(m in g)Object.prototype.hasOwnProperty.call(g,m)&&w.push([g[m],m]);if(!w.length){g=a;for(m in g)Object.prototype.hasOwnProperty.call(g,m)&&w.push([g[m],m])}return w.sort(function(v,B){return v[0]-B[0]||a[v[1]]-a[B[1]]}),r[w.pop()[1]]||44}function s(h,g){var x=g||{},m="",w=x.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(m=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(m=h.charAt(4),h=h.slice(6)):m=n(h.slice(0,1024)):x&&x.FS?m=x.FS:m=n(h.slice(0,1024));var B=0,k=0,N=0,S=0,O=0,T=m.charCodeAt(0),U=!1,D=0,H=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var j=x.dateNF!=null?lj(x.dateNF):null;function W(){var I=h.slice(S,O),Q={};if(I.charAt(0)=='"'&&I.charAt(I.length-1)=='"'&&(I=I.slice(1,-1).replace(/""/g,'"')),I.length===0)Q.t="z";else if(x.raw)Q.t="s",Q.v=I;else if(I.trim().length===0)Q.t="s",Q.v=I;else if(I.charCodeAt(0)==61)I.charCodeAt(1)==34&&I.charCodeAt(I.length-1)==34?(Q.t="s",Q.v=I.slice(2,-1).replace(/""/g,'"')):IO(I)?(Q.t="n",Q.f=I.slice(1)):(Q.t="s",Q.v=I);else if(I=="TRUE")Q.t="b",Q.v=!0;else if(I=="FALSE")Q.t="b",Q.v=!1;else if(!isNaN(N=AA(I)))Q.t="n",x.cellText!==!1&&(Q.w=I),Q.v=N;else if(!isNaN(xf(I).getDate())||j&&I.match(j)){Q.z=x.dateNF||Lr[14];var Y=0;j&&I.match(j)&&(I=oj(I,x.dateNF,I.match(j)||[]),Y=1),x.cellDates?(Q.t="d",Q.v=Bn(I,Y)):(Q.t="n",Q.v=zs(Bn(I,Y))),x.cellText!==!1&&(Q.w=Oo(Q.z,Q.v instanceof Date?zs(Q.v):Q.v)),x.cellNF||delete Q.z}else Q.t="s",Q.v=I;if(Q.t=="z"||(x.dense?(w[B]||(w[B]=[]),w[B][k]=Q):w[Ir({c:k,r:B})]=Q),S=O+1,H=h.charCodeAt(S),v.e.c<k&&(v.e.c=k),v.e.r<B&&(v.e.r=B),D==T)++k;else if(k=0,++B,x.sheetRows&&x.sheetRows<=B)return!0}e:for(;O<h.length;++O)switch(D=h.charCodeAt(O)){case 34:H===34&&(U=!U);break;case T:case 10:case 13:if(!U&&W())break e;break}return O-S>0&&W(),w["!ref"]=Wr(v),w}function l(h,g){return!(g&&g.PRN)||g.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?s(h,g):Sf(t(h,g),g)}function A(h,g){var x="",m=g.type=="string"?[0,0,0,0]:ry(h,g);switch(g.type){case"base64":x=ho(h);break;case"binary":x=h;break;case"buffer":g.codepage==65001?x=h.toString("utf8"):g.codepage&&typeof dp<"u"||(x=Zr&&Buffer.isBuffer(h)?h.toString("binary"):Ju(h));break;case"array":x=O0(h);break;case"string":x=h;break;default:throw new Error("Unrecognized type "+g.type)}return m[0]==239&&m[1]==187&&m[2]==191?x=en(x.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?x=en(x):g.type=="binary"&&typeof dp<"u",x.slice(0,19)=="socialcalc:version:"?yE.to_sheet(g.type=="string"?x:en(x),g):l(x,g)}function u(h,g){return Zu(A(h,g),g)}function f(h){for(var g=[],x=ka(h["!ref"]),m,w=Array.isArray(h),v=x.s.r;v<=x.e.r;++v){for(var B=[],k=x.s.c;k<=x.e.c;++k){var N=Ir({r:v,c:k});if(m=w?(h[v]||[])[k]:h[N],!m||m.v==null){B.push("          ");continue}for(var S=(m.w||(zc(m),m.w)||"").slice(0,10);S.length<10;)S+=" ";B.push(S+(k===0?" ":""))}g.push(B.join(""))}return g.join(`
`)}return{to_workbook:u,to_sheet:A,from_sheet:f}})();function yQ(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var n=vE.to_workbook(e,r);return r.WTF=a,n}catch(s){if(r.WTF=a,!s.message.match(/SYLK bad record ID/)&&a)throw s;return bf.to_workbook(e,t)}}var T0=(function(){function e(F,R,M){if(F){vi(F,F.l||0);for(var P=M.Enum||Se;F.l<F.length;){var re=F.read_shift(2),ge=P[re]||P[65535],Ce=F.read_shift(2),de=F.l+Ce,be=ge.f&&ge.f(F,Ce,M);if(F.l=de,R(be,ge,re))return}}}function t(F,R){switch(R.type){case"base64":return r(oo(ho(F)),R);case"binary":return r(oo(F),R);case"buffer":case"array":return r(F,R)}throw"Unsupported type "+R.type}function r(F,R){if(!F)return F;var M=R||{},P=M.dense?[]:{},re="Sheet1",ge="",Ce=0,de={},be=[],Le=[],ie={s:{r:0,c:0},e:{r:0,c:0}},_e=M.sheetRows||0;if(F[2]==0&&(F[3]==8||F[3]==9)&&F.length>=16&&F[14]==5&&F[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(F[2]==2)M.Enum=Se,e(F,function(He,ct,Xe){switch(Xe){case 0:M.vers=He,He>=4096&&(M.qpro=!0);break;case 6:ie=He;break;case 204:He&&(ge=He);break;case 222:ge=He;break;case 15:case 51:M.qpro||(He[1].v=He[1].v.slice(1));case 13:case 14:case 16:Xe==14&&(He[2]&112)==112&&(He[2]&15)>1&&(He[2]&15)<15&&(He[1].z=M.dateNF||Lr[14],M.cellDates&&(He[1].t="d",He[1].v=Wx(He[1].v))),M.qpro&&He[3]>Ce&&(P["!ref"]=Wr(ie),de[re]=P,be.push(re),P=M.dense?[]:{},ie={s:{r:0,c:0},e:{r:0,c:0}},Ce=He[3],re=ge||"Sheet"+(Ce+1),ge="");var Ut=M.dense?(P[He[0].r]||[])[He[0].c]:P[Ir(He[0])];if(Ut){Ut.t=He[1].t,Ut.v=He[1].v,He[1].z!=null&&(Ut.z=He[1].z),He[1].f!=null&&(Ut.f=He[1].f);break}M.dense?(P[He[0].r]||(P[He[0].r]=[]),P[He[0].r][He[0].c]=He[1]):P[Ir(He[0])]=He[1];break}},M);else if(F[2]==26||F[2]==14)M.Enum=we,F[2]==14&&(M.qpro=!0,F.l=0),e(F,function(He,ct,Xe){switch(Xe){case 204:re=He;break;case 22:He[1].v=He[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(He[3]>Ce&&(P["!ref"]=Wr(ie),de[re]=P,be.push(re),P=M.dense?[]:{},ie={s:{r:0,c:0},e:{r:0,c:0}},Ce=He[3],re="Sheet"+(Ce+1)),_e>0&&He[0].r>=_e)break;M.dense?(P[He[0].r]||(P[He[0].r]=[]),P[He[0].r][He[0].c]=He[1]):P[Ir(He[0])]=He[1],ie.e.c<He[0].c&&(ie.e.c=He[0].c),ie.e.r<He[0].r&&(ie.e.r=He[0].r);break;case 27:He[14e3]&&(Le[He[14e3][0]]=He[14e3][1]);break;case 1537:Le[He[0]]=He[1],He[0]==Ce&&(re=He[1]);break}},M);else throw new Error("Unrecognized LOTUS BOF "+F[2]);if(P["!ref"]=Wr(ie),de[ge||re]=P,be.push(ge||re),!Le.length)return{SheetNames:be,Sheets:de};for(var je={},J=[],ze=0;ze<Le.length;++ze)de[be[ze]]?(J.push(Le[ze]||be[ze]),je[Le[ze]]=de[Le[ze]]||de[be[ze]]):(J.push(Le[ze]),je[Le[ze]]={"!ref":"A1"});return{SheetNames:J,Sheets:je}}function a(F,R){var M=R||{};if(+M.codepage>=0&&lA(+M.codepage),M.type=="string")throw new Error("Cannot write WK1 to JS string");var P=Ql(),re=ka(F["!ref"]),ge=Array.isArray(F),Ce=[];Ht(P,0,s(1030)),Ht(P,6,u(re));for(var de=Math.min(re.e.r,8191),be=re.s.r;be<=de;++be)for(var Le=xs(be),ie=re.s.c;ie<=re.e.c;++ie){be===re.s.r&&(Ce[ie]=Hn(ie));var _e=Ce[ie]+Le,je=ge?(F[be]||[])[ie]:F[_e];if(!(!je||je.t=="z"))if(je.t=="n")(je.v|0)==je.v&&je.v>=-32768&&je.v<=32767?Ht(P,13,m(be,ie,je.v)):Ht(P,14,v(be,ie,je.v));else{var J=zc(je);Ht(P,15,g(be,ie,J.slice(0,239)))}}return Ht(P,1),P.end()}function n(F,R){var M=R||{};if(+M.codepage>=0&&lA(+M.codepage),M.type=="string")throw new Error("Cannot write WK3 to JS string");var P=Ql();Ht(P,0,l(F));for(var re=0,ge=0;re<F.SheetNames.length;++re)(F.Sheets[F.SheetNames[re]]||{})["!ref"]&&Ht(P,27,G(F.SheetNames[re],ge++));var Ce=0;for(re=0;re<F.SheetNames.length;++re){var de=F.Sheets[F.SheetNames[re]];if(!(!de||!de["!ref"])){for(var be=ka(de["!ref"]),Le=Array.isArray(de),ie=[],_e=Math.min(be.e.r,8191),je=be.s.r;je<=_e;++je)for(var J=xs(je),ze=be.s.c;ze<=be.e.c;++ze){je===be.s.r&&(ie[ze]=Hn(ze));var He=ie[ze]+J,ct=Le?(de[je]||[])[ze]:de[He];if(!(!ct||ct.t=="z"))if(ct.t=="n")Ht(P,23,W(je,ze,Ce,ct.v));else{var Xe=zc(ct);Ht(P,22,D(je,ze,Ce,Xe.slice(0,239)))}}++Ce}}return Ht(P,1),P.end()}function s(F){var R=lt(2);return R.write_shift(2,F),R}function l(F){var R=lt(26);R.write_shift(2,4096),R.write_shift(2,4),R.write_shift(4,0);for(var M=0,P=0,re=0,ge=0;ge<F.SheetNames.length;++ge){var Ce=F.SheetNames[ge],de=F.Sheets[Ce];if(!(!de||!de["!ref"])){++re;var be=Rl(de["!ref"]);M<be.e.r&&(M=be.e.r),P<be.e.c&&(P=be.e.c)}}return M>8191&&(M=8191),R.write_shift(2,M),R.write_shift(1,re),R.write_shift(1,P),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(1,1),R.write_shift(1,2),R.write_shift(4,0),R.write_shift(4,0),R}function A(F,R,M){var P={s:{c:0,r:0},e:{c:0,r:0}};return R==8&&M.qpro?(P.s.c=F.read_shift(1),F.l++,P.s.r=F.read_shift(2),P.e.c=F.read_shift(1),F.l++,P.e.r=F.read_shift(2),P):(P.s.c=F.read_shift(2),P.s.r=F.read_shift(2),R==12&&M.qpro&&(F.l+=2),P.e.c=F.read_shift(2),P.e.r=F.read_shift(2),R==12&&M.qpro&&(F.l+=2),P.s.c==65535&&(P.s.c=P.e.c=P.s.r=P.e.r=0),P)}function u(F){var R=lt(8);return R.write_shift(2,F.s.c),R.write_shift(2,F.s.r),R.write_shift(2,F.e.c),R.write_shift(2,F.e.r),R}function f(F,R,M){var P=[{c:0,r:0},{t:"n",v:0},0,0];return M.qpro&&M.vers!=20768?(P[0].c=F.read_shift(1),P[3]=F.read_shift(1),P[0].r=F.read_shift(2),F.l+=2):(P[2]=F.read_shift(1),P[0].c=F.read_shift(2),P[0].r=F.read_shift(2)),P}function h(F,R,M){var P=F.l+R,re=f(F,R,M);if(re[1].t="s",M.vers==20768){F.l++;var ge=F.read_shift(1);return re[1].v=F.read_shift(ge,"utf8"),re}return M.qpro&&F.l++,re[1].v=F.read_shift(P-F.l,"cstr"),re}function g(F,R,M){var P=lt(7+M.length);P.write_shift(1,255),P.write_shift(2,R),P.write_shift(2,F),P.write_shift(1,39);for(var re=0;re<P.length;++re){var ge=M.charCodeAt(re);P.write_shift(1,ge>=128?95:ge)}return P.write_shift(1,0),P}function x(F,R,M){var P=f(F,R,M);return P[1].v=F.read_shift(2,"i"),P}function m(F,R,M){var P=lt(7);return P.write_shift(1,255),P.write_shift(2,R),P.write_shift(2,F),P.write_shift(2,M,"i"),P}function w(F,R,M){var P=f(F,R,M);return P[1].v=F.read_shift(8,"f"),P}function v(F,R,M){var P=lt(13);return P.write_shift(1,255),P.write_shift(2,R),P.write_shift(2,F),P.write_shift(8,M,"f"),P}function B(F,R,M){var P=F.l+R,re=f(F,R,M);if(re[1].v=F.read_shift(8,"f"),M.qpro)F.l=P;else{var ge=F.read_shift(2);O(F.slice(F.l,F.l+ge),re),F.l+=ge}return re}function k(F,R,M){var P=R&32768;return R&=-32769,R=(P?F:0)+(R>=8192?R-16384:R),(P?"":"$")+(M?Hn(R):xs(R))}var N={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},S=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function O(F,R){vi(F,0);for(var M=[],P=0,re="",ge="",Ce="",de="";F.l<F.length;){var be=F[F.l++];switch(be){case 0:M.push(F.read_shift(8,"f"));break;case 1:ge=k(R[0].c,F.read_shift(2),!0),re=k(R[0].r,F.read_shift(2),!1),M.push(ge+re);break;case 2:{var Le=k(R[0].c,F.read_shift(2),!0),ie=k(R[0].r,F.read_shift(2),!1);ge=k(R[0].c,F.read_shift(2),!0),re=k(R[0].r,F.read_shift(2),!1),M.push(Le+ie+":"+ge+re)}break;case 3:if(F.l<F.length){console.error("WK1 premature formula end");return}break;case 4:M.push("("+M.pop()+")");break;case 5:M.push(F.read_shift(2));break;case 6:{for(var _e="";be=F[F.l++];)_e+=String.fromCharCode(be);M.push('"'+_e.replace(/"/g,'""')+'"')}break;case 8:M.push("-"+M.pop());break;case 23:M.push("+"+M.pop());break;case 22:M.push("NOT("+M.pop()+")");break;case 20:case 21:de=M.pop(),Ce=M.pop(),M.push(["AND","OR"][be-20]+"("+Ce+","+de+")");break;default:if(be<32&&S[be])de=M.pop(),Ce=M.pop(),M.push(Ce+S[be]+de);else if(N[be]){if(P=N[be][1],P==69&&(P=F[F.l++]),P>M.length){console.error("WK1 bad formula parse 0x"+be.toString(16)+":|"+M.join("|")+"|");return}var je=M.slice(-P);M.length-=P,M.push(N[be][0]+"("+je.join(",")+")")}else return be<=7?console.error("WK1 invalid opcode "+be.toString(16)):be<=24?console.error("WK1 unsupported op "+be.toString(16)):be<=30?console.error("WK1 invalid opcode "+be.toString(16)):be<=115?console.error("WK1 unsupported function opcode "+be.toString(16)):console.error("WK1 unrecognized opcode "+be.toString(16))}}M.length==1?R[1].f=""+M[0]:console.error("WK1 bad formula parse |"+M.join("|")+"|")}function T(F){var R=[{c:0,r:0},{t:"n",v:0},0];return R[0].r=F.read_shift(2),R[3]=F[F.l++],R[0].c=F[F.l++],R}function U(F,R){var M=T(F);return M[1].t="s",M[1].v=F.read_shift(R-4,"cstr"),M}function D(F,R,M,P){var re=lt(6+P.length);re.write_shift(2,F),re.write_shift(1,M),re.write_shift(1,R),re.write_shift(1,39);for(var ge=0;ge<P.length;++ge){var Ce=P.charCodeAt(ge);re.write_shift(1,Ce>=128?95:Ce)}return re.write_shift(1,0),re}function H(F,R){var M=T(F);M[1].v=F.read_shift(2);var P=M[1].v>>1;if(M[1].v&1)switch(P&7){case 0:P=(P>>3)*5e3;break;case 1:P=(P>>3)*500;break;case 2:P=(P>>3)/20;break;case 3:P=(P>>3)/200;break;case 4:P=(P>>3)/2e3;break;case 5:P=(P>>3)/2e4;break;case 6:P=(P>>3)/16;break;case 7:P=(P>>3)/64;break}return M[1].v=P,M}function j(F,R){var M=T(F),P=F.read_shift(4),re=F.read_shift(4),ge=F.read_shift(2);if(ge==65535)return P===0&&re===3221225472?(M[1].t="e",M[1].v=15):P===0&&re===3489660928?(M[1].t="e",M[1].v=42):M[1].v=0,M;var Ce=ge&32768;return ge=(ge&32767)-16446,M[1].v=(1-Ce*2)*(re*Math.pow(2,ge+32)+P*Math.pow(2,ge)),M}function W(F,R,M,P){var re=lt(14);if(re.write_shift(2,F),re.write_shift(1,M),re.write_shift(1,R),P==0)return re.write_shift(4,0),re.write_shift(4,0),re.write_shift(2,65535),re;var ge=0,Ce=0,de=0,be=0;return P<0&&(ge=1,P=-P),Ce=Math.log2(P)|0,P/=Math.pow(2,Ce-31),be=P>>>0,(be&2147483648)==0&&(P/=2,++Ce,be=P>>>0),P-=be,be|=2147483648,be>>>=0,P*=Math.pow(2,32),de=P>>>0,re.write_shift(4,de),re.write_shift(4,be),Ce+=16383+(ge?32768:0),re.write_shift(2,Ce),re}function I(F,R){var M=j(F);return F.l+=R-14,M}function Q(F,R){var M=T(F),P=F.read_shift(4);return M[1].v=P>>6,M}function Y(F,R){var M=T(F),P=F.read_shift(8,"f");return M[1].v=P,M}function z(F,R){var M=Y(F);return F.l+=R-10,M}function ue(F,R){return F[F.l+R-1]==0?F.read_shift(R,"cstr"):""}function Z(F,R){var M=F[F.l++];M>R-1&&(M=R-1);for(var P="";P.length<M;)P+=String.fromCharCode(F[F.l++]);return P}function Ae(F,R,M){if(!(!M.qpro||R<21)){var P=F.read_shift(1);F.l+=17,F.l+=1,F.l+=2;var re=F.read_shift(R-21,"cstr");return[P,re]}}function ve(F,R){for(var M={},P=F.l+R;F.l<P;){var re=F.read_shift(2);if(re==14e3){for(M[re]=[0,""],M[re][0]=F.read_shift(2);F[F.l];)M[re][1]+=String.fromCharCode(F[F.l]),F.l++;F.l++}}return M}function G(F,R){var M=lt(5+F.length);M.write_shift(2,14e3),M.write_shift(2,R);for(var P=0;P<F.length;++P){var re=F.charCodeAt(P);M[M.l++]=re>127?95:re}return M[M.l++]=0,M}var Se={0:{n:"BOF",f:Fs},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:A},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:B},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ue},222:{n:"SHEETNAMELP",f:Z},65535:{n:""}},we={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:U},23:{n:"NUMBER17",f:j},24:{n:"NUMBER18",f:H},25:{n:"FORMULA19",f:I},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ve},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Q},38:{n:"??"},39:{n:"NUMBER27",f:Y},40:{n:"FORMULA28",f:z},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ue},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ae},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:t}})();function _Q(e){var t={},r=e.match(Gi),a=0,n=!1;if(r)for(;a!=r.length;++a){var s=Qr(r[a]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=b2[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(s[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+s[0])}}return t}var BQ=(function(){var e=pp("t"),t=pp("rPr");function r(s){var l=s.match(e);if(!l)return{t:"s",v:""};var A={t:"s",v:Ba(l[1])},u=s.match(t);return u&&(A.s=_Q(u[1])),A}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(l){return l.replace(a,"").split(n).map(r).filter(function(A){return A.v})}})(),kQ=(function(){var t=/(\r\n|\n)/g;function r(n,s,l){var A=[];n.u&&A.push("text-decoration: underline;"),n.uval&&A.push("text-underline-style:"+n.uval+";"),n.sz&&A.push("font-size:"+n.sz+"pt;"),n.outline&&A.push("text-effect: outline;"),n.shadow&&A.push("text-shadow: auto;"),s.push('<span style="'+A.join("")+'">'),n.b&&(s.push("<b>"),l.push("</b>")),n.i&&(s.push("<i>"),l.push("</i>")),n.strike&&(s.push("<s>"),l.push("</s>"));var u=n.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(s.push("<"+u+">"),l.push("</"+u+">")),l.push("</span>"),n}function a(n){var s=[[],n.v,[]];return n.v?(n.s&&r(n.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(a).join("")}})(),CQ=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,SQ=/<(?:\w+:)?r>/,EQ=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function K2(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=Ba(en(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=en(e),r&&(a.h=N2(a.t))):e.match(SQ)&&(a.r=en(e),a.t=Ba(en((e.replace(EQ,"").match(CQ)||[]).join("").replace(Gi,""))),r&&(a.h=kQ(BQ(a.r)))),a):{t:""}}var NQ=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,FQ=/<(?:\w+:)?(?:si|sstItem)>/g,TQ=/<\/(?:\w+:)?(?:si|sstItem)>/;function LQ(e,t){var r=[],a="";if(!e)return r;var n=e.match(NQ);if(n){a=n[2].replace(FQ,"").split(TQ);for(var s=0;s!=a.length;++s){var l=K2(a[s].trim(),t);l!=null&&(r[r.length]=l)}n=Qr(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}var UQ=/^\s|\s$|[\t\n\r]/;function _E(e,t){if(!t.bookSST)return"";var r=[bs];r[r.length]=Mt("sst",null,{xmlns:z0[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var n=e[a],s="<si>";n.r?s+=n.r:(s+="<t",n.t||(n.t=""),n.t.match(UQ)&&(s+=' xml:space="preserve"'),s+=">"+Va(n.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function jQ(e){return[e.read_shift(4),e.read_shift(4)]}function DQ(e,t){var r=[],a=!1;return Wc(e,function(s,l,A){switch(A){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(l.T,!a||t.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}}),r}function IQ(e,t){return t||(t=lt(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var QQ=Gj;function OQ(e){var t=Ql();_t(t,159,IQ(e));for(var r=0;r<e.length;++r)_t(t,19,QQ(e[r]));return _t(t,160),t.end()}function BE(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function Pc(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function RQ(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Pc(e,4),t.U=Pc(e,4),t.W=Pc(e,4),t}function MQ(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},n=e.read_shift(4),s=[];n-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function HQ(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(MQ(e));return t}function PQ(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function KQ(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Pc(e,4),t.U=Pc(e,4),t.W=Pc(e,4),t}function qQ(e){var t=KQ(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function kE(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function CE(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function zQ(e){var t=Pc(e);switch(t.Minor){case 2:return[t.Minor,VQ(e)];case 3:return[t.Minor,GQ()];case 4:return[t.Minor,WQ(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function VQ(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=kE(e,r),n=CE(e,e.length-e.l);return{t:"Std",h:a,v:n}}function GQ(){throw new Error("File is password-protected: ECMA-376 Extensible")}function WQ(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(Gi,function(s){var l=Qr(s);switch(ac(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(A){a[A]=l[A]});break;case"<dataIntegrity":a.encryptedHmacKey=l.encryptedHmacKey,a.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(l);break;default:throw l[0]}}),a}function XQ(e,t){var r={},a=r.EncryptionVersionInfo=Pc(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,r.EncryptionHeader=kE(e,n),t-=n,r.EncryptionVerifier=CE(e,t),r}function YQ(e){var t={},r=t.EncryptionVersionInfo=Pc(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function q2(e){var t=0,r,a=BE(e),n=a.length+1,s,l,A,u,f;for(r=Ku(n),r[0]=a.length,s=1;s!=n;++s)r[s]=a[s-1];for(s=n-1;s>=0;--s)l=r[s],A=(t&16384)===0?0:1,u=t<<1&32767,f=A|u,t=f^l;return t^52811}var SE=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(l){return(l/2|l*128)&255},n=function(l,A){return a(l^A)},s=function(l){for(var A=t[l.length-1],u=104,f=l.length-1;f>=0;--f)for(var h=l[f],g=0;g!=7;++g)h&64&&(A^=r[u]),h*=2,--u;return A};return function(l){for(var A=BE(l),u=s(A),f=A.length,h=Ku(16),g=0;g!=16;++g)h[g]=0;var x,m,w;for((f&1)===1&&(x=u>>8,h[f]=n(e[0],x),--f,x=u&255,m=A[A.length-1],h[f]=n(m,x));f>0;)--f,x=u>>8,h[f]=n(A[f],x),--f,x=u&255,h[f]=n(A[f],x);for(f=15,w=15-A.length;w>0;)x=u>>8,h[f]=n(e[w],x),--f,--w,x=u&255,h[f]=n(A[f],x),--f,--w;return h}})(),$Q=function(e,t,r,a,n){n||(n=t),a||(a=SE(e));var s,l;for(s=0;s!=t.length;++s)l=t[s],l^=a[r],l=(l>>5|l<<3)&255,n[s]=l,++r;return[n,r,a]},JQ=function(e){var t=0,r=SE(e);return function(a){var n=$Q("",a,t,r);return t=n[1],n[0]}};function ZQ(e,t,r,a){var n={key:Fs(e),verificationBytes:Fs(e)};return r.password&&(n.verifier=q2(r.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=JQ(r.password)),n}function e7(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=YQ(e):a.Data=XQ(e,t),a}function t7(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?e7(e,t-2,a):ZQ(e,r.biff>=8?t:t-2,r,a),a}var EE=(function(){function e(n,s){switch(s.type){case"base64":return t(ho(n),s);case"binary":return t(n,s);case"buffer":return t(Zr&&Buffer.isBuffer(n)?n.toString("binary"):Ju(n),s);case"array":return t(O0(n),s)}throw new Error("Unrecognized type "+s.type)}function t(n,s){var l=s||{},A=l.dense?[]:{},u=n.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(h,g){Array.isArray(A)&&(A[g]=[]);for(var x=/\\\w+\b/g,m=0,w,v=-1;w=x.exec(h);){switch(w[0]){case"\\cell":var B=h.slice(m,x.lastIndex-w[0].length);if(B[0]==" "&&(B=B.slice(1)),++v,B.length){var k={v:B,t:"s"};Array.isArray(A)?A[g][v]=k:A[Ir({r:g,c:v})]=k}break}m=x.lastIndex}v>f.e.c&&(f.e.c=v)}),A["!ref"]=Wr(f),A}function r(n,s){return Zu(e(n,s),s)}function a(n){for(var s=["{\\rtf1\\ansi"],l=ka(n["!ref"]),A,u=Array.isArray(n),f=l.s.r;f<=l.e.r;++f){s.push("\\trowd\\trautofit1");for(var h=l.s.c;h<=l.e.c;++h)s.push("\\cellx"+(h+1));for(s.push("\\pard\\intbl"),h=l.s.c;h<=l.e.c;++h){var g=Ir({r:f,c:h});A=u?(n[f]||[])[h]:n[g],!(!A||A.v==null&&(!A.f||A.F))&&(s.push(" "+(A.w||(zc(A),A.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}})();function r7(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function bp(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function a7(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,n=Math.max(t,r,a),s=Math.min(t,r,a),l=n-s;if(l===0)return[0,0,t];var A=0,u=0,f=n+s;switch(u=l/(f>1?2-f:f),n){case t:A=((r-a)/l+6)%6;break;case r:A=(a-t)/l+2;break;case a:A=(t-r)/l+4;break}return[A/6,u,f/2]}function n7(e){var t=e[0],r=e[1],a=e[2],n=r*2*(a<.5?a:1-a),s=a-n/2,l=[s,s,s],A=6*t,u;if(r!==0)switch(A|0){case 0:case 6:u=n*A,l[0]+=n,l[1]+=u;break;case 1:u=n*(2-A),l[0]+=u,l[1]+=n;break;case 2:u=n*(A-2),l[1]+=n,l[2]+=u;break;case 3:u=n*(4-A),l[1]+=u,l[2]+=n;break;case 4:u=n*(A-4),l[2]+=n,l[0]+=u;break;case 5:u=n*(6-A),l[2]+=u,l[0]+=n;break}for(var f=0;f!=3;++f)l[f]=Math.round(l[f]*255);return l}function hx(e,t){if(t===0)return e;var r=a7(r7(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),bp(n7(r))}var NE=6,s7=15,i7=1,Ki=NE;function vp(e){return Math.floor((e+Math.round(128/Ki)/256)*Ki)}function wp(e){return Math.floor((e-5)/Ki*100+.5)/100}function px(e){return Math.round((e*Ki+5)/Ki*256)/256}function zb(e){return px(wp(vp(e)))}function z2(e){var t=Math.abs(e-zb(e)),r=Ki;if(t>.005)for(Ki=i7;Ki<s7;++Ki)Math.abs(e-zb(e))<=t&&(t=Math.abs(e-zb(e)),r=Ki);Ki=r}function qu(e){e.width?(e.wpx=vp(e.width),e.wch=wp(e.wpx),e.MDW=Ki):e.wpx?(e.wch=wp(e.wpx),e.width=px(e.wch),e.MDW=Ki):typeof e.wch=="number"&&(e.width=px(e.wch),e.wpx=vp(e.width),e.MDW=Ki),e.customWidth&&delete e.customWidth}var l7=96,FE=l7;function yp(e){return e*96/FE}function vf(e){return e*FE/96}var o7={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function A7(e,t,r,a){t.Borders=[];var n={},s=!1;(e[0].match(Gi)||[]).forEach(function(l){var A=Qr(l);switch(ac(A[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},A.diagonalUp&&(n.diagonalUp=yn(A.diagonalUp)),A.diagonalDown&&(n.diagonalDown=yn(A.diagonalDown)),t.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+A[0]+" in borders")}})}function c7(e,t,r,a){t.Fills=[];var n={},s=!1;(e[0].match(Gi)||[]).forEach(function(l){var A=Qr(l);switch(ac(A[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},t.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":A.patternType&&(n.patternType=A.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),A.indexed&&(n.bgColor.indexed=parseInt(A.indexed,10)),A.theme&&(n.bgColor.theme=parseInt(A.theme,10)),A.tint&&(n.bgColor.tint=parseFloat(A.tint)),A.rgb&&(n.bgColor.rgb=A.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),A.theme&&(n.fgColor.theme=parseInt(A.theme,10)),A.tint&&(n.fgColor.tint=parseFloat(A.tint)),A.rgb!=null&&(n.fgColor.rgb=A.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+A[0]+" in fills")}})}function u7(e,t,r,a){t.Fonts=[];var n={},s=!1;(e[0].match(Gi)||[]).forEach(function(l){var A=Qr(l);switch(ac(A[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(n),n={};break;case"<name":A.val&&(n.name=en(A.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=A.val?yn(A.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=A.val?yn(A.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(A.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=A.val?yn(A.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=A.val?yn(A.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=A.val?yn(A.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=A.val?yn(A.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=A.val?yn(A.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":A.val&&(n.sz=+A.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":A.val&&(n.vertAlign=A.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":A.val&&(n.family=parseInt(A.val,10));break;case"<family/>":case"</family>":break;case"<scheme":A.val&&(n.scheme=A.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(A.val=="1")break;A.codepage=b2[parseInt(A.val,10)];break;case"<color":if(n.color||(n.color={}),A.auto&&(n.color.auto=yn(A.auto)),A.rgb)n.color.rgb=A.rgb.slice(-6);else if(A.indexed){n.color.index=parseInt(A.indexed,10);var u=N0[n.color.index];n.color.index==81&&(u=N0[1]),u||(u=N0[1]),n.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else A.theme&&(n.color.theme=parseInt(A.theme,10),A.tint&&(n.color.tint=parseFloat(A.tint)),A.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=hx(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+A[0]+" in fonts")}})}function d7(e,t,r){t.NumberFmt=[];for(var a=as(Lr),n=0;n<a.length;++n)t.NumberFmt[a[n]]=Lr[a[n]];var s=e[0].match(Gi);if(s)for(n=0;n<s.length;++n){var l=Qr(s[n]);switch(ac(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var A=Ba(en(l.formatCode)),u=parseInt(l.numFmtId,10);if(t.NumberFmt[u]=A,u>0){if(u>392){for(u=392;u>60&&t.NumberFmt[u]!=null;--u);t.NumberFmt[u]=A}Hc(A,u)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function f7(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=Mt("numFmt",null,{numFmtId:a,formatCode:Va(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Mt("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Zg=["numFmtId","fillId","fontId","borderId","xfId"],em=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function h7(e,t,r){t.CellXf=[];var a,n=!1;(e[0].match(Gi)||[]).forEach(function(s){var l=Qr(s),A=0;switch(ac(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=l,delete a[0],A=0;A<Zg.length;++A)a[Zg[A]]&&(a[Zg[A]]=parseInt(a[Zg[A]],10));for(A=0;A<em.length;++A)a[em[A]]&&(a[em[A]]=yn(a[em[A]]));if(t.NumberFmt&&a.numFmtId>392){for(A=392;A>60;--A)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[A]){a.numFmtId=A;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};l.vertical&&(u.vertical=l.vertical),l.horizontal&&(u.horizontal=l.horizontal),l.textRotation!=null&&(u.textRotation=l.textRotation),l.indent&&(u.indent=l.indent),l.wrapText&&(u.wrapText=yn(l.wrapText)),a.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function p7(e){var t=[];return t[t.length]=Mt("cellXfs",null),e.forEach(function(r){t[t.length]=Mt("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Mt("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var g7=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(A,u,f){var h={};if(!A)return h;A=A.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var g;return(g=A.match(t))&&d7(g,h,f),(g=A.match(n))&&u7(g,h,u,f),(g=A.match(a))&&c7(g,h,u,f),(g=A.match(s))&&A7(g,h,u,f),(g=A.match(r))&&h7(g,h,f),h}})();function TE(e,t){var r=[bs,Mt("styleSheet",null,{xmlns:z0[0],"xmlns:vt":qs.vt})],a;return e.SSF&&(a=f7(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=p7(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function m7(e,t){var r=e.read_shift(2),a=zi(e);return[r,a]}function x7(e,t,r){r||(r=lt(6+4*t.length)),r.write_shift(2,e),ni(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function b7(e,t,r){var a={};a.sz=e.read_shift(2)/20;var n=eD(e);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var s=e.read_shift(2);switch(s===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(a.underline=l);var A=e.read_shift(1);A>0&&(a.family=A);var u=e.read_shift(1);switch(u>0&&(a.charset=u),e.l++,a.color=Zj(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=zi(e),a}function v7(e,t){t||(t=lt(153)),t.write_shift(2,e.sz*20),tD(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),ux(e.color,t);var a=0;return a=2,t.write_shift(1,a),ni(e.name,t),t.length>t.l?t.slice(0,t.l):t}var w7=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Vb,y7=Vi;function _4(e,t){t||(t=lt(84)),Vb||(Vb=Vx(w7));var r=Vb[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(ux({auto:1},t),ux({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function _7(e,t){var r=e.l+t,a=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:n}}function LE(e,t,r){r||(r=lt(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function vh(e,t){return t||(t=lt(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var B7=Vi;function k7(e,t){return t||(t=lt(51)),t.write_shift(1,0),vh(null,t),vh(null,t),vh(null,t),vh(null,t),vh(null,t),t.length>t.l?t.slice(0,t.l):t}function C7(e,t){return t||(t=lt(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),cx(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function S7(e,t,r){var a=lt(2052);return a.write_shift(4,e),cx(t,a),cx(r,a),a.length>a.l?a.slice(0,a.l):a}function E7(e,t,r){var a={};a.NumberFmt=[];for(var n in Lr)a.NumberFmt[n]=Lr[n];a.CellXf=[],a.Fonts=[];var s=[],l=!1;return Wc(e,function(u,f,h){switch(h){case 44:a.NumberFmt[u[0]]=u[1],Hc(u[1],u[0]);break;case 43:a.Fonts.push(u),u.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(u.color.rgb=hx(t.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&a.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:s.push(h),l=!0;break;case 38:s.pop(),l=!1;break;default:if(f.T>0)s.push(h);else if(f.T<0)s.pop();else if(!l||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),a}function N7(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&++r}),r!=0&&(_t(e,615,cA(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&_t(e,44,x7(n,t[n]))}),_t(e,616))}}function F7(e){var t=1;_t(e,611,cA(t)),_t(e,43,v7({sz:12,color:{theme:1},name:"Calibri",family:2})),_t(e,612)}function T7(e){var t=2;_t(e,603,cA(t)),_t(e,45,_4({patternType:"none"})),_t(e,45,_4({patternType:"gray125"})),_t(e,604)}function L7(e){var t=1;_t(e,613,cA(t)),_t(e,46,k7()),_t(e,614)}function U7(e){var t=1;_t(e,626,cA(t)),_t(e,47,LE({numFmtId:0},65535)),_t(e,627)}function j7(e,t){_t(e,617,cA(t.length)),t.forEach(function(r){_t(e,47,LE(r,0))}),_t(e,618)}function D7(e){var t=1;_t(e,619,cA(t)),_t(e,48,C7({xfId:0,name:"Normal"})),_t(e,620)}function I7(e){var t=0;_t(e,505,cA(t)),_t(e,506)}function Q7(e){var t=0;_t(e,508,S7(t,"TableStyleMedium9","PivotStyleMedium4")),_t(e,509)}function O7(e,t){var r=Ql();return _t(r,278),N7(r,e.SSF),F7(r),T7(r),L7(r),U7(r),j7(r,t.cellXfs),D7(r),I7(r),Q7(r),_t(r,279),r.end()}var R7=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function M7(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(Gi)||[]).forEach(function(n){var s=Qr(n);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=s.val;break;case"<a:sysClr":a.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[R7.indexOf(s[0])]=a,a={}):a.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function H7(){}function P7(){}var K7=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,q7=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,z7=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function V7(e,t,r){t.themeElements={};var a;[["clrScheme",K7,M7],["fontScheme",q7,H7],["fmtScheme",z7,P7]].forEach(function(n){if(!(a=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,t,r)})}var G7=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function UE(e,t){(!e||e.length===0)&&(e=V2());var r,a={};if(!(r=e.match(G7)))throw new Error("themeElements not found in theme");return V7(r[0],a,t),a.raw=e,a}function V2(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[bs];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function W7(e,t,r){var a=e.l+t,n=e.read_shift(4);if(n!==124226){if(!r.cellStyles){e.l=a;return}var s=e.slice(e.l);e.l=a;var l;try{l=k3(s,{type:"array"})}catch{return}var A=Ao(l,"theme/theme/theme1.xml",!0);if(A)return UE(A,r)}}function X7(e){return e.read_shift(4)}function Y7(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=$7(e,4);break;case 2:t.xclrValue=dE(e);break;case 3:t.xclrValue=X7(e);break;case 4:e.l+=4;break}return e.l+=8,t}function $7(e,t){return Vi(e,t)}function J7(e,t){return Vi(e,t)}function Z7(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=Y7(e);break;case 6:a[1]=J7(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function eO(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),s=[];n-- >0;)s.push(Z7(e,r-e.l));return{ixfe:a,ext:s}}function tO(e,t){t.forEach(function(r){r[0]})}function rO(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:zi(e)}}function aO(e){var t=lt(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),ni(e.name,t),t.slice(0,t.l)}function nO(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function sO(e){var t=lt(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function iO(e,t){var r=lt(8+2*t.length);return r.write_shift(4,e),ni(t,r),r.slice(0,r.l)}function lO(e){return e.l+=4,e.read_shift(4)!=0}function oO(e,t){var r=lt(8);return r.write_shift(4,e),r.write_shift(4,1),r}function AO(e,t,r){var a={Types:[],Cell:[],Value:[]},n=r||{},s=[],l=!1,A=2;return Wc(e,function(u,f,h){switch(h){case 335:a.Types.push({name:u.name});break;case 51:u.forEach(function(g){A==1?a.Cell.push({type:a.Types[g[0]-1].name,index:g[1]}):A==0&&a.Value.push({type:a.Types[g[0]-1].name,index:g[1]})});break;case 337:A=u?1:0;break;case 338:A=2;break;case 35:s.push(h),l=!0;break;case 36:s.pop(),l=!1;break;default:if(!f.T){if(!l||n.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),a}function cO(){var e=Ql();return _t(e,332),_t(e,334,cA(1)),_t(e,335,aO({name:"XLDAPR",version:12e4,flags:3496657072})),_t(e,336),_t(e,339,iO(1,"XLDAPR")),_t(e,52),_t(e,35,cA(514)),_t(e,4096,cA(0)),_t(e,4097,To(1)),_t(e,36),_t(e,53),_t(e,340),_t(e,337,oO(1)),_t(e,51,sO([[1,0]])),_t(e,338),_t(e,333),e.end()}function uO(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var n=!1,s=2,l;return e.replace(Gi,function(A){var u=Qr(A);switch(ac(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<a.Types.length;++f)a.Types[f].name==u.name&&(l=a.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?a.Cell.push({type:a.Types[u.t-1].name,index:+u.v}):s==0&&a.Value.push({type:a.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+u.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return A}),a}function jE(){var e=[bs];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function dO(e){var t=[];if(!e)return t;var r=1;return(e.match(Gi)||[]).forEach(function(a){var n=Qr(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n);break}}),t}function fO(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ir(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function hO(e,t,r){var a=[];return Wc(e,function(s,l,A){switch(A){case 63:a.push(s);break;default:if(!l.T)throw new Error("Unexpected record 0x"+A.toString(16))}}),a}function pO(e,t,r,a){if(!e)return e;var n=a||{},s=!1;Wc(e,function(A,u,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!u.T){if(!s||n.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},n)}function gO(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var ef=1024;function DE(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[Mt("xml",null,{"xmlns:v":io.v,"xmlns:o":io.o,"xmlns:x":io.x,"xmlns:mv":io.mv}).replace(/\/>/,">"),Mt("o:shapelayout",Mt("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Mt("v:shapetype",[Mt("v:stroke",null,{joinstyle:"miter"}),Mt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];ef<e*1e3;)ef+=1e3;return t.forEach(function(s){var l=Pn(s[0]),A={color2:"#BEFF82",type:"gradient"};A.type=="gradient"&&(A.angle="-180");var u=A.type=="gradient"?Mt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,f=Mt("v:fill",u,A),h={on:"t",obscured:"t"};++ef,n=n.concat(["<v:shape"+gp({id:"_x0000_s"+ef,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",f,Mt("v:shadow",null,h),Mt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",wi("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),wi("x:AutoFill","False"),wi("x:Row",String(l.r)),wi("x:Column",String(l.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function B4(e,t,r,a){var n=Array.isArray(e),s;t.forEach(function(l){var A=Pn(l.ref);if(n?(e[A.r]||(e[A.r]=[]),s=e[A.r][A.c]):s=e[l.ref],!s){s={t:"z"},n?e[A.r][A.c]=s:e[l.ref]=s;var u=ka(e["!ref"]||"BDWGO1000001:A1");u.s.r>A.r&&(u.s.r=A.r),u.e.r<A.r&&(u.e.r=A.r),u.s.c>A.c&&(u.s.c=A.c),u.e.c<A.c&&(u.e.c=A.c);var f=Wr(u);f!==e["!ref"]&&(e["!ref"]=f)}s.c||(s.c=[]);var h={a:l.author,t:l.t,r:l.r,T:r};l.h&&(h.h=l.h);for(var g=s.c.length-1;g>=0;--g){if(!r&&s.c[g].T)return;r&&!s.c[g].T&&s.c.splice(g,1)}if(r&&a){for(g=0;g<a.length;++g)if(h.a==a[g].id){h.a=a[g].name||h.a;break}}s.c.push(h)})}function mO(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var A=l.match(/<(?:\w+:)?author[^>]*>(.*)/);A&&r.push(A[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var A=l.match(/<(?:\w+:)?comment[^>]*>/);if(A){var u=Qr(A[0]),f={author:u.authorId&&r[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},h=Pn(u.ref);if(!(t.sheetRows&&t.sheetRows<=h.r)){var g=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),x=!!g&&!!g[1]&&K2(g[1])||{r:"",t:"",h:""};f.r=x.r,x.r=="<t></t>"&&(x.t=x.h=""),f.t=(x.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(f.h=x.h),a.push(f)}}}}),a}function IE(e){var t=[bs,Mt("comments",null,{xmlns:z0[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(n){var s=Va(n.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var n=0,s=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?n=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(u){u.a&&(n=r.indexOf(Va(u.a))),s.push(u.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+n+'"><text>'),s.length<=1)t.push(wi("t",Va(s[0]||"")));else{for(var l=`Comment:
    `+s[0]+`
`,A=1;A<s.length;++A)l+=`Reply:
    `+s[A]+`
`;t.push(wi("t",Va(l)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function xO(e,t){var r=[],a=!1,n={},s=0;return e.replace(Gi,function(A,u){var f=Qr(A);switch(ac(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":s=u+A.length;break;case"</text>":n.t=e.slice(s,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return A}),r}function bO(e,t,r){var a=[bs,Mt("ThreadedComments",null,{xmlns:qs.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var s="";(n[1]||[]).forEach(function(l,A){if(!l.T){delete l.ID;return}l.a&&t.indexOf(l.a)==-1&&t.push(l.a);var u={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};A==0?s=u.id:u.parentId=s,l.ID=u.id,l.a&&(u.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(l.a)).slice(-12)+"}"),a.push(Mt("threadedComment",wi("text",l.t||""),u))})}),a.push("</ThreadedComments>"),a.join("")}function vO(e,t){var r=[],a=!1;return e.replace(Gi,function(s){var l=Qr(s);switch(ac(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return s}),r}function wO(e){var t=[bs,Mt("personList",null,{xmlns:qs.TCMNT,"xmlns:x":z0[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(Mt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function yO(e){var t={};t.iauthor=e.read_shift(4);var r=X0(e);return t.rfx=r.s,t.ref=Ir(r.s),e.l+=16,t}function _O(e,t){return t==null&&(t=lt(36)),t.write_shift(4,e[1].iauthor),Ef(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var BO=zi;function kO(e){return ni(e.slice(0,54))}function CO(e,t){var r=[],a=[],n={},s=!1;return Wc(e,function(A,u,f){switch(f){case 632:a.push(A);break;case 635:n=A;break;case 637:n.t=A.t,n.h=A.h,n.r=A.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,t.sheetRows&&n.rfx&&t.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),r}function SO(e){var t=Ql(),r=[];return _t(t,628),_t(t,630),e.forEach(function(a){a[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),_t(t,632,kO(n.a)))})}),_t(t,631),_t(t,633),e.forEach(function(a){a[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var s={s:Pn(a[0]),e:Pn(a[0])};_t(t,635,_O([s,n])),n.t&&n.t.length>0&&_t(t,637,Xj(n)),_t(t,636),delete n.iauthor})}),_t(t,634),_t(t,629),t.end()}var EO="application/vnd.ms-office.vbaProject";function NO(e){var t=yr.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");yr.utils.cfb_add(t,n,e.FileIndex[a].content)}}),yr.write(t)}function FO(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&yr.utils.cfb_add(e,n,t.FileIndex[a].content)}})}var QE=["xlsb","xlsm","xlam","biff8","xla"];function TO(){return{"!type":"dialog"}}function LO(){return{"!type":"dialog"}}function UO(){return{"!type":"macro"}}function jO(){return{"!type":"macro"}}var cf=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,n,s,l){var A=!1,u=!1;s.length==0?u=!0:s.charAt(0)=="["&&(u=!0,s=s.slice(1,-1)),l.length==0?A=!0:l.charAt(0)=="["&&(A=!0,l=l.slice(1,-1));var f=s.length>0?parseInt(s,10)|0:0,h=l.length>0?parseInt(l,10)|0:0;return A?h+=t.c:--h,u?f+=t.r:--f,n+(A?"":"$")+Hn(h)+(u?"":"$")+xs(f)}return function(n,s){return t=s,n.replace(e,r)}})(),G2=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,W2=(function(){return function(t,r){return t.replace(G2,function(a,n,s,l,A,u){var f=j2(l)-(s?0:r.c),h=U2(u)-(A?0:r.r),g=h==0?"":A?h+1:"["+h+"]",x=f==0?"":s?f+1:"["+f+"]";return n+"R"+g+"C"+x})}})();function OE(e,t){return e.replace(G2,function(r,a,n,s,l,A){return a+(n=="$"?n+s:Hn(j2(s)+t.c))+(l=="$"?l+A:xs(U2(A)+t.r))})}function DO(e,t,r){var a=Rl(t),n=a.s,s=Pn(r),l={r:s.r-n.r,c:s.c-n.c};return OE(e,l)}function IO(e){return e.length!=1}function k4(e){return e.replace(/_xlfn\./g,"")}function Es(e){e.l+=1}function zu(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function RE(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return ME(e);r.biff==12&&(a=4)}var n=e.read_shift(a),s=e.read_shift(a),l=zu(e),A=zu(e);return{s:{r:n,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:A[0],cRel:A[1],rRel:A[2]}}}function ME(e){var t=zu(e),r=zu(e),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function QO(e,t,r){if(r.biff<8)return ME(e);var a=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),s=zu(e),l=zu(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:n,c:l[0],cRel:l[1],rRel:l[2]}}}function HE(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return OO(e);var a=e.read_shift(r&&r.biff==12?4:2),n=zu(e);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function OO(e){var t=zu(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function RO(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function MO(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return HO(e);var n=e.read_shift(a>=12?4:2),s=e.read_shift(2),l=(s&16384)>>14,A=(s&32768)>>15;if(s&=16383,A==1)for(;n>524287;)n-=1048576;if(l==1)for(;s>8191;)s=s-16384;return{r:n,c:s,cRel:l,rRel:A}}function HO(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:a}}function PO(e,t,r){var a=(e[e.l++]&96)>>5,n=RE(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,n]}function KO(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var l=RE(e,s,r);return[a,n,l]}function qO(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function zO(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[a,n]}function VO(e,t,r){var a=(e[e.l++]&96)>>5,n=QO(e,t-1,r);return[a,n]}function GO(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function C4(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function WO(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),n=[],s=0;s<=a;++s)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function XO(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function YO(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function $O(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function JO(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function PE(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function ZO(e){return e.read_shift(2),PE(e)}function eR(e){return e.read_shift(2),PE(e)}function tR(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=HE(e,0,r);return[a,n]}function rR(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=MO(e,0,r);return[a,n]}function aR(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=HE(e,0,r);return[a,n,s]}function nR(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[lM[n],zE[n],a]}function sR(e,t,r){var a=e[e.l++],n=e.read_shift(1),s=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:iR(e);return[n,(s[0]===0?zE:iM)[s[1]]]}function iR(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function lR(e,t,r){e.l+=r&&r.biff==2?3:4}function oR(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function AR(e){return e.l++,Xc[e.read_shift(1)]}function cR(e){return e.l++,e.read_shift(2)}function uR(e){return e.l++,e.read_shift(1)!==0}function dR(e){return e.l++,qi(e)}function fR(e,t,r){return e.l++,Qp(e,t-1,r)}function hR(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=cs(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Xc[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=qi(e);break;case 2:r[1]=Y0(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function pR(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),n=[],s=0;s!=a;++s)n.push((r.biff==12?X0:Xx)(e));return n}function gR(e,t,r){var a=0,n=0;r.biff==12?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--n==0&&(n=256));for(var s=0,l=[];s!=a&&(l[s]=[]);++s)for(var A=0;A!=n;++A)l[s][A]=hR(e,r.biff);return l}function mR(e,t,r){var a=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,s=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,s]}function xR(e,t,r){if(r.biff==5)return bR(e);var a=e.read_shift(1)>>>5&3,n=e.read_shift(2),s=e.read_shift(4);return[a,n,s]}function bR(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function vR(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function wR(e,t,r){var a=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function yR(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function _R(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[a,n]}var BR=Vi,kR=Vi,CR=Vi;function Rp(e,t,r){return e.l+=2,[RO(e)]}function X2(e){return e.l+=6,[]}var SR=Rp,ER=X2,NR=X2,FR=Rp;function KE(e){return e.l+=2,[Fs(e),e.read_shift(2)&1]}var TR=Rp,LR=KE,UR=X2,jR=Rp,DR=Rp,IR=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function QR(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),s=e.read_shift(2),l=IR[r>>2&31];return{ixti:t,coltype:r&3,rt:l,idx:a,c:n,C:s}}function OR(e){return e.l+=2,[e.read_shift(4)]}function RR(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function MR(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function HR(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function PR(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function KR(e){return e.l+=4,[0,0]}var S4={1:{n:"PtgExp",f:oR},2:{n:"PtgTbl",f:CR},3:{n:"PtgAdd",f:Es},4:{n:"PtgSub",f:Es},5:{n:"PtgMul",f:Es},6:{n:"PtgDiv",f:Es},7:{n:"PtgPower",f:Es},8:{n:"PtgConcat",f:Es},9:{n:"PtgLt",f:Es},10:{n:"PtgLe",f:Es},11:{n:"PtgEq",f:Es},12:{n:"PtgGe",f:Es},13:{n:"PtgGt",f:Es},14:{n:"PtgNe",f:Es},15:{n:"PtgIsect",f:Es},16:{n:"PtgUnion",f:Es},17:{n:"PtgRange",f:Es},18:{n:"PtgUplus",f:Es},19:{n:"PtgUminus",f:Es},20:{n:"PtgPercent",f:Es},21:{n:"PtgParen",f:Es},22:{n:"PtgMissArg",f:Es},23:{n:"PtgStr",f:fR},26:{n:"PtgSheet",f:RR},27:{n:"PtgEndSheet",f:MR},28:{n:"PtgErr",f:AR},29:{n:"PtgBool",f:uR},30:{n:"PtgInt",f:cR},31:{n:"PtgNum",f:dR},32:{n:"PtgArray",f:GO},33:{n:"PtgFunc",f:nR},34:{n:"PtgFuncVar",f:sR},35:{n:"PtgName",f:mR},36:{n:"PtgRef",f:tR},37:{n:"PtgArea",f:PO},38:{n:"PtgMemArea",f:vR},39:{n:"PtgMemErr",f:BR},40:{n:"PtgMemNoMem",f:kR},41:{n:"PtgMemFunc",f:wR},42:{n:"PtgRefErr",f:yR},43:{n:"PtgAreaErr",f:qO},44:{n:"PtgRefN",f:rR},45:{n:"PtgAreaN",f:VO},46:{n:"PtgMemAreaN",f:HR},47:{n:"PtgMemNoMemN",f:PR},57:{n:"PtgNameX",f:xR},58:{n:"PtgRef3d",f:aR},59:{n:"PtgArea3d",f:KO},60:{n:"PtgRefErr3d",f:_R},61:{n:"PtgAreaErr3d",f:zO},255:{}},qR={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},zR={1:{n:"PtgElfLel",f:KE},2:{n:"PtgElfRw",f:jR},3:{n:"PtgElfCol",f:SR},6:{n:"PtgElfRwV",f:DR},7:{n:"PtgElfColV",f:FR},10:{n:"PtgElfRadical",f:TR},11:{n:"PtgElfRadicalS",f:UR},13:{n:"PtgElfColS",f:ER},15:{n:"PtgElfColSV",f:NR},16:{n:"PtgElfRadicalLel",f:LR},25:{n:"PtgList",f:QR},29:{n:"PtgSxName",f:OR},255:{}},VR={0:{n:"PtgAttrNoop",f:KR},1:{n:"PtgAttrSemi",f:JO},2:{n:"PtgAttrIf",f:YO},4:{n:"PtgAttrChoose",f:WO},8:{n:"PtgAttrGoto",f:XO},16:{n:"PtgAttrSum",f:lR},32:{n:"PtgAttrBaxcel",f:C4},33:{n:"PtgAttrBaxcel",f:C4},64:{n:"PtgAttrSpace",f:ZO},65:{n:"PtgAttrSpaceSemi",f:eR},128:{n:"PtgAttrIfError",f:$O},255:{}};function Mp(e,t,r,a){if(a.biff<8)return Vi(e,t);for(var n=e.l+t,s=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=gR(e,0,a),s.push(r[l][1]);break;case"PtgMemArea":r[l][2]=pR(e,r[l][1],a),s.push(r[l][2]);break;case"PtgExp":a&&a.biff==12&&(r[l][1][1]=e.read_shift(4),s.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return t=n-e.l,t!==0&&s.push(Vi(e,t)),s}function Hp(e,t,r){for(var a=e.l+t,n,s,l=[];a!=e.l;)t=a-e.l,s=e[e.l],n=S4[s]||S4[qR[s]],(s===24||s===25)&&(n=(s===24?zR:VR)[e[e.l+1]]),!n||!n.f?Vi(e,t):l.push([n.n,n.f(e,t,r)]);return l}function GR(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],n=[],s=0;s<a.length;++s){var l=a[s];l?l[0]===2?n.push('"'+l[1].replace(/"/g,'""')+'"'):n.push(l[1]):n.push("")}t.push(n.join(","))}return t.join(";")}var WR={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function XR(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function qE(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[a[0]][0]){case 357:return n=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[a[0]][0][3]?(n=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function E4(e,t,r){var a=qE(e,t,r);return a=="#REF"?a:XR(a,r)}function Hi(e,t,r,a,n){var s=n&&n.biff||8,l={s:{c:0,r:0}},A=[],u,f,h,g=0,x=0,m,w="";if(!e[0]||!e[0][0])return"";for(var v=-1,B="",k=0,N=e[0].length;k<N;++k){var S=e[0][k];switch(S[0]){case"PtgUminus":A.push("-"+A.pop());break;case"PtgUplus":A.push("+"+A.pop());break;case"PtgPercent":A.push(A.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=A.pop(),f=A.pop(),v>=0){switch(e[0][v][1][0]){case 0:B=ts(" ",e[0][v][1][1]);break;case 1:B=ts("\r",e[0][v][1][1]);break;default:if(B="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}f=f+B,v=-1}A.push(f+WR[S[0]]+u);break;case"PtgIsect":u=A.pop(),f=A.pop(),A.push(f+" "+u);break;case"PtgUnion":u=A.pop(),f=A.pop(),A.push(f+","+u);break;case"PtgRange":u=A.pop(),f=A.pop(),A.push(f+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=zh(S[1][1],l,n),A.push(Vh(h,s));break;case"PtgRefN":h=r?zh(S[1][1],r,n):S[1][1],A.push(Vh(h,s));break;case"PtgRef3d":g=S[1][1],h=zh(S[1][2],l,n),w=E4(a,g,n),A.push(w+"!"+Vh(h,s));break;case"PtgFunc":case"PtgFuncVar":var O=S[1][0],T=S[1][1];O||(O=0),O&=127;var U=O==0?[]:A.slice(-O);A.length-=O,T==="User"&&(T=U.shift()),A.push(T+"("+U.join(",")+")");break;case"PtgBool":A.push(S[1]?"TRUE":"FALSE");break;case"PtgInt":A.push(S[1]);break;case"PtgNum":A.push(String(S[1]));break;case"PtgStr":A.push('"'+S[1].replace(/"/g,'""')+'"');break;case"PtgErr":A.push(S[1]);break;case"PtgAreaN":m=a4(S[1][1],r?{s:r}:l,n),A.push(Pb(m,n));break;case"PtgArea":m=a4(S[1][1],l,n),A.push(Pb(m,n));break;case"PtgArea3d":g=S[1][1],m=S[1][2],w=E4(a,g,n),A.push(w+"!"+Pb(m,n));break;case"PtgAttrSum":A.push("SUM("+A.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=S[1][2];var D=(a.names||[])[x-1]||(a[0]||[])[x],H=D?D.Name:"SH33TJSNAME"+String(x);H&&H.slice(0,6)=="_xlfn."&&!n.xlfn&&(H=H.slice(6)),A.push(H);break;case"PtgNameX":var j=S[1][1];x=S[1][2];var W;if(n.biff<=5)j<0&&(j=-j),a[j]&&(W=a[j][x]);else{var I="";if(((a[j]||[])[0]||[])[0]==14849||(((a[j]||[])[0]||[])[0]==1025?a[j][x]&&a[j][x].itab>0&&(I=a.SheetNames[a[j][x].itab-1]+"!"):I=a.SheetNames[x-1]+"!"),a[j]&&a[j][x])I+=a[j][x].Name;else if(a[0]&&a[0][x])I+=a[0][x].Name;else{var Q=(qE(a,j,n)||"").split(";;");Q[x-1]?I=Q[x-1]:I+="SH33TJSERRX"}A.push(I);break}W||(W={Name:"SH33TJSERRY"}),A.push(W.Name);break;case"PtgParen":var Y="(",z=")";if(v>=0){switch(B="",e[0][v][1][0]){case 2:Y=ts(" ",e[0][v][1][1])+Y;break;case 3:Y=ts("\r",e[0][v][1][1])+Y;break;case 4:z=ts(" ",e[0][v][1][1])+z;break;case 5:z=ts("\r",e[0][v][1][1])+z;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}v=-1}A.push(Y+A.pop()+z);break;case"PtgRefErr":A.push("#REF!");break;case"PtgRefErr3d":A.push("#REF!");break;case"PtgExp":h={c:S[1][1],r:S[1][0]};var ue={c:r.c,r:r.r};if(a.sharedf[Ir(h)]){var Z=a.sharedf[Ir(h)];A.push(Hi(Z,l,ue,a,n))}else{var Ae=!1;for(u=0;u!=a.arrayf.length;++u)if(f=a.arrayf[u],!(h.c<f[0].s.c||h.c>f[0].e.c)&&!(h.r<f[0].s.r||h.r>f[0].e.r)){A.push(Hi(f[1],l,ue,a,n)),Ae=!0;break}Ae||A.push(S[1])}break;case"PtgArray":A.push("{"+GR(S[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":A.push("");break;case"PtgAreaErr":A.push("#REF!");break;case"PtgAreaErr3d":A.push("#REF!");break;case"PtgList":A.push("Table"+S[1].idx+"[#"+S[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(S));default:throw new Error("Unrecognized Formula Token: "+String(S))}var ve=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&v>=0&&ve.indexOf(e[0][k][0])==-1){S=e[0][v];var G=!0;switch(S[1][0]){case 4:G=!1;case 0:B=ts(" ",S[1][1]);break;case 5:G=!1;case 1:B=ts("\r",S[1][1]);break;default:if(B="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+S[1][0])}A.push((G?B:"")+A.pop()+(G?"":B)),v=-1}}if(A.length>1&&n.WTF)throw new Error("bad formula stack");return A[0]}function YR(e,t,r){var a=e.l+t,n=r.biff==2?1:2,s,l=e.read_shift(n);if(l==65535)return[[],Vi(e,t-2)];var A=Hp(e,l,r);return t!==l+n&&(s=Mp(e,t-l-n,A,r)),e.l=a,[A,s]}function $R(e,t,r){var a=e.l+t,n=r.biff==2?1:2,s,l=e.read_shift(n);if(l==65535)return[[],Vi(e,t-2)];var A=Hp(e,l,r);return t!==l+n&&(s=Mp(e,t-l-n,A,r)),e.l=a,[A,s]}function JR(e,t,r,a){var n=e.l+t,s=Hp(e,a,r),l;return n!==e.l&&(l=Mp(e,n-e.l,s,r)),[s,l]}function ZR(e,t,r){var a=e.l+t,n,s=e.read_shift(2),l=Hp(e,s,r);return s==65535?[[],Vi(e,t-2)]:(t!==s+2&&(n=Mp(e,a-s-2,l,r)),[l,n])}function eM(e){var t;if(Rc(e,e.l+6)!==65535)return[qi(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function tM(e){if(e==null){var t=lt(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return R0(e);return R0(0)}function Gb(e,t,r){var a=e.l+t,n=nc(e);r.biff==2&&++e.l;var s=eM(e),l=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var A=$R(e,a-e.l,r);return{cell:n,val:s[0],formula:A,shared:l>>3&1,tt:s[1]}}function rM(e,t,r,a,n){var s=H0(t,r,n),l=tM(e.v),A=lt(6),u=33;A.write_shift(2,u),A.write_shift(4,0);for(var f=lt(e.bf.length),h=0;h<e.bf.length;++h)f[h]=e.bf[h];var g=ai([s,l,A,f]);return g}function Yx(e,t,r){var a=e.read_shift(4),n=Hp(e,a,r),s=e.read_shift(4),l=s>0?Mp(e,s,n,r):null;return[n,l]}var aM=Yx,$x=Yx,nM=Yx,sM=Yx,iM={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},zE={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},lM={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function N4(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function oM(e){var t="of:="+e.replace(G2,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Wb(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function AM(e){return e.replace(/\./,"!")}var Wh={},uf={},Xh=typeof Map<"u";function Y2(e,t,r){var a=0,n=e.length;if(r){if(Xh?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=Xh?r.get(t):r[t];a<s.length;++a)if(e[s[a]].t===t)return e.Count++,s[a]}}else for(;a<n;++a)if(e[a].t===t)return e.Count++,a;return e[n]={t},e.Count++,e.Unique++,r&&(Xh?(r.has(t)||r.set(t,[]),r.get(t).push(n)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(n))),n}function Jx(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(Ki=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=wp(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=px(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function L0(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function e0(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],n=60,s=e.length;if(a==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){Hc(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=a=n;break}}for(n=0;n!=s;++n)if(e[n].numFmtId===a)return n;return e[s]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function VE(e,t,r,a,n,s){try{a.cellNF&&(e.z=Lr[t])}catch(A){if(a.WTF)throw A}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Bn(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(Lr[t]==null&&Hc(ij[t]||"General",t),e.t==="e")e.w=e.w||Xc[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=hp(e.v);else if(e.t==="d"){var l=zs(e.v);(l|0)===l?e.w=l.toString(10):e.w=hp(l)}else{if(e.v===void 0)return"";e.w=Q0(e.v,uf)}else e.t==="d"?e.w=Oo(t,zs(e.v),uf):e.w=Oo(t,e.v,uf)}catch(A){if(a.WTF)throw A}if(a.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=hx(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=hx(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(A){if(a.WTF&&s.Fills)throw A}}}function cM(e,t,r){if(e&&e["!ref"]){var a=ka(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function uM(e,t){var r=ka(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Wr(r))}var dM=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,fM=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,hM=/<(?:\w:)?hyperlink [^>]*>/mg,pM=/"(\w*:\w*)"/,gM=/<(?:\w:)?col\b[^>]*[\/]?>/g,mM=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,xM=/<(?:\w:)?pageMargins[^>]*\/>/g,GE=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,bM=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,vM=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function wM(e,t,r,a,n,s,l){if(!e)return e;a||(a={"!id":{}});var A=t.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",h="",g=e.match(fM);g?(f=e.slice(0,g.index),h=e.slice(g.index+g[0].length)):f=h=e;var x=f.match(GE);x?$2(x[0],A,n,r):(x=f.match(bM))&&_M(x[0],x[1]||"",A,n,r);var m=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var w=f.slice(m,m+50).match(pM);w&&uM(A,w[1])}var v=f.match(vM);v&&v[1]&&IM(v[1],n);var B=[];if(t.cellStyles){var k=f.match(gM);k&&TM(B,k)}g&&RM(g[1],A,t,u,s,l);var N=h.match(mM);N&&(A["!autofilter"]=UM(N[0]));var S=[],O=h.match(dM);if(O)for(m=0;m!=O.length;++m)S[m]=ka(O[m].slice(O[m].indexOf('"')+1));var T=h.match(hM);T&&EM(A,T,a);var U=h.match(xM);if(U&&(A["!margins"]=NM(Qr(U[0]))),!A["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(A["!ref"]=Wr(u)),t.sheetRows>0&&A["!ref"]){var D=ka(A["!ref"]);t.sheetRows<=+D.e.r&&(D.e.r=t.sheetRows-1,D.e.r>u.e.r&&(D.e.r=u.e.r),D.e.r<D.s.r&&(D.s.r=D.e.r),D.e.c>u.e.c&&(D.e.c=u.e.c),D.e.c<D.s.c&&(D.s.c=D.e.c),A["!fullref"]=A["!ref"],A["!ref"]=Wr(D))}return B.length>0&&(A["!cols"]=B),S.length>0&&(A["!merges"]=S),A}function yM(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Wr(e[r])+'"/>';return t+"</mergeCells>"}function $2(e,t,r,a){var n=Qr(e);r.Sheets[a]||(r.Sheets[a]={}),n.codeName&&(r.Sheets[a].CodeName=Ba(en(n.codeName)))}function _M(e,t,r,a,n){$2(e.slice(0,e.indexOf(">")),r,a,n)}function BM(e,t,r,a,n){var s=!1,l={},A=null;if(a.bookType!=="xlsx"&&t.vbaraw){var u=t.SheetNames[r];try{t.Workbook&&(u=t.Workbook.Sheets[r].CodeName||u)}catch{}s=!0,l.codeName=ec(Va(u))}if(e&&e["!outline"]){var f={summaryBelow:1,summaryRight:1};e["!outline"].above&&(f.summaryBelow=0),e["!outline"].left&&(f.summaryRight=0),A=(A||"")+Mt("outlinePr",null,f)}!s&&!A||(n[n.length]=Mt("sheetPr",A,l))}var kM=["objects","scenarios","selectLockedCells","selectUnlockedCells"],CM=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function SM(e){var t={sheet:1};return kM.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),CM.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=q2(e.password).toString(16).toUpperCase()),Mt("sheetProtection",null,t)}function EM(e,t,r){for(var a=Array.isArray(e),n=0;n!=t.length;++n){var s=Qr(en(t[n]),!0);if(!s.ref)return;var l=((r||{})["!id"]||[])[s.id];l?(s.Target=l.Target,s.location&&(s.Target+="#"+Ba(s.location))):(s.Target="#"+Ba(s.location),l={Target:s.Target,TargetMode:"Internal"}),s.Rel=l,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var A=ka(s.ref),u=A.s.r;u<=A.e.r;++u)for(var f=A.s.c;f<=A.e.c;++f){var h=Ir({c:f,r:u});a?(e[u]||(e[u]=[]),e[u][f]||(e[u][f]={t:"z",v:void 0}),e[u][f].l=s):(e[h]||(e[h]={t:"z",v:void 0}),e[h].l=s)}}}function NM(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function FM(e){return L0(e),Mt("pageMargins",null,e)}function TM(e,t){for(var r=!1,a=0;a!=t.length;++a){var n=Qr(t[a],!0);n.hidden&&(n.hidden=yn(n.hidden));var s=parseInt(n.min,10)-1,l=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,z2(n.width)),qu(n);s<=l;)e[s++]=kn(n)}}function LM(e,t){for(var r=["<cols>"],a,n=0;n!=t.length;++n)(a=t[n])&&(r[r.length]=Mt("col",null,Jx(n,a)));return r[r.length]="</cols>",r.join("")}function UM(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function jM(e,t,r,a){var n=typeof e.ref=="string"?e.ref:Wr(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,l=Rl(n);l.s.r==l.e.r&&(l.e.r=Rl(t["!ref"]).e.r,n=Wr(l));for(var A=0;A<s.length;++A){var u=s[A];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==a){u.Ref="'"+r.SheetNames[a]+"'!"+n;break}}return A==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),Mt("autoFilter",null,{ref:n})}var DM=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function IM(e,t){t.Views||(t.Views=[{}]),(e.match(DM)||[]).forEach(function(r,a){var n=Qr(r);t.Views[a]||(t.Views[a]={}),+n.zoomScale&&(t.Views[a].zoom=+n.zoomScale),yn(n.rightToLeft)&&(t.Views[a].RTL=!0)})}function QM(e,t,r,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Mt("sheetViews",Mt("sheetView",null,n),{})}function OM(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",s=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=Xc[e.v];break;case"d":a&&a.cellDates?n=Bn(e.v,-1).toISOString():(e=kn(e),e.t="n",n=""+(e.v=zs(Bn(e.v)))),typeof e.z>"u"&&(e.z=Lr[14]);break;default:n=e.v;break}var A=wi("v",Va(n)),u={r:t},f=e0(a.cellXfs,e,a);switch(f!==0&&(u.s=f),e.t){case"n":break;case"d":u.t="d";break;case"b":u.t="b";break;case"e":u.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){A=wi("v",""+Y2(a.Strings,e.v,a.revStrings)),u.t="s";break}u.t="str";break}if(e.t!=s&&(e.t=s,e.v=l),typeof e.f=="string"&&e.f){var h=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;A=Mt("f",Va(e.f),h)+(e.v!=null?A:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(u.cm=1),Mt("c",A,u)}var RM=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,s=pp("v"),l=pp("f");return function(u,f,h,g,x,m){for(var w=0,v="",B=[],k=[],N=0,S=0,O=0,T="",U,D,H=0,j=0,W,I,Q=0,Y=0,z=Array.isArray(m.CellXf),ue,Z=[],Ae=[],ve=Array.isArray(f),G=[],Se={},we=!1,F=!!h.sheetStubs,R=u.split(t),M=0,P=R.length;M!=P;++M){v=R[M].trim();var re=v.length;if(re!==0){var ge=0;e:for(w=0;w<re;++w)switch(v[w]){case">":if(v[w-1]!="/"){++w;break e}if(h&&h.cellStyles){if(D=Qr(v.slice(ge,w),!0),H=D.r!=null?parseInt(D.r,10):H+1,j=-1,h.sheetRows&&h.sheetRows<H)continue;Se={},we=!1,D.ht&&(we=!0,Se.hpt=parseFloat(D.ht),Se.hpx=vf(Se.hpt)),D.hidden=="1"&&(we=!0,Se.hidden=!0),D.outlineLevel!=null&&(we=!0,Se.level=+D.outlineLevel),we&&(G[H-1]=Se)}break;case"<":ge=w;break}if(ge>=w)break;if(D=Qr(v.slice(ge,w),!0),H=D.r!=null?parseInt(D.r,10):H+1,j=-1,!(h.sheetRows&&h.sheetRows<H)){g.s.r>H-1&&(g.s.r=H-1),g.e.r<H-1&&(g.e.r=H-1),h&&h.cellStyles&&(Se={},we=!1,D.ht&&(we=!0,Se.hpt=parseFloat(D.ht),Se.hpx=vf(Se.hpt)),D.hidden=="1"&&(we=!0,Se.hidden=!0),D.outlineLevel!=null&&(we=!0,Se.level=+D.outlineLevel),we&&(G[H-1]=Se)),B=v.slice(w).split(e);for(var Ce=0;Ce!=B.length&&B[Ce].trim().charAt(0)=="<";++Ce);for(B=B.slice(Ce),w=0;w!=B.length;++w)if(v=B[w].trim(),v.length!==0){if(k=v.match(r),N=w,S=0,O=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,k!=null&&k.length===2){for(N=0,T=k[1],S=0;S!=T.length&&!((O=T.charCodeAt(S)-64)<1||O>26);++S)N=26*N+O;--N,j=N}else++j;for(S=0;S!=v.length&&v.charCodeAt(S)!==62;++S);if(++S,D=Qr(v.slice(0,S),!0),D.r||(D.r=Ir({r:H-1,c:j})),T=v.slice(S),U={t:""},(k=T.match(s))!=null&&k[1]!==""&&(U.v=Ba(k[1])),h.cellFormula){if((k=T.match(l))!=null&&k[1]!==""){if(U.f=Ba(en(k[1])).replace(/\r\n/g,`
`),h.xlfn||(U.f=k4(U.f)),k[0].indexOf('t="array"')>-1)U.F=(T.match(n)||[])[1],U.F.indexOf(":")>-1&&Z.push([ka(U.F),U.F]);else if(k[0].indexOf('t="shared"')>-1){I=Qr(k[0]);var de=Ba(en(k[1]));h.xlfn||(de=k4(de)),Ae[parseInt(I.si,10)]=[I,de,D.r]}}else(k=T.match(/<f[^>]*\/>/))&&(I=Qr(k[0]),Ae[I.si]&&(U.f=DO(Ae[I.si][1],Ae[I.si][2],D.r)));var be=Pn(D.r);for(S=0;S<Z.length;++S)be.r>=Z[S][0].s.r&&be.r<=Z[S][0].e.r&&be.c>=Z[S][0].s.c&&be.c<=Z[S][0].e.c&&(U.F=Z[S][1])}if(D.t==null&&U.v===void 0)if(U.f||U.F)U.v=0,U.t="n";else if(F)U.t="z";else continue;else U.t=D.t||"n";switch(g.s.c>j&&(g.s.c=j),g.e.c<j&&(g.e.c=j),U.t){case"n":if(U.v==""||U.v==null){if(!F)continue;U.t="z"}else U.v=parseFloat(U.v);break;case"s":if(typeof U.v>"u"){if(!F)continue;U.t="z"}else W=Wh[parseInt(U.v,10)],U.v=W.t,U.r=W.r,h.cellHTML&&(U.h=W.h);break;case"str":U.t="s",U.v=U.v!=null?en(U.v):"",h.cellHTML&&(U.h=N2(U.v));break;case"inlineStr":k=T.match(a),U.t="s",k!=null&&(W=K2(k[1]))?(U.v=W.t,h.cellHTML&&(U.h=W.h)):U.v="";break;case"b":U.v=yn(U.v);break;case"d":h.cellDates?U.v=Bn(U.v,1):(U.v=zs(Bn(U.v,1)),U.t="n");break;case"e":(!h||h.cellText!==!1)&&(U.w=U.v),U.v=X3[U.v];break}if(Q=Y=0,ue=null,z&&D.s!==void 0&&(ue=m.CellXf[D.s],ue!=null&&(ue.numFmtId!=null&&(Q=ue.numFmtId),h.cellStyles&&ue.fillId!=null&&(Y=ue.fillId))),VE(U,Q,Y,h,x,m),h.cellDates&&z&&U.t=="n"&&kf(Lr[Q])&&(U.t="d",U.v=Wx(U.v)),D.cm&&h.xlmeta){var Le=(h.xlmeta.Cell||[])[+D.cm-1];Le&&Le.type=="XLDAPR"&&(U.D=!0)}if(ve){var ie=Pn(D.r);f[ie.r]||(f[ie.r]=[]),f[ie.r][ie.c]=U}else f[D.r]=U}}}}G.length>0&&(f["!rows"]=G)}})();function MM(e,t,r,a){var n=[],s=[],l=ka(e["!ref"]),A="",u,f="",h=[],g=0,x=0,m=e["!rows"],w=Array.isArray(e),v={r:f},B,k=-1;for(x=l.s.c;x<=l.e.c;++x)h[x]=Hn(x);for(g=l.s.r;g<=l.e.r;++g){for(s=[],f=xs(g),x=l.s.c;x<=l.e.c;++x){u=h[x]+f;var N=w?(e[g]||[])[x]:e[u];N!==void 0&&(A=OM(N,u,e,t))!=null&&s.push(A)}(s.length>0||m&&m[g])&&(v={r:f},m&&m[g]&&(B=m[g],B.hidden&&(v.hidden=1),k=-1,B.hpx?k=yp(B.hpx):B.hpt&&(k=B.hpt),k>-1&&(v.ht=k,v.customHeight=1),B.level&&(v.outlineLevel=B.level)),n[n.length]=Mt("row",s.join(""),v))}if(m)for(;g<m.length;++g)m&&m[g]&&(v={r:g+1},B=m[g],B.hidden&&(v.hidden=1),k=-1,B.hpx?k=yp(B.hpx):B.hpt&&(k=B.hpt),k>-1&&(v.ht=k,v.customHeight=1),B.level&&(v.outlineLevel=B.level),n[n.length]=Mt("row","",v));return n.join("")}function WE(e,t,r,a){var n=[bs,Mt("worksheet",null,{xmlns:z0[0],"xmlns:r":qs.r})],s=r.SheetNames[e],l=0,A="",u=r.Sheets[s];u==null&&(u={});var f=u["!ref"]||"A1",h=ka(f);if(h.e.c>16383||h.e.r>1048575){if(t.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),f=Wr(h)}a||(a={}),u["!comments"]=[];var g=[];BM(u,r,e,t,n),n[n.length]=Mt("dimension",null,{ref:f}),n[n.length]=QM(u,t,e,r),t.sheetFormat&&(n[n.length]=Mt("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),u["!cols"]!=null&&u["!cols"].length>0&&(n[n.length]=LM(u,u["!cols"])),n[l=n.length]="<sheetData/>",u["!links"]=[],u["!ref"]!=null&&(A=MM(u,t),A.length>0&&(n[n.length]=A)),n.length>l+1&&(n[n.length]="</sheetData>",n[l]=n[l].replace("/>",">")),u["!protect"]&&(n[n.length]=SM(u["!protect"])),u["!autofilter"]!=null&&(n[n.length]=jM(u["!autofilter"],u,r,e)),u["!merges"]!=null&&u["!merges"].length>0&&(n[n.length]=yM(u["!merges"]));var x=-1,m,w=-1;return u["!links"].length>0&&(n[n.length]="<hyperlinks>",u["!links"].forEach(function(v){v[1].Target&&(m={ref:v[0]},v[1].Target.charAt(0)!="#"&&(w=qa(a,-1,Va(v[1].Target).replace(/#.*$/,""),na.HLINK),m["r:id"]="rId"+w),(x=v[1].Target.indexOf("#"))>-1&&(m.location=Va(v[1].Target.slice(x+1))),v[1].Tooltip&&(m.tooltip=Va(v[1].Tooltip)),n[n.length]=Mt("hyperlink",null,m))}),n[n.length]="</hyperlinks>"),delete u["!links"],u["!margins"]!=null&&(n[n.length]=FM(u["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=wi("ignoredErrors",Mt("ignoredError",null,{numberStoredAsText:1,sqref:f}))),g.length>0&&(w=qa(a,-1,"../drawings/drawing"+(e+1)+".xml",na.DRAW),n[n.length]=Mt("drawing",null,{"r:id":"rId"+w}),u["!drawing"]=g),u["!comments"].length>0&&(w=qa(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",na.VML),n[n.length]=Mt("legacyDrawing",null,{"r:id":"rId"+w}),u["!legacy"]=w),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function HM(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=a,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=n/20),r}function PM(e,t,r){var a=lt(145),n=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var s=320;n.hpx?s=yp(n.hpx)*20:n.hpt&&(s=n.hpt*20),a.write_shift(2,s),a.write_shift(1,0);var l=0;n.level&&(l|=n.level),n.hidden&&(l|=16),(n.hpx||n.hpt)&&(l|=32),a.write_shift(1,l),a.write_shift(1,0);var A=0,u=a.l;a.l+=4;for(var f={r:e,c:0},h=0;h<16;++h)if(!(t.s.c>h+1<<10||t.e.c<h<<10)){for(var g=-1,x=-1,m=h<<10;m<h+1<<10;++m){f.c=m;var w=Array.isArray(r)?(r[f.r]||[])[f.c]:r[Ir(f)];w&&(g<0&&(g=m),x=m)}g<0||(++A,a.write_shift(4,g),a.write_shift(4,x))}var v=a.l;return a.l=u,a.write_shift(4,A),a.l=v,a.length>a.l?a.slice(0,a.l):a}function KM(e,t,r,a){var n=PM(a,r,t);(n.length>17||(t["!rows"]||[])[a])&&_t(e,0,n)}var qM=X0,zM=Ef;function VM(){}function GM(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=Yj(e),r}function WM(e,t,r){r==null&&(r=lt(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var n=1;n<3;++n)r.write_shift(1,0);return ux({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),q3(e,r),r.slice(0,r.l)}function XM(e){var t=Ho(e);return[t]}function YM(e,t,r){return r==null&&(r=lt(8)),V0(t,r)}function $M(e){var t=G0(e);return[t]}function JM(e,t,r){return r==null&&(r=lt(4)),W0(t,r)}function ZM(e){var t=Ho(e),r=e.read_shift(1);return[t,r,"b"]}function e9(e,t,r){return r==null&&(r=lt(9)),V0(t,r),r.write_shift(1,e.v?1:0),r}function t9(e){var t=G0(e),r=e.read_shift(1);return[t,r,"b"]}function r9(e,t,r){return r==null&&(r=lt(5)),W0(t,r),r.write_shift(1,e.v?1:0),r}function a9(e){var t=Ho(e),r=e.read_shift(1);return[t,r,"e"]}function n9(e,t,r){return r==null&&(r=lt(9)),V0(t,r),r.write_shift(1,e.v),r}function s9(e){var t=G0(e),r=e.read_shift(1);return[t,r,"e"]}function i9(e,t,r){return r==null&&(r=lt(8)),W0(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function l9(e){var t=Ho(e),r=e.read_shift(4);return[t,r,"s"]}function o9(e,t,r){return r==null&&(r=lt(12)),V0(t,r),r.write_shift(4,t.v),r}function A9(e){var t=G0(e),r=e.read_shift(4);return[t,r,"s"]}function c9(e,t,r){return r==null&&(r=lt(8)),W0(t,r),r.write_shift(4,t.v),r}function u9(e){var t=Ho(e),r=qi(e);return[t,r,"n"]}function d9(e,t,r){return r==null&&(r=lt(16)),V0(t,r),R0(e.v,r),r}function XE(e){var t=G0(e),r=qi(e);return[t,r,"n"]}function f9(e,t,r){return r==null&&(r=lt(12)),W0(t,r),R0(e.v,r),r}function h9(e){var t=Ho(e),r=O2(e);return[t,r,"n"]}function p9(e,t,r){return r==null&&(r=lt(12)),V0(t,r),z3(e.v,r),r}function g9(e){var t=G0(e),r=O2(e);return[t,r,"n"]}function m9(e,t,r){return r==null&&(r=lt(8)),W0(t,r),z3(e.v,r),r}function x9(e){var t=Ho(e),r=D2(e);return[t,r,"is"]}function b9(e){var t=Ho(e),r=zi(e);return[t,r,"str"]}function v9(e,t,r){return r==null&&(r=lt(12+4*e.v.length)),V0(t,r),ni(e.v,r),r.length>r.l?r.slice(0,r.l):r}function w9(e){var t=G0(e),r=zi(e);return[t,r,"str"]}function y9(e,t,r){return r==null&&(r=lt(8+4*e.v.length)),W0(t,r),ni(e.v,r),r.length>r.l?r.slice(0,r.l):r}function _9(e,t,r){var a=e.l+t,n=Ho(e);n.r=r["!row"];var s=e.read_shift(1),l=[n,s,"b"];if(r.cellFormula){e.l+=2;var A=$x(e,a-e.l,r);l[3]=Hi(A,null,n,r.supbooks,r)}else e.l=a;return l}function B9(e,t,r){var a=e.l+t,n=Ho(e);n.r=r["!row"];var s=e.read_shift(1),l=[n,s,"e"];if(r.cellFormula){e.l+=2;var A=$x(e,a-e.l,r);l[3]=Hi(A,null,n,r.supbooks,r)}else e.l=a;return l}function k9(e,t,r){var a=e.l+t,n=Ho(e);n.r=r["!row"];var s=qi(e),l=[n,s,"n"];if(r.cellFormula){e.l+=2;var A=$x(e,a-e.l,r);l[3]=Hi(A,null,n,r.supbooks,r)}else e.l=a;return l}function C9(e,t,r){var a=e.l+t,n=Ho(e);n.r=r["!row"];var s=zi(e),l=[n,s,"str"];if(r.cellFormula){e.l+=2;var A=$x(e,a-e.l,r);l[3]=Hi(A,null,n,r.supbooks,r)}else e.l=a;return l}var S9=X0,E9=Ef;function N9(e,t){return t==null&&(t=lt(4)),t.write_shift(4,e),t}function F9(e,t){var r=e.l+t,a=X0(e),n=I2(e),s=zi(e),l=zi(e),A=zi(e);e.l=r;var u={rfx:a,relId:n,loc:s,display:A};return l&&(u.Tooltip=l),u}function T9(e,t){var r=lt(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Ef({s:Pn(e[0]),e:Pn(e[0])},r),Q2("rId"+t,r);var a=e[1].Target.indexOf("#"),n=a==-1?"":e[1].Target.slice(a+1);return ni(n||"",r),ni(e[1].Tooltip||"",r),ni("",r),r.slice(0,r.l)}function L9(){}function U9(e,t,r){var a=e.l+t,n=V3(e),s=e.read_shift(1),l=[n];if(l[2]=s,r.cellFormula){var A=aM(e,a-e.l,r);l[1]=A}else e.l=a;return l}function j9(e,t,r){var a=e.l+t,n=X0(e),s=[n];if(r.cellFormula){var l=sM(e,a-e.l,r);s[1]=l,e.l=a}else e.l=a;return s}function D9(e,t,r){r==null&&(r=lt(18));var a=Jx(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof a.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),r.write_shift(2,n),r}var YE=["left","right","top","bottom","header","footer"];function I9(e){var t={};return YE.forEach(function(r){t[r]=qi(e)}),t}function Q9(e,t){return t==null&&(t=lt(48)),L0(e),YE.forEach(function(r){R0(e[r],t)}),t}function O9(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function R9(e,t,r){r==null&&(r=lt(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function M9(e){var t=lt(24);return t.write_shift(4,4),t.write_shift(4,1),Ef(e,t),t}function H9(e,t){return t==null&&(t=lt(66)),t.write_shift(2,e.password?q2(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function P9(){}function K9(){}function q9(e,t,r,a,n,s,l){if(!e)return e;var A=t||{};a||(a={"!id":{}});var u=A.dense?[]:{},f,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=!1,x=!1,m,w,v,B,k,N,S,O,T,U=[];A.biff=12,A["!row"]=0;var D=0,H=!1,j=[],W={},I=A.supbooks||n.supbooks||[[]];if(I.sharedf=W,I.arrayf=j,I.SheetNames=n.SheetNames||n.Sheets.map(function(ve){return ve.name}),!A.supbooks&&(A.supbooks=I,n.Names))for(var Q=0;Q<n.Names.length;++Q)I[0][Q+1]=n.Names[Q];var Y=[],z=[],ue=!1;_p[16]={n:"BrtShortReal",f:XE};var Z;if(Wc(e,function(G,Se,we){if(!x)switch(we){case 148:f=G;break;case 0:m=G,A.sheetRows&&A.sheetRows<=m.r&&(x=!0),O=xs(B=m.r),A["!row"]=m.r,(G.hidden||G.hpt||G.level!=null)&&(G.hpt&&(G.hpx=vf(G.hpt)),z[G.r]=G);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(w={t:G[2]},G[2]){case"n":w.v=G[1];break;case"s":S=Wh[G[1]],w.v=S.t,w.r=S.r;break;case"b":w.v=!!G[1];break;case"e":w.v=G[1],A.cellText!==!1&&(w.w=Xc[w.v]);break;case"str":w.t="s",w.v=G[1];break;case"is":w.t="s",w.v=G[1].t;break}if((v=l.CellXf[G[0].iStyleRef])&&VE(w,v.numFmtId,null,A,s,l),k=G[0].c==-1?k+1:G[0].c,A.dense?(u[B]||(u[B]=[]),u[B][k]=w):u[Hn(k)+O]=w,A.cellFormula){for(H=!1,D=0;D<j.length;++D){var F=j[D];m.r>=F[0].s.r&&m.r<=F[0].e.r&&k>=F[0].s.c&&k<=F[0].e.c&&(w.F=Wr(F[0]),H=!0)}!H&&G.length>3&&(w.f=G[3])}if(h.s.r>m.r&&(h.s.r=m.r),h.s.c>k&&(h.s.c=k),h.e.r<m.r&&(h.e.r=m.r),h.e.c<k&&(h.e.c=k),A.cellDates&&v&&w.t=="n"&&kf(Lr[v.numFmtId])){var R=C0(w.v);R&&(w.t="d",w.v=new Date(R.y,R.m-1,R.d,R.H,R.M,R.S,R.u))}Z&&(Z.type=="XLDAPR"&&(w.D=!0),Z=void 0);break;case 1:case 12:if(!A.sheetStubs||g)break;w={t:"z",v:void 0},k=G[0].c==-1?k+1:G[0].c,A.dense?(u[B]||(u[B]=[]),u[B][k]=w):u[Hn(k)+O]=w,h.s.r>m.r&&(h.s.r=m.r),h.s.c>k&&(h.s.c=k),h.e.r<m.r&&(h.e.r=m.r),h.e.c<k&&(h.e.c=k),Z&&(Z.type=="XLDAPR"&&(w.D=!0),Z=void 0);break;case 176:U.push(G);break;case 49:Z=((A.xlmeta||{}).Cell||[])[G-1];break;case 494:var M=a["!id"][G.relId];for(M?(G.Target=M.Target,G.loc&&(G.Target+="#"+G.loc),G.Rel=M):G.relId==""&&(G.Target="#"+G.loc),B=G.rfx.s.r;B<=G.rfx.e.r;++B)for(k=G.rfx.s.c;k<=G.rfx.e.c;++k)A.dense?(u[B]||(u[B]=[]),u[B][k]||(u[B][k]={t:"z",v:void 0}),u[B][k].l=G):(N=Ir({c:k,r:B}),u[N]||(u[N]={t:"z",v:void 0}),u[N].l=G);break;case 426:if(!A.cellFormula)break;j.push(G),T=A.dense?u[B][k]:u[Hn(k)+O],T.f=Hi(G[1],h,{r:m.r,c:k},I,A),T.F=Wr(G[0]);break;case 427:if(!A.cellFormula)break;W[Ir(G[0].s)]=G[1],T=A.dense?u[B][k]:u[Hn(k)+O],T.f=Hi(G[1],h,{r:m.r,c:k},I,A);break;case 60:if(!A.cellStyles)break;for(;G.e>=G.s;)Y[G.e--]={width:G.w/256,hidden:!!(G.flags&1),level:G.level},ue||(ue=!0,z2(G.w/256)),qu(Y[G.e+1]);break;case 161:u["!autofilter"]={ref:Wr(G)};break;case 476:u["!margins"]=G;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),G.name&&(n.Sheets[r].CodeName=G.name),(G.above||G.left)&&(u["!outline"]={above:G.above,left:G.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),G.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:g=!0;break;case 36:g=!1;break;case 37:g=!0;break;case 38:g=!1;break;default:if(!Se.T){if(!g||A.WTF)throw new Error("Unexpected record 0x"+we.toString(16))}}},A),delete A.supbooks,delete A["!row"],!u["!ref"]&&(h.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(u["!ref"]=Wr(f||h)),A.sheetRows&&u["!ref"]){var Ae=ka(u["!ref"]);A.sheetRows<=+Ae.e.r&&(Ae.e.r=A.sheetRows-1,Ae.e.r>h.e.r&&(Ae.e.r=h.e.r),Ae.e.r<Ae.s.r&&(Ae.s.r=Ae.e.r),Ae.e.c>h.e.c&&(Ae.e.c=h.e.c),Ae.e.c<Ae.s.c&&(Ae.s.c=Ae.e.c),u["!fullref"]=u["!ref"],u["!ref"]=Wr(Ae))}return U.length>0&&(u["!merges"]=U),Y.length>0&&(u["!cols"]=Y),z.length>0&&(u["!rows"]=z),u}function z9(e,t,r,a,n,s,l){if(t.v===void 0)return!1;var A="";switch(t.t){case"b":A=t.v?"1":"0";break;case"d":t=kn(t),t.z=t.z||Lr[14],t.v=zs(Bn(t.v)),t.t="n";break;case"n":case"e":A=""+t.v;break;default:A=t.v;break}var u={r,c:a};switch(u.s=e0(n.cellXfs,t,n),t.l&&s["!links"].push([Ir(u),t.l]),t.c&&s["!comments"].push([Ir(u),t.c]),t.t){case"s":case"str":return n.bookSST?(A=Y2(n.Strings,t.v,n.revStrings),u.t="s",u.v=A,l?_t(e,18,c9(t,u)):_t(e,7,o9(t,u))):(u.t="str",l?_t(e,17,y9(t,u)):_t(e,6,v9(t,u))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?l?_t(e,13,m9(t,u)):_t(e,2,p9(t,u)):l?_t(e,16,f9(t,u)):_t(e,5,d9(t,u)),!0;case"b":return u.t="b",l?_t(e,15,r9(t,u)):_t(e,4,e9(t,u)),!0;case"e":return u.t="e",l?_t(e,14,i9(t,u)):_t(e,3,n9(t,u)),!0}return l?_t(e,12,JM(t,u)):_t(e,1,YM(t,u)),!0}function V9(e,t,r,a){var n=ka(t["!ref"]||"A1"),s,l="",A=[];_t(e,145);var u=Array.isArray(t),f=n.e.r;t["!rows"]&&(f=Math.max(n.e.r,t["!rows"].length-1));for(var h=n.s.r;h<=f;++h){l=xs(h),KM(e,t,n,h);var g=!1;if(h<=n.e.r)for(var x=n.s.c;x<=n.e.c;++x){h===n.s.r&&(A[x]=Hn(x)),s=A[x]+l;var m=u?(t[h]||[])[x]:t[s];if(!m){g=!1;continue}g=z9(e,m,h,x,a,t,g)}}_t(e,146)}function G9(e,t){!t||!t["!merges"]||(_t(e,177,N9(t["!merges"].length)),t["!merges"].forEach(function(r){_t(e,176,E9(r))}),_t(e,178))}function W9(e,t){!t||!t["!cols"]||(_t(e,390),t["!cols"].forEach(function(r,a){r&&_t(e,60,D9(a,r))}),_t(e,391))}function X9(e,t){!t||!t["!ref"]||(_t(e,648),_t(e,649,M9(ka(t["!ref"]))),_t(e,650))}function Y9(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var n=qa(r,-1,a[1].Target.replace(/#.*$/,""),na.HLINK);_t(e,494,T9(a,n))}}),delete t["!links"]}function $9(e,t,r,a){if(t["!comments"].length>0){var n=qa(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",na.VML);_t(e,551,Q2("rId"+n)),t["!legacy"]=n}}function J9(e,t,r,a){if(t["!autofilter"]){var n=t["!autofilter"],s=typeof n.ref=="string"?n.ref:Wr(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,A=Rl(s);A.s.r==A.e.r&&(A.e.r=Rl(t["!ref"]).e.r,s=Wr(A));for(var u=0;u<l.length;++u){var f=l[u];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==a){f.Ref="'"+r.SheetNames[a]+"'!"+s;break}}u==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+s}),_t(e,161,Ef(ka(s))),_t(e,162)}}function Z9(e,t,r){_t(e,133),_t(e,137,R9(t,r)),_t(e,138),_t(e,134)}function eH(e,t){t["!protect"]&&_t(e,535,H9(t["!protect"]))}function tH(e,t,r,a){var n=Ql(),s=r.SheetNames[e],l=r.Sheets[s]||{},A=s;try{r&&r.Workbook&&(A=r.Workbook.Sheets[e].CodeName||A)}catch{}var u=ka(l["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],_t(n,129),(r.vbaraw||l["!outline"])&&_t(n,147,WM(A,l["!outline"])),_t(n,148,zM(u)),Z9(n,l,r.Workbook),W9(n,l),V9(n,l,e,t),eH(n,l),J9(n,l,r,e),G9(n,l),Y9(n,l,a),l["!margins"]&&_t(n,476,Q9(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&X9(n,l),$9(n,l,e,a),_t(n,130),n.end()}function rH(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var l=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(t[+l[1]]=r?+l[2]:l[2])});var n=Ba((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){a=s.replace(/<.*?>/g,"")}),[t,n,a]}function aH(e,t,r,a,n,s){var l=s||{"!type":"chart"};if(!e)return s;var A=0,u=0,f="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(g){var x=rH(g);h.s.r=h.s.c=0,h.e.c=A,f=Hn(A),x[0].forEach(function(m,w){l[f+xs(w)]={t:"n",v:m,z:x[1]},u=w}),h.e.r<u&&(h.e.r=u),++A}),A>0&&(l["!ref"]=Wr(h)),l}function nH(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l,A=e.match(GE);return A&&$2(A[0],s,n,r),(l=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=l[1]),a["!id"][s["!rel"]]&&(s["!drawel"]=a["!id"][s["!rel"]]),s}function sH(e,t){e.l+=10;var r=zi(e);return{name:r}}function iH(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l=!1;return Wc(e,function(u,f,h){switch(h){case 550:s["!rel"]=u;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),u.name&&(n.Sheets[r].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!l||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}},t),a["!id"][s["!rel"]]&&(s["!drawel"]=a["!id"][s["!rel"]]),s}var J2=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],lH=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],oH=[],AH=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function F4(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],n=0;n!=t.length;++n){var s=t[n];if(a[s[0]]==null)a[s[0]]=s[1];else switch(s[2]){case"bool":typeof a[s[0]]=="string"&&(a[s[0]]=yn(a[s[0]]));break;case"int":typeof a[s[0]]=="string"&&(a[s[0]]=parseInt(a[s[0]],10));break}}}function T4(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=yn(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function $E(e){T4(e.WBProps,J2),T4(e.CalcPr,AH),F4(e.WBView,lH),F4(e.Sheets,oH),uf.date1904=yn(e.WBProps.date1904)}function cH(e){return!e.Workbook||!e.Workbook.WBProps?"false":yn(e.Workbook.WBProps.date1904)?"true":"false"}var uH="][*?/\\".split("");function JE(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return uH.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function dH(e,t,r){e.forEach(function(a,n){JE(a);for(var s=0;s<n;++s)if(a==e[s])throw new Error("Duplicate Sheet Name: "+a);if(r){var l=t&&t[n]&&t[n].CodeName||a;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function fH(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];dH(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)cM(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var hH=/<\w+:workbook/;function pH(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",s={},l=0;if(e.replace(Gi,function(u,f){var h=Qr(u);switch(ac(h[0])){case"<?xml":break;case"<workbook":u.match(hH)&&(n="xmlns"+u.match(/<(\w+):/)[1]),r.xmlns=h[n];break;case"</workbook>":break;case"<fileVersion":delete h[0],r.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":J2.forEach(function(g){if(h[g[0]]!=null)switch(g[2]){case"bool":r.WBProps[g[0]]=yn(h[g[0]]);break;case"int":r.WBProps[g[0]]=parseInt(h[g[0]],10);break;default:r.WBProps[g[0]]=h[g[0]]}}),h.codeName&&(r.WBProps.CodeName=en(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],r.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=Ba(en(h.name)),delete h[0],r.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":s={},s.Name=en(h.name),h.comment&&(s.Comment=h.comment),h.localSheetId&&(s.Sheet=+h.localSheetId),yn(h.hidden||"0")&&(s.Hidden=!0),l=f+u.length;break;case"</definedName>":s.Ref=Ba(en(e.slice(l,f))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete h[0],r.CalcPr=h;break;case"<calcPr/>":delete h[0],r.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return u}),z0.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return $E(r),r}function ZE(e){var t=[bs];t[t.length]=Mt("workbook",null,{xmlns:z0[0],"xmlns:r":qs.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(J2.forEach(function(A){e.Workbook.WBProps[A[0]]!=null&&e.Workbook.WBProps[A[0]]!=A[1]&&(a[A[0]]=e.Workbook.WBProps[A[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=Mt("workbookPr",null,a);var n=e.Workbook&&e.Workbook.Sheets||[],s=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!n[s]||!n[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var l={name:Va(e.SheetNames[s].slice(0,31))};if(l.sheetId=""+(s+1),l["r:id"]="rId"+(s+1),n[s])switch(n[s].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}t[t.length]=Mt("sheet",null,l)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(A){var u={name:A.Name};A.Comment&&(u.comment=A.Comment),A.Sheet!=null&&(u.localSheetId=""+A.Sheet),A.Hidden&&(u.hidden="1"),A.Ref&&(t[t.length]=Mt("definedName",Va(A.Ref),u))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function gH(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=lw(e),r.name=zi(e),r}function mH(e,t){return t||(t=lt(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Q2(e.strRelID,t),ni(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function xH(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?zi(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function bH(e,t){t||(t=lt(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),q3(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function vH(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function wH(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),s=$j(e),l=nM(e,0,r),A=I2(e);e.l=a;var u={Name:s,Ptg:l};return n<268435455&&(u.Sheet=n),A&&(u.Comment=A),u}function yH(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;t||(t={}),t.biff=12;var s=[],l=[[]];return l.SheetNames=[],l.XTI=[],_p[16]={n:"BrtFRTArchID$",f:vH},Wc(e,function(u,f,h){switch(h){case 156:l.SheetNames.push(u.name),r.Sheets.push(u);break;case 153:r.WBProps=u;break;case 39:u.Sheet!=null&&(t.SID=u.Sheet),u.Ref=Hi(u.Ptg,null,null,l,t),delete t.SID,delete u.Ptg,s.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([h,u]):l[0]=[h,u],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(u),l.XTI=l.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(h),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(h),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!f.T){if(!n||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},t),$E(r),r.Names=s,r.supbooks=l,r}function _H(e,t){_t(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,n={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};_t(e,156,mH(n))}_t(e,144)}function BH(e,t){t||(t=lt(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return ni("SheetJS",t),ni(nx.version,t),ni(nx.version,t),ni("7262",t),t.length>t.l?t.slice(0,t.l):t}function kH(e,t){t||(t=lt(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function CH(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,n=-1,s=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&n==-1?n=a:r[a].Hidden==1&&s==-1&&(s=a);s>n||(_t(e,135),_t(e,158,kH(n)),_t(e,136))}}function SH(e,t){var r=Ql();return _t(r,131),_t(r,128,BH()),_t(r,153,bH(e.Workbook&&e.Workbook.WBProps||null)),CH(r,e),_H(r,e),_t(r,132),r.end()}function EH(e,t,r){return t.slice(-4)===".bin"?yH(e,r):pH(e,r)}function NH(e,t,r,a,n,s,l,A){return t.slice(-4)===".bin"?q9(e,a,r,n,s,l,A):wM(e,a,r,n,s,l,A)}function FH(e,t,r,a,n,s,l,A){return t.slice(-4)===".bin"?iH(e,a,r,n,s):nH(e,a,r,n,s)}function TH(e,t,r,a,n,s,l,A){return t.slice(-4)===".bin"?UO():jO()}function LH(e,t,r,a,n,s,l,A){return t.slice(-4)===".bin"?TO():LO()}function UH(e,t,r,a){return t.slice(-4)===".bin"?E7(e,r,a):g7(e,r,a)}function jH(e,t,r){return UE(e,r)}function DH(e,t,r){return t.slice(-4)===".bin"?DQ(e,r):LQ(e,r)}function IH(e,t,r){return t.slice(-4)===".bin"?CO(e,r):mO(e,r)}function QH(e,t,r){return t.slice(-4)===".bin"?hO(e):dO(e)}function OH(e,t,r,a){return r.slice(-4)===".bin"?pO(e,t,r,a):void 0}function RH(e,t,r){return t.slice(-4)===".bin"?AO(e,t,r):uO(e,t,r)}function MH(e,t,r){return(t.slice(-4)===".bin"?SH:ZE)(e)}function HH(e,t,r,a,n){return(t.slice(-4)===".bin"?tH:WE)(e,r,a,n)}function PH(e,t,r){return(t.slice(-4)===".bin"?O7:TE)(e,r)}function KH(e,t,r){return(t.slice(-4)===".bin"?OQ:_E)(e,r)}function qH(e,t,r){return(t.slice(-4)===".bin"?SO:IE)(e)}function zH(e){return(e.slice(-4)===".bin"?cO:jE)()}var eN=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,tN=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function aA(e,t){var r=e.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var n=e.match(eN),s,l,A,u;if(n)for(u=0;u!=n.length;++u)s=n[u].match(tN),(l=s[1].indexOf(":"))===-1?a[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?A="xmlns"+s[1].slice(6):A=s[1].slice(l+1),a[A]=s[2].slice(1,s[2].length-1));return a}function VH(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(eN),n,s,l,A;if(a)for(A=0;A!=a.length;++A)n=a[A].match(tN),(s=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?l="xmlns"+n[1].slice(6):l=n[1].slice(s+1),r[l]=n[2].slice(1,n[2].length-1));return r}var Yh;function GH(e,t){var r=Yh[e]||Ba(e);return r==="General"?Q0(t):Oo(r,t)}function WH(e,t,r,a){var n=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=yn(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=Bn(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ba(t)]=n}function XH(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Xc[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=hp(e.v):e.w=Q0(e.v):e.w=GH(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var a=Yh[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&kf(a)){var n=C0(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(s){if(r.WTF)throw s}}}function YH(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=o7[a.Pattern]||a.Pattern)}e[t.ID]=t}function $H(e,t,r,a,n,s,l,A,u,f){var h="General",g=a.StyleID,x={};f=f||{};var m=[],w=0;for(g===void 0&&A&&(g=A.StyleID),g===void 0&&l&&(g=l.StyleID);s[g]!==void 0&&(s[g].nf&&(h=s[g].nf),s[g].Interior&&m.push(s[g].Interior),!!s[g].Parent);)g=s[g].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=yn(e);break;case"String":a.t="s",a.r=WB(Ba(e)),a.v=e.indexOf("<")>-1?Ba(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(Bn(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),a.v!==a.v?a.v=Ba(e):a.v<60&&(a.v=a.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=X3[e],f.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=WB(t||e));break}if(XH(a,h,f),f.cellFormula!==!1)if(a.Formula){var v=Ba(a.Formula);v.charCodeAt(0)==61&&(v=v.slice(1)),a.f=cf(v,n),delete a.Formula,a.ArrayRange=="RC"?a.F=cf("RC:RC",n):a.ArrayRange&&(a.F=cf(a.ArrayRange,n),u.push([ka(a.F),a.F]))}else for(w=0;w<u.length;++w)n.r>=u[w][0].s.r&&n.r<=u[w][0].e.r&&n.c>=u[w][0].s.c&&n.c<=u[w][0].e.c&&(a.F=u[w][1]);f.cellStyles&&(m.forEach(function(B){!x.patternType&&B.patternType&&(x.patternType=B.patternType)}),a.s=x),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function JH(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Xb(e,t){var r=t||{};Cf();var a=Th(F2(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=en(a));var n=a.slice(0,1024).toLowerCase(),s=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var l=kn(r);return l.type="string",bf.to_workbook(a,l)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ct){n.indexOf("<"+ct)>=0&&(s=!0)}),s)return QP(a,r);Yh={"General Number":"General","General Date":Lr[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Lr[15],"Short Date":Lr[14],"Long Time":Lr[19],"Medium Time":Lr[18],"Short Time":Lr[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Lr[2],Standard:Lr[4],Percent:Lr[10],Scientific:Lr[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var A,u=[],f,h={},g=[],x=r.dense?[]:{},m="",w={},v={},B=aA('<Data ss:Type="String">'),k=0,N=0,S=0,O={s:{r:2e6,c:2e6},e:{r:0,c:0}},T={},U={},D="",H=0,j=[],W={},I={},Q=0,Y=[],z=[],ue={},Z=[],Ae,ve=!1,G=[],Se=[],we={},F=0,R=0,M={Sheets:[],WBProps:{date1904:!1}},P={};mp.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var re="";A=mp.exec(a);)switch(A[3]=(re=A[3]).toLowerCase()){case"data":if(re=="data"){if(A[1]==="/"){if((f=u.pop())[0]!==A[3])throw new Error("Bad state: "+f.join("|"))}else A[0].charAt(A[0].length-2)!=="/"&&u.push([A[3],!0]);break}if(u[u.length-1][1])break;A[1]==="/"?$H(a.slice(k,A.index),D,B,u[u.length-1][0]=="comment"?ue:w,{c:N,r:S},T,Z[N],v,G,r):(D="",B=aA(A[0]),k=A.index+A[0].length);break;case"cell":if(A[1]==="/")if(z.length>0&&(w.c=z),(!r.sheetRows||r.sheetRows>S)&&w.v!==void 0&&(r.dense?(x[S]||(x[S]=[]),x[S][N]=w):x[Hn(N)+xs(S)]=w),w.HRef&&(w.l={Target:Ba(w.HRef)},w.HRefScreenTip&&(w.l.Tooltip=w.HRefScreenTip),delete w.HRef,delete w.HRefScreenTip),(w.MergeAcross||w.MergeDown)&&(F=N+(parseInt(w.MergeAcross,10)|0),R=S+(parseInt(w.MergeDown,10)|0),j.push({s:{c:N,r:S},e:{c:F,r:R}})),!r.sheetStubs)w.MergeAcross?N=F+1:++N;else if(w.MergeAcross||w.MergeDown){for(var ge=N;ge<=F;++ge)for(var Ce=S;Ce<=R;++Ce)(ge>N||Ce>S)&&(r.dense?(x[Ce]||(x[Ce]=[]),x[Ce][ge]={t:"z"}):x[Hn(ge)+xs(Ce)]={t:"z"});N=F+1}else++N;else w=VH(A[0]),w.Index&&(N=+w.Index-1),N<O.s.c&&(O.s.c=N),N>O.e.c&&(O.e.c=N),A[0].slice(-2)==="/>"&&++N,z=[];break;case"row":A[1]==="/"||A[0].slice(-2)==="/>"?(S<O.s.r&&(O.s.r=S),S>O.e.r&&(O.e.r=S),A[0].slice(-2)==="/>"&&(v=aA(A[0]),v.Index&&(S=+v.Index-1)),N=0,++S):(v=aA(A[0]),v.Index&&(S=+v.Index-1),we={},(v.AutoFitHeight=="0"||v.Height)&&(we.hpx=parseInt(v.Height,10),we.hpt=yp(we.hpx),Se[S]=we),v.Hidden=="1"&&(we.hidden=!0,Se[S]=we));break;case"worksheet":if(A[1]==="/"){if((f=u.pop())[0]!==A[3])throw new Error("Bad state: "+f.join("|"));g.push(m),O.s.r<=O.e.r&&O.s.c<=O.e.c&&(x["!ref"]=Wr(O),r.sheetRows&&r.sheetRows<=O.e.r&&(x["!fullref"]=x["!ref"],O.e.r=r.sheetRows-1,x["!ref"]=Wr(O))),j.length&&(x["!merges"]=j),Z.length>0&&(x["!cols"]=Z),Se.length>0&&(x["!rows"]=Se),h[m]=x}else O={s:{r:2e6,c:2e6},e:{r:0,c:0}},S=N=0,u.push([A[3],!1]),f=aA(A[0]),m=Ba(f.Name),x=r.dense?[]:{},j=[],G=[],Se=[],P={name:m,Hidden:0},M.Sheets.push(P);break;case"table":if(A[1]==="/"){if((f=u.pop())[0]!==A[3])throw new Error("Bad state: "+f.join("|"))}else{if(A[0].slice(-2)=="/>")break;u.push([A[3],!1]),Z=[],ve=!1}break;case"style":A[1]==="/"?YH(T,U,r):U=aA(A[0]);break;case"numberformat":U.nf=Ba(aA(A[0]).Format||"General"),Yh[U.nf]&&(U.nf=Yh[U.nf]);for(var de=0;de!=392&&Lr[de]!=U.nf;++de);if(de==392){for(de=57;de!=392;++de)if(Lr[de]==null){Hc(U.nf,de);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(Ae=aA(A[0]),Ae.Hidden&&(Ae.hidden=!0,delete Ae.Hidden),Ae.Width&&(Ae.wpx=parseInt(Ae.Width,10)),!ve&&Ae.wpx>10){ve=!0,Ki=NE;for(var be=0;be<Z.length;++be)Z[be]&&qu(Z[be])}ve&&qu(Ae),Z[Ae.Index-1||Z.length]=Ae;for(var Le=0;Le<+Ae.Span;++Le)Z[Z.length]=kn(Ae);break;case"namedrange":if(A[1]==="/")break;M.Names||(M.Names=[]);var ie=Qr(A[0]),_e={Name:ie.Name,Ref:cf(ie.RefersTo.slice(1),{r:0,c:0})};M.Sheets.length>0&&(_e.Sheet=M.Sheets.length-1),M.Names.push(_e);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(A[0].slice(-2)==="/>")break;A[1]==="/"?D+=a.slice(H,A.index):H=A.index+A[0].length;break;case"interior":if(!r.cellStyles)break;U.Interior=aA(A[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(A[0].slice(-2)==="/>")break;A[1]==="/"?yD(W,re,a.slice(Q,A.index)):Q=A.index+A[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(A[1]==="/"){if((f=u.pop())[0]!==A[3])throw new Error("Bad state: "+f.join("|"))}else u.push([A[3],!1]);break;case"comment":if(A[1]==="/"){if((f=u.pop())[0]!==A[3])throw new Error("Bad state: "+f.join("|"));JH(ue),z.push(ue)}else u.push([A[3],!1]),f=aA(A[0]),ue={a:f.Author};break;case"autofilter":if(A[1]==="/"){if((f=u.pop())[0]!==A[3])throw new Error("Bad state: "+f.join("|"))}else if(A[0].charAt(A[0].length-2)!=="/"){var je=aA(A[0]);x["!autofilter"]={ref:cf(je.Range).replace(/\$/g,"")},u.push([A[3],!0])}break;case"name":break;case"datavalidation":if(A[1]==="/"){if((f=u.pop())[0]!==A[3])throw new Error("Bad state: "+f.join("|"))}else A[0].charAt(A[0].length-2)!=="/"&&u.push([A[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(A[1]==="/"){if((f=u.pop())[0]!==A[3])throw new Error("Bad state: "+f.join("|"))}else A[0].charAt(A[0].length-2)!=="/"&&u.push([A[3],!0]);break;case"null":break;default:if(u.length==0&&A[3]=="document"||u.length==0&&A[3]=="uof")return I4(a,r);var J=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(A[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:J=!1}break;case"componentoptions":switch(A[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:J=!1}break;case"excelworkbook":switch(A[3]){case"date1904":M.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:J=!1}break;case"workbookoptions":switch(A[3]){case"owcversion":break;case"height":break;case"width":break;default:J=!1}break;case"worksheetoptions":switch(A[3]){case"visible":if(A[0].slice(-2)!=="/>")if(A[1]==="/")switch(a.slice(Q,A.index)){case"SheetHidden":P.Hidden=1;break;case"SheetVeryHidden":P.Hidden=2;break}else Q=A.index+A[0].length;break;case"header":x["!margins"]||L0(x["!margins"]={},"xlml"),isNaN(+Qr(A[0]).Margin)||(x["!margins"].header=+Qr(A[0]).Margin);break;case"footer":x["!margins"]||L0(x["!margins"]={},"xlml"),isNaN(+Qr(A[0]).Margin)||(x["!margins"].footer=+Qr(A[0]).Margin);break;case"pagemargins":var ze=Qr(A[0]);x["!margins"]||L0(x["!margins"]={},"xlml"),isNaN(+ze.Top)||(x["!margins"].top=+ze.Top),isNaN(+ze.Left)||(x["!margins"].left=+ze.Left),isNaN(+ze.Right)||(x["!margins"].right=+ze.Right),isNaN(+ze.Bottom)||(x["!margins"].bottom=+ze.Bottom);break;case"displayrighttoleft":M.Views||(M.Views=[]),M.Views[0]||(M.Views[0]={}),M.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:J=!1}break;case"pivottable":case"pivotcache":switch(A[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:J=!1}break;case"pagebreaks":switch(A[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:J=!1}break;case"autofilter":switch(A[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:J=!1}break;case"querytable":switch(A[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:J=!1}break;case"datavalidation":switch(A[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:J=!1}break;case"sorting":case"conditionalformatting":switch(A[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:J=!1}break;case"mapinfo":case"schema":case"data":switch(A[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:J=!1}break;case"smarttags":break;default:J=!1;break}if(J||A[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+A[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(A[0].slice(-2)==="/>")break;A[1]==="/"?WH(I,re,Y,a.slice(Q,A.index)):(Y=A,Q=A.index+A[0].length);break}if(r.WTF)throw"Unrecognized tag: "+A[3]+"|"+u.join("|")}var He={};return!r.bookSheets&&!r.bookProps&&(He.Sheets=h),He.SheetNames=g,He.Workbook=M,He.SSF=kn(Lr),He.Props=W,He.Custprops=I,He}function hw(e,t){switch(ey(t=t||{}),t.type||"base64"){case"base64":return Xb(ho(e),t);case"binary":case"buffer":case"file":return Xb(e,t);case"array":return Xb(Ju(e),t)}}function ZH(e,t){var r=[];return e.Props&&r.push(_D(e.Props,t)),e.Custprops&&r.push(BD(e.Props,e.Custprops)),r.join("")}function eP(){return""}function tP(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,n){var s=[];s.push(Mt("NumberFormat",null,{"ss:Format":Va(Lr[a.numFmtId])}));var l={"ss:ID":"s"+(21+n)};r.push(Mt("Style",s.join(""),l))}),Mt("Styles",r.join(""))}function rN(e){return Mt("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+W2(e.Ref,{r:0,c:0})})}function rP(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var n=t[a];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(rN(n)))}return Mt("Names",r.join(""))}function aP(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,s=[],l=0;l<n.length;++l){var A=n[l];A.Sheet==r&&(A.Name.match(/^_xlfn\./)||s.push(rN(A)))}return s.join("")}function nP(e,t,r,a){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(Mt("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(Mt("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(Mt("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)n.push(Mt("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(a.Workbook.Sheets[s]&&!a.Workbook.Sheets[s].Hidden);++s);s==r&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(wi("ProtectContents","True")),e["!protect"].objects&&n.push(wi("ProtectObjects","True")),e["!protect"].scenarios&&n.push(wi("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(wi("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(wi("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&n.push("<"+l[1]+"/>")})),n.length==0?"":Mt("WorksheetOptions",n.join(""),{xmlns:io.x})}function sP(e){return e.map(function(t){var r=Cj(t.t||""),a=Mt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Mt("Comment",a,{"ss:Author":t.a})}).join("")}function iP(e,t,r,a,n,s,l){if(!e||e.v==null&&e.f==null)return"";var A={};if(e.f&&(A["ss:Formula"]="="+Va(W2(e.f,l))),e.F&&e.F.slice(0,t.length)==t){var u=Pn(e.F.slice(t.length+1));A["ss:ArrayRange"]="RC:R"+(u.r==l.r?"":"["+(u.r-l.r)+"]")+"C"+(u.c==l.c?"":"["+(u.c-l.c)+"]")}if(e.l&&e.l.Target&&(A["ss:HRef"]=Va(e.l.Target),e.l.Tooltip&&(A["x:HRefScreenTip"]=Va(e.l.Tooltip))),r["!merges"])for(var f=r["!merges"],h=0;h!=f.length;++h)f[h].s.c!=l.c||f[h].s.r!=l.r||(f[h].e.c>f[h].s.c&&(A["ss:MergeAcross"]=f[h].e.c-f[h].s.c),f[h].e.r>f[h].s.r&&(A["ss:MergeDown"]=f[h].e.r-f[h].s.r));var g="",x="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":g="Number",x=String(e.v);break;case"b":g="Boolean",x=e.v?"1":"0";break;case"e":g="Error",x=Xc[e.v];break;case"d":g="DateTime",x=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Lr[14]);break;case"s":g="String",x=kj(e.v||"");break}var m=e0(a.cellXfs,e,a);A["ss:StyleID"]="s"+(21+m),A["ss:Index"]=l.c+1;var w=e.v!=null?x:"",v=e.t=="z"?"":'<Data ss:Type="'+g+'">'+w+"</Data>";return(e.c||[]).length>0&&(v+=sP(e.c)),Mt("Cell",v,A)}function lP(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=vf(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function oP(e,t,r,a){if(!e["!ref"])return"";var n=ka(e["!ref"]),s=e["!merges"]||[],l=0,A=[];e["!cols"]&&e["!cols"].forEach(function(B,k){qu(B);var N=!!B.width,S=Jx(k,B),O={"ss:Index":k+1};N&&(O["ss:Width"]=vp(S.width)),B.hidden&&(O["ss:Hidden"]="1"),A.push(Mt("Column",null,O))});for(var u=Array.isArray(e),f=n.s.r;f<=n.e.r;++f){for(var h=[lP(f,(e["!rows"]||[])[f])],g=n.s.c;g<=n.e.c;++g){var x=!1;for(l=0;l!=s.length;++l)if(!(s[l].s.c>g)&&!(s[l].s.r>f)&&!(s[l].e.c<g)&&!(s[l].e.r<f)){(s[l].s.c!=g||s[l].s.r!=f)&&(x=!0);break}if(!x){var m={r:f,c:g},w=Ir(m),v=u?(e[f]||[])[g]:e[w];h.push(iP(v,w,e,t,r,a,m))}}h.push("</Row>"),h.length>2&&A.push(h.join(""))}return A.join("")}function AP(e,t,r){var a=[],n=r.SheetNames[e],s=r.Sheets[n],l=s?aP(s,t,e,r):"";return l.length>0&&a.push("<Names>"+l+"</Names>"),l=s?oP(s,t,e,r):"",l.length>0&&a.push("<Table>"+l+"</Table>"),a.push(nP(s,t,e,r)),a.join("")}function cP(e,t){t||(t={}),e.SSF||(e.SSF=kn(Lr)),e.SSF&&(Cf(),zx(e.SSF),t.revssf=Gx(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],e0(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(ZH(e,t)),r.push(eP()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(Mt("Worksheet",AP(a,t,e),{"ss:Name":Va(e.SheetNames[a])}));return r[2]=tP(e,t),r[3]=rP(e),bs+Mt("Workbook",r.join(""),{xmlns:io.ss,"xmlns:o":io.o,"xmlns:x":io.x,"xmlns:ss":io.ss,"xmlns:dt":io.dt,"xmlns:html":io.html})}function uP(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=rD(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=aD(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var dP=[60,1084,2066,2165,2175];function fP(e,t,r,a,n){var s=a,l=[],A=r.slice(r.l,r.l+s);if(n&&n.enc&&n.enc.insitu&&A.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(A)}l.push(A),r.l+=s;for(var u=Rc(r,r.l),f=pw[u],h=0;f!=null&&dP.indexOf(u)>-1;)s=Rc(r,r.l+2),h=r.l+4,u==2066?h+=4:(u==2165||u==2175)&&(h+=12),A=r.slice(h,r.l+4+s),l.push(A),r.l+=4+s,f=pw[u=Rc(r,r.l)];var g=ai(l);vi(g,0);var x=0;g.lens=[];for(var m=0;m<l.length;++m)g.lens.push(x),x+=l[m].length;if(g.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+g.length+" < "+a;return t.f(g,g.length,n)}function MA(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Lr[a])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Xc[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=hp(e.v):e.w=Q0(e.v):e.w=Oo(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&a&&e.t=="n"&&kf(Lr[a]||String(a))){var n=C0(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function tm(e,t,r){return{v:e,ixfe:t,t:r}}function hP(e,t){var r={opts:{}},a={},n=t.dense?[]:{},s={},l={},A=null,u=[],f="",h={},g,x="",m,w,v,B,k={},N=[],S,O,T=[],U=[],D={Sheets:[],WBProps:{date1904:!1},Views:[{}]},H={},j=function(ht){return ht<8?N0[ht]:ht<64&&U[ht-8]||N0[ht]},W=function(ht,Bt,pr){var $t=Bt.XF.data;if(!(!$t||!$t.patternType||!pr||!pr.cellStyles)){Bt.s={},Bt.s.patternType=$t.patternType;var Ee;(Ee=bp(j($t.icvFore)))&&(Bt.s.fgColor={rgb:Ee}),(Ee=bp(j($t.icvBack)))&&(Bt.s.bgColor={rgb:Ee})}},I=function(ht,Bt,pr){if(!(we>1)&&!(pr.sheetRows&&ht.r>=pr.sheetRows)){if(pr.cellStyles&&Bt.XF&&Bt.XF.data&&W(ht,Bt,pr),delete Bt.ixfe,delete Bt.XF,g=ht,x=Ir(ht),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),ht.r<l.s.r&&(l.s.r=ht.r),ht.c<l.s.c&&(l.s.c=ht.c),ht.r+1>l.e.r&&(l.e.r=ht.r+1),ht.c+1>l.e.c&&(l.e.c=ht.c+1),pr.cellFormula&&Bt.f){for(var $t=0;$t<N.length;++$t)if(!(N[$t][0].s.c>ht.c||N[$t][0].s.r>ht.r)&&!(N[$t][0].e.c<ht.c||N[$t][0].e.r<ht.r)){Bt.F=Wr(N[$t][0]),(N[$t][0].s.c!=ht.c||N[$t][0].s.r!=ht.r)&&delete Bt.f,Bt.f&&(Bt.f=""+Hi(N[$t][1],l,ht,G,Q));break}}pr.dense?(n[ht.r]||(n[ht.r]=[]),n[ht.r][ht.c]=Bt):n[x]=Bt}},Q={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:N,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(Q.password=t.password);var Y,z=[],ue=[],Z=[],Ae=[],ve=!1,G=[];G.SheetNames=Q.snames,G.sharedf=Q.sharedf,G.arrayf=Q.arrayf,G.names=[],G.XTI=[];var Se=0,we=0,F=0,R=[],M=[],P;Q.codepage=1200,lA(1200);for(var re=!1;e.l<e.length-1;){var ge=e.l,Ce=e.read_shift(2);if(Ce===0&&Se===10)break;var de=e.l===e.length?0:e.read_shift(2),be=pw[Ce];if(be&&be.f){if(t.bookSheets&&Se===133&&Ce!==133)break;if(Se=Ce,be.r===2||be.r==12){var Le=e.read_shift(2);if(de-=2,!Q.enc&&Le!==Ce&&((Le&255)<<8|Le>>8)!==Ce)throw new Error("rt mismatch: "+Le+"!="+Ce);be.r==12&&(e.l+=10,de-=10)}var ie={};if(Ce===10?ie=be.f(e,de,Q):ie=fP(Ce,be,e,de,Q),we==0&&[9,521,1033,2057].indexOf(Se)===-1)continue;switch(Ce){case 34:r.opts.Date1904=D.WBProps.date1904=ie;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(Q.enc||(e.l=0),Q.enc=ie,!t.password)throw new Error("File is password-protected");if(ie.valid==null)throw new Error("Encryption scheme unsupported");if(!ie.valid)throw new Error("Password is incorrect");break;case 92:Q.lastuser=ie;break;case 66:var _e=Number(ie);switch(_e){case 21010:_e=1200;break;case 32768:_e=1e4;break;case 32769:_e=1252;break}lA(Q.codepage=_e),re=!0;break;case 317:Q.rrtabid=ie;break;case 25:Q.winlocked=ie;break;case 439:r.opts.RefreshAll=ie;break;case 12:r.opts.CalcCount=ie;break;case 16:r.opts.CalcDelta=ie;break;case 17:r.opts.CalcIter=ie;break;case 13:r.opts.CalcMode=ie;break;case 14:r.opts.CalcPrecision=ie;break;case 95:r.opts.CalcSaveRecalc=ie;break;case 15:Q.CalcRefMode=ie;break;case 2211:r.opts.FullCalc=ie;break;case 129:ie.fDialog&&(n["!type"]="dialog"),ie.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),ie.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:T.push(ie);break;case 430:G.push([ie]),G[G.length-1].XTI=[];break;case 35:case 547:G[G.length-1].push(ie);break;case 24:case 536:P={Name:ie.Name,Ref:Hi(ie.rgce,l,null,G,Q)},ie.itab>0&&(P.Sheet=ie.itab-1),G.names.push(P),G[0]||(G[0]=[],G[0].XTI=[]),G[G.length-1].push(ie),ie.Name=="_xlnm._FilterDatabase"&&ie.itab>0&&ie.rgce&&ie.rgce[0]&&ie.rgce[0][0]&&ie.rgce[0][0][0]=="PtgArea3d"&&(M[ie.itab-1]={ref:Wr(ie.rgce[0][0][1][2])});break;case 22:Q.ExternCount=ie;break;case 23:G.length==0&&(G[0]=[],G[0].XTI=[]),G[G.length-1].XTI=G[G.length-1].XTI.concat(ie),G.XTI=G.XTI.concat(ie);break;case 2196:if(Q.biff<8)break;P!=null&&(P.Comment=ie[1]);break;case 18:n["!protect"]=ie;break;case 19:ie!==0&&Q.WTF&&console.error("Password verifier: "+ie);break;case 133:s[ie.pos]=ie,Q.snames.push(ie.name);break;case 10:{if(--we)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,n["!ref"]=Wr(l),t.sheetRows&&t.sheetRows<=l.e.r){var je=l.e.r;l.e.r=t.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=Wr(l),l.e.r=je}l.e.r++,l.e.c++}z.length>0&&(n["!merges"]=z),ue.length>0&&(n["!objects"]=ue),Z.length>0&&(n["!cols"]=Z),Ae.length>0&&(n["!rows"]=Ae),D.Sheets.push(H)}f===""?h=n:a[f]=n,n=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(Q.biff===8&&(Q.biff={9:2,521:3,1033:4}[Ce]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[ie.BIFFVer]||8),Q.biffguess=ie.BIFFVer==0,ie.BIFFVer==0&&ie.dt==4096&&(Q.biff=5,re=!0,lA(Q.codepage=28591)),Q.biff==8&&ie.BIFFVer==0&&ie.dt==16&&(Q.biff=2),we++)break;if(n=t.dense?[]:{},Q.biff<8&&!re&&(re=!0,lA(Q.codepage=t.codepage||1252)),Q.biff<5||ie.BIFFVer==0&&ie.dt==4096){f===""&&(f="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var J={pos:e.l-de,name:f};s[J.pos]=J,Q.snames.push(f)}else f=(s[ge]||{name:""}).name;ie.dt==32&&(n["!type"]="chart"),ie.dt==64&&(n["!type"]="macro"),z=[],ue=[],Q.arrayf=N=[],Z=[],Ae=[],ve=!1,H={Hidden:(s[ge]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(t.dense?(n[ie.r]||[])[ie.c]:n[Ir({c:ie.c,r:ie.r})])&&++ie.c,S={ixfe:ie.ixfe,XF:T[ie.ixfe]||{},v:ie.val,t:"n"},F>0&&(S.z=R[S.ixfe>>8&63]),MA(S,t,r.opts.Date1904),I({c:ie.c,r:ie.r},S,t);break;case 5:case 517:S={ixfe:ie.ixfe,XF:T[ie.ixfe],v:ie.val,t:ie.t},F>0&&(S.z=R[S.ixfe>>8&63]),MA(S,t,r.opts.Date1904),I({c:ie.c,r:ie.r},S,t);break;case 638:S={ixfe:ie.ixfe,XF:T[ie.ixfe],v:ie.rknum,t:"n"},F>0&&(S.z=R[S.ixfe>>8&63]),MA(S,t,r.opts.Date1904),I({c:ie.c,r:ie.r},S,t);break;case 189:for(var ze=ie.c;ze<=ie.C;++ze){var He=ie.rkrec[ze-ie.c][0];S={ixfe:He,XF:T[He],v:ie.rkrec[ze-ie.c][1],t:"n"},F>0&&(S.z=R[S.ixfe>>8&63]),MA(S,t,r.opts.Date1904),I({c:ze,r:ie.r},S,t)}break;case 6:case 518:case 1030:{if(ie.val=="String"){A=ie;break}if(S=tm(ie.val,ie.cell.ixfe,ie.tt),S.XF=T[S.ixfe],t.cellFormula){var ct=ie.formula;if(ct&&ct[0]&&ct[0][0]&&ct[0][0][0]=="PtgExp"){var Xe=ct[0][0][1][0],Ut=ct[0][0][1][1],yt=Ir({r:Xe,c:Ut});k[yt]?S.f=""+Hi(ie.formula,l,ie.cell,G,Q):S.F=((t.dense?(n[Xe]||[])[Ut]:n[yt])||{}).F}else S.f=""+Hi(ie.formula,l,ie.cell,G,Q)}F>0&&(S.z=R[S.ixfe>>8&63]),MA(S,t,r.opts.Date1904),I(ie.cell,S,t),A=ie}break;case 7:case 519:if(A)A.val=ie,S=tm(ie,A.cell.ixfe,"s"),S.XF=T[S.ixfe],t.cellFormula&&(S.f=""+Hi(A.formula,l,A.cell,G,Q)),F>0&&(S.z=R[S.ixfe>>8&63]),MA(S,t,r.opts.Date1904),I(A.cell,S,t),A=null;else throw new Error("String record expects Formula");break;case 33:case 545:{N.push(ie);var qt=Ir(ie[0].s);if(m=t.dense?(n[ie[0].s.r]||[])[ie[0].s.c]:n[qt],t.cellFormula&&m){if(!A||!qt||!m)break;m.f=""+Hi(ie[1],l,ie[0],G,Q),m.F=Wr(ie[0])}}break;case 1212:{if(!t.cellFormula)break;if(x){if(!A)break;k[Ir(A.cell)]=ie[0],m=t.dense?(n[A.cell.r]||[])[A.cell.c]:n[Ir(A.cell)],(m||{}).f=""+Hi(ie[0],l,g,G,Q)}}break;case 253:S=tm(u[ie.isst].t,ie.ixfe,"s"),u[ie.isst].h&&(S.h=u[ie.isst].h),S.XF=T[S.ixfe],F>0&&(S.z=R[S.ixfe>>8&63]),MA(S,t,r.opts.Date1904),I({c:ie.c,r:ie.r},S,t);break;case 513:t.sheetStubs&&(S={ixfe:ie.ixfe,XF:T[ie.ixfe],t:"z"},F>0&&(S.z=R[S.ixfe>>8&63]),MA(S,t,r.opts.Date1904),I({c:ie.c,r:ie.r},S,t));break;case 190:if(t.sheetStubs)for(var Lt=ie.c;Lt<=ie.C;++Lt){var jt=ie.ixfe[Lt-ie.c];S={ixfe:jt,XF:T[jt],t:"z"},F>0&&(S.z=R[S.ixfe>>8&63]),MA(S,t,r.opts.Date1904),I({c:Lt,r:ie.r},S,t)}break;case 214:case 516:case 4:S=tm(ie.val,ie.ixfe,"s"),S.XF=T[S.ixfe],F>0&&(S.z=R[S.ixfe>>8&63]),MA(S,t,r.opts.Date1904),I({c:ie.c,r:ie.r},S,t);break;case 0:case 512:we===1&&(l=ie);break;case 252:u=ie;break;case 1054:if(Q.biff==4){R[F++]=ie[1];for(var Pt=0;Pt<F+163&&Lr[Pt]!=ie[1];++Pt);Pt>=163&&Hc(ie[1],F+163)}else Hc(ie[1],ie[0]);break;case 30:{R[F++]=ie;for(var zt=0;zt<F+163&&Lr[zt]!=ie;++zt);zt>=163&&Hc(ie,F+163)}break;case 229:z=z.concat(ie);break;case 93:ue[ie.cmo[0]]=Q.lastobj=ie;break;case 438:Q.lastobj.TxO=ie;break;case 127:Q.lastobj.ImData=ie;break;case 440:for(B=ie[0].s.r;B<=ie[0].e.r;++B)for(v=ie[0].s.c;v<=ie[0].e.c;++v)m=t.dense?(n[B]||[])[v]:n[Ir({c:v,r:B})],m&&(m.l=ie[1]);break;case 2048:for(B=ie[0].s.r;B<=ie[0].e.r;++B)for(v=ie[0].s.c;v<=ie[0].e.c;++v)m=t.dense?(n[B]||[])[v]:n[Ir({c:v,r:B})],m&&m.l&&(m.l.Tooltip=ie[1]);break;case 28:{if(Q.biff<=5&&Q.biff>=2)break;m=t.dense?(n[ie[0].r]||[])[ie[0].c]:n[Ir(ie[0])];var Jt=ue[ie[2]];m||(t.dense?(n[ie[0].r]||(n[ie[0].r]=[]),m=n[ie[0].r][ie[0].c]={t:"z"}):m=n[Ir(ie[0])]={t:"z"},l.e.r=Math.max(l.e.r,ie[0].r),l.s.r=Math.min(l.s.r,ie[0].r),l.e.c=Math.max(l.e.c,ie[0].c),l.s.c=Math.min(l.s.c,ie[0].c)),m.c||(m.c=[]),w={a:ie[1],t:Jt.TxO.t},m.c.push(w)}break;case 2173:tO(T[ie.ixfe],ie.ext);break;case 125:{if(!Q.cellStyles)break;for(;ie.e>=ie.s;)Z[ie.e--]={width:ie.w/256,level:ie.level||0,hidden:!!(ie.flags&1)},ve||(ve=!0,z2(ie.w/256)),qu(Z[ie.e+1])}break;case 520:{var It={};ie.level!=null&&(Ae[ie.r]=It,It.level=ie.level),ie.hidden&&(Ae[ie.r]=It,It.hidden=!0),ie.hpt&&(Ae[ie.r]=It,It.hpt=ie.hpt,It.hpx=vf(ie.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||L0(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ce]]=ie;break;case 161:n["!margins"]||L0(n["!margins"]={}),n["!margins"].header=ie.header,n["!margins"].footer=ie.footer;break;case 574:ie.RTL&&(D.Views[0].RTL=!0);break;case 146:U=ie;break;case 2198:Y=ie;break;case 140:O=ie;break;case 442:f?H.CodeName=ie||H.name:D.WBProps.CodeName=ie||"ThisWorkbook";break}}else be||console.error("Missing Info for XLS Record 0x"+Ce.toString(16)),e.l+=de}return r.SheetNames=as(s).sort(function(xt,ht){return Number(xt)-Number(ht)}).map(function(xt){return s[xt].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&h["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=h)):r.Preamble=h,r.Sheets&&M.forEach(function(xt,ht){r.Sheets[r.SheetNames[ht]]["!autofilter"]=xt}),r.Strings=u,r.SSF=kn(Lr),Q.enc&&(r.Encryption=Q.enc),Y&&(r.Themes=Y),r.Metadata={},O!==void 0&&(r.Metadata.Country=O),G.names.length>0&&(D.Names=G.names),r.Workbook=D,r}var $h={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function pP(e,t,r){var a=yr.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=d4(a,ow,$h.DSI);for(var s in n)t[s]=n[s]}catch(f){if(r.WTF)throw f}var l=yr.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var A=d4(l,Aw,$h.SI);for(var u in A)t[u]==null&&(t[u]=A[u])}catch(f){if(r.WTF)throw f}t.HeadingPairs&&t.TitlesOfParts&&(tE(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function gP(e,t){var r=[],a=[],n=[],s=0,l,A=PB(ow,"n"),u=PB(Aw,"n");if(e.Props)for(l=as(e.Props),s=0;s<l.length;++s)(Object.prototype.hasOwnProperty.call(A,l[s])?r:Object.prototype.hasOwnProperty.call(u,l[s])?a:n).push([l[s],e.Props[l[s]]]);if(e.Custprops)for(l=as(e.Custprops),s=0;s<l.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},l[s])||(Object.prototype.hasOwnProperty.call(A,l[s])?r:Object.prototype.hasOwnProperty.call(u,l[s])?a:n).push([l[s],e.Custprops[l[s]]]);var f=[];for(s=0;s<n.length;++s)oE.indexOf(n[s][0])>-1||eE.indexOf(n[s][0])>-1||n[s][1]!=null&&f.push(n[s]);a.length&&yr.utils.cfb_add(t,"/SummaryInformation",f4(a,$h.SI,u,Aw)),(r.length||f.length)&&yr.utils.cfb_add(t,"/DocumentSummaryInformation",f4(r,$h.DSI,A,ow,f.length?f:null,$h.UDI))}function aN(e,t){t||(t={}),ey(t),w2(),t.codepage&&v2(t.codepage);var r,a;if(e.FullPaths){if(yr.find(e,"/encryption"))throw new Error("File is password-protected");r=yr.find(e,"!CompObj"),a=yr.find(e,"/Workbook")||yr.find(e,"/Book")}else{switch(t.type){case"base64":e=oo(ho(e));break;case"binary":e=oo(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}vi(e,0),a={content:e}}var n,s;if(r&&uP(r),t.bookProps&&!t.bookSheets)n={};else{var l=Zr?"buffer":"array";if(a&&a.content)n=hP(a.content,t);else if((s=yr.find(e,"PerfectOffice_MAIN"))&&s.content)n=T0.to_workbook(s.content,(t.type=l,t));else if((s=yr.find(e,"NativeContent_MAIN"))&&s.content)n=T0.to_workbook(s.content,(t.type=l,t));else throw(s=yr.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&yr.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=NO(e))}var A={};return e.FullPaths&&pP(e,A,t),n.Props=n.Custprops=A,t.bookFiles&&(n.cfb=e),n}function mP(e,t){var r=t||{},a=yr.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return yr.utils.cfb_add(a,n,nN(e,r)),r.biff==8&&(e.Props||e.Custprops)&&gP(e,a),r.biff==8&&e.vbaraw&&FO(a,yr.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var _p={0:{f:HM},1:{f:XM},2:{f:h9},3:{f:a9},4:{f:ZM},5:{f:u9},6:{f:b9},7:{f:l9},8:{f:C9},9:{f:k9},10:{f:_9},11:{f:B9},12:{f:$M},13:{f:g9},14:{f:s9},15:{f:t9},16:{f:XE},17:{f:w9},18:{f:A9},19:{f:D2},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:wH},40:{},42:{},43:{f:b7},44:{f:m7},45:{f:y7},46:{f:B7},47:{f:_7},48:{},49:{f:qj},50:{},51:{f:nO},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:bE},62:{f:x9},63:{f:fO},64:{f:P9},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Vi,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:O9},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:GM},148:{f:qM,p:16},151:{f:L9},152:{},153:{f:xH},154:{},155:{},156:{f:gH},157:{},158:{},159:{T:1,f:jQ},160:{T:-1},161:{T:1,f:X0},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:S9},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:rO},336:{T:-1},337:{f:lO,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:lw},357:{},358:{},359:{},360:{T:1},361:{},362:{f:xE},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:U9},427:{f:j9},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:I9},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:VM},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:F9},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:lw},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:BO},633:{T:1},634:{T:-1},635:{T:1,f:yO},636:{T:-1},637:{f:Wj},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:sH},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:K9},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},pw={6:{f:Gb},10:{f:wu},12:{f:Fs},13:{f:Fs},14:{f:cs},15:{f:cs},16:{f:qi},17:{f:cs},18:{f:cs},19:{f:Fs},20:{f:b4},21:{f:b4},23:{f:xE},24:{f:w4},25:{f:cs},26:{},27:{},28:{f:KI},29:{},34:{f:cs},35:{f:v4},38:{f:qi},39:{f:qi},40:{f:qi},41:{f:qi},42:{f:cs},43:{f:cs},47:{f:t7},49:{f:gI},51:{f:Fs},60:{},61:{f:uI},64:{f:cs},65:{f:pI},66:{f:Fs},77:{},80:{},81:{},82:{},85:{f:Fs},89:{},90:{},91:{},92:{f:eI},93:{f:VI},94:{},95:{f:cs},96:{},97:{},99:{f:cs},125:{f:bE},128:{f:TI},129:{f:rI},130:{f:Fs},131:{f:cs},132:{f:cs},133:{f:aI},134:{},140:{f:eQ},141:{f:Fs},144:{},146:{f:aQ},151:{},152:{},153:{},154:{},155:{},156:{f:Fs},157:{},158:{},160:{f:cQ},161:{f:iQ},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:SI},190:{f:EI},193:{f:wu},197:{},198:{},199:{},200:{},201:{},202:{f:cs},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Fs},220:{},221:{f:cs},222:{},224:{f:FI},225:{f:ZD},226:{f:wu},227:{},229:{f:qI},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:sI},253:{f:xI},255:{f:lI},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:AE},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:cs},353:{f:wu},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:II},431:{f:cs},432:{},433:{},434:{},437:{},438:{f:XI},439:{f:cs},440:{f:YI},441:{},442:{f:Op},443:{},444:{f:Fs},445:{},446:{},448:{f:wu},449:{f:cI,r:2},450:{f:wu},512:{f:g4},513:{f:AQ},515:{f:jI},516:{f:vI},517:{f:x4},519:{f:uQ},520:{f:oI},523:{},545:{f:y4},549:{f:p4},566:{},574:{f:fI},638:{f:CI},659:{},1048:{},1054:{f:yI},1084:{},1212:{f:MI},2048:{f:JI},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Jg},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:wu},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:nQ,r:12},2173:{f:eO,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:cs,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:RI,r:12},2197:{},2198:{f:W7,r:12},2199:{},2200:{},2201:{},2202:{f:HI,r:12},2203:{f:wu},2204:{},2205:{},2206:{},2207:{},2211:{f:AI},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Fs},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:lQ},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:rQ},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:g4},1:{},2:{f:gQ},3:{f:hQ},4:{f:fQ},5:{f:x4},7:{f:xQ},8:{},9:{f:Jg},11:{},22:{f:Fs},30:{f:BI},31:{},32:{},33:{f:y4},36:{},37:{f:p4},50:{f:bQ},62:{},52:{},67:{},68:{f:Fs},69:{},86:{},126:{},127:{f:dQ},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:vQ},223:{},234:{},354:{},421:{},518:{f:Gb},521:{f:Jg},536:{f:w4},547:{f:v4},561:{},579:{},1030:{f:Gb},1033:{f:Jg},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ht(e,t,r,a){var n=t;if(!isNaN(n)){var s=a||(r||[]).length||0,l=e.next(4);l.write_shift(2,n),l.write_shift(2,s),s>0&&L2(r)&&e.push(r)}}function xP(e,t,r,a){var n=(r||[]).length||0;if(n<=8224)return Ht(e,t,r,n);var s=t;if(!isNaN(s)){for(var l=r.parts||[],A=0,u=0,f=0;f+(l[A]||8224)<=8224;)f+=l[A]||8224,A++;var h=e.next(4);for(h.write_shift(2,s),h.write_shift(2,f),e.push(r.slice(u,u+f)),u+=f;u<n;){for(h=e.next(4),h.write_shift(2,60),f=0;f+(l[A]||8224)<=8224;)f+=l[A]||8224,A++;h.write_shift(2,f),e.push(r.slice(u,u+f)),u+=f}}}function Pp(e,t,r){return e||(e=lt(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function bP(e,t,r,a){var n=lt(9);return Pp(n,e,t),cE(r,a||"b",n),n}function vP(e,t,r){var a=lt(8+2*r.length);return Pp(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function wP(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?zs(Bn(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?Ht(e,2,mQ(r,a,n)):Ht(e,3,pQ(r,a,n));return;case"b":case"e":Ht(e,5,bP(r,a,t.v,t.t));return;case"s":case"str":Ht(e,4,vP(r,a,(t.v||"").slice(0,255)));return}Ht(e,1,Pp(null,r,a))}function yP(e,t,r,a){var n=Array.isArray(t),s=ka(t["!ref"]||"A1"),l,A="",u=[];if(s.e.c>255||s.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),l=Wr(s)}for(var f=s.s.r;f<=s.e.r;++f){A=xs(f);for(var h=s.s.c;h<=s.e.c;++h){f===s.s.r&&(u[h]=Hn(h)),l=u[h]+A;var g=n?(t[f]||[])[h]:t[l];g&&wP(e,g,f,h)}}}function _P(e,t){for(var r=t||{},a=Ql(),n=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(n=s);if(n==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ht(a,r.biff==4?1033:r.biff==3?521:9,P2(e,16,r)),yP(a,e.Sheets[e.SheetNames[n]],n,r),Ht(a,10),a.end()}function BP(e,t,r){Ht(e,49,mI({sz:12,name:"Arial"},r))}function kP(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&Ht(e,1054,_I(n,t[n],r))})}function CP(e,t){var r=lt(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ht(e,2151,r),r=lt(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),pE(ka(t["!ref"]||"A1"),r),r.write_shift(4,4),Ht(e,2152,r)}function SP(e,t){for(var r=0;r<16;++r)Ht(e,224,m4({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){Ht(e,224,m4(a,0,t))})}function EP(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];Ht(e,440,$I(a)),a[1].Tooltip&&Ht(e,2048,ZI(a))}delete t["!links"]}function NP(e,t){if(t){var r=0;t.forEach(function(a,n){++r<=256&&a&&Ht(e,125,sQ(Jx(n,a),n))})}}function FP(e,t,r,a,n){var s=16+e0(n.cellXfs,t,n);if(t.v==null&&!t.bf){Ht(e,513,H0(r,a,s));return}if(t.bf)Ht(e,6,rM(t,r,a,n,s));else switch(t.t){case"d":case"n":var l=t.t=="d"?zs(Bn(t.v)):t.v;Ht(e,515,DI(r,a,l,s));break;case"b":case"e":Ht(e,517,UI(r,a,t.v,s,n,t.t));break;case"s":case"str":if(n.bookSST){var A=Y2(n.Strings,t.v,n.revStrings);Ht(e,253,bI(r,a,A,s))}else Ht(e,516,wI(r,a,(t.v||"").slice(0,255),s,n));break;default:Ht(e,513,H0(r,a,s))}}function TP(e,t,r){var a=Ql(),n=r.SheetNames[e],s=r.Sheets[n]||{},l=(r||{}).Workbook||{},A=(l.Sheets||[])[e]||{},u=Array.isArray(s),f=t.biff==8,h,g="",x=[],m=ka(s["!ref"]||"A1"),w=f?65536:16384;if(m.e.c>255||m.e.r>=w){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,w-1)}Ht(a,2057,P2(r,16,t)),Ht(a,13,To(1)),Ht(a,12,To(100)),Ht(a,15,al(!0)),Ht(a,17,al(!1)),Ht(a,16,R0(.001)),Ht(a,95,al(!0)),Ht(a,42,al(!1)),Ht(a,43,al(!1)),Ht(a,130,To(1)),Ht(a,128,LI()),Ht(a,131,al(!1)),Ht(a,132,al(!1)),f&&NP(a,s["!cols"]),Ht(a,512,kI(m,t)),f&&(s["!links"]=[]);for(var v=m.s.r;v<=m.e.r;++v){g=xs(v);for(var B=m.s.c;B<=m.e.c;++B){v===m.s.r&&(x[B]=Hn(B)),h=x[B]+g;var k=u?(s[v]||[])[B]:s[h];k&&(FP(a,k,v,B,t),f&&k.l&&s["!links"].push([h,k.l]))}}var N=A.CodeName||A.name||n;return f&&Ht(a,574,hI((l.Views||[])[0])),f&&(s["!merges"]||[]).length&&Ht(a,229,zI(s["!merges"])),f&&EP(a,s),Ht(a,442,uE(N)),f&&CP(a,s),Ht(a,10),a.end()}function LP(e,t,r){var a=Ql(),n=(e||{}).Workbook||{},s=n.Sheets||[],l=n.WBProps||{},A=r.biff==8,u=r.biff==5;if(Ht(a,2057,P2(e,5,r)),r.bookType=="xla"&&Ht(a,135),Ht(a,225,A?To(1200):null),Ht(a,193,UD(2)),u&&Ht(a,191),u&&Ht(a,192),Ht(a,226),Ht(a,92,tI("SheetJS",r)),Ht(a,66,To(A?1200:1252)),A&&Ht(a,353,To(0)),A&&Ht(a,448),Ht(a,317,oQ(e.SheetNames.length)),A&&e.vbaraw&&Ht(a,211),A&&e.vbaraw){var f=l.CodeName||"ThisWorkbook";Ht(a,442,uE(f))}Ht(a,156,To(17)),Ht(a,25,al(!1)),Ht(a,18,al(!1)),Ht(a,19,To(0)),A&&Ht(a,431,al(!1)),A&&Ht(a,444,To(0)),Ht(a,61,dI()),Ht(a,64,al(!1)),Ht(a,141,To(0)),Ht(a,34,al(cH(e)=="true")),Ht(a,14,al(!0)),A&&Ht(a,439,al(!1)),Ht(a,218,To(0)),BP(a,e,r),kP(a,e.SSF,r),SP(a,r),A&&Ht(a,352,al(!1));var h=a.end(),g=Ql();A&&Ht(g,140,tQ()),A&&r.Strings&&xP(g,252,iI(r.Strings)),Ht(g,10);var x=g.end(),m=Ql(),w=0,v=0;for(v=0;v<e.SheetNames.length;++v)w+=(A?12:11)+(A?2:1)*e.SheetNames[v].length;var B=h.length+w+x.length;for(v=0;v<e.SheetNames.length;++v){var k=s[v]||{};Ht(m,133,nI({pos:B,hs:k.Hidden||0,dt:0,name:e.SheetNames[v]},r)),B+=t[v].length}var N=m.end();if(w!=N.length)throw new Error("BS8 "+w+" != "+N.length);var S=[];return h.length&&S.push(h),N.length&&S.push(N),x.length&&S.push(x),ai(S)}function UP(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=kn(Lr)),e&&e.SSF&&(Cf(),zx(e.SSF),r.revssf=Gx(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,ty(r),r.cellXfs=[],e0(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)a[a.length]=TP(n,r,e);return a.unshift(LP(e,a,r)),ai(a)}function nN(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var n=Rl(a["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return UP(e,t);case 4:case 3:case 2:return _P(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function L4(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),l=n.index,A=s&&s.index||e.length,u=mj(e.slice(l,A),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,h=0,g=0,x=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},w=[];for(l=0;l<u.length;++l){var v=u[l].trim(),B=v.slice(0,3).toLowerCase();if(B=="<tr"){if(++f,r.sheetRows&&r.sheetRows<=f){--f;break}h=0;continue}if(!(B!="<td"&&B!="<th")){var k=v.split(/<\/t[dh]>/i);for(A=0;A<k.length;++A){var N=k[A].trim();if(N.match(/<t[dh]/i)){for(var S=N,O=0;S.charAt(0)=="<"&&(O=S.indexOf(">"))>-1;)S=S.slice(O+1);for(var T=0;T<w.length;++T){var U=w[T];U.s.c==h&&U.s.r<f&&f<=U.e.r&&(h=U.e.c+1,T=-1)}var D=Qr(N.slice(0,N.indexOf(">")));x=D.colspan?+D.colspan:1,((g=+D.rowspan)>1||x>1)&&w.push({s:{r:f,c:h},e:{r:f+(g||1)-1,c:h+x-1}});var H=D.t||D["data-t"]||"";if(!S.length){h+=x;continue}if(S=E3(S),m.s.r>f&&(m.s.r=f),m.e.r<f&&(m.e.r=f),m.s.c>h&&(m.s.c=h),m.e.c<h&&(m.e.c=h),!S.length){h+=x;continue}var j={t:"s",v:S};r.raw||!S.trim().length||H=="s"||(S==="TRUE"?j={t:"b",v:!0}:S==="FALSE"?j={t:"b",v:!1}:isNaN(AA(S))?isNaN(xf(S).getDate())||(j={t:"d",v:Bn(S)},r.cellDates||(j={t:"n",v:zs(j.v)}),j.z=r.dateNF||Lr[14]):j={t:"n",v:AA(S)}),r.dense?(a[f]||(a[f]=[]),a[f][h]=j):a[Ir({r:f,c:h})]=j,h+=x}}}}return a["!ref"]=Wr(m),w.length&&(a["!merges"]=w),a}function jP(e,t,r,a){for(var n=e["!merges"]||[],s=[],l=t.s.c;l<=t.e.c;++l){for(var A=0,u=0,f=0;f<n.length;++f)if(!(n[f].s.r>r||n[f].s.c>l)&&!(n[f].e.r<r||n[f].e.c<l)){if(n[f].s.r<r||n[f].s.c<l){A=-1;break}A=n[f].e.r-n[f].s.r+1,u=n[f].e.c-n[f].s.c+1;break}if(!(A<0)){var h=Ir({r,c:l}),g=a.dense?(e[r]||[])[l]:e[h],x=g&&g.v!=null&&(g.h||N2(g.w||(zc(g),g.w)||""))||"",m={};A>1&&(m.rowspan=A),u>1&&(m.colspan=u),a.editable?x='<span contenteditable="true">'+x+"</span>":g&&(m["data-t"]=g&&g.t||"z",g.v!=null&&(m["data-v"]=g.v),g.z!=null&&(m["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+g.l.Target+'">'+x+"</a>")),m.id=(a.id||"sjs")+"-"+h,s.push(Mt("td",x,m))}}var w="<tr>";return w+s.join("")+"</tr>"}var DP='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',IP="</body></html>";function QP(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Zu(L4(r[0],t),t);var a=ny();return r.forEach(function(n,s){sy(a,L4(n,t),"Sheet"+(s+1))}),a}function OP(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function sN(e,t){var r=t||{},a=r.header!=null?r.header:DP,n=r.footer!=null?r.footer:IP,s=[a],l=Rl(e["!ref"]);r.dense=Array.isArray(e),s.push(OP(e,l,r));for(var A=l.s.r;A<=l.e.r;++A)s.push(jP(e,l,A,r));return s.push("</table>"+n),s.join("")}function iN(e,t,r){var a=r||{},n=0,s=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var l=typeof a.origin=="string"?Pn(a.origin):a.origin;n=l.r,s=l.c}var A=t.getElementsByTagName("tr"),u=Math.min(a.sheetRows||1e7,A.length),f={s:{r:0,c:0},e:{r:n,c:s}};if(e["!ref"]){var h=Rl(e["!ref"]);f.s.r=Math.min(f.s.r,h.s.r),f.s.c=Math.min(f.s.c,h.s.c),f.e.r=Math.max(f.e.r,h.e.r),f.e.c=Math.max(f.e.c,h.e.c),n==-1&&(f.e.r=n=h.e.r+1)}var g=[],x=0,m=e["!rows"]||(e["!rows"]=[]),w=0,v=0,B=0,k=0,N=0,S=0;for(e["!cols"]||(e["!cols"]=[]);w<A.length&&v<u;++w){var O=A[w];if(U4(O)){if(a.display)continue;m[v]={hidden:!0}}var T=O.children;for(B=k=0;B<T.length;++B){var U=T[B];if(!(a.display&&U4(U))){var D=U.hasAttribute("data-v")?U.getAttribute("data-v"):U.hasAttribute("v")?U.getAttribute("v"):E3(U.innerHTML),H=U.getAttribute("data-z")||U.getAttribute("z");for(x=0;x<g.length;++x){var j=g[x];j.s.c==k+s&&j.s.r<v+n&&v+n<=j.e.r&&(k=j.e.c+1-s,x=-1)}S=+U.getAttribute("colspan")||1,((N=+U.getAttribute("rowspan")||1)>1||S>1)&&g.push({s:{r:v+n,c:k+s},e:{r:v+n+(N||1)-1,c:k+s+(S||1)-1}});var W={t:"s",v:D},I=U.getAttribute("data-t")||U.getAttribute("t")||"";D!=null&&(D.length==0?W.t=I||"z":a.raw||D.trim().length==0||I=="s"||(D==="TRUE"?W={t:"b",v:!0}:D==="FALSE"?W={t:"b",v:!1}:isNaN(AA(D))?isNaN(xf(D).getDate())||(W={t:"d",v:Bn(D)},a.cellDates||(W={t:"n",v:zs(W.v)}),W.z=a.dateNF||Lr[14]):W={t:"n",v:AA(D)})),W.z===void 0&&H!=null&&(W.z=H);var Q="",Y=U.getElementsByTagName("A");if(Y&&Y.length)for(var z=0;z<Y.length&&!(Y[z].hasAttribute("href")&&(Q=Y[z].getAttribute("href"),Q.charAt(0)!="#"));++z);Q&&Q.charAt(0)!="#"&&(W.l={Target:Q}),a.dense?(e[v+n]||(e[v+n]=[]),e[v+n][k+s]=W):e[Ir({c:k+s,r:v+n})]=W,f.e.c<k+s&&(f.e.c=k+s),k+=S}}++v}return g.length&&(e["!merges"]=(e["!merges"]||[]).concat(g)),f.e.r=Math.max(f.e.r,v-1+n),e["!ref"]=Wr(f),v>=u&&(e["!fullref"]=Wr((f.e.r=A.length-w+v-1+n,f))),e}function lN(e,t){var r=t||{},a=r.dense?[]:{};return iN(a,e,t)}function RP(e,t){return Zu(lN(e,t),t)}function U4(e){var t="",r=MP(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function MP(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function HP(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ba(t.replace(/<[^>]*>/g,""));return[r]}var j4={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function oN(e,t){var r=t||{},a=F2(e),n=[],s,l,A={name:""},u="",f=0,h,g,x={},m=[],w=r.dense?[]:{},v,B,k={value:""},N="",S=0,O=[],T=-1,U=-1,D={s:{r:1e6,c:1e7},e:{r:0,c:0}},H=0,j={},W=[],I={},Q=0,Y=0,z=[],ue=1,Z=1,Ae=[],ve={Names:[]},G={},Se=["",""],we=[],F={},R="",M=0,P=!1,re=!1,ge=0;for(mp.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=mp.exec(a);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"":v[1]==="/"?(D.e.c>=D.s.c&&D.e.r>=D.s.r?w["!ref"]=Wr(D):w["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=D.e.r&&(w["!fullref"]=w["!ref"],D.e.r=r.sheetRows-1,w["!ref"]=Wr(D)),W.length&&(w["!merges"]=W),z.length&&(w["!rows"]=z),h.name=h.||h.name,typeof JSON<"u"&&JSON.stringify(h),m.push(h.name),x[h.name]=w,re=!1):v[0].charAt(v[0].length-2)!=="/"&&(h=Qr(v[0],!1),T=U=-1,D.s.r=D.s.c=1e7,D.e.r=D.e.c=0,w=r.dense?[]:{},W=[],z=[],re=!0);break;case"table-row-group":v[1]==="/"?--H:++H;break;case"table-row":case"":if(v[1]==="/"){T+=ue,ue=1;break}if(g=Qr(v[0],!1),g.?T=g.-1:T==-1&&(T=0),ue=+g["number-rows-repeated"]||1,ue<10)for(ge=0;ge<ue;++ge)H>0&&(z[T+ge]={level:H});U=-1;break;case"covered-table-cell":v[1]!=="/"&&++U,r.sheetStubs&&(r.dense?(w[T]||(w[T]=[]),w[T][U]={t:"z"}):w[Ir({r:T,c:U})]={t:"z"}),N="",O=[];break;case"table-cell":case"":if(v[0].charAt(v[0].length-2)==="/")++U,k=Qr(v[0],!1),Z=parseInt(k["number-columns-repeated"]||"1",10),B={t:"z",v:null},k.formula&&r.cellFormula!=!1&&(B.f=N4(Ba(k.formula))),(k.||k["value-type"])=="string"&&(B.t="s",B.v=Ba(k["string-value"]||""),r.dense?(w[T]||(w[T]=[]),w[T][U]=B):w[Ir({r:T,c:U})]=B),U+=Z-1;else if(v[1]!=="/"){++U,N="",S=0,O=[],Z=1;var Ce=ue?T+ue-1:T;if(U>D.e.c&&(D.e.c=U),U<D.s.c&&(D.s.c=U),T<D.s.r&&(D.s.r=T),Ce>D.e.r&&(D.e.r=Ce),k=Qr(v[0],!1),we=[],F={},B={t:k.||k["value-type"],v:null},r.cellFormula)if(k.formula&&(k.formula=Ba(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(Q=parseInt(k["number-matrix-rows-spanned"],10)||0,Y=parseInt(k["number-matrix-columns-spanned"],10)||0,I={s:{r:T,c:U},e:{r:T+Q-1,c:U+Y-1}},B.F=Wr(I),Ae.push([I,B.F])),k.formula)B.f=N4(k.formula);else for(ge=0;ge<Ae.length;++ge)T>=Ae[ge][0].s.r&&T<=Ae[ge][0].e.r&&U>=Ae[ge][0].s.c&&U<=Ae[ge][0].e.c&&(B.F=Ae[ge][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(Q=parseInt(k["number-rows-spanned"],10)||0,Y=parseInt(k["number-columns-spanned"],10)||0,I={s:{r:T,c:U},e:{r:T+Q-1,c:U+Y-1}},W.push(I)),k["number-columns-repeated"]&&(Z=parseInt(k["number-columns-repeated"],10)),B.t){case"boolean":B.t="b",B.v=yn(k["boolean-value"]);break;case"float":B.t="n",B.v=parseFloat(k.value);break;case"percentage":B.t="n",B.v=parseFloat(k.value);break;case"currency":B.t="n",B.v=parseFloat(k.value);break;case"date":B.t="d",B.v=Bn(k["date-value"]),r.cellDates||(B.t="n",B.v=zs(B.v)),B.z="m/d/yy";break;case"time":B.t="n",B.v=hj(k["time-value"])/86400,r.cellDates&&(B.t="d",B.v=Wx(B.v)),B.z="HH:MM:SS";break;case"number":B.t="n",B.v=parseFloat(k.);break;default:if(B.t==="string"||B.t==="text"||!B.t)B.t="s",k["string-value"]!=null&&(N=Ba(k["string-value"]),O=[]);else throw new Error("Unsupported value type "+B.t)}}else{if(P=!1,B.t==="s"&&(B.v=N||"",O.length&&(B.R=O),P=S==0),G.Target&&(B.l=G),we.length>0&&(B.c=we,we=[]),N&&r.cellText!==!1&&(B.w=N),P&&(B.t="z",delete B.v),(!P||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=T))for(var de=0;de<ue;++de){if(Z=parseInt(k["number-columns-repeated"]||"1",10),r.dense)for(w[T+de]||(w[T+de]=[]),w[T+de][U]=de==0?B:kn(B);--Z>0;)w[T+de][U+Z]=kn(B);else for(w[Ir({r:T+de,c:U})]=B;--Z>0;)w[Ir({r:T+de,c:U+Z})]=kn(B);D.e.c<=U&&(D.e.c=U)}Z=parseInt(k["number-columns-repeated"]||"1",10),U+=Z-1,Z=0,B={},N="",O=[]}G={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((s=n.pop())[0]!==v[3])throw"Bad state: "+s}else v[0].charAt(v[0].length-2)!=="/"&&n.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((s=n.pop())[0]!==v[3])throw"Bad state: "+s;F.t=N,O.length&&(F.R=O),F.a=R,we.push(F)}else v[0].charAt(v[0].length-2)!=="/"&&n.push([v[3],!1]);R="",M=0,N="",S=0,O=[];break;case"creator":v[1]==="/"?R=a.slice(M,v.index):M=v.index+v[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((s=n.pop())[0]!==v[3])throw"Bad state: "+s}else v[0].charAt(v[0].length-2)!=="/"&&n.push([v[3],!1]);N="",S=0,O=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(j[A.name]=u,(s=n.pop())[0]!==v[3])throw"Bad state: "+s}else v[0].charAt(v[0].length-2)!=="/"&&(u="",A=Qr(v[0],!1),n.push([v[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":l=Qr(v[0],!1),u+=j4[v[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":l=Qr(v[0],!1),u+=j4[v[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":u+=a.slice(f,v.index);break}else f=v.index+v[0].length;break;case"named-range":l=Qr(v[0],!1),Se=Wb(l["cell-range-address"]);var be={Name:l.name,Ref:Se[0]+"!"+Se[1]};re&&(be.Sheet=m.length),ve.Names.push(be);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(v[1]==="/"&&(!k||!k["string-value"])){var Le=HP(a.slice(S,v.index));N=(N.length>0?N+`
`:"")+Le[0]}else Qr(v[0],!1),S=v.index+v[0].length;break;case"s":break;case"database-range":if(v[1]==="/")break;try{Se=Wb(Qr(v[0])["target-range-address"]),x[Se[0]]["!autofilter"]={ref:Se[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(v[1]!=="/"){if(G=Qr(v[0],!1),!G.href)break;G.Target=Ba(G.href),delete G.href,G.Target.charAt(0)=="#"&&G.Target.indexOf(".")>-1?(Se=Wb(G.Target.slice(1)),G.Target="#"+Se[0]+"!"+Se[1]):G.Target.match(/^\.\.[\\\/]/)&&(G.Target=G.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(v)}}var ie={Sheets:x,SheetNames:m,Workbook:ve};return r.bookSheets&&delete ie.Sheets,ie}function D4(e,t){t=t||{},No(e,"META-INF/manifest.xml")&&hD(Ns(e,"META-INF/manifest.xml"),t);var r=Ao(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=oN(en(r),t);return No(e,"meta.xml")&&(a.Props=J3(Ns(e,"meta.xml"))),a}function I4(e,t){return oN(e,t)}var PP=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+gp({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return bs+t}})(),Q4=(function(){var e=function(s){return Va(s).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(s,l,A){var u=[];u.push('      <table:table table:name="'+Va(l.SheetNames[A])+`" table:style-name="ta1">
`);var f=0,h=0,g=Rl(s["!ref"]||"A1"),x=s["!merges"]||[],m=0,w=Array.isArray(s);if(s["!cols"])for(h=0;h<=g.e.c;++h)u.push("        <table:table-column"+(s["!cols"][h]?' table:style-name="co'+s["!cols"][h].ods+'"':"")+`></table:table-column>
`);var v="",B=s["!rows"]||[];for(f=0;f<g.s.r;++f)v=B[f]?' table:style-name="ro'+B[f].ods+'"':"",u.push("        <table:table-row"+v+`></table:table-row>
`);for(;f<=g.e.r;++f){for(v=B[f]?' table:style-name="ro'+B[f].ods+'"':"",u.push("        <table:table-row"+v+`>
`),h=0;h<g.s.c;++h)u.push(t);for(;h<=g.e.c;++h){var k=!1,N={},S="";for(m=0;m!=x.length;++m)if(!(x[m].s.c>h)&&!(x[m].s.r>f)&&!(x[m].e.c<h)&&!(x[m].e.r<f)){(x[m].s.c!=h||x[m].s.r!=f)&&(k=!0),N["table:number-columns-spanned"]=x[m].e.c-x[m].s.c+1,N["table:number-rows-spanned"]=x[m].e.r-x[m].s.r+1;break}if(k){u.push(r);continue}var O=Ir({r:f,c:h}),T=w?(s[f]||[])[h]:s[O];if(T&&T.f&&(N["table:formula"]=Va(oM(T.f)),T.F&&T.F.slice(0,O.length)==O)){var U=Rl(T.F);N["table:number-matrix-columns-spanned"]=U.e.c-U.s.c+1,N["table:number-matrix-rows-spanned"]=U.e.r-U.s.r+1}if(!T){u.push(t);continue}switch(T.t){case"b":S=T.v?"TRUE":"FALSE",N["office:value-type"]="boolean",N["office:boolean-value"]=T.v?"true":"false";break;case"n":S=T.w||String(T.v||0),N["office:value-type"]="float",N["office:value"]=T.v||0;break;case"s":case"str":S=T.v==null?"":T.v,N["office:value-type"]="string";break;case"d":S=T.w||Bn(T.v).toISOString(),N["office:value-type"]="date",N["office:date-value"]=Bn(T.v).toISOString(),N["table:style-name"]="ce1";break;default:u.push(t);continue}var D=e(S);if(T.l&&T.l.Target){var H=T.l.Target;H=H.charAt(0)=="#"?"#"+AM(H.slice(1)):H,H.charAt(0)!="#"&&!H.match(/^\w+:/)&&(H="../"+H),D=Mt("text:a",D,{"xlink:href":H.replace(/&/g,"&amp;")})}u.push("          "+Mt("table:table-cell",Mt("text:p",D,{}),N)+`
`)}u.push(`        </table:table-row>
`)}return u.push(`      </table:table>
`),u.join("")},n=function(s,l){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var A=0;l.SheetNames.map(function(f){return l.Sheets[f]}).forEach(function(f){if(f&&f["!cols"]){for(var h=0;h<f["!cols"].length;++h)if(f["!cols"][h]){var g=f["!cols"][h];if(g.width==null&&g.wpx==null&&g.wch==null)continue;qu(g),g.ods=A;var x=f["!cols"][h].wpx+"px";s.push('  <style:style style:name="co'+A+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),s.push(`  </style:style>
`),++A}}});var u=0;l.SheetNames.map(function(f){return l.Sheets[f]}).forEach(function(f){if(f&&f["!rows"]){for(var h=0;h<f["!rows"].length;++h)if(f["!rows"][h]){f["!rows"][h].ods=u;var g=f["!rows"][h].hpx+"px";s.push('  <style:style style:name="ro'+u+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+g+`"/>
`),s.push(`  </style:style>
`),++u}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(l,A){var u=[bs],f=gp({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=gp({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});A.bookType=="fods"?(u.push("<office:document"+f+h+`>
`),u.push($3().replace(/office:document-meta/g,"office:meta"))):u.push("<office:document-content"+f+`>
`),n(u,l),u.push(`  <office:body>
`),u.push(`    <office:spreadsheet>
`);for(var g=0;g!=l.SheetNames.length;++g)u.push(a(l.Sheets[l.SheetNames[g]],l,g));return u.push(`    </office:spreadsheet>
`),u.push(`  </office:body>
`),A.bookType=="fods"?u.push("</office:document>"):u.push("</office:document-content>"),u.join("")}})();function AN(e,t){if(t.bookType=="fods")return Q4(e,t);var r=C2(),a="",n=[],s=[];return a="mimetype",Yr(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",Yr(r,a,Q4(e,t)),n.push([a,"text/xml"]),s.push([a,"ContentFile"]),a="styles.xml",Yr(r,a,PP(e,t)),n.push([a,"text/xml"]),s.push([a,"StylesFile"]),a="meta.xml",Yr(r,a,bs+$3()),n.push([a,"text/xml"]),s.push([a,"MetadataFile"]),a="manifest.rdf",Yr(r,a,mD(s)),n.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",Yr(r,a,pD(n)),r}function P0(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function gw(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):en(Ju(e))}function KP(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):oo(ec(e))}function qP(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function Vu(e){var t=e.reduce(function(n,s){return n+s.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(n){r.set(n,a),a+=n.length}),r}function O4(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function zP(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,n=t+13;n>=t;--n)a=a*256+e[n];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function VP(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var s=0;n>=1;++s,n/=256)e[t+s]=n&255;e[t+15]|=r>=0?0:128}function Bp(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function Pa(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function rs(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Na(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],n=Bp(e,r),s=n&7;n=Math.floor(n/8);var l=0,A;if(n==0)break;switch(s){case 0:{for(var u=r[0];e[r[0]++]>=128;);A=e.slice(u,r[0])}break;case 5:l=4,A=e.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,A=e.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=Bp(e,r),A=e.slice(r[0],r[0]+l),r[0]+=l;break;default:throw new Error("PB Type ".concat(s," for Field ").concat(n," at offset ").concat(a))}var f={data:A,type:s};t[n]==null?t[n]=[f]:t[n].push(f)}return t}function mi(e){var t=[];return e.forEach(function(r,a){r.forEach(function(n){n.data&&(t.push(Pa(a*8+n.type)),n.type==2&&t.push(Pa(n.data.length)),t.push(n.data))})}),Vu(t)}function Z2(e,t){return e?.map(function(r){return t(r.data)})||[]}function So(e){for(var t,r=[],a=[0];a[0]<e.length;){var n=Bp(e,a),s=Na(e.slice(a[0],a[0]+n));a[0]+=n;var l={id:rs(s[1][0].data),messages:[]};s[2].forEach(function(A){var u=Na(A.data),f=rs(u[3][0].data);l.messages.push({meta:u,data:e.slice(a[0],a[0]+f)}),a[0]+=f}),(t=s[3])!=null&&t[0]&&(l.merge=rs(s[3][0].data)>>>0>0),r.push(l)}return r}function Dd(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:Pa(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:Pa(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(l){n.push(l.data),l.meta[3]=[{type:0,data:Pa(l.data.length)}],a[2].push({data:mi(l.meta),type:2})});var s=mi(a);t.push(Pa(s.length)),t.push(s),n.forEach(function(l){return t.push(l)})}),Vu(t)}function GP(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=Bp(t,r),n=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var l=t[r[0]++]>>2;if(l<60)++l;else{var A=l-59;l=t[r[0]],A>1&&(l|=t[r[0]+1]<<8),A>2&&(l|=t[r[0]+2]<<16),A>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=A}n.push(t.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var u=0,f=0;if(s==1?(f=(t[r[0]]>>2&7)+4,u=(t[r[0]++]&224)<<3,u|=t[r[0]++]):(f=(t[r[0]++]>>2)+1,s==2?(u=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(u=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[Vu(n)],u==0)throw new Error("Invalid offset 0");if(u>n[0].length)throw new Error("Invalid offset beyond length");if(f>=u)for(n.push(n[0].slice(-u)),f-=u;f>=n[n.length-1].length;)n.push(n[n.length-1]),f-=n[n.length-1].length;n.push(n[0].slice(-u,-u+f))}}var h=Vu(n);if(h.length!=a)throw new Error("Unexpected length: ".concat(h.length," != ").concat(a));return h}function Eo(e){for(var t=[],r=0;r<e.length;){var a=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(GP(a,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Vu(t)}function Id(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),n=new Uint8Array(4);t.push(n);var s=Pa(a),l=s.length;t.push(s),a<=60?(l++,t.push(new Uint8Array([a-1<<2]))):a<=256?(l+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(l+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(l+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(l+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),l+=a,n[0]=0,n[1]=l&255,n[2]=l>>8&255,n[3]=l>>16&255,r+=a}return Vu(t)}function WP(e,t,r,a){var n=P0(e),s=n.getUint32(4,!0),l=(a>1?12:8)+O4(s&(a>1?3470:398))*4,A=-1,u=-1,f=NaN,h=new Date(2001,0,1);s&512&&(A=n.getUint32(l,!0),l+=4),l+=O4(s&(a>1?12288:4096))*4,s&16&&(u=n.getUint32(l,!0),l+=4),s&32&&(f=n.getFloat64(l,!0),l+=8),s&64&&(h.setTime(h.getTime()+n.getFloat64(l,!0)*1e3),l+=8);var g;switch(e[2]){case 0:break;case 2:g={t:"n",v:f};break;case 3:g={t:"s",v:t[u]};break;case 5:g={t:"d",v:h};break;case 6:g={t:"b",v:f>0};break;case 7:g={t:"n",v:f/86400};break;case 8:g={t:"e",v:0};break;case 9:if(A>-1)g={t:"s",v:r[A]};else if(u>-1)g={t:"s",v:t[u]};else if(!isNaN(f))g={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return g}function XP(e,t,r){var a=P0(e),n=a.getUint32(8,!0),s=12,l=-1,A=-1,u=NaN,f=NaN,h=new Date(2001,0,1);n&1&&(u=zP(e,s),s+=16),n&2&&(f=a.getFloat64(s,!0),s+=8),n&4&&(h.setTime(h.getTime()+a.getFloat64(s,!0)*1e3),s+=8),n&8&&(A=a.getUint32(s,!0),s+=4),n&16&&(l=a.getUint32(s,!0),s+=4);var g;switch(e[1]){case 0:break;case 2:g={t:"n",v:u};break;case 3:g={t:"s",v:t[A]};break;case 5:g={t:"d",v:h};break;case 6:g={t:"b",v:f>0};break;case 7:g={t:"n",v:f/86400};break;case 8:g={t:"e",v:0};break;case 9:if(l>-1)g={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:g={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return g}function Yb(e,t){var r=new Uint8Array(32),a=P0(r),n=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,VP(r,n,e.v),s|=1,n+=16;break;case"b":r[1]=6,a.setFloat64(n,e.v?1:0,!0),s|=2,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(n,t.indexOf(e.v),!0),s|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,s,!0),r.slice(0,n)}function $b(e,t){var r=new Uint8Array(32),a=P0(r),n=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(n,e.v,!0),s|=32,n+=8;break;case"b":r[2]=6,a.setFloat64(n,e.v?1:0,!0),s|=32,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(n,t.indexOf(e.v),!0),s|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,s,!0),r.slice(0,n)}function YP(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return WP(e,t,r,e[0]);case 5:return XP(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Mi(e){var t=Na(e);return Bp(t[1][0].data)}function R4(e,t){var r=Na(t.data),a=rs(r[1][0].data),n=r[3],s=[];return(n||[]).forEach(function(l){var A=Na(l.data),u=rs(A[1][0].data)>>>0;switch(a){case 1:s[u]=gw(A[3][0].data);break;case 8:{var f=e[Mi(A[9][0].data)][0],h=Na(f.data),g=e[Mi(h[1][0].data)][0],x=rs(g.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var m=Na(g.data);s[u]=m[3].map(function(w){return gw(w.data)}).join("")}break}}),s}function $P(e,t){var r,a,n,s,l,A,u,f,h,g,x,m,w,v,B=Na(e),k=rs(B[1][0].data)>>>0,N=rs(B[2][0].data)>>>0,S=((a=(r=B[8])==null?void 0:r[0])==null?void 0:a.data)&&rs(B[8][0].data)>0||!1,O,T;if((s=(n=B[7])==null?void 0:n[0])!=null&&s.data&&t!=0)O=(A=(l=B[7])==null?void 0:l[0])==null?void 0:A.data,T=(f=(u=B[6])==null?void 0:u[0])==null?void 0:f.data;else if((g=(h=B[4])==null?void 0:h[0])!=null&&g.data&&t!=1)O=(m=(x=B[4])==null?void 0:x[0])==null?void 0:m.data,T=(v=(w=B[3])==null?void 0:w[0])==null?void 0:v.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var U=S?4:1,D=P0(O),H=[],j=0;j<O.length/2;++j){var W=D.getUint16(j*2,!0);W<65535&&H.push([j,W])}if(H.length!=N)throw"Expected ".concat(N," cells, found ").concat(H.length);var I=[];for(j=0;j<H.length-1;++j)I[H[j][0]]=T.subarray(H[j][1]*U,H[j+1][1]*U);return H.length>=1&&(I[H[H.length-1][0]]=T.subarray(H[H.length-1][1]*U)),{R:k,cells:I}}function JP(e,t){var r,a=Na(t.data),n=(r=a?.[7])!=null&&r[0]?rs(a[7][0].data)>>>0>0?1:0:-1,s=Z2(a[5],function(l){return $P(l,n)});return{nrows:rs(a[4][0].data)>>>0,data:s.reduce(function(l,A){return l[A.R]||(l[A.R]=[]),A.cells.forEach(function(u,f){if(l[A.R][f])throw new Error("Duplicate cell r=".concat(A.R," c=").concat(f));l[A.R][f]=u}),l},[])}}function ZP(e,t,r){var a,n=Na(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(rs(n[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(s.e.c=(rs(n[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=Wr(s);var l=Na(n[4][0].data),A=R4(e,e[Mi(l[4][0].data)][0]),u=(a=l[17])!=null&&a[0]?R4(e,e[Mi(l[17][0].data)][0]):[],f=Na(l[3][0].data),h=0;f[1].forEach(function(g){var x=Na(g.data),m=e[Mi(x[2][0].data)][0],w=rs(m.meta[1][0].data);if(w!=6002)throw new Error("6001 unexpected reference to ".concat(w));var v=JP(e,m);v.data.forEach(function(B,k){B.forEach(function(N,S){var O=Ir({r:h+k,c:S}),T=YP(N,A,u);T&&(r[O]=T)})}),h+=v.nrows})}function eK(e,t){var r=Na(t.data),a={"!ref":"A1"},n=e[Mi(r[2][0].data)],s=rs(n[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return ZP(e,n[0],a),a}function tK(e,t){var r,a=Na(t.data),n={name:(r=a[1])!=null&&r[0]?gw(a[1][0].data):"",sheets:[]},s=Z2(a[2],Mi);return s.forEach(function(l){e[l].forEach(function(A){var u=rs(A.meta[1][0].data);u==6e3&&n.sheets.push(eK(e,A))})}),n}function rK(e,t){var r=ny(),a=Na(t.data),n=Z2(a[1],Mi);if(n.forEach(function(s){e[s].forEach(function(l){var A=rs(l.meta[1][0].data);if(A==2){var u=tK(e,l);u.sheets.forEach(function(f,h){sy(r,f,h==0?u.name:u.name+"_"+h,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Jb(e){var t,r,a,n,s={},l=[];if(e.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var f;try{f=Eo(u.content)}catch(g){return console.log("?? "+u.content.length+" "+(g.message||g))}var h;try{h=So(f)}catch(g){return console.log("## "+(g.message||g))}h.forEach(function(g){s[g.id]=g.messages,l.push(g.id)})}}),!l.length)throw new Error("File has no messages");var A=((n=(a=(r=(t=s?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&rs(s[1][0].meta[1][0].data)==1&&s[1][0];if(A||l.forEach(function(u){s[u].forEach(function(f){var h=rs(f.meta[1][0].data)>>>0;if(h==1)if(!A)A=f;else throw new Error("Document has multiple roots")})}),!A)throw new Error("Cannot find Document root");return rK(s,A)}function aK(e,t,r){var a,n,s,l;if(!((a=e[6])!=null&&a[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var A=((l=(s=e[8])==null?void 0:s[0])==null?void 0:l.data)&&rs(e[8][0].data)>0||!1;if(A)throw"Math only works with normal offsets";for(var u=0,f=P0(e[7][0].data),h=0,g=[],x=P0(e[4][0].data),m=0,w=[],v=0;v<t.length;++v){if(t[v]==null){f.setUint16(v*2,65535,!0),x.setUint16(v*2,65535);continue}f.setUint16(v*2,h,!0),x.setUint16(v*2,m,!0);var B,k;switch(typeof t[v]){case"string":B=Yb({t:"s",v:t[v]},r),k=$b({t:"s",v:t[v]},r);break;case"number":B=Yb({t:"n",v:t[v]},r),k=$b({t:"n",v:t[v]},r);break;case"boolean":B=Yb({t:"b",v:t[v]},r),k=$b({t:"b",v:t[v]},r);break;default:throw new Error("Unsupported value "+t[v])}g.push(B),h+=B.length,w.push(k),m+=k.length,++u}for(e[2][0].data=Pa(u);v<e[7][0].data.length/2;++v)f.setUint16(v*2,65535,!0),x.setUint16(v*2,65535,!0);return e[6][0].data=Vu(g),e[3][0].data=Vu(w),u}function nK(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=Rl(r["!ref"]);a.s.r=a.s.c=0;var n=!1;a.e.c>9&&(n=!0,a.e.c=9),a.e.r>49&&(n=!0,a.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(Wr(a)));var s=mx(r,{range:a,header:1}),l=["~Sh33tJ5~"];s.forEach(function(R){return R.forEach(function(M){typeof M=="string"&&l.push(M)})});var A={},u=[],f=yr.read(t.numbers,{type:"base64"});f.FileIndex.map(function(R,M){return[R,f.FullPaths[M]]}).forEach(function(R){var M=R[0],P=R[1];if(M.type==2&&M.name.match(/\.iwa/)){var re=M.content,ge=Eo(re),Ce=So(ge);Ce.forEach(function(de){u.push(de.id),A[de.id]={deps:[],location:P,type:rs(de.messages[0].meta[1][0].data)}})}}),u.sort(function(R,M){return R-M});var h=u.filter(function(R){return R>1}).map(function(R){return[R,Pa(R)]});f.FileIndex.map(function(R,M){return[R,f.FullPaths[M]]}).forEach(function(R){var M=R[0];if(R[1],!!M.name.match(/\.iwa/)){var P=So(Eo(M.content));P.forEach(function(re){re.messages.forEach(function(ge){h.forEach(function(Ce){re.messages.some(function(de){return rs(de.meta[1][0].data)!=11006&&qP(de.data,Ce[1])})&&A[Ce[0]].deps.push(re.id)})})})}});for(var g=yr.find(f,A[1].location),x=So(Eo(g.content)),m,w=0;w<x.length;++w){var v=x[w];v.id==1&&(m=v)}var B=Mi(Na(m.messages[0].data)[1][0].data);for(g=yr.find(f,A[B].location),x=So(Eo(g.content)),w=0;w<x.length;++w)v=x[w],v.id==B&&(m=v);for(B=Mi(Na(m.messages[0].data)[2][0].data),g=yr.find(f,A[B].location),x=So(Eo(g.content)),w=0;w<x.length;++w)v=x[w],v.id==B&&(m=v);for(B=Mi(Na(m.messages[0].data)[2][0].data),g=yr.find(f,A[B].location),x=So(Eo(g.content)),w=0;w<x.length;++w)v=x[w],v.id==B&&(m=v);var k=Na(m.messages[0].data);{k[6][0].data=Pa(a.e.r+1),k[7][0].data=Pa(a.e.c+1);var N=Mi(k[46][0].data),S=yr.find(f,A[N].location),O=So(Eo(S.content));{for(var T=0;T<O.length&&O[T].id!=N;++T);if(O[T].id!=N)throw"Bad ColumnRowUIDMapArchive";var U=Na(O[T].messages[0].data);U[1]=[],U[2]=[],U[3]=[];for(var D=0;D<=a.e.c;++D){var H=[];H[1]=H[2]=[{type:0,data:Pa(D+420690)}],U[1].push({type:2,data:mi(H)}),U[2].push({type:0,data:Pa(D)}),U[3].push({type:0,data:Pa(D)})}U[4]=[],U[5]=[],U[6]=[];for(var j=0;j<=a.e.r;++j)H=[],H[1]=H[2]=[{type:0,data:Pa(j+726270)}],U[4].push({type:2,data:mi(H)}),U[5].push({type:0,data:Pa(j)}),U[6].push({type:0,data:Pa(j)});O[T].messages[0].data=mi(U)}S.content=Id(Dd(O)),S.size=S.content.length,delete k[46];var W=Na(k[4][0].data);{W[7][0].data=Pa(a.e.r+1);var I=Na(W[1][0].data),Q=Mi(I[2][0].data);S=yr.find(f,A[Q].location),O=So(Eo(S.content));{if(O[0].id!=Q)throw"Bad HeaderStorageBucket";var Y=Na(O[0].messages[0].data);for(j=0;j<s.length;++j){var z=Na(Y[2][0].data);z[1][0].data=Pa(j),z[4][0].data=Pa(s[j].length),Y[2][j]={type:Y[2][0].type,data:mi(z)}}O[0].messages[0].data=mi(Y)}S.content=Id(Dd(O)),S.size=S.content.length;var ue=Mi(W[2][0].data);S=yr.find(f,A[ue].location),O=So(Eo(S.content));{if(O[0].id!=ue)throw"Bad HeaderStorageBucket";for(Y=Na(O[0].messages[0].data),D=0;D<=a.e.c;++D)z=Na(Y[2][0].data),z[1][0].data=Pa(D),z[4][0].data=Pa(a.e.r+1),Y[2][D]={type:Y[2][0].type,data:mi(z)};O[0].messages[0].data=mi(Y)}S.content=Id(Dd(O)),S.size=S.content.length;var Z=Mi(W[4][0].data);(function(){for(var R=yr.find(f,A[Z].location),M=So(Eo(R.content)),P,re=0;re<M.length;++re){var ge=M[re];ge.id==Z&&(P=ge)}var Ce=Na(P.messages[0].data);{Ce[3]=[];var de=[];l.forEach(function(ie,_e){de[1]=[{type:0,data:Pa(_e)}],de[2]=[{type:0,data:Pa(1)}],de[3]=[{type:2,data:KP(ie)}],Ce[3].push({type:2,data:mi(de)})})}P.messages[0].data=mi(Ce);var be=Dd(M),Le=Id(be);R.content=Le,R.size=R.content.length})();var Ae=Na(W[3][0].data);{var ve=Ae[1][0];delete Ae[2];var G=Na(ve.data);{var Se=Mi(G[2][0].data);(function(){for(var R=yr.find(f,A[Se].location),M=So(Eo(R.content)),P,re=0;re<M.length;++re){var ge=M[re];ge.id==Se&&(P=ge)}var Ce=Na(P.messages[0].data);{delete Ce[6],delete Ae[7];var de=new Uint8Array(Ce[5][0].data);Ce[5]=[];for(var be=0,Le=0;Le<=a.e.r;++Le){var ie=Na(de);be+=aK(ie,s[Le],l),ie[1][0].data=Pa(Le),Ce[5].push({data:mi(ie),type:2})}Ce[1]=[{type:0,data:Pa(a.e.c+1)}],Ce[2]=[{type:0,data:Pa(a.e.r+1)}],Ce[3]=[{type:0,data:Pa(be)}],Ce[4]=[{type:0,data:Pa(a.e.r+1)}]}P.messages[0].data=mi(Ce);var _e=Dd(M),je=Id(_e);R.content=je,R.size=R.content.length})()}ve.data=mi(G)}W[3][0].data=mi(Ae)}k[4][0].data=mi(W)}m.messages[0].data=mi(k);var we=Dd(x),F=Id(we);return g.content=F,g.size=g.content.length,f}function cN(e){return function(r){for(var a=0;a!=e.length;++a){var n=e[a];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function ey(e){cN([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function ty(e){cN([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function sK(e){return na.WS.indexOf(e)>-1?"sheet":e==na.CS?"chart":e==na.DS?"dialog":e==na.MS?"macro":e&&e.length?e:"sheet"}function iK(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,sK(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function lK(e,t,r,a,n,s,l,A,u,f,h,g){try{s[a]=Gh(Ao(e,r,!0),t);var x=Ns(e,t),m;switch(A){case"sheet":m=NH(x,t,n,u,s[a],f,h,g);break;case"chart":if(m=FH(x,t,n,u,s[a],f,h,g),!m||!m["!drawel"])break;var w=Uh(m["!drawel"].Target,t),v=xp(w),B=gO(Ao(e,w,!0),Gh(Ao(e,v,!0),w)),k=Uh(B,w),N=xp(k);m=aH(Ao(e,k,!0),k,u,Gh(Ao(e,N,!0),k),f,m);break;case"macro":m=TH(x,t,n,u,s[a],f,h,g);break;case"dialog":m=LH(x,t,n,u,s[a],f,h,g);break;default:throw new Error("Unrecognized sheet type "+A)}l[a]=m;var S=[];s&&s[a]&&as(s[a]).forEach(function(O){var T="";if(s[a][O].Type==na.CMNT){T=Uh(s[a][O].Target,t);var U=IH(Ns(e,T,!0),T,u);if(!U||!U.length)return;B4(m,U,!1)}s[a][O].Type==na.TCMNT&&(T=Uh(s[a][O].Target,t),S=S.concat(xO(Ns(e,T,!0),u)))}),S&&S.length&&B4(m,S,!0,u.people||[])}catch(O){if(u.WTF)throw O}}function Bo(e){return e.charAt(0)=="/"?e.slice(1):e}function oK(e,t){if(Cf(),t=t||{},ey(t),No(e,"META-INF/manifest.xml")||No(e,"objectdata.xml"))return D4(e,t);if(No(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Jb<"u"){if(e.FileIndex)return Jb(e);var r=yr.utils.cfb_new();return zB(e).forEach(function(z){Yr(r,z,bj(e,z))}),Jb(r)}throw new Error("Unsupported NUMBERS file")}if(!No(e,"[Content_Types].xml"))throw No(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):No(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=zB(e),n=dD(Ao(e,"[Content_Types].xml")),s=!1,l,A;if(n.workbooks.length===0&&(A="xl/workbook.xml",Ns(e,A,!0)&&n.workbooks.push(A)),n.workbooks.length===0){if(A="xl/workbook.bin",!Ns(e,A,!0))throw new Error("Could not find workbook");n.workbooks.push(A),s=!0}n.workbooks[0].slice(-3)=="bin"&&(s=!0);var u={},f={};if(!t.bookSheets&&!t.bookProps){if(Wh=[],n.sst)try{Wh=DH(Ns(e,Bo(n.sst)),n.sst,t)}catch(z){if(t.WTF)throw z}t.cellStyles&&n.themes.length&&(u=jH(Ao(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],t)),n.style&&(f=UH(Ns(e,Bo(n.style)),n.style,u,t))}n.links.map(function(z){try{var ue=Gh(Ao(e,xp(Bo(z))),z);return OH(Ns(e,Bo(z)),ue,z,t)}catch{}});var h=EH(Ns(e,Bo(n.workbooks[0])),n.workbooks[0],t),g={},x="";n.coreprops.length&&(x=Ns(e,Bo(n.coreprops[0]),!0),x&&(g=J3(x)),n.extprops.length!==0&&(x=Ns(e,Bo(n.extprops[0]),!0),x&&bD(x,g,t)));var m={};(!t.bookSheets||t.bookProps)&&n.custprops.length!==0&&(x=Ao(e,Bo(n.custprops[0]),!0),x&&(m=wD(x,t)));var w={};if((t.bookSheets||t.bookProps)&&(h.Sheets?l=h.Sheets.map(function(ue){return ue.name}):g.Worksheets&&g.SheetNames.length>0&&(l=g.SheetNames),t.bookProps&&(w.Props=g,w.Custprops=m),t.bookSheets&&typeof l<"u"&&(w.SheetNames=l),t.bookSheets?w.SheetNames:t.bookProps))return w;l={};var v={};t.bookDeps&&n.calcchain&&(v=QH(Ns(e,Bo(n.calcchain)),n.calcchain));var B=0,k={},N,S;{var O=h.Sheets;g.Worksheets=O.length,g.SheetNames=[];for(var T=0;T!=O.length;++T)g.SheetNames[T]=O[T].name}var U=s?"bin":"xml",D=n.workbooks[0].lastIndexOf("/"),H=(n.workbooks[0].slice(0,D+1)+"_rels/"+n.workbooks[0].slice(D+1)+".rels").replace(/^\//,"");No(e,H)||(H="xl/_rels/workbook."+U+".rels");var j=Gh(Ao(e,H,!0),H.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(t.xlmeta=RH(Ns(e,Bo(n.metadata[0])),n.metadata[0],t)),(n.people||[]).length>=1&&(t.people=vO(Ns(e,Bo(n.people[0])),t)),j&&(j=iK(j,h.Sheets));var W=Ns(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(B=0;B!=g.Worksheets;++B){var I="sheet";if(j&&j[B]?(N="xl/"+j[B][1].replace(/[\/]?xl\//,""),No(e,N)||(N=j[B][1]),No(e,N)||(N=H.replace(/_rels\/.*$/,"")+j[B][1]),I=j[B][2]):(N="xl/worksheets/sheet"+(B+1-W)+"."+U,N=N.replace(/sheet0\./,"sheet.")),S=N.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(B!=t.sheets)continue e;break;case"string":if(g.SheetNames[B].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var Q=!1,Y=0;Y!=t.sheets.length;++Y)typeof t.sheets[Y]=="number"&&t.sheets[Y]==B&&(Q=1),typeof t.sheets[Y]=="string"&&t.sheets[Y].toLowerCase()==g.SheetNames[B].toLowerCase()&&(Q=1);if(!Q)continue e}}lK(e,N,S,g.SheetNames[B],B,k,l,I,t,h,u,f)}return w={Directory:n,Workbook:h,Props:g,Custprops:m,Deps:v,Sheets:l,SheetNames:g.SheetNames,Strings:Wh,Styles:f,Themes:u,SSF:kn(Lr)},t&&t.bookFiles&&(e.files?(w.keys=a,w.files=e.files):(w.keys=[],w.files={},e.FullPaths.forEach(function(z,ue){z=z.replace(/^Root Entry[\/]/,""),w.keys.push(z),w.files[z]=e.FileIndex[ue]}))),t&&t.bookVBA&&(n.vba.length>0?w.vbaraw=Ns(e,Bo(n.vba[0]),!0):n.defaults&&n.defaults.bin===EO&&(w.vbaraw=Ns(e,"xl/vbaProject.bin",!0))),w}function AK(e,t){var r=t||{},a="Workbook",n=yr.find(e,a);try{if(a="/!DataSpaces/Version",n=yr.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(RQ(n.content),a="/!DataSpaces/DataSpaceMap",n=yr.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var s=HQ(n.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=yr.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=PQ(n.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=yr.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);qQ(n.content)}catch{}if(a="/EncryptionInfo",n=yr.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var A=zQ(n.content);if(a="/EncryptedPackage",n=yr.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(A[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(A[1],n.content,r.password||"",r);if(A[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(A[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function cK(e,t){return t.bookType=="ods"?AN(e,t):t.bookType=="numbers"?nK(e,t):t.bookType=="xlsb"?uK(e,t):dK(e,t)}function uK(e,t){ef=1024,e&&!e.SSF&&(e.SSF=kn(Lr)),e&&e.SSF&&(Cf(),zx(e.SSF),t.revssf=Gx(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Xh?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=QE.indexOf(t.bookType)>-1,n=M2();ty(t=t||{});var s=C2(),l="",A=0;if(t.cellXfs=[],e0(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",Yr(s,l,Z3(e.Props,t)),n.coreprops.push(l),qa(t.rels,2,l,na.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&u.push(e.SheetNames[f]);e.Props.SheetNames=u}for(e.Props.Worksheets=e.Props.SheetNames.length,Yr(s,l,rE(e.Props)),n.extprops.push(l),qa(t.rels,3,l,na.EXT_PROPS),e.Custprops!==e.Props&&as(e.Custprops||{}).length>0&&(l="docProps/custom.xml",Yr(s,l,aE(e.Custprops)),n.custprops.push(l),qa(t.rels,4,l,na.CUST_PROPS)),A=1;A<=e.SheetNames.length;++A){var h={"!id":{}},g=e.Sheets[e.SheetNames[A-1]],x=(g||{})["!type"]||"sheet";if(l="xl/worksheets/sheet"+A+"."+r,Yr(s,l,HH(A-1,l,t,e,h)),n.sheets.push(l),qa(t.wbrels,-1,"worksheets/sheet"+A+"."+r,na.WS[0]),g){var m=g["!comments"],w=!1,v="";m&&m.length>0&&(v="xl/comments"+A+"."+r,Yr(s,v,qH(m,v)),n.comments.push(v),qa(h,-1,"../comments"+A+"."+r,na.CMNT),w=!0),g["!legacy"]&&w&&Yr(s,"xl/drawings/vmlDrawing"+A+".vml",DE(A,g["!comments"])),delete g["!comments"],delete g["!legacy"]}h["!id"].rId1&&Yr(s,xp(l),Af(h))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,Yr(s,l,KH(t.Strings,l,t)),n.strs.push(l),qa(t.wbrels,-1,"sharedStrings."+r,na.SST)),l="xl/workbook."+r,Yr(s,l,MH(e,l)),n.workbooks.push(l),qa(t.rels,1,l,na.WB),l="xl/theme/theme1.xml",Yr(s,l,V2(e.Themes,t)),n.themes.push(l),qa(t.wbrels,-1,"theme/theme1.xml",na.THEME),l="xl/styles."+r,Yr(s,l,PH(e,l,t)),n.styles.push(l),qa(t.wbrels,-1,"styles."+r,na.STY),e.vbaraw&&a&&(l="xl/vbaProject.bin",Yr(s,l,e.vbaraw),n.vba.push(l),qa(t.wbrels,-1,"vbaProject.bin",na.VBA)),l="xl/metadata."+r,Yr(s,l,zH(l)),n.metadata.push(l),qa(t.wbrels,-1,"metadata."+r,na.XLMETA),Yr(s,"[Content_Types].xml",Y3(n,t)),Yr(s,"_rels/.rels",Af(t.rels)),Yr(s,"xl/_rels/workbook."+r+".rels",Af(t.wbrels)),delete t.revssf,delete t.ssf,s}function dK(e,t){ef=1024,e&&!e.SSF&&(e.SSF=kn(Lr)),e&&e.SSF&&(Cf(),zx(e.SSF),t.revssf=Gx(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Xh?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=QE.indexOf(t.bookType)>-1,n=M2();ty(t=t||{});var s=C2(),l="",A=0;if(t.cellXfs=[],e0(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",Yr(s,l,Z3(e.Props,t)),n.coreprops.push(l),qa(t.rels,2,l,na.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&u.push(e.SheetNames[f]);e.Props.SheetNames=u}e.Props.Worksheets=e.Props.SheetNames.length,Yr(s,l,rE(e.Props)),n.extprops.push(l),qa(t.rels,3,l,na.EXT_PROPS),e.Custprops!==e.Props&&as(e.Custprops||{}).length>0&&(l="docProps/custom.xml",Yr(s,l,aE(e.Custprops)),n.custprops.push(l),qa(t.rels,4,l,na.CUST_PROPS));var h=["SheetJ5"];for(t.tcid=0,A=1;A<=e.SheetNames.length;++A){var g={"!id":{}},x=e.Sheets[e.SheetNames[A-1]],m=(x||{})["!type"]||"sheet";if(l="xl/worksheets/sheet"+A+"."+r,Yr(s,l,WE(A-1,t,e,g)),n.sheets.push(l),qa(t.wbrels,-1,"worksheets/sheet"+A+"."+r,na.WS[0]),x){var w=x["!comments"],v=!1,B="";if(w&&w.length>0){var k=!1;w.forEach(function(N){N[1].forEach(function(S){S.T==!0&&(k=!0)})}),k&&(B="xl/threadedComments/threadedComment"+A+"."+r,Yr(s,B,bO(w,h,t)),n.threadedcomments.push(B),qa(g,-1,"../threadedComments/threadedComment"+A+"."+r,na.TCMNT)),B="xl/comments"+A+"."+r,Yr(s,B,IE(w)),n.comments.push(B),qa(g,-1,"../comments"+A+"."+r,na.CMNT),v=!0}x["!legacy"]&&v&&Yr(s,"xl/drawings/vmlDrawing"+A+".vml",DE(A,x["!comments"])),delete x["!comments"],delete x["!legacy"]}g["!id"].rId1&&Yr(s,xp(l),Af(g))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,Yr(s,l,_E(t.Strings,t)),n.strs.push(l),qa(t.wbrels,-1,"sharedStrings."+r,na.SST)),l="xl/workbook."+r,Yr(s,l,ZE(e)),n.workbooks.push(l),qa(t.rels,1,l,na.WB),l="xl/theme/theme1.xml",Yr(s,l,V2(e.Themes,t)),n.themes.push(l),qa(t.wbrels,-1,"theme/theme1.xml",na.THEME),l="xl/styles."+r,Yr(s,l,TE(e,t)),n.styles.push(l),qa(t.wbrels,-1,"styles."+r,na.STY),e.vbaraw&&a&&(l="xl/vbaProject.bin",Yr(s,l,e.vbaraw),n.vba.push(l),qa(t.wbrels,-1,"vbaProject.bin",na.VBA)),l="xl/metadata."+r,Yr(s,l,jE()),n.metadata.push(l),qa(t.wbrels,-1,"metadata."+r,na.XLMETA),h.length>1&&(l="xl/persons/person.xml",Yr(s,l,wO(h)),n.people.push(l),qa(t.wbrels,-1,"persons/person.xml",na.PEOPLE)),Yr(s,"[Content_Types].xml",Y3(n,t)),Yr(s,"_rels/.rels",Af(t.rels)),Yr(s,"xl/_rels/workbook."+r+".rels",Af(t.wbrels)),delete t.revssf,delete t.ssf,s}function ry(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ho(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function fK(e,t){return yr.find(e,"EncryptedPackage")?AK(e,t):aN(e,t)}function hK(e,t){var r,a=e,n=t||{};return n.type||(n.type=Zr&&Buffer.isBuffer(e)?"buffer":"base64"),r=k3(a,n),oK(r,n)}function uN(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return hw(e.slice(r),t);default:break e}return bf.to_workbook(e,t)}function pK(e,t){var r="",a=ry(e,t);switch(t.type){case"base64":r=ho(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=O0(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=en(r)),t.type="binary",uN(r,t)}function gK(e,t){var r=e;return t.type=="base64"&&(r=ho(r)),r=dp.utils.decode(1200,r.slice(2),"str"),t.type="binary",uN(r,t)}function mK(e){return e.match(/[^\x00-\x7F]/)?ec(e):e}function Zb(e,t,r,a){return a?(r.type="string",bf.to_workbook(e,r)):bf.to_workbook(t,r)}function gx(e,t){w2();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return gx(new Uint8Array(e),(r=kn(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,n=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),uf={},r.dateNF&&(uf.dateNF=r.dateNF),r.type||(r.type=Zr&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Zr?"buffer":"binary",a=uj(e),typeof Uint8Array<"u"&&!Zr&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,a=mK(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),A=new Uint8Array(l);if(A.foo="bar",!A.foo)return r=kn(r),r.type="array",gx(y2(a),r)}switch((n=ry(a,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return fK(yr.read(a,r),r);break;case 9:if(n[1]<=8)return aN(a,r);break;case 60:return hw(a,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return yQ(a,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return wE.to_workbook(a,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?hK(a,r):Zb(e,a,r,s);case 239:return n[3]===60?hw(a,r):Zb(e,a,r,s);case 255:if(n[1]===254)return gK(a,r);if(n[1]===0&&n[2]===2&&n[3]===0)return T0.to_workbook(a,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return T0.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return fw.to_workbook(a,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return EE.to_workbook(a,r);break;case 10:case 13:case 32:return pK(a,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return wQ.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?fw.to_workbook(a,r):Zb(e,a,r,s)}function dN(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Dp(t.file,yr.write(e,{type:Zr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return yr.write(e,t)}function xK(e,t){var r=kn(t||{}),a=cK(e,r);return bK(a,r)}function bK(e,t){var r={},a=Zr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?yr.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array(qx(n))}return t.password&&typeof encrypt_agile<"u"?dN(encrypt_agile(n,t.password),t):t.type==="file"?Dp(t.file,n):t.type=="string"?en(n):n}function vK(e,t){var r=t||{},a=mP(e,r);return dN(a,r)}function qA(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return fp(ec(a));case"binary":return ec(a);case"string":return e;case"file":return Dp(t.file,a,"utf8");case"buffer":return Zr?Gc(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):qA(a,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function wK(e,t){switch(t.type){case"base64":return fp(e);case"binary":return e;case"string":return e;case"file":return Dp(t.file,e,"binary");case"buffer":return Zr?Gc(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function rm(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?fp(r):t.type=="string"?en(r):r;case"file":return Dp(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function fN(e,t){w2(),fH(e);var r=kn(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=fN(e,r);return r.type="array",qx(a)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=e.SheetNames.indexOf(r.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return qA(cP(e,r),r);case"slk":case"sylk":return qA(vE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"htm":case"html":return qA(sN(e.Sheets[e.SheetNames[n]],r),r);case"txt":return wK(hN(e.Sheets[e.SheetNames[n]],r),r);case"csv":return qA(ay(e.Sheets[e.SheetNames[n]],r),r,"\uFEFF");case"dif":return qA(wE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"dbf":return rm(fw.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"prn":return qA(bf.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"rtf":return qA(EE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"eth":return qA(yE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"fods":return qA(AN(e,r),r);case"wk1":return rm(T0.sheet_to_wk1(e.Sheets[e.SheetNames[n]],r),r);case"wk3":return rm(T0.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),rm(nN(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),vK(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return xK(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function yK(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function _K(e,t,r){var a={};return a.type="file",a.file=t,yK(a),fN(e,a)}function BK(e,t,r,a,n,s,l,A){var u=xs(r),f=A.defval,h=A.raw||!Object.prototype.hasOwnProperty.call(A,"raw"),g=!0,x=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:r,enumerable:!1})}catch{x.__rowNum__=r}else x.__rowNum__=r;if(!l||e[r])for(var m=t.s.c;m<=t.e.c;++m){var w=l?e[r][m]:e[a[m]+u];if(w===void 0||w.t===void 0){if(f===void 0)continue;s[m]!=null&&(x[s[m]]=f);continue}var v=w.v;switch(w.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(s[m]!=null){if(v==null)if(w.t=="e"&&v===null)x[s[m]]=null;else if(f!==void 0)x[s[m]]=f;else if(h&&v===null)x[s[m]]=null;else continue;else x[s[m]]=h&&(w.t!=="n"||w.t==="n"&&A.rawNumbers!==!1)?v:zc(w,v,A);v!=null&&(g=!1)}}return{row:x,isempty:g}}function mx(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,n=1,s=[],l=0,A="",u={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},h=f.range!=null?f.range:e["!ref"];switch(f.header===1?a=1:f.header==="A"?a=2:Array.isArray(f.header)?a=3:f.header==null&&(a=0),typeof h){case"string":u=ka(h);break;case"number":u=ka(e["!ref"]),u.s.r=h;break;default:u=h}a>0&&(n=0);var g=xs(u.s.r),x=[],m=[],w=0,v=0,B=Array.isArray(e),k=u.s.r,N=0,S={};B&&!e[k]&&(e[k]=[]);var O=f.skipHidden&&e["!cols"]||[],T=f.skipHidden&&e["!rows"]||[];for(N=u.s.c;N<=u.e.c;++N)if(!(O[N]||{}).hidden)switch(x[N]=Hn(N),r=B?e[k][N]:e[x[N]+g],a){case 1:s[N]=N-u.s.c;break;case 2:s[N]=x[N];break;case 3:s[N]=f.header[N-u.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),A=l=zc(r,null,f),v=S[l]||0,!v)S[l]=1;else{do A=l+"_"+v++;while(S[A]);S[l]=v,S[A]=1}s[N]=A}for(k=u.s.r+n;k<=u.e.r;++k)if(!(T[k]||{}).hidden){var U=BK(e,u,k,x,a,s,B,f);(U.isempty===!1||(a===1?f.blankrows!==!1:f.blankrows))&&(m[w++]=U.row)}return m.length=w,m}var M4=/"/g;function kK(e,t,r,a,n,s,l,A){for(var u=!0,f=[],h="",g=xs(r),x=t.s.c;x<=t.e.c;++x)if(a[x]){var m=A.dense?(e[r]||[])[x]:e[a[x]+g];if(m==null)h="";else if(m.v!=null){u=!1,h=""+(A.rawNumbers&&m.t=="n"?m.v:zc(m,null,A));for(var w=0,v=0;w!==h.length;++w)if((v=h.charCodeAt(w))===n||v===s||v===34||A.forceQuotes){h='"'+h.replace(M4,'""')+'"';break}h=="ID"&&(h='"ID"')}else m.f!=null&&!m.F?(u=!1,h="="+m.f,h.indexOf(",")>=0&&(h='"'+h.replace(M4,'""')+'"')):h="";f.push(h)}return A.blankrows===!1&&u?null:f.join(l)}function ay(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var n=ka(e["!ref"]),s=a.FS!==void 0?a.FS:",",l=s.charCodeAt(0),A=a.RS!==void 0?a.RS:`
`,u=A.charCodeAt(0),f=new RegExp((s=="|"?"\\|":s)+"+$"),h="",g=[];a.dense=Array.isArray(e);for(var x=a.skipHidden&&e["!cols"]||[],m=a.skipHidden&&e["!rows"]||[],w=n.s.c;w<=n.e.c;++w)(x[w]||{}).hidden||(g[w]=Hn(w));for(var v=0,B=n.s.r;B<=n.e.r;++B)(m[B]||{}).hidden||(h=kK(e,n,B,g,l,u,s,a),h!=null&&(a.strip&&(h=h.replace(f,"")),(h||a.blankrows!==!1)&&r.push((v++?A:"")+h)));return delete a.dense,r.join("")}function hN(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=ay(e,t);return r}function CK(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var n=ka(e["!ref"]),s="",l=[],A,u=[],f=Array.isArray(e);for(A=n.s.c;A<=n.e.c;++A)l[A]=Hn(A);for(var h=n.s.r;h<=n.e.r;++h)for(s=xs(h),A=n.s.c;A<=n.e.c;++A)if(t=l[A]+s,r=f?(e[h]||[])[A]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}u[u.length]=t+"="+a}return u}function pN(e,t,r){var a=r||{},n=+!a.skipHeader,s=e||{},l=0,A=0;if(s&&a.origin!=null)if(typeof a.origin=="number")l=a.origin;else{var u=typeof a.origin=="string"?Pn(a.origin):a.origin;l=u.r,A=u.c}var f,h={s:{c:0,r:0},e:{c:A,r:l+t.length-1+n}};if(s["!ref"]){var g=ka(s["!ref"]);h.e.c=Math.max(h.e.c,g.e.c),h.e.r=Math.max(h.e.r,g.e.r),l==-1&&(l=g.e.r+1,h.e.r=l+t.length-1+n)}else l==-1&&(l=0,h.e.r=t.length-1+n);var x=a.header||[],m=0;t.forEach(function(v,B){as(v).forEach(function(k){(m=x.indexOf(k))==-1&&(x[m=x.length]=k);var N=v[k],S="z",O="",T=Ir({c:A+m,r:l+B+n});f=kp(s,T),N&&typeof N=="object"&&!(N instanceof Date)?s[T]=N:(typeof N=="number"?S="n":typeof N=="boolean"?S="b":typeof N=="string"?S="s":N instanceof Date?(S="d",a.cellDates||(S="n",N=zs(N)),O=a.dateNF||Lr[14]):N===null&&a.nullError&&(S="e",N=0),f?(f.t=S,f.v=N,delete f.w,delete f.R,O&&(f.z=O)):s[T]=f={t:S,v:N},O&&(f.z=O))})}),h.e.c=Math.max(h.e.c,A+x.length-1);var w=xs(l);if(n)for(m=0;m<x.length;++m)s[Hn(m+A)+w]={t:"s",v:x[m]};return s["!ref"]=Wr(h),s}function SK(e,t){return pN(null,e,t)}function kp(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=Pn(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?kp(e,Ir(t)):kp(e,Ir({r:t,c:r||0}))}function EK(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function ny(){return{SheetNames:[],Sheets:{}}}function sy(e,t,r,a){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);n=s&&+s[2]||0;var l=s&&s[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=l+n)!=-1;++n);}if(JE(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function NK(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=EK(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function FK(e,t){return e.z=t,e}function gN(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function TK(e,t,r){return gN(e,"#"+t,r)}function LK(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function UK(e,t,r,a){for(var n=typeof t!="string"?t:ka(t),s=typeof t=="string"?t:Wr(t),l=n.s.r;l<=n.e.r;++l)for(var A=n.s.c;A<=n.e.c;++A){var u=kp(e,l,A);u.t="n",u.F=s,delete u.v,l==n.s.r&&A==n.s.c&&(u.f=r,a&&(u.D=!0))}return e}var Jh={encode_col:Hn,encode_row:xs,encode_cell:Ir,encode_range:Wr,decode_col:j2,decode_row:U2,split_cell:Kj,decode_cell:Pn,decode_range:Rl,format_cell:zc,sheet_add_aoa:K3,sheet_add_json:pN,sheet_add_dom:iN,aoa_to_sheet:Sf,json_to_sheet:SK,table_to_sheet:lN,table_to_book:RP,sheet_to_csv:ay,sheet_to_txt:hN,sheet_to_json:mx,sheet_to_html:sN,sheet_to_formulae:CK,sheet_to_row_object_array:mx,sheet_get_cell:kp,book_new:ny,book_append_sheet:sy,book_set_sheet_visibility:NK,cell_set_number_format:FK,cell_set_hyperlink:gN,cell_set_internal_link:TK,cell_add_comment:LK,sheet_set_array_formula:UK,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const jK=(e,t,r="Sheet1")=>{const a=Jh.json_to_sheet(e),n=Jh.book_new();Jh.book_append_sheet(n,a,r);const s=t.endsWith(".xlsx")?t:`${t}.xlsx`;_K(n,s)},Ol=({isOpen:e,onClose:t,title:r,children:a,noScroll:n,variant:s="default"})=>(X.useEffect(()=>{const l=A=>{A.key==="Escape"&&t()};return e&&(document.body.style.overflow="hidden",window.addEventListener("keydown",l)),()=>{document.body.style.overflow="unset",window.removeEventListener("keydown",l)}},[e,t]),e?k0.createPortal(c.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[c.jsx("div",{className:"absolute inset-0 bg-slate-900/60 backdrop-blur-sm animate-in fade-in duration-200",onClick:t}),c.jsxs("div",{className:Hs("relative bg-white dark:bg-slate-800 border border-slate-200/80 dark:border-slate-700 shadow-2xl w-full max-h-[90vh] flex flex-col animate-in zoom-in-95 duration-200 z-10 overflow-hidden",s==="dialog"?"max-w-xl rounded-xl":"max-w-4xl rounded-2xl"),children:[c.jsxs("div",{className:Hs("flex items-center justify-between border-b border-slate-200 dark:border-slate-700 shrink-0",s==="dialog"?"px-4 py-3 bg-slate-50 dark:bg-slate-900/60":"p-6 bg-gradient-to-r from-slate-50 to-white dark:from-slate-800 dark:to-slate-800/90"),children:[c.jsx("h3",{className:Hs("text-slate-900 dark:text-white",s==="dialog"?"text-sm font-semibold":"text-xl font-bold"),children:r}),c.jsx("button",{onClick:t,className:Hs("text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500/60",s==="dialog"?"p-1 rounded-md hover:bg-slate-200/70 dark:hover:bg-slate-700":"p-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700"),children:c.jsx(nl,{className:Hs(s==="dialog"?"w-4 h-4":"w-5 h-5")})})]}),c.jsx("div",{className:Hs("flex-1 min-h-0 flex flex-col",!n&&"overflow-auto p-6"),children:a})]})]}),document.body):null),DK="modulepreload",IK=function(e){return"/litebistudio/"+e},H4={},iA=function(t,r,a){let n=Promise.resolve();if(r&&r.length>0){let u=function(f){return Promise.all(f.map(h=>Promise.resolve(h).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),A=l?.nonce||l?.getAttribute("nonce");n=u(r.map(f=>{if(f=IK(f),f in H4)return;H4[f]=!0;const h=f.endsWith(".css"),g=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${g}`))return;const x=document.createElement("link");if(x.rel=h?"stylesheet":DK,h||(x.as="script"),x.crossOrigin="",x.href=f,A&&x.setAttribute("nonce",A),document.head.appendChild(x),h)return new Promise((m,w)=>{x.addEventListener("load",m),x.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${f}`)))})}))}function s(l){const A=new Event("vite:preloadError",{cancelable:!0});if(A.payload=l,window.dispatchEvent(A),!A.defaultPrevented)throw l}return n.then(l=>{for(const A of l||[])A.status==="rejected"&&s(A.reason);return t().catch(s)})};function QK(e){return new Worker("/litebistudio/assets/db.worker-Bf6HykEJ.js",{name:e?.name})}let rc=null,xx=0;const Mu=fA("DB"),co=new Map,tf=new BroadcastChannel("litebistudio_db_v1"),bx=new Set;let mw=!1,YA=!1,wf=!1;const vx=sessionStorage.getItem("litebistudio_instance_id")||crypto.randomUUID();sessionStorage.setItem("litebistudio_instance_id",vx);function OK(e){return e instanceof Error?e.message:String(e)}function RK(e){return typeof e=="object"&&e!==null&&"sql"in e&&typeof e.sql=="string"}tf.onmessage=async e=>{if(e.data&&e.data.type==="PING")YA&&e.data.instanceId!==vx&&tf.postMessage({type:"MASTER_PONG",instanceId:e.data.instanceId});else if(e.data&&e.data.type==="MASTER_PONG")e.data.instanceId===vx&&MK();else if(e.data&&e.data.type==="RPC_REQ"&&YA){const{id:t,actionType:r,payload:a}=e.data;try{const n=await ol(r,a);tf.postMessage({type:"RPC_RES",id:t,result:n})}catch(n){tf.postMessage({type:"RPC_RES",id:t,error:OK(n)})}}else if(e.data&&e.data.type==="RPC_RES"&&!YA){const{id:t,result:r,error:a}=e.data;if(co.has(t)){const{resolve:n,reject:s}=co.get(t);co.delete(t),a?s(new Error(a)):n(r)}}};const mN=new AbortController;function iy(e=!1){wf=!0,sessionStorage.setItem("litebistudio_accepted_readonly","true"),bx.forEach(t=>t(!0,!0)),mN.abort(),e||(window.location.hash="#/")}function MK(){mw||(mw=!0,Mu.warn("Tab conflict detected! Access restricted to one tab."),sessionStorage.getItem("litebistudio_accepted_readonly")==="true"?iy(!0):bx.forEach(e=>e(!0,wf)))}function xN(e){return bx.add(e),mw&&e(!0,wf),()=>{bx.delete(e)}}tf.postMessage({type:"PING",instanceId:vx});let ev=null;function bN(){const e=new QK;return e.onmessage=t=>{const{id:r,result:a,error:n}=t.data;if(co.has(r)){const s=co.get(r);co.delete(r),n?s.reject(new Error(n)):s.resolve(a)}},e.postMessage({id:++xx,type:"SET_LOG_LEVEL",payload:{level:x2()}}),e}function HK(){return ev||(ev=new Promise(e=>{navigator.locks.request("litebistudio_db_lifecycle",{ifAvailable:!0},async t=>{if(!t){YA=!1,e();try{await navigator.locks.request("litebistudio_db_lifecycle",{signal:mN.signal},async()=>{Mu.info("Previous master tab closed. Reloading to take over..."),window.location.reload()})}catch(r){r instanceof DOMException&&r.name==="AbortError"||Mu.error("Background lock request failed:",r)}return}if(wf){YA=!1,e();return}YA=!0,rc=bN(),e(),await new Promise(()=>{})}).catch(t=>{t.name!=="AbortError"&&Mu.error("Failed to acquire DB lock:",t),YA=!1,e()})})),ev.then(()=>YA&&rc?rc:"SLAVE")}window.addEventListener("beforeunload",()=>{rc&&rc.postMessage({type:"CLOSE"})});function ol(e,t){const r=performance.now();window.dispatchEvent(new CustomEvent("db-query-start"));const a=()=>{const l=performance.now()-r;window.dispatchEvent(new CustomEvent("db-query-end",{detail:{duration:l}}))},n=()=>{if(wf){if(e==="EXEC"&&RK(t)){const l=t.sql.toUpperCase().trimStart();if(!l.startsWith("SELECT")&&!l.startsWith("PRAGMA"))return Promise.reject(new Error(`Action ${e} (WRITE) not permitted in Read-Only mode.`))}else if(e!=="INIT"&&e!=="GET_DIAGNOSTICS"&&e!=="GET_DATABASE_HEALTH"&&e!=="GET_STORAGE_STATUS"&&e!=="EXPORT")return Promise.reject(new Error(`Action ${e} not permitted in Read-Only mode.`))}return new Promise((l,A)=>{const u=++xx,f=setTimeout(()=>{co.has(u)&&(co.delete(u),Mu.error(`RPC Timeout for action: ${e} (Master tab unresponsive)`),A(new Error("Database Master unresponsive (Timeout after 5s). Please focus the first tab or refresh.")))},5e3);co.set(u,{actionType:e,resolve:h=>{clearTimeout(f),l(h)},reject:h=>{clearTimeout(f),A(h)}}),tf.postMessage({type:"RPC_REQ",id:u,actionType:e,payload:t})})};let s;return!YA&&wf?s=n():s=HK().then(l=>{if(l==="SLAVE")return n();const A=l;return new Promise((u,f)=>{const h=++xx;co.set(h,{actionType:e,resolve:g=>u(g),reject:f}),A.postMessage({id:h,type:e,payload:t})})}),s.finally(a)}function Oi(e=1,t="insert"){Mu.debug(`Dispatched db-changed event: type=${t}, count=${e}`),window.dispatchEvent(new CustomEvent("db-changed",{detail:{type:t,count:e}}))}async function PK(){if(!Array.from(co.values()).some(t=>t.actionType==="EXEC"))return!1;if(!YA||!rc)return Mu.warn("Abort requested without local DB master. Query cancel is only available in the active master tab."),!1;Mu.warn("Aborting active SQL execution by restarting DB worker.");for(const[t,r]of Array.from(co.entries()))co.delete(t),r.actionType==="EXEC"?r.reject(new Error("Query cancelled by user.")):r.reject(new Error("Operation interrupted by query cancellation."));return rc.terminate(),rc=bN(),!0}typeof window<"u"&&window.addEventListener("app-log-level-changed",()=>{rc&&rc.postMessage({id:++xx,type:"SET_LOG_LEVEL",payload:{level:x2()}})});function Po(){return ol("INIT").then(()=>{})}async function Kr(e,t){return await Po(),ol("EXEC",{sql:e,bind:t})}async function KK(){return await Po(),ol("CLEAR")}async function qK(){return await Po(),ol("FACTORY_RESET")}async function zK(e){return await Po(),ol("CLEAR_TABLE",{tableName:e})}async function VK(){return await Po(),ol("EXPORT")}async function GK(e){const t=await ol("IMPORT",e);return t&&t.isValid&&Oi(0,"restore"),t}async function WK(e){return await Po(),ol("LOAD_DEMO",e)}async function XK(){return await Po(),ol("EXPORT_DEMO_DATA")}async function YK(){return await Po(),ol("INIT_SCHEMA")}async function $K(){return await Po(),ol("GET_DIAGNOSTICS")}async function JK(){return await Po(),ol("GET_DATABASE_HEALTH")}async function ZK(){return await Po(),ol("GET_STORAGE_STATUS")}function eq(e,t){return ol("GENERIC_BULK_INSERT",{tableName:e,records:t})}const Tu=Object.freeze(Object.defineProperty({__proto__:null,abortActiveQueries:PK,clearDatabase:KK,clearTable:zK,exportDatabase:VK,exportDemoData:XK,factoryResetDatabase:qK,genericBulkInsert:eq,getDatabaseHealth:JK,getDiagnostics:$K,getStorageStatus:ZK,importDatabase:GK,initDB:Po,initSchema:YK,loadDemoData:WK,notifyDbChange:Oi,onTabConflict:xN,runQuery:Kr,setReadOnlyMode:iy},Symbol.toStringTag,{value:"Module"})),tv=new Map,Dt={async getDatabaseStats(){const e=await this.getTables();let t=0;for(const r of e){const a=await Kr(`SELECT count(*) as count FROM "${r}"`);t+=a[0]?.count||0}return{tables:e.length,records:t}},async getTotalRecordCount(){return(await this.getDatabaseStats()).records},async getDiagnostics(){return await iA(()=>Promise.resolve().then(()=>Tu),void 0).then(e=>e.getDiagnostics())},async getDatabaseHealth(){return await iA(()=>Promise.resolve().then(()=>Tu),void 0).then(e=>e.getDatabaseHealth())},async getStorageStatus(){return await iA(()=>Promise.resolve().then(()=>Tu),void 0).then(e=>e.getStorageStatus())},async getTables(){return(await Kr("SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%'")).map(t=>typeof t.name=="string"?t.name:"").filter(t=>t.length>0)},async getDataSources(){return(await Kr(`
            SELECT name, type
            FROM sqlite_master
            WHERE type IN ('table', 'view')
              AND name NOT LIKE 'sqlite_%'
            ORDER BY name ASC
        `)).map(t=>{const r=typeof t.name=="string"?t.name:"",a=t.type==="view"?"view":"table";return{name:r,type:a}}).filter(t=>t.name.length>0)},async getDataSourceType(e){if(!x0(e))return"unknown";const r=(await Kr("SELECT type FROM sqlite_master WHERE name = ? AND type IN ('table', 'view') LIMIT 1",[e]))[0]?.type;return r==="table"||r==="view"?r:"unknown"},async getTableSchema(e){if(!x0(e))return[];if(tv.has(e))return tv.get(e);const t=await Kr(`PRAGMA table_info("${e}")`);return tv.set(e,t),t},async getTableIndexes(e){if(!x0(e))return[];const t=e.replace(/"/g,'""'),r=await Kr(`PRAGMA index_list("${t}")`),a=await Kr("SELECT name, sql FROM sqlite_master WHERE type='index' AND LOWER(tbl_name) = LOWER(?) AND name NOT LIKE 'sqlite_%' ORDER BY name",[e]),n=new Map;for(const u of a){const f=typeof u.name=="string"?u.name:"";f&&n.set(f,typeof u.sql=="string"?u.sql:"")}const s=new Set;for(const u of r)typeof u.name=="string"&&u.name&&s.add(u.name);for(const u of a)typeof u.name=="string"&&u.name&&s.add(u.name);const l=Array.from(s);return l.length?(await Promise.all(l.map(async u=>{const f=u.replace(/"/g,'""'),g=(await Kr(`PRAGMA index_info("${f}")`)).sort((k,N)=>Number(k.seqno||0)-Number(N.seqno||0)).map(k=>typeof k.name=="string"?k.name:"").filter(k=>k.length>0),x=r.find(k=>k.name===u),m=n.get(u)||"",w=x?Number(x.unique||0)===1:!1,v=x?Number(x.partial||0)===1:!1,B=x&&typeof x.origin=="string"?x.origin:void 0;return{name:u,unique:w||/\bCREATE\s+UNIQUE\s+INDEX\b/i.test(m),columns:g,origin:B||"c",partial:v||/\bWHERE\b/i.test(m)}}))).sort((u,f)=>u.name.localeCompare(f.name)):[]},async inspectTable(e,t,r,a=0,n){if(!x0(e))throw new Error(`Invalid table name: ${e}`);const l=(n||await this.getDataSourceType(e))==="table";let A=l?`SELECT rowid as _rowid, * FROM "${e}"`:`SELECT * FROM "${e}"`;const u=[];if(r){const f=await this.getTableSchema(e),h=f.filter(g=>g.type.toUpperCase().includes("TEXT")||g.name.toLowerCase().includes("id")||g.name.toLowerCase().includes("name")).map(g=>`${g.name} LIKE '%' || ? || '%'`).join(" OR ");h&&(A+=` WHERE ${h}`,u.push(...Array(f.filter(g=>g.type.toUpperCase().includes("TEXT")||g.name.toLowerCase().includes("id")||g.name.toLowerCase().includes("name")).length).fill(r)))}return l&&(A+=" ORDER BY rowid DESC"),A+=" LIMIT ? OFFSET ?",u.push(t),u.push(Math.max(0,a)),await Kr(A,u)},async countTableRows(e,t){if(!x0(e))throw new Error(`Invalid table name: ${e}`);let r=`SELECT COUNT(*) as count FROM "${e}"`;const a=[];if(t){const l=(await this.getTableSchema(e)).filter(u=>u.type.toUpperCase().includes("TEXT")||u.name.toLowerCase().includes("id")||u.name.toLowerCase().includes("name")),A=l.map(u=>`${u.name} LIKE '%' || ? || '%'`).join(" OR ");A&&(r+=` WHERE ${A}`,a.push(...Array(l.length).fill(t)))}const n=await Kr(r,a);return Number(n[0]?.count||0)},async executeRaw(e,t){const r=await Kr(e,t),a=e.trim().toUpperCase();return(a.startsWith("INSERT")||a.startsWith("UPDATE")||a.startsWith("DELETE")||a.startsWith("DROP")||a.startsWith("CREATE")||a.startsWith("ALTER"))&&Oi(),r},async abortActiveQueries(){return await iA(()=>Promise.resolve().then(()=>Tu),void 0).then(e=>e.abortActiveQueries())},async bulkInsert(e,t){const{genericBulkInsert:r}=await iA(async()=>{const{genericBulkInsert:n}=await Promise.resolve().then(()=>Tu);return{genericBulkInsert:n}},void 0),a=await r(e,t);return Oi(a),a},async getUserWidgets(){return await Kr("SELECT * FROM sys_user_widgets ORDER BY created_at DESC")},async saveUserWidget(e){(await Kr("SELECT id FROM sys_user_widgets WHERE id = ?",[e.id])).length>0?await Kr("UPDATE sys_user_widgets SET name = ?, description = ?, sql_query = ?, visualization_config = ?, visual_builder_config = ?, updated_at = CURRENT_TIMESTAMP WHERE id = ?",[e.name,e.description,e.sql_query,JSON.stringify(e.visualization_config),JSON.stringify(e.visual_builder_config),e.id]):await Kr("INSERT INTO sys_user_widgets (id, name, description, sql_query, visualization_config, visual_builder_config) VALUES (?, ?, ?, ?, ?, ?)",[e.id,e.name,e.description,e.sql_query,JSON.stringify(e.visualization_config),JSON.stringify(e.visual_builder_config)]),Oi()},async deleteUserWidget(e){await Kr("DELETE FROM sys_user_widgets WHERE id = ?",[e]),Oi()},async getDashboards(){return(await Kr("SELECT * FROM sys_dashboards ORDER BY created_at ASC")).map(t=>({...t,layout:typeof t.layout=="string"?JSON.parse(t.layout):t.layout}))},async saveDashboard(e,t=!1){(await Kr("SELECT id FROM sys_dashboards WHERE id = ?",[e.id])).length>0?await Kr("UPDATE sys_dashboards SET name = ?, layout = ?, is_default = ?, updated_at = CURRENT_TIMESTAMP WHERE id = ?",[e.name,JSON.stringify(e.layout),e.is_default?1:0,e.id]):await Kr("INSERT INTO sys_dashboards (id, name, layout, is_default) VALUES (?, ?, ?, ?)",[e.id,e.name,JSON.stringify(e.layout),e.is_default?1:0]),t||Oi()},async deleteDashboard(e){await Kr("DELETE FROM sys_dashboards WHERE id = ?",[e]),Oi()},async getReportPacks(){return(await Kr("SELECT * FROM sys_report_packs ORDER BY created_at DESC")).map(t=>({...t,category:typeof t.category=="string"&&t.category.trim().length>0?t.category:"General",config:typeof t.config=="string"?JSON.parse(t.config):t.config}))},async saveReportPack(e){(await Kr("SELECT id FROM sys_report_packs WHERE id = ?",[e.id])).length>0?await Kr("UPDATE sys_report_packs SET name = ?, category = ?, description = ?, config = ?, updated_at = CURRENT_TIMESTAMP WHERE id = ?",[e.name,e.category||"General",e.description,JSON.stringify(e.config),e.id]):await Kr("INSERT INTO sys_report_packs (id, name, category, description, config) VALUES (?, ?, ?, ?, ?)",[e.id,e.name,e.category||"General",e.description,JSON.stringify(e.config)]),Oi()},async deleteReportPack(e){await Kr("DELETE FROM sys_report_packs WHERE id = ?",[e]),Oi()},async listSqlStatements(e="global"){return await Kr(`SELECT id, name, sql_text, description, scope, tags, is_favorite, use_count, last_used_at, created_at, updated_at
             FROM sys_sql_statement
             WHERE scope = ?
             ORDER BY is_favorite DESC, COALESCE(last_used_at, updated_at, created_at) DESC, name ASC`,[e])},async saveSqlStatement(e){const t=(e.scope||"global").trim()||"global";(await Kr("SELECT id FROM sys_sql_statement WHERE id = ?",[e.id])).length>0?await Kr(`UPDATE sys_sql_statement
                 SET name = ?, sql_text = ?, description = ?, scope = ?, tags = ?, is_favorite = ?, updated_at = CURRENT_TIMESTAMP
                 WHERE id = ?`,[e.name,e.sql_text,e.description||"",t,e.tags||"",e.is_favorite?1:0,e.id]):await Kr(`INSERT INTO sys_sql_statement (id, name, sql_text, description, scope, tags, is_favorite)
                 VALUES (?, ?, ?, ?, ?, ?, ?)`,[e.id,e.name,e.sql_text,e.description||"",t,e.tags||"",e.is_favorite?1:0]),Oi()},async deleteSqlStatement(e){await Kr("DELETE FROM sys_sql_statement WHERE id = ?",[e]),Oi()},async setSqlStatementFavorite(e,t){await Kr("UPDATE sys_sql_statement SET is_favorite = ?, updated_at = CURRENT_TIMESTAMP WHERE id = ?",[t?1:0,e]),Oi()},async markSqlStatementUsed(e){await Kr(`UPDATE sys_sql_statement
             SET use_count = COALESCE(use_count, 0) + 1,
                 last_used_at = CURRENT_TIMESTAMP
             WHERE id = ?`,[e]),Oi()},async getWorklist(){return await Kr("SELECT * FROM sys_worklist ORDER BY created_at DESC")},async updateWorklistItem(e,t){const r=[],a=[];if(t.status!==void 0&&(r.push("status = ?"),a.push(t.status)),t.comment!==void 0&&(r.push("comment = ?"),a.push(t.comment)),r.length===0)return;r.push("updated_at = CURRENT_TIMESTAMP"),a.push(Number(e));const n=`UPDATE sys_worklist SET ${r.join(", ")} WHERE id = ?`;await Kr(n,a),Oi()},async checkRecordExists(e,t){if(!x0(e))return!1;try{return(await Kr(`SELECT 1 FROM "${e}" WHERE id = ? LIMIT 1`,[t])).length>0}catch{try{const a=(await this.getTableSchema(e)).find(s=>s.pk===1||s.name.toLowerCase()==="id")?.name;return a&&a.toLowerCase()!=="id"?(await Kr(`SELECT 1 FROM "${e}" WHERE "${a}" = ? LIMIT 1`,[t])).length>0:(await Kr(`SELECT 1 FROM "${e}" WHERE rowid = ? LIMIT 1`,[t])).length>0}catch{return!1}}},async getRecordMetadata(e,t){if(!x0(e))return{exists:!1,isInWorklist:!1,worklistItem:null};if(t==null)return{exists:!1,isInWorklist:!1,worklistItem:null};const[r,a]=await Promise.all([Kr(`SELECT 1 FROM "${e}" WHERE id = ? LIMIT 1`,[t]).catch(async()=>{try{const s=(await this.getTableSchema(e)).find(l=>l.pk===1||l.name.toLowerCase()==="id")?.name;return s&&s.toLowerCase()!=="id"?await Kr(`SELECT 1 FROM "${e}" WHERE "${s}" = ? LIMIT 1`,[t]):await Kr(`SELECT 1 FROM "${e}" WHERE rowid = ? LIMIT 1`,[t])}catch{}return[]}),Kr("SELECT * FROM sys_worklist WHERE source_table = ? AND source_id = ?",[e,t]).catch(()=>[])]);return{exists:r.length>0,isInWorklist:a.length>0,worklistItem:a[0]||null}}};let Zh=null,P4=Promise.resolve();function tq(e){const t=P4.then(e,e);return P4=t.then(()=>{},()=>{}),t}function rq(e){return Zh=e,()=>{Zh===e&&(Zh=null)}}function aq(e){if(e.kind==="confirm")return{confirmed:window.confirm(e.message)};if(e.kind==="prompt"){const t=window.prompt(e.message,e.defaultValue||"");return{confirmed:t!==null,value:t??void 0}}return window.alert(e.message),{confirmed:!0}}async function wh(e){return Zh?tq(()=>Zh(e)):aq(e)}const Xt={async info(e,t){await wh({kind:"info",title:t,message:e})},async warning(e,t){await wh({kind:"warning",title:t,message:e})},async error(e,t){await wh({kind:"error",title:t,message:e})},async confirm(e,t){return(await wh({kind:"confirm",title:t,message:e})).confirmed},async prompt(e,t){const r=await wh({kind:"prompt",title:t?.title,message:e,defaultValue:t?.defaultValue,placeholder:t?.placeholder});return r.confirmed?r.value??"":null}},ly=({isOpen:e,onClose:t})=>{const{t:r}=tn(),[a,n]=X.useState("overview"),[s,l]=X.useState("health"),[A,u]=X.useState({}),[f,h]=X.useState(null),[g,x]=X.useState(null),[m,w]=X.useState(null),[v,B]=X.useState(null),{data:k,loading:N,refresh:S}=ri(()=>Dt.getDiagnostics(),[e]),{data:O,loading:T,refresh:U}=ri(async()=>e?await Dt.getDatabaseHealth():null,[e]),D="1.1.0",H="26.02.2026, 17:47",j=navigator;X.useEffect(()=>{e&&navigator.storage&&navigator.storage.estimate&&navigator.storage.estimate().then(G=>u(G))},[e]),X.useEffect(()=>{if(!e)return;const G=[];let Se=0;const we=(_e,je,J,ze,He)=>{G.push({severity:_e,code:je,title:J,details:ze,recommendation:He})};if(Se+=1,A.quota&&A.usage!==void 0){const _e=A.usage/A.quota,je=(_e*100).toFixed(2);_e>=.9?we("error","storage_quota_critical",r("widgets.system_health.client_storage_quota_critical"),`${je}%`):_e>=.75?we("warning","storage_quota_high",r("widgets.system_health.client_storage_quota_high"),`${je}%`):we("info","storage_quota_ok",r("widgets.system_health.client_storage_quota_ok"),`${je}%`)}else we("info","storage_quota_unknown",r("widgets.system_health.client_storage_quota_unknown"),r("widgets.system_health.no_storage_info"));Se+=1;const F=Object.keys(window.localStorage),R=F.reduce((_e,je)=>_e+(je.length+(window.localStorage.getItem(je)?.length||0))*2,0),M=F.slice(0,8).join(", ");R>4*1024*1024?we("warning","local_storage_large",r("widgets.system_health.client_local_storage_large"),`${(R/1024/1024).toFixed(2)} MB | ${F.length} keys`,M?`Keys: ${M}${F.length>8?" ...":""}`:void 0):we("info","local_storage_ok",r("widgets.system_health.client_local_storage_ok"),`${F.length} keys`,M?`Keys: ${M}${F.length>8?" ...":""}`:void 0),Se+=1;const P=Object.keys(window.sessionStorage),re=P.reduce((_e,je)=>_e+(je.length+(window.sessionStorage.getItem(je)?.length||0))*2,0),ge=P.slice(0,8).join(", ");re>1024*1024?we("warning","session_storage_large",r("widgets.system_health.client_session_storage_large"),`${(re/1024/1024).toFixed(2)} MB | ${P.length} keys`,ge?`Keys: ${ge}${P.length>8?" ...":""}`:void 0):we("info","session_storage_ok",r("widgets.system_health.client_session_storage_ok"),`${P.length} keys`,ge?`Keys: ${ge}${P.length>8?" ...":""}`:void 0),Se+=1,window.localStorage.getItem("notifications_confirm_destructive")==="false"?we("warning","destructive_confirm_off",r("widgets.system_health.client_destructive_confirm_off"),r("widgets.system_health.client_destructive_confirm_off_detail")):we("info","destructive_confirm_on",r("widgets.system_health.client_destructive_confirm_on"),r("widgets.system_health.client_destructive_confirm_on_detail")),Se+=1;const Ce=(window.localStorage.getItem("app_log_level")||"info").toLowerCase();Ce==="debug"?we("warning","log_level_debug",r("widgets.system_health.client_log_level_debug"),r("widgets.system_health.client_log_level_debug_detail")):we("info","log_level_ok",r("widgets.system_health.client_log_level_ok"),`Level: ${Ce}`),Se+=1;const de=window.localStorage.getItem("litebistudio_last_backup");de?we("info","backup_exists",r("widgets.system_health.client_backup_exists"),new Date(de).toLocaleString()):we("warning","backup_missing",r("widgets.system_health.client_backup_missing"),r("widgets.system_health.client_backup_missing_detail"));const be=G.filter(_e=>_e.severity==="error").length,Le=G.filter(_e=>_e.severity==="warning").length,ie=G.filter(_e=>_e.severity==="info").length;B({status:be>0?"error":Le>0?"warning":"ok",score:Math.max(0,100-be*25-Le*10-ie*1),checksRun:Se,findings:G})},[e,A,r]);const W=()=>{S(),U(),n("database"),l("health")},I=()=>{sessionStorage.setItem("litebistudio_datasource_tab","system"),window.location.hash="#/datasource"},Q=()=>{window.location.hash="#/inspector"},Y=G=>{if(!G)return"0 B";const Se=1024,we=["B","KB","MB","GB","TB"],F=Math.floor(Math.log(G)/Math.log(Se));return parseFloat((G/Math.pow(Se,F)).toFixed(2))+" "+we[F]},z=G=>G.replace(/"/g,'""'),ue=G=>{const Se=G.details||"";return G.code==="query_plan_full_scan_risk"?Array.from(Se.matchAll(/([a-zA-Z0-9_]+)\s+\(column:\s*([a-zA-Z0-9_]+)\)/g)).map(F=>({table:F[1],column:F[2]})):G.code==="large_unindexed_tables"?Array.from(Se.matchAll(/([a-zA-Z0-9_]+)\s+\(\d+\s+rows\)/g)).map(F=>({table:F[1]})):[]},Z=async G=>{const Se=ue(G),we=[];for(const F of Se){const R=F.table,M=await Dt.getTableSchema(R);if(!M.length)continue;const P=F.column&&M.some(ge=>ge.name===F.column)?F.column:M.find(ge=>Number(ge.pk||0)>0)?.name||M[0]?.name;if(!P)continue;const re=`idx_auto_${R}_${P}`.slice(0,60);we.push(`CREATE INDEX IF NOT EXISTS "${z(re)}" ON "${z(R)}"("${z(P)}")`)}return we},Ae=G=>G.code==="query_plan_full_scan_risk"||G.code==="large_unindexed_tables",ve=async(G,Se)=>{try{w(Se);const we=await Z(G);if(!we.length){await Xt.warning(r("widgets.system_health.quick_fix_none"));return}const F=we.slice(0,5).join(`;
`);if(!await Xt.confirm(`${r("widgets.system_health.quick_fix_confirm")}

${F}${we.length>5?`
...`:""}`))return;for(const M of we)await Dt.executeRaw(M);await Xt.info(r("widgets.system_health.quick_fix_success",{count:we.length})),S(),U()}catch(we){const F=we instanceof Error?we.message:String(we);await Xt.error(`${r("widgets.system_health.quick_fix_failed")} ${F}`)}finally{w(null)}};return c.jsx(Ol,{isOpen:e,onClose:t,title:r("widgets.system_health.title"),children:c.jsxs("div",{className:"h-[70vh] min-h-[520px] max-h-[760px] flex flex-col",children:[c.jsxs("div",{className:"flex border-b border-slate-200 dark:border-slate-700 mb-6 sticky top-0 bg-white dark:bg-slate-800 z-10 -mx-6 px-6 pt-2",children:[c.jsxs("button",{onClick:()=>n("overview"),className:`pb-3 px-4 text-sm font-medium transition-colors relative ${a==="overview"?"text-blue-600 dark:text-blue-400":"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"}`,children:[r("widgets.system_health.tab_overview"),a==="overview"&&c.jsx("div",{className:"absolute bottom-0 left-0 w-full h-0.5 bg-blue-600 dark:bg-blue-400 rounded-t-full"})]}),c.jsxs("button",{onClick:()=>n("storage"),className:`pb-3 px-4 text-sm font-medium transition-colors relative ${a==="storage"?"text-blue-600 dark:text-blue-400":"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"}`,children:[r("widgets.system_health.tab_storage"),a==="storage"&&c.jsx("div",{className:"absolute bottom-0 left-0 w-full h-0.5 bg-blue-600 dark:bg-blue-400 rounded-t-full"})]}),c.jsxs("button",{onClick:()=>n("database"),className:`pb-3 px-4 text-sm font-medium transition-colors relative ${a==="database"?"text-blue-600 dark:text-blue-400":"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"}`,children:[r("widgets.system_health.tab_database"),a==="database"&&c.jsx("div",{className:"absolute bottom-0 left-0 w-full h-0.5 bg-blue-600 dark:bg-blue-400 rounded-t-full"})]})]}),c.jsxs("div",{className:"flex-1 min-h-0 overflow-hidden",children:[a==="overview"&&c.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-bottom-2 duration-300",children:[c.jsxs("div",{className:"bg-slate-50 dark:bg-slate-900/50 p-4 rounded-xl border border-slate-100 dark:border-slate-800",children:[c.jsxs("h4",{className:"text-sm font-semibold text-slate-900 dark:text-white mb-3 flex items-center gap-2",children:[c.jsx(f2,{className:"w-4 h-4 text-indigo-500"}),r("widgets.system_health.app_environment")]}),c.jsxs("div",{className:"space-y-2 text-sm",children:[c.jsxs("div",{className:"flex justify-between border-b border-slate-200 dark:border-slate-700/50 pb-2",children:[c.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:r("widgets.system_health.version")}),c.jsx("span",{className:"font-mono font-medium text-slate-900 dark:text-white",children:D})]}),k?.schemaVersion!==void 0&&c.jsxs("div",{className:"flex justify-between border-b border-slate-200 dark:border-slate-700/50 pb-2",children:[c.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:"Database Schema"}),c.jsxs("span",{className:"font-mono font-bold text-blue-600 dark:text-blue-400",children:["V",k.schemaVersion]})]}),c.jsxs("div",{className:"flex justify-between border-b border-slate-200 dark:border-slate-700/50 pb-2",children:[c.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:r("widgets.system_health.build_date")}),c.jsx("span",{className:"font-mono font-medium text-slate-900 dark:text-white",children:H})]}),c.jsxs("div",{className:"flex justify-between border-b border-slate-200 dark:border-slate-700/50 pb-2",children:[c.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:r("widgets.system_health.environment")}),c.jsx("span",{className:"font-mono font-medium text-slate-900 dark:text-white uppercase text-xs bg-slate-200 dark:bg-slate-700 px-2 py-0.5 rounded",children:"production"})]}),c.jsxs("div",{className:"flex flex-col gap-1 pb-1",children:[c.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:r("widgets.system_health.user_agent")}),c.jsx("div",{className:"font-mono text-[10px] text-slate-500 dark:text-slate-400 break-all bg-slate-100 dark:bg-slate-900/50 p-2 rounded border border-slate-200 dark:border-slate-800/50",children:navigator.userAgent})]})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"p-4 rounded-xl bg-blue-50 dark:bg-blue-900/10 border border-blue-100 dark:border-blue-900/30",children:[c.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400 font-bold uppercase mb-1",children:r("widgets.system_health.cpu_cores")}),c.jsx("div",{className:"text-2xl font-black text-blue-700 dark:text-blue-300",children:navigator.hardwareConcurrency||"?"})]}),c.jsxs("div",{className:"p-4 rounded-xl bg-purple-50 dark:bg-purple-900/10 border border-purple-100 dark:border-purple-900/30",children:[c.jsx("div",{className:"text-xs text-purple-600 dark:text-purple-400 font-bold uppercase mb-1",children:r("widgets.system_health.device_memory")}),c.jsx("div",{className:"text-2xl font-black text-purple-700 dark:text-purple-300",title:r("widgets.system_health.memory_limit_hint"),children:j.deviceMemory?`${j.deviceMemory>=8?" ":"~"}${j.deviceMemory} GB`:"?"}),c.jsx("div",{className:"text-[9px] text-purple-400 dark:text-purple-500 mt-1 leading-tight",children:r("widgets.system_health.memory_limit_hint")})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[c.jsxs("div",{className:"rounded-xl border border-slate-200 dark:border-slate-700 p-3 bg-white dark:bg-slate-900",children:[c.jsx("div",{className:"text-[10px] uppercase tracking-wider font-bold text-slate-500",children:r("widgets.system_health.overview_db_health")}),c.jsx("div",{className:`mt-1 text-sm font-semibold ${O?.status==="error"?"text-red-600 dark:text-red-300":O?.status==="warning"?"text-amber-600 dark:text-amber-300":"text-emerald-600 dark:text-emerald-300"}`,children:r(O?`widgets.system_health.health_status_${O.status}`:"widgets.system_health.overview_not_available")}),O&&c.jsx("div",{className:"text-[11px] text-slate-500 dark:text-slate-400",children:r("widgets.system_health.health_score",{score:O.score})})]}),c.jsxs("div",{className:"rounded-xl border border-slate-200 dark:border-slate-700 p-3 bg-white dark:bg-slate-900",children:[c.jsx("div",{className:"text-[10px] uppercase tracking-wider font-bold text-slate-500",children:r("widgets.system_health.overview_storage_health")}),c.jsx("div",{className:`mt-1 text-sm font-semibold ${v?.status==="error"?"text-red-600 dark:text-red-300":v?.status==="warning"?"text-amber-600 dark:text-amber-300":"text-emerald-600 dark:text-emerald-300"}`,children:r(v?`widgets.system_health.health_status_${v.status}`:"widgets.system_health.overview_not_available")}),v&&c.jsx("div",{className:"text-[11px] text-slate-500 dark:text-slate-400",children:r("widgets.system_health.health_score",{score:v.score})})]}),c.jsxs("div",{className:"rounded-xl border border-slate-200 dark:border-slate-700 p-3 bg-white dark:bg-slate-900",children:[c.jsx("div",{className:"text-[10px] uppercase tracking-wider font-bold text-slate-500",children:r("widgets.system_health.overview_last_backup")}),c.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-800 dark:text-slate-200",children:window.localStorage.getItem("litebistudio_last_backup")?new Date(String(window.localStorage.getItem("litebistudio_last_backup"))).toLocaleString():r("widgets.system_health.overview_not_available")})]})]}),c.jsxs("div",{className:"rounded-xl border border-slate-200 dark:border-slate-700 p-3 bg-white dark:bg-slate-900",children:[c.jsx("div",{className:"text-[10px] uppercase tracking-wider font-bold text-slate-500 mb-2",children:r("widgets.system_health.overview_quick_actions")}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx("button",{onClick:W,className:"px-3 py-1.5 text-xs font-bold rounded border border-blue-300 text-blue-700 dark:border-blue-700 dark:text-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors",children:r("widgets.system_health.overview_action_run_health")}),c.jsx("button",{onClick:()=>n("storage"),className:"px-3 py-1.5 text-xs font-bold rounded border border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",children:r("widgets.system_health.overview_action_open_storage")}),c.jsx("button",{onClick:I,className:"px-3 py-1.5 text-xs font-bold rounded border border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",children:r("widgets.system_health.overview_action_backup")}),c.jsx("button",{onClick:Q,className:"px-3 py-1.5 text-xs font-bold rounded border border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",children:r("widgets.system_health.overview_action_inspector")})]})]})]}),a==="storage"&&c.jsx("div",{className:"h-full min-h-0 overflow-y-auto xl:overflow-hidden pr-1 xl:pr-0 animate-in fade-in slide-in-from-bottom-2 duration-300",children:c.jsxs("div",{className:"h-full min-h-0 grid grid-cols-1 xl:grid-cols-12 gap-4",children:[c.jsxs("div",{className:"xl:col-span-5 space-y-4",children:[c.jsxs("div",{className:"p-6 rounded-2xl bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-800 border border-slate-200 dark:border-slate-700 text-center",children:[c.jsx(BS,{className:"w-12 h-12 text-slate-400 mx-auto mb-4"}),A.quota?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-1",children:r("widgets.system_health.used_storage")}),c.jsx("div",{className:"text-3xl font-black text-slate-900 dark:text-white mb-4",children:Y(A.usage)}),c.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest mb-1",children:r("widgets.system_health.max_available")}),c.jsx("div",{className:"text-sm text-slate-600 dark:text-slate-300 mb-6 font-mono",children:Y(A.quota)}),c.jsx("div",{className:"relative h-2 bg-slate-100 dark:bg-slate-700 rounded-full overflow-hidden max-w-xs mx-auto mb-2",children:c.jsx("div",{className:"absolute top-0 left-0 h-full bg-blue-500 transition-all duration-1000",style:{width:`${Math.min(100,Math.max(1,(A.usage||0)/(A.quota||1)*100))}%`}})}),c.jsx("div",{className:"text-[10px] text-slate-400",children:r("widgets.system_health.quota_used",{percent:((A.usage||0)/(A.quota||1)*100).toFixed(6)})})]}):c.jsx("div",{className:"text-slate-500 italic",children:r("widgets.system_health.no_storage_info")})]}),c.jsxs("div",{className:"flex gap-4 p-4 bg-amber-50 dark:bg-amber-900/10 border border-amber-100 dark:border-amber-900/30 rounded-xl",children:[c.jsx(qc,{className:"w-5 h-5 text-amber-600 dark:text-amber-400 shrink-0 mt-0.5"}),c.jsxs("div",{className:"text-xs text-amber-800 dark:text-amber-300",children:[c.jsx("p",{className:"font-bold mb-1",children:r("widgets.system_health.opfs_title")}),c.jsx("p",{children:r("widgets.system_health.opfs_description")})]})]})]}),v&&c.jsx("div",{className:"xl:col-span-7 min-h-0",children:c.jsxs("div",{className:"h-full min-h-0 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl overflow-hidden flex flex-col",children:[c.jsx("div",{className:"bg-slate-50 dark:bg-slate-800/50 px-4 py-2 border-b border-slate-200 dark:border-slate-700 text-xs font-bold text-slate-500 uppercase tracking-wider",children:r("widgets.system_health.client_health_title")}),c.jsxs("div",{className:"p-4 space-y-3 flex-1 min-h-0 flex flex-col",children:[c.jsxs("div",{className:"flex items-center justify-between gap-2",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[v.status==="ok"&&c.jsx(Eb,{className:"w-4 h-4 text-emerald-600 dark:text-emerald-400"}),v.status==="warning"&&c.jsx(Ou,{className:"w-4 h-4 text-amber-600 dark:text-amber-400"}),v.status==="error"&&c.jsx($v,{className:"w-4 h-4 text-red-600 dark:text-red-400"}),c.jsx("span",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:r(`widgets.system_health.health_status_${v.status}`)})]}),c.jsx("div",{className:"text-xs font-mono text-slate-500 dark:text-slate-400",children:r("widgets.system_health.health_score",{score:v.score})})]}),c.jsx("div",{className:"text-[11px] text-slate-500 dark:text-slate-400",children:r("widgets.system_health.client_health_meta",{checks:v.checksRun})}),c.jsx("div",{className:"space-y-2 flex-1 min-h-0 overflow-auto pr-1",children:v.findings.map((G,Se)=>{const we=`client-${G.code}-${Se}`,F=!!(G.recommendation&&G.recommendation.trim().length>0);return c.jsxs("div",{className:`rounded-lg border px-3 py-2 ${G.severity==="error"?"border-red-200 bg-red-50 dark:border-red-900/40 dark:bg-red-900/10":G.severity==="warning"?"border-amber-200 bg-amber-50 dark:border-amber-900/40 dark:bg-amber-900/10":"border-slate-200 bg-slate-50 dark:border-slate-700 dark:bg-slate-800/30"}`,children:[c.jsxs("div",{className:"flex items-center justify-between gap-2",children:[c.jsx("span",{className:"text-xs font-semibold text-slate-900 dark:text-white",children:G.title}),c.jsx("span",{className:`text-[10px] uppercase font-bold ${G.severity==="error"?"text-red-700 dark:text-red-300":G.severity==="warning"?"text-amber-700 dark:text-amber-300":"text-slate-500 dark:text-slate-400"}`,children:r(`widgets.system_health.severity_${G.severity}`)})]}),c.jsx("div",{className:"text-[11px] text-slate-600 dark:text-slate-300 mt-1",children:G.details}),c.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:c.jsx("button",{disabled:!F,onClick:()=>x(R=>R===we?null:we),className:`px-2 py-1 text-[10px] font-bold rounded border transition-colors ${F?"border-slate-300 dark:border-slate-600 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700":"border-slate-200 dark:border-slate-700 text-slate-400 dark:text-slate-500 bg-slate-100/60 dark:bg-slate-800/60 cursor-not-allowed"}`,children:r(g===we?"widgets.system_health.hide_details":"widgets.system_health.show_details")})}),g===we&&G.recommendation&&c.jsxs("div",{className:"text-[11px] text-slate-500 dark:text-slate-400 mt-1",children:[r("widgets.system_health.recommendation_prefix")," ",G.recommendation]})]},we)})})]})]})})]})}),a==="database"&&c.jsx("div",{className:"h-full min-h-0 flex flex-col space-y-4 animate-in fade-in slide-in-from-bottom-2 duration-300",children:N||T?c.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center py-12 text-slate-400",children:[c.jsx($5,{className:"w-8 h-8 animate-spin mb-2"}),c.jsx("p",{children:r("widgets.system_health.analyzing_db")})]}):k?c.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"bg-emerald-50 dark:bg-emerald-900/10 p-4 rounded-xl border border-emerald-100 dark:border-emerald-900/30",children:[c.jsx("div",{className:"text-xs text-emerald-600 dark:text-emerald-400 font-bold uppercase mb-1",children:r("widgets.system_health.db_size")}),c.jsx("div",{className:"text-2xl font-black text-emerald-700 dark:text-emerald-300",children:Y(k.dbSize)}),c.jsxs("div",{className:"text-[10px] text-emerald-600/70 mt-1 font-mono",children:[k.pageCount," Pages @ ",k.pageSize," Bytes"]})]}),c.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-4 rounded-xl border border-slate-100 dark:border-slate-700 flex flex-col justify-center items-center text-center",children:[c.jsxs("div",{className:"flex items-center gap-2 text-green-600 dark:text-green-400 mb-1",children:[c.jsx(Eb,{className:"w-5 h-5"}),c.jsx("span",{className:"font-bold",children:r("widgets.system_health.connected")})]}),c.jsx("div",{className:"text-xs text-slate-400",children:r("widgets.system_health.worker_active")})]})]}),c.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl overflow-hidden flex-1 min-h-0 flex flex-col",children:[c.jsx("div",{className:"bg-slate-50 dark:bg-slate-800/50 px-3 py-2 border-b border-slate-200 dark:border-slate-700",children:c.jsxs("div",{className:"inline-flex rounded-lg border border-slate-200 dark:border-slate-700 overflow-hidden",children:[c.jsx("button",{onClick:()=>l("health"),className:`px-3 py-1.5 text-xs font-bold transition-colors ${s==="health"?"bg-blue-600 text-white":"bg-white dark:bg-slate-900 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800"}`,children:r("widgets.system_health.health_check_title")}),c.jsx("button",{onClick:()=>l("stats"),className:`px-3 py-1.5 text-xs font-bold transition-colors ${s==="stats"?"bg-blue-600 text-white":"bg-white dark:bg-slate-900 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800"}`,children:r("widgets.system_health.table_stats")})]})}),s==="health"&&O&&c.jsxs("div",{className:"p-4 space-y-3 flex-1 min-h-0 flex flex-col",children:[c.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[O.status==="ok"&&c.jsx(Eb,{className:"w-4 h-4 text-emerald-600 dark:text-emerald-400"}),O.status==="warning"&&c.jsx(Ou,{className:"w-4 h-4 text-amber-600 dark:text-amber-400"}),O.status==="error"&&c.jsx($v,{className:"w-4 h-4 text-red-600 dark:text-red-400"}),c.jsx("span",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:r(`widgets.system_health.health_status_${O.status}`)})]}),c.jsx("div",{className:"text-xs font-mono text-slate-500 dark:text-slate-400",children:r("widgets.system_health.health_score",{score:O.score})})]}),c.jsx("div",{className:"text-[11px] text-slate-500 dark:text-slate-400",children:r("widgets.system_health.health_meta",{checks:O.checksRun,timestamp:new Date(O.checkedAt).toLocaleString()})}),c.jsx("div",{className:"space-y-2 flex-1 min-h-0 overflow-auto pr-1",children:O.findings.map((G,Se)=>{const we=`${G.code}-${Se}`,F=!!(G.recommendation&&G.recommendation.trim().length>0);return c.jsxs("div",{className:`rounded-lg border px-3 py-2 ${G.severity==="error"?"border-red-200 bg-red-50 dark:border-red-900/40 dark:bg-red-900/10":G.severity==="warning"?"border-amber-200 bg-amber-50 dark:border-amber-900/40 dark:bg-amber-900/10":"border-slate-200 bg-slate-50 dark:border-slate-700 dark:bg-slate-800/30"}`,children:[c.jsxs("div",{className:"flex items-center justify-between gap-2",children:[c.jsx("span",{className:"text-xs font-semibold text-slate-900 dark:text-white",children:G.title}),c.jsx("span",{className:`text-[10px] uppercase font-bold ${G.severity==="error"?"text-red-700 dark:text-red-300":G.severity==="warning"?"text-amber-700 dark:text-amber-300":"text-slate-500 dark:text-slate-400"}`,children:r(`widgets.system_health.severity_${G.severity}`)})]}),c.jsx("div",{className:"text-[11px] text-slate-600 dark:text-slate-300 mt-1",children:G.details}),c.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[c.jsx("button",{disabled:!F,onClick:()=>h(R=>R===we?null:we),className:`px-2 py-1 text-[10px] font-bold rounded border transition-colors ${F?"border-slate-300 dark:border-slate-600 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700":"border-slate-200 dark:border-slate-700 text-slate-400 dark:text-slate-500 bg-slate-100/60 dark:bg-slate-800/60 cursor-not-allowed"}`,children:r(f===we?"widgets.system_health.hide_details":"widgets.system_health.show_details")}),Ae(G)&&c.jsxs("button",{disabled:m===we,onClick:()=>ve(G,we),className:"inline-flex items-center gap-1 px-2 py-1 text-[10px] font-bold rounded border border-blue-300 text-blue-700 dark:border-blue-700 dark:text-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[c.jsx(g8,{className:"w-3 h-3"}),r(m===we?"widgets.system_health.quick_fix_running":"widgets.system_health.quick_fix")]})]}),f===we&&G.recommendation&&c.jsxs("div",{className:"text-[11px] text-slate-500 dark:text-slate-400 mt-2",children:[r("widgets.system_health.recommendation_prefix")," ",G.recommendation]})]},we)})})]}),s==="stats"&&c.jsxs("div",{className:"divide-y divide-slate-100 dark:divide-slate-800 flex-1 min-h-0 overflow-auto",children:[Object.entries(k.tableStats||{}).filter(([G])=>!G.startsWith("sys_")&&!G.startsWith("sqlite_")).length>0&&c.jsx("div",{className:"bg-blue-50/30 dark:bg-blue-900/10 px-4 py-1.5 text-[10px] font-bold text-blue-600 dark:text-blue-400 uppercase tracking-tight",children:r("widgets.system_health.user_tables")}),Object.entries(k.tableStats||{}).filter(([G])=>!G.startsWith("sys_")&&!G.startsWith("sqlite_")).map(([G,Se])=>c.jsxs("div",{className:"flex justify-between px-4 py-3 text-sm hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors",children:[c.jsx("span",{className:"font-mono text-slate-700 dark:text-slate-200",children:G}),c.jsx("span",{className:"font-bold text-slate-900 dark:text-white",children:Se.toLocaleString()})]},G)),c.jsx("div",{className:"bg-slate-100 dark:bg-slate-800/80 px-4 py-1.5 text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-tight",children:r("widgets.system_health.system_tables")}),Object.entries(k.tableStats||{}).filter(([G])=>G.startsWith("sys_")||G.startsWith("sqlite_")).map(([G,Se])=>c.jsxs("div",{className:"flex justify-between px-4 py-3 text-sm opacity-70 hover:opacity-100 transition-opacity",children:[c.jsx("span",{className:"font-mono text-slate-500 dark:text-slate-400 text-xs",children:G}),c.jsx("span",{className:"font-medium text-slate-700 dark:text-slate-300",children:Se.toLocaleString()})]},G))]})]}),c.jsx("div",{className:"flex justify-end pt-2",children:c.jsxs("button",{onClick:()=>{S(),U()},className:"flex items-center gap-2 px-4 py-2 bg-slate-100 dark:bg-slate-800 hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300 rounded-lg text-xs font-bold transition-colors",children:[c.jsx($5,{className:"w-3.5 h-3.5"}),r("widgets.system_health.refresh_diag")]})})]}):c.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center py-12 text-red-400",children:[c.jsx(Ou,{className:"w-8 h-8 mb-2"}),c.jsx("p",{children:r("widgets.system_health.diag_failed")}),c.jsx("button",{onClick:S,className:"mt-4 text-blue-500 underline text-sm",children:r("widgets.system_health.retry")})]})})]})]})})},nq=({isCollapsed:e})=>{const{t}=tn(),[r,a]=X.useState(!1);return c.jsxs(c.Fragment,{children:[c.jsxs("button",{onClick:()=>a(!0),className:`w-full flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-md transition-all text-slate-700 hover:bg-slate-100 dark:text-slate-200 dark:hover:bg-slate-800 ${e?"md:justify-center md:px-0":""}`,title:e?t("sidebar.system_status"):"",children:[c.jsx(Ru,{className:"w-5 h-5 flex-shrink-0 text-blue-500"}),c.jsx("span",{className:`transition-all duration-300 ${e?"md:opacity-0 md:w-0 overflow-hidden":"opacity-100"}`,children:t("sidebar.system_status")})]}),c.jsx(ly,{isOpen:r,onClose:()=>a(!1)})]})},sq=({isCollapsed:e,sidebarOpen:t,onToggleCollapse:r,onCloseMobile:a,isReadOnly:n})=>{const{t:s,i18n:l}=tn(),{visibleSidebarComponentIds:A,lockApp:u}=Mo(),[f,h]=ar.useState(!!localStorage.getItem("litebistudio_app_pin")),[g,x]=hr("ui_sidebar_show_language_switch",!0),[m,w]=hr("ui_sidebar_show_system_status",!0);ar.useEffect(()=>{const U=()=>{h(!!localStorage.getItem("litebistudio_app_pin"))};return window.addEventListener("pin-changed",U),()=>window.removeEventListener("pin-changed",U)},[]),ar.useEffect(()=>{const U=D=>{const H=D;typeof H.detail?.visible=="boolean"&&x(H.detail.visible)};return window.addEventListener("sidebar-language-visibility-changed",U),()=>window.removeEventListener("sidebar-language-visibility-changed",U)},[x]),ar.useEffect(()=>{const U=D=>{const H=D;typeof H.detail?.visible=="boolean"&&w(H.detail.visible)};return window.addEventListener("sidebar-system-status-visibility-changed",U),()=>window.removeEventListener("sidebar-system-status-visibility-changed",U)},[w]);const v=()=>{const U=l.language.startsWith("de")?"en":"de";l.changeLanguage(U)},B={ItCostsComponent:c.jsx(b8,{className:"w-5 h-5 flex-shrink-0 text-emerald-500"}),SystemsComponent:c.jsx(x8,{className:"w-5 h-5 flex-shrink-0 text-blue-500"}),AnomalyRadarComponent:c.jsx(m8,{className:"w-5 h-5 flex-shrink-0 text-rose-500"}),WorklistComponent:c.jsx(nf,{className:"w-5 h-5 flex-shrink-0 text-amber-500"}),DataInspectorComponent:c.jsx(fo,{className:"w-5 h-5 flex-shrink-0 text-indigo-500"})},k=[{to:"/",icon:c.jsx(J5,{className:"w-5 h-5 flex-shrink-0"}),label:s("sidebar.dashboard")}],N=Fu.filter(U=>U.targetView&&A.includes(U.id)).map(U=>({to:U.targetView,icon:B[U.component]||c.jsx(J5,{className:"w-5 h-5 flex-shrink-0"}),label:s(`sidebar.${U.id.replace(/-/g,"_")}`,U.title)})),S=[{to:"/datasource",icon:c.jsx(_i,{className:"w-5 h-5 flex-shrink-0"}),label:s("sidebar.datasource")},{to:"/query",icon:c.jsx(Zd,{className:"w-5 h-5 flex-shrink-0"}),label:s("sidebar.query_builder")},{to:"/reports",icon:c.jsx(Hh,{className:"w-5 h-5 flex-shrink-0"}),label:s("sidebar.reports")},{to:"/about",icon:c.jsx(qc,{className:"w-5 h-5 flex-shrink-0"}),label:s("sidebar.about")}],O={"/":0,"/datasource":1,"/inspector":2,"/query":3,"/reports":4,"/worklist":5,"/settings":6,"/about":7},T=[...k,...N,...S].sort((U,D)=>{const H=O[U.to]??100,j=O[D.to]??100;return H!==j?H-j:U.label.localeCompare(D.label)});return c.jsxs("aside",{className:`
            fixed inset-y-0 left-0 z-50 bg-white dark:bg-slate-800 border-r border-slate-300 dark:border-slate-700 transform transition-all duration-300 ease-in-out
            ${e?"md:w-20":"md:w-64"}
            ${t?"translate-x-0 w-64":"-translate-x-full md:translate-x-0"}
        `,children:[c.jsxs("div",{className:`p-6 border-b border-slate-300 dark:border-slate-700 flex items-center justify-between ${e?"md:p-4 md:justify-center":""}`,children:[c.jsxs("div",{className:"flex items-center gap-2.5 overflow-hidden",children:[c.jsx("div",{className:"flex-shrink-0 p-1.5 bg-blue-600 rounded-lg shadow-lg shadow-blue-200 dark:shadow-none",children:c.jsx(kS,{className:"w-5 h-5 text-white"})}),c.jsxs("div",{className:`transition-all duration-300 ${e?"md:opacity-0 md:w-0":"opacity-100 flex flex-col"}`,children:[c.jsxs("h1",{className:"text-lg font-extrabold tracking-tight text-slate-900 dark:text-white leading-tight whitespace-nowrap",children:["LiteBI ",c.jsx("span",{className:"text-blue-600",children:"Studio"})]}),c.jsx("p",{className:"text-[10px] font-medium text-slate-400 uppercase tracking-widest whitespace-nowrap",children:s("sidebar.analytics_platform")})]})]}),c.jsx("button",{onClick:a,className:"md:hidden p-1 text-slate-500 hover:text-slate-700",children:c.jsx(CS,{className:"w-6 h-6"})}),c.jsx("button",{onClick:r,className:"hidden md:flex absolute -right-3 top-1/2 -translate-y-1/2 w-6 h-6 bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-700 rounded-full items-center justify-center shadow-md hover:text-blue-600 transition-colors z-50",children:e?c.jsx(Ul,{className:"w-4 h-4"}):c.jsx(SS,{className:"w-4 h-4"})})]}),c.jsxs("div",{className:"flex flex-col h-[calc(100%-80px)] justify-between",children:[c.jsxs("div",{children:[n&&c.jsxs("div",{className:`bg-amber-50 dark:bg-amber-900/20 border-b border-amber-200 dark:border-amber-800/50 px-4 py-3 flex items-start gap-3 text-amber-800 dark:text-amber-400 overflow-hidden ${e?"md:px-0 md:justify-center":""}`,children:[c.jsx(qc,{className:"w-5 h-5 flex-shrink-0"}),c.jsxs("div",{className:`text-xs transition-all duration-300 ${e?"md:opacity-0 md:w-0":"opacity-100"}`,children:[c.jsx("span",{className:"font-semibold block text-sm",children:"Lese-Modus"}),"Schreibschutz aktiv (2. Tab)"]})]}),c.jsx("nav",{className:"p-4 space-y-1",children:T.map(({to:U,icon:D,label:H})=>c.jsxs(Y5,{to:U,end:U==="/",onClick:a,className:({isActive:j})=>`w-full flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-md transition-all ${e?"md:justify-center md:px-0":""} ${j?"bg-blue-50 text-blue-700 dark:bg-blue-900/20 dark:text-blue-200":"text-slate-700 hover:bg-slate-100 dark:text-slate-200 dark:hover:bg-slate-800"}`,title:e?H:"",children:[D,c.jsx("span",{className:`transition-all duration-300 ${e?"md:opacity-0 md:w-0 overflow-hidden":"opacity-100"}`,children:H})]},`${H}-${U}`))})]}),c.jsxs("div",{className:`p-4 border-t border-slate-300 dark:border-slate-700 transition-all space-y-1 ${e?"md:p-2 md:py-4":""}`,children:[g&&c.jsxs("button",{onClick:v,className:`w-full flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-md text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 transition-all ${e?"md:justify-center md:px-0":""}`,title:l.language.startsWith("de")?"Switch to English":"Auf Deutsch umstellen",children:[c.jsx(Xm,{className:"w-5 h-5 flex-shrink-0"}),c.jsx("span",{className:`transition-all duration-300 ${e?"md:opacity-0 md:w-0 overflow-hidden":"opacity-100"}`,children:l.language.startsWith("de")?"English":"Deutsch"})]}),c.jsxs(Y5,{to:"/settings",onClick:a,className:({isActive:U})=>`w-full flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-md transition-all ${e?"md:justify-center md:px-0":""} ${U?"bg-blue-50 text-blue-700 dark:bg-blue-900/20 dark:text-blue-200":"text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800"}`,title:e?s("sidebar.settings"):"",children:[c.jsx(cp,{className:"w-5 h-5 flex-shrink-0"}),c.jsx("span",{className:`transition-all duration-300 ${e?"md:opacity-0 md:w-0 overflow-hidden":"opacity-100"}`,children:s("sidebar.settings")})]}),f&&c.jsxs("button",{onClick:u,className:`w-full flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-md text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 transition-all ${e?"md:justify-center md:px-0":""}`,title:l.language.startsWith("de")?"Lock screen":"Sperrbildschirm aktivieren",children:[c.jsx(E0,{className:"w-5 h-5 flex-shrink-0"}),c.jsx("span",{className:`transition-all duration-300 ${e?"md:opacity-0 md:w-0 overflow-hidden":"opacity-100"}`,children:l.language.startsWith("de")?"Lock":"Sperren"})]}),m&&c.jsx(nq,{isCollapsed:e})]})]})]})},iq=()=>c.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-slate-900/80 backdrop-blur-sm animate-in fade-in duration-300",children:c.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-3xl shadow-2xl border border-slate-200 dark:border-slate-700 max-w-md w-full overflow-hidden animate-in zoom-in-95 duration-300",children:[c.jsxs("div",{className:"p-8",children:[c.jsx("div",{className:"flex items-center justify-center w-16 h-16 bg-amber-100 dark:bg-amber-900/30 rounded-2xl mb-6 mx-auto",children:c.jsx(Ou,{className:"w-8 h-8 text-amber-600 dark:text-amber-500"})}),c.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white text-center mb-3",children:"Zweite Instanz erkannt"}),c.jsxs("p",{className:"text-slate-600 dark:text-slate-400 text-center mb-8 leading-relaxed",children:["LiteBI Studio ist bereits in einem anderen Tab geffnet. Um Datenverlust zu vermeiden, ist der Zugriff auf ",c.jsx("span",{className:"font-semibold text-slate-900 dark:text-white",children:"einen aktiven Tab"})," beschrnkt."]}),c.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800/50 rounded-2xl p-4 flex gap-3 items-start mb-6",children:[c.jsx($v,{className:"w-5 h-5 text-amber-600 dark:text-amber-500 mt-0.5 shrink-0"}),c.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-400",children:"Bitte schlieen Sie diesen Tab manuell und nutzen Sie die bereits geffnete Instanz."})]}),c.jsxs("button",{onClick:()=>iy(),className:"w-full flex items-center justify-center gap-2 py-3 px-4 bg-slate-900 hover:bg-slate-800 dark:bg-white dark:hover:bg-slate-100 text-white dark:text-slate-900 font-medium rounded-xl transition-colors mb-2",children:[c.jsx(v8,{className:"w-5 h-5 flex-shrink-0"}),"Weiter im Lese-Modus"]})]}),c.jsx("div",{className:"bg-slate-50 dark:bg-slate-900/50 p-4 border-t border-slate-100 dark:border-slate-800 flex justify-center",children:c.jsxs("a",{href:"https://github.com/hrmnns/litebistudio/blob/48f73003fb415174711f4e77baaf1433637d76ff/docs/Single-Instance-Policy.md",target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-500 hover:text-blue-600 flex items-center gap-1 transition-colors",children:["Warum ist das so? ",c.jsx(Nu,{className:"w-3 h-3"})]})})]})});function lq(e=16){const t=new Uint8Array(e);return crypto.getRandomValues(t),Array.from(t).map(r=>r.toString(16).padStart(2,"0")).join("")}async function vN(e,t){const a=new TextEncoder().encode(t?t+e:e),n=await crypto.subtle.digest("SHA-256",a);return Array.from(new Uint8Array(n)).map(l=>l.toString(16).padStart(2,"0")).join("")}async function wN(e){const t=new TextEncoder;return crypto.subtle.importKey("raw",t.encode(e),{name:"PBKDF2"},!1,["deriveBits","deriveKey"])}async function yN(e,t){return crypto.subtle.deriveKey({name:"PBKDF2",salt:t,iterations:1e5,hash:"SHA-256"},e,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"])}async function oq(e,t){const r=crypto.getRandomValues(new Uint8Array(16)),a=crypto.getRandomValues(new Uint8Array(12)),n=await wN(t),s=await yN(n,new Uint8Array(r).buffer),l=await crypto.subtle.encrypt({name:"AES-GCM",iv:a},s,e),A=new Uint8Array(r.byteLength+a.byteLength+l.byteLength);return A.set(r,0),A.set(a,r.byteLength),A.set(new Uint8Array(l),r.byteLength+a.byteLength),A.buffer}async function Aq(e,t){const r=e instanceof Uint8Array?e:new Uint8Array(e),a=r.slice(0,16),n=r.slice(16,28),s=r.slice(28),l=await wN(t),A=await yN(l,new Uint8Array(a).buffer);return crypto.subtle.decrypt({name:"AES-GCM",iv:n},A,s)}const cq=()=>{const{isLocked:e,unlockApp:t}=Mo(),[r,a]=X.useState(""),[n,s]=X.useState(""),[l,A]=X.useState(!1);if(!e)return null;const u=async f=>{f&&f.preventDefault();const h=localStorage.getItem("litebistudio_app_pin"),g=localStorage.getItem("litebistudio_app_pin_salt")||"";if(!h){t();return}await vN(r,g)===h?(t(),a(""),s("")):(s("Falsche PIN"),A(!0),setTimeout(()=>A(!1),500),a(""))};return c.jsxs("div",{className:"fixed inset-0 z-[100] bg-slate-900/95 backdrop-blur-sm flex items-center justify-center p-4",children:[c.jsxs("div",{className:`w-full max-w-sm bg-slate-800 border border-slate-700 rounded-2xl shadow-2xl p-8 flex flex-col items-center gap-6 ${l?"animate-shake":""}`,children:[c.jsx("div",{className:"p-4 bg-slate-700/50 rounded-full ring-4 ring-slate-800",children:c.jsx(E0,{className:"w-8 h-8 text-blue-500"})}),c.jsxs("div",{className:"text-center space-y-2",children:[c.jsx("h2",{className:"text-2xl font-bold text-white",children:"System gesperrt"}),c.jsx("p",{className:"text-slate-400",children:"Bitte geben Sie Ihre PIN ein, um fortzufahren."})]}),c.jsxs("form",{onSubmit:u,className:"w-full space-y-4",children:[c.jsx("div",{className:"relative",children:c.jsx("input",{type:"password",inputMode:"numeric",pattern:"[0-9]*",autoFocus:!0,maxLength:6,value:r,onChange:f=>{s(""),a(f.target.value)},className:"w-full bg-slate-900 border border-slate-700 text-white text-center text-3xl tracking-[1em] py-4 rounded-xl focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 placeholder:tracking-normal font-mono",placeholder:""})}),n&&c.jsxs("div",{className:"flex items-center justify-center gap-2 text-red-400 text-sm animate-fade-in",children:[c.jsx(il,{className:"w-4 h-4"}),n]}),c.jsxs("button",{type:"submit",disabled:r.length<4,className:"w-full py-3 bg-blue-600 hover:bg-blue-500 active:bg-blue-700 text-white font-semibold rounded-xl transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[c.jsx(ES,{className:"w-4 h-4"}),"Entsperren"]})]}),c.jsx("div",{className:"text-xs text-slate-500 mt-4",children:"LiteBI Studio Protected"})]}),c.jsx("style",{children:`
                @keyframes shake {
                    0%, 100% { transform: translateX(0); }
                    25% { transform: translateX(-5px); }
                    75% { transform: translateX(5px); }
                }
                .animate-shake {
                    animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
                }
            `})]})},uq=()=>{const[e,t]=X.useState(!1),[r,a]=X.useState(!1),{isSidebarCollapsed:n,setSidebarCollapsed:s,isPresentationMode:l,togglePresentationMode:A,isReadOnly:u,setIsReadOnly:f}=Mo();return X.useEffect(()=>{const h=xN((g,x)=>{a(g),f(x??!1)});return()=>{h()}},[f]),c.jsxs("div",{className:"h-screen overflow-hidden bg-slate-50 dark:bg-slate-900 text-slate-900 dark:text-slate-100 flex flex-col md:flex-row",children:[!l&&c.jsx(sq,{currentView:"dashboard",isCollapsed:n,sidebarOpen:e,onNavigate:()=>{},onToggleCollapse:()=>s(!n),onCloseMobile:()=>t(!1),isReadOnly:u}),c.jsxs("main",{className:`flex-1 flex flex-col min-w-0 overflow-hidden transition-all duration-300 ${l?"ml-0":n?"md:ml-20":"md:ml-64"}`,children:[!l&&c.jsxs("header",{className:"md:hidden bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 p-4 flex items-center gap-4",children:[c.jsx("button",{onClick:()=>t(!0),className:"p-1 text-slate-500 hover:text-slate-700",children:c.jsx(CS,{className:"w-6 h-6"})}),c.jsxs("h1",{className:"text-lg font-bold flex items-center gap-2",children:["LiteBI Studio",u&&c.jsx("span",{className:"text-[10px] uppercase font-bold tracking-wider bg-amber-100 dark:bg-amber-900/50 text-amber-700 dark:text-amber-400 px-2 py-0.5 rounded-full border border-amber-200 dark:border-amber-800",children:"Lese-Modus"})]})]}),c.jsx("div",{className:"flex-1 min-h-0 overflow-hidden relative",children:c.jsx(A8,{})})]}),e&&c.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 md:hidden glass",onClick:()=>t(!1)}),r&&!u&&c.jsx(iq,{}),c.jsx(cq,{}),l&&c.jsxs("button",{onClick:A,className:"fixed bottom-6 right-6 z-50 p-4 bg-slate-900 text-white rounded-full shadow-2xl hover:bg-slate-800 transition-all hover:scale-105 active:scale-95 group",title:"Prsentationsmodus beenden",children:[c.jsx(h2,{className:"w-6 h-6"}),c.jsx("span",{className:"absolute right-full mr-3 top-1/2 -translate-y-1/2 bg-slate-900 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap pointer-events-none",children:"Modus beenden"})]})]})},_N=X.createContext(void 0),dq=({children:e})=>{const[t,r]=hr("theme","system");return X.useEffect(()=>{const a=window.document.documentElement,n=()=>{a.classList.remove("light","dark")},s=l=>{if(n(),l==="system"){const A=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";a.classList.add(A);return}a.classList.add(l)};if(s(t),t==="system"){const l=window.matchMedia("(prefers-color-scheme: dark)"),A=()=>s("system");return l.addEventListener("change",A),()=>l.removeEventListener("change",A)}},[t]),c.jsx(_N.Provider,{value:{theme:t,setTheme:r},children:e})},fq=()=>{const e=X.useContext(_N);if(!e)throw new Error("useThemeContext must be used within a ThemeProvider");return e},xw={sm:"w-[min(100vw,26rem)]",md:"w-[min(100vw,34rem)]",lg:"w-[min(100vw,42rem)]"},hq=e=>{if(typeof e=="number")return{width:`${e}px`};if(typeof e=="string"&&!xw[e])return{width:e}},pq=e=>e?typeof e!="string"?"w-full max-w-full":xw[e]??"w-full max-w-full":xw.md,gq=({isOpen:e,onClose:t,title:r,children:a,width:n="md",noScroll:s})=>(X.useEffect(()=>{if(!e)return;const l=document.body.style.overflow,A=u=>{u.key==="Escape"&&t()};return document.body.style.overflow="hidden",window.addEventListener("keydown",A),()=>{document.body.style.overflow=l,window.removeEventListener("keydown",A)}},[e,t]),e?k0.createPortal(c.jsxs("div",{className:"fixed inset-0 z-[90] flex justify-end",children:[c.jsx("div",{className:"absolute inset-0 bg-slate-900/60 backdrop-blur-sm animate-in fade-in duration-200",onClick:t}),c.jsx("aside",{role:"dialog","aria-modal":"true",className:Hs("relative h-full max-h-screen bg-white dark:bg-slate-800 shadow-2xl border-l border-slate-200 dark:border-slate-700","animate-in slide-in-from-right-16 duration-200",pq(n)),style:hq(n),children:c.jsxs("div",{className:"h-full min-h-0 flex flex-col",children:[c.jsxs("div",{className:"px-5 py-4 border-b border-slate-200 dark:border-slate-700 flex items-center justify-between gap-3",children:[c.jsx("h3",{className:"text-base font-bold text-slate-900 dark:text-white truncate",children:r}),c.jsx("button",{onClick:t,className:"p-2 rounded-lg text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors","aria-label":"Close panel",children:c.jsx(nl,{className:"w-4 h-4"})})]}),c.jsx("div",{className:Hs("flex-1 min-h-0 p-5",!s&&"overflow-auto"),children:a})]})})]}),document.body):null),mq={error:{bg:"bg-red-50 dark:bg-red-900/10",border:"border-red-200 dark:border-red-800/40",text:"text-red-800 dark:text-red-300",icon:""},warning:{bg:"bg-amber-50 dark:bg-amber-900/10",border:"border-amber-200 dark:border-amber-800/40",text:"text-amber-800 dark:text-amber-300",icon:""},info:{bg:"bg-blue-50 dark:bg-blue-900/10",border:"border-blue-200 dark:border-blue-800/40",text:"text-blue-800 dark:text-blue-300",icon:""},success:{bg:"bg-emerald-50 dark:bg-emerald-900/10",border:"border-emerald-200 dark:border-emerald-800/40",text:"text-emerald-800 dark:text-emerald-300",icon:""}},t0=({header:e,alerts:t,children:r,sidebar:a,footer:n,breadcrumbs:s,className:l,fillHeight:A,rightPanel:u})=>{const{t:f}=tn(),{isAdminMode:h,isReadOnly:g}=Mo(),[x,m]=X.useState(0),[w,v]=X.useState(null),[B,k]=X.useState(!!u?.defaultOpen),{data:N}=ri(()=>Dt.getStorageStatus(),[],{cacheKey:"db-storage-status",ttl:15e3});X.useEffect(()=>{const W=()=>m(Q=>Q+1),I=Q=>{m(z=>Math.max(0,z-1));const Y=Q.detail;Y?.duration!==void 0&&v(Y.duration)};return window.addEventListener("db-query-start",W),window.addEventListener("db-query-end",I),()=>{window.removeEventListener("db-query-start",W),window.removeEventListener("db-query-end",I)}},[]);const S=[...t??[]];if(N?.mode==="memory"){const W=N.reason?` ${f("common.storage_memory_reason","Reason")}: ${N.reason}`:"";S.unshift({level:"warning",message:`${f("common.storage_memory_warning","Local persistence is currently unavailable. The database runs in memory and changes may be lost after reload.")}${W}`})}const O=async()=>{await Dt.abortActiveQueries()},T=u?.isOpen!==void 0,U=u?T?!!u.isOpen:B:!1,D=!!(u&&(u.enabled??!0)),H=D&&U,j=W=>{u&&(T||k(W),u.onOpenChange?.(W))};return c.jsxs("div",{className:Hs("h-full flex flex-col overflow-hidden animate-in slide-in-from-right-4 duration-500",l),children:[c.jsx("header",{className:"flex-shrink-0 px-6 md:px-8 py-4 border-b border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm",children:c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[c.jsx("div",{className:"flex items-center gap-4",children:c.jsxs("div",{children:[c.jsx("h1",{className:"text-xl md:text-2xl font-black text-slate-900 dark:text-white tracking-tight leading-tight",children:e.title}),e.subtitle&&c.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-0.5",children:e.subtitle})]})}),c.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.actions,c.jsx("button",{type:"button",onClick:()=>{D&&j(!0)},title:D?u?.triggerTitle||f("common.open","Open"):f("common.not_available","Not available"),"aria-label":D?u?.triggerTitle||f("common.open","Open"):f("common.not_available","Not available"),disabled:!D,className:Hs("h-10 w-10 flex items-center justify-center rounded-lg border transition-all",D?"bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-700":"bg-slate-100 dark:bg-slate-800/60 text-slate-300 dark:text-slate-600 border-slate-200 dark:border-slate-700 cursor-not-allowed",D&&H&&"ring-2 ring-blue-500/30",u?.triggerClassName),children:c.jsx(w8,{className:"w-4 h-4"})})]})]})}),c.jsx("div",{className:Hs("flex-1",A?"flex flex-col overflow-hidden":"overflow-y-auto"),children:c.jsxs("div",{className:Hs("px-6 md:px-8 py-6",A?"flex-1 flex flex-col gap-6 overflow-hidden":"space-y-6"),children:[S.length>0&&c.jsx("div",{className:"space-y-3 flex-shrink-0",children:S.map((W,I)=>{const Q=mq[W.level];return c.jsxs("div",{className:Hs("flex items-center justify-between gap-4 p-4 rounded-xl border",Q.bg,Q.border),children:[c.jsxs("div",{className:Hs("flex items-center gap-3 text-sm font-medium",Q.text),children:[c.jsx("span",{className:"text-base flex-shrink-0",children:Q.icon}),c.jsx("span",{children:W.message})]}),W.action&&c.jsx("button",{onClick:W.action.onClick,className:"flex-shrink-0 px-4 py-1.5 text-xs font-bold uppercase tracking-wider border border-current rounded-lg hover:bg-black/5 dark:hover:bg-white/5 transition-colors",children:W.action.label})]},I)})}),a?c.jsxs("div",{className:Hs("flex flex-col lg:flex-row gap-6",A&&"flex-1 overflow-hidden"),children:[c.jsx("div",{className:Hs("flex-1 min-w-0",A?"flex flex-col gap-6 overflow-hidden":"space-y-6"),children:r}),c.jsx("aside",{className:"w-full lg:w-72 flex-shrink-0 space-y-6",children:a})]}):c.jsx("div",{className:Hs(A?"flex-1 flex flex-col gap-6 overflow-hidden":"space-y-6"),children:r})]})}),(n||s&&s.length>0||x>0||w!==null)&&c.jsx("footer",{className:"flex-shrink-0 px-6 md:px-8 py-3 border-t border-slate-300 dark:border-slate-700 bg-slate-50/50 dark:bg-slate-800/50",children:c.jsxs("div",{className:"flex items-center justify-between gap-4",children:[c.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-400 dark:text-slate-500",children:[g&&c.jsxs("div",{className:"flex items-center gap-2 px-2.5 py-0.5 rounded-lg bg-rose-100 dark:bg-rose-900/40 border border-rose-300 dark:border-rose-700 shadow-sm",title:f("common.read_only","Read-Only"),children:[c.jsx(E0,{className:"w-3.5 h-3.5 text-rose-700 dark:text-rose-300"}),c.jsx("span",{className:"text-[10px] font-black uppercase tracking-wider text-rose-800 dark:text-rose-200",children:f("common.read_only","Read-Only")})]}),h?c.jsxs("div",{className:"flex items-center gap-2 px-2.5 py-0.5 rounded-lg bg-amber-100 dark:bg-amber-900/40 border border-amber-300 dark:border-amber-700 shadow-sm",title:f("settings.admin_mode_active","Admin Mode active"),children:[c.jsx(y8,{className:"w-3.5 h-3.5 text-amber-700 dark:text-amber-300"}),c.jsx("span",{className:"text-[10px] font-black uppercase tracking-wider text-amber-800 dark:text-amber-200",children:f("settings.admin_mode","Admin Mode")})]}):c.jsx("div",{className:"flex items-center px-1.5 py-0.5 rounded-full text-slate-400 dark:text-slate-500",title:f("settings.user_mode","User Mode"),children:c.jsx(NS,{className:"w-3.5 h-3.5"})}),(x>0||w!==null)&&c.jsx("div",{className:"flex items-center gap-2 px-2 py-0.5 rounded-full bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shadow-sm transition-all",title:"Letzte Datenbank-Antwortzeit",children:x>0?c.jsxs(c.Fragment,{children:[c.jsx(Ym,{className:"w-3 h-3 animate-spin text-blue-500"}),c.jsx("span",{className:"text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:f("common.loading","Loading...")})]}):c.jsxs(c.Fragment,{children:[c.jsx(Ru,{className:"w-3 h-3 text-emerald-500"}),c.jsxs("span",{className:"text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:[Math.round(w)," ms"]})]})}),x>0&&c.jsx("button",{type:"button",onClick:()=>{O()},className:"px-2 py-0.5 rounded-full bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shadow-sm text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider hover:text-rose-600 dark:hover:text-rose-400 hover:border-rose-300 dark:hover:border-rose-700 transition-colors",title:f("common.stop_sql","Stop"),children:f("common.stop_sql","Stop")})]}),c.jsxs("div",{className:"flex items-center gap-3 text-right",children:[n&&c.jsx("div",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:n}),n&&s&&s.length>0&&c.jsx("div",{className:"w-1 h-1 rounded-full bg-slate-300 dark:bg-slate-600"}),s&&s.length>0&&c.jsx("nav",{className:"flex items-center gap-1.5 text-[10px] uppercase font-black tracking-wider",children:s.map((W,I)=>c.jsxs(ar.Fragment,{children:[I>0&&c.jsx("span",{className:"text-slate-300 dark:text-slate-600",children:"/"}),W.href||W.onClick?c.jsx("a",{href:W.href||"#",onClick:Q=>{W.onClick&&(Q.preventDefault(),W.onClick())},className:"text-slate-400 dark:text-slate-500 hover:text-blue-600 dark:hover:text-blue-400 transition-colors cursor-pointer",children:W.label}):c.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:W.label})]},I))})]})]})}),u&&D&&c.jsx(gq,{isOpen:H,onClose:()=>j(!1),title:u.title,width:u.width,noScroll:u.noScroll,children:u.content})]})},xq="litebi-backup-location",Gu="handles",oy="backup-directory-handle",Ay="backup_saved_folder_label",Nf=typeof window<"u",cy=()=>new Promise((e,t)=>{const r=indexedDB.open(xq,1);r.onupgradeneeded=()=>{const a=r.result;a.objectStoreNames.contains(Gu)||a.createObjectStore(Gu)},r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)}),bq=async e=>{const t=await cy();await new Promise((r,a)=>{const n=t.transaction(Gu,"readwrite");n.objectStore(Gu).put(e,oy),n.oncomplete=()=>r(),n.onerror=()=>a(n.error),n.onabort=()=>a(n.error)})},BN=async()=>{const e=await cy();return await new Promise((t,r)=>{const n=e.transaction(Gu,"readonly").objectStore(Gu).get(oy);n.onsuccess=()=>t(n.result||null),n.onerror=()=>r(n.error)})},vq=async()=>{const e=await cy();await new Promise((t,r)=>{const a=e.transaction(Gu,"readwrite");a.objectStore(Gu).delete(oy),a.oncomplete=()=>t(),a.onerror=()=>r(a.error),a.onabort=()=>r(a.error)})},wq=async(e,t)=>!e.queryPermission||!e.requestPermission||await e.queryPermission({mode:t})==="granted"?!0:await e.requestPermission({mode:t})==="granted",Kp=()=>Nf?typeof window.showDirectoryPicker=="function":!1,yq=()=>Nf&&localStorage.getItem(Ay)||"",_q=async()=>{if(!Nf||!Kp())return null;const e=window.showDirectoryPicker,t=await e();if(!t)return null;await bq(t);const r=t.name||"";return localStorage.setItem(Ay,r),r},Bq=async()=>{Nf&&(await vq(),localStorage.removeItem(Ay))},kq=async(e,t)=>{if(!Nf||!Kp())return!1;const r=await BN();if(!r||!r.getFileHandle||!await wq(r,"readwrite"))return!1;const n=await r.getFileHandle(t,{create:!0});if(!n?.createWritable)return!1;const s=await n.createWritable();return await s.write(e),await s.close(),!0},Cq=async()=>{if(!Nf||!Kp())return{file:null,cancelled:!1};const e=window.showOpenFilePicker;if(!e)return{file:null,cancelled:!1};const t=await BN();try{const r=await e({multiple:!1,startIn:t||void 0,types:[{description:"SQLite Backup",accept:{"application/x-sqlite3":[".sqlite3",".sqlite",".db"]}}]});return r?.length?{file:await r[0].getFile(),cancelled:!1}:{file:null,cancelled:!1}}catch(r){return(r instanceof DOMException?r.name:"")==="AbortError"?{file:null,cancelled:!0}:{file:null,cancelled:!1}}},Sq=()=>{const{t:e,i18n:t}=tn(),r="1.1.0",a="20260226-1747",{theme:n,setTheme:s}=fq(),{isReadOnly:l,isAdminMode:A,setIsAdminMode:u}=Mo(),[f,h]=ar.useState("appearance"),[g,x]=ar.useState("inspector"),[m,w]=ar.useState("datatable"),[v,B]=ar.useState(!1),k=[{value:"light",label:e("settings.theme_light")},{value:"dark",label:e("settings.theme_dark")},{value:"system",label:e("settings.theme_system")}],[N,S]=ar.useState(!!localStorage.getItem("litebistudio_app_pin")),[O,T]=ar.useState(!1),[U,D]=ar.useState(""),[H,j]=hr("data_inspector_page_size",100),[W,I]=hr("data_inspector_show_profiling",!0),[Q,Y]=hr("data_inspector_explain_mode",!1),[z,ue]=hr("data_inspector_sql_assist_open",!1),[Z,Ae]=hr("data_inspector_autocomplete_enabled",!0),[ve,G]=hr("data_inspector_sql_require_limit_confirm",!0),[Se,we]=hr("data_inspector_sql_max_rows",5e3),[F,R]=hr("data_inspector_profiling_thresholds",{nullRate:30,cardinalityRate:95}),[M,P]=hr("query_builder_default_mode","visual"),[re,ge]=hr("query_builder_sql_editor_height",384),[Ce,de]=hr("import_default_mode","append"),[be,Le]=hr("import_auto_save_mappings",!0),[ie,_e]=hr("backup_file_name_pattern","backup_{date}_{mode}"),[je,J]=hr("backup_use_saved_location",!0),[ze,He]=hr("backup_saved_folder_label",""),[ct,Xe]=hr("ui_table_density","normal"),[Ut,yt]=hr("ui_table_wrap_cells",!1),[qt,Lt]=hr("data_table_default_show_filters",!1),[jt,Pt]=hr("notifications_confirm_destructive",!0),[zt,Jt]=hr(i3,"error"),[It,xt]=hr("ui_sidebar_show_language_switch",!0),[ht,Bt]=hr("ui_sidebar_show_system_status",!0),pr=async tt=>jt?await Xt.confirm(tt):!0,$t=async()=>{await pr(e("settings.inspector_reset_layout_confirm"))&&(localStorage.removeItem("data_inspector_column_widths_v1"),localStorage.removeItem("data_inspector_saved_views"),localStorage.removeItem("data_inspector_active_view"),localStorage.removeItem("data_inspector_sql_editor_height"),await Xt.info(e("settings.inspector_reset_layout_done")))},Ee=async()=>{await pr(e("settings.inspector_reset_sql_confirm"))&&(localStorage.removeItem("data_inspector_sql_history"),localStorage.removeItem("data_inspector_favorite_queries"),localStorage.removeItem("data_inspector_custom_sql_templates"),localStorage.removeItem("data_inspector_selected_custom_template"),await Xt.info(e("settings.inspector_reset_sql_done")))},at=async()=>{if(U.length<4){await Xt.warning(e("settings.pin_error_min"));return}const tt=lq(),Wt=await vN(U,tt);localStorage.setItem("litebistudio_app_pin_salt",tt),localStorage.setItem("litebistudio_app_pin",Wt),S(!0),T(!1),D(""),window.dispatchEvent(new Event("pin-changed")),await Xt.info(e("settings.pin_success"))},it=async()=>{await Xt.confirm(e("settings.pin_confirm_remove"))&&(localStorage.removeItem("litebistudio_app_pin"),localStorage.removeItem("litebistudio_app_pin_salt"),S(!1),window.dispatchEvent(new Event("pin-changed")))},bt=new Date,Et=t.language.startsWith("de")?"de-DE":"en-US",mt=Kp(),Ot=e("settings.last_update",{date:bt.toLocaleDateString(Et),time:bt.toLocaleTimeString(Et,{hour:"2-digit",minute:"2-digit"})}),Ur=async()=>{try{const tt=await _q();He(tt||yq())}catch{await Xt.warning(e("settings.backup_folder_select_error","Folder could not be selected."))}},Vt=async()=>{await Bq(),He("")};return c.jsxs(t0,{header:{title:e("sidebar.settings"),subtitle:e("settings.subtitle")},rightPanel:{title:e("settings.quick_access_panel","Quick Access"),triggerTitle:e("settings.quick_access_open","Quick Access"),width:"sm",content:c.jsxs("div",{className:"space-y-4 text-sm",children:[c.jsx("p",{className:"text-slate-500",children:e("settings.quick_access_hint","Open frequently used sections without adding more controls to the main layout.")}),c.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[c.jsx("button",{type:"button",onClick:()=>h("appearance"),className:`px-3 py-2 rounded-lg text-left border transition-colors ${f==="appearance"?"border-blue-300 bg-blue-50 text-blue-700":"border-slate-200 bg-white text-slate-600 hover:bg-slate-50"}`,children:e("settings.tab_appearance")}),c.jsx("button",{type:"button",onClick:()=>h("security"),className:`px-3 py-2 rounded-lg text-left border transition-colors ${f==="security"?"border-blue-300 bg-blue-50 text-blue-700":"border-slate-200 bg-white text-slate-600 hover:bg-slate-50"}`,children:e("settings.tab_security")}),c.jsx("button",{type:"button",onClick:()=>{h("apps"),x("inspector")},className:`px-3 py-2 rounded-lg text-left border transition-colors ${f==="apps"?"border-blue-300 bg-blue-50 text-blue-700":"border-slate-200 bg-white text-slate-600 hover:bg-slate-50"}`,children:e("sidebar.data_inspector")}),c.jsx("button",{type:"button",onClick:()=>B(!0),className:"px-3 py-2 rounded-lg text-left border border-slate-200 bg-white text-slate-600 hover:bg-slate-50 transition-colors",children:e("settings.open_health_check","Open Health Check")})]})]})},footer:Ot,breadcrumbs:[{label:e("sidebar.settings")}],children:[c.jsxs("div",{className:"max-w-3xl space-y-6",children:[c.jsx("div",{className:"flex items-center justify-between border-b border-slate-200 dark:border-slate-800",children:c.jsx("div",{className:"flex items-center overflow-x-auto",children:[{id:"appearance",label:e("settings.tab_appearance")},{id:"security",label:e("settings.tab_security")},{id:"apps",label:e("settings.tab_apps","Apps")},{id:"controls",label:e("settings.tab_controls","Controls")},{id:"about",label:e("settings.tab_about")}].map(tt=>c.jsx("button",{onClick:()=>h(tt.id),className:`px-4 py-2.5 text-sm font-bold transition-all border-b-2 whitespace-nowrap ${f===tt.id?"text-blue-600 border-blue-600":"text-slate-400 hover:text-blue-600 border-transparent"}`,children:tt.label},tt.id))})}),f==="apps"&&c.jsx("div",{className:"flex items-center justify-between border-b border-slate-200 dark:border-slate-800 -mt-2",children:c.jsx("div",{className:"flex items-center overflow-x-auto",children:[{id:"inspector",label:e("sidebar.data_inspector")},{id:"querybuilder",label:e("sidebar.query_builder")},{id:"datamanagement",label:e("sidebar.datasource")}].map(tt=>c.jsx("button",{onClick:()=>x(tt.id),className:`px-4 py-2 text-xs font-bold transition-all border-b-2 whitespace-nowrap ${g===tt.id?"text-blue-600 border-blue-600":"text-slate-400 hover:text-blue-600 border-transparent"}`,children:tt.label},tt.id))})}),f==="controls"&&c.jsx("div",{className:"flex items-center justify-between border-b border-slate-200 dark:border-slate-800 -mt-2",children:c.jsx("div",{className:"flex items-center overflow-x-auto",children:[{id:"datatable",label:e("settings.tab_datatable")},{id:"notifications",label:e("settings.tab_notifications")}].map(tt=>c.jsx("button",{onClick:()=>w(tt.id),className:`px-4 py-2 text-xs font-bold transition-all border-b-2 whitespace-nowrap ${m===tt.id?"text-blue-600 border-blue-600":"text-slate-400 hover:text-blue-600 border-transparent"}`,children:tt.label},tt.id))})}),f==="appearance"&&c.jsxs("div",{className:`space-y-4 transition-opacity ${l?"opacity-50 pointer-events-none":""}`,children:[c.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm",children:[c.jsxs("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[c.jsx("span",{className:"p-1.5 bg-slate-100 dark:bg-slate-700 rounded-lg",children:c.jsx(_8,{className:"w-4 h-4 text-blue-500"})}),e("settings.appearance")]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:e("settings.appearance_hint")}),c.jsx("div",{className:"grid grid-cols-3 gap-3",children:k.map(({value:tt,label:Wt})=>c.jsx("button",{onClick:()=>s(tt),className:`p-3 rounded-xl border flex flex-col items-center gap-2 transition-all ${n===tt?"bg-blue-50 border-blue-200 text-blue-700 dark:bg-blue-900/20 dark:border-blue-800 dark:text-blue-200 ring-2 ring-blue-500 ring-offset-2 dark:ring-offset-slate-800":"border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-700/50 text-slate-600 dark:text-slate-400"}`,children:c.jsx("span",{className:"text-sm font-medium",children:Wt})},tt))})]})]}),c.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm",children:[c.jsxs("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[c.jsx("span",{className:"p-1.5 bg-slate-100 dark:bg-slate-700 rounded-lg",children:c.jsx(Xm,{className:"w-4 h-4 text-blue-500"})}),e("settings.language_panel_title")]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:e("settings.language_panel_hint")}),c.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-bold uppercase tracking-wider text-slate-500 mb-2",children:e("settings.language")}),c.jsxs("select",{value:t.language.startsWith("de")?"de":"en",onChange:tt=>{t.changeLanguage(tt.target.value)},className:"w-full px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200",children:[c.jsx("option",{value:"de",children:e("settings.language_de")}),c.jsx("option",{value:"en",children:e("settings.language_en")})]})]}),c.jsx("div",{className:"flex items-end",children:c.jsxs("label",{className:"w-full flex items-center justify-between rounded-xl border border-slate-200 dark:border-slate-700 px-3 py-2",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Xm,{className:"w-4 h-4 text-blue-500"}),c.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:e("settings.show_sidebar_language_switch")})]}),c.jsx("button",{type:"button",onClick:()=>{const tt=!It;xt(tt),window.dispatchEvent(new CustomEvent("sidebar-language-visibility-changed",{detail:{visible:tt}}))},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${It?"bg-blue-600":"bg-slate-300 dark:bg-slate-600"}`,"aria-pressed":It,"aria-label":e("settings.show_sidebar_language_switch"),children:c.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${It?"translate-x-6":"translate-x-1"}`})})]})})]})]})]}),c.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm",children:[c.jsxs("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[c.jsx("span",{className:"p-1.5 bg-slate-100 dark:bg-slate-700 rounded-lg",children:c.jsx(Ru,{className:"w-4 h-4 text-blue-500"})}),e("settings.health_link_title")]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:e("settings.health_link_hint")}),c.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[c.jsxs("button",{onClick:()=>B(!0),className:"inline-flex items-center gap-2 px-3 py-2 text-sm font-semibold rounded-lg border border-blue-300 text-blue-700 dark:border-blue-700 dark:text-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors",children:[c.jsx(Ru,{className:"w-4 h-4"}),e("settings.health_link_open")]}),c.jsxs("label",{className:"inline-flex items-center gap-3 rounded-xl border border-slate-200 dark:border-slate-700 px-3 py-2",children:[c.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:e("settings.show_sidebar_system_status")}),c.jsx("button",{type:"button",onClick:()=>{const tt=!ht;Bt(tt),window.dispatchEvent(new CustomEvent("sidebar-system-status-visibility-changed",{detail:{visible:tt}}))},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${ht?"bg-blue-600":"bg-slate-300 dark:bg-slate-600"}`,"aria-pressed":ht,"aria-label":e("settings.show_sidebar_system_status"),children:c.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${ht?"translate-x-6":"translate-x-1"}`})})]})]})]})]})]}),f==="security"&&c.jsxs("div",{className:`space-y-4 transition-opacity ${l?"opacity-50 pointer-events-none":""}`,children:[c.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm",children:[c.jsxs("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[c.jsx("span",{className:"p-1.5 bg-slate-100 dark:bg-slate-700 rounded-lg",children:c.jsx(E0,{className:"w-4 h-4 text-emerald-500"})}),e("settings.access_restriction_title")]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:e("settings.access_restriction_hint")}),!N&&!O&&c.jsxs("button",{onClick:()=>T(!0),className:"w-full h-12 border-2 border-dashed border-slate-300 dark:border-slate-600 rounded-xl flex items-center justify-center gap-2 text-slate-500 hover:border-blue-500 hover:text-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-all font-medium",children:[c.jsx(E0,{className:"w-4 h-4"}),e("settings.enable_pin")]}),O&&c.jsxs("div",{className:"flex items-center gap-2 animate-in fade-in slide-in-from-top-2",children:[c.jsx("input",{type:"password",inputMode:"numeric",pattern:"[0-9]*",placeholder:e("settings.pin_placeholder"),className:"flex-1 px-4 py-2 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none",value:U,onChange:tt=>D(tt.target.value),autoFocus:!0}),c.jsx("button",{onClick:at,className:"p-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors",title:e("common.save"),children:c.jsx(Px,{className:"w-5 h-5"})}),c.jsx("button",{onClick:()=>{T(!1),D("")},className:"p-2 bg-slate-200 dark:bg-slate-700 text-slate-600 dark:text-slate-300 rounded-lg hover:bg-slate-300 dark:hover:bg-slate-600 transition-colors",title:e("common.cancel"),children:c.jsx(nl,{className:"w-5 h-5"})})]}),N&&c.jsxs("div",{className:"flex items-center justify-between p-4 bg-emerald-50 dark:bg-emerald-900/10 border border-emerald-100 dark:border-emerald-900/30 rounded-xl",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-emerald-100 dark:bg-emerald-900/30 rounded-full",children:c.jsx(E0,{className:"w-4 h-4 text-emerald-600 dark:text-emerald-400"})}),c.jsxs("div",{children:[c.jsx("div",{className:"font-semibold text-emerald-900 dark:text-emerald-100",children:e("settings.pin_active")}),c.jsx("div",{className:"text-xs text-emerald-700 dark:text-emerald-400",children:e("settings.pin_active_hint")})]})]}),c.jsx("button",{onClick:it,className:"p-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:e("common.remove"),children:c.jsx(ds,{className:"w-4 h-4"})})]})]})]}),c.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm",children:[c.jsxs("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[c.jsx("span",{className:"p-1.5 bg-slate-100 dark:bg-slate-700 rounded-lg",children:c.jsx(Z5,{className:"w-4 h-4 text-amber-500"})}),e("settings.admin_mode")]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:e("settings.admin_mode_panel_hint")}),c.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-slate-200 dark:border-slate-700 px-3 py-2",children:[c.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:e("settings.admin_mode_hint")}),c.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[c.jsx("input",{type:"checkbox",className:"sr-only peer",checked:A,onChange:()=>u(!A)}),c.jsx("div",{className:"w-11 h-6 bg-slate-200 peer-focus:outline-none rounded-full peer dark:bg-slate-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-slate-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-slate-600 peer-checked:bg-amber-500"})]})]})]})]})]}),f==="apps"&&g==="inspector"&&c.jsxs("div",{className:`bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm transition-opacity ${l?"opacity-50 pointer-events-none":""}`,children:[c.jsxs("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[c.jsx("span",{className:"p-1.5 bg-slate-100 dark:bg-slate-700 rounded-lg",children:c.jsx(Jv,{className:"w-4 h-4 text-blue-500"})}),e("settings.inspector_title")]}),c.jsxs("div",{className:"space-y-5",children:[c.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:e("settings.inspector_hint")}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsxs("label",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-200 dark:border-slate-700",children:[c.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:e("settings.inspector_autocomplete")}),c.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:Z,onChange:()=>Ae(!Z)})]}),c.jsxs("label",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-200 dark:border-slate-700",children:[c.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:e("settings.inspector_explain")}),c.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:Q,onChange:()=>Y(!Q)})]}),c.jsxs("label",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-200 dark:border-slate-700",children:[c.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:e("settings.inspector_sql_assist")}),c.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:z,onChange:()=>ue(!z)})]}),c.jsxs("label",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-200 dark:border-slate-700",children:[c.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:e("settings.inspector_profiling")}),c.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:W,onChange:()=>I(!W)})]})]}),c.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-700 space-y-3",children:[c.jsx("label",{className:"block text-xs font-bold uppercase tracking-wider text-slate-500",children:e("settings.inspector_page_size")}),c.jsx("select",{value:String(H),onChange:tt=>j(Number(tt.target.value)),className:"w-full sm:w-52 p-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm",children:[50,100,250,500].map(tt=>c.jsx("option",{value:tt,children:tt},tt))})]}),c.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-700 space-y-4",children:[c.jsx("p",{className:"text-xs font-bold uppercase tracking-wider text-slate-500",children:e("settings.inspector_thresholds")}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsxs("label",{className:"space-y-1",children:[c.jsx("span",{className:"text-xs text-slate-500",children:e("settings.inspector_null_threshold")}),c.jsx("input",{type:"number",min:0,max:100,value:F.nullRate,onChange:tt=>{const Wt=Math.max(0,Math.min(100,Number(tt.target.value)||0));R({...F,nullRate:Wt})},className:"w-full p-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm"})]}),c.jsxs("label",{className:"space-y-1",children:[c.jsx("span",{className:"text-xs text-slate-500",children:e("settings.inspector_cardinality_threshold")}),c.jsx("input",{type:"number",min:0,max:100,value:F.cardinalityRate,onChange:tt=>{const Wt=Math.max(0,Math.min(100,Number(tt.target.value)||0));R({...F,cardinalityRate:Wt})},className:"w-full p-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm"})]})]})]}),c.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-700 space-y-4",children:[c.jsx("p",{className:"text-xs font-bold uppercase tracking-wider text-slate-500",children:e("settings.inspector_sql_safety")}),c.jsxs("label",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-200 dark:border-slate-700",children:[c.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:e("settings.inspector_sql_confirm_without_limit")}),c.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:ve,onChange:()=>G(!ve)})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-xs text-slate-500",children:e("settings.inspector_sql_max_rows")}),c.jsx("input",{type:"number",min:100,max:5e4,value:Se,onChange:tt=>{const Wt=Math.max(100,Math.min(5e4,Number(tt.target.value)||100));we(Wt)},className:"w-full sm:w-52 p-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm"})]})]}),c.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-700 space-y-3",children:[c.jsx("p",{className:"text-xs font-bold uppercase tracking-wider text-slate-500",children:e("settings.inspector_reset_title")}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx("button",{type:"button",onClick:$t,className:"px-3 py-2 rounded-lg border border-slate-300 dark:border-slate-600 text-xs font-semibold text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors",children:e("settings.inspector_reset_layout")}),c.jsx("button",{type:"button",onClick:Ee,className:"px-3 py-2 rounded-lg border border-slate-300 dark:border-slate-600 text-xs font-semibold text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors",children:e("settings.inspector_reset_sql")})]})]})]})]}),f==="apps"&&g==="querybuilder"&&c.jsxs("div",{className:`bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm transition-opacity ${l?"opacity-50 pointer-events-none":""}`,children:[c.jsxs("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[c.jsx("span",{className:"p-1.5 bg-slate-100 dark:bg-slate-700 rounded-lg",children:c.jsx(Jv,{className:"w-4 h-4 text-blue-500"})}),e("settings.querybuilder_title")]}),c.jsxs("div",{className:"space-y-5",children:[c.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:e("settings.querybuilder_hint")}),c.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-700 space-y-3",children:[c.jsx("label",{className:"block text-xs font-bold uppercase tracking-wider text-slate-500",children:e("settings.querybuilder_default_mode")}),c.jsxs("select",{value:M,onChange:tt=>P(tt.target.value),className:"w-full sm:w-52 p-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm",children:[c.jsx("option",{value:"visual",children:e("querybuilder.visual_builder")}),c.jsx("option",{value:"sql",children:e("querybuilder.direct_editor")})]})]}),c.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-700 space-y-3",children:[c.jsx("label",{className:"block text-xs font-bold uppercase tracking-wider text-slate-500",children:e("settings.querybuilder_sql_height")}),c.jsx("input",{type:"number",min:220,max:700,value:re,onChange:tt=>{const Wt=Math.max(220,Math.min(700,Number(tt.target.value)||220));ge(Wt)},className:"w-full sm:w-52 p-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm"})]})]})]}),f==="apps"&&g==="datamanagement"&&c.jsxs("div",{className:`space-y-6 transition-opacity ${l?"opacity-50 pointer-events-none":""}`,children:[c.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm space-y-5",children:[c.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:e("settings.import_title")}),c.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:e("settings.import_hint")}),c.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-700 space-y-3",children:[c.jsx("label",{className:"block text-xs font-bold uppercase tracking-wider text-slate-500",children:e("settings.import_default_mode")}),c.jsxs("select",{value:Ce,onChange:tt=>de(tt.target.value),className:"w-full sm:w-52 p-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm",children:[c.jsx("option",{value:"append",children:e("datasource.excel_import.append")}),c.jsx("option",{value:"overwrite",children:e("datasource.excel_import.overwrite")})]})]}),c.jsxs("label",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-200 dark:border-slate-700",children:[c.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:e("settings.import_auto_save_mappings")}),c.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:be,onChange:()=>Le(!be)})]})]}),c.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm space-y-5",children:[c.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:e("datasource.backup_restore")}),c.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:e("settings.backup_hint","Defaults for backup and restore behavior.")}),c.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-700 space-y-3",children:[c.jsx("label",{className:"block text-xs font-bold uppercase tracking-wider text-slate-500",children:e("settings.backup_name_pattern","Backup filename pattern")}),c.jsx("input",{value:ie,onChange:tt=>_e(tt.target.value),placeholder:"backup_{date}_{mode}",className:"w-full sm:w-[28rem] p-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm"}),c.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:e("settings.backup_name_pattern_hint","Tokens: {date}, {time}, {datetime}, {mode}.")})]}),c.jsxs("label",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-200 dark:border-slate-700",children:[c.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:e("settings.backup_use_saved_location","Use saved backup folder")}),c.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:je,onChange:()=>J(!je)})]}),c.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 -mt-2",children:e("settings.backup_use_saved_location_hint","Default: try the selected backup folder first, then fall back to file picker.")}),c.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-700 space-y-3",children:[c.jsx("label",{className:"block text-xs font-bold uppercase tracking-wider text-slate-500",children:e("settings.backup_folder","Backup folder")}),mt?c.jsxs(c.Fragment,{children:[c.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-200",children:ze||e("settings.backup_folder_none","No folder selected")}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{type:"button",onClick:()=>{Ur()},className:"px-3 py-1.5 text-xs font-semibold rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-700 dark:text-slate-200",children:e("settings.backup_folder_choose","Choose folder")}),c.jsx("button",{type:"button",onClick:()=>{Vt()},className:"px-3 py-1.5 text-xs font-semibold rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",children:e("common.clear","Clear")})]})]}):c.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:e("settings.backup_folder_not_supported","Your browser does not support persistent folder access.")})]})]})]}),f==="controls"&&m==="datatable"&&c.jsxs("div",{className:`bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm transition-opacity ${l?"opacity-50 pointer-events-none":""}`,children:[c.jsxs("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[c.jsx("span",{className:"p-1.5 bg-slate-100 dark:bg-slate-700 rounded-lg",children:c.jsx(FS,{className:"w-4 h-4 text-blue-500"})}),e("settings.datatable_title")]}),c.jsxs("div",{className:"space-y-5",children:[c.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:e("settings.datatable_hint")}),c.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-700 space-y-3",children:[c.jsx("label",{className:"block text-xs font-bold uppercase tracking-wider text-slate-500",children:e("settings.datatable_density")}),c.jsxs("select",{value:ct,onChange:tt=>Xe(tt.target.value),className:"w-full sm:w-52 p-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm",children:[c.jsx("option",{value:"normal",children:e("settings.datatable_density_normal")}),c.jsx("option",{value:"compact",children:e("settings.datatable_density_compact")})]})]}),c.jsxs("label",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-200 dark:border-slate-700",children:[c.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:e("settings.datatable_wrap_cells")}),c.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:Ut,onChange:()=>yt(!Ut)})]}),c.jsxs("label",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-200 dark:border-slate-700",children:[c.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:e("settings.datatable_default_filters")}),c.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:qt,onChange:()=>Lt(!qt)})]})]})]}),f==="controls"&&m==="notifications"&&c.jsxs("div",{className:`bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm transition-opacity ${l?"opacity-50 pointer-events-none":""}`,children:[c.jsxs("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[c.jsx("span",{className:"p-1.5 bg-slate-100 dark:bg-slate-700 rounded-lg",children:c.jsx(B8,{className:"w-4 h-4 text-blue-500"})}),e("settings.notifications_title")]}),c.jsxs("div",{className:"space-y-5",children:[c.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:e("settings.notifications_hint")}),c.jsxs("label",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-200 dark:border-slate-700",children:[c.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:e("settings.notifications_confirm_destructive")}),c.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:jt,onChange:()=>Pt(!jt)})]}),c.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-700 space-y-3",children:[c.jsx("label",{className:"block text-xs font-bold uppercase tracking-wider text-slate-500",children:e("settings.log_level")}),c.jsxs("select",{value:zt,onChange:tt=>{const Wt=tt.target.value;Jt(Wt),window.dispatchEvent(new CustomEvent("app-log-level-changed",{detail:{level:Wt}}))},className:"w-full sm:w-52 p-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm",children:[c.jsx("option",{value:"off",children:e("settings.log_level_off")}),c.jsx("option",{value:"error",children:e("settings.log_level_error")}),c.jsx("option",{value:"warn",children:e("settings.log_level_warn")}),c.jsx("option",{value:"info",children:e("settings.log_level_info")}),c.jsx("option",{value:"debug",children:e("settings.log_level_debug")})]})]})]})]}),f==="about"&&c.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm",children:[c.jsxs("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[c.jsx("span",{className:"p-1.5 bg-slate-100 dark:bg-slate-700 rounded-lg",children:c.jsx(qc,{className:"w-4 h-4 text-blue-500"})}),e("about.title","About LiteBI Studio")]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:e("about.settings_hint","Learn more about the project, the version and the vision behind LiteBI Studio.")}),c.jsxs(c8,{to:"/about",className:"w-full flex items-center justify-between p-4 bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-700 rounded-xl hover:bg-slate-100 dark:hover:bg-slate-700 transition-all group",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:c.jsx(Z5,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"})}),c.jsxs("div",{children:[c.jsx("div",{className:"font-semibold text-slate-900 dark:text-white",children:e("about.view_info","Project Information")}),c.jsxs("div",{className:"mt-1 flex items-center gap-2 text-xs text-slate-500 dark:text-slate-400",children:[c.jsxs("span",{children:["Version ",r]}),c.jsx("span",{className:"text-slate-300 dark:text-slate-600",children:"|"}),c.jsxs("span",{children:["Build ",a]})]})]})]}),c.jsx(Ul,{className:"w-5 h-5 text-slate-400 group-hover:text-blue-500 transition-colors"})]})]})]})]}),c.jsx(ly,{isOpen:v,onClose:()=>B(!1)})]})},Eq=()=>c.jsx(Sq,{}),kN=6048e5,Nq=864e5,Fq=6e4,Tq=36e5,Lq=1e3,K4=Symbol.for("constructDateFrom");function si(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&K4 in e?e[K4](t):e instanceof Date?new e.constructor(t):new Date(t)}function Ls(e,t){return si(t||e,e)}function CN(e,t,r){const a=Ls(e,r?.in);return isNaN(t)?si(r?.in||e,NaN):(t&&a.setDate(a.getDate()+t),a)}let Uq={};function Ff(){return Uq}function Wu(e,t){const r=Ff(),a=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,n=Ls(e,t?.in),s=n.getDay(),l=(s<a?7:0)+s-a;return n.setDate(n.getDate()-l),n.setHours(0,0,0,0),n}function yf(e,t){return Wu(e,{...t,weekStartsOn:1})}function SN(e,t){const r=Ls(e,t?.in),a=r.getFullYear(),n=si(r,0);n.setFullYear(a+1,0,4),n.setHours(0,0,0,0);const s=yf(n),l=si(r,0);l.setFullYear(a,0,4),l.setHours(0,0,0,0);const A=yf(l);return r.getTime()>=s.getTime()?a+1:r.getTime()>=A.getTime()?a:a-1}function wx(e){const t=Ls(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function jq(e,...t){const r=si.bind(null,t.find(a=>typeof a=="object"));return t.map(r)}function q4(e,t){const r=Ls(e,t?.in);return r.setHours(0,0,0,0),r}function Dq(e,t,r){const[a,n]=jq(r?.in,e,t),s=q4(a),l=q4(n),A=+s-wx(s),u=+l-wx(l);return Math.round((A-u)/Nq)}function Iq(e,t){const r=SN(e,t),a=si(e,0);return a.setFullYear(r,0,4),a.setHours(0,0,0,0),yf(a)}function Qq(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function bw(e){return!(!Qq(e)&&typeof e!="number"||isNaN(+Ls(e)))}function Oq(e,t){const r=Ls(e,t?.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const Rq={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Mq=(e,t,r)=>{let a;const n=Rq[e];return typeof n=="string"?a=n:t===1?a=n.one:a=n.other.replace("{{count}}",t.toString()),r?.addSuffix?r.comparison&&r.comparison>0?"in "+a:a+" ago":a};function rv(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const Hq={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Pq={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Kq={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},qq={date:rv({formats:Hq,defaultWidth:"full"}),time:rv({formats:Pq,defaultWidth:"full"}),dateTime:rv({formats:Kq,defaultWidth:"full"})},zq={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Vq=(e,t,r,a)=>zq[e];function yh(e){return(t,r)=>{const a=r?.context?String(r.context):"standalone";let n;if(a==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,A=r?.width?String(r.width):l;n=e.formattingValues[A]||e.formattingValues[l]}else{const l=e.defaultWidth,A=r?.width?String(r.width):e.defaultWidth;n=e.values[A]||e.values[l]}const s=e.argumentCallback?e.argumentCallback(t):t;return n[s]}}const Gq={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Wq={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Xq={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Yq={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},$q={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Jq={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Zq=(e,t)=>{const r=Number(e),a=r%100;if(a>20||a<10)switch(a%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},ez={ordinalNumber:Zq,era:yh({values:Gq,defaultWidth:"wide"}),quarter:yh({values:Wq,defaultWidth:"wide",argumentCallback:e=>e-1}),month:yh({values:Xq,defaultWidth:"wide"}),day:yh({values:Yq,defaultWidth:"wide"}),dayPeriod:yh({values:$q,defaultWidth:"wide",formattingValues:Jq,defaultFormattingWidth:"wide"})};function _h(e){return(t,r={})=>{const a=r.width,n=a&&e.matchPatterns[a]||e.matchPatterns[e.defaultMatchWidth],s=t.match(n);if(!s)return null;const l=s[0],A=a&&e.parsePatterns[a]||e.parsePatterns[e.defaultParseWidth],u=Array.isArray(A)?rz(A,g=>g.test(l)):tz(A,g=>g.test(l));let f;f=e.valueCallback?e.valueCallback(u):u,f=r.valueCallback?r.valueCallback(f):f;const h=t.slice(l.length);return{value:f,rest:h}}}function tz(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function rz(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function az(e){return(t,r={})=>{const a=t.match(e.matchPattern);if(!a)return null;const n=a[0],s=t.match(e.parsePattern);if(!s)return null;let l=e.valueCallback?e.valueCallback(s[0]):s[0];l=r.valueCallback?r.valueCallback(l):l;const A=t.slice(n.length);return{value:l,rest:A}}}const nz=/^(\d+)(th|st|nd|rd)?/i,sz=/\d+/i,iz={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},lz={any:[/^b/i,/^(a|c)/i]},oz={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Az={any:[/1/i,/2/i,/3/i,/4/i]},cz={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},uz={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},dz={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},fz={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},hz={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},pz={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},gz={ordinalNumber:az({matchPattern:nz,parsePattern:sz,valueCallback:e=>parseInt(e,10)}),era:_h({matchPatterns:iz,defaultMatchWidth:"wide",parsePatterns:lz,defaultParseWidth:"any"}),quarter:_h({matchPatterns:oz,defaultMatchWidth:"wide",parsePatterns:Az,defaultParseWidth:"any",valueCallback:e=>e+1}),month:_h({matchPatterns:cz,defaultMatchWidth:"wide",parsePatterns:uz,defaultParseWidth:"any"}),day:_h({matchPatterns:dz,defaultMatchWidth:"wide",parsePatterns:fz,defaultParseWidth:"any"}),dayPeriod:_h({matchPatterns:hz,defaultMatchWidth:"any",parsePatterns:pz,defaultParseWidth:"any"})},EN={code:"en-US",formatDistance:Mq,formatLong:qq,formatRelative:Vq,localize:ez,match:gz,options:{weekStartsOn:0,firstWeekContainsDate:1}};function mz(e,t){const r=Ls(e,t?.in);return Dq(r,Oq(r))+1}function NN(e,t){const r=Ls(e,t?.in),a=+yf(r)-+Iq(r);return Math.round(a/kN)+1}function uy(e,t){const r=Ls(e,t?.in),a=r.getFullYear(),n=Ff(),s=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,l=si(t?.in||e,0);l.setFullYear(a+1,0,s),l.setHours(0,0,0,0);const A=Wu(l,t),u=si(t?.in||e,0);u.setFullYear(a,0,s),u.setHours(0,0,0,0);const f=Wu(u,t);return+r>=+A?a+1:+r>=+f?a:a-1}function xz(e,t){const r=Ff(),a=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,n=uy(e,t),s=si(t?.in||e,0);return s.setFullYear(n,0,a),s.setHours(0,0,0,0),Wu(s,t)}function FN(e,t){const r=Ls(e,t?.in),a=+Wu(r,t)-+xz(r,t);return Math.round(a/kN)+1}function Ka(e,t){const r=e<0?"-":"",a=Math.abs(e).toString().padStart(t,"0");return r+a}const yu={y(e,t){const r=e.getFullYear(),a=r>0?r:1-r;return Ka(t==="yy"?a%100:a,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Ka(r+1,2)},d(e,t){return Ka(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Ka(e.getHours()%12||12,t.length)},H(e,t){return Ka(e.getHours(),t.length)},m(e,t){return Ka(e.getMinutes(),t.length)},s(e,t){return Ka(e.getSeconds(),t.length)},S(e,t){const r=t.length,a=e.getMilliseconds(),n=Math.trunc(a*Math.pow(10,r-3));return Ka(n,t.length)}},Qd={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},z4={G:function(e,t,r){const a=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(a,{width:"abbreviated"});case"GGGGG":return r.era(a,{width:"narrow"});default:return r.era(a,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const a=e.getFullYear(),n=a>0?a:1-a;return r.ordinalNumber(n,{unit:"year"})}return yu.y(e,t)},Y:function(e,t,r,a){const n=uy(e,a),s=n>0?n:1-n;if(t==="YY"){const l=s%100;return Ka(l,2)}return t==="Yo"?r.ordinalNumber(s,{unit:"year"}):Ka(s,t.length)},R:function(e,t){const r=SN(e);return Ka(r,t.length)},u:function(e,t){const r=e.getFullYear();return Ka(r,t.length)},Q:function(e,t,r){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(a);case"QQ":return Ka(a,2);case"Qo":return r.ordinalNumber(a,{unit:"quarter"});case"QQQ":return r.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(a,{width:"narrow",context:"formatting"});default:return r.quarter(a,{width:"wide",context:"formatting"})}},q:function(e,t,r){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(a);case"qq":return Ka(a,2);case"qo":return r.ordinalNumber(a,{unit:"quarter"});case"qqq":return r.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(a,{width:"narrow",context:"standalone"});default:return r.quarter(a,{width:"wide",context:"standalone"})}},M:function(e,t,r){const a=e.getMonth();switch(t){case"M":case"MM":return yu.M(e,t);case"Mo":return r.ordinalNumber(a+1,{unit:"month"});case"MMM":return r.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(a,{width:"narrow",context:"formatting"});default:return r.month(a,{width:"wide",context:"formatting"})}},L:function(e,t,r){const a=e.getMonth();switch(t){case"L":return String(a+1);case"LL":return Ka(a+1,2);case"Lo":return r.ordinalNumber(a+1,{unit:"month"});case"LLL":return r.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(a,{width:"narrow",context:"standalone"});default:return r.month(a,{width:"wide",context:"standalone"})}},w:function(e,t,r,a){const n=FN(e,a);return t==="wo"?r.ordinalNumber(n,{unit:"week"}):Ka(n,t.length)},I:function(e,t,r){const a=NN(e);return t==="Io"?r.ordinalNumber(a,{unit:"week"}):Ka(a,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):yu.d(e,t)},D:function(e,t,r){const a=mz(e);return t==="Do"?r.ordinalNumber(a,{unit:"dayOfYear"}):Ka(a,t.length)},E:function(e,t,r){const a=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(a,{width:"short",context:"formatting"});default:return r.day(a,{width:"wide",context:"formatting"})}},e:function(e,t,r,a){const n=e.getDay(),s=(n-a.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return Ka(s,2);case"eo":return r.ordinalNumber(s,{unit:"day"});case"eee":return r.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(n,{width:"short",context:"formatting"});default:return r.day(n,{width:"wide",context:"formatting"})}},c:function(e,t,r,a){const n=e.getDay(),s=(n-a.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return Ka(s,t.length);case"co":return r.ordinalNumber(s,{unit:"day"});case"ccc":return r.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(n,{width:"narrow",context:"standalone"});case"cccccc":return r.day(n,{width:"short",context:"standalone"});default:return r.day(n,{width:"wide",context:"standalone"})}},i:function(e,t,r){const a=e.getDay(),n=a===0?7:a;switch(t){case"i":return String(n);case"ii":return Ka(n,t.length);case"io":return r.ordinalNumber(n,{unit:"day"});case"iii":return r.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(a,{width:"short",context:"formatting"});default:return r.day(a,{width:"wide",context:"formatting"})}},a:function(e,t,r){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(n,{width:"narrow",context:"formatting"});default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(e,t,r){const a=e.getHours();let n;switch(a===12?n=Qd.noon:a===0?n=Qd.midnight:n=a/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(n,{width:"narrow",context:"formatting"});default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(e,t,r){const a=e.getHours();let n;switch(a>=17?n=Qd.evening:a>=12?n=Qd.afternoon:a>=4?n=Qd.morning:n=Qd.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(n,{width:"narrow",context:"formatting"});default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let a=e.getHours()%12;return a===0&&(a=12),r.ordinalNumber(a,{unit:"hour"})}return yu.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):yu.H(e,t)},K:function(e,t,r){const a=e.getHours()%12;return t==="Ko"?r.ordinalNumber(a,{unit:"hour"}):Ka(a,t.length)},k:function(e,t,r){let a=e.getHours();return a===0&&(a=24),t==="ko"?r.ordinalNumber(a,{unit:"hour"}):Ka(a,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):yu.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):yu.s(e,t)},S:function(e,t){return yu.S(e,t)},X:function(e,t,r){const a=e.getTimezoneOffset();if(a===0)return"Z";switch(t){case"X":return G4(a);case"XXXX":case"XX":return v0(a);default:return v0(a,":")}},x:function(e,t,r){const a=e.getTimezoneOffset();switch(t){case"x":return G4(a);case"xxxx":case"xx":return v0(a);default:return v0(a,":")}},O:function(e,t,r){const a=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+V4(a,":");default:return"GMT"+v0(a,":")}},z:function(e,t,r){const a=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+V4(a,":");default:return"GMT"+v0(a,":")}},t:function(e,t,r){const a=Math.trunc(+e/1e3);return Ka(a,t.length)},T:function(e,t,r){return Ka(+e,t.length)}};function V4(e,t=""){const r=e>0?"-":"+",a=Math.abs(e),n=Math.trunc(a/60),s=a%60;return s===0?r+String(n):r+String(n)+t+Ka(s,2)}function G4(e,t){return e%60===0?(e>0?"-":"+")+Ka(Math.abs(e)/60,2):v0(e,t)}function v0(e,t=""){const r=e>0?"-":"+",a=Math.abs(e),n=Ka(Math.trunc(a/60),2),s=Ka(a%60,2);return r+n+t+s}const W4=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},TN=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},bz=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],a=r[1],n=r[2];if(!n)return W4(e,t);let s;switch(a){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;default:s=t.dateTime({width:"full"});break}return s.replace("{{date}}",W4(a,t)).replace("{{time}}",TN(n,t))},vw={p:TN,P:bz},vz=/^D+$/,wz=/^Y+$/,yz=["D","DD","YY","YYYY"];function LN(e){return vz.test(e)}function UN(e){return wz.test(e)}function ww(e,t,r){const a=_z(e,t,r);if(console.warn(a),yz.includes(e))throw new RangeError(a)}function _z(e,t,r){const a=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${a} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Bz=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,kz=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Cz=/^'([^]*?)'?$/,Sz=/''/g,Ez=/[a-zA-Z]/;function av(e,t,r){const a=Ff(),n=a.locale??EN,s=a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,l=a.weekStartsOn??a.locale?.options?.weekStartsOn??0,A=Ls(e,r?.in);if(!bw(A))throw new RangeError("Invalid time value");let u=t.match(kz).map(h=>{const g=h[0];if(g==="p"||g==="P"){const x=vw[g];return x(h,n.formatLong)}return h}).join("").match(Bz).map(h=>{if(h==="''")return{isToken:!1,value:"'"};const g=h[0];if(g==="'")return{isToken:!1,value:Nz(h)};if(z4[g])return{isToken:!0,value:h};if(g.match(Ez))throw new RangeError("Format string contains an unescaped latin alphabet character `"+g+"`");return{isToken:!1,value:h}});n.localize.preprocessor&&(u=n.localize.preprocessor(A,u));const f={firstWeekContainsDate:s,weekStartsOn:l,locale:n};return u.map(h=>{if(!h.isToken)return h.value;const g=h.value;(UN(g)||LN(g))&&ww(g,t,String(e));const x=z4[g[0]];return x(A,g,n.localize,f)}).join("")}function Nz(e){const t=e.match(Cz);return t?t[1].replace(Sz,"'"):e}function Fz(){return Object.assign({},Ff())}function Tz(e,t){const r=Ls(e,t?.in).getDay();return r===0?7:r}function Lz(e,t){const r=Uz(t)?new t(0):si(t,0);return r.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),r.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),r}function Uz(e){return typeof e=="function"&&e.prototype?.constructor===e}const jz=10;class jN{subPriority=0;validate(t,r){return!0}}class Dz extends jN{constructor(t,r,a,n,s){super(),this.value=t,this.validateValue=r,this.setValue=a,this.priority=n,s&&(this.subPriority=s)}validate(t,r){return this.validateValue(t,this.value,r)}set(t,r,a){return this.setValue(t,r,this.value,a)}}class Iz extends jN{priority=jz;subPriority=-1;constructor(t,r){super(),this.context=t||(a=>si(r,a))}set(t,r){return r.timestampIsSet?t:si(t,Lz(t,this.context))}}let Qa=class{run(t,r,a,n){const s=this.parse(t,r,a,n);return s?{setter:new Dz(s.value,this.validate,this.set,this.priority,this.subPriority),rest:s.rest}:null}validate(t,r,a){return!0}};class Qz extends Qa{priority=140;parse(t,r,a){switch(r){case"G":case"GG":case"GGG":return a.era(t,{width:"abbreviated"})||a.era(t,{width:"narrow"});case"GGGGG":return a.era(t,{width:"narrow"});default:return a.era(t,{width:"wide"})||a.era(t,{width:"abbreviated"})||a.era(t,{width:"narrow"})}}set(t,r,a){return r.era=a,t.setFullYear(a,0,1),t.setHours(0,0,0,0),t}incompatibleTokens=["R","u","t","T"]}const gs={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},$A={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function ms(e,t){return e&&{value:t(e.value),rest:e.rest}}function Mn(e,t){const r=t.match(e);return r?{value:parseInt(r[0],10),rest:t.slice(r[0].length)}:null}function JA(e,t){const r=t.match(e);if(!r)return null;if(r[0]==="Z")return{value:0,rest:t.slice(1)};const a=r[1]==="+"?1:-1,n=r[2]?parseInt(r[2],10):0,s=r[3]?parseInt(r[3],10):0,l=r[5]?parseInt(r[5],10):0;return{value:a*(n*Tq+s*Fq+l*Lq),rest:t.slice(r[0].length)}}function DN(e){return Mn(gs.anyDigitsSigned,e)}function ns(e,t){switch(e){case 1:return Mn(gs.singleDigit,t);case 2:return Mn(gs.twoDigits,t);case 3:return Mn(gs.threeDigits,t);case 4:return Mn(gs.fourDigits,t);default:return Mn(new RegExp("^\\d{1,"+e+"}"),t)}}function yx(e,t){switch(e){case 1:return Mn(gs.singleDigitSigned,t);case 2:return Mn(gs.twoDigitsSigned,t);case 3:return Mn(gs.threeDigitsSigned,t);case 4:return Mn(gs.fourDigitsSigned,t);default:return Mn(new RegExp("^-?\\d{1,"+e+"}"),t)}}function dy(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;default:return 0}}function IN(e,t){const r=t>0,a=r?t:1-t;let n;if(a<=50)n=e||100;else{const s=a+50,l=Math.trunc(s/100)*100,A=e>=s%100;n=e+l-(A?100:0)}return r?n:1-n}function QN(e){return e%400===0||e%4===0&&e%100!==0}class Oz extends Qa{priority=130;incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"];parse(t,r,a){const n=s=>({year:s,isTwoDigitYear:r==="yy"});switch(r){case"y":return ms(ns(4,t),n);case"yo":return ms(a.ordinalNumber(t,{unit:"year"}),n);default:return ms(ns(r.length,t),n)}}validate(t,r){return r.isTwoDigitYear||r.year>0}set(t,r,a){const n=t.getFullYear();if(a.isTwoDigitYear){const l=IN(a.year,n);return t.setFullYear(l,0,1),t.setHours(0,0,0,0),t}const s=!("era"in r)||r.era===1?a.year:1-a.year;return t.setFullYear(s,0,1),t.setHours(0,0,0,0),t}}class Rz extends Qa{priority=130;parse(t,r,a){const n=s=>({year:s,isTwoDigitYear:r==="YY"});switch(r){case"Y":return ms(ns(4,t),n);case"Yo":return ms(a.ordinalNumber(t,{unit:"year"}),n);default:return ms(ns(r.length,t),n)}}validate(t,r){return r.isTwoDigitYear||r.year>0}set(t,r,a,n){const s=uy(t,n);if(a.isTwoDigitYear){const A=IN(a.year,s);return t.setFullYear(A,0,n.firstWeekContainsDate),t.setHours(0,0,0,0),Wu(t,n)}const l=!("era"in r)||r.era===1?a.year:1-a.year;return t.setFullYear(l,0,n.firstWeekContainsDate),t.setHours(0,0,0,0),Wu(t,n)}incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]}class Mz extends Qa{priority=130;parse(t,r){return yx(r==="R"?4:r.length,t)}set(t,r,a){const n=si(t,0);return n.setFullYear(a,0,4),n.setHours(0,0,0,0),yf(n)}incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]}class Hz extends Qa{priority=130;parse(t,r){return yx(r==="u"?4:r.length,t)}set(t,r,a){return t.setFullYear(a,0,1),t.setHours(0,0,0,0),t}incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]}class Pz extends Qa{priority=120;parse(t,r,a){switch(r){case"Q":case"QQ":return ns(r.length,t);case"Qo":return a.ordinalNumber(t,{unit:"quarter"});case"QQQ":return a.quarter(t,{width:"abbreviated",context:"formatting"})||a.quarter(t,{width:"narrow",context:"formatting"});case"QQQQQ":return a.quarter(t,{width:"narrow",context:"formatting"});default:return a.quarter(t,{width:"wide",context:"formatting"})||a.quarter(t,{width:"abbreviated",context:"formatting"})||a.quarter(t,{width:"narrow",context:"formatting"})}}validate(t,r){return r>=1&&r<=4}set(t,r,a){return t.setMonth((a-1)*3,1),t.setHours(0,0,0,0),t}incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]}class Kz extends Qa{priority=120;parse(t,r,a){switch(r){case"q":case"qq":return ns(r.length,t);case"qo":return a.ordinalNumber(t,{unit:"quarter"});case"qqq":return a.quarter(t,{width:"abbreviated",context:"standalone"})||a.quarter(t,{width:"narrow",context:"standalone"});case"qqqqq":return a.quarter(t,{width:"narrow",context:"standalone"});default:return a.quarter(t,{width:"wide",context:"standalone"})||a.quarter(t,{width:"abbreviated",context:"standalone"})||a.quarter(t,{width:"narrow",context:"standalone"})}}validate(t,r){return r>=1&&r<=4}set(t,r,a){return t.setMonth((a-1)*3,1),t.setHours(0,0,0,0),t}incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]}class qz extends Qa{incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"];priority=110;parse(t,r,a){const n=s=>s-1;switch(r){case"M":return ms(Mn(gs.month,t),n);case"MM":return ms(ns(2,t),n);case"Mo":return ms(a.ordinalNumber(t,{unit:"month"}),n);case"MMM":return a.month(t,{width:"abbreviated",context:"formatting"})||a.month(t,{width:"narrow",context:"formatting"});case"MMMMM":return a.month(t,{width:"narrow",context:"formatting"});default:return a.month(t,{width:"wide",context:"formatting"})||a.month(t,{width:"abbreviated",context:"formatting"})||a.month(t,{width:"narrow",context:"formatting"})}}validate(t,r){return r>=0&&r<=11}set(t,r,a){return t.setMonth(a,1),t.setHours(0,0,0,0),t}}class zz extends Qa{priority=110;parse(t,r,a){const n=s=>s-1;switch(r){case"L":return ms(Mn(gs.month,t),n);case"LL":return ms(ns(2,t),n);case"Lo":return ms(a.ordinalNumber(t,{unit:"month"}),n);case"LLL":return a.month(t,{width:"abbreviated",context:"standalone"})||a.month(t,{width:"narrow",context:"standalone"});case"LLLLL":return a.month(t,{width:"narrow",context:"standalone"});default:return a.month(t,{width:"wide",context:"standalone"})||a.month(t,{width:"abbreviated",context:"standalone"})||a.month(t,{width:"narrow",context:"standalone"})}}validate(t,r){return r>=0&&r<=11}set(t,r,a){return t.setMonth(a,1),t.setHours(0,0,0,0),t}incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]}function Vz(e,t,r){const a=Ls(e,r?.in),n=FN(a,r)-t;return a.setDate(a.getDate()-n*7),Ls(a,r?.in)}class Gz extends Qa{priority=100;parse(t,r,a){switch(r){case"w":return Mn(gs.week,t);case"wo":return a.ordinalNumber(t,{unit:"week"});default:return ns(r.length,t)}}validate(t,r){return r>=1&&r<=53}set(t,r,a,n){return Wu(Vz(t,a,n),n)}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]}function Wz(e,t,r){const a=Ls(e,r?.in),n=NN(a,r)-t;return a.setDate(a.getDate()-n*7),a}class Xz extends Qa{priority=100;parse(t,r,a){switch(r){case"I":return Mn(gs.week,t);case"Io":return a.ordinalNumber(t,{unit:"week"});default:return ns(r.length,t)}}validate(t,r){return r>=1&&r<=53}set(t,r,a){return yf(Wz(t,a))}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]}const Yz=[31,28,31,30,31,30,31,31,30,31,30,31],$z=[31,29,31,30,31,30,31,31,30,31,30,31];class Jz extends Qa{priority=90;subPriority=1;parse(t,r,a){switch(r){case"d":return Mn(gs.date,t);case"do":return a.ordinalNumber(t,{unit:"date"});default:return ns(r.length,t)}}validate(t,r){const a=t.getFullYear(),n=QN(a),s=t.getMonth();return n?r>=1&&r<=$z[s]:r>=1&&r<=Yz[s]}set(t,r,a){return t.setDate(a),t.setHours(0,0,0,0),t}incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]}class Zz extends Qa{priority=90;subpriority=1;parse(t,r,a){switch(r){case"D":case"DD":return Mn(gs.dayOfYear,t);case"Do":return a.ordinalNumber(t,{unit:"date"});default:return ns(r.length,t)}}validate(t,r){const a=t.getFullYear();return QN(a)?r>=1&&r<=366:r>=1&&r<=365}set(t,r,a){return t.setMonth(0,a),t.setHours(0,0,0,0),t}incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]}function fy(e,t,r){const a=Ff(),n=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??a.weekStartsOn??a.locale?.options?.weekStartsOn??0,s=Ls(e,r?.in),l=s.getDay(),u=(t%7+7)%7,f=7-n,h=t<0||t>6?t-(l+f)%7:(u+f)%7-(l+f)%7;return CN(s,h,r)}class eV extends Qa{priority=90;parse(t,r,a){switch(r){case"E":case"EE":case"EEE":return a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"});case"EEEEE":return a.day(t,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"});default:return a.day(t,{width:"wide",context:"formatting"})||a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"})}}validate(t,r){return r>=0&&r<=6}set(t,r,a,n){return t=fy(t,a,n),t.setHours(0,0,0,0),t}incompatibleTokens=["D","i","e","c","t","T"]}class tV extends Qa{priority=90;parse(t,r,a,n){const s=l=>{const A=Math.floor((l-1)/7)*7;return(l+n.weekStartsOn+6)%7+A};switch(r){case"e":case"ee":return ms(ns(r.length,t),s);case"eo":return ms(a.ordinalNumber(t,{unit:"day"}),s);case"eee":return a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"});case"eeeee":return a.day(t,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"});default:return a.day(t,{width:"wide",context:"formatting"})||a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"})}}validate(t,r){return r>=0&&r<=6}set(t,r,a,n){return t=fy(t,a,n),t.setHours(0,0,0,0),t}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]}class rV extends Qa{priority=90;parse(t,r,a,n){const s=l=>{const A=Math.floor((l-1)/7)*7;return(l+n.weekStartsOn+6)%7+A};switch(r){case"c":case"cc":return ms(ns(r.length,t),s);case"co":return ms(a.ordinalNumber(t,{unit:"day"}),s);case"ccc":return a.day(t,{width:"abbreviated",context:"standalone"})||a.day(t,{width:"short",context:"standalone"})||a.day(t,{width:"narrow",context:"standalone"});case"ccccc":return a.day(t,{width:"narrow",context:"standalone"});case"cccccc":return a.day(t,{width:"short",context:"standalone"})||a.day(t,{width:"narrow",context:"standalone"});default:return a.day(t,{width:"wide",context:"standalone"})||a.day(t,{width:"abbreviated",context:"standalone"})||a.day(t,{width:"short",context:"standalone"})||a.day(t,{width:"narrow",context:"standalone"})}}validate(t,r){return r>=0&&r<=6}set(t,r,a,n){return t=fy(t,a,n),t.setHours(0,0,0,0),t}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]}function aV(e,t,r){const a=Ls(e,r?.in),n=Tz(a,r),s=t-n;return CN(a,s,r)}class nV extends Qa{priority=90;parse(t,r,a){const n=s=>s===0?7:s;switch(r){case"i":case"ii":return ns(r.length,t);case"io":return a.ordinalNumber(t,{unit:"day"});case"iii":return ms(a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"}),n);case"iiiii":return ms(a.day(t,{width:"narrow",context:"formatting"}),n);case"iiiiii":return ms(a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"}),n);default:return ms(a.day(t,{width:"wide",context:"formatting"})||a.day(t,{width:"abbreviated",context:"formatting"})||a.day(t,{width:"short",context:"formatting"})||a.day(t,{width:"narrow",context:"formatting"}),n)}}validate(t,r){return r>=1&&r<=7}set(t,r,a){return t=aV(t,a),t.setHours(0,0,0,0),t}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]}class sV extends Qa{priority=80;parse(t,r,a){switch(r){case"a":case"aa":case"aaa":return a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaaa":return a.dayPeriod(t,{width:"narrow",context:"formatting"});default:return a.dayPeriod(t,{width:"wide",context:"formatting"})||a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,r,a){return t.setHours(dy(a),0,0,0),t}incompatibleTokens=["b","B","H","k","t","T"]}class iV extends Qa{priority=80;parse(t,r,a){switch(r){case"b":case"bb":case"bbb":return a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbbb":return a.dayPeriod(t,{width:"narrow",context:"formatting"});default:return a.dayPeriod(t,{width:"wide",context:"formatting"})||a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,r,a){return t.setHours(dy(a),0,0,0),t}incompatibleTokens=["a","B","H","k","t","T"]}class lV extends Qa{priority=80;parse(t,r,a){switch(r){case"B":case"BB":case"BBB":return a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBBB":return a.dayPeriod(t,{width:"narrow",context:"formatting"});default:return a.dayPeriod(t,{width:"wide",context:"formatting"})||a.dayPeriod(t,{width:"abbreviated",context:"formatting"})||a.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,r,a){return t.setHours(dy(a),0,0,0),t}incompatibleTokens=["a","b","t","T"]}class oV extends Qa{priority=70;parse(t,r,a){switch(r){case"h":return Mn(gs.hour12h,t);case"ho":return a.ordinalNumber(t,{unit:"hour"});default:return ns(r.length,t)}}validate(t,r){return r>=1&&r<=12}set(t,r,a){const n=t.getHours()>=12;return n&&a<12?t.setHours(a+12,0,0,0):!n&&a===12?t.setHours(0,0,0,0):t.setHours(a,0,0,0),t}incompatibleTokens=["H","K","k","t","T"]}class AV extends Qa{priority=70;parse(t,r,a){switch(r){case"H":return Mn(gs.hour23h,t);case"Ho":return a.ordinalNumber(t,{unit:"hour"});default:return ns(r.length,t)}}validate(t,r){return r>=0&&r<=23}set(t,r,a){return t.setHours(a,0,0,0),t}incompatibleTokens=["a","b","h","K","k","t","T"]}class cV extends Qa{priority=70;parse(t,r,a){switch(r){case"K":return Mn(gs.hour11h,t);case"Ko":return a.ordinalNumber(t,{unit:"hour"});default:return ns(r.length,t)}}validate(t,r){return r>=0&&r<=11}set(t,r,a){return t.getHours()>=12&&a<12?t.setHours(a+12,0,0,0):t.setHours(a,0,0,0),t}incompatibleTokens=["h","H","k","t","T"]}class uV extends Qa{priority=70;parse(t,r,a){switch(r){case"k":return Mn(gs.hour24h,t);case"ko":return a.ordinalNumber(t,{unit:"hour"});default:return ns(r.length,t)}}validate(t,r){return r>=1&&r<=24}set(t,r,a){const n=a<=24?a%24:a;return t.setHours(n,0,0,0),t}incompatibleTokens=["a","b","h","H","K","t","T"]}class dV extends Qa{priority=60;parse(t,r,a){switch(r){case"m":return Mn(gs.minute,t);case"mo":return a.ordinalNumber(t,{unit:"minute"});default:return ns(r.length,t)}}validate(t,r){return r>=0&&r<=59}set(t,r,a){return t.setMinutes(a,0,0),t}incompatibleTokens=["t","T"]}class fV extends Qa{priority=50;parse(t,r,a){switch(r){case"s":return Mn(gs.second,t);case"so":return a.ordinalNumber(t,{unit:"second"});default:return ns(r.length,t)}}validate(t,r){return r>=0&&r<=59}set(t,r,a){return t.setSeconds(a,0),t}incompatibleTokens=["t","T"]}class hV extends Qa{priority=30;parse(t,r){const a=n=>Math.trunc(n*Math.pow(10,-r.length+3));return ms(ns(r.length,t),a)}set(t,r,a){return t.setMilliseconds(a),t}incompatibleTokens=["t","T"]}class pV extends Qa{priority=10;parse(t,r){switch(r){case"X":return JA($A.basicOptionalMinutes,t);case"XX":return JA($A.basic,t);case"XXXX":return JA($A.basicOptionalSeconds,t);case"XXXXX":return JA($A.extendedOptionalSeconds,t);default:return JA($A.extended,t)}}set(t,r,a){return r.timestampIsSet?t:si(t,t.getTime()-wx(t)-a)}incompatibleTokens=["t","T","x"]}class gV extends Qa{priority=10;parse(t,r){switch(r){case"x":return JA($A.basicOptionalMinutes,t);case"xx":return JA($A.basic,t);case"xxxx":return JA($A.basicOptionalSeconds,t);case"xxxxx":return JA($A.extendedOptionalSeconds,t);default:return JA($A.extended,t)}}set(t,r,a){return r.timestampIsSet?t:si(t,t.getTime()-wx(t)-a)}incompatibleTokens=["t","T","X"]}class mV extends Qa{priority=40;parse(t){return DN(t)}set(t,r,a){return[si(t,a*1e3),{timestampIsSet:!0}]}incompatibleTokens="*"}class xV extends Qa{priority=20;parse(t){return DN(t)}set(t,r,a){return[si(t,a),{timestampIsSet:!0}]}incompatibleTokens="*"}const bV={G:new Qz,y:new Oz,Y:new Rz,R:new Mz,u:new Hz,Q:new Pz,q:new Kz,M:new qz,L:new zz,w:new Gz,I:new Xz,d:new Jz,D:new Zz,E:new eV,e:new tV,c:new rV,i:new nV,a:new sV,b:new iV,B:new lV,h:new oV,H:new AV,K:new cV,k:new uV,m:new dV,s:new fV,S:new hV,X:new pV,x:new gV,t:new mV,T:new xV},vV=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,wV=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,yV=/^'([^]*?)'?$/,_V=/''/g,BV=/\S/,kV=/[a-zA-Z]/;function X4(e,t,r,a){const n=()=>si(r,NaN),s=Fz(),l=s.locale??EN,A=s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,u=s.weekStartsOn??s.locale?.options?.weekStartsOn??0;if(!t)return e?n():Ls(r,a?.in);const f={firstWeekContainsDate:A,weekStartsOn:u,locale:l},h=[new Iz(a?.in,r)],g=t.match(wV).map(B=>{const k=B[0];if(k in vw){const N=vw[k];return N(B,l.formatLong)}return B}).join("").match(vV),x=[];for(let B of g){UN(B)&&ww(B,t,e),LN(B)&&ww(B,t,e);const k=B[0],N=bV[k];if(N){const{incompatibleTokens:S}=N;if(Array.isArray(S)){const T=x.find(U=>S.includes(U.token)||U.token===k);if(T)throw new RangeError(`The format string mustn't contain \`${T.fullToken}\` and \`${B}\` at the same time`)}else if(N.incompatibleTokens==="*"&&x.length>0)throw new RangeError(`The format string mustn't contain \`${B}\` and any other token at the same time`);x.push({token:k,fullToken:B});const O=N.run(e,B,l.match,f);if(!O)return n();h.push(O.setter),e=O.rest}else{if(k.match(kV))throw new RangeError("Format string contains an unescaped latin alphabet character `"+k+"`");if(B==="''"?B="'":k==="'"&&(B=CV(B)),e.indexOf(B)===0)e=e.slice(B.length);else return n()}}if(e.length>0&&BV.test(e))return n();const m=h.map(B=>B.priority).sort((B,k)=>k-B).filter((B,k,N)=>N.indexOf(B)===k).map(B=>h.filter(k=>k.priority===B).sort((k,N)=>N.subPriority-k.subPriority)).map(B=>B[0]);let w=Ls(r,a?.in);if(isNaN(+w))return n();const v={};for(const B of m){if(!B.validate(w,f))return n();const k=B.set(w,v,f);Array.isArray(k)?(w=k[0],Object.assign(v,k[1])):w=k}return w}function CV(e){return e.match(yV)[1].replace(_V,"'")}const ON={Period:[{id:"MMM.YYYY",label:"MMM.YYYY (e.g. 001.2025)",description:"Converts 001.2025 to 2025-01",apply:e=>{if(typeof e!="string")return e;const t=e.match(/^(\d{3})\.(\d{4})$/);if(t){const r=parseInt(t[1],10);return`${t[2]}-${r.toString().padStart(2,"0")}`}return e}},{id:"YYYY-MM",label:"YYYY-MM (ISO)",description:"Standard ISO format",apply:e=>e},{id:"MM.YYYY",label:"MM.YYYY / MM-YYYY (e.g. 01.2025)",description:"Converts 01.2025 or 01-2025 to 2025-01",apply:e=>{if(typeof e!="string")return e;const t=String(e).trim().match(/^(\d{1,2})[.-](\d{4})$/);if(t){const r=parseInt(t[1],10);return`${t[2]}-${r.toString().padStart(2,"0")}`}return e}}],PostingDate:[{id:"DD.MM.YYYY",label:"DD.MM.YYYY",description:"German date format",apply:e=>{if(typeof e!="string"||e.match(/^\d{4}-\d{2}-\d{2}$/))return e;const t=X4(e,"dd.MM.yyyy",new Date);return bw(t)?av(t,"yyyy-MM-dd"):e}},{id:"MM/DD/YYYY",label:"MM/DD/YYYY",description:"US date format",apply:e=>{if(typeof e!="string")return e;const t=X4(e,"MM/dd/yyyy",new Date);return bw(t)?av(t,"yyyy-MM-dd"):e}},{id:"ExcelSerial",label:"Excel Serial Number",description:"Number like 45321",apply:e=>{const t=Number(e);if(!isNaN(t)&&t>2e4){const r=new Date((t-25569)*86400*1e3);return av(r,"yyyy-MM-dd")}return e}}],...["VendorName","VendorId","DocumentId","CostCenter","Category","SubCategory","Service","System","Description"].reduce((e,t)=>({...e,[t]:[{id:"Trim",label:"Trim Whitespace",description:"Removes leading and trailing spaces",apply:r=>String(r||"").trim()},{id:"UpperCase",label:"UPPER CASE",description:"Converts to uppercase",apply:r=>String(r||"").toUpperCase()},{id:"LowerCase",label:"lower case",description:"Converts to lowercase",apply:r=>String(r||"").toLowerCase()},{id:"TitleCase",label:"Title Case",description:"Capitalize First Letters",apply:r=>String(r||"").replace(/\w\S*/g,a=>a.charAt(0).toUpperCase()+a.substr(1).toLowerCase())}]}),{}),...["Amount","UnitPrice","Quantity"].reduce((e,t)=>({...e,[t]:[{id:"ParseDeCurrency",label:"German Currency (1.234,56)",description:"Parses 1.234,56 to 1234.56",apply:r=>{if(typeof r=="number")return r;if(!r)return 0;const a=String(r).replace(/\./g,"").replace(",","."),n=parseFloat(a);return isNaN(n)?0:n}},{id:"CleanNumber",label:"Clean Number (Remove Symbols)",description:"Keep only digits, dots and minus",apply:r=>{if(typeof r=="number")return r;const a=String(r).replace(/[^0-9.-]/g,""),n=parseFloat(a);return isNaN(n)?0:n}}]}),{})},SV=(e,t,r)=>{const a=ON[r];if(!a)return e;const n=a.find(s=>s.id===t);return n?n.apply(e):e},EV=({sourceColumns:e,targetSchema:t,onConfirm:r,onCancel:a,initialMapping:n})=>{const[s,l]=X.useState(n||{}),A=t.properties,u=t.required||[],f=Object.keys(A).map(m=>({key:m,description:A[m].description,required:u.includes(m)})),h=X.useCallback(()=>{const m={};f.forEach(w=>{const v=e.find(B=>B.toLowerCase()===w.key.toLowerCase()||B.toLowerCase().replace(/[^a-z0-9]/g,"")===w.key.toLowerCase().replace(/[^a-z0-9]/g,""));v&&(m[w.key]={sourceColumn:v,operation:"direct"})}),l(w=>({...w,...m}))},[e,f]);X.useEffect(()=>{if(n&&Object.keys(n).length>0)return;const m=window.setTimeout(()=>{h()},0);return()=>window.clearTimeout(m)},[h,n]);const g=f.filter(m=>m.required).every(m=>{const w=s[m.key];return w?w.sourceColumn==="__CONSTANT__"?!!w.constantValue:w.operation==="concat"&&!w.secondaryColumn?!1:!!w.sourceColumn:!1}),x=()=>f.filter(m=>{if(!m.required)return!1;const w=s[m.key];return w?w.sourceColumn==="__CONSTANT__"?!w.constantValue:w.operation==="concat"&&!w.secondaryColumn?!0:!w.sourceColumn:!0}).length;return c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4 animate-in fade-in duration-200",children:c.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-6xl max-h-[90vh] flex flex-col",children:[c.jsxs("div",{className:"p-4 sm:p-6 border-b border-slate-200 dark:border-slate-700 flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Map Columns & Transforms"}),c.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Match columns and apply necessary format conversions."})]}),c.jsxs("button",{onClick:h,className:"w-full sm:w-auto flex items-center justify-center gap-2 px-3 py-1.5 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors text-sm font-medium",children:[c.jsx(k8,{className:"w-4 h-4"}),"Auto-Map"]})]}),c.jsxs("div",{className:"flex-1 overflow-auto p-4 sm:p-6",children:[c.jsxs("div",{className:"hidden lg:grid grid-cols-[1fr,auto,2fr,1fr] gap-4 items-start mb-2 px-4 text-xs font-bold text-slate-400 uppercase tracking-wider",children:[c.jsx("div",{children:"Required Field"}),c.jsx("div",{className:"w-8"}),c.jsx("div",{children:"Source Configuration"}),c.jsx("div",{children:"Transformation"})]}),c.jsx("div",{className:"space-y-3",children:f.map(m=>{const w=ON[m.key]||[],v=s[m.key],B=v?.operation||"direct";return c.jsxs("div",{className:`
                                    grid grid-cols-1 lg:grid-cols-[1fr,auto,2fr,1fr] gap-3 lg:gap-4 items-start p-4 rounded-xl border transition-colors
                                    ${v?.sourceColumn?"bg-slate-50 dark:bg-slate-900/30 border-slate-200 dark:border-slate-700":m.required?"bg-red-50 dark:bg-red-900/10 border-red-200 dark:border-red-900/30":"bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 opacity-70 hover:opacity-100"}
                                `,children:[c.jsxs("div",{className:"mt-2",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:`font-semibold ${m.required?"text-slate-900 dark:text-white":"text-slate-500 dark:text-slate-400"}`,children:m.key}),m.required&&c.jsx("span",{className:"text-[10px] bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 px-1.5 py-0.5 rounded font-bold uppercase",children:"Required"})]}),c.jsx("div",{className:"text-xs text-slate-500 mt-1 line-clamp-1",title:m.description,children:m.description})]}),c.jsx(p2,{className:`hidden lg:block w-4 h-4 mt-3 ${v?.sourceColumn?"text-blue-500":"text-slate-300"}`}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider lg:hidden",children:"Source Configuration"}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:items-center min-h-10",children:[c.jsxs("select",{value:v?.sourceColumn||"",onChange:k=>{const N=k.target.value;l(S=>{const O={...S};if(N){let T=O[m.key]?.transformId;N==="__CONSTANT__"&&!T&&w.length>0&&(T=w[0].id),O[m.key]={sourceColumn:N,transformId:T,operation:"direct"}}else delete O[m.key];return O})},className:`
                                                    w-full sm:flex-1 h-10 px-3 rounded-lg border text-sm outline-none focus:ring-2 focus:ring-blue-500 transition-all
                                                    ${v?.sourceColumn?"border-blue-200 bg-white dark:bg-slate-900 dark:border-blue-900/50":"border-slate-200 bg-slate-50 dark:bg-slate-800 dark:border-slate-600"}
                                                `,children:[c.jsx("option",{value:"",children:"-- Ignored --"}),c.jsx("option",{value:"__CONSTANT__",className:"font-bold text-blue-600",children:"-- Set Constant Value --"}),c.jsx("optgroup",{label:"Source Columns",children:e.map(k=>c.jsx("option",{value:k,children:k},k))})]}),v?.sourceColumn&&v.sourceColumn!=="__CONSTANT__"&&c.jsxs("div",{className:"flex h-10 sm:h-full w-full sm:w-auto bg-slate-100 dark:bg-slate-700 rounded-lg p-1 border border-slate-200 dark:border-slate-600 items-center flex-wrap sm:flex-nowrap",children:[c.jsx("button",{onClick:()=>l(k=>({...k,[m.key]:{...k[m.key],operation:"direct"}})),className:`h-full px-3 rounded-md text-xs font-bold transition-all flex items-center ${B==="direct"?"bg-white dark:bg-slate-600 shadow-sm text-slate-900 dark:text-white":"text-slate-500 hover:text-slate-700"}`,title:"Direct Mapping",children:"1:1"}),c.jsx("div",{className:"w-px h-4 bg-slate-200 dark:bg-slate-600 mx-0.5"}),c.jsx("button",{onClick:()=>l(k=>({...k,[m.key]:{...k[m.key],operation:"coalesce"}})),className:`h-full px-3 rounded-md text-xs font-bold transition-all flex items-center ${B==="coalesce"?"bg-white dark:bg-slate-600 shadow-sm text-slate-900 dark:text-white":"text-slate-500 hover:text-slate-700"}`,title:"Fallback if empty (Coalesce)",children:"Fallback"}),c.jsx("div",{className:"w-px h-4 bg-slate-200 dark:bg-slate-600 mx-0.5"}),c.jsx("button",{onClick:()=>l(k=>({...k,[m.key]:{...k[m.key],operation:"concat",separator:" "}})),className:`h-full px-3 rounded-md text-xs font-bold transition-all flex items-center ${B==="concat"?"bg-white dark:bg-slate-600 shadow-sm text-slate-900 dark:text-white":"text-slate-500 hover:text-slate-700"}`,title:"Combine Columns (Concat)",children:"Combine"})]})]}),B==="coalesce"&&c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 animate-in slide-in-from-top-2 min-h-10",children:[c.jsx(eB,{className:"w-4 h-4 text-slate-400 rotate-45"}),c.jsx("span",{className:"text-xs font-bold text-slate-400 shrink-0",children:"ELSE USE"}),c.jsxs("select",{value:v?.secondaryColumn||"",onChange:k=>l(N=>({...N,[m.key]:{...N[m.key],secondaryColumn:k.target.value}})),className:"w-full sm:flex-1 h-10 px-3 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 text-sm focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"",children:"-- Select Fallback Column --"}),e.map(k=>c.jsx("option",{value:k,children:k},k))]})]}),B==="concat"&&c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 animate-in slide-in-from-top-2 min-h-10",children:[c.jsx(Io,{className:"w-4 h-4 text-slate-400"}),c.jsx("input",{type:"text",placeholder:"Separator (space)",value:v?.separator??" ",onChange:k=>l(N=>({...N,[m.key]:{...N[m.key],separator:k.target.value}})),className:"w-full sm:w-16 h-10 px-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 text-center text-sm",title:"Separator"}),c.jsx(Io,{className:"w-4 h-4 text-slate-400"}),c.jsxs("select",{value:v?.secondaryColumn||"",onChange:k=>l(N=>({...N,[m.key]:{...N[m.key],secondaryColumn:k.target.value}})),className:"w-full sm:flex-1 h-10 px-3 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 text-sm focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"",children:"-- Select 2nd Column --"}),e.map(k=>c.jsx("option",{value:k,children:k},k))]})]}),v?.sourceColumn==="__CONSTANT__"&&c.jsx("div",{className:"relative animate-in fade-in zoom-in-95 h-10",children:c.jsx("input",{type:"text",placeholder:"Enter constant value...",value:v.constantValue||"",onChange:k=>{const N=k.target.value;l(S=>({...S,[m.key]:{...S[m.key],constantValue:N}}))},className:`
                                                        w-full h-full px-3 rounded-lg border text-sm outline-none focus:ring-2 focus:ring-blue-500 transition-all
                                                        ${v.constantValue?"border-blue-200 bg-white dark:bg-slate-900 dark:border-blue-900/50":"border-red-300 ring-2 ring-red-100 bg-red-50"}
                                                    `})})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider lg:hidden mb-2",children:"Transformation"}),w.length>0&&(v?.sourceColumn||m.key==="Currency")&&c.jsxs("div",{className:"relative h-10",children:[c.jsx(C8,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none"}),c.jsxs("select",{value:v?.transformId||"",onChange:k=>{const N=k.target.value;l(S=>({...S,[m.key]:{...S[m.key],transformId:N||void 0}}))},className:"w-full h-full pl-9 pr-3 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 text-sm focus:ring-2 focus:ring-blue-500 appearance-none",children:[c.jsx("option",{value:"",children:"No Transformation"}),w.map(k=>c.jsx("option",{value:k.id,children:k.label},k.id))]}),c.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none",children:c.jsx(eB,{className:"w-3 h-3 text-slate-400"})})]})]})]},m.key)})})]}),c.jsxs("div",{className:"p-4 sm:p-6 border-t border-slate-200 dark:border-slate-700 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 bg-slate-50 dark:bg-slate-900/50 rounded-b-2xl",children:[c.jsx("button",{onClick:a,className:"px-4 py-2 text-slate-600 hover:text-slate-900 dark:text-slate-400 dark:hover:text-white font-medium transition-colors",children:"Cancel Import"}),c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 sm:gap-4 w-full sm:w-auto",children:[!g&&c.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm font-medium",children:[c.jsx(il,{className:"w-4 h-4"}),x()," required fields missing"]}),c.jsxs("button",{onClick:()=>r(s),disabled:!g,className:`
                                w-full sm:w-auto flex items-center justify-center gap-2 px-6 py-2.5 rounded-xl font-semibold shadow-lg transition-all transform
                                ${g?"bg-blue-600 hover:bg-blue-700 text-white shadow-blue-200 dark:shadow-none hover:-translate-y-0.5":"bg-slate-200 dark:bg-slate-700 text-slate-400 cursor-not-allowed"}
                            `,children:[c.jsx(g2,{className:"w-4 h-4"}),"Confirm Mapping"]})]})]})]})})},NV=({config:e,onImportComplete:t})=>{const{t:r}=tn(),[a,n]=X.useState(!1),[s,l]=X.useState(!1),[A,u]=X.useState(null),[f,h]=X.useState(null),[g]=hr("import_default_mode","append"),[x]=hr("import_auto_save_mappings",!0),[m,w]=X.useState(g),[v,B]=X.useState(!1),[k,N]=X.useState(null),[S,O]=X.useState([]),T=X.useRef(null),[U,D]=hr("excel_mappings_v2",{});X.useEffect(()=>{w(g)},[g,e?.key]);const H=X.useCallback(()=>{if(!e?.schema||typeof e.schema!="object")return null;const ue=e.schema;return!ue.properties||typeof ue.properties!="object"?null:{properties:ue.properties,required:Array.isArray(ue.required)?ue.required:[]}},[e]),j=X.useCallback((ue,Z,Ae)=>{const ve=Object.keys(Ae.properties),G=Se=>Se==null||Se==="";return ue.map(Se=>{const we={};return ve.forEach(F=>{const R=Z[F];if(!R?.sourceColumn)return;let M;if(R.sourceColumn==="__CONSTANT__")M=R.constantValue??"";else{const P=Se[R.sourceColumn],re=R.secondaryColumn?Se[R.secondaryColumn]:void 0;switch(R.operation){case"coalesce":M=G(P)?re:P;break;case"concat":{M=[P,re].filter(Ce=>!G(Ce)).map(Ce=>String(Ce)).join(R.separator??" ");break}default:M=P;break}}R.transformId&&(M=SV(M,R.transformId,F)),we[F]=M}),we})},[]),W=X.useCallback(async ue=>{if(e){if(ue.length===0){u(r("datasource.excel_import.no_valid_data"));return}m==="overwrite"&&e.clearFn&&await e.clearFn(),await e.importFn(ue),h(r("datasource.excel_import.success_msg",{count:ue.length})),t&&t(),window.dispatchEvent(new Event("db-updated"))}},[e,m,t,r]),I=X.useCallback(async ue=>{if(e){l(!0),u(null),h(null);try{const Z=await ue.arrayBuffer(),Ae=gx(Z),ve=Ae.SheetNames[0],G=Ae.Sheets[ve],Se=Jh.sheet_to_json(G);if(Se.length===0){u(r("datasource.excel_import.no_data"));return}const we=Object.keys(Se[0]??{});if(H()){N(Se),O(we),B(!0);return}await W(Se)}catch(Z){const Ae=Z instanceof Error?Z.message:String(Z);u(r("datasource.excel_import.error_reading",{error:Ae}))}finally{l(!1)}}},[e,W,H,r]),Q=X.useCallback(async ue=>{if(!e||!k)return;const Z=H();if(Z){B(!1),l(!0),u(null),h(null);try{const Ae=j(k,ue,Z);x&&D(ve=>({...ve,[e.key]:ue})),await W(Ae)}catch(Ae){const ve=Ae instanceof Error?Ae.message:String(Ae);u(r("datasource.excel_import.import_failed",{error:ve}))}finally{N(null),O([]),l(!1)}}},[j,x,e,W,H,k,D,r]),Y=X.useCallback(()=>{B(!1),N(null),O([])},[]),z=X.useCallback(ue=>{ue.preventDefault(),n(!1);const Z=ue.dataTransfer.files[0];Z&&I(Z)},[I]);return e?c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex bg-slate-100 dark:bg-slate-800 p-1 rounded-lg w-fit",children:[c.jsxs("button",{onClick:()=>w("append"),className:`px-3 py-1.5 text-xs font-bold rounded-md flex items-center gap-2 transition-all ${m==="append"?"bg-white dark:bg-slate-700 shadow text-blue-600 dark:text-blue-300":"text-slate-500 dark:text-slate-400"}`,children:[c.jsx(Im,{className:"w-3.5 h-3.5"})," ",r("datasource.excel_import.append")]}),c.jsxs("button",{onClick:()=>w("overwrite"),className:`px-3 py-1.5 text-xs font-bold rounded-md flex items-center gap-2 transition-all ${m==="overwrite"?"bg-white dark:bg-slate-700 shadow text-red-600 dark:text-red-300":"text-slate-500 dark:text-slate-400"}`,children:[c.jsx(Ic,{className:"w-3.5 h-3.5"})," ",r("datasource.excel_import.overwrite")]})]}),c.jsxs("div",{onDragOver:ue=>{ue.preventDefault(),n(!0)},onDragLeave:()=>n(!1),onDrop:z,onClick:()=>T.current?.click(),className:`
                    relative group border-2 border-dashed rounded-2xl p-8 transition-all cursor-pointer text-center
                    ${a?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-slate-200 dark:border-slate-700 hover:border-slate-400 dark:hover:border-slate-600 hover:bg-slate-50 dark:hover:bg-slate-900/40"}
                    ${s?"opacity-50 pointer-events-none":""}
                `,children:[c.jsx("input",{type:"file",ref:T,onChange:ue=>ue.target.files?.[0]&&I(ue.target.files[0]),accept:".xlsx,.xls,.csv",className:"hidden"}),c.jsxs("div",{className:"flex flex-col items-center gap-3",children:[c.jsx("div",{className:`p-3 rounded-xl transition-colors ${a?"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-300":"bg-slate-100 dark:bg-slate-800 text-slate-400 dark:text-slate-500 group-hover:bg-slate-200 dark:group-hover:bg-slate-700 group-hover:text-slate-600 dark:group-hover:text-slate-300"}`,children:c.jsx(TS,{className:"w-8 h-8"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-bold text-slate-700 dark:text-slate-200",children:r("datasource.smart_import.upload_label")}),c.jsx("p",{className:"text-xs text-slate-400 dark:text-slate-500 mt-1",children:r("datasource.excel_import.drop_hint")})]})]}),s&&c.jsx("div",{className:"absolute inset-0 bg-white/60 dark:bg-slate-900/60 flex items-center justify-center rounded-2xl backdrop-blur-[1px]",children:c.jsxs("div",{className:"flex items-center gap-3 text-blue-600 dark:text-blue-300",children:[c.jsx("div",{className:"w-5 h-5 border-2 border-current border-t-transparent rounded-full animate-spin"}),c.jsx("span",{className:"text-xs font-bold",children:r("datasource.excel_import.processing_file")})]})})]}),A&&c.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 border-2 border-red-100 dark:border-red-800/50 rounded-2xl flex items-start gap-3 text-red-600 dark:text-red-300 text-xs animate-in slide-in-from-top-2 relative",children:[c.jsx(il,{className:"w-5 h-5 shrink-0 mt-0.5"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"font-black uppercase tracking-widest text-[10px] mb-1",children:r("common.error")}),c.jsx("p",{className:"font-medium leading-relaxed",children:A})]}),c.jsx("button",{onClick:()=>u(null),className:"p-1 hover:bg-red-100 dark:hover:bg-red-900/40 rounded-lg transition-colors",children:c.jsx(nl,{className:"w-4 h-4"})})]}),f&&c.jsxs("div",{className:"p-4 bg-emerald-50 dark:bg-emerald-900/20 border-2 border-emerald-100 dark:border-emerald-800/50 rounded-2xl flex items-start gap-3 text-emerald-600 dark:text-emerald-300 text-xs animate-in slide-in-from-top-2 relative",children:[c.jsx(Bf,{className:"w-5 h-5 shrink-0 mt-0.5"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"font-black uppercase tracking-widest text-[10px] mb-1",children:r("common.success")}),c.jsx("p",{className:"font-medium leading-relaxed",children:f})]}),c.jsx("button",{onClick:()=>h(null),className:"p-1 hover:bg-emerald-100 dark:hover:bg-emerald-900/40 rounded-lg transition-colors",children:c.jsx(nl,{className:"w-4 h-4"})})]}),v&&e&&H()&&c.jsx(EV,{sourceColumns:S,targetSchema:H(),initialMapping:U[e.key],onConfirm:ue=>{Q(ue)},onCancel:Y})]}):c.jsx("div",{className:"p-8 text-center bg-slate-50 dark:bg-slate-900/40 border-2 border-dashed border-slate-200 dark:border-slate-700 rounded-2xl",children:c.jsx("p",{className:"text-slate-400 dark:text-slate-500 text-sm",children:r("datasource.excel_import.none_selected")})})};async function FV(e){return new Promise((t,r)=>{const a=new FileReader;a.onload=n=>{try{const s=new Uint8Array(n.target?.result),l=gx(s,{type:"array",cellDates:!0}),A=[];for(const u of l.SheetNames){const f=l.Sheets[u],h=Jh.sheet_to_json(f,{header:1});if(!h||h.length<2)continue;const g=h[0].map(N=>String(N).trim()),x=h.slice(1);let m=u.toLowerCase().replace(/[^a-z0-9_]/g,"_").replace(/^_+|_+$/g,"").replace(/_+/g,"_"),w,v=!0;/^[a-z][a-z0-9_]*$/.test(m)||(/^[0-9]/.test(m)?m="tbl_"+m:m===""&&(m="tbl_unnamed")),m.startsWith("sys_")&&(v=!1,w="Tabellennamen drfen nicht mit 'sys_' beginnen (reserviert).");const B=g.map((N,S)=>{let O=!0,T=!0,U=!1;const D=Math.min(x.length,100);for(let W=0;W<D;W++){const I=x[W][S];if(I==null||I==="")continue;U=!0;const Q=Number(I);if(isNaN(Q)){O=!1,T=!1;break}Number.isInteger(Q)||(O=!1)}let H="TEXT";return U&&(O?H="INTEGER":T&&(H="REAL")),{name:N.toLowerCase().replace(/[^a-z0-9_]/g,"_"),type:H}}),k=x.map(N=>{const S={};return B.forEach((O,T)=>{let U=N[T];U instanceof Date?U=U.toISOString():typeof U=="object"&&U!==null&&(U=JSON.stringify(U)),S[O.name]=U}),S});A.push({sheetName:u,suggestedTableName:m,columns:B,rowCount:x.length,data:k,isValid:v,validationError:w})}t(A)}catch(s){r(s)}},a.onerror=n=>r(n),a.readAsArrayBuffer(e)})}const TV=()=>{const{t:e}=tn(),t=fA("SmartImport"),[r,a]=X.useState(1),[n,s]=X.useState([]),[l,A]=X.useState({tables:0,records:0}),[u,f]=X.useState(!1),[h,g]=X.useState(!1),x=X.useRef(null),m=async v=>{const B=v.target.files?.[0];if(B){f(!0);try{const N=(await FV(B)).map(S=>({sheetName:S.sheetName,tableName:S.suggestedTableName.startsWith("usr_")?S.suggestedTableName:`usr_${S.suggestedTableName}`,columns:S.columns,rows:S.data,isValid:S.isValid,error:S.validationError}));s(N),a(2)}catch(k){t.error("Analysis failed",k),await Xt.error(e("datasource.smart_import.error_analyzing"))}finally{f(!1)}}},w=async()=>{g(!0);let v=0,B=0;try{for(const k of n){if(!k.isValid)continue;const N=k.columns.map(O=>`"${O.name}" ${O.type}`).join(", ");await Dt.executeRaw(`CREATE TABLE IF NOT EXISTS "${k.tableName}" (${N});`);const S=500;for(let O=0;O<k.rows.length;O+=S)await Dt.bulkInsert(k.tableName,k.rows.slice(O,O+S));B++,v+=k.rows.length}A({tables:B,records:v}),a(4),s([]),window.dispatchEvent(new Event("db-updated"))}catch(k){const N=k instanceof Error?k.message:String(k);await Xt.error(e("common.error")+": "+N)}finally{g(!1)}};return c.jsxs("div",{className:"space-y-6",children:[c.jsx("div",{className:"flex items-center gap-4 px-2",children:[{s:1,label:e("datasource.smart_import.step_upload")},{s:2,label:e("datasource.smart_import.step_config")},{s:3,label:e("datasource.smart_import.step_import")}].concat(r===4?[{s:4,label:e("datasource.smart_import.step_success")}]:[]).map(({s:v,label:B})=>c.jsxs(ar.Fragment,{children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-[10px] font-black ${r>=v?"bg-blue-600 text-white":"bg-slate-200 text-slate-500"}`,children:v}),c.jsx("span",{className:`text-[10px] font-bold uppercase tracking-wider ${r>=v?"text-slate-700":"text-slate-400"}`,children:B})]}),v<(r===4?4:3)&&c.jsx(Ul,{className:"w-4 h-4 text-slate-300"})]},v))}),c.jsxs("div",{className:"min-h-[200px]",children:[r===1&&c.jsxs("div",{onClick:()=>x.current?.click(),className:"group relative border-2 border-dashed border-slate-200 hover:border-blue-400 hover:bg-blue-50/50 rounded-2xl p-12 transition-all cursor-pointer text-center",children:[c.jsx("input",{type:"file",ref:x,onChange:m,accept:".xlsx,.xls,.csv",className:"hidden"}),c.jsxs("div",{className:"flex flex-col items-center gap-4",children:[c.jsx("div",{className:"p-4 bg-blue-50 group-hover:bg-blue-100 rounded-2xl text-blue-600 transition-colors",children:c.jsx($m,{className:"w-8 h-8"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-bold text-slate-700",children:e("datasource.smart_import.upload_label")}),c.jsx("p",{className:"text-xs text-slate-400 mt-1",children:e("datasource.smart_import.upload_hint")})]})]}),u&&c.jsx("div",{className:"absolute inset-0 bg-white/80 flex items-center justify-center rounded-2xl z-10",children:c.jsxs("div",{className:"flex items-center gap-3 text-blue-600",children:[c.jsx("div",{className:"w-5 h-5 border-2 border-current border-t-transparent rounded-full animate-spin"}),c.jsx("span",{className:"text-xs font-bold",children:e("common.loading")})]})})]}),r===2&&c.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-bottom-2 duration-300",children:[c.jsx("div",{className:"flex items-center justify-between mb-2",children:c.jsxs("div",{children:[c.jsx("h4",{className:"text-sm font-bold text-slate-700",children:e("datasource.smart_import.found_tables")}),c.jsx("p",{className:"text-[10px] text-slate-400",children:e("datasource.smart_import.found_tables_hint")})]})}),c.jsx("div",{className:"space-y-3",children:n.map((v,B)=>c.jsx("div",{className:`p-4 rounded-xl border-2 transition-all ${v.isValid?"bg-white border-slate-100 shadow-sm":"bg-red-50 border-red-100"}`,children:c.jsxs("div",{className:"flex items-start justify-between gap-4",children:[c.jsxs("div",{className:"flex-1 space-y-3",children:[c.jsx("div",{className:"flex items-center gap-4",children:c.jsxs("div",{className:"flex-1",children:[c.jsxs("span",{className:"text-[9px] font-black text-slate-400 uppercase",children:[e("datasource.smart_import.sheet_label")," ",v.sheetName]}),c.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[c.jsx(Oc,{className:"w-4 h-4 text-blue-500"}),c.jsx("input",{value:v.tableName,onChange:k=>{const N=[...n];N[B].tableName=k.target.value,N[B].isValid=k.target.value.length>0&&!k.target.value.startsWith("sys_"),s(N)},className:`text-sm font-bold bg-transparent border-b-2 outline-none w-full ${v.isValid?"border-blue-100 focus:border-blue-500":"border-red-300"}`,placeholder:e("datasource.smart_import.table_label")})]}),!v.isValid&&c.jsxs("p",{className:"text-[10px] text-red-500 mt-1 flex items-center gap-1",children:[c.jsx(il,{className:"w-3 h-3"})," ",e("datasource.smart_import.invalid_prefix")]})]})}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-bold text-slate-500",children:[c.jsx(_i,{className:"w-3 h-3"}),e("datasource.smart_import.columns_count",{count:v.columns.length})]}),c.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-bold text-slate-500",children:[c.jsx(TS,{className:"w-3 h-3"}),e("datasource.smart_import.rows_count",{count:v.rows.length})]})]}),c.jsxs("div",{className:"flex flex-wrap gap-1",children:[v.columns.slice(0,5).map(k=>c.jsxs("span",{className:"px-2 py-0.5 bg-slate-100 text-slate-600 rounded text-[9px] font-medium",children:[k.name," ",c.jsxs("span",{className:"opacity-50 font-mono",children:["(",k.type,")"]})]},k.name)),v.columns.length>5&&c.jsx("span",{className:"px-2 py-0.5 bg-slate-100 text-slate-400 rounded text-[9px] font-medium",children:e("datasource.smart_import.more_columns",{count:v.columns.length-5})})]})]}),c.jsx("button",{onClick:()=>s(n.filter((k,N)=>N!==B)),className:"p-2 text-slate-300 hover:text-red-500 hover:bg-red-50 rounded-lg transition-all",children:c.jsx(ds,{className:"w-4 h-4"})})]})},B))}),c.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-slate-100",children:[c.jsx("button",{onClick:()=>a(1),className:"px-4 py-2 text-slate-500 font-bold text-xs hover:bg-slate-100 rounded-lg transition-colors",children:e("datasource.smart_import.back_btn")}),c.jsxs("button",{onClick:()=>{a(3),w()},disabled:n.length===0||n.some(v=>!v.isValid)||h,className:"px-6 py-2.5 bg-blue-600 hover:bg-blue-700 disabled:opacity-30 disabled:cursor-not-allowed text-white rounded-xl text-xs font-black shadow-lg shadow-blue-500/20 transition-all flex items-center gap-2",children:[e("datasource.smart_import.start_import")," ",c.jsx(Ul,{className:"w-4 h-4"})]})]})]}),r===3&&c.jsxs("div",{className:"flex flex-col items-center justify-center p-12 text-center space-y-4",children:[c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-blue-100 border-t-blue-600 rounded-full animate-spin"}),c.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:c.jsx(_i,{className:"w-6 h-6 text-blue-600"})})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-sm font-bold text-slate-700",children:e("datasource.smart_import.import_running")}),c.jsx("p",{className:"text-xs text-slate-400 mt-1",children:e("common.loading")})]})]}),r===4&&c.jsxs("div",{className:"flex flex-col items-center justify-center p-12 text-center space-y-6 animate-in zoom-in-95 duration-500",children:[c.jsx("div",{className:"w-20 h-20 bg-emerald-50 text-emerald-600 rounded-full flex items-center justify-center shadow-inner ring-8 ring-emerald-50/50",children:c.jsx(Bf,{className:"w-10 h-10"})}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("h4",{className:"text-xl font-black text-slate-800 tracking-tight",children:e("datasource.smart_import.import_success_title")}),c.jsx("p",{className:"text-sm text-slate-500 max-w-[280px] leading-relaxed",children:e("datasource.smart_import.import_success_hint",{count:l.tables})})]}),c.jsxs("div",{className:"flex items-center gap-8 py-4 px-8 bg-slate-50 rounded-2xl border border-slate-100",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1",children:e("datasource.smart_import.found_tables")}),c.jsx("p",{className:"text-lg font-black text-slate-700",children:l.tables})]}),c.jsx("div",{className:"w-px h-8 bg-slate-200"}),c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1",children:e("datasource.smart_import.rows_count",{count:0}).replace("0","").trim()}),c.jsx("p",{className:"text-lg font-black text-slate-700",children:l.records})]})]}),c.jsx("button",{onClick:()=>a(1),className:"px-8 py-3 bg-slate-900 hover:bg-black text-white rounded-xl text-sm font-bold transition-all transform hover:scale-105 active:scale-95 shadow-xl shadow-slate-900/10",children:e("datasource.smart_import.finish_btn")})]})]})]})},RN=({schema:e})=>{const{t}=tn();if(!e)return null;const r=e.items||e,a=r.properties,n=r.required||[];if(!a)return c.jsx("div",{className:"p-4 text-center text-slate-400 italic text-sm",children:"Keine Feld-Informationen verfgbar."});const s=Object.entries(a),l=e.indexes||[];return c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"overflow-x-auto rounded-xl border border-slate-200 dark:border-slate-700",children:c.jsxs("table",{className:"w-full text-sm text-left border-collapse",children:[c.jsx("thead",{className:"bg-slate-50 dark:bg-slate-900/50 text-slate-500 uppercase text-[11px] font-bold",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-3 border-b border-slate-200 dark:border-slate-700",children:"Property"}),c.jsx("th",{className:"px-4 py-3 border-b border-slate-200 dark:border-slate-700",children:"Type"}),c.jsx("th",{className:"px-4 py-3 border-b border-slate-200 dark:border-slate-700",children:"Constraints"}),c.jsx("th",{className:"px-4 py-3 border-b border-slate-200 dark:border-slate-700",children:"Description"})]})}),c.jsx("tbody",{children:s.map(([A,u])=>c.jsxs("tr",{className:"hover:bg-slate-50/80 dark:hover:bg-slate-800/50 transition-colors border-b border-slate-100 dark:border-slate-800 last:border-0",children:[c.jsx("td",{className:"px-4 py-4 align-top",children:c.jsxs("div",{className:"font-mono font-bold text-slate-900 dark:text-white flex items-center gap-1.5",children:[A,n.includes(A)&&c.jsx("span",{className:"text-[10px] text-red-500 font-bold px-1.5 py-0.5 bg-red-50 dark:bg-red-900/20 rounded border border-red-100 dark:border-red-900/30",children:"REQ"})]})}),c.jsx("td",{className:"px-4 py-4 align-top",children:c.jsx("code",{className:"text-[11px] px-1.5 py-0.5 bg-slate-100 dark:bg-slate-700 rounded text-slate-600 dark:text-slate-300",children:u.type})}),c.jsx("td",{className:"px-4 py-4 align-top",children:c.jsxs("div",{className:"flex flex-wrap gap-1",children:[u.enum&&c.jsxs("div",{className:"w-full mb-1",children:[c.jsx("span",{className:"text-[10px] text-slate-400 uppercase font-bold block mb-1",children:"Allowed Values:"}),c.jsx("div",{className:"flex flex-wrap gap-1",children:u.enum.map(f=>c.jsx("span",{className:"text-[10px] px-1 bg-amber-50 dark:bg-amber-900/20 text-amber-600 dark:text-amber-400 border border-amber-100 dark:border-amber-900/30 rounded",children:f},f))})]}),u.pattern&&c.jsxs("div",{className:"w-full",children:[c.jsx("span",{className:"text-[10px] text-slate-400 uppercase font-bold block mb-0.5",children:"Regex Pattern:"}),c.jsx("code",{className:"text-[10px] text-indigo-500 font-mono break-all",children:u.pattern})]}),u.format&&c.jsx("span",{className:"text-[10px] px-1 bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 border border-blue-100 dark:border-blue-900/30 rounded uppercase",children:u.format}),u.minimum!==void 0&&c.jsxs("span",{className:"text-[10px] px-1 bg-slate-50 dark:bg-slate-700 text-slate-500 rounded font-mono",children:["min: ",u.minimum]}),u.maximum!==void 0&&c.jsxs("span",{className:"text-[10px] px-1 bg-slate-50 dark:bg-slate-700 text-slate-500 rounded font-mono",children:["max: ",u.maximum]})]})}),c.jsx("td",{className:"px-4 py-4 align-top text-slate-600 dark:text-slate-400 text-xs leading-relaxed",children:u.description||c.jsx("span",{className:"opacity-30 italic",children:"No description available"})})]},A))})]})}),c.jsxs("div",{className:"rounded-xl border border-slate-200 dark:border-slate-700 p-4 bg-white dark:bg-slate-900/30",children:[c.jsx("div",{className:"text-[11px] font-bold uppercase tracking-wider text-slate-500 mb-2",children:t("datasource.indexes_title","Indexes")}),l.length===0?c.jsx("div",{className:"text-xs text-slate-400 italic",children:t("datasource.indexes_empty","No indexes available.")}):c.jsx("div",{className:"space-y-2",children:l.map(A=>c.jsxs("div",{className:"p-2.5 rounded-lg border border-slate-100 dark:border-slate-800 bg-slate-50/70 dark:bg-slate-900/40",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[c.jsx("span",{className:"font-mono text-xs font-bold text-slate-700 dark:text-slate-200",children:A.name}),A.unique&&c.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-emerald-50 border border-emerald-200 text-emerald-700 dark:bg-emerald-900/20 dark:border-emerald-900/30 dark:text-emerald-300",children:"UNIQUE"}),A.partial&&c.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-amber-50 border border-amber-200 text-amber-700 dark:bg-amber-900/20 dark:border-amber-900/30 dark:text-amber-300",children:"PARTIAL"})]}),c.jsxs("div",{className:"text-[11px] text-slate-500",children:[t("datasource.indexes_columns","Columns"),": ",c.jsx("span",{className:"font-mono text-slate-700 dark:text-slate-300",children:A.columns.join(", ")||"-"}),A.origin?c.jsxs("span",{className:"ml-2 text-slate-400",children:["(",A.origin,")"]}):null]})]},A.name))})]})]})},LV=({type:e,title:t,message:r,details:a,onClose:n,className:s=""})=>{const A={success:{bg:"bg-emerald-50 dark:bg-emerald-900/20",border:"border-emerald-100 dark:border-emerald-800/50",text:"text-emerald-800 dark:text-emerald-200",icon:c.jsx(Bf,{className:"w-5 h-5 text-emerald-500"})},error:{bg:"bg-red-50 dark:bg-red-900/20",border:"border-red-100 dark:border-red-800/50",text:"text-red-800 dark:text-red-200",icon:c.jsx(il,{className:"w-5 h-5 text-red-500"})},warning:{bg:"bg-amber-50 dark:bg-amber-900/20",border:"border-amber-100 dark:border-amber-800/50",text:"text-amber-800 dark:text-amber-200",icon:c.jsx(Ou,{className:"w-5 h-5 text-amber-500"})},info:{bg:"bg-blue-50 dark:bg-blue-900/20",border:"border-blue-100 dark:border-blue-800/50",text:"text-blue-800 dark:text-blue-200",icon:c.jsx(qc,{className:"w-5 h-5 text-blue-500"})}}[e];return c.jsxs("div",{className:`p-4 rounded-2xl border-2 ${A.bg} ${A.border} flex items-start gap-4 animate-in slide-in-from-top-2 duration-300 ${s}`,children:[c.jsx("div",{className:"shrink-0 mt-0.5",children:A.icon}),c.jsxs("div",{className:"flex-1 min-w-0",children:[t&&c.jsx("h5",{className:`text-sm font-black uppercase tracking-wider mb-1 ${A.text}`,children:t}),c.jsx("p",{className:`text-sm font-medium leading-relaxed ${A.text}`,children:r}),a&&c.jsx("div",{className:"mt-3 p-3 bg-white/50 dark:bg-black/20 rounded-xl border border-white/50 dark:border-white/5",children:c.jsx("pre",{className:"text-[10px] font-mono whitespace-pre-wrap break-all opacity-80",children:a})})]}),n&&c.jsx("button",{onClick:n,className:"p-1 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg transition-colors shrink-0",children:c.jsx(nl,{className:"w-4 h-4 opacity-50"})})]})},UV=()=>{const{t:e}=tn(),[t,r]=hr("excel_mappings_v2",{}),a=X.useRef(null),[n,s]=ar.useState(null),[l,A]=ar.useState(null),u=()=>{try{const x=JSON.stringify(t,null,2),m=new Blob([x],{type:"application/json"}),w=URL.createObjectURL(m),v=document.createElement("a");v.href=w,v.download=`itdashboard_mappings_${new Date().toISOString().split("T")[0]}.json`,v.click(),URL.revokeObjectURL(w),A("success"),s(e("common.success"))}catch(x){const m=x instanceof Error?x.message:String(x);A("error"),s(e("common.error")+": "+m)}},f=x=>{const m=x.target.files?.[0];if(!m)return;const w=new FileReader;w.onload=v=>{try{const B=JSON.parse(v.target?.result);if(typeof B!="object"||B===null)throw new Error("Invalid JSON");r(k=>({...k,...B})),A("success"),s(e("common.success"))}catch(B){const k=B instanceof Error?B.message:String(B);A("error"),s(e("common.error")+": "+k)}},w.readAsText(m),a.current&&(a.current.value="")},h=async()=>{await Xt.confirm(e("datasource.clear_mappings_confirm"))&&(r({}),A("success"),s(e("common.success")))};ar.useEffect(()=>{if(n){const x=setTimeout(()=>{s(null),A(null)},3e3);return()=>clearTimeout(x)}},[n]);const g=Object.keys(t).length;return c.jsxs("div",{className:"flex items-center gap-3",children:[n&&c.jsxs("div",{className:`text-xs px-2 py-1 rounded flex items-center gap-1.5 animate-in fade-in slide-in-from-right-4 ${l==="success"?"bg-green-50 text-green-700 dark:bg-green-900/20 dark:text-green-300":"bg-red-50 text-red-700 dark:bg-red-900/20 dark:text-red-300"}`,children:[l==="success"?c.jsx(Bf,{className:"w-3 h-3"}):c.jsx(il,{className:"w-3 h-3"}),n]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-xs text-slate-400 mr-2",children:e("datasource.mappings_saved",{count:g})}),c.jsx("button",{onClick:u,disabled:g===0,className:"p-1.5 text-slate-500 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-slate-700 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:e("datasource.export_mappings"),children:c.jsx(jp,{className:"w-4 h-4"})}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"file",accept:".json",ref:a,onChange:f,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",title:e("datasource.import_mappings")}),c.jsx("button",{className:"p-1.5 text-slate-500 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-slate-700 rounded transition-colors pointer-events-none",children:c.jsx($m,{className:"w-4 h-4"})})]}),c.jsx("div",{className:"w-px h-4 bg-slate-200 dark:bg-slate-700 mx-1"}),c.jsx("button",{onClick:h,disabled:g===0,className:"p-1.5 text-slate-500 hover:text-red-600 hover:bg-red-50 dark:hover:bg-slate-700 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:e("datasource.clear_mappings"),children:c.jsx(ds,{className:"w-4 h-4"})})]})]})},MN=()=>{const{lastBackup:e,changeCount:t,markBackupComplete:r}=Mo();return{lastBackup:e?new Date(e):null,changeCount:t,isBackupRecommended:t>0,markBackupComplete:r}},ko=fA("DatasourceView"),jV=["litebistudio_","data_inspector_","query_builder_","data_table_","ui_table_","notifications_","import_"],DV=new Set(["app_log_level","custom_dashboard_layout","excel_mappings_v2","i18nextLng","visibleComponentIds","visibleSidebarComponentIds","componentOrder","isSidebarCollapsed"]),IV=["litebistudio_","data_inspector_","query_builder_"],Bh=e=>String(e).padStart(2,"0"),QV=(e,t)=>{const r=new Date,a=`${r.getFullYear()}-${Bh(r.getMonth()+1)}-${Bh(r.getDate())}`,n=`${Bh(r.getHours())}${Bh(r.getMinutes())}${Bh(r.getSeconds())}`,s=`${a}_${n}`,l=t?"secure":"standard",f=(e||"backup_{date}_{mode}").trim().replace(/\{date\}/gi,a).replace(/\{time\}/gi,n).replace(/\{datetime\}/gi,s).replace(/\{mode\}/gi,l).replace(/[<>:"/\\|?*]/g,"_"),g=Array.from(f).map(x=>x.charCodeAt(0)<32?"_":x).join("").trim()||`backup_${a}_${l}`;return g.toLowerCase().endsWith(".sqlite3")?g:`${g}.sqlite3`},OV=()=>{const e=Object.keys(window.localStorage);for(const r of e)(DV.has(r)||jV.some(a=>r.startsWith(a)))&&window.localStorage.removeItem(r);const t=Object.keys(window.sessionStorage);for(const r of t)IV.some(a=>r.startsWith(a))&&window.sessionStorage.removeItem(r)},RV=({onImportComplete:e})=>{const{t,i18n:r}=tn(),a=new Date,n=t("settings.last_update",{date:a.toLocaleDateString(r.language==="de"?"de-DE":"en-US"),time:a.toLocaleTimeString(r.language==="de"?"de-DE":"en-US",{hour:"2-digit",minute:"2-digit"})}),{isReadOnly:s,isAdminMode:l}=Mo(),A=Me=>Me instanceof Error?Me.message:String(Me),[u,f]=X.useState(()=>{const Me=sessionStorage.getItem("litebistudio_datasource_tab");return Me==="import"||Me==="structure"||Me==="system"?Me:"import"});X.useEffect(()=>{sessionStorage.setItem("litebistudio_datasource_tab",u)},[u]);const[h,g]=X.useState(""),[x,m]=X.useState(null),[w,v]=X.useState(!1),[B,k]=X.useState(!1),[N,S]=X.useState(""),[O,T]=X.useState(""),[U,D]=X.useState([]),[H,j]=X.useState(!1),[W,I]=X.useState(""),[Q,Y]=X.useState([]),[z,ue]=X.useState(!1),[Z,Ae]=X.useState(""),[ve,G]=X.useState(!1),[Se,we]=X.useState(`CREATE TABLE usr_my_table (
    id INTEGER PRIMARY KEY,
    name TEXT,
    amount REAL
);`),[F,R]=X.useState([{name:"id",type:"INTEGER PRIMARY KEY"}]),{isBackupRecommended:M,changeCount:P,markBackupComplete:re}=MN(),[ge,Ce]=X.useState(!1),[de,be]=X.useState(""),[Le,ie]=X.useState(null),[_e,je]=X.useState(!1),[J,ze]=X.useState(!1),[He]=hr("backup_file_name_pattern","backup_{date}_{mode}"),[ct]=hr("backup_use_saved_location",!0),Xe=X.useRef(null),Ut=Kp(),yt=async Me=>{const kt=()=>new Date().toLocaleTimeString();ko.debug(`[Restore][${kt()}] File selected:`,Me.name,Me.size,Me.type);try{ko.debug(`[Restore][${kt()}] Calling file.arrayBuffer()...`);const Tt=await Me.arrayBuffer();ko.debug(`[Restore][${kt()}] Buffer received, size:`,Tt.byteLength);const ir=new Uint8Array(Tt.slice(0,16)),Sr=new TextDecoder().decode(ir).startsWith("SQLite format 3");ko.debug("[Restore] Header check - isSqlite:",Sr);let ca=Tt;if(!Sr){const Hr=await Xt.prompt(t("datasource.restore_encrypted_prompt"));if(!Hr)return;try{ca=await Aq(Tt,Hr)}catch{ie({type:"error",title:t("common.error"),message:t("datasource.restore_failed")});return}}if(!await Xt.confirm(t("datasource.restore_confirm")))return;ko.info(`[Restore][${kt()}] User confirmed restore. Starting process...`),ie({type:"warning",title:t("common.loading"),message:"Verarbeite Backup-Datei..."});try{ko.debug(`[Restore][${kt()}] Importing db module...`);const{importDatabase:Hr}=await iA(async()=>{const{importDatabase:Er}=await Promise.resolve().then(()=>Tu);return{importDatabase:Er}},void 0);ko.debug(`[Restore][${kt()}] Calling worker importDatabase...`);const Br=await Hr(ca);ko.debug(`[Restore][${kt()}] Worker report received:`,Br);const{versionInfo:jr}=Br;if(!Br.headerMatch){ie({type:"error",title:t("datasource.restore_invalid"),message:Br.error||t("datasource.restore_warning_hint")});return}if(Br.error){ie({type:"error",title:Br.isDowngrade?"Incompatible Backup":t("common.error"),message:Br.error,details:jr?`Backup Version: V${jr.backup} | App Version: V${jr.current}`:void 0});return}if(Br.isValid)ie({type:"success",title:t("common.success"),message:t("datasource.restore_success_reload"),details:jr?`Database Version: V${jr.backup} (Upgraded to V${jr.current})`:void 0}),ko.info(`[Restore][${kt()}] Success! Reloading in 2s...`),re(),setTimeout(()=>window.location.reload(),2e3);else{let Er="";if(jr&&(Er+=`Schema: V${jr.backup}  V${jr.current} (Update required)

`),Br.missingTables.length>0&&(Er+=t("datasource.restore_missing_tables")+`
- `+Br.missingTables.join(`
- `)+`

`),Object.keys(Br.missingColumns).length>0){Er+=t("datasource.restore_missing_columns")+`
`;for(const[ae,xe]of Object.entries(Br.missingColumns))Er+=`- ${ae}: ${xe.join(", ")}
`}ie({type:"warning",title:t("datasource.restore_warning_title"),message:t("datasource.restore_warning_hint"),details:Er})}}catch(Hr){ko.error(`[Restore][${kt()}] Inner Error:`,Hr),ie({type:"error",title:t("common.error"),message:A(Hr)})}}catch(Tt){ko.error(`[Restore][${kt()}] Outer Error:`,Tt),ie({type:"error",title:t("common.error"),message:A(Tt)})}},qt=async()=>{if(ie(null),ct&&Ut){const Me=await Cq();if(Me.cancelled)return;if(Me.file){await yt(Me.file);return}Xe.current&&Xe.current.click();return}Xe.current&&Xe.current.click()},{data:Lt,refresh:jt}=ri(()=>Dt.getTables(),[]),{data:Pt,refresh:zt}=ri(()=>Dt.getDataSources(),[]),Jt=Me=>Me.startsWith("sys_")||Me==="sqlite_sequence",It=Lt?.filter(Me=>!Jt(Me))||[],xt=Lt?.filter(Me=>Jt(Me))||[],ht=(Pt||[]).filter(Me=>Me.type==="view"&&!Jt(Me.name)),{data:Bt}=ri(async()=>{if(u!=="structure"||It.length===0)return{};const Me=await Promise.all(It.map(async kt=>{const[Tt,ir]=await Promise.all([Dt.executeRaw(`SELECT COUNT(*) AS count FROM "${kt}"`),Dt.executeRaw("SELECT COUNT(*) AS count FROM sqlite_master WHERE type='index' AND LOWER(tbl_name) = LOWER(?) AND name NOT LIKE 'sqlite_%'",[kt])]);return[kt,{rows:Number(Tt[0]?.count||0),indexes:Number(ir[0]?.count||0)}]}));return Object.fromEntries(Me)},[u,It.join("|")],{cacheKey:`datasource-table-meta-${It.join("|")}`,ttl:15e3}),{data:pr}=ri(async()=>{if(u!=="structure"||ht.length===0)return{};const Me=await Promise.all(ht.map(async kt=>{try{const Tt=await Dt.executeRaw(`SELECT COUNT(*) AS count FROM "${kt.name}"`);return[kt.name,{valid:!0,rows:Number(Tt[0]?.count||0)}]}catch(Tt){return[kt.name,{valid:!1,error:A(Tt)}]}}));return Object.fromEntries(Me)},[u,ht.map(Me=>Me.name).join("|")],{cacheKey:`datasource-view-meta-${ht.map(Me=>Me.name).join("|")}`,ttl:15e3});X.useEffect(()=>{(async()=>{if(!h){m(null);return}try{const[kt,Tt]=await Promise.all([Dt.getTableSchema(h),Dt.getTableIndexes(h)]),ir={};kt.forEach(Nt=>{ir[Nt.name]={type:Nt.type.toUpperCase().includes("INT")||Nt.type.toUpperCase().includes("REAL")?"number":"string",description:Nt.type}}),m({title:h,description:t("datasource.records_label",{name:h}),properties:ir,required:kt.filter(Nt=>Nt.notnull).map(Nt=>Nt.name),indexes:Tt.map(Nt=>({name:Nt.name,unique:Nt.unique,columns:Nt.columns,origin:Nt.origin,partial:Nt.partial}))})}catch(kt){ko.error("Failed to load schema",kt),m(null)}})()},[h,Lt,w,t]);const Ee=(()=>{if(!(!h||!x))return{key:`import_${h}`,entityLabel:t("datasource.records_label",{name:h}),schema:x,validate:()=>!0,getValidationErrors:()=>[],importFn:async Me=>{for(let Tt=0;Tt<Me.length;Tt+=500)await Dt.bulkInsert(h,Me.slice(Tt,Tt+500))},clearFn:async()=>{await Dt.executeRaw(`DELETE FROM ${h}`)}}})(),at=async()=>{try{if(ve)await Dt.executeRaw(Se);else{const Me=F.map(Tt=>`${Tt.name} ${Tt.type}`).join(", "),kt=`CREATE TABLE ${Z} (${Me})`;await Dt.executeRaw(kt)}ue(!1),jt(),Ae(""),R([{name:"id",type:"INTEGER PRIMARY KEY"}]),await Xt.info(t("datasource.table_created"))}catch(Me){await Xt.error(t("common.error")+": "+A(Me))}},it=async Me=>{if(!(localStorage.getItem("notifications_confirm_destructive")!=="false"&&!await Xt.confirm(t("datasource.drop_confirm",{name:Me}))))try{await Dt.executeRaw(`DROP TABLE ${Me}`),jt(),zt(),h===Me&&g("")}catch(Tt){await Xt.error(t("common.error")+": "+A(Tt))}},bt=async Me=>{if(!(localStorage.getItem("notifications_confirm_destructive")!=="false"&&!await Xt.confirm(t("datasource.drop_view_confirm",`View "${Me}" lschen?`,{name:Me}))))try{await Dt.executeRaw(`DROP VIEW ${Me}`),jt(),zt(),h===Me&&g("")}catch(Tt){await Xt.error(t("common.error")+": "+A(Tt))}},Et=async Me=>{if(!(localStorage.getItem("notifications_confirm_destructive")!=="false"&&!await Xt.confirm(t("datasource.clear_confirm",{name:Me}))))try{await Dt.executeRaw(`DELETE FROM ${Me}`),jt(),await Xt.info(t("datasource.cleared_success"))}catch(Tt){await Xt.error(t("common.error")+": "+A(Tt))}},mt=async()=>{const Me=t("datasource.sql_manager_reset_confirm","Reset SQL Manager? All saved SQL statements and favorites will be deleted.");if(!await Xt.confirm(Me))return;const kt=await Xt.prompt(t("datasource.sql_manager_reset_prompt",'Please type "RESET" to continue:'));if(kt!=="RESET"){kt!==null&&await Xt.warning(t("datasource.sql_manager_reset_aborted","Canceled: Wrong input."));return}try{ze(!0),await Dt.executeRaw("DELETE FROM sys_sql_statement;"),await Xt.info(t("datasource.sql_manager_reset_success","SQL Manager was reset."))}catch(Tt){await Xt.error(t("common.error")+": "+A(Tt))}finally{ze(!1)}},Ot=Me=>`"${Me.replace(/"/g,'""')}"`,Ur=async Me=>{try{const Tt=(await Dt.getTableSchema(Me)).map(ir=>ir.name).filter(Boolean);S(Me),Y(Tt),D([]),j(!1),I(""),T(`idx_${Me}_`),k(!0)}catch(kt){await Xt.error(t("common.error")+": "+A(kt))}},Vt=Me=>{D(kt=>kt.includes(Me)?kt.filter(Tt=>Tt!==Me):[...kt,Me])},tt=(Me,kt)=>{D(Tt=>{const ir=Tt.indexOf(Me);if(ir===-1)return Tt;const Nt=kt==="up"?ir-1:ir+1;if(Nt<0||Nt>=Tt.length)return Tt;const Sr=[...Tt];return[Sr[ir],Sr[Nt]]=[Sr[Nt],Sr[ir]],Sr})},Wt=async()=>{const Me=O.trim();if(!Me){await Xt.warning(t("datasource.index_create_name_required","Bitte einen Indexnamen angeben."));return}if(U.length===0){await Xt.warning(t("datasource.index_create_columns_required","Bitte mindestens eine Spalte auswhlen."));return}try{const kt=H?"UNIQUE ":"",Tt=U.map(Ot).join(", "),ir=W.trim()?` WHERE ${W.trim()}`:"",Nt=`CREATE ${kt}INDEX ${Ot(Me)} ON ${Ot(N)} (${Tt})${ir};`;await Dt.executeRaw(Nt),k(!1),await jt(),await Xt.info(t("datasource.index_create_success","Index erstellt."))}catch(kt){await Xt.error(t("common.error")+": "+A(kt))}};return c.jsxs(t0,{header:{title:t("sidebar.datasource"),subtitle:t("datasource.subtitle"),onBack:()=>window.history.back()},footer:n,children:[c.jsxs("div",{className:`max-w-4xl space-y-6 ${s?"opacity-80":""}`,children:[c.jsx("div",{className:"border-b border-slate-200 dark:border-slate-700",children:c.jsxs("div",{className:"flex items-center gap-8 px-1",children:[c.jsxs("button",{onClick:()=>f("import"),className:`relative py-3 text-sm font-bold transition-colors ${u==="import"?"text-blue-600 dark:text-blue-400":"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"}`,children:[t("datasource.tab_import"),u==="import"&&c.jsx("span",{className:"absolute left-0 right-0 -bottom-px h-0.5 bg-blue-600 dark:bg-blue-400"})]}),c.jsxs("button",{onClick:()=>f("structure"),className:`relative py-3 text-sm font-bold transition-colors ${u==="structure"?"text-blue-600 dark:text-blue-400":"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"}`,children:[t("datasource.tab_structure"),u==="structure"&&c.jsx("span",{className:"absolute left-0 right-0 -bottom-px h-0.5 bg-blue-600 dark:bg-blue-400"})]}),c.jsxs("button",{onClick:()=>f("system"),className:`relative py-3 text-sm font-bold transition-colors ${u==="system"?"text-blue-600 dark:text-blue-400":"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"}`,children:[t("datasource.tab_system"),u==="system"&&c.jsx("span",{className:"absolute left-0 right-0 -bottom-px h-0.5 bg-blue-600 dark:bg-blue-400"})]})]})}),u==="import"&&c.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[c.jsxs("div",{className:`bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm ${s?"pointer-events-none opacity-60":""}`,children:[c.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[c.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg text-blue-600",children:c.jsx(Io,{className:"w-5 h-5"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-sm font-bold text-slate-700 dark:text-slate-200 uppercase tracking-widest",children:t("datasource.smart_import_title")}),c.jsx("p",{className:"text-xs text-slate-400",children:t("datasource.smart_import_hint")})]})]}),c.jsx(TV,{})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"h-px bg-slate-200 dark:bg-slate-700 flex-1"}),c.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase",children:t("datasource.or_separator")}),c.jsx("div",{className:"h-px bg-slate-200 dark:bg-slate-700 flex-1"})]}),c.jsxs("div",{className:`bg-slate-50 dark:bg-slate-800/50 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm ${s?"pointer-events-none opacity-60":""}`,children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-white dark:bg-slate-700 rounded-lg text-slate-600 dark:text-slate-300 shadow-sm",children:c.jsx(_i,{className:"w-5 h-5"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-sm font-bold text-slate-700 dark:text-slate-200 uppercase tracking-widest",children:t("datasource.append_data_title")}),c.jsx("p",{className:"text-xs text-slate-400",children:t("datasource.append_data_hint")})]})]}),c.jsx(UV,{})]}),c.jsx("div",{className:"mb-6",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("select",{value:h,onChange:Me=>g(Me.target.value),className:"w-full md:w-1/2 p-2.5 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-sm font-medium text-slate-700 dark:text-slate-200 outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"",disabled:!0,children:t("datasource.select_target_table")}),Lt?.filter(Me=>!Jt(Me)).map(Me=>c.jsx("option",{value:Me,children:Me},Me))]}),c.jsx("button",{onClick:()=>jt(),className:"p-2.5 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 text-slate-400 dark:text-slate-500 hover:text-blue-600 dark:hover:text-blue-400 rounded-lg",children:c.jsx(Ic,{className:"w-5 h-5"})})]})}),h&&c.jsx(NV,{onImportComplete:e,config:Ee},h)]})]}),u==="structure"&&c.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[c.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("div",{children:[c.jsxs("h3",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wider flex items-center gap-2",children:[c.jsx(Oc,{className:"w-4 h-4"})," ",t("datasource.user_tables")]}),c.jsx("p",{className:"text-xs text-slate-400 mt-1",children:t("datasource.user_tables_hint")})]}),!s&&c.jsxs("button",{onClick:()=>ue(!0),className:"flex items-center gap-2 px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-xs font-bold transition-colors shadow-sm",children:[c.jsx(Io,{className:"w-4 h-4"})," ",t("datasource.new_table")]})]}),It.length===0?c.jsx("div",{className:"p-8 text-center border-2 border-dashed border-slate-200 dark:border-slate-700 rounded-xl bg-slate-50 dark:bg-slate-900/40",children:c.jsx("p",{className:"text-slate-400 dark:text-slate-500 text-sm",children:t("datasource.no_user_tables")})}):c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:It.map(Me=>c.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-slate-900/40 border border-slate-200 dark:border-slate-700 rounded-xl flex items-center justify-between group",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-white dark:bg-slate-800 rounded-lg shadow-sm text-blue-600 dark:text-blue-400",children:c.jsx(Oc,{className:"w-4 h-4"})}),c.jsxs("div",{className:"flex flex-col min-w-0",children:[c.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-200 truncate",children:Me}),c.jsxs("span",{className:"text-[10px] text-slate-400 dark:text-slate-500",children:[t("datasource.table_meta_rows",{count:Bt?.[Me]?.rows??0}),"  ",t("datasource.table_meta_indexes",{count:Bt?.[Me]?.indexes??0})]})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:()=>{g(Me),v(!0)},className:"p-1.5 text-slate-400 dark:text-slate-500 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-colors",title:t("datasource.show_schema"),children:c.jsx(qc,{className:"w-4 h-4"})}),!s&&c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:()=>{Ur(Me)},className:"p-1.5 text-slate-400 dark:text-slate-500 hover:text-indigo-600 dark:hover:text-indigo-400 hover:bg-indigo-50 dark:hover:bg-indigo-900/20 rounded transition-colors",title:t("datasource.create_index_title","Index erstellen"),children:c.jsx(LS,{className:"w-4 h-4"})}),c.jsx("button",{onClick:()=>{g(Me),f("import")},className:"p-1.5 text-slate-400 dark:text-slate-500 hover:text-green-600 dark:hover:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/20 rounded transition-colors",title:t("datasource.append_data_short"),children:c.jsx($m,{className:"w-4 h-4"})}),c.jsx("button",{onClick:()=>it(Me),className:"p-1.5 text-slate-400 dark:text-slate-500 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors",title:t("common.delete"),children:c.jsx(ds,{className:"w-4 h-4"})})]})]})]},Me))})]}),c.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm",children:[c.jsx("div",{className:"flex items-center justify-between mb-6",children:c.jsxs("div",{children:[c.jsxs("h3",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wider flex items-center gap-2",children:[c.jsx(Oc,{className:"w-4 h-4"})," ",t("datasource.user_views","Views")]}),c.jsx("p",{className:"text-xs text-slate-400 mt-1",children:t("datasource.user_views_hint","SQL views available in the local database.")})]})}),ht.length===0?c.jsx("div",{className:"p-8 text-center border-2 border-dashed border-slate-200 dark:border-slate-700 rounded-xl bg-slate-50 dark:bg-slate-900/40",children:c.jsx("p",{className:"text-slate-400 dark:text-slate-500 text-sm",children:t("datasource.no_user_views","No views available.")})}):c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:ht.map(Me=>c.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-slate-900/40 border border-slate-200 dark:border-slate-700 rounded-xl flex items-center justify-between group",children:[c.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[c.jsx("div",{className:"p-2 bg-white dark:bg-slate-800 rounded-lg shadow-sm text-indigo-600 dark:text-indigo-400",children:c.jsx(Oc,{className:"w-4 h-4"})}),c.jsxs("div",{className:"min-w-0",children:[c.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-200 block truncate",children:Me.name}),pr?.[Me.name]?.valid===!1?c.jsx("span",{className:"text-[10px] text-rose-500 block",title:pr?.[Me.name]?.error,children:t("datasource.view_invalid","Defekter View")}):c.jsx("span",{className:"text-[10px] text-slate-400 dark:text-slate-500 block",children:t("datasource.table_meta_rows",{count:pr?.[Me.name]?.rows??0})})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:()=>{g(Me.name),v(!0)},disabled:pr?.[Me.name]?.valid===!1,className:`p-1.5 rounded transition-colors ${pr?.[Me.name]?.valid===!1?"text-slate-300 dark:text-slate-600 cursor-not-allowed":"text-slate-400 dark:text-slate-500 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20"}`,title:pr?.[Me.name]?.valid===!1?t("datasource.view_invalid","Defekter View"):t("datasource.show_schema"),children:c.jsx(qc,{className:"w-4 h-4"})}),!s&&c.jsx("button",{onClick:()=>bt(Me.name),className:"p-1.5 text-slate-400 dark:text-slate-500 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors",title:t("datasource.drop_view_title","Delete view"),children:c.jsx(ds,{className:"w-4 h-4"})})]})]},Me.name))})]}),l&&c.jsxs("div",{className:"bg-slate-100 dark:bg-slate-800/50 rounded-2xl p-6",children:[c.jsx("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest mb-4",children:t("datasource.system_tables")}),c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:xt.map(Me=>c.jsx("button",{onClick:()=>{g(Me),v(!0)},className:"px-3 py-2 bg-white/50 dark:bg-slate-800/60 border border-slate-200/50 dark:border-slate-700 rounded text-xs font-mono text-slate-500 dark:text-slate-400 hover:bg-white dark:hover:bg-slate-800 hover:text-blue-600 dark:hover:text-blue-400 text-left transition-colors",children:Me},Me))})]})]}),u==="system"&&c.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[c.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm",children:[c.jsx("h3",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wider mb-4",children:t("datasource.backup_restore")}),M&&c.jsxs("div",{className:"mb-4 p-3 bg-amber-50 dark:bg-amber-900/20 text-amber-800 dark:text-amber-200 rounded-lg border border-amber-200 dark:border-amber-800/50 text-xs flex items-center gap-2",children:[c.jsx(Ou,{className:"w-4 h-4"}),c.jsx("span",{children:t("datasource.backup_recommended",{count:P})})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"flex items-center gap-2",children:c.jsxs("button",{onClick:()=>Ce(!ge),className:`flex-1 p-3 rounded-xl border flex items-center gap-3 transition-all ${ge?"bg-emerald-50 dark:bg-emerald-900/20 border-emerald-200 dark:border-emerald-800 ring-1 ring-emerald-500/70 dark:ring-emerald-700/70":"bg-slate-50 dark:bg-slate-900/40 border-slate-200 dark:border-slate-700"}`,children:[c.jsx("div",{className:`p-2 rounded-lg ${ge?"bg-emerald-100 dark:bg-emerald-900/40 text-emerald-600 dark:text-emerald-300":"bg-slate-200 dark:bg-slate-700 text-slate-500 dark:text-slate-300"}`,children:ge?c.jsx(E0,{className:"w-4 h-4"}):c.jsx(ES,{className:"w-4 h-4"})}),c.jsxs("div",{className:"text-left",children:[c.jsx("div",{className:`text-sm font-bold ${ge?"text-emerald-900 dark:text-emerald-200":"text-slate-600 dark:text-slate-200"}`,children:t(ge?"datasource.encryption_active":"datasource.encryption_standard")}),c.jsx("div",{className:"text-xs text-slate-400 dark:text-slate-500",children:t(ge?"datasource.encryption_active_hint":"datasource.encryption_standard_hint")})]})]})}),ge&&c.jsx("div",{className:"animate-in fade-in slide-in-from-top-2",children:c.jsx("input",{type:"password",placeholder:t("datasource.backup_password_placeholder"),value:de,onChange:Me=>be(Me.target.value),className:"w-full p-3 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-200 rounded-xl outline-none focus:ring-2 focus:ring-emerald-500",autoFocus:!0})}),Le&&c.jsx("div",{className:"mb-4",children:c.jsx(LV,{type:Le.type,title:Le.title,message:Le.message,details:Le.details,onClose:()=>ie(null)})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 pt-2",children:[c.jsxs("button",{onClick:async()=>{if(ge&&de.length<4){await Xt.warning(t("datasource.backup_password_error"));return}const{exportDatabase:Me}=await iA(async()=>{const{exportDatabase:ca}=await Promise.resolve().then(()=>Tu);return{exportDatabase:ca}},void 0),kt=await Me(),Tt=new Uint8Array(kt).buffer;let ir=Tt;ge&&(ir=await oq(Tt,de));const Nt=QV(He,ge);let Sr=!1;if(ct&&Ut)try{Sr=await kq(ir,Nt)}catch{Sr=!1}if(!Sr){const ca=new Blob([ir],{type:"application/x-sqlite3"}),Hr=URL.createObjectURL(ca),Br=document.createElement("a");Br.href=Hr,Br.download=Nt,Br.click()}re(),ge&&be("")},className:`flex items-center justify-center gap-2 p-3 border rounded-lg text-sm font-bold transition-colors ${ge?"bg-emerald-600 border-emerald-700 text-white hover:bg-emerald-700":"bg-slate-50 dark:bg-slate-900/40 border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800"}`,children:[c.jsx(_i,{className:"w-4 h-4"}),t(ge?"datasource.save_backup_secure":"datasource.save_backup_standard")]}),c.jsxs("button",{type:"button",onClick:()=>{qt()},className:`flex items-center justify-center gap-2 p-3 border rounded-lg text-sm font-bold transition-colors ${ge?"bg-emerald-600 border-emerald-700 text-white hover:bg-emerald-700":"bg-slate-50 dark:bg-slate-900/40 border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800"}`,children:[c.jsx($m,{className:"w-4 h-4 text-amber-500"})," ",t("datasource.restore_backup")]}),c.jsx("input",{ref:Xe,type:"file",accept:".sqlite3,.sqlite,.db",className:"hidden",onChange:async Me=>{const kt=Me.target.files?.[0];kt&&(ie(null),await yt(kt),Me.currentTarget.value="")}})]})]})]}),c.jsxs("div",{className:"bg-red-50/50 dark:bg-red-900/10 rounded-2xl border border-red-200 dark:border-red-900/50 p-6 shadow-sm",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx("div",{className:"p-2 bg-red-100 dark:bg-red-900/30 text-red-600 rounded-lg",children:c.jsx(Ou,{className:"w-5 h-5"})}),c.jsxs("div",{className:"flex flex-col",children:[c.jsx("h3",{className:"text-sm font-bold text-red-900 dark:text-red-400 uppercase tracking-wider leading-none",children:t("datasource.danger_zone")}),c.jsx("p",{className:"text-xs text-red-700/70 dark:text-red-300/60 mt-1",children:t("datasource.danger_zone_hint")})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-6",children:[c.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-red-100 dark:border-red-900/20 rounded-xl p-4 shadow-sm",children:[c.jsx("h4",{className:"text-xs font-black text-slate-400 uppercase mb-3",children:t("datasource.clear_reset")}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("select",{id:"clear-table-select",className:"flex-1 p-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded text-xs outline-none",defaultValue:"",children:[c.jsx("option",{value:"",disabled:!0,children:t("datasource.select_target_table")}),(l?Lt:It)?.map(Me=>c.jsx("option",{value:Me,children:Me},Me))]}),c.jsx("button",{onClick:()=>{const Me=document.getElementById("clear-table-select");Me.value&&Et(Me.value)},className:"px-3 py-2 bg-red-600 hover:bg-red-700 text-white rounded font-bold text-xs transition-colors",children:t("datasource.clear_btn")})]}),c.jsx("p",{className:"text-[10px] text-slate-400 italic",children:t("datasource.clear_reset_hint")})]})]}),c.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-red-100 dark:border-red-900/20 rounded-xl p-4 shadow-sm",children:[c.jsx("h4",{className:"text-xs font-black text-slate-400 uppercase mb-3",children:t("datasource.drop_table_title")}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("select",{id:"drop-table-select",className:"flex-1 p-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded text-xs outline-none",defaultValue:"",children:[c.jsx("option",{value:"",disabled:!0,children:t("datasource.select_target_table")}),It.map(Me=>c.jsx("option",{value:`table:${Me}`,children:Me},`tbl-${Me}`)),ht.map(Me=>c.jsxs("option",{value:`view:${Me.name}`,children:[Me.name," (view)"]},`view-${Me.name}`))]}),c.jsx("button",{onClick:()=>{const Me=document.getElementById("drop-table-select");if(!Me.value)return;const[kt,Tt]=Me.value.split(":");Tt&&(kt==="view"?bt(Tt):it(Tt))},disabled:It.length===0&&ht.length===0,className:"px-3 py-2 bg-red-900 hover:bg-black text-white rounded font-bold text-xs transition-colors disabled:opacity-30 disabled:cursor-not-allowed",children:t("datasource.drop_btn")})]}),c.jsx("p",{className:"text-[10px] text-slate-400 italic",children:t("datasource.drop_table_hint")})]})]}),c.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-red-100 dark:border-red-900/20 rounded-xl p-4 shadow-sm",children:[c.jsx("h4",{className:"text-xs font-black text-slate-400 uppercase mb-3",children:t("datasource.sql_manager_reset_title","SQL Manager reset")}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("div",{className:"flex items-center gap-2",children:c.jsxs("button",{disabled:J,onClick:()=>{mt()},className:"flex items-center gap-2 px-4 py-2 bg-red-700 hover:bg-red-800 text-white rounded font-bold text-xs transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[J&&c.jsx(Ym,{className:"w-4 h-4 animate-spin"}),t("datasource.sql_manager_reset_btn","Reset SQL Manager")]})}),c.jsx("p",{className:"text-[10px] text-slate-400 italic",children:t("datasource.sql_manager_reset_hint","Deletes all saved SQL statements in the SQL Manager, including favorites and usage counters.")})]})]}),c.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-red-100 dark:border-red-900/20 rounded-xl p-4 shadow-sm md:col-span-2",children:[c.jsx("h4",{className:"text-xs font-black text-slate-400 uppercase mb-3",children:t("datasource.factory_reset_title","Werkseinstellungen")}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("div",{className:"flex items-center gap-2",children:c.jsxs("button",{disabled:_e,onClick:async()=>{const Me=t("datasource.factory_reset_confirm","Bist du sicher? Alle Daten (inkl. Tabellen, Views und Indizes), Dashboards, Widgets und lokale Einstellungen werden endgueltig geloescht. Dies kann nicht rueckgaengig gemacht werden!");if(await Xt.confirm(Me)){const kt=await Xt.prompt(t("datasource.factory_reset_prompt",'Bitte tippe "RESET" ein, um fortzufahren:'));if(kt==="RESET")try{je(!0);const{factoryResetDatabase:Tt}=await iA(async()=>{const{factoryResetDatabase:ir}=await Promise.resolve().then(()=>Tu);return{factoryResetDatabase:ir}},void 0);await Tt(),OV(),await Xt.info(t("datasource.factory_reset_success","Datenbank wurde auf Werkseinstellungen zurckgesetzt! Lade neu...")),re(),sessionStorage.removeItem("litebistudio_datasource_tab"),window.location.hash="#/",window.location.reload()}catch(Tt){je(!1),await Xt.error(A(Tt))}else kt!==null&&await Xt.warning(t("datasource.factory_reset_aborted","Abgebrochen: Falsche Eingabe."))}},className:"flex items-center gap-2 px-4 py-2 bg-red-900 hover:bg-black text-white rounded font-bold text-xs transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[_e&&c.jsx(Ym,{className:"w-4 h-4 animate-spin"}),t("datasource.factory_reset_btn","Komplett zurcksetzen")]})}),c.jsx("p",{className:"text-[10px] text-slate-400 italic",children:t("datasource.factory_reset_hint","Loescht die gesamte Datenbank inklusive Tabellen, Views und Indizes, setzt lokale Einstellungen zurueck und erstellt ein frisches, leeres Schema der neuesten Version.")})]})]})]})]})]})]}),c.jsx(Ol,{isOpen:z,onClose:()=>ue(!1),title:t("datasource.create_table_title"),children:c.jsxs("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto",children:[c.jsxs("div",{className:"flex gap-2 mb-4 bg-slate-100 p-1 rounded-lg w-fit",children:[c.jsx("button",{onClick:()=>G(!1),className:`px-3 py-1 text-xs font-bold rounded ${ve?"text-slate-500":"bg-white shadow text-blue-600"}`,children:t("datasource.assistant")}),c.jsx("button",{onClick:()=>G(!0),className:`px-3 py-1 text-xs font-bold rounded ${ve?"bg-white shadow text-blue-600":"text-slate-500"}`,children:"SQL"})]}),ve?c.jsx("textarea",{value:Se,onChange:Me=>we(Me.target.value),className:"w-full h-40 font-mono text-sm p-3 bg-slate-900 text-white rounded-lg"}):c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:t("datasource.name_label")}),c.jsx("input",{value:Z,onChange:Me=>Ae(Me.target.value),className:"w-full p-2 border rounded",placeholder:"usr_tabelle"})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:t("datasource.columns_label")}),F.map((Me,kt)=>c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{value:Me.name,onChange:Tt=>{const ir=[...F];ir[kt].name=Tt.target.value,R(ir)},className:"flex-1 p-2 border rounded text-sm",placeholder:t("datasource.name_label")}),c.jsxs("select",{value:Me.type,onChange:Tt=>{const ir=[...F];ir[kt].type=Tt.target.value,R(ir)},className:"w-32 p-2 border rounded text-sm",children:[c.jsx("option",{value:"TEXT",children:"TEXT"}),c.jsx("option",{value:"INTEGER",children:"INTEGER"}),c.jsx("option",{value:"REAL",children:"REAL"}),c.jsx("option",{value:"INTEGER PRIMARY KEY",children:"ID (PK)"})]}),c.jsx("button",{onClick:()=>R(F.filter((Tt,ir)=>ir!==kt)),className:"text-red-500",children:c.jsx(ds,{className:"w-4 h-4"})})]},kt)),c.jsx("button",{onClick:()=>R([...F,{name:"",type:"TEXT"}]),className:"text-xs text-blue-600 font-bold flex items-center gap-1",children:t("datasource.add_column")})]})]}),c.jsx("div",{className:"flex justify-end gap-2 pt-4",children:c.jsx("button",{onClick:at,className:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-bold",children:t("datasource.create_btn")})})]})}),c.jsx(Ol,{isOpen:w,onClose:()=>v(!1),title:x?.title||h,children:x?c.jsx(RN,{schema:x}):c.jsx("div",{className:"p-4 text-center",children:t("datasource.schema_not_available")})}),c.jsx(Ol,{isOpen:B,onClose:()=>k(!1),title:t("datasource.create_index_title","Index erstellen"),children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"text-xs text-slate-500",children:[t("datasource.index_create_for_table","Tabelle"),": ",c.jsx("span",{className:"font-mono font-semibold text-slate-700",children:N})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:t("datasource.index_name","Indexname")}),c.jsx("input",{value:O,onChange:Me=>T(Me.target.value),className:"w-full p-2 border border-slate-200 rounded text-sm",placeholder:`idx_${N}_...`})]}),c.jsxs("label",{className:"flex items-center gap-2 text-sm text-slate-600",children:[c.jsx("input",{type:"checkbox",checked:H,onChange:()=>j(!H),className:"h-4 w-4"}),t("datasource.index_unique","Unique Index")]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:t("datasource.index_columns","Spalten")}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 max-h-48 overflow-auto border border-slate-200 rounded p-2 bg-slate-50",children:Q.map(Me=>c.jsxs("label",{className:"flex items-center gap-2 text-sm text-slate-700",children:[c.jsx("input",{type:"checkbox",checked:U.includes(Me),onChange:()=>Vt(Me),className:"h-4 w-4"}),c.jsx("span",{className:"font-mono",children:Me})]},Me))})]}),U.length>0&&c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:t("datasource.index_order","Spaltenreihenfolge")}),c.jsx("div",{className:"space-y-1 border border-slate-200 rounded p-2 bg-white",children:U.map((Me,kt)=>c.jsxs("div",{className:"flex items-center justify-between text-sm",children:[c.jsxs("span",{className:"font-mono text-slate-700",children:[kt+1,". ",Me]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("button",{type:"button",onClick:()=>tt(Me,"up"),disabled:kt===0,className:"px-2 py-0.5 text-xs border border-slate-200 rounded disabled:opacity-40",children:""}),c.jsx("button",{type:"button",onClick:()=>tt(Me,"down"),disabled:kt===U.length-1,className:"px-2 py-0.5 text-xs border border-slate-200 rounded disabled:opacity-40",children:""})]})]},Me))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:t("datasource.index_where_optional","WHERE (optional)")}),c.jsx("input",{value:W,onChange:Me=>I(Me.target.value),className:"w-full p-2 border border-slate-200 rounded text-sm font-mono",placeholder:"status = 'open'"})]}),c.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[c.jsx("button",{onClick:()=>k(!1),className:"px-4 py-2 border border-slate-200 rounded-lg text-sm",children:t("common.cancel")}),c.jsx("button",{onClick:()=>{Wt()},className:"px-4 py-2 bg-indigo-600 text-white rounded-lg text-sm font-bold hover:bg-indigo-700",children:t("datasource.create_index_btn","Index erstellen")})]})]})})]})};function hy({data:e,columns:t,searchTerm:r="",searchFields:a=[],emptyMessage:n="No items found",onRowClick:s,sortConfig:l,onSortConfigChange:A,filters:u,onFiltersChange:f,showFilters:h,onShowFiltersChange:g,columnWidths:x,onColumnWidthsChange:m}){const w=ar.useRef(null),v=ar.useRef(null),B=ar.useRef(null),[k,N]=ar.useState(null),[S,O]=ar.useState({}),[T,U]=ar.useState(!1),[D,H]=ar.useState({}),[j]=hr("ui_table_density","normal"),[W]=hr("ui_table_wrap_cells",!1),I=l!==void 0?l:k,Q=u!==void 0?u:S,Y=h!==void 0?h:T,z=x!==void 0?x:D,ue=de=>{l===void 0&&N(de),A?.(de)},Z=de=>{u===void 0&&O(de),f?.(de)},Ae=de=>{h===void 0&&U(de),g?.(de)},ve=ar.useCallback(de=>{x===void 0&&H(de),m?.(de)},[x,m]),G=de=>typeof de.accessor=="string"?de.accessor:de.header,Se=de=>{if(!de)return null;const be=/^(\d+)px$/i.exec(de.trim());return be?Number(be[1]):null},we=de=>{const be=G(de);if(z[be])return Math.max(90,z[be]);const Le=Se(de.width);return Le?Math.max(90,Le):150},F=X.useCallback((de,be)=>de[be],[]),R=X.useMemo(()=>{let de=e;if(r){const be=r.toLowerCase();de=de.filter(Le=>a.some(ie=>{const _e=Le[ie];return String(_e??"").toLowerCase().includes(be)}))}return Object.keys(Q).length>0&&(de=de.filter(be=>Object.entries(Q).every(([Le,ie])=>{if(!ie)return!0;const _e=t.find(J=>(typeof J.accessor=="string"?J.accessor:J.header)===Le);if(!_e)return!0;let je;return typeof _e.accessor=="function"?je=_e.accessor(be):je=F(be,_e.accessor),String(je??"").toLowerCase().includes(ie.toLowerCase())}))),I&&(de=[...de].sort((be,Le)=>{const ie=t.find(ze=>ze.accessor===I.key||typeof ze.accessor=="string"&&ze.accessor===I.key);let _e,je;if(ie&&typeof ie.accessor=="function"?(_e=ie.accessor(be),je=ie.accessor(Le)):(_e=F(be,I.key),je=F(Le,I.key)),_e===je)return 0;if(_e==null)return 1;if(je==null)return-1;const J=_e<je?-1:1;return I.direction==="asc"?J:-J})),de},[e,r,a,I,t,Q,F]),M=()=>{w.current&&v.current&&(w.current.scrollLeft=v.current.scrollLeft)},P=(de,be)=>{de.preventDefault(),de.stopPropagation(),B.current={key:G(be),startX:de.clientX,startWidth:we(be)}};ar.useEffect(()=>{const de=Le=>{const ie=B.current;if(!ie)return;const _e=Math.max(90,Math.min(900,ie.startWidth+(Le.clientX-ie.startX)));z[ie.key]!==_e&&ve({...z,[ie.key]:_e})},be=()=>{B.current=null};return window.addEventListener("mousemove",de),window.addEventListener("mouseup",be),()=>{window.removeEventListener("mousemove",de),window.removeEventListener("mouseup",be)}},[z,ve]);const re=de=>{const be=G(de);let Le="asc";I&&I.key===be&&I.direction==="asc"&&(Le="desc"),ue({key:be,direction:Le})},ge=(de,be)=>{Z({...Q,[de]:be})},Ce=()=>c.jsx("colgroup",{children:t.map((de,be)=>c.jsx("col",{style:{width:`${we(de)}px`,minWidth:`${we(de)}px`}},be))});return c.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden h-full relative border rounded-lg border-slate-300 dark:border-slate-700",children:[c.jsx("div",{ref:w,className:"overflow-hidden flex-none bg-slate-50 dark:bg-slate-900 border-b border-slate-300 dark:border-slate-700",children:c.jsxs("table",{className:"w-full text-sm text-left table-fixed",children:[Ce(),c.jsxs("thead",{className:"text-[10px] text-slate-400 uppercase font-bold text-left",children:[c.jsx("tr",{children:t.map((de,be)=>{const Le=G(de),ie=I?.key===Le;return c.jsxs("th",{className:`relative px-4 ${j==="compact"?"py-2":"py-3"} truncate cursor-pointer select-none hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors ${de.align==="right"?"text-right":de.align==="center"?"text-center":"text-left"} ${de.className||""}`,title:de.header,onClick:()=>re(de),children:[c.jsxs("div",{className:`flex items-center gap-1.5 ${de.align==="right"?"justify-end":de.align==="center"?"justify-center":"justify-start"}`,children:[be===0&&c.jsx("button",{onClick:_e=>{_e.stopPropagation(),Ae(!Y)},className:`p-1 rounded hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors mr-2 ${Y||Object.keys(Q).length>0?"text-blue-600 bg-blue-100 dark:bg-blue-900/40":"text-slate-500 hover:text-slate-700"}`,title:"Toggle Column Filters",children:c.jsx(sf,{className:"w-4 h-4"})}),c.jsx("span",{className:"truncate",children:de.header}),ie&&c.jsx("span",{className:"text-blue-500 text-[9px]",children:I?.direction==="asc"?"":""})]}),c.jsx("div",{className:"absolute top-0 right-0 h-full w-2 cursor-col-resize group",onMouseDown:_e=>P(_e,de),role:"separator","aria-orientation":"vertical","aria-label":`Resize ${de.header}`,children:c.jsx("div",{className:"mx-auto h-full w-px bg-slate-300 dark:bg-slate-700 opacity-0 group-hover:opacity-100"})})]},be)})}),Y&&c.jsx("tr",{className:"bg-slate-100/50 dark:bg-slate-800/50",children:t.map((de,be)=>{const Le=typeof de.accessor=="string"?de.accessor:de.header;return c.jsx("th",{className:`px-2 ${j==="compact"?"py-0.5":"py-1"}`,children:c.jsxs("div",{className:"relative flex items-center",children:[c.jsx("input",{type:"text",value:Q[Le]||"",onChange:ie=>ge(Le,ie.target.value),onClick:ie=>ie.stopPropagation(),placeholder:`Filter ${de.header}...`,className:"w-full px-2 py-1 text-[10px] font-normal border border-slate-300 dark:border-slate-600 rounded bg-white dark:bg-slate-900 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-1 focus:ring-blue-500 placeholder:text-slate-300"}),Q[Le]&&c.jsx("button",{onClick:ie=>{ie.stopPropagation(),ge(Le,"")},className:"absolute right-1 text-slate-400 hover:text-slate-600 dark:hover:text-slate-200",children:c.jsx(nl,{className:"w-3 h-3"})})]})},be)})})]})]})}),c.jsx("div",{ref:v,onScroll:M,className:"flex-1 overflow-auto bg-white dark:bg-slate-800",children:c.jsxs("table",{className:"w-full text-sm text-left table-fixed",children:[Ce(),c.jsxs("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:[R.map((de,be)=>c.jsx("tr",{onClick:()=>s&&s(de),className:`transition-colors group ${s?"cursor-pointer hover:bg-blue-50 dark:hover:bg-blue-900/20":"hover:bg-slate-50 dark:hover:bg-slate-700/30"}`,children:t.map((Le,ie)=>{const _e=typeof Le.accessor=="function"?Le.accessor(de):F(de,Le.accessor),je=Le.render?Le.render(de):typeof _e=="string"||typeof _e=="number"?_e:_e==null?"":String(_e);return c.jsx("td",{className:`px-4 ${j==="compact"?"py-2":"py-3"} ${W?"whitespace-normal break-words":"truncate"} ${Le.align==="right"?"text-right":Le.align==="center"?"text-center":"text-left"} ${Le.className||""}`,title:typeof _e=="string"?_e:void 0,children:je},ie)})},be)),R.length===0&&c.jsx("tr",{children:c.jsxs("td",{colSpan:t.length,className:"px-6 py-20 text-center text-slate-400",children:[c.jsx(fo,{className:"w-12 h-12 mx-auto mb-4 opacity-10"}),c.jsx("p",{className:"text-lg",children:n})]})})]})]})})]})}const am=fA("RecordDetail"),Zx=({isOpen:e,onClose:t,items:r,initialIndex:a=0,title:n,tableName:s,schema:l})=>{const{t:A}=tn(),[u,f]=X.useState(a),[h,g]=X.useState(null),[x,m]=X.useState(null),[w,v]=X.useState(!1),[B,k]=X.useState(!1),[N,S]=X.useState(null),[O,T]=X.useState(null),[U,D]=X.useState(null),[H,j]=X.useState(!1),W=n||A("record_detail.title"),I=s||"unknown",Q=ar.useRef(!1);X.useEffect(()=>{if(!e){Q.current=!1;return}if(e&&!Q.current&&r&&r.length>0){const R=Math.max(0,a);f(R),m(R),g(null),v(!1),Q.current=!0}},[e,a,r]),X.useEffect(()=>{if(e){if(l){D(l);return}s&&s!=="unknown"?(async()=>{const M=await Dt.getTableSchema(s);if(M&&M.length>0){const P={title:`${A("datasource.tab_structure")}: ${s}`,description:A("datasource.user_tables_hint"),type:"object",properties:M.reduce((re,ge)=>(re[ge.name]={type:ge.type.toLowerCase().includes("int")||ge.type.toLowerCase().includes("real")?"number":"string",description:`${ge.name} (${ge.type})`},re),{})};D(P)}else D(null)})():D(null)}},[e,s,l,A]);const Y=X.useCallback(async R=>{if(!R)return null;try{const ge=(await Dt.getTableSchema(I)).find(Ce=>Ce.pk===1)?.name;if(ge&&R[ge]!==void 0&&R[ge]!==null){const Ce=R[ge];if(typeof Ce=="string"||typeof Ce=="number")return Ce}}catch{}if(R._rowid!==void 0&&R._rowid!==null){const re=R._rowid;if(typeof re=="string"||typeof re=="number")return re}const M=Object.keys(R).find(re=>re.toLowerCase()==="id"||re.toLowerCase()==="entryid"||re.toLowerCase()==="rowid");if(M&&R[M]!==void 0&&R[M]!==null){const re=R[M];if(typeof re=="string"||typeof re=="number")return re}const P=Object.keys(R).find(re=>re.toLowerCase().endsWith("_id")||re.toLowerCase().endsWith("id"));if(P&&R[P]!==void 0&&R[P]!==null){const re=R[P];if(typeof re=="string"||typeof re=="number")return re}return null},[I]);X.useEffect(()=>{e&&(async()=>{const M=r[u];if(M){const P=await Y(M),re=await Dt.getRecordMetadata(I,P??"");k(re.isInWorklist),S(re.worklistItem),T(re.exists)}else T(null),S(null),k(!1)})()},[e,u,r,I,Y]);const z=async()=>{if(H)return;const R=r[u],M=await Y(R);if(!M){am.warn("Cannot toggle worklist: No unique ID found for record",R);return}j(!0);try{if(B)await Dt.executeRaw("DELETE FROM sys_worklist WHERE source_table = ? AND source_id = ?",[I,M]),k(!1),S(null);else{const P=["name","title","description","label","display_name","VendorName","Description"];let re="";for(const be of P){const Le=Object.keys(R).find(ie=>ie.toLowerCase()===be.toLowerCase());if(Le&&R[Le]){re=String(R[Le]);break}}re||(re=A("worklist.entry_id",{id:M}));const ge=["period","fiscalyear","category","type","group","Period"];let Ce=I;for(const be of ge){const Le=Object.keys(R).find(ie=>ie.toLowerCase()===be.toLowerCase());if(Le&&R[Le]){Ce=String(R[Le]);break}}await Dt.executeRaw("INSERT INTO sys_worklist (source_table, source_id, display_label, display_context) VALUES (?, ?, ?, ?)",[I,M,re,Ce]);const de=await Dt.getRecordMetadata(I,M);k(!0),S(de.worklistItem)}window.dispatchEvent(new Event("db-changed"))}catch(P){am.error("Failed to toggle worklist status",P)}finally{j(!1)}},ue=()=>{m(x===u?null:u)},Z=R=>{g(u),f(R)};if(!r||r.length===0)return null;const Ae=r[u],ve=x!==null?r[x]:h!==null&&h>=0&&h<r.length?r[h]:null,G=x!==null,Se=x===u;if(!Ae)return null;const we=R=>{if(R==null)return null;const M=String(R).trim();if(!M)return null;const P=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,re=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,ge=/^[A-Z]{2}\d{2}[A-Z0-9]{10,30}$/i,Ce=/^https?:\/\/[^\s/$.?#].[^\s]*$/i,de=(()=>{if(!(/^\d{4}-\d{2}-\d{2}/.test(M)||/^\d{2}[./-]\d{2}[./-]\d{2,4}$/.test(M)))return!1;const Le=Date.parse(M.replace(/\./g,"-"));return!Number.isNaN(Le)})();return P.test(M)?"email":re.test(M)?"uuid":ge.test(M)?"iban":Ce.test(M)?"url":de?"date":null},F=R=>{if(R==null)return!1;const M=String(R);if(!M.trim())return!1;let P=!1;for(let Ce=0;Ce<M.length;Ce++){const de=M.charCodeAt(Ce);if(de<32&&de!==9&&de!==10&&de!==13){P=!0;break}}const re=M.length>256&&!/\s/.test(M),ge=/<script|javascript:/i.test(M);return P||re||ge};return c.jsxs(c.Fragment,{children:[c.jsx(Ol,{isOpen:e,onClose:t,title:r.length>1?`${W} (${u+1} / ${r.length})`:W,noScroll:!0,children:c.jsxs("div",{className:"flex flex-col h-full min-h-0 bg-white dark:bg-slate-800",children:[c.jsxs("div",{className:"shrink-0 px-6 py-3 bg-slate-50 dark:bg-slate-900/50 border-b border-slate-200 dark:border-slate-700 flex items-center justify-between z-20",children:[c.jsxs("div",{className:"flex items-center gap-1",children:[U&&c.jsx("button",{onClick:()=>v(!0),className:"p-1.5 rounded-lg border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors text-slate-500",title:A("record_detail.schema_definition"),children:c.jsx(qc,{className:"w-4 h-4"})}),c.jsx("button",{onClick:z,disabled:H,className:`p-1.5 rounded-lg border transition-colors flex items-center gap-1.5 ${H?"opacity-50 cursor-not-allowed":""} ${B?"bg-amber-50 border-amber-200 text-amber-600 dark:bg-amber-900/20 dark:border-amber-800 dark:text-amber-400":"bg-white border-slate-300 text-slate-500 hover:bg-slate-50 dark:bg-slate-800 dark:border-slate-700 dark:hover:bg-slate-700"}`,title:A(B?"record_detail.remove_worklist":"record_detail.add_worklist"),children:H?c.jsx(Ic,{className:"w-4 h-4 animate-spin"}):c.jsx(S8,{className:`w-4 h-4 ${B?"fill-current":""}`})}),c.jsx("div",{className:"h-4 w-[1px] bg-slate-200 dark:bg-slate-700 mx-1"}),c.jsxs("button",{onClick:ue,className:`p-1.5 rounded-lg border transition-colors flex items-center gap-1.5 group relative ${G?"bg-blue-50 border-blue-200 text-blue-600 dark:bg-blue-900/20 dark:border-blue-800 dark:text-blue-400":"bg-white border-slate-300 text-slate-500 hover:bg-slate-50 dark:bg-slate-800 dark:border-slate-700 dark:hover:bg-slate-700"}`,title:A(Se?"record_detail.clear_reference":"record_detail.set_reference"),children:[c.jsx(tB,{className:`w-4 h-4 ${G?"fill-current":""}`}),G&&!Se&&c.jsxs("span",{className:"absolute -top-1 -right-1 flex h-2.5 w-2.5",children:[c.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-blue-400 opacity-75"}),c.jsx("span",{className:"relative inline-flex rounded-full h-2.5 w-2.5 bg-blue-500"})]})]}),c.jsx("div",{className:"h-4 w-[1px] bg-slate-200 dark:bg-slate-700 mx-1"}),c.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest px-2",children:A("record_detail.navigation")})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[O===!1&&c.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 border border-red-200 dark:border-red-800 rounded-lg text-[10px] font-black animate-pulse",children:[c.jsx(il,{className:"w-3.5 h-3.5"})," ",A("record_detail.deleted_badge")]}),c.jsx("button",{disabled:u===0,onClick:()=>Z(u-1),className:"p-1.5 rounded-lg border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-800 disabled:opacity-30 disabled:cursor-not-allowed hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors",children:c.jsx(SS,{className:"w-4 h-4"})}),c.jsxs("div",{className:"text-[11px] font-black text-slate-700 dark:text-slate-200 min-w-[60px] text-center bg-white dark:bg-slate-800 px-2 py-1 rounded-md border border-slate-200 dark:border-slate-800 shadow-sm",children:[u+1," / ",r.length]}),c.jsx("button",{disabled:u===r.length-1,onClick:()=>Z(u+1),className:"p-1.5 rounded-lg border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-800 disabled:opacity-30 disabled:cursor-not-allowed hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors",children:c.jsx(Ul,{className:"w-4 h-4"})})]})]}),B&&c.jsx("div",{className:"shrink-0 px-6 py-4 bg-amber-50/30 dark:bg-amber-900/5 border-b border-slate-200 dark:border-slate-700 space-y-3",children:c.jsxs("div",{className:"flex items-start gap-4",children:[c.jsxs("div",{className:"w-48 shrink-0",children:[c.jsx("label",{className:"block text-[9px] font-black uppercase text-amber-600 dark:text-amber-400 mb-1.5 px-1",children:A("record_detail.status_label")}),c.jsxs("select",{value:typeof N?.status=="string"?N.status:"open",onChange:async R=>{if(N){const M=R.target.value;S(P=>P&&{...P,status:M});try{await Dt.updateWorklistItem(N.id,{status:M})}catch(P){am.error("Failed to update status",P)}}},className:"w-full p-2 bg-white dark:bg-slate-800 border border-amber-200 dark:border-amber-900/50 rounded-xl text-xs font-bold outline-none focus:ring-2 focus:ring-amber-500/20 transition-all cursor-pointer",children:[c.jsx("option",{value:"open",children:A("worklist.status_open","Neu / Offen")}),c.jsx("option",{value:"in_progress",children:A("worklist.status_in_progress","In Bearbeitung")}),c.jsx("option",{value:"done",children:A("worklist.status_done","Erledigt")}),c.jsx("option",{value:"closed",children:A("worklist.status_closed","Geschlossen")})]})]}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("label",{className:"block text-[9px] font-black uppercase text-amber-600 dark:text-amber-400 mb-1.5 px-1",children:A("record_detail.comment_label")}),c.jsx("textarea",{value:typeof N?.comment=="string"?N.comment:"",onChange:R=>S(M=>M&&{...M,comment:R.target.value}),onBlur:async R=>{if(N)try{await Dt.updateWorklistItem(N.id,{comment:R.target.value})}catch(M){am.error("Failed to update comment",M)}},placeholder:A("record_detail.comment_placeholder"),className:"w-full p-2 h-[37px] bg-white dark:bg-slate-800 border border-amber-200 dark:border-amber-900/50 rounded-xl text-xs font-medium outline-none focus:ring-2 focus:ring-amber-500/20 transition-all resize-none overflow-hidden hover:overflow-y-auto"})]})]})}),c.jsxs("div",{className:"flex-1 overflow-auto p-6 pt-4 min-h-0 scrollbar-thin scrollbar-thumb-slate-200 dark:scrollbar-thumb-slate-700",children:[G&&!Se&&c.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/10 border border-blue-100 dark:border-blue-900/30 rounded-lg px-3 py-2 text-[10px] text-blue-700 dark:text-blue-300 flex items-center gap-2 mb-6",children:[c.jsx(tB,{className:"w-3.5 h-3.5"}),c.jsx("span",{className:"font-bold",children:A("record_detail.comparison_active")}),c.jsx("span",{children:A("record_detail.differences_relative",{id:r[x].id||x+1})})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6",children:Object.entries(Ae).map(([R,M])=>{if(R.startsWith("is")||R==="compositeKey"||R==="status")return null;const P=ve&&String(M)!==String(ve[R]);return c.jsxs("div",{className:`
                                            border-b border-slate-100 dark:border-slate-700/50 pb-2 transition-colors duration-500
                                            ${P?"bg-amber-50 dark:bg-amber-900/20 -mx-2 px-2 rounded-lg border-amber-200 dark:border-amber-800 shadow-sm":""}
                                        `,children:[c.jsxs("dt",{className:"text-[10px] font-bold uppercase text-slate-400 mb-1 flex items-center justify-between tracking-wider",children:[R,P&&c.jsx("span",{className:"text-[9px] bg-amber-200 dark:bg-amber-800 text-amber-800 dark:text-amber-200 px-1.5 rounded-full font-black",children:"DIFF"})]}),c.jsx("dd",{className:`text-sm font-semibold break-all ${P?"text-amber-900 dark:text-amber-100":"text-slate-900 dark:text-white"}`,children:M==null||M===""?c.jsx("span",{className:"text-slate-300 italic",children:A("record_detail.empty_value")}):c.jsxs("div",{className:"flex flex-wrap items-start gap-2",children:[c.jsx("span",{children:String(M)}),(()=>{const re=we(M);return re?c.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded-full border border-indigo-200 bg-indigo-50 text-indigo-700 text-[10px] font-black uppercase tracking-wide",children:A(`record_detail.pattern_${re}`)}):null})(),F(M)&&c.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded-full border border-amber-200 bg-amber-50 text-amber-700 text-[10px] font-black uppercase tracking-wide",children:A("record_detail.suspicious")})]})})]},R)})})]})]})}),U&&w&&c.jsx(Ol,{isOpen:w,onClose:()=>v(!1),title:U.title||W,children:c.jsxs("div",{className:"space-y-6",children:[c.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 italic",children:U.description}),c.jsx(RN,{schema:U}),c.jsx("button",{onClick:()=>v(!1),className:"w-full py-2.5 bg-slate-900 dark:bg-slate-100 text-white dark:text-slate-900 rounded-xl font-bold text-xs transition-opacity hover:opacity-90 mt-4",children:A("record_detail.close")})]})})]})},yw="data_inspector_pending_sql",_w="data_inspector_return_hash",MV=["SELECT","FROM","WHERE","GROUP BY","ORDER BY","HAVING","LIMIT","OFFSET","JOIN","LEFT JOIN","RIGHT JOIN","INNER JOIN","ON","AND","OR","NOT","IN","LIKE","IS NULL","IS NOT NULL","COUNT(*)","SUM()","AVG()","MIN()","MAX()","DISTINCT"],HV=({onBack:e})=>{const{t,i18n:r}=tn(),{isAdminMode:a}=Mo(),n="global",s="data_inspector_sql_library_migrated_v1",[l,A]=X.useState("table"),[u,f]=X.useState(""),[h,g]=hr("data_inspector_sql_history",[]),[x]=hr("data_inspector_explain_mode",!1),[m,w]=hr("data_inspector_sql_assist_open",!0),[v,B]=hr("data_inspector_autocomplete_enabled",!0),[k]=hr("data_inspector_sql_require_limit_confirm",!0),[N]=hr("data_inspector_sql_max_rows",5e3),[S,O]=X.useState([]),[T,U]=X.useState(""),[D,H]=X.useState("manager"),[j,W]=hr("data_inspector_table_tools_open",!1),[I,Q]=hr("data_inspector_table_tools_tab_v1","columns"),[Y,z]=X.useState([]),[ue,Z]=X.useState([]),[Ae,ve]=X.useState(""),[G,Se]=X.useState(""),[we,F]=hr("data_inspector_sql_manager_panels_v1",{templates:!0,manager:!0,recent:!0}),[R,M]=X.useState(""),[P,re]=X.useState([]),[ge,Ce]=X.useState(""),[de,be]=X.useState(""),[Le,ie]=X.useState("DESC"),[_e,je]=X.useState(100),[J,ze]=X.useState("none"),[He,ct]=X.useState(""),[Xe,Ut]=X.useState(""),[yt,qt]=X.useState("metric_value"),[Lt,jt]=X.useState([]),[Pt,zt]=X.useState(""),[Jt,It]=X.useState(!1),[xt,ht]=X.useState(x?"explain":"result"),[Bt,pr]=X.useState(""),[$t,Ee]=X.useState(""),[at,it]=X.useState(!1),[bt,Et]=X.useState(""),[mt,Ot]=X.useState([]),[Ur,Vt]=X.useState(!1),[tt,Wt]=X.useState(""),[Me,kt]=X.useState(!1),[Tt,ir]=X.useState([]),[Nt,Sr]=X.useState(!1),[ca,Hr]=X.useState(""),[Br,jr]=hr("data_inspector_sql_editor_height",160),[Er,ae]=X.useState(Br),xe=X.useRef(null),[fe,pe]=X.useState(0),[K,se]=X.useState(!1),[Fe,Re]=X.useState(0),[Qe,Pe]=X.useState({top:12,left:12,width:320}),[qe,pt]=X.useState(""),[et,Rt]=X.useState(""),[Ct,Qt]=X.useState(null),[Gt,wa]=hr("data_inspector_page_size",100),[Pr,sa]=X.useState(1),[vs,Bi]=X.useState(""),Wi=(Pr-1)*Gt,[rn,ki]=X.useState(null),[Ca,Vs]=X.useState({}),[ii]=hr("data_table_default_show_filters",!1),[ia,li]=X.useState(ii),[Xi,Pl]=hr("data_inspector_column_widths_v1",{}),[Ko,ws]=hr("data_inspector_saved_views",[]),[Fa,an]=hr("data_inspector_active_view",""),[mA]=hr("data_inspector_show_profiling",!0),[oi,xA]=X.useState(mA?"profiling":"data"),[hn,qo]=hr("data_inspector_profiling_thresholds",{nullRate:30,cardinalityRate:95}),[Kl,Ci]=X.useState(!1),ql=X.useRef(null),bA=X.useRef(Er),oc=X.useRef(0),[vA,Ac]=X.useState(null);X.useEffect(()=>{li(ii)},[ii,et]),X.useEffect(()=>{const ne=localStorage.getItem(yw),De=localStorage.getItem(_w);if(De){const ut=De.startsWith("#/")?De:"#/";Ac(ut),localStorage.removeItem(_w)}ne&&(localStorage.removeItem(yw),A("sql"),f(ne),ht("result"))},[]);const Yi=X.useCallback(ne=>ne.trim().replace(/\s+/g," ").toLowerCase(),[]),Ta=X.useCallback(async()=>{const ne=await Dt.listSqlStatements(n);O(ne)},[n]);X.useEffect(()=>{Ta()},[Ta]),X.useEffect(()=>{(async()=>{if(localStorage.getItem(s)!=="true")try{const ut=await Dt.listSqlStatements(n),Ft=new Set(ut.map(mr=>Yi(mr.sql_text))),ur=localStorage.getItem("data_inspector_custom_sql_templates"),dr=localStorage.getItem("data_inspector_favorite_queries"),qr=ur?JSON.parse(ur):[],Fr=dr?JSON.parse(dr):[];for(const mr of qr){const $r=(mr.sql||"").trim();if(!$r)continue;const sn=Yi($r);Ft.has(sn)||(await Dt.saveSqlStatement({id:crypto.randomUUID(),name:(mr.name||t("datainspector.save_template")).trim()||`Template ${Ft.size+1}`,sql_text:$r,scope:n}),Ft.add(sn))}for(const mr of Fr){const $r=mr.trim();if(!$r)continue;const sn=Yi($r);if(Ft.has(sn))continue;const Tr=$r.split(`
`).map(xr=>xr.trim()).find(Boolean)||$r;await Dt.saveSqlStatement({id:crypto.randomUUID(),name:`${t("datainspector.favorite_queries")}: ${Tr.slice(0,36)}`,sql_text:$r,scope:n,is_favorite:!0}),Ft.add(sn)}localStorage.setItem(s,"true"),await Ta()}catch{localStorage.setItem(s,"true")}})()},[s,n,Ta,Yi,t]);const{data:Us}=ri(async()=>{const ne=await Dt.getDataSources(),De=a?ne:ne.filter(ut=>!ut.name.startsWith("sys_"));return De.length>0&&(!et||et.startsWith("sys_")&&!a)&&Rt(De[0].name),De},[a]),ys=ar.useMemo(()=>(Us||[]).map(ne=>ne.name),[Us]),_s=ar.useMemo(()=>Us?.find(ne=>ne.name===et)?.type??"table",[Us,et]),po=ar.useMemo(()=>et?Xi[et]||{}:{},[Xi,et]),_r=X.useCallback(ne=>{et&&Pl(De=>({...De,[et]:ne}))},[et,Pl]),{data:ma,loading:$i,error:cc,refresh:Ga}=ri(async()=>l==="table"?et?await Dt.inspectTable(et,Gt,qe,Wi,_s):[]:Bt?await Dt.executeRaw(Bt):[],[l,et,_s,Gt,Pr,Bt]),{data:Kn}=ri(async()=>l!=="table"||!et?0:await Dt.countTableRows(et,qe),[l,et,qe]),go=Math.max(1,Math.ceil((Kn||0)/Gt)),{data:jn}=ri(async()=>et?await Dt.getTableSchema(et):[],[et]),{data:Bs}=ri(async()=>R?await Dt.getTableSchema(R):[],[R]);X.useEffect(()=>{const ne=(jn||[]).map(De=>De.name);if(ne.length===0){ve("");return}(!Ae||!ne.includes(Ae))&&ve(ne[0])},[jn,Ae]),X.useEffect(()=>{const ne=(jn||[]).map(De=>De.name);z(De=>De.filter(ut=>ne.includes(ut)))},[jn]);const zl=ar.useMemo(()=>{const ne=ma&&ma.length>0?Object.keys(ma[0]).filter(De=>De!=="_rowid"):[];return ue.length>0?ne.filter(De=>ue.includes(De)):ne},[ma,ue]);X.useEffect(()=>{l!=="table"||!j||I!=="columns"||zl.length!==0&&z(zl)},[zl,l,j,I]),X.useEffect(()=>{Z([])},[et]),X.useEffect(()=>{if(l==="table"){const ne=setTimeout(()=>{Ga()},500);return()=>clearTimeout(ne)}},[qe,l,Ga]);const qn=X.useCallback(async ne=>{const De=ne.trim();if(!De)return;const ut=De.toUpperCase();if(/^(INSERT|UPDATE|DELETE|DROP|CREATE|ALTER|REPLACE|TRUNCATE|VACUUM|ATTACH|DETACH)\b/.test(ut)&&!await Xt.confirm(t("datainspector.write_confirm")))return;const ur=/^\s*SELECT\b/i.test(De),dr=/\bLIMIT\b/i.test(De);if(ur&&!dr&&k&&!await Xt.confirm(t("datainspector.limit_confirm_prompt",{limit:N})))return;let qr=De.replace(/;\s*$/,"");if(ur){const Fr=Math.max(1,Math.floor(N||1));qr=`SELECT * FROM (${qr}) AS __litebi_guard LIMIT ${Fr}`,Ee(t("datainspector.limit_applied_notice",{limit:Fr}))}else Ee("");ht("result"),pr(qr),Ga(),g(Fr=>[De,...Fr.filter(mr=>mr!==De)].slice(0,12))},[Ga,g,N,k,t]),Yc=async()=>{await qn(u)},Si=async()=>{await Dt.abortActiveQueries()||await Xt.info(t("datainspector.cancel_not_available","No cancellable SQL query is currently running in this tab."))},zo=X.useCallback(async ne=>{const De=ne.trim();if(!De){jt([]),zt("");return}It(!0),zt("");try{const ut=await Dt.executeRaw(`EXPLAIN QUERY PLAN ${De}`);jt(ut)}catch(ut){jt([]),zt(ut instanceof Error?ut.message:String(ut))}finally{It(!1)}},[]),wA=async ne=>{const De=ne.trim();if(!De)return;const ut=Yi(De),Ft=S.find(dr=>Yi(dr.sql_text)===ut);if(Ft){await Dt.setSqlStatementFavorite(Ft.id,Number(Ft.is_favorite)!==1),await Ta();return}const ur=De.split(`
`).map(dr=>dr.trim()).find(Boolean)||De;await Dt.saveSqlStatement({id:crypto.randomUUID(),name:ur.slice(0,42),sql_text:De,scope:n,is_favorite:!0}),await Ta()},zn=async()=>{const ne=u.trim();if(!ne)return;const De=`${et||"Query"} Template`,ut=(await Xt.prompt(t("datainspector.custom_template_prompt"),{defaultValue:De}))?.trim();if(!ut)return;const Ft=S.find(dr=>dr.name.toLowerCase()===ut.toLowerCase()&&dr.scope===n);if(Ft&&!await Xt.confirm(t("datainspector.custom_template_overwrite_confirm",{name:ut})))return;const ur=Ft?.id||crypto.randomUUID();await Dt.saveSqlStatement({id:ur,name:ut,sql_text:ne,scope:n,is_favorite:Ft?Number(Ft.is_favorite)===1:!1}),await Ta()},Al=ne=>{Rt(ne.table),pt(ne.searchTerm),ki(ne.sortConfig),Vs(ne.filters||{}),li(!!ne.showFilters),A("table")},Ai=async()=>{const ne=Ko.find(Ft=>Ft.id===Fa)?.name||`${et} View`,De=(await Xt.prompt(t("datainspector.new_view_prompt"),{defaultValue:ne}))?.trim();if(!De)return;const ut={id:Fa||crypto.randomUUID(),name:De,table:et,searchTerm:qe,sortConfig:rn,filters:Ca,showFilters:ia};ws(Ft=>{const ur=Ft.filter(dr=>dr.id!==ut.id);return[ut,...ur].slice(0,20)}),an(ut.id)},cl=async()=>{Fa&&await Xt.confirm(t("datainspector.delete_view_confirm"))&&(ws(ne=>ne.filter(De=>De.id!==Fa)),an(""))},Vn=X.useCallback(ne=>`"${ne.replace(/"/g,'""')}"`,[]),mo=()=>{!et||_s!=="table"||(Et(`idx_${et}_`),Ot([]),Vt(!1),Wt(""),it(!0))},Vl=ne=>{Ot(De=>De.includes(ne)?De.filter(ut=>ut!==ne):[...De,ne])},ul=(ne,De)=>{Ot(ut=>{const Ft=ut.indexOf(ne);if(Ft===-1)return ut;const ur=De==="up"?Ft-1:Ft+1;if(ur<0||ur>=ut.length)return ut;const dr=[...ut];return[dr[Ft],dr[ur]]=[dr[ur],dr[Ft]],dr})},Vo=async()=>{const ne=bt.trim();if(!(!et||_s!=="table")){if(!ne){await Xt.warning(t("datasource.index_create_name_required","Please provide an index name."));return}if(mt.length===0){await Xt.warning(t("datasource.index_create_columns_required","Please select at least one column."));return}kt(!0);try{const De=Ur?"UNIQUE ":"",ut=mt.map(Vn).join(", "),Ft=tt.trim()?` WHERE ${tt.trim()}`:"",ur=`CREATE ${De}INDEX ${Vn(ne)} ON ${Vn(et)} (${ut})${Ft};`;await Dt.executeRaw(ur),it(!1),Ga(),await Xt.info(t("datasource.index_create_success","Index created."))}catch(De){await Xt.error(t("common.error")+": "+(De instanceof Error?De.message:String(De)))}finally{kt(!1)}}},yA=X.useCallback((ne,De)=>`idx_${ne}_${De.join("_")}`.toLowerCase().replace(/[^a-z0-9_]/g,"_").slice(0,60),[]),dl=X.useCallback(async ne=>{const De=Vn(ne),Ft=(await Dt.executeRaw(`PRAGMA index_list(${De});`)).map(dr=>String(dr.name??"")).filter(Boolean),ur=[];for(const dr of Ft){const Fr=(await Dt.executeRaw(`PRAGMA index_info(${Vn(dr)});`)).map(mr=>String(mr.name??"")).filter(Boolean);Fr.length>0&&ur.push(Fr)}return ur},[Vn]),Gl=X.useCallback(async()=>{if(!(!et||_s!=="table")){Sr(!0);try{const ne=(jn||[]).map(xr=>xr.name);if(ne.length===0){ir([]);return}const De=await dl(et),ut=await Dt.executeRaw(`SELECT COUNT(*) AS total_rows FROM ${Vn(et)};`),Ft=Number(ut[0]?.total_rows??0),ur=ne.slice(0,14),dr=await Promise.all(ur.map(async xr=>{const ta=await Dt.executeRaw(`SELECT COUNT(DISTINCT ${Vn(xr)}) AS distinct_count FROM ${Vn(et)};`),ra=Number(ta[0]?.distinct_count??0),js=Ft>0?ra/Ft:0;return{column:xr,distinctCount:ra,ratio:js}})),qr=[],Fr=new Set,mr=(xr,ta,ra)=>{const js=xr.filter(Boolean);if(js.length===0)return;const mn=js.join("|").toLowerCase();Fr.has(mn)||(Fr.add(mn),qr.push({columns:js,reason:ta,score:ra}))},$r=Object.keys(Ca).filter(xr=>ne.includes(xr));if($r.forEach((xr,ta)=>{mr([xr],t("datainspector.index_suggestion_reason_filter","Used in active table filter"),95-ta)}),rn?.key&&ne.includes(String(rn.key))&&mr([String(rn.key)],t("datainspector.index_suggestion_reason_sort","Used as active sort column"),92),$r.length>1)mr($r.slice(0,2),t("datainspector.index_suggestion_reason_composite","Composite index for combined filters"),96);else if($r.length===1&&rn?.key&&ne.includes(String(rn.key))){const xr=String(rn.key);xr!==$r[0]&&mr([$r[0],xr],t("datainspector.index_suggestion_reason_filter_sort","Composite index for filter + sort"),97)}dr.sort((xr,ta)=>ta.ratio-xr.ratio).slice(0,3).forEach((xr,ta)=>{xr.ratio<.08||mr([xr.column],t("datainspector.index_suggestion_reason_cardinality","High cardinality column"),86-ta)});const sn=xr=>De.some(ta=>ta.length>=xr.length&&xr.every((ra,js)=>ta[js]===ra)),Tr=qr.filter(xr=>!sn(xr.columns)).sort((xr,ta)=>ta.score-xr.score).slice(0,5).map(xr=>{const ta=yA(et,xr.columns),ra=xr.columns.map(js=>Vn(js)).join(", ");return{id:`${et}:${xr.columns.join("|")}`,indexName:ta,columns:xr.columns,reason:xr.reason,score:xr.score,sql:`CREATE INDEX ${Vn(ta)} ON ${Vn(et)} (${ra});`}});ir(Tr)}catch(ne){await Xt.error(t("common.error")+": "+(ne instanceof Error?ne.message:String(ne)))}finally{Sr(!1)}}},[yA,dl,Vn,_s,et,jn,Ca,rn,t]),$c=X.useCallback(async ne=>{Hr(ne.id);try{await Dt.executeRaw(ne.sql),await Xt.info(t("datasource.index_create_success","Index created.")),ir(De=>De.filter(ut=>ut.id!==ne.id)),Ga()}catch(De){await Xt.error(t("common.error")+": "+(De instanceof Error?De.message:String(De)))}finally{Hr("")}},[Ga,t]),Wl=ar.useMemo(()=>{if(!ma||ma.length===0)return[];const ne=Object.keys(ma[0]).filter(ut=>ut!=="_rowid"),De=ue.length>0?ne.filter(ut=>ue.includes(ut)):ne;return De.length===0?[]:De.map(ut=>{const Ft=ut.toLowerCase().includes("amount")||ut.toLowerCase().includes("price"),ur=ut.toLowerCase().includes("id"),qr=typeof ma[0][ut]=="number";return{header:ut,accessor:ut,align:qr?"right":"left",className:ur?"font-mono text-[10px] text-slate-400":ut==="Period"||ut==="PostingDate"?"font-mono":"",render:Ft?Fr=>c.jsx("span",{className:Number(Fr[ut]??0)<0?"text-red-500":"text-slate-900 dark:text-slate-100",children:new Intl.NumberFormat("de-DE",{style:"currency",currency:Fr.Currency||"EUR"}).format(Fr[ut]||0)}):void 0}})},[ma,ue]),uc=r.language.startsWith("de")?"de-DE":"en-US",E=new Date,ee=`${t("common.loading").replace("...","")} ${E.toLocaleDateString(uc)}, ${E.toLocaleTimeString(uc,{hour:"2-digit",minute:"2-digit"})}`;X.useEffect(()=>{l!=="sql"&&(jt([]),zt(""),It(!1))},[l]),X.useEffect(()=>{if(l!=="sql"||xt!=="explain")return;const ne=window.setTimeout(()=>{zo(u)},250);return()=>window.clearTimeout(ne)},[l,xt,u,zo]);const Be=[{key:"top10",sql:`SELECT * FROM ${et||"table_name"} LIMIT 10`},{key:"count",sql:`SELECT COUNT(*) AS total_rows FROM ${et||"table_name"}`},{key:"nullscan",sql:`SELECT * FROM ${et||"table_name"} WHERE 1=1 LIMIT 50`},{key:"duplicates",sql:`SELECT key_column, COUNT(*) AS cnt FROM ${et||"table_name"} GROUP BY key_column HAVING COUNT(*) > 1 ORDER BY cnt DESC LIMIT 50`},{key:"outliers",sql:`SELECT * FROM ${et||"table_name"} WHERE value_column IS NOT NULL ORDER BY value_column DESC LIMIT 25`}];X.useEffect(()=>{ys.length&&(!R||!ys.includes(R))&&M(et&&ys.includes(et)?et:ys[0])},[R,et,ys]);const Ne=ar.useMemo(()=>(Bs||[]).map(ne=>ne.name),[Bs]),Ke=ar.useMemo(()=>(Bs||[]).filter(ne=>/int|real|num|dec|float|double/i.test(ne.type||"")).map(ne=>ne.name),[Bs]);X.useEffect(()=>{re(ne=>ne.filter(De=>Ne.includes(De))),J!=="none"&&J!=="count"&&He&&!Ne.includes(He)&&ct(""),de&&!Ne.includes(de)&&de!==yt&&be(""),Xe&&!Ne.includes(Xe)&&Ut("")},[J,He,Ne,Xe,yt,de]),X.useEffect(()=>{J==="none"||J==="count"||He||(Ke.length>0?ct(Ke[0]):Ne.length>0&&ct(Ne[0]))},[J,He,Ne,Ke]);const wt=X.useCallback(()=>{if(!R)return"";const ne=xr=>`"${xr.replace(/"/g,'""')}"`,De=`FROM ${ne(R)}`,ut=J.toUpperCase(),Ft=J==="count"?`COUNT(*) AS ${ne(yt||"metric_value")}`:`${ut}(${ne(He)}) AS ${ne(yt||"metric_value")}`;let ur="SELECT *";const dr=[];if(J==="none")ur=`SELECT ${P.length>0?P.map(ne).join(", "):"*"}`;else{const xr=Xe?[ne(Xe)]:[];dr.push(...xr),ur=`SELECT ${[...xr,Ft].join(", ")}`}const qr=ge.trim()?`WHERE ${ge.trim()}`:"",Fr=dr.length>0?`GROUP BY ${dr.join(", ")}`:"",mr=de.trim()||(J!=="none"?ne(yt||"metric_value"):""),$r=mr?`ORDER BY ${mr} ${Le}`:"",Tr=`LIMIT ${Math.max(1,Math.min(1e5,Math.floor(Number(_e)||100)))}`;return[ur,De,qr,Fr,$r,Tr].filter(Boolean).join(`
`)},[J,He,Xe,_e,yt,de,Le,P,R,ge])(),tr=X.useCallback(async ne=>{const De=wt.trim();if(De){if(A("sql"),ne==="replace"||!u.trim())f(De),pe(De.length);else{const Ft=`${u.trim().replace(/;?\s*$/,";")}
${De}`;f(Ft),pe(Ft.length)}ht("result"),w(!1),ne==="run"&&await qn(De)}},[wt,qn,u,w]),Ar=Yi(u),kr=S.find(ne=>Yi(ne.sql_text)===Ar),Dr=!!(kr&&Number(kr.is_favorite)===1),ea=ar.useMemo(()=>{const ne=T.trim().toLowerCase();return ne?S.filter(De=>De.name.toLowerCase().includes(ne)||De.sql_text.toLowerCase().includes(ne)||(De.description||"").toLowerCase().includes(ne)):S},[T,S]),nn=ar.useMemo(()=>S.filter(ne=>Number(ne.is_favorite)===1).length,[S]),un=X.useCallback(async(ne,De)=>{A("sql"),f(ne.sql_text),pe(ne.sql_text.length),ht("result"),w(!1),await Dt.markSqlStatementUsed(ne.id),De&&await qn(ne.sql_text),await Ta()},[qn,Ta,w]),La=X.useCallback(async(ne,De)=>{A("sql"),f(ne),pe(ne.length),ht("result"),w(!1),De&&await qn(ne)},[qn,w]),pn=X.useCallback(ne=>{F(De=>({...De,[ne]:!De[ne]}))},[F]),Cn=X.useCallback(async ne=>{await Xt.confirm(t("datainspector.custom_template_delete_confirm"))&&(await Dt.deleteSqlStatement(ne.id),await Ta())},[Ta,t]),ss=X.useCallback(async ne=>{const De=(await Xt.prompt(t("datainspector.rename_template_prompt"),{defaultValue:ne.name}))?.trim();if(!De||De===ne.name)return;const ut=S.find(Ft=>Ft.id!==ne.id&&Ft.name.toLowerCase()===De.toLowerCase()&&Ft.scope===ne.scope);ut&&!await Xt.confirm(t("datainspector.custom_template_overwrite_confirm",{name:De}))||(ut&&await Dt.deleteSqlStatement(ut.id),await Dt.saveSqlStatement({id:ne.id,name:De,sql_text:ne.sql_text,description:ne.description,scope:ne.scope,tags:ne.tags,is_favorite:Number(ne.is_favorite)===1}),await Ta())},[Ta,S,t]),fl=X.useCallback(()=>{if(!ma||ma.length===0)return;const ne=new Date().toISOString().slice(0,10),De=ma.map(ut=>{const Ft={...ut};return delete Ft._rowid,Ft});jK(De,`export_${ne}`,"Export")},[ma]),Ji=X.useCallback(()=>{const ne=Ae.trim();ne&&(Vs(De=>({...De,[ne]:G})),li(!0))},[li,Ae,G]),Xl=X.useCallback(ne=>{Vs(De=>{const ut={...De};return delete ut[ne],ut})},[]),dc=X.useCallback(()=>{Vs({}),pt(""),li(!1),Se("")},[li]),_A=X.useCallback(()=>{const De=`SELECT * FROM "${et.replace(/"/g,'""')}" LIMIT 100`;A("sql"),f(De),pe(De.length),ht("result"),W(!1)},[et,W]),Ei=X.useCallback(ne=>{Q(ne),W(!0)},[W,Q]),Ni=X.useCallback(ne=>{const De=et.replace(/"/g,'""'),ut=ur=>`"${ur.replace(/"/g,'""')}"`;return`SELECT ${ne.length>0?ne.map(ut).join(", "):"*"}
FROM "${De}"
LIMIT 100`},[et]),Go=X.useCallback(async ne=>{if(Y.length===0){await Xt.info(t("datainspector.table_tools_pick_fields_required","Select at least one field."));return}const De=Ni(Y);A("sql"),f(De),pe(De.length),ht("result"),W(!1),ne&&await qn(De)},[Ni,qn,W,Y,t]),Yl=X.useCallback(async()=>{if(Y.length===0){await Xt.info(t("datainspector.table_tools_pick_fields_required","Select at least one field."));return}A("table"),Z(Y),W(!1)},[W,Y,t]),gn=X.useCallback((ne,De)=>{let ut=De,Ft=De;const ur=qr=>/[A-Za-z0-9_."]/i.test(qr);for(;ut>0&&ur(ne[ut-1]);)ut-=1;for(;Ft<ne.length&&ur(ne[Ft]);)Ft+=1;const dr=ne.slice(ut,De);return{start:ut,end:Ft,token:dr}},[]),Dn=ar.useMemo(()=>{if(l!=="sql"||!v)return[];const ne=(jn||[]).map(Tr=>Tr.name),{token:De}=gn(u,fe),ut=De.trim().toLowerCase(),Ft=u.slice(0,fe).toUpperCase(),ur=/\b(FROM|JOIN|INTO|UPDATE|TABLE)\s+["A-Z0-9_]*$/i.test(Ft),dr=/\b(SELECT|WHERE|AND|OR|ON|HAVING|BY|ORDER BY|GROUP BY)\s+["A-Z0-9_.,]*$/i.test(Ft),qr=MV.filter(Tr=>ut.length===0||Tr.toLowerCase().startsWith(ut)).map(Tr=>({label:Tr,insert:Tr,type:"keyword"})),Fr=(ys||[]).filter(Tr=>ut.length===0||Tr.toLowerCase().startsWith(ut)).map(Tr=>({label:Tr,insert:Tr,type:"table"})),mr=ne.filter(Tr=>ut.length===0||Tr.toLowerCase().startsWith(ut)).map(Tr=>({label:Tr,insert:Tr,type:"column"}));let $r=[];return ur?$r=[...Fr,...qr]:dr||De.includes(".")?$r=[...mr,...qr,...Fr]:$r=[...qr,...Fr,...mr],$r.filter((Tr,xr,ta)=>ta.findIndex(ra=>ra.label===Tr.label&&ra.type===Tr.type)===xr).slice(0,16)},[l,v,jn,gn,u,fe,ys]);X.useEffect(()=>{Re(0),se(l==="sql"&&v&&Dn.length>0)},[l,v,Dn]),X.useEffect(()=>{v||se(!1)},[v]);const hl=X.useCallback(ne=>{const{start:De,end:ut}=gn(u,fe),Ft=`${u.slice(0,De)}${ne.insert}${u.slice(ut)}`,ur=De+ne.insert.length;f(Ft),pe(ur),se(!1),Re(0),window.setTimeout(()=>{xe.current?.focus(),xe.current?.setSelectionRange(ur,ur)},0)},[gn,u,fe]),BA=X.useCallback(ne=>{if(v){if(!K||Dn.length===0){ne.key===" "&&ne.ctrlKey&&(ne.preventDefault(),se(!0));return}if(ne.key==="ArrowDown"){ne.preventDefault(),Re(De=>(De+1)%Dn.length);return}if(ne.key==="ArrowUp"){ne.preventDefault(),Re(De=>(De-1+Dn.length)%Dn.length);return}if(ne.key==="Enter"||ne.key==="Tab"){ne.preventDefault(),hl(Dn[Fe]);return}ne.key==="Escape"&&(ne.preventDefault(),se(!1))}},[v,K,Fe,hl,Dn]),Fi=X.useCallback(()=>{const ne=xe.current;if(!ne)return;const De=ne.selectionStart??fe,ut=window.getComputedStyle(ne),Ft=document.createElement("div"),ur=["boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontFamily","lineHeight","textAlign","textTransform","textIndent","letterSpacing","wordSpacing"];Ft.style.position="absolute",Ft.style.visibility="hidden",Ft.style.whiteSpace="pre-wrap",Ft.style.wordWrap="break-word",Ft.style.top="0",Ft.style.left="-9999px";for(const ta of ur)Ft.style[ta]=ut[ta];Ft.style.width=`${ne.clientWidth}px`,Ft.textContent=ne.value.slice(0,De);const dr=document.createElement("span");dr.textContent=ne.value.slice(De)||".",Ft.appendChild(dr),document.body.appendChild(Ft);const qr=Number.parseFloat(ut.lineHeight),Fr=Number.isFinite(qr)?qr:18,mr=dr.offsetTop-ne.scrollTop+Fr+6,$r=dr.offsetLeft-ne.scrollLeft+8;document.body.removeChild(Ft);const sn=Math.max(8,Math.min(mr,ne.clientHeight-44)),Tr=Math.max(8,Math.min($r,ne.clientWidth-180)),xr=Math.max(180,ne.clientWidth-Tr-10);Pe({top:sn,left:Tr,width:Math.min(420,xr)})},[fe]);X.useEffect(()=>{!K||Dn.length===0||Fi()},[K,Dn.length,fe,u,Fi]),X.useEffect(()=>{const ne=xe.current;if(!ne)return;const De=new ResizeObserver(ut=>{if(Kl||Date.now()-oc.current<250)return;const Ft=ut[0];if(!Ft)return;const ur=Math.round(Ft.contentRect.height),dr=Math.max(120,Math.min(520,ur));dr!==Er&&ae(dr)});return De.observe(ne),()=>De.disconnect()},[Er,l,Kl]),X.useEffect(()=>{ae(Br)},[Br]),X.useEffect(()=>{if(Er===Br)return;const ne=window.setTimeout(()=>{jr(Er)},180);return()=>window.clearTimeout(ne)},[Er,Br,jr]);const Sn=ar.useMemo(()=>{if(l!=="table"||!ma||ma.length===0)return[];const ne=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,De=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,ut=/^[A-Z]{2}\d{2}[A-Z0-9]{10,30}$/i,Ft=/^https?:\/\/[^\s/$.?#].[^\s]*$/i,ur=qr=>{if(!(/^\d{4}-\d{2}-\d{2}/.test(qr)||/^\d{2}[./-]\d{2}[./-]\d{2,4}$/.test(qr)))return!1;const mr=Date.parse(qr.replace(/\./g,"-"));return!Number.isNaN(mr)};return Object.keys(ma[0]).filter(qr=>qr!=="_rowid").map(qr=>{const Fr=ma.map(cr=>cr[qr]),mr=Fr.filter(cr=>cr!=null&&String(cr).trim()!==""),$r=Fr.length-mr.length,sn=Fr.length>0?$r/Fr.length*100:0,Tr=mr.map(cr=>String(cr).trim()),xr=new Set(Tr).size,ta=mr.map(cr=>typeof cr=="number"?cr:Number(cr)).filter(cr=>!Number.isNaN(cr)),ra=ta.length,js=mr.filter(cr=>cr instanceof Date||ur(String(cr).trim())).length;let mn="unknown";if(mr.length===0)mn="unknown";else{const cr=ra/mr.length,In=js/mr.length;cr>.9?mn="number":In>.9?mn="date":cr>.1||In>.1?mn="mixed":mn="text"}const pl=ta.length>0?Math.min(...ta):null,is=ta.length>0?Math.max(...ta):null,gl={email:Tr.filter(cr=>ne.test(cr)).length,uuid:Tr.filter(cr=>De.test(cr)).length,iban:Tr.filter(cr=>ut.test(cr)).length,url:Tr.filter(cr=>Ft.test(cr)).length,date:Tr.filter(cr=>ur(cr)).length},CA=Object.entries(gl).filter(([,cr])=>cr>=2&&cr/Math.max(1,Tr.length)>=.2).sort((cr,In)=>In[1]-cr[1]).map(([cr])=>cr),ml=Object.entries(gl).sort((cr,In)=>In[1]-cr[1])[0],Jl=ml?ml[1]/Math.max(1,Tr.length):0;let ci=0;mn==="number"?ci=Math.max(0,mr.length-ra):mn==="date"?ci=Math.max(0,mr.length-js):ml&&ml[1]>=3&&Jl>=.6&&(ci=Math.max(0,mr.length-ml[1]));const Ti=new Map;Tr.forEach(cr=>{Ti.set(cr,(Ti.get(cr)||0)+1)});const Wo=Array.from(Ti.entries()).sort((cr,In)=>In[1]-cr[1]).slice(0,3),ui=mr.length>0?xr/mr.length*100>hn.cardinalityRate:!1,di=[];return sn>=hn.nullRate&&di.push("high_null"),mn==="mixed"&&di.push("mixed_types"),ui&&di.push("high_cardinality"),ci>0&&di.push("suspicious_values"),{key:qr,distinctCount:xr,nullRate:sn,min:pl,max:is,topValues:Wo,detectedType:mn,patterns:CA,suspiciousCount:ci,issues:di}})},[l,ma,hn]),$l=ar.useMemo(()=>Sn.reduce((ne,De)=>ne+De.issues.length,0),[Sn]),kA=ne=>{ne.preventDefault(),ne.stopPropagation(),ql.current={startY:ne.clientY,startHeight:Er},bA.current=Er,Ci(!0)};return X.useEffect(()=>{if(!Kl)return;const ne=ut=>{const Ft=ql.current;if(!Ft)return;const ur=ut.clientY-Ft.startY,dr=120,qr=Math.max(260,Math.floor(window.innerHeight*.62)),Fr=Math.max(dr,Math.min(qr,Ft.startHeight+ur));bA.current=Fr,xe.current&&(xe.current.style.height=`${Fr}px`)},De=()=>{const ut=Math.round(bA.current);oc.current=Date.now(),ae(ut),Ci(!1),ql.current=null};return document.body.style.cursor="row-resize",document.body.style.userSelect="none",document.body.style.overflowAnchor="none",window.addEventListener("mousemove",ne),window.addEventListener("mouseup",De),()=>{document.body.style.cursor="",document.body.style.userSelect="",document.body.style.overflowAnchor="",window.removeEventListener("mousemove",ne),window.removeEventListener("mouseup",De)}},[Kl,ae]),c.jsxs(t0,{header:{title:t("sidebar.data_inspector"),subtitle:t("datainspector.subtitle",{count:l==="sql"&&xt==="explain"?Lt.length:l==="table"&&oi==="profiling"?Sn.length:ma?.length||0,mode:l==="table"?et:t("datainspector.sql_mode")}),onBack:e,actions:c.jsxs(c.Fragment,{children:[vA&&c.jsxs("button",{onClick:()=>{window.location.hash=vA},className:"h-10 flex items-center gap-2 px-3 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-sm font-semibold rounded-lg border border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-700 transition-all",title:t("datainspector.back_to_dashboard"),children:[c.jsx(T8,{className:"w-4 h-4"}),c.jsx("span",{className:"hidden sm:inline",children:t("datainspector.back_to_dashboard")})]}),c.jsxs("div",{className:"flex items-center bg-slate-100 dark:bg-slate-800 p-1 rounded-lg",children:[c.jsxs("button",{onClick:()=>{A("table"),Ga()},className:`px-3 py-1.5 rounded-md text-sm font-medium transition-all flex items-center gap-2 ${l==="table"?"bg-white dark:bg-slate-700 shadow text-blue-600 dark:text-blue-400":"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"}`,children:[c.jsx(Oc,{className:"w-4 h-4"}),t("datainspector.table_mode")]}),c.jsxs("button",{onClick:()=>{A("sql"),ht(x?"explain":"result"),u||f(`SELECT * FROM ${et} LIMIT 10`)},className:`px-3 py-1.5 rounded-md text-sm font-medium transition-all flex items-center gap-2 ${l==="sql"?"bg-white dark:bg-slate-700 shadow text-blue-600 dark:text-blue-400":"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"}`,children:[c.jsx(L8,{className:"w-4 h-4"}),t("datainspector.sql_mode")]})]}),c.jsx("button",{onClick:Ga,className:"h-10 w-10 flex items-center justify-center bg-white dark:bg-slate-800 text-slate-500 dark:text-slate-400 rounded-lg border border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-700 hover:text-slate-700 dark:hover:text-slate-200 transition-all",title:t("datainspector.refresh_title"),children:c.jsx(Ic,{className:`w-4 h-4 ${$i?"animate-spin":""}`})}),c.jsxs("button",{onClick:fl,className:"h-10 flex items-center gap-2 px-4 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-sm font-semibold rounded-lg border border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-700 transition-all",children:[c.jsx(jp,{className:"w-4 h-4"}),c.jsx("span",{className:"hidden sm:inline",children:t("datainspector.export_excel")})]})]})},rightPanel:{title:l==="table"?t("datainspector.table_tools","Table Tools"):t("datainspector.sql_assist","SQL Workspace"),enabled:l==="sql"||l==="table",triggerTitle:l==="table"?t("datainspector.table_tools","Table Tools"):t("datainspector.sql_assist","SQL Workspace"),width:"sm",isOpen:l==="table"?j:m,onOpenChange:l==="table"?W:w,content:l==="table"?c.jsxs("div",{className:"h-full min-h-0 flex flex-col gap-4",children:[c.jsxs("div",{className:"inline-flex items-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 p-1 flex-shrink-0",children:[c.jsx("button",{type:"button",onClick:()=>Q("columns"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${I==="columns"?"bg-blue-600 text-white":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:t("datainspector.table_tools_tab_columns","Columns")}),c.jsx("button",{type:"button",onClick:()=>Q("filters"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${I==="filters"?"bg-blue-600 text-white":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:t("datainspector.table_tools_tab_filters","Filters")}),c.jsx("button",{type:"button",onClick:()=>Q("actions"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${I==="actions"?"bg-blue-600 text-white":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:t("datainspector.table_tools_tab_actions","Actions")})]}),I==="columns"&&c.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-2",children:[c.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:t("datainspector.table_tools_columns_hint","Inspect schema and set sorting per column.")}),c.jsxs("div",{className:"rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900/40 p-2 space-y-2",children:[c.jsxs("div",{className:"flex items-center justify-between gap-2",children:[c.jsx("span",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:t("datainspector.table_tools_field_picker","Field Picker")}),c.jsx("span",{className:"text-[11px] text-slate-500 dark:text-slate-400",children:t("datainspector.table_tools_selected_count",{count:Y.length,defaultValue:"{{count}} selected"})})]}),c.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[c.jsx("button",{type:"button",onClick:()=>z((jn||[]).map(ne=>ne.name)),className:"h-7 w-7 inline-flex items-center justify-center rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:t("datainspector.table_tools_select_all_fields","Select all"),"aria-label":t("datainspector.table_tools_select_all_fields","Select all"),children:c.jsx(E8,{className:"w-3.5 h-3.5"})}),c.jsx("button",{type:"button",onClick:()=>z([]),className:"h-7 w-7 inline-flex items-center justify-center rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:t("datainspector.table_tools_clear_field_selection","Clear"),"aria-label":t("datainspector.table_tools_clear_field_selection","Clear"),children:c.jsx(N8,{className:"w-3.5 h-3.5"})}),c.jsxs("button",{type:"button",onClick:()=>{Go(!1)},className:"h-7 px-2 inline-flex items-center gap-1 text-[11px] rounded border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/30 text-blue-700 dark:text-blue-300",children:[c.jsx(p2,{className:"w-3.5 h-3.5"}),t("datainspector.sql_assist","SQL Workspace")]}),c.jsx("button",{type:"button",onClick:()=>{Yl()},className:"h-7 w-7 inline-flex items-center justify-center text-[11px] rounded border border-blue-200 bg-blue-600 hover:bg-blue-700 text-white",title:t("datainspector.table_tools_apply_to_table","Apply to Table"),"aria-label":t("datainspector.table_tools_apply_to_table","Apply to Table"),children:c.jsx(Zd,{className:"w-3.5 h-3.5 fill-current"})})]})]}),c.jsx("div",{className:"flex-1 min-h-0 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg divide-y divide-slate-100 dark:divide-slate-700",children:(jn||[]).length===0?c.jsx("div",{className:"p-3 text-xs text-slate-400 dark:text-slate-500",children:t("common.no_data")}):(jn||[]).map(ne=>{const De=rn?.key===ne.name,ut=De?rn?.direction:null,Ft=Y.includes(ne.name);return c.jsx("div",{className:`p-3 space-y-2 ${De?"bg-blue-50/60 dark:bg-blue-900/20":""} ${Ft?"ring-1 ring-inset ring-blue-200 dark:ring-blue-700/60":""}`,children:c.jsxs("div",{className:"flex items-center justify-between gap-2",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsxs("label",{className:"flex items-center gap-2 min-w-0",children:[c.jsx("input",{type:"checkbox",checked:Ft,onChange:()=>{z(ur=>ur.includes(ne.name)?ur.filter(dr=>dr!==ne.name):[...ur,ne.name])}}),c.jsxs("div",{className:"text-xs font-semibold text-slate-700 dark:text-slate-200 truncate flex items-center gap-2",children:[c.jsx("span",{className:"truncate",children:ne.name}),De&&c.jsx("span",{className:"px-1.5 py-0.5 rounded bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 text-[10px] font-bold",children:ut==="asc"?"ASC":"DESC"})]})]}),c.jsx("div",{className:"text-[10px] text-slate-400 dark:text-slate-500",children:ne.type||"-"})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("button",{type:"button",onClick:()=>ki({key:ne.name,direction:"asc"}),className:`h-7 px-2 text-[11px] rounded border ${De&&ut==="asc"?"border-blue-300 dark:border-blue-800 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300":"border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300"}`,title:t("datainspector.table_tools_sort_asc","Sort ascending"),children:"ASC"}),c.jsx("button",{type:"button",onClick:()=>ki({key:ne.name,direction:"desc"}),className:`h-7 px-2 text-[11px] rounded border ${De&&ut==="desc"?"border-blue-300 dark:border-blue-800 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300":"border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300"}`,title:t("datainspector.table_tools_sort_desc","Sort descending"),children:"DESC"})]})]})},ne.name)})})]}),I==="filters"&&c.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-3",children:[c.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:t("datainspector.table_tools_filters_hint","Manage global search and column filters.")}),c.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:t("datainspector.table_tools_global_search","Global Search")}),c.jsx("input",{type:"text",value:qe,onChange:ne=>pt(ne.target.value),placeholder:t("datainspector.search_placeholder"),className:"w-full h-9 px-3 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none focus:ring-2 focus:ring-blue-500"}),c.jsxs("div",{className:"grid grid-cols-[1fr_1fr_auto] gap-2 items-end",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:t("datainspector.table_tools_column","Column")}),c.jsx("select",{value:Ae,onChange:ne=>ve(ne.target.value),className:"w-full h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none",children:(jn||[]).map(ne=>c.jsx("option",{value:ne.name,children:ne.name},ne.name))})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:t("datainspector.table_tools_filter_value","Filter")}),c.jsx("input",{type:"text",value:G,onChange:ne=>Se(ne.target.value),className:"w-full h-9 px-3 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none focus:ring-2 focus:ring-blue-500"})]}),c.jsx("button",{type:"button",onClick:Ji,className:"h-9 px-3 rounded-lg border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 text-xs font-semibold hover:bg-blue-100 dark:hover:bg-blue-900/30",children:t("datainspector.table_tools_filter_apply","Apply")})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("label",{className:"inline-flex items-center gap-2 text-xs text-slate-600 dark:text-slate-300",children:[c.jsx("input",{type:"checkbox",checked:ia,onChange:ne=>li(ne.target.checked)}),t("datainspector.table_tools_toggle_filter_row","Show filter row in table")]}),c.jsx("button",{type:"button",onClick:dc,className:"text-[11px] text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200",children:t("datainspector.table_tools_clear_all","Clear all")})]}),c.jsx("div",{className:"flex-1 min-h-0 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg divide-y divide-slate-100 dark:divide-slate-700",children:Object.keys(Ca).length===0?c.jsx("div",{className:"p-3 text-xs text-slate-400 dark:text-slate-500",children:t("datainspector.table_tools_no_filters","No active column filters")}):Object.entries(Ca).map(([ne,De])=>c.jsxs("div",{className:"p-3 flex items-center justify-between gap-2",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"text-xs font-semibold text-slate-700 dark:text-slate-200 truncate",children:ne}),c.jsx("div",{className:"text-[11px] text-slate-500 dark:text-slate-400 truncate",children:De||"-"})]}),c.jsx("button",{type:"button",onClick:()=>Xl(ne),className:"h-7 px-2 text-[11px] rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",children:t("common.remove","Remove")})]},ne))})]}),I==="actions"&&c.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-3",children:[c.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:t("datainspector.table_tools_actions_hint","Quick actions for current table context.")}),c.jsx("button",{type:"button",onClick:()=>Ga(),className:"h-9 px-3 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-xs font-semibold hover:bg-slate-50 dark:hover:bg-slate-700 text-left",children:t("common.refresh","Refresh")}),c.jsx("button",{type:"button",onClick:fl,className:"h-9 px-3 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-xs font-semibold hover:bg-slate-50 dark:hover:bg-slate-700 text-left",children:t("datainspector.table_tools_export_rows","Export current rows")}),c.jsx("button",{type:"button",onClick:_A,className:"h-9 px-3 rounded-lg border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 text-xs font-semibold hover:bg-blue-100 dark:hover:bg-blue-900/30 text-left",children:t("datainspector.table_tools_open_sql","Open as SQL")}),c.jsx("button",{type:"button",onClick:Ai,className:"h-9 px-3 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-xs font-semibold hover:bg-slate-50 dark:hover:bg-slate-700 text-left",children:t(Fa?"datainspector.update_view":"datainspector.save_view")}),c.jsx("button",{type:"button",onClick:()=>{cl()},disabled:!Fa,className:"h-9 px-3 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-xs font-semibold hover:bg-slate-50 dark:hover:bg-slate-700 text-left disabled:opacity-40",children:t("datainspector.delete_view")}),_s==="table"&&c.jsx("button",{type:"button",onClick:mo,className:"h-9 px-3 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-xs font-semibold hover:bg-slate-50 dark:hover:bg-slate-700 text-left",children:t("datainspector.table_tools_create_index","Create index")}),_s==="table"&&c.jsxs("div",{className:"mt-1 pt-3 border-t border-slate-200 dark:border-slate-700 min-h-0 flex-1 flex flex-col gap-2",children:[c.jsxs("div",{className:"flex items-center justify-between gap-2",children:[c.jsx("div",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:t("datainspector.index_suggestions_title","Index Suggestions")}),c.jsx("button",{type:"button",onClick:()=>{Gl()},disabled:Nt,className:"h-7 px-2 rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300 text-[11px] disabled:opacity-40",children:Nt?t("common.loading","Loading..."):t("datainspector.index_suggestions_generate","Generate")})]}),c.jsx("div",{className:"text-[11px] text-slate-500 dark:text-slate-400",children:t("datainspector.index_suggestions_hint","Based on active filters, sorting, cardinality and existing indexes.")}),c.jsx("div",{className:"min-h-0 flex-1 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg divide-y divide-slate-100 dark:divide-slate-700",children:Tt.length===0?c.jsx("div",{className:"p-3 text-xs text-slate-400 dark:text-slate-500",children:t("datainspector.index_suggestions_empty","No suggestions yet. Generate to analyze this table.")}):Tt.map(ne=>c.jsxs("div",{className:"p-3 space-y-2",children:[c.jsx("div",{className:"text-xs font-semibold text-slate-700 dark:text-slate-200",children:ne.indexName}),c.jsx("div",{className:"text-[11px] text-slate-500 dark:text-slate-400",children:ne.reason}),c.jsxs("div",{className:"text-[11px] text-slate-500 dark:text-slate-400",children:[t("datainspector.index_suggestions_columns","Columns"),": ",c.jsx("span",{className:"font-mono",children:ne.columns.join(", ")})]}),c.jsx("div",{className:"font-mono text-[10px] text-slate-400 dark:text-slate-500 break-all",children:ne.sql}),c.jsx("button",{type:"button",onClick:()=>{$c(ne)},disabled:ca===ne.id,className:"h-7 px-2 rounded border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/30 text-blue-700 dark:text-blue-300 text-[11px] disabled:opacity-40",children:ca===ne.id?t("common.saving","Saving..."):t("datainspector.index_suggestions_apply","Create")})]},ne.id))})]})]})]}):c.jsxs("div",{className:"h-full min-h-0 flex flex-col gap-4",children:[c.jsxs("div",{className:"inline-flex items-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 p-1 flex-shrink-0",children:[c.jsx("button",{type:"button",onClick:()=>H("manager"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${D==="manager"?"bg-blue-600 text-white":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:t("datainspector.sql_manager_tab","SQL Manager")}),c.jsx("button",{type:"button",onClick:()=>H("assistant"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${D==="assistant"?"bg-blue-600 text-white":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:t("datainspector.assistant_tab","SQL Builder")})]}),D==="manager"?c.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-3 overflow-hidden",children:[c.jsxs("div",{className:we.templates?"min-h-0 flex-[0.9] flex flex-col gap-2":"flex-shrink-0",children:[c.jsxs("button",{type:"button",onClick:()=>pn("templates"),className:"flex items-center justify-between text-left",children:[c.jsx("span",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:t("datainspector.templates")}),c.jsx(lf,{className:`w-4 h-4 text-slate-400 dark:text-slate-500 transition-transform ${we.templates?"rotate-180":""}`})]}),we.templates&&c.jsx("div",{className:"flex-1 min-h-0 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg divide-y divide-slate-100 dark:divide-slate-700",children:Be.map(ne=>c.jsxs("div",{className:"p-3 space-y-2",children:[c.jsx("div",{className:"text-xs font-semibold text-slate-700 dark:text-slate-200",children:t(`datainspector.template_${ne.key}`)}),c.jsx("div",{className:"font-mono text-[10px] text-slate-400 dark:text-slate-500 truncate",children:ne.sql}),c.jsxs("div",{className:"flex flex-wrap gap-1",children:[c.jsx("button",{type:"button",onClick:()=>{La(ne.sql,!1)},className:"h-7 w-7 inline-flex items-center justify-center rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:t("common.open","Open"),"aria-label":t("common.open","Open"),children:c.jsx(Nb,{className:"w-3.5 h-3.5"})}),c.jsx("button",{type:"button",onClick:()=>{La(ne.sql,!0)},className:"h-7 w-7 inline-flex items-center justify-center rounded border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/30 text-blue-700 dark:text-blue-300",title:t("datainspector.run_sql"),"aria-label":t("datainspector.run_sql"),children:c.jsx(Zd,{className:"w-3.5 h-3.5"})})]})]},ne.key))})]}),c.jsxs("div",{className:we.manager?"min-h-0 flex-[1.3] flex flex-col gap-2":"flex-shrink-0",children:[c.jsxs("button",{type:"button",onClick:()=>pn("manager"),className:"flex items-center justify-between text-left",children:[c.jsxs("span",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:[t("datainspector.sql_manager_tab","SQL Manager")," (",S.length,")"]}),c.jsx(lf,{className:`w-4 h-4 text-slate-400 dark:text-slate-500 transition-transform ${we.manager?"rotate-180":""}`})]}),we.manager&&c.jsxs(c.Fragment,{children:[c.jsx("input",{type:"text",value:T,onChange:ne=>U(ne.target.value),placeholder:t("datainspector.sql_manager_search_placeholder","Search patterns..."),className:"w-full h-9 px-3 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none focus:ring-2 focus:ring-blue-500 flex-shrink-0"}),c.jsx("div",{className:"flex-1 min-h-0 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg divide-y divide-slate-100 dark:divide-slate-700",children:ea.length===0?c.jsx("div",{className:"p-4 text-xs text-slate-400 dark:text-slate-500",children:t("datainspector.sql_manager_no_results","No matches")}):ea.map(ne=>c.jsxs("div",{className:"p-3 space-y-2",children:[c.jsx("div",{className:"flex items-start justify-between gap-2",children:c.jsxs("div",{children:[c.jsxs("div",{className:"text-xs font-semibold text-slate-700 dark:text-slate-200 flex items-center gap-2",children:[ne.name,Number(ne.is_favorite)===1&&c.jsx(Qm,{className:"w-3.5 h-3.5 text-amber-500 fill-current"})]}),c.jsx("div",{className:"font-mono text-[10px] text-slate-400 dark:text-slate-500 truncate",children:ne.sql_text})]})}),c.jsxs("div",{className:"flex flex-wrap gap-1",children:[c.jsx("button",{type:"button",onClick:()=>{un(ne,!1)},className:"h-7 w-7 inline-flex items-center justify-center rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:t("common.open","Open"),"aria-label":t("common.open","Open"),children:c.jsx(Nb,{className:"w-3.5 h-3.5"})}),c.jsx("button",{type:"button",onClick:()=>{un(ne,!0)},className:"h-7 w-7 inline-flex items-center justify-center rounded border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/30 text-blue-700 dark:text-blue-300",title:t("datainspector.run_sql"),"aria-label":t("datainspector.run_sql"),children:c.jsx(Zd,{className:"w-3.5 h-3.5"})}),c.jsx("button",{type:"button",onClick:()=>{Dt.setSqlStatementFavorite(ne.id,Number(ne.is_favorite)!==1).then(Ta)},className:"h-7 w-7 inline-flex items-center justify-center rounded border border-amber-200 dark:border-amber-800 bg-amber-50 dark:bg-amber-900/20 hover:bg-amber-100 dark:hover:bg-amber-900/30 text-amber-700 dark:text-amber-300",title:Number(ne.is_favorite)===1?t("datainspector.unpin"):t("datainspector.pin"),"aria-label":Number(ne.is_favorite)===1?t("datainspector.unpin"):t("datainspector.pin"),children:c.jsx(Qm,{className:`w-3.5 h-3.5 ${Number(ne.is_favorite)===1?"fill-current":""}`})}),c.jsx("button",{type:"button",onClick:()=>{ss(ne)},className:"px-2 py-1 text-[11px] rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:t("datainspector.rename_template"),children:c.jsx(F8,{className:"w-3 h-3"})}),c.jsx("button",{type:"button",onClick:()=>{Cn(ne)},className:"px-2 py-1 text-[11px] rounded border border-rose-200 dark:border-rose-800 bg-rose-50 dark:bg-rose-900/20 hover:bg-rose-100 dark:hover:bg-rose-900/30 text-rose-700 dark:text-rose-300",title:t("datainspector.delete_template"),children:c.jsx(ds,{className:"w-3 h-3"})})]})]},ne.id))})]})]}),c.jsxs("div",{className:we.recent?"min-h-0 flex-[0.8] flex flex-col gap-2":"flex-shrink-0",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("button",{type:"button",onClick:()=>pn("recent"),className:"flex items-center justify-between gap-2 text-left flex-1",children:[c.jsx("span",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:t("datainspector.recent_queries")}),c.jsx(lf,{className:`w-4 h-4 text-slate-400 dark:text-slate-500 transition-transform ${we.recent?"rotate-180":""}`})]}),we.recent&&c.jsx("button",{type:"button",onClick:()=>g([]),className:"text-[11px] text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200",children:t("datainspector.clear_history")})]}),we.recent&&c.jsx("div",{className:"flex-1 min-h-0 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg divide-y divide-slate-100 dark:divide-slate-700",children:h.length===0?c.jsx("div",{className:"p-3 text-xs text-slate-400 dark:text-slate-500",children:t("common.no_data")}):h.map((ne,De)=>c.jsx("button",{type:"button",onClick:()=>f(ne),className:"w-full text-left p-3 hover:bg-slate-50 dark:hover:bg-slate-700/60",children:c.jsx("div",{className:"font-mono text-[11px] text-slate-600 dark:text-slate-300 truncate",children:ne})},`${De}-${ne.slice(0,16)}`))})]})]}):c.jsxs("div",{className:"space-y-3",children:[c.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:t("datainspector.assistant_hint","Build SQL by selecting table, columns and optional aggregation.")}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:t("datainspector.assistant_table","Table")}),c.jsx("select",{value:R,onChange:ne=>M(ne.target.value),className:"w-full h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none focus:ring-2 focus:ring-blue-500",children:ys.map(ne=>c.jsx("option",{value:ne,children:ne},ne))})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:t("datainspector.assistant_columns","Columns")}),c.jsx("button",{type:"button",onClick:()=>re(Ne),className:"text-[11px] text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200",children:t("datainspector.assistant_select_all","Select all")})]}),c.jsx("div",{className:"max-h-28 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg p-2 space-y-1",children:Ne.map(ne=>c.jsxs("label",{className:"flex items-center gap-2 text-xs text-slate-600 dark:text-slate-300",children:[c.jsx("input",{type:"checkbox",checked:P.includes(ne),onChange:()=>{re(De=>De.includes(ne)?De.filter(ut=>ut!==ne):[...De,ne])}}),c.jsx("span",{className:"font-mono",children:ne})]},ne))})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:t("datainspector.assistant_aggregation","Aggregation")}),c.jsxs("select",{value:J,onChange:ne=>ze(ne.target.value),className:"w-full h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none",children:[c.jsx("option",{value:"none",children:t("datainspector.assistant_none","None")}),c.jsx("option",{value:"count",children:"COUNT"}),c.jsx("option",{value:"sum",children:"SUM"}),c.jsx("option",{value:"avg",children:"AVG"}),c.jsx("option",{value:"min",children:"MIN"}),c.jsx("option",{value:"max",children:"MAX"})]})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:t("datainspector.assistant_aggregation_field","Aggregation Field")}),c.jsxs("select",{value:He,disabled:J==="none"||J==="count",onChange:ne=>ct(ne.target.value),className:"w-full h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none disabled:opacity-40",children:[c.jsx("option",{value:"",children:"-"}),Ne.map(ne=>c.jsx("option",{value:ne,children:ne},ne))]})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:t("datainspector.assistant_group_by","Group by")}),c.jsxs("select",{value:Xe,onChange:ne=>Ut(ne.target.value),className:"w-full h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none",children:[c.jsx("option",{value:"",children:t("datainspector.assistant_none","None")}),Ne.map(ne=>c.jsx("option",{value:ne,children:ne},ne))]})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:t("datainspector.assistant_metric_alias","Metric Alias")}),c.jsx("input",{type:"text",value:yt,onChange:ne=>qt(ne.target.value),className:"w-full h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none"})]})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:t("datainspector.assistant_where","WHERE")}),c.jsx("input",{type:"text",value:ge,onChange:ne=>Ce(ne.target.value),placeholder:t("datainspector.assistant_where_placeholder","status = 'active'"),className:"w-full h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none"})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[c.jsxs("div",{className:"space-y-1 col-span-2",children:[c.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:t("datainspector.assistant_order_by","Order by")}),c.jsxs("select",{value:de,onChange:ne=>be(ne.target.value),className:"w-full h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none",children:[c.jsx("option",{value:"",children:t("datainspector.assistant_auto","Auto")}),Ne.map(ne=>c.jsx("option",{value:ne,children:ne},ne))]})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:t("datainspector.assistant_direction","Direction")}),c.jsxs("select",{value:Le,onChange:ne=>ie(ne.target.value),className:"w-full h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none",children:[c.jsx("option",{value:"DESC",children:"DESC"}),c.jsx("option",{value:"ASC",children:"ASC"})]})]})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:t("datainspector.assistant_limit","Limit")}),c.jsx("input",{type:"number",min:1,max:1e5,value:_e,onChange:ne=>je(Number(ne.target.value)),className:"w-full h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none"})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:t("datainspector.assistant_generated_sql","Generated SQL")}),c.jsx("textarea",{readOnly:!0,value:wt,className:"w-full min-h-36 p-2 font-mono text-xs border border-slate-200 dark:border-slate-700 rounded-lg bg-slate-50 dark:bg-slate-900 text-slate-700 dark:text-slate-200"})]}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx("button",{type:"button",onClick:()=>{tr("replace")},className:"px-3 py-1.5 rounded-md border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-xs hover:bg-slate-50 dark:hover:bg-slate-700",children:t("datainspector.assistant_replace_editor","Replace Editor")}),c.jsx("button",{type:"button",onClick:()=>{tr("append")},className:"px-3 py-1.5 rounded-md border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-xs hover:bg-slate-50 dark:hover:bg-slate-700",children:t("datainspector.assistant_append","Append")}),c.jsx("button",{type:"button",onClick:()=>{tr("run")},className:"px-3 py-1.5 rounded-md border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 text-xs hover:bg-blue-100 dark:hover:bg-blue-900/30",children:t("datainspector.run_sql")})]})]})]})},footer:ee,breadcrumbs:[{label:t("sidebar.data_inspector")}],fillHeight:!0,children:[c.jsx("div",{className:"fixed top-0 left-0 w-full h-[3px] bg-blue-100 dark:bg-blue-900/30 z-[100] overflow-hidden",children:$i&&c.jsx("div",{className:"h-full bg-blue-600 dark:bg-blue-400 animate-pulse",style:{width:"40%"}})}),l==="table"?c.jsx("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm flex-shrink-0",children:c.jsx("div",{className:"grid grid-cols-1 gap-3",children:c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[minmax(220px,320px)_minmax(280px,1fr)_auto] gap-3",children:[c.jsxs("div",{className:"relative min-w-0",children:[c.jsx("select",{value:et,onChange:ne=>{Rt(ne.target.value),pt(""),ki(null),Vs({}),li(!1),an(""),sa(1)},className:"w-full h-10 appearance-none pl-10 pr-10 border border-slate-200 dark:border-slate-700 rounded-lg bg-slate-50 dark:bg-slate-900 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 cursor-pointer text-sm font-medium",children:Us?.map(ne=>c.jsx("option",{value:ne.name,children:ne.type==="view"?`${ne.name} (view)`:ne.name},ne.name))}),c.jsx(_i,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none"}),c.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 w-2 h-2 border-r-2 border-b-2 border-slate-400 rotate-45 pointer-events-none"})]}),c.jsxs("div",{className:"relative min-w-0",children:[c.jsx("input",{type:"text",placeholder:t("datainspector.search_placeholder"),value:qe,onChange:ne=>{pt(ne.target.value),sa(1)},className:"w-full h-10 pl-10 pr-4 border border-slate-200 dark:border-slate-700 rounded-lg bg-slate-50 dark:bg-slate-900 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),c.jsx(fo,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"})]}),c.jsxs("button",{onClick:()=>Ga(),className:"h-10 px-3 flex items-center justify-center gap-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300 text-sm font-medium",title:t("datainspector.refresh_title"),children:[c.jsx(Ic,{className:`w-4 h-4 ${$i?"animate-spin":""}`}),c.jsx("span",{children:t("common.refresh","Refresh")})]})]})})}):c.jsxs("div",{className:"flex flex-col gap-2 bg-white dark:bg-slate-800 p-4 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm ring-1 ring-slate-900/5 flex-shrink-0",children:[c.jsxs("div",{className:"relative",children:[c.jsx("textarea",{ref:xe,value:u,onChange:ne=>{f(ne.target.value),ht("explain"),pe(ne.target.selectionStart??ne.target.value.length)},onClick:ne=>pe(ne.currentTarget.selectionStart??0),onKeyUp:ne=>pe(ne.currentTarget.selectionStart??0),onSelect:ne=>pe(ne.currentTarget.selectionStart??0),onScroll:()=>{v&&K&&Fi()},onKeyDown:BA,placeholder:t("datainspector.sql_placeholder"),className:"w-full p-4 font-mono text-sm bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-y text-slate-800 dark:text-slate-200 min-h-[120px] max-h-[520px]",style:{height:`${Er}px`}}),v&&K&&Dn.length>0&&c.jsx("div",{className:"absolute z-20 border border-slate-200 dark:border-slate-700 rounded-lg bg-white/95 dark:bg-slate-900/95 backdrop-blur shadow-lg max-h-40 overflow-auto",style:{top:Qe.top,left:Qe.left,width:Qe.width},children:Dn.slice(0,10).map((ne,De)=>c.jsxs("button",{type:"button",onClick:()=>hl(ne),className:`w-full text-left px-3 py-1.5 text-xs font-mono border-b last:border-b-0 border-slate-100 dark:border-slate-800 transition-colors ${De===Fe?"bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300":"hover:bg-slate-50 dark:hover:bg-slate-800 text-slate-700 dark:text-slate-300"}`,children:[c.jsx("span",{className:"font-bold",children:ne.label}),c.jsx("span",{className:"ml-2 hidden sm:inline text-[10px] uppercase tracking-wide text-slate-400",children:ne.type})]},`${ne.type}-${ne.label}`))}),c.jsxs("div",{className:"absolute bottom-4 right-4 flex gap-2",children:[c.jsx("button",{onClick:()=>f(""),className:"px-3 py-1 text-xs text-slate-500 hover:text-slate-700 dark:hover:text-slate-300",children:t("datainspector.clear_sql")}),c.jsxs("button",{onClick:()=>{Yc()},className:"flex items-center gap-2 px-4 py-1.5 bg-blue-600 hover:bg-blue-700 text-white rounded-md text-sm font-medium shadow-sm transition-colors",children:[$i?c.jsx(Ic,{className:"w-3 h-3 animate-spin"}):c.jsx(Zd,{className:"w-3 h-3 fill-current"}),t("datainspector.run_sql")]}),$i&&c.jsx("button",{onClick:()=>{Si()},className:"px-3 py-1.5 rounded-md text-sm font-medium border bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 text-slate-500 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700",children:t("datainspector.stop_sql","Stop")}),c.jsx("button",{onClick:()=>B(!v),className:`px-3 py-1.5 rounded-md text-sm font-medium border transition-colors ${v?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800 text-blue-700 dark:text-blue-300":"bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 text-slate-500 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700"}`,title:t("datainspector.autocomplete_toggle_title","Toggle SQL autocomplete"),children:v?t("datainspector.autocomplete_on","Autocomplete on"):t("datainspector.autocomplete_off","Autocomplete off")}),c.jsx("button",{onClick:()=>w(!0),className:"h-9 w-9 flex items-center justify-center rounded-md border bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 text-slate-500 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700",title:t("datainspector.sql_assist","SQL Workspace"),"aria-label":t("datainspector.sql_assist","SQL Workspace"),children:c.jsx(Nb,{className:"w-4 h-4"})}),c.jsxs("button",{onClick:zn,className:"flex items-center gap-1 px-3 py-1.5 rounded-md text-sm font-medium border bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 text-slate-500 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700",title:t("common.save","Save"),children:[c.jsx(g2,{className:"w-3.5 h-3.5"}),t("common.save","Save")]}),c.jsxs("button",{onClick:()=>{wA(u)},className:`flex items-center gap-1 px-3 py-1.5 rounded-md text-sm font-medium border transition-colors ${Dr?"bg-amber-50 dark:bg-amber-900/20 border-amber-200 dark:border-amber-800 text-amber-700 dark:text-amber-300":"bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 text-slate-500 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700"}`,title:t(Dr?"datainspector.unpin_query":"datainspector.pin_query"),children:[c.jsx(Qm,{className:`w-3.5 h-3.5 ${Dr?"fill-current":""}`}),t(Dr?"datainspector.unpin":"datainspector.pin")]})]})]}),$t&&c.jsx("div",{className:"mt-2 px-3 py-2 text-xs rounded-md border border-amber-200 bg-amber-50 text-amber-800",children:$t}),c.jsxs("div",{className:"px-3 py-2 text-[11px] rounded-md border border-slate-200 dark:border-slate-700 bg-slate-50/70 dark:bg-slate-900/40 text-slate-500 dark:text-slate-400",children:[t("datainspector.sql_assist","SQL Workspace"),":"," ",Be.length," ",t("datainspector.templates")," ","|"," ",nn," ",t("datainspector.favorite_queries")," ","|"," ",S.length," ",t("datainspector.custom_templates")]})]}),l==="sql"&&c.jsx("div",{onMouseDown:kA,className:`h-3 -mt-2 -mb-1 flex items-center justify-center cursor-row-resize ${Kl?"opacity-100":"opacity-70 hover:opacity-100"}`,title:t("datainspector.resize_sql_split","Resize SQL and results panes"),children:c.jsx("div",{className:"h-1 w-12 rounded-full bg-slate-300 dark:bg-slate-600"})}),c.jsxs("div",{className:"flex-1 bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 shadow-sm overflow-hidden flex flex-col min-h-0 relative",children:[$i&&ma&&ma.length>0&&!(l==="sql"&&xt==="explain")&&c.jsx("div",{className:"absolute inset-0 bg-white/40 dark:bg-slate-800/40 z-10 flex items-center justify-center backdrop-blur-[1px]",children:c.jsx("div",{className:"bg-white dark:bg-slate-900 p-4 rounded-full shadow-xl border border-slate-100 dark:border-slate-700",children:c.jsx(Ic,{className:"w-8 h-8 text-blue-600 dark:text-blue-400 animate-spin"})})}),l==="sql"&&c.jsxs("div",{className:"px-4 py-2 border-b border-slate-100 dark:border-slate-700 bg-slate-50/60 dark:bg-slate-900/30 flex items-center justify-between gap-3",children:[c.jsxs("div",{className:"inline-flex items-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 p-1",children:[c.jsx("button",{onClick:()=>ht("result"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${xt==="result"?"bg-blue-600 text-white":"text-slate-500 hover:text-slate-700 dark:text-slate-300 dark:hover:text-slate-100"}`,children:t("datainspector.output_results","Results")}),c.jsx("button",{onClick:()=>{ht("explain")},className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${xt==="explain"?"bg-indigo-600 text-white":"text-slate-500 hover:text-slate-700 dark:text-slate-300 dark:hover:text-slate-100"}`,children:t("datainspector.output_explain","Explain")})]}),c.jsx("span",{className:"text-[11px] text-slate-400",children:t("datainspector.explain_hint")})]}),l==="table"&&c.jsxs("div",{className:"px-4 py-2 border-b border-slate-100 dark:border-slate-700 bg-slate-50/60 dark:bg-slate-900/30 flex items-center justify-between gap-3",children:[c.jsxs("div",{className:"inline-flex items-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 p-1",children:[c.jsx("button",{onClick:()=>xA("data"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${oi==="data"?"bg-blue-600 text-white":"text-slate-500 hover:text-slate-700 dark:text-slate-300 dark:hover:text-slate-100"}`,children:t("datainspector.result_tab_data","Data")}),c.jsx("button",{onClick:()=>xA("profiling"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${oi==="profiling"?"bg-indigo-600 text-white":"text-slate-500 hover:text-slate-700 dark:text-slate-300 dark:hover:text-slate-100"}`,children:t("datainspector.result_tab_profile","Profiling")})]}),c.jsx("span",{className:"text-[11px] text-slate-400",children:oi==="profiling"?t("datainspector.profiling_issues",{count:$l}):t("datainspector.auto_limit",{limit:Gt})})]}),l==="table"&&oi==="profiling"&&c.jsxs("div",{className:"px-4 py-2 border-b border-slate-100 dark:border-slate-700 bg-white dark:bg-slate-800 flex items-center justify-between gap-3 text-[11px]",children:[c.jsx("div",{className:"font-semibold uppercase tracking-wider text-slate-500",children:t("datainspector.profiling_settings","Profiling Settings")}),c.jsxs("div",{className:"flex items-center gap-2 text-slate-500 dark:text-slate-400",children:[c.jsxs("label",{className:"flex items-center gap-1",children:[c.jsx("span",{children:t("datainspector.null_threshold")}),c.jsx("input",{type:"number",min:0,max:100,value:hn.nullRate,onChange:ne=>{const De=Number(ne.target.value);Number.isNaN(De)||qo({...hn,nullRate:Math.max(0,Math.min(100,De))})},className:"w-14 px-1.5 py-0.5 border border-slate-200 dark:border-slate-700 rounded bg-white dark:bg-slate-900 text-slate-700 dark:text-slate-200"}),c.jsx("span",{children:"%"})]}),c.jsxs("label",{className:"flex items-center gap-1",children:[c.jsx("span",{children:t("datainspector.cardinality_threshold")}),c.jsx("input",{type:"number",min:0,max:100,value:hn.cardinalityRate,onChange:ne=>{const De=Number(ne.target.value);Number.isNaN(De)||qo({...hn,cardinalityRate:Math.max(0,Math.min(100,De))})},className:"w-14 px-1.5 py-0.5 border border-slate-200 dark:border-slate-700 rounded bg-white dark:bg-slate-900 text-slate-700 dark:text-slate-200"}),c.jsx("span",{children:"%"})]}),c.jsx("button",{onClick:()=>qo({nullRate:30,cardinalityRate:95}),className:"px-2 py-0.5 rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-500 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-700",children:t("datainspector.reset_thresholds")})]})]}),l==="table"&&oi==="data"&&c.jsxs("div",{className:"px-4 py-2 border-b border-slate-100 dark:border-slate-700 bg-white dark:bg-slate-800 flex items-center justify-between gap-3 text-[11px]",children:[c.jsxs("div",{className:"flex items-center gap-1.5",children:[c.jsx("button",{onClick:()=>Ei("columns"),className:"h-7 w-7 inline-flex items-center justify-center rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:t("datainspector.table_tools_tab_columns","Columns"),"aria-label":t("datainspector.table_tools_tab_columns","Columns"),children:c.jsx(FS,{className:"w-3.5 h-3.5"})}),c.jsx("button",{onClick:()=>Ei("filters"),className:"h-7 w-7 inline-flex items-center justify-center rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:t("datainspector.table_tools_tab_filters","Filters"),"aria-label":t("datainspector.table_tools_tab_filters","Filters"),children:c.jsx(sf,{className:"w-3.5 h-3.5"})}),c.jsx("button",{onClick:()=>Ei("actions"),className:"h-7 w-7 inline-flex items-center justify-center rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:t("datainspector.table_tools_tab_actions","Actions"),"aria-label":t("datainspector.table_tools_tab_actions","Actions"),children:c.jsx(Jv,{className:"w-3.5 h-3.5"})}),c.jsxs("button",{onClick:mo,disabled:_s!=="table",className:"h-7 px-2 text-[11px] rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300 disabled:opacity-40 flex items-center gap-1",title:_s!=="table"?t("datasource.view_type","VIEW"):t("datasource.create_index_title","Create index"),children:[c.jsx(LS,{className:"w-3.5 h-3.5"}),t("datasource.create_index_btn","Create index")]})]}),c.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[c.jsx("span",{className:"text-slate-500 dark:text-slate-400 font-semibold uppercase tracking-wider",children:t("datainspector.saved_views","Saved Views")}),c.jsxs("select",{value:Fa,onChange:ne=>{const De=ne.target.value;if(an(De),!De)return;const ut=Ko.find(Ft=>Ft.id===De);ut&&Al(ut)},className:"h-7 px-2 border border-slate-200 dark:border-slate-700 rounded bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-[11px] outline-none min-w-[180px]",children:[c.jsx("option",{value:"",children:t("datainspector.select_view")}),Ko.map(ne=>c.jsx("option",{value:ne.id,children:ne.name},ne.id))]}),c.jsx("button",{onClick:Ai,className:"h-7 px-2 text-[11px] rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",children:t(Fa?"datainspector.update_view":"datainspector.save_view")}),c.jsx("button",{onClick:cl,disabled:!Fa,className:"h-7 px-2 text-[11px] rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-500 dark:text-slate-300 disabled:opacity-40",children:t("datainspector.delete_view")})]})]}),c.jsx("div",{className:"flex-1 overflow-hidden flex flex-col relative min-h-0",children:l==="sql"&&xt==="explain"?Jt?c.jsxs("div",{className:"flex-1 flex items-center justify-center p-6 text-xs text-slate-400 gap-2",children:[c.jsx(Ic,{className:"w-3.5 h-3.5 animate-spin"}),t("common.loading")]}):Pt?c.jsx("div",{className:"flex-1 p-4 text-xs text-rose-600",children:Pt}):Lt.length===0?c.jsx("div",{className:"flex-1 p-4 text-xs text-slate-400",children:t("datainspector.explain_empty")}):c.jsx("div",{className:"flex-1 overflow-auto custom-scrollbar",children:c.jsxs("table",{className:"w-full text-xs min-w-[520px]",children:[c.jsx("thead",{className:"sticky top-0 bg-slate-50 dark:bg-slate-900 text-slate-400 uppercase text-[10px] z-[1]",children:c.jsx("tr",{children:Object.keys(Lt[0]).map(ne=>c.jsx("th",{className:"text-left px-2 py-1.5",children:ne},ne))})}),c.jsx("tbody",{children:Lt.map((ne,De)=>c.jsx("tr",{className:"border-t border-slate-100 dark:border-slate-700",children:Object.keys(Lt[0]).map(ut=>c.jsx("td",{className:"px-2 py-1.5 text-slate-600 dark:text-slate-300",children:String(ne[ut]??"")},ut))},De))})]})}):l==="table"&&oi==="profiling"?Sn.length===0?c.jsx("div",{className:"flex-1 p-4 text-xs text-slate-400",children:t("datainspector.no_profile")}):c.jsx("div",{className:"flex-1 overflow-auto custom-scrollbar",children:c.jsxs("table",{className:"w-full text-xs min-w-[760px]",children:[c.jsx("thead",{className:"text-slate-400 uppercase text-[10px] sticky top-0 bg-slate-50 dark:bg-slate-900 z-[1]",children:c.jsxs("tr",{children:[c.jsx("th",{className:"text-left py-1.5 px-2",children:t("querybuilder.value")}),c.jsx("th",{className:"text-left py-1.5 px-2",children:t("datainspector.type")}),c.jsx("th",{className:"text-left py-1.5 px-2",children:t("datainspector.distinct_values")}),c.jsx("th",{className:"text-left py-1.5 px-2",children:t("datainspector.null_rate")}),c.jsx("th",{className:"text-left py-1.5 px-2",children:t("datainspector.min")}),c.jsx("th",{className:"text-left py-1.5 px-2",children:t("datainspector.max")}),c.jsx("th",{className:"text-left py-1.5 px-2",children:t("datainspector.top_values")}),c.jsx("th",{className:"text-left py-1.5 px-2",children:t("datainspector.patterns")}),c.jsx("th",{className:"text-left py-1.5 px-2",children:t("datainspector.suspicious_values")}),c.jsx("th",{className:"text-left py-1.5 px-2",children:t("datainspector.issues")})]})}),c.jsx("tbody",{children:Sn.map(ne=>c.jsxs("tr",{className:"border-t border-slate-100 dark:border-slate-700",children:[c.jsx("td",{className:"py-1.5 px-2 font-semibold text-slate-700 dark:text-slate-200",children:ne.key}),c.jsx("td",{className:"py-1.5 px-2 text-slate-600 dark:text-slate-300",children:t(`datainspector.type_${ne.detectedType}`)}),c.jsx("td",{className:"py-1.5 px-2 text-slate-600 dark:text-slate-300",children:ne.distinctCount}),c.jsxs("td",{className:"py-1.5 px-2 text-slate-600 dark:text-slate-300",children:[ne.nullRate.toFixed(1),"%"]}),c.jsx("td",{className:"py-1.5 px-2 text-slate-600 dark:text-slate-300",children:ne.min??"-"}),c.jsx("td",{className:"py-1.5 px-2 text-slate-600 dark:text-slate-300",children:ne.max??"-"}),c.jsx("td",{className:"py-1.5 px-2 text-slate-600 dark:text-slate-300 truncate max-w-[260px]",title:ne.topValues.map(De=>`${De[0]} (${De[1]})`).join(", "),children:ne.topValues.length>0?ne.topValues.map(De=>`${De[0]} (${De[1]})`).join(", "):"-"}),c.jsx("td",{className:"py-1.5 px-2",children:ne.patterns.length>0?c.jsx("div",{className:"flex flex-wrap gap-1",children:ne.patterns.map(De=>c.jsx("span",{className:"px-1.5 py-0.5 rounded bg-indigo-50 text-indigo-700 border border-indigo-200 text-[10px] font-semibold",children:t(`datainspector.pattern_${De}`)},De))}):c.jsx("span",{className:"text-slate-400",children:"-"})}),c.jsx("td",{className:"py-1.5 px-2 text-slate-600 dark:text-slate-300",children:ne.suspiciousCount}),c.jsx("td",{className:"py-1.5 px-2",children:ne.issues.length>0?c.jsx("div",{className:"flex flex-wrap gap-1",children:ne.issues.map(De=>c.jsx("span",{className:"px-1.5 py-0.5 rounded bg-amber-50 text-amber-700 border border-amber-200 text-[10px] font-semibold",children:t(`datainspector.issue_${De}`)},De))}):c.jsx("span",{className:"text-slate-400",children:"-"})})]},ne.key))})]})}):$i&&!ma?c.jsx("div",{className:"flex-1 flex items-center justify-center p-12 text-center text-slate-400 animate-pulse",children:c.jsxs("div",{className:"flex flex-col items-center gap-4",children:[c.jsx(fo,{className:"w-12 h-12 opacity-20"}),c.jsx("p",{className:"text-lg",children:t("common.loading")})]})}):c.jsx(hy,{data:ma||[],columns:Wl,searchTerm:"",emptyMessage:t(l==="sql"&&!u?"datainspector.empty_sql":"common.no_data"),onRowClick:ne=>Qt(ne),sortConfig:l==="table"?rn:void 0,onSortConfigChange:l==="table"?ki:void 0,filters:l==="table"?Ca:void 0,onFiltersChange:l==="table"?Vs:void 0,showFilters:l==="table"?ia:void 0,onShowFiltersChange:l==="table"?li:void 0,columnWidths:l==="table"?po:void 0,onColumnWidthsChange:l==="table"?_r:void 0})}),c.jsxs("div",{className:"px-4 py-2 border-t border-slate-100 dark:border-slate-700 text-[10px] flex justify-between items-center text-slate-400 bg-slate-50/50 dark:bg-slate-900/50",children:[c.jsx("div",{className:"font-medium",children:l==="table"?oi==="profiling"?t("datainspector.result_tab_profile","Profiling"):c.jsx("select",{value:String(Gt),onChange:ne=>{wa(Number(ne.target.value)),sa(1)},className:"h-7 px-2 border border-slate-200 dark:border-slate-700 rounded bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-[10px] outline-none",title:t("datainspector.page_size"),children:[50,100,250,500].map(ne=>c.jsx("option",{value:ne,children:t("datainspector.page_size_value",{size:ne})},ne))}):xt==="explain"?t("datainspector.output_explain","Explain"):t("datainspector.sql_mode")}),c.jsxs("div",{className:"flex items-center gap-4",children:[l==="table"&&oi==="data"&&c.jsxs("div",{className:"flex items-center gap-1.5",children:[c.jsx("button",{onClick:()=>sa(ne=>Math.max(1,ne-1)),disabled:Pr<=1,className:"px-2 py-1 rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-500 dark:text-slate-300 disabled:opacity-40",children:t("datainspector.prev_page")}),c.jsx("span",{className:"text-[10px] font-semibold text-slate-500 dark:text-slate-300",children:t("datainspector.page_info",{page:Pr,pages:go,total:Kn||0})}),c.jsx("button",{onClick:()=>sa(ne=>ne+1),disabled:Pr>=go,className:"px-2 py-1 rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-500 dark:text-slate-300 disabled:opacity-40",children:t("datainspector.next_page")}),c.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[c.jsx("input",{type:"number",min:1,max:go,value:vs,onChange:ne=>Bi(ne.target.value),placeholder:t("datainspector.page_number_placeholder"),className:"w-16 px-2 py-1 rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-[10px] outline-none"}),c.jsx("button",{onClick:()=>{const ne=Number(vs);if(Number.isNaN(ne))return;const De=Math.max(1,Math.min(go,Math.floor(ne)));sa(De),Bi("")},className:"px-2 py-1 rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-500 dark:text-slate-300 text-[10px]",children:t("datainspector.go")})]})]}),c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx(_i,{className:"w-3 h-3"})," LiteBI Studio DB"]}),c.jsx("span",{className:"font-medium",children:t("common.results_count",{count:l==="sql"&&xt==="explain"?Lt.length:l==="table"&&oi==="profiling"?Sn.length:ma?.length||0})})]})]})]}),c.jsx(Zx,{isOpen:!!Ct,onClose:()=>Qt(null),items:ma||[],initialIndex:ma&&Ct?Math.max(0,ma.indexOf(Ct)):0,title:t("common.details"),tableName:et,schema:void 0}),c.jsx(Ol,{isOpen:at,onClose:()=>{Me||it(!1)},title:t("datasource.create_index_title","Create index"),children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"text-xs text-slate-500",children:[t("datasource.index_create_for_table","Table"),": ",c.jsx("span",{className:"font-mono font-semibold text-slate-700",children:et})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:t("datasource.index_name","Index name")}),c.jsx("input",{type:"text",value:bt,onChange:ne=>Et(ne.target.value),className:"w-full p-2 border border-slate-200 rounded-lg bg-white outline-none focus:ring-2 focus:ring-blue-500 text-sm",placeholder:`idx_${et}_...`})]}),c.jsxs("label",{className:"flex items-center gap-2 text-sm text-slate-600",children:[c.jsx("input",{type:"checkbox",checked:Ur,onChange:()=>Vt(!Ur),className:"h-4 w-4"}),t("datasource.index_unique","Unique index")]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase",children:t("datasource.index_columns","Columns")}),c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-40 overflow-auto border border-slate-200 rounded p-2 bg-slate-50",children:(jn||[]).map(ne=>c.jsxs("label",{className:"flex items-center gap-2 text-sm text-slate-700",children:[c.jsx("input",{type:"checkbox",checked:mt.includes(ne.name),onChange:()=>Vl(ne.name),className:"h-4 w-4"}),c.jsx("span",{className:"font-mono",children:ne.name})]},ne.name))})]}),mt.length>0&&c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase",children:t("datasource.index_order","Column order")}),c.jsx("div",{className:"space-y-1 border border-slate-200 rounded p-2 bg-white",children:mt.map((ne,De)=>c.jsxs("div",{className:"flex items-center justify-between text-sm",children:[c.jsxs("span",{className:"font-mono text-slate-700",children:[De+1,". ",ne]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("button",{type:"button",onClick:()=>ul(ne,"up"),disabled:De===0,className:"px-2 py-0.5 text-xs border border-slate-200 rounded disabled:opacity-40",children:""}),c.jsx("button",{type:"button",onClick:()=>ul(ne,"down"),disabled:De===mt.length-1,className:"px-2 py-0.5 text-xs border border-slate-200 rounded disabled:opacity-40",children:""})]})]},ne))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:t("datasource.index_where_optional","WHERE (optional)")}),c.jsx("input",{type:"text",value:tt,onChange:ne=>Wt(ne.target.value),className:"w-full p-2 border border-slate-200 rounded-lg bg-white outline-none focus:ring-2 focus:ring-blue-500 text-sm font-mono",placeholder:"status = 'open'"})]}),c.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2",children:[c.jsx("button",{onClick:()=>it(!1),disabled:Me,className:"px-3 py-1.5 rounded border border-slate-200 text-slate-600 text-sm hover:bg-slate-50 disabled:opacity-40",children:t("common.cancel","Cancel")}),c.jsx("button",{onClick:()=>{Vo()},disabled:Me,className:"px-4 py-1.5 rounded bg-indigo-600 text-white text-sm font-semibold hover:bg-indigo-700 disabled:opacity-40",children:Me?t("common.saving","Saving..."):t("datasource.create_index_btn","Create index")})]})]})}),cc&&c.jsxs("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 bg-red-100 dark:bg-red-900/50 border border-red-200 dark:border-red-800 text-red-700 dark:text-red-200 px-4 py-3 rounded-lg shadow-lg flex items-center gap-3 animate-in slide-in-from-bottom-2 fade-in",children:[c.jsx(il,{className:"w-5 h-5 shrink-0"}),c.jsxs("div",{className:"flex flex-col",children:[c.jsx("p",{className:"text-sm font-bold",children:t("datainspector.sql_error")}),c.jsx("p",{className:"text-xs opacity-90",children:String(cc)})]}),c.jsx("button",{onClick:Ga,className:"ml-auto p-1.5 hover:bg-red-200 dark:hover:bg-red-800 rounded-md transition-colors",children:c.jsx(Ic,{className:"w-4 h-4"})})]})]})};var Bw=function(e,t){return Bw=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(r[n]=a[n])},Bw(e,t)};function hA(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Bw(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var kw=function(){return kw=Object.assign||function(t){for(var r,a=1,n=arguments.length;a<n;a++){r=arguments[a];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},kw.apply(this,arguments)};function tl(e,t,r,a){function n(s){return s instanceof r?s:new r(function(l){l(s)})}return new(r||(r=Promise))(function(s,l){function A(h){try{f(a.next(h))}catch(g){l(g)}}function u(h){try{f(a.throw(h))}catch(g){l(g)}}function f(h){h.done?s(h.value):n(h.value).then(A,u)}f((a=a.apply(e,[])).next())})}function Ri(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},a,n,s,l;return l={next:A(0),throw:A(1),return:A(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function A(f){return function(h){return u([f,h])}}function u(f){if(a)throw new TypeError("Generator is already executing.");for(;r;)try{if(a=1,n&&(s=f[0]&2?n.return:f[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,f[1])).done)return s;switch(n=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,n=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(h){f=[6,h],n=0}finally{a=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function nm(e,t,r){if(arguments.length===2)for(var a=0,n=t.length,s;a<n;a++)(s||!(a in t))&&(s||(s=Array.prototype.slice.call(t,0,a)),s[a]=t[a]);return e.concat(s||t)}var Vc=(function(){function e(t,r,a,n){this.left=t,this.top=r,this.width=a,this.height=n}return e.prototype.add=function(t,r,a,n){return new e(this.left+t,this.top+r,this.width+a,this.height+n)},e.fromClientRect=function(t,r){return new e(r.left+t.windowBounds.left,r.top+t.windowBounds.top,r.width,r.height)},e.fromDOMRectList=function(t,r){var a=Array.from(r).find(function(n){return n.width!==0});return a?new e(a.left+t.windowBounds.left,a.top+t.windowBounds.top,a.width,a.height):e.EMPTY},e.EMPTY=new e(0,0,0,0),e})(),e1=function(e,t){return Vc.fromClientRect(e,t.getBoundingClientRect())},PV=function(e){var t=e.body,r=e.documentElement;if(!t||!r)throw new Error("Unable to get document size");var a=Math.max(Math.max(t.scrollWidth,r.scrollWidth),Math.max(t.offsetWidth,r.offsetWidth),Math.max(t.clientWidth,r.clientWidth)),n=Math.max(Math.max(t.scrollHeight,r.scrollHeight),Math.max(t.offsetHeight,r.offsetHeight),Math.max(t.clientHeight,r.clientHeight));return new Vc(0,0,a,n)},t1=function(e){for(var t=[],r=0,a=e.length;r<a;){var n=e.charCodeAt(r++);if(n>=55296&&n<=56319&&r<a){var s=e.charCodeAt(r++);(s&64512)===56320?t.push(((n&1023)<<10)+(s&1023)+65536):(t.push(n),r--)}else t.push(n)}return t},us=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var a=[],n=-1,s="";++n<r;){var l=e[n];l<=65535?a.push(l):(l-=65536,a.push((l>>10)+55296,l%1024+56320)),(n+1===r||a.length>16384)&&(s+=String.fromCharCode.apply(String,a),a.length=0)}return s},Y4="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",KV=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var sm=0;sm<Y4.length;sm++)KV[Y4.charCodeAt(sm)]=sm;var $4="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",jh=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var im=0;im<$4.length;im++)jh[$4.charCodeAt(im)]=im;var qV=function(e){var t=e.length*.75,r=e.length,a,n=0,s,l,A,u;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var f=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),h=Array.isArray(f)?f:new Uint8Array(f);for(a=0;a<r;a+=4)s=jh[e.charCodeAt(a)],l=jh[e.charCodeAt(a+1)],A=jh[e.charCodeAt(a+2)],u=jh[e.charCodeAt(a+3)],h[n++]=s<<2|l>>4,h[n++]=(l&15)<<4|A>>2,h[n++]=(A&3)<<6|u&63;return f},zV=function(e){for(var t=e.length,r=[],a=0;a<t;a+=2)r.push(e[a+1]<<8|e[a]);return r},VV=function(e){for(var t=e.length,r=[],a=0;a<t;a+=4)r.push(e[a+3]<<24|e[a+2]<<16|e[a+1]<<8|e[a]);return r},U0=5,py=11,nv=2,GV=py-U0,HN=65536>>U0,WV=1<<U0,sv=WV-1,XV=1024>>U0,YV=HN+XV,$V=YV,JV=32,ZV=$V+JV,eG=65536>>py,tG=1<<GV,rG=tG-1,J4=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},aG=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},nG=function(e,t){var r=qV(e),a=Array.isArray(r)?VV(r):new Uint32Array(r),n=Array.isArray(r)?zV(r):new Uint16Array(r),s=24,l=J4(n,s/2,a[4]/2),A=a[5]===2?J4(n,(s+a[4])/2):aG(a,Math.ceil((s+a[4])/4));return new sG(a[0],a[1],a[2],a[3],l,A)},sG=(function(){function e(t,r,a,n,s,l){this.initialValue=t,this.errorValue=r,this.highStart=a,this.highValueIndex=n,this.index=s,this.data=l}return e.prototype.get=function(t){var r;if(t>=0){if(t<55296||t>56319&&t<=65535)return r=this.index[t>>U0],r=(r<<nv)+(t&sv),this.data[r];if(t<=65535)return r=this.index[HN+(t-55296>>U0)],r=(r<<nv)+(t&sv),this.data[r];if(t<this.highStart)return r=ZV-eG+(t>>py),r=this.index[r],r+=t>>U0&rG,r=this.index[r],r=(r<<nv)+(t&sv),this.data[r];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e})(),Z4="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",iG=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var lm=0;lm<Z4.length;lm++)iG[Z4.charCodeAt(lm)]=lm;var lG="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",ek=50,oG=1,PN=2,KN=3,AG=4,cG=5,tk=7,qN=8,rk=9,ju=10,Cw=11,ak=12,Sw=13,uG=14,Dh=15,Ew=16,om=17,kh=18,dG=19,nk=20,Nw=21,Ch=22,iv=23,Od=24,so=25,Ih=26,Qh=27,Rd=28,fG=29,_0=30,hG=31,Am=32,cm=33,Fw=34,Tw=35,Lw=36,Cp=37,Uw=38,Om=39,Rm=40,lv=41,zN=42,pG=43,gG=[9001,65288],VN="!",fa="",um="",jw=nG(lG),Lc=[_0,Lw],Dw=[oG,PN,KN,cG],GN=[ju,qN],sk=[Qh,Ih],mG=Dw.concat(GN),ik=[Uw,Om,Rm,Fw,Tw],xG=[Dh,Sw],bG=function(e,t){t===void 0&&(t="strict");var r=[],a=[],n=[];return e.forEach(function(s,l){var A=jw.get(s);if(A>ek?(n.push(!0),A-=ek):n.push(!1),["normal","auto","loose"].indexOf(t)!==-1&&[8208,8211,12316,12448].indexOf(s)!==-1)return a.push(l),r.push(Ew);if(A===AG||A===Cw){if(l===0)return a.push(l),r.push(_0);var u=r[l-1];return mG.indexOf(u)===-1?(a.push(a[l-1]),r.push(u)):(a.push(l),r.push(_0))}if(a.push(l),A===hG)return r.push(t==="strict"?Nw:Cp);if(A===zN||A===fG)return r.push(_0);if(A===pG)return s>=131072&&s<=196605||s>=196608&&s<=262141?r.push(Cp):r.push(_0);r.push(A)}),[a,r,n]},ov=function(e,t,r,a){var n=a[r];if(Array.isArray(e)?e.indexOf(n)!==-1:e===n)for(var s=r;s<=a.length;){s++;var l=a[s];if(l===t)return!0;if(l!==ju)break}if(n===ju)for(var s=r;s>0;){s--;var A=a[s];if(Array.isArray(e)?e.indexOf(A)!==-1:e===A)for(var u=r;u<=a.length;){u++;var l=a[u];if(l===t)return!0;if(l!==ju)break}if(A!==ju)break}return!1},lk=function(e,t){for(var r=e;r>=0;){var a=t[r];if(a===ju)r--;else return a}return 0},vG=function(e,t,r,a,n){if(r[a]===0)return fa;var s=a-1;if(Array.isArray(n)&&n[s]===!0)return fa;var l=s-1,A=s+1,u=t[s],f=l>=0?t[l]:0,h=t[A];if(u===PN&&h===KN)return fa;if(Dw.indexOf(u)!==-1)return VN;if(Dw.indexOf(h)!==-1||GN.indexOf(h)!==-1)return fa;if(lk(s,t)===qN)return um;if(jw.get(e[s])===Cw||(u===Am||u===cm)&&jw.get(e[A])===Cw||u===tk||h===tk||u===rk||[ju,Sw,Dh].indexOf(u)===-1&&h===rk||[om,kh,dG,Od,Rd].indexOf(h)!==-1||lk(s,t)===Ch||ov(iv,Ch,s,t)||ov([om,kh],Nw,s,t)||ov(ak,ak,s,t))return fa;if(u===ju)return um;if(u===iv||h===iv)return fa;if(h===Ew||u===Ew)return um;if([Sw,Dh,Nw].indexOf(h)!==-1||u===uG||f===Lw&&xG.indexOf(u)!==-1||u===Rd&&h===Lw||h===nk||Lc.indexOf(h)!==-1&&u===so||Lc.indexOf(u)!==-1&&h===so||u===Qh&&[Cp,Am,cm].indexOf(h)!==-1||[Cp,Am,cm].indexOf(u)!==-1&&h===Ih||Lc.indexOf(u)!==-1&&sk.indexOf(h)!==-1||sk.indexOf(u)!==-1&&Lc.indexOf(h)!==-1||[Qh,Ih].indexOf(u)!==-1&&(h===so||[Ch,Dh].indexOf(h)!==-1&&t[A+1]===so)||[Ch,Dh].indexOf(u)!==-1&&h===so||u===so&&[so,Rd,Od].indexOf(h)!==-1)return fa;if([so,Rd,Od,om,kh].indexOf(h)!==-1)for(var g=s;g>=0;){var x=t[g];if(x===so)return fa;if([Rd,Od].indexOf(x)!==-1)g--;else break}if([Qh,Ih].indexOf(h)!==-1)for(var g=[om,kh].indexOf(u)!==-1?l:s;g>=0;){var x=t[g];if(x===so)return fa;if([Rd,Od].indexOf(x)!==-1)g--;else break}if(Uw===u&&[Uw,Om,Fw,Tw].indexOf(h)!==-1||[Om,Fw].indexOf(u)!==-1&&[Om,Rm].indexOf(h)!==-1||[Rm,Tw].indexOf(u)!==-1&&h===Rm||ik.indexOf(u)!==-1&&[nk,Ih].indexOf(h)!==-1||ik.indexOf(h)!==-1&&u===Qh||Lc.indexOf(u)!==-1&&Lc.indexOf(h)!==-1||u===Od&&Lc.indexOf(h)!==-1||Lc.concat(so).indexOf(u)!==-1&&h===Ch&&gG.indexOf(e[A])===-1||Lc.concat(so).indexOf(h)!==-1&&u===kh)return fa;if(u===lv&&h===lv){for(var m=r[s],w=1;m>0&&(m--,t[m]===lv);)w++;if(w%2!==0)return fa}return u===Am&&h===cm?fa:um},wG=function(e,t){t||(t={lineBreak:"normal",wordBreak:"normal"});var r=bG(e,t.lineBreak),a=r[0],n=r[1],s=r[2];(t.wordBreak==="break-all"||t.wordBreak==="break-word")&&(n=n.map(function(A){return[so,_0,zN].indexOf(A)!==-1?Cp:A}));var l=t.wordBreak==="keep-all"?s.map(function(A,u){return A&&e[u]>=19968&&e[u]<=40959}):void 0;return[a,n,l]},yG=(function(){function e(t,r,a,n){this.codePoints=t,this.required=r===VN,this.start=a,this.end=n}return e.prototype.slice=function(){return us.apply(void 0,this.codePoints.slice(this.start,this.end))},e})(),_G=function(e,t){var r=t1(e),a=wG(r,t),n=a[0],s=a[1],l=a[2],A=r.length,u=0,f=0;return{next:function(){if(f>=A)return{done:!0,value:null};for(var h=fa;f<A&&(h=vG(r,s,n,++f,l))===fa;);if(h!==fa||f===A){var g=new yG(r,h,u,f);return u=f,{value:g,done:!1}}return{done:!0,value:null}}}},BG=1,kG=2,qp=4,ok=8,_x=10,Ak=47,ep=92,CG=9,SG=32,dm=34,Sh=61,EG=35,NG=36,FG=37,fm=39,hm=40,Eh=41,TG=95,Il=45,LG=33,UG=60,jG=62,DG=64,IG=91,QG=93,OG=61,RG=123,pm=63,MG=125,ck=124,HG=126,PG=128,uk=65533,Av=42,S0=43,KG=44,qG=58,zG=59,Sp=46,VG=0,GG=8,WG=11,XG=14,YG=31,$G=127,HA=-1,WN=48,XN=97,YN=101,JG=102,ZG=117,eW=122,$N=65,JN=69,ZN=70,tW=85,rW=90,Pi=function(e){return e>=WN&&e<=57},aW=function(e){return e>=55296&&e<=57343},Md=function(e){return Pi(e)||e>=$N&&e<=ZN||e>=XN&&e<=JG},nW=function(e){return e>=XN&&e<=eW},sW=function(e){return e>=$N&&e<=rW},iW=function(e){return nW(e)||sW(e)},lW=function(e){return e>=PG},gm=function(e){return e===_x||e===CG||e===SG},Bx=function(e){return iW(e)||lW(e)||e===TG},dk=function(e){return Bx(e)||Pi(e)||e===Il},oW=function(e){return e>=VG&&e<=GG||e===WG||e>=XG&&e<=YG||e===$G},Su=function(e,t){return e!==ep?!1:t!==_x},mm=function(e,t,r){return e===Il?Bx(t)||Su(t,r):Bx(e)?!0:!!(e===ep&&Su(e,t))},cv=function(e,t,r){return e===S0||e===Il?Pi(t)?!0:t===Sp&&Pi(r):Pi(e===Sp?t:e)},AW=function(e){var t=0,r=1;(e[t]===S0||e[t]===Il)&&(e[t]===Il&&(r=-1),t++);for(var a=[];Pi(e[t]);)a.push(e[t++]);var n=a.length?parseInt(us.apply(void 0,a),10):0;e[t]===Sp&&t++;for(var s=[];Pi(e[t]);)s.push(e[t++]);var l=s.length,A=l?parseInt(us.apply(void 0,s),10):0;(e[t]===JN||e[t]===YN)&&t++;var u=1;(e[t]===S0||e[t]===Il)&&(e[t]===Il&&(u=-1),t++);for(var f=[];Pi(e[t]);)f.push(e[t++]);var h=f.length?parseInt(us.apply(void 0,f),10):0;return r*(n+A*Math.pow(10,-l))*Math.pow(10,u*h)},cW={type:2},uW={type:3},dW={type:4},fW={type:13},hW={type:8},pW={type:21},gW={type:9},mW={type:10},xW={type:11},bW={type:12},vW={type:14},xm={type:23},wW={type:1},yW={type:25},_W={type:24},BW={type:26},kW={type:27},CW={type:28},SW={type:29},EW={type:31},Iw={type:32},eF=(function(){function e(){this._value=[]}return e.prototype.write=function(t){this._value=this._value.concat(t1(t))},e.prototype.read=function(){for(var t=[],r=this.consumeToken();r!==Iw;)t.push(r),r=this.consumeToken();return t},e.prototype.consumeToken=function(){var t=this.consumeCodePoint();switch(t){case dm:return this.consumeStringToken(dm);case EG:var r=this.peekCodePoint(0),a=this.peekCodePoint(1),n=this.peekCodePoint(2);if(dk(r)||Su(a,n)){var s=mm(r,a,n)?kG:BG,l=this.consumeName();return{type:5,value:l,flags:s}}break;case NG:if(this.peekCodePoint(0)===Sh)return this.consumeCodePoint(),fW;break;case fm:return this.consumeStringToken(fm);case hm:return cW;case Eh:return uW;case Av:if(this.peekCodePoint(0)===Sh)return this.consumeCodePoint(),vW;break;case S0:if(cv(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case KG:return dW;case Il:var A=t,u=this.peekCodePoint(0),f=this.peekCodePoint(1);if(cv(A,u,f))return this.reconsumeCodePoint(t),this.consumeNumericToken();if(mm(A,u,f))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();if(u===Il&&f===jG)return this.consumeCodePoint(),this.consumeCodePoint(),_W;break;case Sp:if(cv(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case Ak:if(this.peekCodePoint(0)===Av)for(this.consumeCodePoint();;){var h=this.consumeCodePoint();if(h===Av&&(h=this.consumeCodePoint(),h===Ak))return this.consumeToken();if(h===HA)return this.consumeToken()}break;case qG:return BW;case zG:return kW;case UG:if(this.peekCodePoint(0)===LG&&this.peekCodePoint(1)===Il&&this.peekCodePoint(2)===Il)return this.consumeCodePoint(),this.consumeCodePoint(),yW;break;case DG:var g=this.peekCodePoint(0),x=this.peekCodePoint(1),m=this.peekCodePoint(2);if(mm(g,x,m)){var l=this.consumeName();return{type:7,value:l}}break;case IG:return CW;case ep:if(Su(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();break;case QG:return SW;case OG:if(this.peekCodePoint(0)===Sh)return this.consumeCodePoint(),hW;break;case RG:return xW;case MG:return bW;case ZG:case tW:var w=this.peekCodePoint(0),v=this.peekCodePoint(1);return w===S0&&(Md(v)||v===pm)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(t),this.consumeIdentLikeToken();case ck:if(this.peekCodePoint(0)===Sh)return this.consumeCodePoint(),gW;if(this.peekCodePoint(0)===ck)return this.consumeCodePoint(),pW;break;case HG:if(this.peekCodePoint(0)===Sh)return this.consumeCodePoint(),mW;break;case HA:return Iw}return gm(t)?(this.consumeWhiteSpace(),EW):Pi(t)?(this.reconsumeCodePoint(t),this.consumeNumericToken()):Bx(t)?(this.reconsumeCodePoint(t),this.consumeIdentLikeToken()):{type:6,value:us(t)}},e.prototype.consumeCodePoint=function(){var t=this._value.shift();return typeof t>"u"?-1:t},e.prototype.reconsumeCodePoint=function(t){this._value.unshift(t)},e.prototype.peekCodePoint=function(t){return t>=this._value.length?-1:this._value[t]},e.prototype.consumeUnicodeRangeToken=function(){for(var t=[],r=this.consumeCodePoint();Md(r)&&t.length<6;)t.push(r),r=this.consumeCodePoint();for(var a=!1;r===pm&&t.length<6;)t.push(r),r=this.consumeCodePoint(),a=!0;if(a){var n=parseInt(us.apply(void 0,t.map(function(u){return u===pm?WN:u})),16),s=parseInt(us.apply(void 0,t.map(function(u){return u===pm?ZN:u})),16);return{type:30,start:n,end:s}}var l=parseInt(us.apply(void 0,t),16);if(this.peekCodePoint(0)===Il&&Md(this.peekCodePoint(1))){this.consumeCodePoint(),r=this.consumeCodePoint();for(var A=[];Md(r)&&A.length<6;)A.push(r),r=this.consumeCodePoint();var s=parseInt(us.apply(void 0,A),16);return{type:30,start:l,end:s}}else return{type:30,start:l,end:l}},e.prototype.consumeIdentLikeToken=function(){var t=this.consumeName();return t.toLowerCase()==="url"&&this.peekCodePoint(0)===hm?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===hm?(this.consumeCodePoint(),{type:19,value:t}):{type:20,value:t}},e.prototype.consumeUrlToken=function(){var t=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===HA)return{type:22,value:""};var r=this.peekCodePoint(0);if(r===fm||r===dm){var a=this.consumeStringToken(this.consumeCodePoint());return a.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===HA||this.peekCodePoint(0)===Eh)?(this.consumeCodePoint(),{type:22,value:a.value}):(this.consumeBadUrlRemnants(),xm)}for(;;){var n=this.consumeCodePoint();if(n===HA||n===Eh)return{type:22,value:us.apply(void 0,t)};if(gm(n))return this.consumeWhiteSpace(),this.peekCodePoint(0)===HA||this.peekCodePoint(0)===Eh?(this.consumeCodePoint(),{type:22,value:us.apply(void 0,t)}):(this.consumeBadUrlRemnants(),xm);if(n===dm||n===fm||n===hm||oW(n))return this.consumeBadUrlRemnants(),xm;if(n===ep)if(Su(n,this.peekCodePoint(0)))t.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),xm;else t.push(n)}},e.prototype.consumeWhiteSpace=function(){for(;gm(this.peekCodePoint(0));)this.consumeCodePoint()},e.prototype.consumeBadUrlRemnants=function(){for(;;){var t=this.consumeCodePoint();if(t===Eh||t===HA)return;Su(t,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},e.prototype.consumeStringSlice=function(t){for(var r=5e4,a="";t>0;){var n=Math.min(r,t);a+=us.apply(void 0,this._value.splice(0,n)),t-=n}return this._value.shift(),a},e.prototype.consumeStringToken=function(t){var r="",a=0;do{var n=this._value[a];if(n===HA||n===void 0||n===t)return r+=this.consumeStringSlice(a),{type:0,value:r};if(n===_x)return this._value.splice(0,a),wW;if(n===ep){var s=this._value[a+1];s!==HA&&s!==void 0&&(s===_x?(r+=this.consumeStringSlice(a),a=-1,this._value.shift()):Su(n,s)&&(r+=this.consumeStringSlice(a),r+=us(this.consumeEscapedCodePoint()),a=-1))}a++}while(!0)},e.prototype.consumeNumber=function(){var t=[],r=qp,a=this.peekCodePoint(0);for((a===S0||a===Il)&&t.push(this.consumeCodePoint());Pi(this.peekCodePoint(0));)t.push(this.consumeCodePoint());a=this.peekCodePoint(0);var n=this.peekCodePoint(1);if(a===Sp&&Pi(n))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),r=ok;Pi(this.peekCodePoint(0));)t.push(this.consumeCodePoint());a=this.peekCodePoint(0),n=this.peekCodePoint(1);var s=this.peekCodePoint(2);if((a===JN||a===YN)&&((n===S0||n===Il)&&Pi(s)||Pi(n)))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),r=ok;Pi(this.peekCodePoint(0));)t.push(this.consumeCodePoint());return[AW(t),r]},e.prototype.consumeNumericToken=function(){var t=this.consumeNumber(),r=t[0],a=t[1],n=this.peekCodePoint(0),s=this.peekCodePoint(1),l=this.peekCodePoint(2);if(mm(n,s,l)){var A=this.consumeName();return{type:15,number:r,flags:a,unit:A}}return n===FG?(this.consumeCodePoint(),{type:16,number:r,flags:a}):{type:17,number:r,flags:a}},e.prototype.consumeEscapedCodePoint=function(){var t=this.consumeCodePoint();if(Md(t)){for(var r=us(t);Md(this.peekCodePoint(0))&&r.length<6;)r+=us(this.consumeCodePoint());gm(this.peekCodePoint(0))&&this.consumeCodePoint();var a=parseInt(r,16);return a===0||aW(a)||a>1114111?uk:a}return t===HA?uk:t},e.prototype.consumeName=function(){for(var t="";;){var r=this.consumeCodePoint();if(dk(r))t+=us(r);else if(Su(r,this.peekCodePoint(0)))t+=us(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(r),t}},e})(),tF=(function(){function e(t){this._tokens=t}return e.create=function(t){var r=new eF;return r.write(t),new e(r.read())},e.parseValue=function(t){return e.create(t).parseComponentValue()},e.parseValues=function(t){return e.create(t).parseComponentValues()},e.prototype.parseComponentValue=function(){for(var t=this.consumeToken();t.type===31;)t=this.consumeToken();if(t.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(t);var r=this.consumeComponentValue();do t=this.consumeToken();while(t.type===31);if(t.type===32)return r;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},e.prototype.parseComponentValues=function(){for(var t=[];;){var r=this.consumeComponentValue();if(r.type===32)return t;t.push(r),t.push()}},e.prototype.consumeComponentValue=function(){var t=this.consumeToken();switch(t.type){case 11:case 28:case 2:return this.consumeSimpleBlock(t.type);case 19:return this.consumeFunction(t)}return t},e.prototype.consumeSimpleBlock=function(t){for(var r={type:t,values:[]},a=this.consumeToken();;){if(a.type===32||FW(a,t))return r;this.reconsumeToken(a),r.values.push(this.consumeComponentValue()),a=this.consumeToken()}},e.prototype.consumeFunction=function(t){for(var r={name:t.value,values:[],type:18};;){var a=this.consumeToken();if(a.type===32||a.type===3)return r;this.reconsumeToken(a),r.values.push(this.consumeComponentValue())}},e.prototype.consumeToken=function(){var t=this._tokens.shift();return typeof t>"u"?Iw:t},e.prototype.reconsumeToken=function(t){this._tokens.unshift(t)},e})(),zp=function(e){return e.type===15},Tf=function(e){return e.type===17},Za=function(e){return e.type===20},NW=function(e){return e.type===0},Qw=function(e,t){return Za(e)&&e.value===t},rF=function(e){return e.type!==31},_f=function(e){return e.type!==31&&e.type!==4},sc=function(e){var t=[],r=[];return e.forEach(function(a){if(a.type===4){if(r.length===0)throw new Error("Error parsing function args, zero tokens for arg");t.push(r),r=[];return}a.type!==31&&r.push(a)}),r.length&&t.push(r),t},FW=function(e,t){return t===11&&e.type===12||t===28&&e.type===29?!0:t===2&&e.type===3},Xu=function(e){return e.type===17||e.type===15},Ts=function(e){return e.type===16||Xu(e)},aF=function(e){return e.length>1?[e[0],e[1]]:[e[0]]},yi={type:17,number:0,flags:qp},gy={type:16,number:50,flags:qp},Du={type:16,number:100,flags:qp},Oh=function(e,t,r){var a=e[0],n=e[1];return[fn(a,t),fn(typeof n<"u"?n:a,r)]},fn=function(e,t){if(e.type===16)return e.number/100*t;if(zp(e))switch(e.unit){case"rem":case"em":return 16*e.number;default:return e.number}return e.number},nF="deg",sF="grad",iF="rad",lF="turn",r1={name:"angle",parse:function(e,t){if(t.type===15)switch(t.unit){case nF:return Math.PI*t.number/180;case sF:return Math.PI/200*t.number;case iF:return t.number;case lF:return Math.PI*2*t.number}throw new Error("Unsupported angle type")}},oF=function(e){return e.type===15&&(e.unit===nF||e.unit===sF||e.unit===iF||e.unit===lF)},AF=function(e){var t=e.filter(Za).map(function(r){return r.value}).join(" ");switch(t){case"to bottom right":case"to right bottom":case"left top":case"top left":return[yi,yi];case"to top":case"bottom":return jo(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[yi,Du];case"to right":case"left":return jo(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[Du,Du];case"to bottom":case"top":return jo(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[Du,yi];case"to left":case"right":return jo(270)}return 0},jo=function(e){return Math.PI*e/180},Hu={name:"color",parse:function(e,t){if(t.type===18){var r=TW[t.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported color function "'+t.name+'"');return r(e,t.values)}if(t.type===5){if(t.value.length===3){var a=t.value.substring(0,1),n=t.value.substring(1,2),s=t.value.substring(2,3);return Iu(parseInt(a+a,16),parseInt(n+n,16),parseInt(s+s,16),1)}if(t.value.length===4){var a=t.value.substring(0,1),n=t.value.substring(1,2),s=t.value.substring(2,3),l=t.value.substring(3,4);return Iu(parseInt(a+a,16),parseInt(n+n,16),parseInt(s+s,16),parseInt(l+l,16)/255)}if(t.value.length===6){var a=t.value.substring(0,2),n=t.value.substring(2,4),s=t.value.substring(4,6);return Iu(parseInt(a,16),parseInt(n,16),parseInt(s,16),1)}if(t.value.length===8){var a=t.value.substring(0,2),n=t.value.substring(2,4),s=t.value.substring(4,6),l=t.value.substring(6,8);return Iu(parseInt(a,16),parseInt(n,16),parseInt(s,16),parseInt(l,16)/255)}}if(t.type===20){var A=Kc[t.value.toUpperCase()];if(typeof A<"u")return A}return Kc.TRANSPARENT}},Pu=function(e){return(255&e)===0},Js=function(e){var t=255&e,r=255&e>>8,a=255&e>>16,n=255&e>>24;return t<255?"rgba("+n+","+a+","+r+","+t/255+")":"rgb("+n+","+a+","+r+")"},Iu=function(e,t,r,a){return(e<<24|t<<16|r<<8|Math.round(a*255)<<0)>>>0},fk=function(e,t){if(e.type===17)return e.number;if(e.type===16){var r=t===3?1:255;return t===3?e.number/100*r:Math.round(e.number/100*r)}return 0},hk=function(e,t){var r=t.filter(_f);if(r.length===3){var a=r.map(fk),n=a[0],s=a[1],l=a[2];return Iu(n,s,l,1)}if(r.length===4){var A=r.map(fk),n=A[0],s=A[1],l=A[2],u=A[3];return Iu(n,s,l,u)}return 0};function uv(e,t,r){return r<0&&(r+=1),r>=1&&(r-=1),r<1/6?(t-e)*r*6+e:r<1/2?t:r<2/3?(t-e)*6*(2/3-r)+e:e}var pk=function(e,t){var r=t.filter(_f),a=r[0],n=r[1],s=r[2],l=r[3],A=(a.type===17?jo(a.number):r1.parse(e,a))/(Math.PI*2),u=Ts(n)?n.number/100:0,f=Ts(s)?s.number/100:0,h=typeof l<"u"&&Ts(l)?fn(l,1):1;if(u===0)return Iu(f*255,f*255,f*255,1);var g=f<=.5?f*(u+1):f+u-f*u,x=f*2-g,m=uv(x,g,A+1/3),w=uv(x,g,A),v=uv(x,g,A-1/3);return Iu(m*255,w*255,v*255,h)},TW={hsl:pk,hsla:pk,rgb:hk,rgba:hk},tp=function(e,t){return Hu.parse(e,tF.create(t).parseComponentValue())},Kc={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},LW={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map(function(r){if(Za(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},UW={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},a1=function(e,t){var r=Hu.parse(e,t[0]),a=t[1];return a&&Ts(a)?{color:r,stop:a}:{color:r,stop:null}},gk=function(e,t){var r=e[0],a=e[e.length-1];r.stop===null&&(r.stop=yi),a.stop===null&&(a.stop=Du);for(var n=[],s=0,l=0;l<e.length;l++){var A=e[l].stop;if(A!==null){var u=fn(A,t);u>s?n.push(u):n.push(s),s=u}else n.push(null)}for(var f=null,l=0;l<n.length;l++){var h=n[l];if(h===null)f===null&&(f=l);else if(f!==null){for(var g=l-f,x=n[f-1],m=(h-x)/(g+1),w=1;w<=g;w++)n[f+w-1]=m*w;f=null}}return e.map(function(v,B){var k=v.color;return{color:k,stop:Math.max(Math.min(1,n[B]/t),0)}})},jW=function(e,t,r){var a=t/2,n=r/2,s=fn(e[0],t)-a,l=n-fn(e[1],r);return(Math.atan2(l,s)+Math.PI*2)%(Math.PI*2)},DW=function(e,t,r){var a=typeof e=="number"?e:jW(e,t,r),n=Math.abs(t*Math.sin(a))+Math.abs(r*Math.cos(a)),s=t/2,l=r/2,A=n/2,u=Math.sin(a-Math.PI/2)*A,f=Math.cos(a-Math.PI/2)*A;return[n,s-f,s+f,l-u,l+u]},sA=function(e,t){return Math.sqrt(e*e+t*t)},mk=function(e,t,r,a,n){var s=[[0,0],[0,t],[e,0],[e,t]];return s.reduce(function(l,A){var u=A[0],f=A[1],h=sA(r-u,a-f);return(n?h<l.optimumDistance:h>l.optimumDistance)?{optimumCorner:A,optimumDistance:h}:l},{optimumDistance:n?1/0:-1/0,optimumCorner:null}).optimumCorner},IW=function(e,t,r,a,n){var s=0,l=0;switch(e.size){case 0:e.shape===0?s=l=Math.min(Math.abs(t),Math.abs(t-a),Math.abs(r),Math.abs(r-n)):e.shape===1&&(s=Math.min(Math.abs(t),Math.abs(t-a)),l=Math.min(Math.abs(r),Math.abs(r-n)));break;case 2:if(e.shape===0)s=l=Math.min(sA(t,r),sA(t,r-n),sA(t-a,r),sA(t-a,r-n));else if(e.shape===1){var A=Math.min(Math.abs(r),Math.abs(r-n))/Math.min(Math.abs(t),Math.abs(t-a)),u=mk(a,n,t,r,!0),f=u[0],h=u[1];s=sA(f-t,(h-r)/A),l=A*s}break;case 1:e.shape===0?s=l=Math.max(Math.abs(t),Math.abs(t-a),Math.abs(r),Math.abs(r-n)):e.shape===1&&(s=Math.max(Math.abs(t),Math.abs(t-a)),l=Math.max(Math.abs(r),Math.abs(r-n)));break;case 3:if(e.shape===0)s=l=Math.max(sA(t,r),sA(t,r-n),sA(t-a,r),sA(t-a,r-n));else if(e.shape===1){var A=Math.max(Math.abs(r),Math.abs(r-n))/Math.max(Math.abs(t),Math.abs(t-a)),g=mk(a,n,t,r,!1),f=g[0],h=g[1];s=sA(f-t,(h-r)/A),l=A*s}break}return Array.isArray(e.size)&&(s=fn(e.size[0],a),l=e.size.length===2?fn(e.size[1],n):s),[s,l]},QW=function(e,t){var r=jo(180),a=[];return sc(t).forEach(function(n,s){if(s===0){var l=n[0];if(l.type===20&&l.value==="to"){r=AF(n);return}else if(oF(l)){r=r1.parse(e,l);return}}var A=a1(e,n);a.push(A)}),{angle:r,stops:a,type:1}},bm=function(e,t){var r=jo(180),a=[];return sc(t).forEach(function(n,s){if(s===0){var l=n[0];if(l.type===20&&["top","left","right","bottom"].indexOf(l.value)!==-1){r=AF(n);return}else if(oF(l)){r=(r1.parse(e,l)+jo(270))%jo(360);return}}var A=a1(e,n);a.push(A)}),{angle:r,stops:a,type:1}},OW=function(e,t){var r=jo(180),a=[],n=1,s=0,l=3,A=[];return sc(t).forEach(function(u,f){var h=u[0];if(f===0){if(Za(h)&&h.value==="linear"){n=1;return}else if(Za(h)&&h.value==="radial"){n=2;return}}if(h.type===18){if(h.name==="from"){var g=Hu.parse(e,h.values[0]);a.push({stop:yi,color:g})}else if(h.name==="to"){var g=Hu.parse(e,h.values[0]);a.push({stop:Du,color:g})}else if(h.name==="color-stop"){var x=h.values.filter(_f);if(x.length===2){var g=Hu.parse(e,x[1]),m=x[0];Tf(m)&&a.push({stop:{type:16,number:m.number*100,flags:m.flags},color:g})}}}}),n===1?{angle:(r+jo(180))%jo(360),stops:a,type:n}:{size:l,shape:s,stops:a,position:A,type:n}},cF="closest-side",uF="farthest-side",dF="closest-corner",fF="farthest-corner",hF="circle",pF="ellipse",gF="cover",mF="contain",RW=function(e,t){var r=0,a=3,n=[],s=[];return sc(t).forEach(function(l,A){var u=!0;if(A===0){var f=!1;u=l.reduce(function(g,x){if(f)if(Za(x))switch(x.value){case"center":return s.push(gy),g;case"top":case"left":return s.push(yi),g;case"right":case"bottom":return s.push(Du),g}else(Ts(x)||Xu(x))&&s.push(x);else if(Za(x))switch(x.value){case hF:return r=0,!1;case pF:return r=1,!1;case"at":return f=!0,!1;case cF:return a=0,!1;case gF:case uF:return a=1,!1;case mF:case dF:return a=2,!1;case fF:return a=3,!1}else if(Xu(x)||Ts(x))return Array.isArray(a)||(a=[]),a.push(x),!1;return g},u)}if(u){var h=a1(e,l);n.push(h)}}),{size:a,shape:r,stops:n,position:s,type:2}},vm=function(e,t){var r=0,a=3,n=[],s=[];return sc(t).forEach(function(l,A){var u=!0;if(A===0?u=l.reduce(function(h,g){if(Za(g))switch(g.value){case"center":return s.push(gy),!1;case"top":case"left":return s.push(yi),!1;case"right":case"bottom":return s.push(Du),!1}else if(Ts(g)||Xu(g))return s.push(g),!1;return h},u):A===1&&(u=l.reduce(function(h,g){if(Za(g))switch(g.value){case hF:return r=0,!1;case pF:return r=1,!1;case mF:case cF:return a=0,!1;case uF:return a=1,!1;case dF:return a=2,!1;case gF:case fF:return a=3,!1}else if(Xu(g)||Ts(g))return Array.isArray(a)||(a=[]),a.push(g),!1;return h},u)),u){var f=a1(e,l);n.push(f)}}),{size:a,shape:r,stops:n,position:s,type:2}},MW=function(e){return e.type===1},HW=function(e){return e.type===2},my={name:"image",parse:function(e,t){if(t.type===22){var r={url:t.value,type:0};return e.cache.addImage(t.value),r}if(t.type===18){var a=xF[t.name];if(typeof a>"u")throw new Error('Attempting to parse an unsupported image function "'+t.name+'"');return a(e,t.values)}throw new Error("Unsupported image type "+t.type)}};function PW(e){return!(e.type===20&&e.value==="none")&&(e.type!==18||!!xF[e.name])}var xF={"linear-gradient":QW,"-moz-linear-gradient":bm,"-ms-linear-gradient":bm,"-o-linear-gradient":bm,"-webkit-linear-gradient":bm,"radial-gradient":RW,"-moz-radial-gradient":vm,"-ms-radial-gradient":vm,"-o-radial-gradient":vm,"-webkit-radial-gradient":vm,"-webkit-gradient":OW},KW={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(t.length===0)return[];var r=t[0];return r.type===20&&r.value==="none"?[]:t.filter(function(a){return _f(a)&&PW(a)}).map(function(a){return my.parse(e,a)})}},qW={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map(function(r){if(Za(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},zW={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(e,t){return sc(t).map(function(r){return r.filter(Ts)}).map(aF)}},VW={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(e,t){return sc(t).map(function(r){return r.filter(Za).map(function(a){return a.value}).join(" ")}).map(GW)}},GW=function(e){switch(e){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;default:return 0}},df;(function(e){e.AUTO="auto",e.CONTAIN="contain",e.COVER="cover"})(df||(df={}));var WW={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(e,t){return sc(t).map(function(r){return r.filter(XW)})}},XW=function(e){return Za(e)||Ts(e)},n1=function(e){return{name:"border-"+e+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},YW=n1("top"),$W=n1("right"),JW=n1("bottom"),ZW=n1("left"),s1=function(e){return{name:"border-radius-"+e,initialValue:"0 0",prefix:!1,type:1,parse:function(t,r){return aF(r.filter(Ts))}}},eX=s1("top-left"),tX=s1("top-right"),rX=s1("bottom-right"),aX=s1("bottom-left"),i1=function(e){return{name:"border-"+e+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(t,r){switch(r){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},nX=i1("top"),sX=i1("right"),iX=i1("bottom"),lX=i1("left"),l1=function(e){return{name:"border-"+e+"-width",initialValue:"0",type:0,prefix:!1,parse:function(t,r){return zp(r)?r.number:0}}},oX=l1("top"),AX=l1("right"),cX=l1("bottom"),uX=l1("left"),dX={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},fX={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(e,t){return t==="rtl"?1:0}},hX={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(e,t){return t.filter(Za).reduce(function(r,a){return r|pX(a.value)},0)}},pX=function(e){switch(e){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},gX={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},mX={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(e,t){return t.type===20&&t.value==="normal"?0:t.type===17||t.type===15?t.number:0}},kx;(function(e){e.NORMAL="normal",e.STRICT="strict"})(kx||(kx={}));var xX={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){return t==="strict"?kx.STRICT:kx.NORMAL}},bX={name:"line-height",initialValue:"normal",prefix:!1,type:4},xk=function(e,t){return Za(e)&&e.value==="normal"?1.2*t:e.type===17?t*e.number:Ts(e)?fn(e,t):t},vX={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(e,t){return t.type===20&&t.value==="none"?null:my.parse(e,t)}},wX={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(e,t){return t==="inside"?0:1}},Ow={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;default:return-1}}},o1=function(e){return{name:"margin-"+e,initialValue:"0",prefix:!1,type:4}},yX=o1("top"),_X=o1("right"),BX=o1("bottom"),kX=o1("left"),CX={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(e,t){return t.filter(Za).map(function(r){switch(r.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;default:return 0}})}},SX={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){return t==="break-word"?"break-word":"normal"}},A1=function(e){return{name:"padding-"+e,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},EX=A1("top"),NX=A1("right"),FX=A1("bottom"),TX=A1("left"),LX={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(e,t){switch(t){case"right":return 2;case"center":case"justify":return 1;default:return 0}}},UX={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(e,t){switch(t){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},jX={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.length===1&&Qw(t[0],"none")?[]:sc(t).map(function(r){for(var a={color:Kc.TRANSPARENT,offsetX:yi,offsetY:yi,blur:yi},n=0,s=0;s<r.length;s++){var l=r[s];Xu(l)?(n===0?a.offsetX=l:n===1?a.offsetY=l:a.blur=l,n++):a.color=Hu.parse(e,l)}return a})}},DX={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},IX={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(e,t){if(t.type===20&&t.value==="none")return null;if(t.type===18){var r=RX[t.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported transform function "'+t.name+'"');return r(t.values)}return null}},QX=function(e){var t=e.filter(function(r){return r.type===17}).map(function(r){return r.number});return t.length===6?t:null},OX=function(e){var t=e.filter(function(u){return u.type===17}).map(function(u){return u.number}),r=t[0],a=t[1];t[2],t[3];var n=t[4],s=t[5];t[6],t[7],t[8],t[9],t[10],t[11];var l=t[12],A=t[13];return t[14],t[15],t.length===16?[r,a,n,s,l,A]:null},RX={matrix:QX,matrix3d:OX},bk={type:16,number:50,flags:qp},MX=[bk,bk],HX={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(e,t){var r=t.filter(Ts);return r.length!==2?MX:[r[0],r[1]]}},PX={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"hidden":return 1;case"collapse":return 2;default:return 0}}},rp;(function(e){e.NORMAL="normal",e.BREAK_ALL="break-all",e.KEEP_ALL="keep-all"})(rp||(rp={}));var KX={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"break-all":return rp.BREAK_ALL;case"keep-all":return rp.KEEP_ALL;default:return rp.NORMAL}}},qX={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(e,t){if(t.type===20)return{auto:!0,order:0};if(Tf(t))return{auto:!1,order:t.number};throw new Error("Invalid z-index number parsed")}},bF={name:"time",parse:function(e,t){if(t.type===15)switch(t.unit.toLowerCase()){case"s":return 1e3*t.number;case"ms":return t.number}throw new Error("Unsupported time type")}},zX={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(e,t){return Tf(t)?t.number:1}},VX={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},GX={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(e,t){return t.filter(Za).map(function(r){switch(r.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(r){return r!==0})}},WX={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(e,t){var r=[],a=[];return t.forEach(function(n){switch(n.type){case 20:case 0:r.push(n.value);break;case 17:r.push(n.number.toString());break;case 4:a.push(r.join(" ")),r.length=0;break}}),r.length&&a.push(r.join(" ")),a.map(function(n){return n.indexOf(" ")===-1?n:"'"+n+"'"})}},XX={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},YX={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(e,t){return Tf(t)?t.number:Za(t)&&t.value==="bold"?700:400}},$X={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.filter(Za).map(function(r){return r.value})}},JX={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"oblique":return"oblique";case"italic":return"italic";default:return"normal"}}},Ks=function(e,t){return(e&t)!==0},ZX={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(t.length===0)return[];var r=t[0];return r.type===20&&r.value==="none"?[]:t}},eY={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return null;var r=t[0];if(r.type===20&&r.value==="none")return null;for(var a=[],n=t.filter(rF),s=0;s<n.length;s++){var l=n[s],A=n[s+1];if(l.type===20){var u=A&&Tf(A)?A.number:1;a.push({counter:l.value,increment:u})}}return a}},tY={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return[];for(var r=[],a=t.filter(rF),n=0;n<a.length;n++){var s=a[n],l=a[n+1];if(Za(s)&&s.value!=="none"){var A=l&&Tf(l)?l.number:0;r.push({counter:s.value,reset:A})}}return r}},rY={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(e,t){return t.filter(zp).map(function(r){return bF.parse(e,r)})}},aY={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return null;var r=t[0];if(r.type===20&&r.value==="none")return null;var a=[],n=t.filter(NW);if(n.length%2!==0)return null;for(var s=0;s<n.length;s+=2){var l=n[s].value,A=n[s+1].value;a.push({open:l,close:A})}return a}},vk=function(e,t,r){if(!e)return"";var a=e[Math.min(t,e.length-1)];return a?r?a.open:a.close:""},nY={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.length===1&&Qw(t[0],"none")?[]:sc(t).map(function(r){for(var a={color:255,offsetX:yi,offsetY:yi,blur:yi,spread:yi,inset:!1},n=0,s=0;s<r.length;s++){var l=r[s];Qw(l,"inset")?a.inset=!0:Xu(l)?(n===0?a.offsetX=l:n===1?a.offsetY=l:n===2?a.blur=l:a.spread=l,n++):a.color=Hu.parse(e,l)}return a})}},sY={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(e,t){var r=[0,1,2],a=[];return t.filter(Za).forEach(function(n){switch(n.value){case"stroke":a.push(1);break;case"fill":a.push(0);break;case"markers":a.push(2);break}}),r.forEach(function(n){a.indexOf(n)===-1&&a.push(n)}),a}},iY={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},lY={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(e,t){return zp(t)?t.number:0}},oY=(function(){function e(t,r){var a,n;this.animationDuration=rr(t,rY,r.animationDuration),this.backgroundClip=rr(t,LW,r.backgroundClip),this.backgroundColor=rr(t,UW,r.backgroundColor),this.backgroundImage=rr(t,KW,r.backgroundImage),this.backgroundOrigin=rr(t,qW,r.backgroundOrigin),this.backgroundPosition=rr(t,zW,r.backgroundPosition),this.backgroundRepeat=rr(t,VW,r.backgroundRepeat),this.backgroundSize=rr(t,WW,r.backgroundSize),this.borderTopColor=rr(t,YW,r.borderTopColor),this.borderRightColor=rr(t,$W,r.borderRightColor),this.borderBottomColor=rr(t,JW,r.borderBottomColor),this.borderLeftColor=rr(t,ZW,r.borderLeftColor),this.borderTopLeftRadius=rr(t,eX,r.borderTopLeftRadius),this.borderTopRightRadius=rr(t,tX,r.borderTopRightRadius),this.borderBottomRightRadius=rr(t,rX,r.borderBottomRightRadius),this.borderBottomLeftRadius=rr(t,aX,r.borderBottomLeftRadius),this.borderTopStyle=rr(t,nX,r.borderTopStyle),this.borderRightStyle=rr(t,sX,r.borderRightStyle),this.borderBottomStyle=rr(t,iX,r.borderBottomStyle),this.borderLeftStyle=rr(t,lX,r.borderLeftStyle),this.borderTopWidth=rr(t,oX,r.borderTopWidth),this.borderRightWidth=rr(t,AX,r.borderRightWidth),this.borderBottomWidth=rr(t,cX,r.borderBottomWidth),this.borderLeftWidth=rr(t,uX,r.borderLeftWidth),this.boxShadow=rr(t,nY,r.boxShadow),this.color=rr(t,dX,r.color),this.direction=rr(t,fX,r.direction),this.display=rr(t,hX,r.display),this.float=rr(t,gX,r.cssFloat),this.fontFamily=rr(t,WX,r.fontFamily),this.fontSize=rr(t,XX,r.fontSize),this.fontStyle=rr(t,JX,r.fontStyle),this.fontVariant=rr(t,$X,r.fontVariant),this.fontWeight=rr(t,YX,r.fontWeight),this.letterSpacing=rr(t,mX,r.letterSpacing),this.lineBreak=rr(t,xX,r.lineBreak),this.lineHeight=rr(t,bX,r.lineHeight),this.listStyleImage=rr(t,vX,r.listStyleImage),this.listStylePosition=rr(t,wX,r.listStylePosition),this.listStyleType=rr(t,Ow,r.listStyleType),this.marginTop=rr(t,yX,r.marginTop),this.marginRight=rr(t,_X,r.marginRight),this.marginBottom=rr(t,BX,r.marginBottom),this.marginLeft=rr(t,kX,r.marginLeft),this.opacity=rr(t,zX,r.opacity);var s=rr(t,CX,r.overflow);this.overflowX=s[0],this.overflowY=s[s.length>1?1:0],this.overflowWrap=rr(t,SX,r.overflowWrap),this.paddingTop=rr(t,EX,r.paddingTop),this.paddingRight=rr(t,NX,r.paddingRight),this.paddingBottom=rr(t,FX,r.paddingBottom),this.paddingLeft=rr(t,TX,r.paddingLeft),this.paintOrder=rr(t,sY,r.paintOrder),this.position=rr(t,UX,r.position),this.textAlign=rr(t,LX,r.textAlign),this.textDecorationColor=rr(t,VX,(a=r.textDecorationColor)!==null&&a!==void 0?a:r.color),this.textDecorationLine=rr(t,GX,(n=r.textDecorationLine)!==null&&n!==void 0?n:r.textDecoration),this.textShadow=rr(t,jX,r.textShadow),this.textTransform=rr(t,DX,r.textTransform),this.transform=rr(t,IX,r.transform),this.transformOrigin=rr(t,HX,r.transformOrigin),this.visibility=rr(t,PX,r.visibility),this.webkitTextStrokeColor=rr(t,iY,r.webkitTextStrokeColor),this.webkitTextStrokeWidth=rr(t,lY,r.webkitTextStrokeWidth),this.wordBreak=rr(t,KX,r.wordBreak),this.zIndex=rr(t,qX,r.zIndex)}return e.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},e.prototype.isTransparent=function(){return Pu(this.backgroundColor)},e.prototype.isTransformed=function(){return this.transform!==null},e.prototype.isPositioned=function(){return this.position!==0},e.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},e.prototype.isFloating=function(){return this.float!==0},e.prototype.isInlineLevel=function(){return Ks(this.display,4)||Ks(this.display,33554432)||Ks(this.display,268435456)||Ks(this.display,536870912)||Ks(this.display,67108864)||Ks(this.display,134217728)},e})(),AY=(function(){function e(t,r){this.content=rr(t,ZX,r.content),this.quotes=rr(t,aY,r.quotes)}return e})(),wk=(function(){function e(t,r){this.counterIncrement=rr(t,eY,r.counterIncrement),this.counterReset=rr(t,tY,r.counterReset)}return e})(),rr=function(e,t,r){var a=new eF,n=r!==null&&typeof r<"u"?r.toString():t.initialValue;a.write(n);var s=new tF(a.read());switch(t.type){case 2:var l=s.parseComponentValue();return t.parse(e,Za(l)?l.value:t.initialValue);case 0:return t.parse(e,s.parseComponentValue());case 1:return t.parse(e,s.parseComponentValues());case 4:return s.parseComponentValue();case 3:switch(t.format){case"angle":return r1.parse(e,s.parseComponentValue());case"color":return Hu.parse(e,s.parseComponentValue());case"image":return my.parse(e,s.parseComponentValue());case"length":var A=s.parseComponentValue();return Xu(A)?A:yi;case"length-percentage":var u=s.parseComponentValue();return Ts(u)?u:yi;case"time":return bF.parse(e,s.parseComponentValue())}break}},cY="data-html2canvas-debug",uY=function(e){var t=e.getAttribute(cY);switch(t){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},Rw=function(e,t){var r=uY(e);return r===1||t===r},ic=(function(){function e(t,r){if(this.context=t,this.textNodes=[],this.elements=[],this.flags=0,Rw(r,3))debugger;this.styles=new oY(t,window.getComputedStyle(r,null)),Pw(r)&&(this.styles.animationDuration.some(function(a){return a>0})&&(r.style.animationDuration="0s"),this.styles.transform!==null&&(r.style.transform="none")),this.bounds=e1(this.context,r),Rw(r,4)&&(this.flags|=16)}return e})(),dY="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",yk="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Rh=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var wm=0;wm<yk.length;wm++)Rh[yk.charCodeAt(wm)]=wm;var fY=function(e){var t=e.length*.75,r=e.length,a,n=0,s,l,A,u;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var f=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),h=Array.isArray(f)?f:new Uint8Array(f);for(a=0;a<r;a+=4)s=Rh[e.charCodeAt(a)],l=Rh[e.charCodeAt(a+1)],A=Rh[e.charCodeAt(a+2)],u=Rh[e.charCodeAt(a+3)],h[n++]=s<<2|l>>4,h[n++]=(l&15)<<4|A>>2,h[n++]=(A&3)<<6|u&63;return f},hY=function(e){for(var t=e.length,r=[],a=0;a<t;a+=2)r.push(e[a+1]<<8|e[a]);return r},pY=function(e){for(var t=e.length,r=[],a=0;a<t;a+=4)r.push(e[a+3]<<24|e[a+2]<<16|e[a+1]<<8|e[a]);return r},j0=5,xy=11,dv=2,gY=xy-j0,vF=65536>>j0,mY=1<<j0,fv=mY-1,xY=1024>>j0,bY=vF+xY,vY=bY,wY=32,yY=vY+wY,_Y=65536>>xy,BY=1<<gY,kY=BY-1,_k=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},CY=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},SY=function(e,t){var r=fY(e),a=Array.isArray(r)?pY(r):new Uint32Array(r),n=Array.isArray(r)?hY(r):new Uint16Array(r),s=24,l=_k(n,s/2,a[4]/2),A=a[5]===2?_k(n,(s+a[4])/2):CY(a,Math.ceil((s+a[4])/4));return new EY(a[0],a[1],a[2],a[3],l,A)},EY=(function(){function e(t,r,a,n,s,l){this.initialValue=t,this.errorValue=r,this.highStart=a,this.highValueIndex=n,this.index=s,this.data=l}return e.prototype.get=function(t){var r;if(t>=0){if(t<55296||t>56319&&t<=65535)return r=this.index[t>>j0],r=(r<<dv)+(t&fv),this.data[r];if(t<=65535)return r=this.index[vF+(t-55296>>j0)],r=(r<<dv)+(t&fv),this.data[r];if(t<this.highStart)return r=yY-_Y+(t>>xy),r=this.index[r],r+=t>>j0&kY,r=this.index[r],r=(r<<dv)+(t&fv),this.data[r];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e})(),Bk="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",NY=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var ym=0;ym<Bk.length;ym++)NY[Bk.charCodeAt(ym)]=ym;var FY=1,hv=2,pv=3,kk=4,Ck=5,TY=7,Sk=8,gv=9,mv=10,Ek=11,Nk=12,Fk=13,Tk=14,xv=15,LY=function(e){for(var t=[],r=0,a=e.length;r<a;){var n=e.charCodeAt(r++);if(n>=55296&&n<=56319&&r<a){var s=e.charCodeAt(r++);(s&64512)===56320?t.push(((n&1023)<<10)+(s&1023)+65536):(t.push(n),r--)}else t.push(n)}return t},UY=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var a=[],n=-1,s="";++n<r;){var l=e[n];l<=65535?a.push(l):(l-=65536,a.push((l>>10)+55296,l%1024+56320)),(n+1===r||a.length>16384)&&(s+=String.fromCharCode.apply(String,a),a.length=0)}return s},jY=SY(dY),Fo="",bv="",DY=function(e){return jY.get(e)},IY=function(e,t,r){var a=r-2,n=t[a],s=t[r-1],l=t[r];if(s===hv&&l===pv)return Fo;if(s===hv||s===pv||s===kk||l===hv||l===pv||l===kk)return bv;if(s===Sk&&[Sk,gv,Ek,Nk].indexOf(l)!==-1||(s===Ek||s===gv)&&(l===gv||l===mv)||(s===Nk||s===mv)&&l===mv||l===Fk||l===Ck||l===TY||s===FY)return Fo;if(s===Fk&&l===Tk){for(;n===Ck;)n=t[--a];if(n===Tk)return Fo}if(s===xv&&l===xv){for(var A=0;n===xv;)A++,n=t[--a];if(A%2===0)return Fo}return bv},QY=function(e){var t=LY(e),r=t.length,a=0,n=0,s=t.map(DY);return{next:function(){if(a>=r)return{done:!0,value:null};for(var l=Fo;a<r&&(l=IY(t,s,++a))===Fo;);if(l!==Fo||a===r){var A=UY.apply(null,t.slice(n,a));return n=a,{value:A,done:!1}}return{done:!0,value:null}}}},OY=function(e){for(var t=QY(e),r=[],a;!(a=t.next()).done;)a.value&&r.push(a.value.slice());return r},RY=function(e){var t=123;if(e.createRange){var r=e.createRange();if(r.getBoundingClientRect){var a=e.createElement("boundtest");a.style.height=t+"px",a.style.display="block",e.body.appendChild(a),r.selectNode(a);var n=r.getBoundingClientRect(),s=Math.round(n.height);if(e.body.removeChild(a),s===t)return!0}}return!1},MY=function(e){var t=e.createElement("boundtest");t.style.width="50px",t.style.display="block",t.style.fontSize="12px",t.style.letterSpacing="0px",t.style.wordSpacing="0px",e.body.appendChild(t);var r=e.createRange();t.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var a=t.firstChild,n=t1(a.data).map(function(u){return us(u)}),s=0,l={},A=n.every(function(u,f){r.setStart(a,s),r.setEnd(a,s+u.length);var h=r.getBoundingClientRect();s+=u.length;var g=h.x>l.x||h.y>l.y;return l=h,f===0?!0:g});return e.body.removeChild(t),A},HY=function(){return typeof new Image().crossOrigin<"u"},PY=function(){return typeof new XMLHttpRequest().responseType=="string"},KY=function(e){var t=new Image,r=e.createElement("canvas"),a=r.getContext("2d");if(!a)return!1;t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{a.drawImage(t,0,0),r.toDataURL()}catch{return!1}return!0},Lk=function(e){return e[0]===0&&e[1]===255&&e[2]===0&&e[3]===255},qY=function(e){var t=e.createElement("canvas"),r=100;t.width=r,t.height=r;var a=t.getContext("2d");if(!a)return Promise.reject(!1);a.fillStyle="rgb(0, 255, 0)",a.fillRect(0,0,r,r);var n=new Image,s=t.toDataURL();n.src=s;var l=Mw(r,r,0,0,n);return a.fillStyle="red",a.fillRect(0,0,r,r),Uk(l).then(function(A){a.drawImage(A,0,0);var u=a.getImageData(0,0,r,r).data;a.fillStyle="red",a.fillRect(0,0,r,r);var f=e.createElement("div");return f.style.backgroundImage="url("+s+")",f.style.height=r+"px",Lk(u)?Uk(Mw(r,r,0,0,f)):Promise.reject(!1)}).then(function(A){return a.drawImage(A,0,0),Lk(a.getImageData(0,0,r,r).data)}).catch(function(){return!1})},Mw=function(e,t,r,a,n){var s="http://www.w3.org/2000/svg",l=document.createElementNS(s,"svg"),A=document.createElementNS(s,"foreignObject");return l.setAttributeNS(null,"width",e.toString()),l.setAttributeNS(null,"height",t.toString()),A.setAttributeNS(null,"width","100%"),A.setAttributeNS(null,"height","100%"),A.setAttributeNS(null,"x",r.toString()),A.setAttributeNS(null,"y",a.toString()),A.setAttributeNS(null,"externalResourcesRequired","true"),l.appendChild(A),A.appendChild(n),l},Uk=function(e){return new Promise(function(t,r){var a=new Image;a.onload=function(){return t(a)},a.onerror=r,a.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(e))})},bi={get SUPPORT_RANGE_BOUNDS(){var e=RY(document);return Object.defineProperty(bi,"SUPPORT_RANGE_BOUNDS",{value:e}),e},get SUPPORT_WORD_BREAKING(){var e=bi.SUPPORT_RANGE_BOUNDS&&MY(document);return Object.defineProperty(bi,"SUPPORT_WORD_BREAKING",{value:e}),e},get SUPPORT_SVG_DRAWING(){var e=KY(document);return Object.defineProperty(bi,"SUPPORT_SVG_DRAWING",{value:e}),e},get SUPPORT_FOREIGNOBJECT_DRAWING(){var e=typeof Array.from=="function"&&typeof window.fetch=="function"?qY(document):Promise.resolve(!1);return Object.defineProperty(bi,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:e}),e},get SUPPORT_CORS_IMAGES(){var e=HY();return Object.defineProperty(bi,"SUPPORT_CORS_IMAGES",{value:e}),e},get SUPPORT_RESPONSE_TYPE(){var e=PY();return Object.defineProperty(bi,"SUPPORT_RESPONSE_TYPE",{value:e}),e},get SUPPORT_CORS_XHR(){var e="withCredentials"in new XMLHttpRequest;return Object.defineProperty(bi,"SUPPORT_CORS_XHR",{value:e}),e},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var e=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(bi,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:e}),e}},ap=(function(){function e(t,r){this.text=t,this.bounds=r}return e})(),zY=function(e,t,r,a){var n=WY(t,r),s=[],l=0;return n.forEach(function(A){if(r.textDecorationLine.length||A.trim().length>0)if(bi.SUPPORT_RANGE_BOUNDS){var u=jk(a,l,A.length).getClientRects();if(u.length>1){var f=by(A),h=0;f.forEach(function(x){s.push(new ap(x,Vc.fromDOMRectList(e,jk(a,h+l,x.length).getClientRects()))),h+=x.length})}else s.push(new ap(A,Vc.fromDOMRectList(e,u)))}else{var g=a.splitText(A.length);s.push(new ap(A,VY(e,a))),a=g}else bi.SUPPORT_RANGE_BOUNDS||(a=a.splitText(A.length));l+=A.length}),s},VY=function(e,t){var r=t.ownerDocument;if(r){var a=r.createElement("html2canvaswrapper");a.appendChild(t.cloneNode(!0));var n=t.parentNode;if(n){n.replaceChild(a,t);var s=e1(e,a);return a.firstChild&&n.replaceChild(a.firstChild,a),s}}return Vc.EMPTY},jk=function(e,t,r){var a=e.ownerDocument;if(!a)throw new Error("Node has no owner document");var n=a.createRange();return n.setStart(e,t),n.setEnd(e,t+r),n},by=function(e){if(bi.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(t.segment(e)).map(function(r){return r.segment})}return OY(e)},GY=function(e,t){if(bi.SUPPORT_NATIVE_TEXT_SEGMENTATION){var r=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(r.segment(e)).map(function(a){return a.segment})}return YY(e,t)},WY=function(e,t){return t.letterSpacing!==0?by(e):GY(e,t)},XY=[32,160,4961,65792,65793,4153,4241],YY=function(e,t){for(var r=_G(e,{lineBreak:t.lineBreak,wordBreak:t.overflowWrap==="break-word"?"break-word":t.wordBreak}),a=[],n,s=function(){if(n.value){var l=n.value.slice(),A=t1(l),u="";A.forEach(function(f){XY.indexOf(f)===-1?u+=us(f):(u.length&&a.push(u),a.push(us(f)),u="")}),u.length&&a.push(u)}};!(n=r.next()).done;)s();return a},$Y=(function(){function e(t,r,a){this.text=JY(r.data,a.textTransform),this.textBounds=zY(t,this.text,a,r)}return e})(),JY=function(e,t){switch(t){case 1:return e.toLowerCase();case 3:return e.replace(ZY,e$);case 2:return e.toUpperCase();default:return e}},ZY=/(^|\s|:|-|\(|\))([a-z])/g,e$=function(e,t,r){return e.length>0?t+r.toUpperCase():e},wF=(function(e){hA(t,e);function t(r,a){var n=e.call(this,r,a)||this;return n.src=a.currentSrc||a.src,n.intrinsicWidth=a.naturalWidth,n.intrinsicHeight=a.naturalHeight,n.context.cache.addImage(n.src),n}return t})(ic),yF=(function(e){hA(t,e);function t(r,a){var n=e.call(this,r,a)||this;return n.canvas=a,n.intrinsicWidth=a.width,n.intrinsicHeight=a.height,n}return t})(ic),_F=(function(e){hA(t,e);function t(r,a){var n=e.call(this,r,a)||this,s=new XMLSerializer,l=e1(r,a);return a.setAttribute("width",l.width+"px"),a.setAttribute("height",l.height+"px"),n.svg="data:image/svg+xml,"+encodeURIComponent(s.serializeToString(a)),n.intrinsicWidth=a.width.baseVal.value,n.intrinsicHeight=a.height.baseVal.value,n.context.cache.addImage(n.svg),n}return t})(ic),BF=(function(e){hA(t,e);function t(r,a){var n=e.call(this,r,a)||this;return n.value=a.value,n}return t})(ic),Hw=(function(e){hA(t,e);function t(r,a){var n=e.call(this,r,a)||this;return n.start=a.start,n.reversed=typeof a.reversed=="boolean"&&a.reversed===!0,n}return t})(ic),t$=[{type:15,flags:0,unit:"px",number:3}],r$=[{type:16,flags:0,number:50}],a$=function(e){return e.width>e.height?new Vc(e.left+(e.width-e.height)/2,e.top,e.height,e.height):e.width<e.height?new Vc(e.left,e.top+(e.height-e.width)/2,e.width,e.width):e},n$=function(e){var t=e.type===s$?new Array(e.value.length+1).join(""):e.value;return t.length===0?e.placeholder||"":t},Cx="checkbox",Sx="radio",s$="password",Dk=707406591,vy=(function(e){hA(t,e);function t(r,a){var n=e.call(this,r,a)||this;switch(n.type=a.type.toLowerCase(),n.checked=a.checked,n.value=n$(a),(n.type===Cx||n.type===Sx)&&(n.styles.backgroundColor=3739148031,n.styles.borderTopColor=n.styles.borderRightColor=n.styles.borderBottomColor=n.styles.borderLeftColor=2779096575,n.styles.borderTopWidth=n.styles.borderRightWidth=n.styles.borderBottomWidth=n.styles.borderLeftWidth=1,n.styles.borderTopStyle=n.styles.borderRightStyle=n.styles.borderBottomStyle=n.styles.borderLeftStyle=1,n.styles.backgroundClip=[0],n.styles.backgroundOrigin=[0],n.bounds=a$(n.bounds)),n.type){case Cx:n.styles.borderTopRightRadius=n.styles.borderTopLeftRadius=n.styles.borderBottomRightRadius=n.styles.borderBottomLeftRadius=t$;break;case Sx:n.styles.borderTopRightRadius=n.styles.borderTopLeftRadius=n.styles.borderBottomRightRadius=n.styles.borderBottomLeftRadius=r$;break}return n}return t})(ic),kF=(function(e){hA(t,e);function t(r,a){var n=e.call(this,r,a)||this,s=a.options[a.selectedIndex||0];return n.value=s&&s.text||"",n}return t})(ic),CF=(function(e){hA(t,e);function t(r,a){var n=e.call(this,r,a)||this;return n.value=a.value,n}return t})(ic),SF=(function(e){hA(t,e);function t(r,a){var n=e.call(this,r,a)||this;n.src=a.src,n.width=parseInt(a.width,10)||0,n.height=parseInt(a.height,10)||0,n.backgroundColor=n.styles.backgroundColor;try{if(a.contentWindow&&a.contentWindow.document&&a.contentWindow.document.documentElement){n.tree=NF(r,a.contentWindow.document.documentElement);var s=a.contentWindow.document.documentElement?tp(r,getComputedStyle(a.contentWindow.document.documentElement).backgroundColor):Kc.TRANSPARENT,l=a.contentWindow.document.body?tp(r,getComputedStyle(a.contentWindow.document.body).backgroundColor):Kc.TRANSPARENT;n.backgroundColor=Pu(s)?Pu(l)?n.styles.backgroundColor:l:s}}catch{}return n}return t})(ic),i$=["OL","UL","MENU"],Mm=function(e,t,r,a){for(var n=t.firstChild,s=void 0;n;n=s)if(s=n.nextSibling,FF(n)&&n.data.trim().length>0)r.textNodes.push(new $Y(e,n,r.styles));else if(rf(n))if(jF(n)&&n.assignedNodes)n.assignedNodes().forEach(function(A){return Mm(e,A,r,a)});else{var l=EF(e,n);l.styles.isVisible()&&(l$(n,l,a)?l.flags|=4:o$(l.styles)&&(l.flags|=2),i$.indexOf(n.tagName)!==-1&&(l.flags|=8),r.elements.push(l),n.slot,n.shadowRoot?Mm(e,n.shadowRoot,l,a):!Ex(n)&&!TF(n)&&!Nx(n)&&Mm(e,n,l,a))}},EF=function(e,t){return Kw(t)?new wF(e,t):LF(t)?new yF(e,t):TF(t)?new _F(e,t):A$(t)?new BF(e,t):c$(t)?new Hw(e,t):u$(t)?new vy(e,t):Nx(t)?new kF(e,t):Ex(t)?new CF(e,t):UF(t)?new SF(e,t):new ic(e,t)},NF=function(e,t){var r=EF(e,t);return r.flags|=4,Mm(e,t,r,r),r},l$=function(e,t,r){return t.styles.isPositionedWithZIndex()||t.styles.opacity<1||t.styles.isTransformed()||wy(e)&&r.styles.isTransparent()},o$=function(e){return e.isPositioned()||e.isFloating()},FF=function(e){return e.nodeType===Node.TEXT_NODE},rf=function(e){return e.nodeType===Node.ELEMENT_NODE},Pw=function(e){return rf(e)&&typeof e.style<"u"&&!Hm(e)},Hm=function(e){return typeof e.className=="object"},A$=function(e){return e.tagName==="LI"},c$=function(e){return e.tagName==="OL"},u$=function(e){return e.tagName==="INPUT"},d$=function(e){return e.tagName==="HTML"},TF=function(e){return e.tagName==="svg"},wy=function(e){return e.tagName==="BODY"},LF=function(e){return e.tagName==="CANVAS"},Ik=function(e){return e.tagName==="VIDEO"},Kw=function(e){return e.tagName==="IMG"},UF=function(e){return e.tagName==="IFRAME"},Qk=function(e){return e.tagName==="STYLE"},f$=function(e){return e.tagName==="SCRIPT"},Ex=function(e){return e.tagName==="TEXTAREA"},Nx=function(e){return e.tagName==="SELECT"},jF=function(e){return e.tagName==="SLOT"},Ok=function(e){return e.tagName.indexOf("-")>0},h$=(function(){function e(){this.counters={}}return e.prototype.getCounterValue=function(t){var r=this.counters[t];return r&&r.length?r[r.length-1]:1},e.prototype.getCounterValues=function(t){var r=this.counters[t];return r||[]},e.prototype.pop=function(t){var r=this;t.forEach(function(a){return r.counters[a].pop()})},e.prototype.parse=function(t){var r=this,a=t.counterIncrement,n=t.counterReset,s=!0;a!==null&&a.forEach(function(A){var u=r.counters[A.counter];u&&A.increment!==0&&(s=!1,u.length||u.push(1),u[Math.max(0,u.length-1)]+=A.increment)});var l=[];return s&&n.forEach(function(A){var u=r.counters[A.counter];l.push(A.counter),u||(u=r.counters[A.counter]=[]),u.push(A.reset)}),l},e})(),Rk={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},Mk={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},p$={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},g$={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Hd=function(e,t,r,a,n,s){return e<t||e>r?Ep(e,n,s.length>0):a.integers.reduce(function(l,A,u){for(;e>=A;)e-=A,l+=a.values[u];return l},"")+s},DF=function(e,t,r,a){var n="";do r||e--,n=a(e)+n,e/=t;while(e*t>=t);return n},As=function(e,t,r,a,n){var s=r-t+1;return(e<0?"-":"")+(DF(Math.abs(e),s,a,function(l){return us(Math.floor(l%s)+t)})+n)},b0=function(e,t,r){r===void 0&&(r=". ");var a=t.length;return DF(Math.abs(e),a,!1,function(n){return t[Math.floor(n%a)]})+r},Xd=1,ku=2,Cu=4,Mh=8,Uc=function(e,t,r,a,n,s){if(e<-9999||e>9999)return Ep(e,4,n.length>0);var l=Math.abs(e),A=n;if(l===0)return t[0]+A;for(var u=0;l>0&&u<=4;u++){var f=l%10;f===0&&Ks(s,Xd)&&A!==""?A=t[f]+A:f>1||f===1&&u===0||f===1&&u===1&&Ks(s,ku)||f===1&&u===1&&Ks(s,Cu)&&e>100||f===1&&u>1&&Ks(s,Mh)?A=t[f]+(u>0?r[u-1]:"")+A:f===1&&u>0&&(A=r[u-1]+A),l=Math.floor(l/10)}return(e<0?a:"")+A},Hk="",Pk="",Kk="",vv="",Ep=function(e,t,r){var a=r?". ":"",n=r?"":"",s=r?", ":"",l=r?" ":"";switch(t){case 0:return""+l;case 1:return""+l;case 2:return""+l;case 5:var A=As(e,48,57,!0,a);return A.length<4?"0"+A:A;case 4:return b0(e,"",n);case 6:return Hd(e,1,3999,Rk,3,a).toLowerCase();case 7:return Hd(e,1,3999,Rk,3,a);case 8:return As(e,945,969,!1,a);case 9:return As(e,97,122,!1,a);case 10:return As(e,65,90,!1,a);case 11:return As(e,1632,1641,!0,a);case 12:case 49:return Hd(e,1,9999,Mk,3,a);case 35:return Hd(e,1,9999,Mk,3,a).toLowerCase();case 13:return As(e,2534,2543,!0,a);case 14:case 30:return As(e,6112,6121,!0,a);case 15:return b0(e,"",n);case 16:return b0(e,"",n);case 17:case 48:return Uc(e,"",Hk,"",n,ku|Cu|Mh);case 47:return Uc(e,"",Pk,"",n,Xd|ku|Cu|Mh);case 42:return Uc(e,"",Hk,"",n,ku|Cu|Mh);case 41:return Uc(e,"",Pk,"",n,Xd|ku|Cu|Mh);case 26:return Uc(e,"","",Kk,n,0);case 25:return Uc(e,"","",Kk,n,Xd|ku|Cu);case 31:return Uc(e,"","",vv,s,Xd|ku|Cu);case 33:return Uc(e,"","",vv,s,0);case 32:return Uc(e,"","",vv,s,Xd|ku|Cu);case 18:return As(e,2406,2415,!0,a);case 20:return Hd(e,1,19999,g$,3,a);case 21:return As(e,2790,2799,!0,a);case 22:return As(e,2662,2671,!0,a);case 22:return Hd(e,1,10999,p$,3,a);case 23:return b0(e,"");case 24:return b0(e,"");case 27:return As(e,3302,3311,!0,a);case 28:return b0(e,"",n);case 29:return b0(e,"",n);case 34:return As(e,3792,3801,!0,a);case 37:return As(e,6160,6169,!0,a);case 38:return As(e,4160,4169,!0,a);case 39:return As(e,2918,2927,!0,a);case 40:return As(e,1776,1785,!0,a);case 43:return As(e,3046,3055,!0,a);case 44:return As(e,3174,3183,!0,a);case 45:return As(e,3664,3673,!0,a);case 46:return As(e,3872,3881,!0,a);default:return As(e,48,57,!0,a)}},IF="data-html2canvas-ignore",qk=(function(){function e(t,r,a){if(this.context=t,this.options=a,this.scrolledElements=[],this.referenceElement=r,this.counters=new h$,this.quoteDepth=0,!r.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(r.ownerDocument.documentElement,!1)}return e.prototype.toIFrame=function(t,r){var a=this,n=m$(t,r);if(!n.contentWindow)return Promise.reject("Unable to find iframe window");var s=t.defaultView.pageXOffset,l=t.defaultView.pageYOffset,A=n.contentWindow,u=A.document,f=v$(n).then(function(){return tl(a,void 0,void 0,function(){var h,g;return Ri(this,function(x){switch(x.label){case 0:return this.scrolledElements.forEach(B$),A&&(A.scrollTo(r.left,r.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(A.scrollY!==r.top||A.scrollX!==r.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(A.scrollX-r.left,A.scrollY-r.top,0,0))),h=this.options.onclone,g=this.clonedReferenceElement,typeof g>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:u.fonts&&u.fonts.ready?[4,u.fonts.ready]:[3,2];case 1:x.sent(),x.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,b$(u)]:[3,4];case 3:x.sent(),x.label=4;case 4:return typeof h=="function"?[2,Promise.resolve().then(function(){return h(u,g)}).then(function(){return n})]:[2,n]}})})});return u.open(),u.write(y$(document.doctype)+"<html></html>"),_$(this.referenceElement.ownerDocument,s,l),u.replaceChild(u.adoptNode(this.documentElement),u.documentElement),u.close(),f},e.prototype.createElementClone=function(t){if(Rw(t,2))debugger;if(LF(t))return this.createCanvasClone(t);if(Ik(t))return this.createVideoClone(t);if(Qk(t))return this.createStyleClone(t);var r=t.cloneNode(!1);return Kw(r)&&(Kw(t)&&t.currentSrc&&t.currentSrc!==t.src&&(r.src=t.currentSrc,r.srcset=""),r.loading==="lazy"&&(r.loading="eager")),Ok(r)?this.createCustomElementClone(r):r},e.prototype.createCustomElementClone=function(t){var r=document.createElement("html2canvascustomelement");return wv(t.style,r),r},e.prototype.createStyleClone=function(t){try{var r=t.sheet;if(r&&r.cssRules){var a=[].slice.call(r.cssRules,0).reduce(function(s,l){return l&&typeof l.cssText=="string"?s+l.cssText:s},""),n=t.cloneNode(!1);return n.textContent=a,n}}catch(s){if(this.context.logger.error("Unable to access cssRules property",s),s.name!=="SecurityError")throw s}return t.cloneNode(!1)},e.prototype.createCanvasClone=function(t){var r;if(this.options.inlineImages&&t.ownerDocument){var a=t.ownerDocument.createElement("img");try{return a.src=t.toDataURL(),a}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",t)}}var n=t.cloneNode(!1);try{n.width=t.width,n.height=t.height;var s=t.getContext("2d"),l=n.getContext("2d");if(l)if(!this.options.allowTaint&&s)l.putImageData(s.getImageData(0,0,t.width,t.height),0,0);else{var A=(r=t.getContext("webgl2"))!==null&&r!==void 0?r:t.getContext("webgl");if(A){var u=A.getContextAttributes();u?.preserveDrawingBuffer===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",t)}l.drawImage(t,0,0)}return n}catch{this.context.logger.info("Unable to clone canvas as it is tainted",t)}return n},e.prototype.createVideoClone=function(t){var r=t.ownerDocument.createElement("canvas");r.width=t.offsetWidth,r.height=t.offsetHeight;var a=r.getContext("2d");try{return a&&(a.drawImage(t,0,0,r.width,r.height),this.options.allowTaint||a.getImageData(0,0,r.width,r.height)),r}catch{this.context.logger.info("Unable to clone video as it is tainted",t)}var n=t.ownerDocument.createElement("canvas");return n.width=t.offsetWidth,n.height=t.offsetHeight,n},e.prototype.appendChildNode=function(t,r,a){(!rf(r)||!f$(r)&&!r.hasAttribute(IF)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(r)))&&(!this.options.copyStyles||!rf(r)||!Qk(r))&&t.appendChild(this.cloneNode(r,a))},e.prototype.cloneChildNodes=function(t,r,a){for(var n=this,s=t.shadowRoot?t.shadowRoot.firstChild:t.firstChild;s;s=s.nextSibling)if(rf(s)&&jF(s)&&typeof s.assignedNodes=="function"){var l=s.assignedNodes();l.length&&l.forEach(function(A){return n.appendChildNode(r,A,a)})}else this.appendChildNode(r,s,a)},e.prototype.cloneNode=function(t,r){if(FF(t))return document.createTextNode(t.data);if(!t.ownerDocument)return t.cloneNode(!1);var a=t.ownerDocument.defaultView;if(a&&rf(t)&&(Pw(t)||Hm(t))){var n=this.createElementClone(t);n.style.transitionProperty="none";var s=a.getComputedStyle(t),l=a.getComputedStyle(t,":before"),A=a.getComputedStyle(t,":after");this.referenceElement===t&&Pw(n)&&(this.clonedReferenceElement=n),wy(n)&&S$(n);var u=this.counters.parse(new wk(this.context,s)),f=this.resolvePseudoContent(t,n,l,np.BEFORE);Ok(t)&&(r=!0),Ik(t)||this.cloneChildNodes(t,n,r),f&&n.insertBefore(f,n.firstChild);var h=this.resolvePseudoContent(t,n,A,np.AFTER);return h&&n.appendChild(h),this.counters.pop(u),(s&&(this.options.copyStyles||Hm(t))&&!UF(t)||r)&&wv(s,n),(t.scrollTop!==0||t.scrollLeft!==0)&&this.scrolledElements.push([n,t.scrollLeft,t.scrollTop]),(Ex(t)||Nx(t))&&(Ex(n)||Nx(n))&&(n.value=t.value),n}return t.cloneNode(!1)},e.prototype.resolvePseudoContent=function(t,r,a,n){var s=this;if(a){var l=a.content,A=r.ownerDocument;if(!(!A||!l||l==="none"||l==="-moz-alt-content"||a.display==="none")){this.counters.parse(new wk(this.context,a));var u=new AY(this.context,a),f=A.createElement("html2canvaspseudoelement");wv(a,f),u.content.forEach(function(g){if(g.type===0)f.appendChild(A.createTextNode(g.value));else if(g.type===22){var x=A.createElement("img");x.src=g.value,x.style.opacity="1",f.appendChild(x)}else if(g.type===18){if(g.name==="attr"){var m=g.values.filter(Za);m.length&&f.appendChild(A.createTextNode(t.getAttribute(m[0].value)||""))}else if(g.name==="counter"){var w=g.values.filter(_f),v=w[0],B=w[1];if(v&&Za(v)){var k=s.counters.getCounterValue(v.value),N=B&&Za(B)?Ow.parse(s.context,B.value):3;f.appendChild(A.createTextNode(Ep(k,N,!1)))}}else if(g.name==="counters"){var S=g.values.filter(_f),v=S[0],O=S[1],B=S[2];if(v&&Za(v)){var T=s.counters.getCounterValues(v.value),U=B&&Za(B)?Ow.parse(s.context,B.value):3,D=O&&O.type===0?O.value:"",H=T.map(function(I){return Ep(I,U,!1)}).join(D);f.appendChild(A.createTextNode(H))}}}else if(g.type===20)switch(g.value){case"open-quote":f.appendChild(A.createTextNode(vk(u.quotes,s.quoteDepth++,!0)));break;case"close-quote":f.appendChild(A.createTextNode(vk(u.quotes,--s.quoteDepth,!1)));break;default:f.appendChild(A.createTextNode(g.value))}}),f.className=qw+" "+zw;var h=n===np.BEFORE?" "+qw:" "+zw;return Hm(r)?r.className.baseValue+=h:r.className+=h,f}}},e.destroy=function(t){return t.parentNode?(t.parentNode.removeChild(t),!0):!1},e})(),np;(function(e){e[e.BEFORE=0]="BEFORE",e[e.AFTER=1]="AFTER"})(np||(np={}));var m$=function(e,t){var r=e.createElement("iframe");return r.className="html2canvas-container",r.style.visibility="hidden",r.style.position="fixed",r.style.left="-10000px",r.style.top="0px",r.style.border="0",r.width=t.width.toString(),r.height=t.height.toString(),r.scrolling="no",r.setAttribute(IF,"true"),e.body.appendChild(r),r},x$=function(e){return new Promise(function(t){if(e.complete){t();return}if(!e.src){t();return}e.onload=t,e.onerror=t})},b$=function(e){return Promise.all([].slice.call(e.images,0).map(x$))},v$=function(e){return new Promise(function(t,r){var a=e.contentWindow;if(!a)return r("No window assigned for iframe");var n=a.document;a.onload=e.onload=function(){a.onload=e.onload=null;var s=setInterval(function(){n.body.childNodes.length>0&&n.readyState==="complete"&&(clearInterval(s),t(e))},50)}})},w$=["all","d","content"],wv=function(e,t){for(var r=e.length-1;r>=0;r--){var a=e.item(r);w$.indexOf(a)===-1&&t.style.setProperty(a,e.getPropertyValue(a))}return t},y$=function(e){var t="";return e&&(t+="<!DOCTYPE ",e.name&&(t+=e.name),e.internalSubset&&(t+=e.internalSubset),e.publicId&&(t+='"'+e.publicId+'"'),e.systemId&&(t+='"'+e.systemId+'"'),t+=">"),t},_$=function(e,t,r){e&&e.defaultView&&(t!==e.defaultView.pageXOffset||r!==e.defaultView.pageYOffset)&&e.defaultView.scrollTo(t,r)},B$=function(e){var t=e[0],r=e[1],a=e[2];t.scrollLeft=r,t.scrollTop=a},k$=":before",C$=":after",qw="___html2canvas___pseudoelement_before",zw="___html2canvas___pseudoelement_after",zk=`{
    content: "" !important;
    display: none !important;
}`,S$=function(e){E$(e,"."+qw+k$+zk+`
         .`+zw+C$+zk)},E$=function(e,t){var r=e.ownerDocument;if(r){var a=r.createElement("style");a.textContent=t,e.appendChild(a)}},QF=(function(){function e(){}return e.getOrigin=function(t){var r=e._link;return r?(r.href=t,r.href=r.href,r.protocol+r.hostname+r.port):"about:blank"},e.isSameOrigin=function(t){return e.getOrigin(t)===e._origin},e.setContext=function(t){e._link=t.document.createElement("a"),e._origin=e.getOrigin(t.location.href)},e._origin="about:blank",e})(),N$=(function(){function e(t,r){this.context=t,this._options=r,this._cache={}}return e.prototype.addImage=function(t){var r=Promise.resolve();return this.has(t)||(_v(t)||U$(t))&&(this._cache[t]=this.loadImage(t)).catch(function(){}),r},e.prototype.match=function(t){return this._cache[t]},e.prototype.loadImage=function(t){return tl(this,void 0,void 0,function(){var r,a,n,s,l=this;return Ri(this,function(A){switch(A.label){case 0:return r=QF.isSameOrigin(t),a=!yv(t)&&this._options.useCORS===!0&&bi.SUPPORT_CORS_IMAGES&&!r,n=!yv(t)&&!r&&!_v(t)&&typeof this._options.proxy=="string"&&bi.SUPPORT_CORS_XHR&&!a,!r&&this._options.allowTaint===!1&&!yv(t)&&!_v(t)&&!n&&!a?[2]:(s=t,n?[4,this.proxy(s)]:[3,2]);case 1:s=A.sent(),A.label=2;case 2:return this.context.logger.debug("Added image "+t.substring(0,256)),[4,new Promise(function(u,f){var h=new Image;h.onload=function(){return u(h)},h.onerror=f,(j$(s)||a)&&(h.crossOrigin="anonymous"),h.src=s,h.complete===!0&&setTimeout(function(){return u(h)},500),l._options.imageTimeout>0&&setTimeout(function(){return f("Timed out ("+l._options.imageTimeout+"ms) loading image")},l._options.imageTimeout)})];case 3:return[2,A.sent()]}})})},e.prototype.has=function(t){return typeof this._cache[t]<"u"},e.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},e.prototype.proxy=function(t){var r=this,a=this._options.proxy;if(!a)throw new Error("No proxy defined");var n=t.substring(0,256);return new Promise(function(s,l){var A=bi.SUPPORT_RESPONSE_TYPE?"blob":"text",u=new XMLHttpRequest;u.onload=function(){if(u.status===200)if(A==="text")s(u.response);else{var g=new FileReader;g.addEventListener("load",function(){return s(g.result)},!1),g.addEventListener("error",function(x){return l(x)},!1),g.readAsDataURL(u.response)}else l("Failed to proxy resource "+n+" with status code "+u.status)},u.onerror=l;var f=a.indexOf("?")>-1?"&":"?";if(u.open("GET",""+a+f+"url="+encodeURIComponent(t)+"&responseType="+A),A!=="text"&&u instanceof XMLHttpRequest&&(u.responseType=A),r._options.imageTimeout){var h=r._options.imageTimeout;u.timeout=h,u.ontimeout=function(){return l("Timed out ("+h+"ms) proxying "+n)}}u.send()})},e})(),F$=/^data:image\/svg\+xml/i,T$=/^data:image\/.*;base64,/i,L$=/^data:image\/.*/i,U$=function(e){return bi.SUPPORT_SVG_DRAWING||!D$(e)},yv=function(e){return L$.test(e)},j$=function(e){return T$.test(e)},_v=function(e){return e.substr(0,4)==="blob"},D$=function(e){return e.substr(-3).toLowerCase()==="svg"||F$.test(e)},Yt=(function(){function e(t,r){this.type=0,this.x=t,this.y=r}return e.prototype.add=function(t,r){return new e(this.x+t,this.y+r)},e})(),Pd=function(e,t,r){return new Yt(e.x+(t.x-e.x)*r,e.y+(t.y-e.y)*r)},_m=(function(){function e(t,r,a,n){this.type=1,this.start=t,this.startControl=r,this.endControl=a,this.end=n}return e.prototype.subdivide=function(t,r){var a=Pd(this.start,this.startControl,t),n=Pd(this.startControl,this.endControl,t),s=Pd(this.endControl,this.end,t),l=Pd(a,n,t),A=Pd(n,s,t),u=Pd(l,A,t);return r?new e(this.start,a,l,u):new e(u,A,s,this.end)},e.prototype.add=function(t,r){return new e(this.start.add(t,r),this.startControl.add(t,r),this.endControl.add(t,r),this.end.add(t,r))},e.prototype.reverse=function(){return new e(this.end,this.endControl,this.startControl,this.start)},e})(),Uo=function(e){return e.type===1},I$=(function(){function e(t){var r=t.styles,a=t.bounds,n=Oh(r.borderTopLeftRadius,a.width,a.height),s=n[0],l=n[1],A=Oh(r.borderTopRightRadius,a.width,a.height),u=A[0],f=A[1],h=Oh(r.borderBottomRightRadius,a.width,a.height),g=h[0],x=h[1],m=Oh(r.borderBottomLeftRadius,a.width,a.height),w=m[0],v=m[1],B=[];B.push((s+u)/a.width),B.push((w+g)/a.width),B.push((l+v)/a.height),B.push((f+x)/a.height);var k=Math.max.apply(Math,B);k>1&&(s/=k,l/=k,u/=k,f/=k,g/=k,x/=k,w/=k,v/=k);var N=a.width-u,S=a.height-x,O=a.width-g,T=a.height-v,U=r.borderTopWidth,D=r.borderRightWidth,H=r.borderBottomWidth,j=r.borderLeftWidth,W=fn(r.paddingTop,t.bounds.width),I=fn(r.paddingRight,t.bounds.width),Q=fn(r.paddingBottom,t.bounds.width),Y=fn(r.paddingLeft,t.bounds.width);this.topLeftBorderDoubleOuterBox=s>0||l>0?Ln(a.left+j/3,a.top+U/3,s-j/3,l-U/3,Oa.TOP_LEFT):new Yt(a.left+j/3,a.top+U/3),this.topRightBorderDoubleOuterBox=s>0||l>0?Ln(a.left+N,a.top+U/3,u-D/3,f-U/3,Oa.TOP_RIGHT):new Yt(a.left+a.width-D/3,a.top+U/3),this.bottomRightBorderDoubleOuterBox=g>0||x>0?Ln(a.left+O,a.top+S,g-D/3,x-H/3,Oa.BOTTOM_RIGHT):new Yt(a.left+a.width-D/3,a.top+a.height-H/3),this.bottomLeftBorderDoubleOuterBox=w>0||v>0?Ln(a.left+j/3,a.top+T,w-j/3,v-H/3,Oa.BOTTOM_LEFT):new Yt(a.left+j/3,a.top+a.height-H/3),this.topLeftBorderDoubleInnerBox=s>0||l>0?Ln(a.left+j*2/3,a.top+U*2/3,s-j*2/3,l-U*2/3,Oa.TOP_LEFT):new Yt(a.left+j*2/3,a.top+U*2/3),this.topRightBorderDoubleInnerBox=s>0||l>0?Ln(a.left+N,a.top+U*2/3,u-D*2/3,f-U*2/3,Oa.TOP_RIGHT):new Yt(a.left+a.width-D*2/3,a.top+U*2/3),this.bottomRightBorderDoubleInnerBox=g>0||x>0?Ln(a.left+O,a.top+S,g-D*2/3,x-H*2/3,Oa.BOTTOM_RIGHT):new Yt(a.left+a.width-D*2/3,a.top+a.height-H*2/3),this.bottomLeftBorderDoubleInnerBox=w>0||v>0?Ln(a.left+j*2/3,a.top+T,w-j*2/3,v-H*2/3,Oa.BOTTOM_LEFT):new Yt(a.left+j*2/3,a.top+a.height-H*2/3),this.topLeftBorderStroke=s>0||l>0?Ln(a.left+j/2,a.top+U/2,s-j/2,l-U/2,Oa.TOP_LEFT):new Yt(a.left+j/2,a.top+U/2),this.topRightBorderStroke=s>0||l>0?Ln(a.left+N,a.top+U/2,u-D/2,f-U/2,Oa.TOP_RIGHT):new Yt(a.left+a.width-D/2,a.top+U/2),this.bottomRightBorderStroke=g>0||x>0?Ln(a.left+O,a.top+S,g-D/2,x-H/2,Oa.BOTTOM_RIGHT):new Yt(a.left+a.width-D/2,a.top+a.height-H/2),this.bottomLeftBorderStroke=w>0||v>0?Ln(a.left+j/2,a.top+T,w-j/2,v-H/2,Oa.BOTTOM_LEFT):new Yt(a.left+j/2,a.top+a.height-H/2),this.topLeftBorderBox=s>0||l>0?Ln(a.left,a.top,s,l,Oa.TOP_LEFT):new Yt(a.left,a.top),this.topRightBorderBox=u>0||f>0?Ln(a.left+N,a.top,u,f,Oa.TOP_RIGHT):new Yt(a.left+a.width,a.top),this.bottomRightBorderBox=g>0||x>0?Ln(a.left+O,a.top+S,g,x,Oa.BOTTOM_RIGHT):new Yt(a.left+a.width,a.top+a.height),this.bottomLeftBorderBox=w>0||v>0?Ln(a.left,a.top+T,w,v,Oa.BOTTOM_LEFT):new Yt(a.left,a.top+a.height),this.topLeftPaddingBox=s>0||l>0?Ln(a.left+j,a.top+U,Math.max(0,s-j),Math.max(0,l-U),Oa.TOP_LEFT):new Yt(a.left+j,a.top+U),this.topRightPaddingBox=u>0||f>0?Ln(a.left+Math.min(N,a.width-D),a.top+U,N>a.width+D?0:Math.max(0,u-D),Math.max(0,f-U),Oa.TOP_RIGHT):new Yt(a.left+a.width-D,a.top+U),this.bottomRightPaddingBox=g>0||x>0?Ln(a.left+Math.min(O,a.width-j),a.top+Math.min(S,a.height-H),Math.max(0,g-D),Math.max(0,x-H),Oa.BOTTOM_RIGHT):new Yt(a.left+a.width-D,a.top+a.height-H),this.bottomLeftPaddingBox=w>0||v>0?Ln(a.left+j,a.top+Math.min(T,a.height-H),Math.max(0,w-j),Math.max(0,v-H),Oa.BOTTOM_LEFT):new Yt(a.left+j,a.top+a.height-H),this.topLeftContentBox=s>0||l>0?Ln(a.left+j+Y,a.top+U+W,Math.max(0,s-(j+Y)),Math.max(0,l-(U+W)),Oa.TOP_LEFT):new Yt(a.left+j+Y,a.top+U+W),this.topRightContentBox=u>0||f>0?Ln(a.left+Math.min(N,a.width+j+Y),a.top+U+W,N>a.width+j+Y?0:u-j+Y,f-(U+W),Oa.TOP_RIGHT):new Yt(a.left+a.width-(D+I),a.top+U+W),this.bottomRightContentBox=g>0||x>0?Ln(a.left+Math.min(O,a.width-(j+Y)),a.top+Math.min(S,a.height+U+W),Math.max(0,g-(D+I)),x-(H+Q),Oa.BOTTOM_RIGHT):new Yt(a.left+a.width-(D+I),a.top+a.height-(H+Q)),this.bottomLeftContentBox=w>0||v>0?Ln(a.left+j+Y,a.top+T,Math.max(0,w-(j+Y)),v-(H+Q),Oa.BOTTOM_LEFT):new Yt(a.left+j+Y,a.top+a.height-(H+Q))}return e})(),Oa;(function(e){e[e.TOP_LEFT=0]="TOP_LEFT",e[e.TOP_RIGHT=1]="TOP_RIGHT",e[e.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",e[e.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(Oa||(Oa={}));var Ln=function(e,t,r,a,n){var s=4*((Math.sqrt(2)-1)/3),l=r*s,A=a*s,u=e+r,f=t+a;switch(n){case Oa.TOP_LEFT:return new _m(new Yt(e,f),new Yt(e,f-A),new Yt(u-l,t),new Yt(u,t));case Oa.TOP_RIGHT:return new _m(new Yt(e,t),new Yt(e+l,t),new Yt(u,f-A),new Yt(u,f));case Oa.BOTTOM_RIGHT:return new _m(new Yt(u,t),new Yt(u,t+A),new Yt(e+l,f),new Yt(e,f));case Oa.BOTTOM_LEFT:default:return new _m(new Yt(u,f),new Yt(u-l,f),new Yt(e,t+A),new Yt(e,t))}},Fx=function(e){return[e.topLeftBorderBox,e.topRightBorderBox,e.bottomRightBorderBox,e.bottomLeftBorderBox]},Q$=function(e){return[e.topLeftContentBox,e.topRightContentBox,e.bottomRightContentBox,e.bottomLeftContentBox]},Tx=function(e){return[e.topLeftPaddingBox,e.topRightPaddingBox,e.bottomRightPaddingBox,e.bottomLeftPaddingBox]},O$=(function(){function e(t,r,a){this.offsetX=t,this.offsetY=r,this.matrix=a,this.type=0,this.target=6}return e})(),Bm=(function(){function e(t,r){this.path=t,this.target=r,this.type=1}return e})(),R$=(function(){function e(t){this.opacity=t,this.type=2,this.target=6}return e})(),M$=function(e){return e.type===0},OF=function(e){return e.type===1},H$=function(e){return e.type===2},Vk=function(e,t){return e.length===t.length?e.some(function(r,a){return r===t[a]}):!1},P$=function(e,t,r,a,n){return e.map(function(s,l){switch(l){case 0:return s.add(t,r);case 1:return s.add(t+a,r);case 2:return s.add(t+a,r+n);case 3:return s.add(t,r+n)}return s})},RF=(function(){function e(t){this.element=t,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return e})(),MF=(function(){function e(t,r){if(this.container=t,this.parent=r,this.effects=[],this.curves=new I$(this.container),this.container.styles.opacity<1&&this.effects.push(new R$(this.container.styles.opacity)),this.container.styles.transform!==null){var a=this.container.bounds.left+this.container.styles.transformOrigin[0].number,n=this.container.bounds.top+this.container.styles.transformOrigin[1].number,s=this.container.styles.transform;this.effects.push(new O$(a,n,s))}if(this.container.styles.overflowX!==0){var l=Fx(this.curves),A=Tx(this.curves);Vk(l,A)?this.effects.push(new Bm(l,6)):(this.effects.push(new Bm(l,2)),this.effects.push(new Bm(A,4)))}}return e.prototype.getEffects=function(t){for(var r=[2,3].indexOf(this.container.styles.position)===-1,a=this.parent,n=this.effects.slice(0);a;){var s=a.effects.filter(function(u){return!OF(u)});if(r||a.container.styles.position!==0||!a.parent){if(n.unshift.apply(n,s),r=[2,3].indexOf(a.container.styles.position)===-1,a.container.styles.overflowX!==0){var l=Fx(a.curves),A=Tx(a.curves);Vk(l,A)||n.unshift(new Bm(A,6))}}else n.unshift.apply(n,s);a=a.parent}return n.filter(function(u){return Ks(u.target,t)})},e})(),Vw=function(e,t,r,a){e.container.elements.forEach(function(n){var s=Ks(n.flags,4),l=Ks(n.flags,2),A=new MF(n,e);Ks(n.styles.display,2048)&&a.push(A);var u=Ks(n.flags,8)?[]:a;if(s||l){var f=s||n.styles.isPositioned()?r:t,h=new RF(A);if(n.styles.isPositioned()||n.styles.opacity<1||n.styles.isTransformed()){var g=n.styles.zIndex.order;if(g<0){var x=0;f.negativeZIndex.some(function(w,v){return g>w.element.container.styles.zIndex.order?(x=v,!1):x>0}),f.negativeZIndex.splice(x,0,h)}else if(g>0){var m=0;f.positiveZIndex.some(function(w,v){return g>=w.element.container.styles.zIndex.order?(m=v+1,!1):m>0}),f.positiveZIndex.splice(m,0,h)}else f.zeroOrAutoZIndexOrTransformedOrOpacity.push(h)}else n.styles.isFloating()?f.nonPositionedFloats.push(h):f.nonPositionedInlineLevel.push(h);Vw(A,h,s?h:r,u)}else n.styles.isInlineLevel()?t.inlineLevel.push(A):t.nonInlineLevel.push(A),Vw(A,t,r,u);Ks(n.flags,8)&&HF(n,u)})},HF=function(e,t){for(var r=e instanceof Hw?e.start:1,a=e instanceof Hw?e.reversed:!1,n=0;n<t.length;n++){var s=t[n];s.container instanceof BF&&typeof s.container.value=="number"&&s.container.value!==0&&(r=s.container.value),s.listValue=Ep(r,s.container.styles.listStyleType,!0),r+=a?-1:1}},K$=function(e){var t=new MF(e,null),r=new RF(t),a=[];return Vw(t,r,r,a),HF(t.container,a),r},Gk=function(e,t){switch(t){case 0:return Do(e.topLeftBorderBox,e.topLeftPaddingBox,e.topRightBorderBox,e.topRightPaddingBox);case 1:return Do(e.topRightBorderBox,e.topRightPaddingBox,e.bottomRightBorderBox,e.bottomRightPaddingBox);case 2:return Do(e.bottomRightBorderBox,e.bottomRightPaddingBox,e.bottomLeftBorderBox,e.bottomLeftPaddingBox);default:return Do(e.bottomLeftBorderBox,e.bottomLeftPaddingBox,e.topLeftBorderBox,e.topLeftPaddingBox)}},q$=function(e,t){switch(t){case 0:return Do(e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox,e.topRightBorderBox,e.topRightBorderDoubleOuterBox);case 1:return Do(e.topRightBorderBox,e.topRightBorderDoubleOuterBox,e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox);case 2:return Do(e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox,e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox);default:return Do(e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox,e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox)}},z$=function(e,t){switch(t){case 0:return Do(e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox,e.topRightBorderDoubleInnerBox,e.topRightPaddingBox);case 1:return Do(e.topRightBorderDoubleInnerBox,e.topRightPaddingBox,e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox);case 2:return Do(e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox,e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox);default:return Do(e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox,e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox)}},V$=function(e,t){switch(t){case 0:return km(e.topLeftBorderStroke,e.topRightBorderStroke);case 1:return km(e.topRightBorderStroke,e.bottomRightBorderStroke);case 2:return km(e.bottomRightBorderStroke,e.bottomLeftBorderStroke);default:return km(e.bottomLeftBorderStroke,e.topLeftBorderStroke)}},km=function(e,t){var r=[];return Uo(e)?r.push(e.subdivide(.5,!1)):r.push(e),Uo(t)?r.push(t.subdivide(.5,!0)):r.push(t),r},Do=function(e,t,r,a){var n=[];return Uo(e)?n.push(e.subdivide(.5,!1)):n.push(e),Uo(r)?n.push(r.subdivide(.5,!0)):n.push(r),Uo(a)?n.push(a.subdivide(.5,!0).reverse()):n.push(a),Uo(t)?n.push(t.subdivide(.5,!1).reverse()):n.push(t),n},PF=function(e){var t=e.bounds,r=e.styles;return t.add(r.borderLeftWidth,r.borderTopWidth,-(r.borderRightWidth+r.borderLeftWidth),-(r.borderTopWidth+r.borderBottomWidth))},Lx=function(e){var t=e.styles,r=e.bounds,a=fn(t.paddingLeft,r.width),n=fn(t.paddingRight,r.width),s=fn(t.paddingTop,r.width),l=fn(t.paddingBottom,r.width);return r.add(a+t.borderLeftWidth,s+t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth+a+n),-(t.borderTopWidth+t.borderBottomWidth+s+l))},G$=function(e,t){return e===0?t.bounds:e===2?Lx(t):PF(t)},W$=function(e,t){return e===0?t.bounds:e===2?Lx(t):PF(t)},Bv=function(e,t,r){var a=G$(Yd(e.styles.backgroundOrigin,t),e),n=W$(Yd(e.styles.backgroundClip,t),e),s=X$(Yd(e.styles.backgroundSize,t),r,a),l=s[0],A=s[1],u=Oh(Yd(e.styles.backgroundPosition,t),a.width-l,a.height-A),f=Y$(Yd(e.styles.backgroundRepeat,t),u,s,a,n),h=Math.round(a.left+u[0]),g=Math.round(a.top+u[1]);return[f,h,g,l,A]},Kd=function(e){return Za(e)&&e.value===df.AUTO},Cm=function(e){return typeof e=="number"},X$=function(e,t,r){var a=t[0],n=t[1],s=t[2],l=e[0],A=e[1];if(!l)return[0,0];if(Ts(l)&&A&&Ts(A))return[fn(l,r.width),fn(A,r.height)];var u=Cm(s);if(Za(l)&&(l.value===df.CONTAIN||l.value===df.COVER)){if(Cm(s)){var f=r.width/r.height;return f<s!=(l.value===df.COVER)?[r.width,r.width/s]:[r.height*s,r.height]}return[r.width,r.height]}var h=Cm(a),g=Cm(n),x=h||g;if(Kd(l)&&(!A||Kd(A))){if(h&&g)return[a,n];if(!u&&!x)return[r.width,r.height];if(x&&u){var m=h?a:n*s,w=g?n:a/s;return[m,w]}var v=h?a:r.width,B=g?n:r.height;return[v,B]}if(u){var k=0,N=0;return Ts(l)?k=fn(l,r.width):Ts(A)&&(N=fn(A,r.height)),Kd(l)?k=N*s:(!A||Kd(A))&&(N=k/s),[k,N]}var S=null,O=null;if(Ts(l)?S=fn(l,r.width):A&&Ts(A)&&(O=fn(A,r.height)),S!==null&&(!A||Kd(A))&&(O=h&&g?S/a*n:r.height),O!==null&&Kd(l)&&(S=h&&g?O/n*a:r.width),S!==null&&O!==null)return[S,O];throw new Error("Unable to calculate background-size for element")},Yd=function(e,t){var r=e[t];return typeof r>"u"?e[0]:r},Y$=function(e,t,r,a,n){var s=t[0],l=t[1],A=r[0],u=r[1];switch(e){case 2:return[new Yt(Math.round(a.left),Math.round(a.top+l)),new Yt(Math.round(a.left+a.width),Math.round(a.top+l)),new Yt(Math.round(a.left+a.width),Math.round(u+a.top+l)),new Yt(Math.round(a.left),Math.round(u+a.top+l))];case 3:return[new Yt(Math.round(a.left+s),Math.round(a.top)),new Yt(Math.round(a.left+s+A),Math.round(a.top)),new Yt(Math.round(a.left+s+A),Math.round(a.height+a.top)),new Yt(Math.round(a.left+s),Math.round(a.height+a.top))];case 1:return[new Yt(Math.round(a.left+s),Math.round(a.top+l)),new Yt(Math.round(a.left+s+A),Math.round(a.top+l)),new Yt(Math.round(a.left+s+A),Math.round(a.top+l+u)),new Yt(Math.round(a.left+s),Math.round(a.top+l+u))];default:return[new Yt(Math.round(n.left),Math.round(n.top)),new Yt(Math.round(n.left+n.width),Math.round(n.top)),new Yt(Math.round(n.left+n.width),Math.round(n.height+n.top)),new Yt(Math.round(n.left),Math.round(n.height+n.top))]}},$$="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",Wk="Hidden Text",J$=(function(){function e(t){this._data={},this._document=t}return e.prototype.parseMetrics=function(t,r){var a=this._document.createElement("div"),n=this._document.createElement("img"),s=this._document.createElement("span"),l=this._document.body;a.style.visibility="hidden",a.style.fontFamily=t,a.style.fontSize=r,a.style.margin="0",a.style.padding="0",a.style.whiteSpace="nowrap",l.appendChild(a),n.src=$$,n.width=1,n.height=1,n.style.margin="0",n.style.padding="0",n.style.verticalAlign="baseline",s.style.fontFamily=t,s.style.fontSize=r,s.style.margin="0",s.style.padding="0",s.appendChild(this._document.createTextNode(Wk)),a.appendChild(s),a.appendChild(n);var A=n.offsetTop-s.offsetTop+2;a.removeChild(s),a.appendChild(this._document.createTextNode(Wk)),a.style.lineHeight="normal",n.style.verticalAlign="super";var u=n.offsetTop-a.offsetTop+2;return l.removeChild(a),{baseline:A,middle:u}},e.prototype.getMetrics=function(t,r){var a=t+" "+r;return typeof this._data[a]>"u"&&(this._data[a]=this.parseMetrics(t,r)),this._data[a]},e})(),KF=(function(){function e(t,r){this.context=t,this.options=r}return e})(),Z$=1e4,eJ=(function(e){hA(t,e);function t(r,a){var n=e.call(this,r,a)||this;return n._activeEffects=[],n.canvas=a.canvas?a.canvas:document.createElement("canvas"),n.ctx=n.canvas.getContext("2d"),a.canvas||(n.canvas.width=Math.floor(a.width*a.scale),n.canvas.height=Math.floor(a.height*a.scale),n.canvas.style.width=a.width+"px",n.canvas.style.height=a.height+"px"),n.fontMetrics=new J$(document),n.ctx.scale(n.options.scale,n.options.scale),n.ctx.translate(-a.x,-a.y),n.ctx.textBaseline="bottom",n._activeEffects=[],n.context.logger.debug("Canvas renderer initialized ("+a.width+"x"+a.height+") with scale "+a.scale),n}return t.prototype.applyEffects=function(r){for(var a=this;this._activeEffects.length;)this.popEffect();r.forEach(function(n){return a.applyEffect(n)})},t.prototype.applyEffect=function(r){this.ctx.save(),H$(r)&&(this.ctx.globalAlpha=r.opacity),M$(r)&&(this.ctx.translate(r.offsetX,r.offsetY),this.ctx.transform(r.matrix[0],r.matrix[1],r.matrix[2],r.matrix[3],r.matrix[4],r.matrix[5]),this.ctx.translate(-r.offsetX,-r.offsetY)),OF(r)&&(this.path(r.path),this.ctx.clip()),this._activeEffects.push(r)},t.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},t.prototype.renderStack=function(r){return tl(this,void 0,void 0,function(){var a;return Ri(this,function(n){switch(n.label){case 0:return a=r.element.container.styles,a.isVisible()?[4,this.renderStackContent(r)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})},t.prototype.renderNode=function(r){return tl(this,void 0,void 0,function(){return Ri(this,function(a){switch(a.label){case 0:if(Ks(r.container.flags,16))debugger;return r.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(r)]:[3,3];case 1:return a.sent(),[4,this.renderNodeContent(r)];case 2:a.sent(),a.label=3;case 3:return[2]}})})},t.prototype.renderTextWithLetterSpacing=function(r,a,n){var s=this;if(a===0)this.ctx.fillText(r.text,r.bounds.left,r.bounds.top+n);else{var l=by(r.text);l.reduce(function(A,u){return s.ctx.fillText(u,A,r.bounds.top+n),A+s.ctx.measureText(u).width},r.bounds.left)}},t.prototype.createFontStyle=function(r){var a=r.fontVariant.filter(function(l){return l==="normal"||l==="small-caps"}).join(""),n=sJ(r.fontFamily).join(", "),s=zp(r.fontSize)?""+r.fontSize.number+r.fontSize.unit:r.fontSize.number+"px";return[[r.fontStyle,a,r.fontWeight,s,n].join(" "),n,s]},t.prototype.renderTextNode=function(r,a){return tl(this,void 0,void 0,function(){var n,s,l,A,u,f,h,g,x=this;return Ri(this,function(m){return n=this.createFontStyle(a),s=n[0],l=n[1],A=n[2],this.ctx.font=s,this.ctx.direction=a.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",u=this.fontMetrics.getMetrics(l,A),f=u.baseline,h=u.middle,g=a.paintOrder,r.textBounds.forEach(function(w){g.forEach(function(v){switch(v){case 0:x.ctx.fillStyle=Js(a.color),x.renderTextWithLetterSpacing(w,a.letterSpacing,f);var B=a.textShadow;B.length&&w.text.trim().length&&(B.slice(0).reverse().forEach(function(k){x.ctx.shadowColor=Js(k.color),x.ctx.shadowOffsetX=k.offsetX.number*x.options.scale,x.ctx.shadowOffsetY=k.offsetY.number*x.options.scale,x.ctx.shadowBlur=k.blur.number,x.renderTextWithLetterSpacing(w,a.letterSpacing,f)}),x.ctx.shadowColor="",x.ctx.shadowOffsetX=0,x.ctx.shadowOffsetY=0,x.ctx.shadowBlur=0),a.textDecorationLine.length&&(x.ctx.fillStyle=Js(a.textDecorationColor||a.color),a.textDecorationLine.forEach(function(k){switch(k){case 1:x.ctx.fillRect(w.bounds.left,Math.round(w.bounds.top+f),w.bounds.width,1);break;case 2:x.ctx.fillRect(w.bounds.left,Math.round(w.bounds.top),w.bounds.width,1);break;case 3:x.ctx.fillRect(w.bounds.left,Math.ceil(w.bounds.top+h),w.bounds.width,1);break}}));break;case 1:a.webkitTextStrokeWidth&&w.text.trim().length&&(x.ctx.strokeStyle=Js(a.webkitTextStrokeColor),x.ctx.lineWidth=a.webkitTextStrokeWidth,x.ctx.lineJoin=window.chrome?"miter":"round",x.ctx.strokeText(w.text,w.bounds.left,w.bounds.top+f)),x.ctx.strokeStyle="",x.ctx.lineWidth=0,x.ctx.lineJoin="miter";break}})}),[2]})})},t.prototype.renderReplacedElement=function(r,a,n){if(n&&r.intrinsicWidth>0&&r.intrinsicHeight>0){var s=Lx(r),l=Tx(a);this.path(l),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(n,0,0,r.intrinsicWidth,r.intrinsicHeight,s.left,s.top,s.width,s.height),this.ctx.restore()}},t.prototype.renderNodeContent=function(r){return tl(this,void 0,void 0,function(){var a,n,s,l,A,u,N,N,f,h,g,x,O,m,w,T,v,B,k,N,S,O,T;return Ri(this,function(U){switch(U.label){case 0:this.applyEffects(r.getEffects(4)),a=r.container,n=r.curves,s=a.styles,l=0,A=a.textNodes,U.label=1;case 1:return l<A.length?(u=A[l],[4,this.renderTextNode(u,s)]):[3,4];case 2:U.sent(),U.label=3;case 3:return l++,[3,1];case 4:if(!(a instanceof wF))return[3,8];U.label=5;case 5:return U.trys.push([5,7,,8]),[4,this.context.cache.match(a.src)];case 6:return N=U.sent(),this.renderReplacedElement(a,n,N),[3,8];case 7:return U.sent(),this.context.logger.error("Error loading image "+a.src),[3,8];case 8:if(a instanceof yF&&this.renderReplacedElement(a,n,a.canvas),!(a instanceof _F))return[3,12];U.label=9;case 9:return U.trys.push([9,11,,12]),[4,this.context.cache.match(a.svg)];case 10:return N=U.sent(),this.renderReplacedElement(a,n,N),[3,12];case 11:return U.sent(),this.context.logger.error("Error loading svg "+a.svg.substring(0,255)),[3,12];case 12:return a instanceof SF&&a.tree?(f=new t(this.context,{scale:this.options.scale,backgroundColor:a.backgroundColor,x:0,y:0,width:a.width,height:a.height}),[4,f.render(a.tree)]):[3,14];case 13:h=U.sent(),a.width&&a.height&&this.ctx.drawImage(h,0,0,a.width,a.height,a.bounds.left,a.bounds.top,a.bounds.width,a.bounds.height),U.label=14;case 14:if(a instanceof vy&&(g=Math.min(a.bounds.width,a.bounds.height),a.type===Cx?a.checked&&(this.ctx.save(),this.path([new Yt(a.bounds.left+g*.39363,a.bounds.top+g*.79),new Yt(a.bounds.left+g*.16,a.bounds.top+g*.5549),new Yt(a.bounds.left+g*.27347,a.bounds.top+g*.44071),new Yt(a.bounds.left+g*.39694,a.bounds.top+g*.5649),new Yt(a.bounds.left+g*.72983,a.bounds.top+g*.23),new Yt(a.bounds.left+g*.84,a.bounds.top+g*.34085),new Yt(a.bounds.left+g*.39363,a.bounds.top+g*.79)]),this.ctx.fillStyle=Js(Dk),this.ctx.fill(),this.ctx.restore()):a.type===Sx&&a.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(a.bounds.left+g/2,a.bounds.top+g/2,g/4,0,Math.PI*2,!0),this.ctx.fillStyle=Js(Dk),this.ctx.fill(),this.ctx.restore())),tJ(a)&&a.value.length){switch(x=this.createFontStyle(s),O=x[0],m=x[1],w=this.fontMetrics.getMetrics(O,m).baseline,this.ctx.font=O,this.ctx.fillStyle=Js(s.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=aJ(a.styles.textAlign),T=Lx(a),v=0,a.styles.textAlign){case 1:v+=T.width/2;break;case 2:v+=T.width;break}B=T.add(v,0,0,-T.height/2+1),this.ctx.save(),this.path([new Yt(T.left,T.top),new Yt(T.left+T.width,T.top),new Yt(T.left+T.width,T.top+T.height),new Yt(T.left,T.top+T.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new ap(a.value,B),s.letterSpacing,w),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!Ks(a.styles.display,2048))return[3,20];if(a.styles.listStyleImage===null)return[3,19];if(k=a.styles.listStyleImage,k.type!==0)return[3,18];N=void 0,S=k.url,U.label=15;case 15:return U.trys.push([15,17,,18]),[4,this.context.cache.match(S)];case 16:return N=U.sent(),this.ctx.drawImage(N,a.bounds.left-(N.width+10),a.bounds.top),[3,18];case 17:return U.sent(),this.context.logger.error("Error loading list-style-image "+S),[3,18];case 18:return[3,20];case 19:r.listValue&&a.styles.listStyleType!==-1&&(O=this.createFontStyle(s)[0],this.ctx.font=O,this.ctx.fillStyle=Js(s.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",T=new Vc(a.bounds.left,a.bounds.top+fn(a.styles.paddingTop,a.bounds.width),a.bounds.width,xk(s.lineHeight,s.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new ap(r.listValue,T),s.letterSpacing,xk(s.lineHeight,s.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),U.label=20;case 20:return[2]}})})},t.prototype.renderStackContent=function(r){return tl(this,void 0,void 0,function(){var a,n,k,s,l,k,A,u,k,f,h,k,g,x,k,m,w,k,v,B,k;return Ri(this,function(N){switch(N.label){case 0:if(Ks(r.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(r.element)];case 1:N.sent(),a=0,n=r.negativeZIndex,N.label=2;case 2:return a<n.length?(k=n[a],[4,this.renderStack(k)]):[3,5];case 3:N.sent(),N.label=4;case 4:return a++,[3,2];case 5:return[4,this.renderNodeContent(r.element)];case 6:N.sent(),s=0,l=r.nonInlineLevel,N.label=7;case 7:return s<l.length?(k=l[s],[4,this.renderNode(k)]):[3,10];case 8:N.sent(),N.label=9;case 9:return s++,[3,7];case 10:A=0,u=r.nonPositionedFloats,N.label=11;case 11:return A<u.length?(k=u[A],[4,this.renderStack(k)]):[3,14];case 12:N.sent(),N.label=13;case 13:return A++,[3,11];case 14:f=0,h=r.nonPositionedInlineLevel,N.label=15;case 15:return f<h.length?(k=h[f],[4,this.renderStack(k)]):[3,18];case 16:N.sent(),N.label=17;case 17:return f++,[3,15];case 18:g=0,x=r.inlineLevel,N.label=19;case 19:return g<x.length?(k=x[g],[4,this.renderNode(k)]):[3,22];case 20:N.sent(),N.label=21;case 21:return g++,[3,19];case 22:m=0,w=r.zeroOrAutoZIndexOrTransformedOrOpacity,N.label=23;case 23:return m<w.length?(k=w[m],[4,this.renderStack(k)]):[3,26];case 24:N.sent(),N.label=25;case 25:return m++,[3,23];case 26:v=0,B=r.positiveZIndex,N.label=27;case 27:return v<B.length?(k=B[v],[4,this.renderStack(k)]):[3,30];case 28:N.sent(),N.label=29;case 29:return v++,[3,27];case 30:return[2]}})})},t.prototype.mask=function(r){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(r.slice(0).reverse()),this.ctx.closePath()},t.prototype.path=function(r){this.ctx.beginPath(),this.formatPath(r),this.ctx.closePath()},t.prototype.formatPath=function(r){var a=this;r.forEach(function(n,s){var l=Uo(n)?n.start:n;s===0?a.ctx.moveTo(l.x,l.y):a.ctx.lineTo(l.x,l.y),Uo(n)&&a.ctx.bezierCurveTo(n.startControl.x,n.startControl.y,n.endControl.x,n.endControl.y,n.end.x,n.end.y)})},t.prototype.renderRepeat=function(r,a,n,s){this.path(r),this.ctx.fillStyle=a,this.ctx.translate(n,s),this.ctx.fill(),this.ctx.translate(-n,-s)},t.prototype.resizeImage=function(r,a,n){var s;if(r.width===a&&r.height===n)return r;var l=(s=this.canvas.ownerDocument)!==null&&s!==void 0?s:document,A=l.createElement("canvas");A.width=Math.max(1,a),A.height=Math.max(1,n);var u=A.getContext("2d");return u.drawImage(r,0,0,r.width,r.height,0,0,a,n),A},t.prototype.renderBackgroundImage=function(r){return tl(this,void 0,void 0,function(){var a,n,s,l,A,u;return Ri(this,function(f){switch(f.label){case 0:a=r.styles.backgroundImage.length-1,n=function(h){var g,x,m,W,Z,Ae,Y,z,H,w,W,Z,Ae,Y,z,v,B,k,N,S,O,T,U,D,H,j,W,I,Q,Y,z,ue,Z,Ae,ve,G,Se,we,F,R,M,P;return Ri(this,function(re){switch(re.label){case 0:if(h.type!==0)return[3,5];g=void 0,x=h.url,re.label=1;case 1:return re.trys.push([1,3,,4]),[4,s.context.cache.match(x)];case 2:return g=re.sent(),[3,4];case 3:return re.sent(),s.context.logger.error("Error loading background-image "+x),[3,4];case 4:return g&&(m=Bv(r,a,[g.width,g.height,g.width/g.height]),W=m[0],Z=m[1],Ae=m[2],Y=m[3],z=m[4],H=s.ctx.createPattern(s.resizeImage(g,Y,z),"repeat"),s.renderRepeat(W,H,Z,Ae)),[3,6];case 5:MW(h)?(w=Bv(r,a,[null,null,null]),W=w[0],Z=w[1],Ae=w[2],Y=w[3],z=w[4],v=DW(h.angle,Y,z),B=v[0],k=v[1],N=v[2],S=v[3],O=v[4],T=document.createElement("canvas"),T.width=Y,T.height=z,U=T.getContext("2d"),D=U.createLinearGradient(k,S,N,O),gk(h.stops,B).forEach(function(ge){return D.addColorStop(ge.stop,Js(ge.color))}),U.fillStyle=D,U.fillRect(0,0,Y,z),Y>0&&z>0&&(H=s.ctx.createPattern(T,"repeat"),s.renderRepeat(W,H,Z,Ae))):HW(h)&&(j=Bv(r,a,[null,null,null]),W=j[0],I=j[1],Q=j[2],Y=j[3],z=j[4],ue=h.position.length===0?[gy]:h.position,Z=fn(ue[0],Y),Ae=fn(ue[ue.length-1],z),ve=IW(h,Z,Ae,Y,z),G=ve[0],Se=ve[1],G>0&&Se>0&&(we=s.ctx.createRadialGradient(I+Z,Q+Ae,0,I+Z,Q+Ae,G),gk(h.stops,G*2).forEach(function(ge){return we.addColorStop(ge.stop,Js(ge.color))}),s.path(W),s.ctx.fillStyle=we,G!==Se?(F=r.bounds.left+.5*r.bounds.width,R=r.bounds.top+.5*r.bounds.height,M=Se/G,P=1/M,s.ctx.save(),s.ctx.translate(F,R),s.ctx.transform(1,0,0,M,0,0),s.ctx.translate(-F,-R),s.ctx.fillRect(I,P*(Q-R)+R,Y,z*P),s.ctx.restore()):s.ctx.fill())),re.label=6;case 6:return a--,[2]}})},s=this,l=0,A=r.styles.backgroundImage.slice(0).reverse(),f.label=1;case 1:return l<A.length?(u=A[l],[5,n(u)]):[3,4];case 2:f.sent(),f.label=3;case 3:return l++,[3,1];case 4:return[2]}})})},t.prototype.renderSolidBorder=function(r,a,n){return tl(this,void 0,void 0,function(){return Ri(this,function(s){return this.path(Gk(n,a)),this.ctx.fillStyle=Js(r),this.ctx.fill(),[2]})})},t.prototype.renderDoubleBorder=function(r,a,n,s){return tl(this,void 0,void 0,function(){var l,A;return Ri(this,function(u){switch(u.label){case 0:return a<3?[4,this.renderSolidBorder(r,n,s)]:[3,2];case 1:return u.sent(),[2];case 2:return l=q$(s,n),this.path(l),this.ctx.fillStyle=Js(r),this.ctx.fill(),A=z$(s,n),this.path(A),this.ctx.fill(),[2]}})})},t.prototype.renderNodeBackgroundAndBorders=function(r){return tl(this,void 0,void 0,function(){var a,n,s,l,A,u,f,h,g=this;return Ri(this,function(x){switch(x.label){case 0:return this.applyEffects(r.getEffects(2)),a=r.container.styles,n=!Pu(a.backgroundColor)||a.backgroundImage.length,s=[{style:a.borderTopStyle,color:a.borderTopColor,width:a.borderTopWidth},{style:a.borderRightStyle,color:a.borderRightColor,width:a.borderRightWidth},{style:a.borderBottomStyle,color:a.borderBottomColor,width:a.borderBottomWidth},{style:a.borderLeftStyle,color:a.borderLeftColor,width:a.borderLeftWidth}],l=rJ(Yd(a.backgroundClip,0),r.curves),n||a.boxShadow.length?(this.ctx.save(),this.path(l),this.ctx.clip(),Pu(a.backgroundColor)||(this.ctx.fillStyle=Js(a.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(r.container)]):[3,2];case 1:x.sent(),this.ctx.restore(),a.boxShadow.slice(0).reverse().forEach(function(m){g.ctx.save();var w=Fx(r.curves),v=m.inset?0:Z$,B=P$(w,-v+(m.inset?1:-1)*m.spread.number,(m.inset?1:-1)*m.spread.number,m.spread.number*(m.inset?-2:2),m.spread.number*(m.inset?-2:2));m.inset?(g.path(w),g.ctx.clip(),g.mask(B)):(g.mask(w),g.ctx.clip(),g.path(B)),g.ctx.shadowOffsetX=m.offsetX.number+v,g.ctx.shadowOffsetY=m.offsetY.number,g.ctx.shadowColor=Js(m.color),g.ctx.shadowBlur=m.blur.number,g.ctx.fillStyle=m.inset?Js(m.color):"rgba(0,0,0,1)",g.ctx.fill(),g.ctx.restore()}),x.label=2;case 2:A=0,u=0,f=s,x.label=3;case 3:return u<f.length?(h=f[u],h.style!==0&&!Pu(h.color)&&h.width>0?h.style!==2?[3,5]:[4,this.renderDashedDottedBorder(h.color,h.width,A,r.curves,2)]:[3,11]):[3,13];case 4:return x.sent(),[3,11];case 5:return h.style!==3?[3,7]:[4,this.renderDashedDottedBorder(h.color,h.width,A,r.curves,3)];case 6:return x.sent(),[3,11];case 7:return h.style!==4?[3,9]:[4,this.renderDoubleBorder(h.color,h.width,A,r.curves)];case 8:return x.sent(),[3,11];case 9:return[4,this.renderSolidBorder(h.color,A,r.curves)];case 10:x.sent(),x.label=11;case 11:A++,x.label=12;case 12:return u++,[3,3];case 13:return[2]}})})},t.prototype.renderDashedDottedBorder=function(r,a,n,s,l){return tl(this,void 0,void 0,function(){var A,u,f,h,g,x,m,w,v,B,k,N,S,O,T,U,T,U;return Ri(this,function(D){return this.ctx.save(),A=V$(s,n),u=Gk(s,n),l===2&&(this.path(u),this.ctx.clip()),Uo(u[0])?(f=u[0].start.x,h=u[0].start.y):(f=u[0].x,h=u[0].y),Uo(u[1])?(g=u[1].end.x,x=u[1].end.y):(g=u[1].x,x=u[1].y),n===0||n===2?m=Math.abs(f-g):m=Math.abs(h-x),this.ctx.beginPath(),l===3?this.formatPath(A):this.formatPath(u.slice(0,2)),w=a<3?a*3:a*2,v=a<3?a*2:a,l===3&&(w=a,v=a),B=!0,m<=w*2?B=!1:m<=w*2+v?(k=m/(2*w+v),w*=k,v*=k):(N=Math.floor((m+v)/(w+v)),S=(m-N*w)/(N-1),O=(m-(N+1)*w)/N,v=O<=0||Math.abs(v-S)<Math.abs(v-O)?S:O),B&&(l===3?this.ctx.setLineDash([0,w+v]):this.ctx.setLineDash([w,v])),l===3?(this.ctx.lineCap="round",this.ctx.lineWidth=a):this.ctx.lineWidth=a*2+1.1,this.ctx.strokeStyle=Js(r),this.ctx.stroke(),this.ctx.setLineDash([]),l===2&&(Uo(u[0])&&(T=u[3],U=u[0],this.ctx.beginPath(),this.formatPath([new Yt(T.end.x,T.end.y),new Yt(U.start.x,U.start.y)]),this.ctx.stroke()),Uo(u[1])&&(T=u[1],U=u[2],this.ctx.beginPath(),this.formatPath([new Yt(T.end.x,T.end.y),new Yt(U.start.x,U.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},t.prototype.render=function(r){return tl(this,void 0,void 0,function(){var a;return Ri(this,function(n){switch(n.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=Js(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),a=K$(r),[4,this.renderStack(a)];case 1:return n.sent(),this.applyEffects([]),[2,this.canvas]}})})},t})(KF),tJ=function(e){return e instanceof CF||e instanceof kF?!0:e instanceof vy&&e.type!==Sx&&e.type!==Cx},rJ=function(e,t){switch(e){case 0:return Fx(t);case 2:return Q$(t);default:return Tx(t)}},aJ=function(e){switch(e){case 1:return"center";case 2:return"right";default:return"left"}},nJ=["-apple-system","system-ui"],sJ=function(e){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?e.filter(function(t){return nJ.indexOf(t)===-1}):e},iJ=(function(e){hA(t,e);function t(r,a){var n=e.call(this,r,a)||this;return n.canvas=a.canvas?a.canvas:document.createElement("canvas"),n.ctx=n.canvas.getContext("2d"),n.options=a,n.canvas.width=Math.floor(a.width*a.scale),n.canvas.height=Math.floor(a.height*a.scale),n.canvas.style.width=a.width+"px",n.canvas.style.height=a.height+"px",n.ctx.scale(n.options.scale,n.options.scale),n.ctx.translate(-a.x,-a.y),n.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+a.width+"x"+a.height+" at "+a.x+","+a.y+") with scale "+a.scale),n}return t.prototype.render=function(r){return tl(this,void 0,void 0,function(){var a,n;return Ri(this,function(s){switch(s.label){case 0:return a=Mw(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,r),[4,lJ(a)];case 1:return n=s.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=Js(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(n,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},t})(KF),lJ=function(e){return new Promise(function(t,r){var a=new Image;a.onload=function(){t(a)},a.onerror=r,a.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(e))})},oJ=(function(){function e(t){var r=t.id,a=t.enabled;this.id=r,this.enabled=a,this.start=Date.now()}return e.prototype.debug=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,nm([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.prototype.getTime=function(){return Date.now()-this.start},e.prototype.info=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,nm([this.id,this.getTime()+"ms"],t))},e.prototype.warn=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,nm([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.prototype.error=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,nm([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.instances={},e})(),AJ=(function(){function e(t,r){var a;this.windowBounds=r,this.instanceName="#"+e.instanceCount++,this.logger=new oJ({id:this.instanceName,enabled:t.logging}),this.cache=(a=t.cache)!==null&&a!==void 0?a:new N$(this,t)}return e.instanceCount=1,e})(),Gw=function(e,t){return t===void 0&&(t={}),cJ(e,t)};typeof window<"u"&&QF.setContext(window);var cJ=function(e,t){return tl(void 0,void 0,void 0,function(){var r,a,n,s,l,A,u,f,h,g,x,m,w,v,B,k,N,S,O,T,D,U,D,H,j,W,I,Q,Y,z,ue,Z,Ae,ve,G,Se,we,F,R,M;return Ri(this,function(P){switch(P.label){case 0:if(!e||typeof e!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(r=e.ownerDocument,!r)throw new Error("Element is not attached to a Document");if(a=r.defaultView,!a)throw new Error("Document is not attached to a Window");return n={allowTaint:(H=t.allowTaint)!==null&&H!==void 0?H:!1,imageTimeout:(j=t.imageTimeout)!==null&&j!==void 0?j:15e3,proxy:t.proxy,useCORS:(W=t.useCORS)!==null&&W!==void 0?W:!1},s=kw({logging:(I=t.logging)!==null&&I!==void 0?I:!0,cache:t.cache},n),l={windowWidth:(Q=t.windowWidth)!==null&&Q!==void 0?Q:a.innerWidth,windowHeight:(Y=t.windowHeight)!==null&&Y!==void 0?Y:a.innerHeight,scrollX:(z=t.scrollX)!==null&&z!==void 0?z:a.pageXOffset,scrollY:(ue=t.scrollY)!==null&&ue!==void 0?ue:a.pageYOffset},A=new Vc(l.scrollX,l.scrollY,l.windowWidth,l.windowHeight),u=new AJ(s,A),f=(Z=t.foreignObjectRendering)!==null&&Z!==void 0?Z:!1,h={allowTaint:(Ae=t.allowTaint)!==null&&Ae!==void 0?Ae:!1,onclone:t.onclone,ignoreElements:t.ignoreElements,inlineImages:f,copyStyles:f},u.logger.debug("Starting document clone with size "+A.width+"x"+A.height+" scrolled to "+-A.left+","+-A.top),g=new qk(u,e,h),x=g.clonedReferenceElement,x?[4,g.toIFrame(r,A)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return m=P.sent(),w=wy(x)||d$(x)?PV(x.ownerDocument):e1(u,x),v=w.width,B=w.height,k=w.left,N=w.top,S=uJ(u,x,t.backgroundColor),O={canvas:t.canvas,backgroundColor:S,scale:(G=(ve=t.scale)!==null&&ve!==void 0?ve:a.devicePixelRatio)!==null&&G!==void 0?G:1,x:((Se=t.x)!==null&&Se!==void 0?Se:0)+k,y:((we=t.y)!==null&&we!==void 0?we:0)+N,width:(F=t.width)!==null&&F!==void 0?F:Math.ceil(v),height:(R=t.height)!==null&&R!==void 0?R:Math.ceil(B)},f?(u.logger.debug("Document cloned, using foreign object rendering"),D=new iJ(u,O),[4,D.render(x)]):[3,3];case 2:return T=P.sent(),[3,5];case 3:return u.logger.debug("Document cloned, element located at "+k+","+N+" with size "+v+"x"+B+" using computed rendering"),u.logger.debug("Starting DOM parsing"),U=NF(u,x),S===U.styles.backgroundColor&&(U.styles.backgroundColor=Kc.TRANSPARENT),u.logger.debug("Starting renderer for element at "+O.x+","+O.y+" with size "+O.width+"x"+O.height),D=new eJ(u,O),[4,D.render(U)];case 4:T=P.sent(),P.label=5;case 5:return(!((M=t.removeContainer)!==null&&M!==void 0)||M)&&(qk.destroy(m)||u.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),u.logger.debug("Finished rendering"),[2,T]}})})},uJ=function(e,t,r){var a=t.ownerDocument,n=a.documentElement?tp(e,getComputedStyle(a.documentElement).backgroundColor):Kc.TRANSPARENT,s=a.body?tp(e,getComputedStyle(a.body).backgroundColor):Kc.TRANSPARENT,l=typeof r=="string"?tp(e,r):r===null?Kc.TRANSPARENT:4294967295;return t===a.documentElement?Pu(n)?Pu(s)?l:s:n:l};const dJ=Object.freeze(Object.defineProperty({__proto__:null,default:Gw},Symbol.toStringTag,{value:"Module"}));function za(e){"@babel/helpers - typeof";return za=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},za(e)}var uA=Uint8Array,uo=Uint16Array,yy=Int32Array,_y=new uA([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),By=new uA([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Xk=new uA([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),qF=function(e,t){for(var r=new uo(31),a=0;a<31;++a)r[a]=t+=1<<e[a-1];for(var n=new yy(r[30]),a=1;a<30;++a)for(var s=r[a];s<r[a+1];++s)n[s]=s-r[a]<<5|a;return{b:r,r:n}},zF=qF(_y,2),fJ=zF.b,Ww=zF.r;fJ[28]=258,Ww[258]=28;var hJ=qF(By,0),Yk=hJ.r,Xw=new uo(32768);for(var _n=0;_n<32768;++_n){var _u=(_n&43690)>>1|(_n&21845)<<1;_u=(_u&52428)>>2|(_u&13107)<<2,_u=(_u&61680)>>4|(_u&3855)<<4,Xw[_n]=((_u&65280)>>8|(_u&255)<<8)>>1}var sp=(function(e,t,r){for(var a=e.length,n=0,s=new uo(t);n<a;++n)e[n]&&++s[e[n]-1];var l=new uo(t);for(n=1;n<t;++n)l[n]=l[n-1]+s[n-1]<<1;var A;if(r){A=new uo(1<<t);var u=15-t;for(n=0;n<a;++n)if(e[n])for(var f=n<<4|e[n],h=t-e[n],g=l[e[n]-1]++<<h,x=g|(1<<h)-1;g<=x;++g)A[Xw[g]>>u]=f}else for(A=new uo(a),n=0;n<a;++n)e[n]&&(A[n]=Xw[l[e[n]-1]++]>>15-e[n]);return A}),K0=new uA(288);for(var _n=0;_n<144;++_n)K0[_n]=8;for(var _n=144;_n<256;++_n)K0[_n]=9;for(var _n=256;_n<280;++_n)K0[_n]=7;for(var _n=280;_n<288;++_n)K0[_n]=8;var Ux=new uA(32);for(var _n=0;_n<32;++_n)Ux[_n]=5;var pJ=sp(K0,9,0),gJ=sp(Ux,5,0),VF=function(e){return(e+7)/8|0},mJ=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new uA(e.subarray(t,r))},jc=function(e,t,r){r<<=t&7;var a=t/8|0;e[a]|=r,e[a+1]|=r>>8},Nh=function(e,t,r){r<<=t&7;var a=t/8|0;e[a]|=r,e[a+1]|=r>>8,e[a+2]|=r>>16},kv=function(e,t){for(var r=[],a=0;a<e.length;++a)e[a]&&r.push({s:a,f:e[a]});var n=r.length,s=r.slice();if(!n)return{t:WF,l:0};if(n==1){var l=new uA(r[0].s+1);return l[r[0].s]=1,{t:l,l:1}}r.sort(function(T,U){return T.f-U.f}),r.push({s:-1,f:25001});var A=r[0],u=r[1],f=0,h=1,g=2;for(r[0]={s:-1,f:A.f+u.f,l:A,r:u};h!=n-1;)A=r[r[f].f<r[g].f?f++:g++],u=r[f!=h&&r[f].f<r[g].f?f++:g++],r[h++]={s:-1,f:A.f+u.f,l:A,r:u};for(var x=s[0].s,a=1;a<n;++a)s[a].s>x&&(x=s[a].s);var m=new uo(x+1),w=Yw(r[h-1],m,0);if(w>t){var a=0,v=0,B=w-t,k=1<<B;for(s.sort(function(U,D){return m[D.s]-m[U.s]||U.f-D.f});a<n;++a){var N=s[a].s;if(m[N]>t)v+=k-(1<<w-m[N]),m[N]=t;else break}for(v>>=B;v>0;){var S=s[a].s;m[S]<t?v-=1<<t-m[S]++-1:++a}for(;a>=0&&v;--a){var O=s[a].s;m[O]==t&&(--m[O],++v)}w=t}return{t:new uA(m),l:w}},Yw=function(e,t,r){return e.s==-1?Math.max(Yw(e.l,t,r+1),Yw(e.r,t,r+1)):t[e.s]=r},$k=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new uo(++t),a=0,n=e[0],s=1,l=function(u){r[a++]=u},A=1;A<=t;++A)if(e[A]==n&&A!=t)++s;else{if(!n&&s>2){for(;s>138;s-=138)l(32754);s>2&&(l(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(l(n),--s;s>6;s-=6)l(8304);s>2&&(l(s-3<<5|8208),s=0)}for(;s--;)l(n);s=1,n=e[A]}return{c:r.subarray(0,a),n:t}},Fh=function(e,t){for(var r=0,a=0;a<t.length;++a)r+=e[a]*t[a];return r},GF=function(e,t,r){var a=r.length,n=VF(t+2);e[n]=a&255,e[n+1]=a>>8,e[n+2]=e[n]^255,e[n+3]=e[n+1]^255;for(var s=0;s<a;++s)e[n+s+4]=r[s];return(n+4+a)*8},Jk=function(e,t,r,a,n,s,l,A,u,f,h){jc(t,h++,r),++n[256];for(var g=kv(n,15),x=g.t,m=g.l,w=kv(s,15),v=w.t,B=w.l,k=$k(x),N=k.c,S=k.n,O=$k(v),T=O.c,U=O.n,D=new uo(19),H=0;H<N.length;++H)++D[N[H]&31];for(var H=0;H<T.length;++H)++D[T[H]&31];for(var j=kv(D,7),W=j.t,I=j.l,Q=19;Q>4&&!W[Xk[Q-1]];--Q);var Y=f+5<<3,z=Fh(n,K0)+Fh(s,Ux)+l,ue=Fh(n,x)+Fh(s,v)+l+14+3*Q+Fh(D,W)+2*D[16]+3*D[17]+7*D[18];if(u>=0&&Y<=z&&Y<=ue)return GF(t,h,e.subarray(u,u+f));var Z,Ae,ve,G;if(jc(t,h,1+(ue<z)),h+=2,ue<z){Z=sp(x,m,0),Ae=x,ve=sp(v,B,0),G=v;var Se=sp(W,I,0);jc(t,h,S-257),jc(t,h+5,U-1),jc(t,h+10,Q-4),h+=14;for(var H=0;H<Q;++H)jc(t,h+3*H,W[Xk[H]]);h+=3*Q;for(var we=[N,T],F=0;F<2;++F)for(var R=we[F],H=0;H<R.length;++H){var M=R[H]&31;jc(t,h,Se[M]),h+=W[M],M>15&&(jc(t,h,R[H]>>5&127),h+=R[H]>>12)}}else Z=pJ,Ae=K0,ve=gJ,G=Ux;for(var H=0;H<A;++H){var P=a[H];if(P>255){var M=P>>18&31;Nh(t,h,Z[M+257]),h+=Ae[M+257],M>7&&(jc(t,h,P>>23&31),h+=_y[M]);var re=P&31;Nh(t,h,ve[re]),h+=G[re],re>3&&(Nh(t,h,P>>5&8191),h+=By[re])}else Nh(t,h,Z[P]),h+=Ae[P]}return Nh(t,h,Z[256]),h+Ae[256]},xJ=new yy([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),WF=new uA(0),bJ=function(e,t,r,a,n,s){var l=s.z||e.length,A=new uA(a+l+5*(1+Math.ceil(l/7e3))+n),u=A.subarray(a,A.length-n),f=s.l,h=(s.r||0)&7;if(t){h&&(u[0]=s.r>>3);for(var g=xJ[t-1],x=g>>13,m=g&8191,w=(1<<r)-1,v=s.p||new uo(32768),B=s.h||new uo(w+1),k=Math.ceil(r/3),N=2*k,S=function(je){return(e[je]^e[je+1]<<k^e[je+2]<<N)&w},O=new yy(25e3),T=new uo(288),U=new uo(32),D=0,H=0,j=s.i||0,W=0,I=s.w||0,Q=0;j+2<l;++j){var Y=S(j),z=j&32767,ue=B[Y];if(v[z]=ue,B[Y]=z,I<=j){var Z=l-j;if((D>7e3||W>24576)&&(Z>423||!f)){h=Jk(e,u,0,O,T,U,H,W,Q,j-Q,h),W=D=H=0,Q=j;for(var Ae=0;Ae<286;++Ae)T[Ae]=0;for(var Ae=0;Ae<30;++Ae)U[Ae]=0}var ve=2,G=0,Se=m,we=z-ue&32767;if(Z>2&&Y==S(j-we))for(var F=Math.min(x,Z)-1,R=Math.min(32767,j),M=Math.min(258,Z);we<=R&&--Se&&z!=ue;){if(e[j+ve]==e[j+ve-we]){for(var P=0;P<M&&e[j+P]==e[j+P-we];++P);if(P>ve){if(ve=P,G=we,P>F)break;for(var re=Math.min(we,P-2),ge=0,Ae=0;Ae<re;++Ae){var Ce=j-we+Ae&32767,de=v[Ce],be=Ce-de&32767;be>ge&&(ge=be,ue=Ce)}}}z=ue,ue=v[z],we+=z-ue&32767}if(G){O[W++]=268435456|Ww[ve]<<18|Yk[G];var Le=Ww[ve]&31,ie=Yk[G]&31;H+=_y[Le]+By[ie],++T[257+Le],++U[ie],I=j+ve,++D}else O[W++]=e[j],++T[e[j]]}}for(j=Math.max(j,I);j<l;++j)O[W++]=e[j],++T[e[j]];h=Jk(e,u,f,O,T,U,H,W,Q,j-Q,h),f||(s.r=h&7|u[h/8|0]<<3,h-=7,s.h=B,s.p=v,s.i=j,s.w=I)}else{for(var j=s.w||0;j<l+f;j+=65535){var _e=j+65535;_e>=l&&(u[h/8|0]=f,_e=l),h=GF(u,h+1,e.subarray(j,_e))}s.i=l}return mJ(A,0,a+VF(h)+n)},XF=function(){var e=1,t=0;return{p:function(r){for(var a=e,n=t,s=r.length|0,l=0;l!=s;){for(var A=Math.min(l+2655,s);l<A;++l)n+=a+=r[l];a=(a&65535)+15*(a>>16),n=(n&65535)+15*(n>>16)}e=a,t=n},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},vJ=function(e,t,r,a,n){if(!n&&(n={l:1},t.dictionary)){var s=t.dictionary.subarray(-32768),l=new uA(s.length+e.length);l.set(s),l.set(e,s.length),e=l,n.w=s.length}return bJ(e,t.level==null?6:t.level,t.mem==null?n.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,a,n)},YF=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},wJ=function(e,t){var r=t.level,a=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=a<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var n=XF();n.p(t.dictionary),YF(e,2,n.d())}};function $w(e,t){t||(t={});var r=XF();r.p(e);var a=vJ(e,t,t.dictionary?6:2,4);return wJ(a,t),YF(a,a.length-4,r.d()),a}var yJ=typeof TextDecoder<"u"&&new TextDecoder,_J=0;try{yJ.decode(WF,{stream:!0}),_J=1}catch{}function BJ(e){if(Array.isArray(e))return e}function kJ(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,n,s,l,A=[],u=!0,f=!1;try{if(s=(r=r.call(e)).next,t!==0)for(;!(u=(a=s.call(r)).done)&&(A.push(a.value),A.length!==t);u=!0);}catch(h){f=!0,n=h}finally{try{if(!u&&r.return!=null&&(l=r.return(),Object(l)!==l))return}finally{if(f)throw n}}return A}}function Zk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=Array(t);r<t;r++)a[r]=e[r];return a}function CJ(e,t){if(e){if(typeof e=="string")return Zk(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Zk(e,t):void 0}}function SJ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eC(e,t){return BJ(e)||kJ(e,t)||CJ(e,t)||SJ()}function tC(e,t="utf8"){return new TextDecoder(t).decode(e)}const EJ=new TextEncoder;function NJ(e){return EJ.encode(e)}const FJ=1024*8,TJ=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),Cv={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class ky{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(t=FJ,r={}){let a=!1;typeof t=="number"?t=new ArrayBuffer(t):(a=!0,this.lastWrittenByte=t.byteLength);const n=r.offset?r.offset>>>0:0,s=t.byteLength-n;let l=n;(ArrayBuffer.isView(t)||t instanceof ky)&&(t.byteLength!==t.buffer.byteLength&&(l=t.byteOffset+n),t=t.buffer),a?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=t,this.length=s,this.byteLength=s,this.byteOffset=l,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,l,s),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const a=(this.offset+t)*2,n=new Uint8Array(a);n.set(new Uint8Array(this.buffer)),this.buffer=n.buffer,this.length=a,this.byteLength=a,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const a=Cv[r].BYTES_PER_ELEMENT*t,n=this.byteOffset+this.offset,s=this.buffer.slice(n,n+a);if(this.littleEndian===TJ&&r!=="uint8"&&r!=="int8"){const A=new Uint8Array(this.buffer.slice(n,n+a));A.reverse();const u=new Cv[r](A.buffer);return this.offset+=a,u.reverse(),u}const l=new Cv[r](s);return this.offset+=a,l}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let a=0;a<t;a++)r+=this.readChar();return r}readUtf8(t=1){return tC(this.readBytes(t))}decodeText(t=1,r="utf8"){return tC(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(NJ(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Lf(e){let t=e.length;for(;--t>=0;)e[t]=0}const LJ=3,UJ=258,$F=29,jJ=256,DJ=jJ+1+$F,JF=30,IJ=512,QJ=new Array((DJ+2)*2);Lf(QJ);const OJ=new Array(JF*2);Lf(OJ);const RJ=new Array(IJ);Lf(RJ);const MJ=new Array(UJ-LJ+1);Lf(MJ);const HJ=new Array($F);Lf(HJ);const PJ=new Array(JF);Lf(PJ);const KJ=(e,t,r,a)=>{let n=e&65535|0,s=e>>>16&65535|0,l=0;for(;r!==0;){l=r>2e3?2e3:r,r-=l;do n=n+t[a++]|0,s=s+n|0;while(--l);n%=65521,s%=65521}return n|s<<16|0};var Jw=KJ;const qJ=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var a=0;a<8;a++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},zJ=new Uint32Array(qJ()),VJ=(e,t,r,a)=>{const n=zJ,s=a+r;e^=-1;for(let l=a;l<s;l++)e=e>>>8^n[(e^t[l])&255];return e^-1};var PA=VJ,Zw={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},ZF={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const GJ=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var WJ=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const a in r)GJ(r,a)&&(e[a]=r[a])}}return e},XJ=e=>{let t=0;for(let a=0,n=e.length;a<n;a++)t+=e[a].length;const r=new Uint8Array(t);for(let a=0,n=0,s=e.length;a<s;a++){let l=e[a];r.set(l,n),n+=l.length}return r},eT={assign:WJ,flattenChunks:XJ};let tT=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{tT=!1}const Np=new Uint8Array(256);for(let e=0;e<256;e++)Np[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Np[254]=Np[254]=1;var YJ=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,a,n,s,l=e.length,A=0;for(n=0;n<l;n++)r=e.charCodeAt(n),(r&64512)===55296&&n+1<l&&(a=e.charCodeAt(n+1),(a&64512)===56320&&(r=65536+(r-55296<<10)+(a-56320),n++)),A+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(A),s=0,n=0;s<A;n++)r=e.charCodeAt(n),(r&64512)===55296&&n+1<l&&(a=e.charCodeAt(n+1),(a&64512)===56320&&(r=65536+(r-55296<<10)+(a-56320),n++)),r<128?t[s++]=r:r<2048?(t[s++]=192|r>>>6,t[s++]=128|r&63):r<65536?(t[s++]=224|r>>>12,t[s++]=128|r>>>6&63,t[s++]=128|r&63):(t[s++]=240|r>>>18,t[s++]=128|r>>>12&63,t[s++]=128|r>>>6&63,t[s++]=128|r&63);return t};const $J=(e,t)=>{if(t<65534&&e.subarray&&tT)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let a=0;a<t;a++)r+=String.fromCharCode(e[a]);return r};var JJ=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let a,n;const s=new Array(r*2);for(n=0,a=0;a<r;){let l=e[a++];if(l<128){s[n++]=l;continue}let A=Np[l];if(A>4){s[n++]=65533,a+=A-1;continue}for(l&=A===2?31:A===3?15:7;A>1&&a<r;)l=l<<6|e[a++]&63,A--;if(A>1){s[n++]=65533;continue}l<65536?s[n++]=l:(l-=65536,s[n++]=55296|l>>10&1023,s[n++]=56320|l&1023)}return $J(s,n)},ZJ=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+Np[e[r]]>t?r:t},e2={string2buf:YJ,buf2string:JJ,utf8border:ZJ};function eZ(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var tZ=eZ;const Sm=16209,rZ=16191;var aZ=function(t,r){let a,n,s,l,A,u,f,h,g,x,m,w,v,B,k,N,S,O,T,U,D,H,j,W;const I=t.state;a=t.next_in,j=t.input,n=a+(t.avail_in-5),s=t.next_out,W=t.output,l=s-(r-t.avail_out),A=s+(t.avail_out-257),u=I.dmax,f=I.wsize,h=I.whave,g=I.wnext,x=I.window,m=I.hold,w=I.bits,v=I.lencode,B=I.distcode,k=(1<<I.lenbits)-1,N=(1<<I.distbits)-1;e:do{w<15&&(m+=j[a++]<<w,w+=8,m+=j[a++]<<w,w+=8),S=v[m&k];t:for(;;){if(O=S>>>24,m>>>=O,w-=O,O=S>>>16&255,O===0)W[s++]=S&65535;else if(O&16){T=S&65535,O&=15,O&&(w<O&&(m+=j[a++]<<w,w+=8),T+=m&(1<<O)-1,m>>>=O,w-=O),w<15&&(m+=j[a++]<<w,w+=8,m+=j[a++]<<w,w+=8),S=B[m&N];r:for(;;){if(O=S>>>24,m>>>=O,w-=O,O=S>>>16&255,O&16){if(U=S&65535,O&=15,w<O&&(m+=j[a++]<<w,w+=8,w<O&&(m+=j[a++]<<w,w+=8)),U+=m&(1<<O)-1,U>u){t.msg="invalid distance too far back",I.mode=Sm;break e}if(m>>>=O,w-=O,O=s-l,U>O){if(O=U-O,O>h&&I.sane){t.msg="invalid distance too far back",I.mode=Sm;break e}if(D=0,H=x,g===0){if(D+=f-O,O<T){T-=O;do W[s++]=x[D++];while(--O);D=s-U,H=W}}else if(g<O){if(D+=f+g-O,O-=g,O<T){T-=O;do W[s++]=x[D++];while(--O);if(D=0,g<T){O=g,T-=O;do W[s++]=x[D++];while(--O);D=s-U,H=W}}}else if(D+=g-O,O<T){T-=O;do W[s++]=x[D++];while(--O);D=s-U,H=W}for(;T>2;)W[s++]=H[D++],W[s++]=H[D++],W[s++]=H[D++],T-=3;T&&(W[s++]=H[D++],T>1&&(W[s++]=H[D++]))}else{D=s-U;do W[s++]=W[D++],W[s++]=W[D++],W[s++]=W[D++],T-=3;while(T>2);T&&(W[s++]=W[D++],T>1&&(W[s++]=W[D++]))}}else if((O&64)===0){S=B[(S&65535)+(m&(1<<O)-1)];continue r}else{t.msg="invalid distance code",I.mode=Sm;break e}break}}else if((O&64)===0){S=v[(S&65535)+(m&(1<<O)-1)];continue t}else if(O&32){I.mode=rZ;break e}else{t.msg="invalid literal/length code",I.mode=Sm;break e}break}}while(a<n&&s<A);T=w>>3,a-=T,w-=T<<3,m&=(1<<w)-1,t.next_in=a,t.next_out=s,t.avail_in=a<n?5+(n-a):5-(a-n),t.avail_out=s<A?257+(A-s):257-(s-A),I.hold=m,I.bits=w};const qd=15,rC=852,aC=592,nC=0,Sv=1,sC=2,nZ=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),sZ=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),iZ=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),lZ=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),oZ=(e,t,r,a,n,s,l,A)=>{const u=A.bits;let f=0,h=0,g=0,x=0,m=0,w=0,v=0,B=0,k=0,N=0,S,O,T,U,D,H=null,j;const W=new Uint16Array(qd+1),I=new Uint16Array(qd+1);let Q=null,Y,z,ue;for(f=0;f<=qd;f++)W[f]=0;for(h=0;h<a;h++)W[t[r+h]]++;for(m=u,x=qd;x>=1&&W[x]===0;x--);if(m>x&&(m=x),x===0)return n[s++]=1<<24|64<<16|0,n[s++]=1<<24|64<<16|0,A.bits=1,0;for(g=1;g<x&&W[g]===0;g++);for(m<g&&(m=g),B=1,f=1;f<=qd;f++)if(B<<=1,B-=W[f],B<0)return-1;if(B>0&&(e===nC||x!==1))return-1;for(I[1]=0,f=1;f<qd;f++)I[f+1]=I[f]+W[f];for(h=0;h<a;h++)t[r+h]!==0&&(l[I[t[r+h]]++]=h);if(e===nC?(H=Q=l,j=20):e===Sv?(H=nZ,Q=sZ,j=257):(H=iZ,Q=lZ,j=0),N=0,h=0,f=g,D=s,w=m,v=0,T=-1,k=1<<m,U=k-1,e===Sv&&k>rC||e===sC&&k>aC)return 1;for(;;){Y=f-v,l[h]+1<j?(z=0,ue=l[h]):l[h]>=j?(z=Q[l[h]-j],ue=H[l[h]-j]):(z=96,ue=0),S=1<<f-v,O=1<<w,g=O;do O-=S,n[D+(N>>v)+O]=Y<<24|z<<16|ue|0;while(O!==0);for(S=1<<f-1;N&S;)S>>=1;if(S!==0?(N&=S-1,N+=S):N=0,h++,--W[f]===0){if(f===x)break;f=t[r+l[h]]}if(f>m&&(N&U)!==T){for(v===0&&(v=m),D+=g,w=f-v,B=1<<w;w+v<x&&(B-=W[w+v],!(B<=0));)w++,B<<=1;if(k+=1<<w,e===Sv&&k>rC||e===sC&&k>aC)return 1;T=N&U,n[T]=m<<24|w<<16|D-s|0}}return N!==0&&(n[D+N]=f-v<<24|64<<16|0),A.bits=m,0};var ip=oZ;const AZ=0,rT=1,aT=2,{Z_FINISH:iC,Z_BLOCK:cZ,Z_TREES:Em,Z_OK:q0,Z_STREAM_END:uZ,Z_NEED_DICT:dZ,Z_STREAM_ERROR:Ro,Z_DATA_ERROR:nT,Z_MEM_ERROR:sT,Z_BUF_ERROR:fZ,Z_DEFLATED:lC}=ZF,c1=16180,oC=16181,AC=16182,cC=16183,uC=16184,dC=16185,fC=16186,hC=16187,pC=16188,gC=16189,jx=16190,Dc=16191,Ev=16192,mC=16193,Nv=16194,xC=16195,bC=16196,vC=16197,wC=16198,Nm=16199,Fm=16200,yC=16201,_C=16202,BC=16203,kC=16204,CC=16205,Fv=16206,SC=16207,EC=16208,Un=16209,iT=16210,lT=16211,hZ=852,pZ=592,gZ=15,mZ=gZ,NC=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function xZ(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const $0=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<c1||t.mode>lT?1:0},oT=e=>{if($0(e))return Ro;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=c1,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(hZ),t.distcode=t.distdyn=new Int32Array(pZ),t.sane=1,t.back=-1,q0},AT=e=>{if($0(e))return Ro;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,oT(e)},cT=(e,t)=>{let r;if($0(e))return Ro;const a=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?Ro:(a.window!==null&&a.wbits!==t&&(a.window=null),a.wrap=r,a.wbits=t,AT(e))},uT=(e,t)=>{if(!e)return Ro;const r=new xZ;e.state=r,r.strm=e,r.window=null,r.mode=c1;const a=cT(e,t);return a!==q0&&(e.state=null),a},bZ=e=>uT(e,mZ);let FC=!0,Tv,Lv;const vZ=e=>{if(FC){Tv=new Int32Array(512),Lv=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(ip(rT,e.lens,0,288,Tv,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;ip(aT,e.lens,0,32,Lv,0,e.work,{bits:5}),FC=!1}e.lencode=Tv,e.lenbits=9,e.distcode=Lv,e.distbits=5},dT=(e,t,r,a)=>{let n;const s=e.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),a>=s.wsize?(s.window.set(t.subarray(r-s.wsize,r),0),s.wnext=0,s.whave=s.wsize):(n=s.wsize-s.wnext,n>a&&(n=a),s.window.set(t.subarray(r-a,r-a+n),s.wnext),a-=n,a?(s.window.set(t.subarray(r-a,r),0),s.wnext=a,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n))),0},wZ=(e,t)=>{let r,a,n,s,l,A,u,f,h,g,x,m,w,v,B=0,k,N,S,O,T,U,D,H;const j=new Uint8Array(4);let W,I;const Q=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if($0(e)||!e.output||!e.input&&e.avail_in!==0)return Ro;r=e.state,r.mode===Dc&&(r.mode=Ev),l=e.next_out,n=e.output,u=e.avail_out,s=e.next_in,a=e.input,A=e.avail_in,f=r.hold,h=r.bits,g=A,x=u,H=q0;e:for(;;)switch(r.mode){case c1:if(r.wrap===0){r.mode=Ev;break}for(;h<16;){if(A===0)break e;A--,f+=a[s++]<<h,h+=8}if(r.wrap&2&&f===35615){r.wbits===0&&(r.wbits=15),r.check=0,j[0]=f&255,j[1]=f>>>8&255,r.check=PA(r.check,j,2,0),f=0,h=0,r.mode=oC;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((f&255)<<8)+(f>>8))%31){e.msg="incorrect header check",r.mode=Un;break}if((f&15)!==lC){e.msg="unknown compression method",r.mode=Un;break}if(f>>>=4,h-=4,D=(f&15)+8,r.wbits===0&&(r.wbits=D),D>15||D>r.wbits){e.msg="invalid window size",r.mode=Un;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=f&512?gC:Dc,f=0,h=0;break;case oC:for(;h<16;){if(A===0)break e;A--,f+=a[s++]<<h,h+=8}if(r.flags=f,(r.flags&255)!==lC){e.msg="unknown compression method",r.mode=Un;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=Un;break}r.head&&(r.head.text=f>>8&1),r.flags&512&&r.wrap&4&&(j[0]=f&255,j[1]=f>>>8&255,r.check=PA(r.check,j,2,0)),f=0,h=0,r.mode=AC;case AC:for(;h<32;){if(A===0)break e;A--,f+=a[s++]<<h,h+=8}r.head&&(r.head.time=f),r.flags&512&&r.wrap&4&&(j[0]=f&255,j[1]=f>>>8&255,j[2]=f>>>16&255,j[3]=f>>>24&255,r.check=PA(r.check,j,4,0)),f=0,h=0,r.mode=cC;case cC:for(;h<16;){if(A===0)break e;A--,f+=a[s++]<<h,h+=8}r.head&&(r.head.xflags=f&255,r.head.os=f>>8),r.flags&512&&r.wrap&4&&(j[0]=f&255,j[1]=f>>>8&255,r.check=PA(r.check,j,2,0)),f=0,h=0,r.mode=uC;case uC:if(r.flags&1024){for(;h<16;){if(A===0)break e;A--,f+=a[s++]<<h,h+=8}r.length=f,r.head&&(r.head.extra_len=f),r.flags&512&&r.wrap&4&&(j[0]=f&255,j[1]=f>>>8&255,r.check=PA(r.check,j,2,0)),f=0,h=0}else r.head&&(r.head.extra=null);r.mode=dC;case dC:if(r.flags&1024&&(m=r.length,m>A&&(m=A),m&&(r.head&&(D=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(a.subarray(s,s+m),D)),r.flags&512&&r.wrap&4&&(r.check=PA(r.check,a,m,s)),A-=m,s+=m,r.length-=m),r.length))break e;r.length=0,r.mode=fC;case fC:if(r.flags&2048){if(A===0)break e;m=0;do D=a[s+m++],r.head&&D&&r.length<65536&&(r.head.name+=String.fromCharCode(D));while(D&&m<A);if(r.flags&512&&r.wrap&4&&(r.check=PA(r.check,a,m,s)),A-=m,s+=m,D)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=hC;case hC:if(r.flags&4096){if(A===0)break e;m=0;do D=a[s+m++],r.head&&D&&r.length<65536&&(r.head.comment+=String.fromCharCode(D));while(D&&m<A);if(r.flags&512&&r.wrap&4&&(r.check=PA(r.check,a,m,s)),A-=m,s+=m,D)break e}else r.head&&(r.head.comment=null);r.mode=pC;case pC:if(r.flags&512){for(;h<16;){if(A===0)break e;A--,f+=a[s++]<<h,h+=8}if(r.wrap&4&&f!==(r.check&65535)){e.msg="header crc mismatch",r.mode=Un;break}f=0,h=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=Dc;break;case gC:for(;h<32;){if(A===0)break e;A--,f+=a[s++]<<h,h+=8}e.adler=r.check=NC(f),f=0,h=0,r.mode=jx;case jx:if(r.havedict===0)return e.next_out=l,e.avail_out=u,e.next_in=s,e.avail_in=A,r.hold=f,r.bits=h,dZ;e.adler=r.check=1,r.mode=Dc;case Dc:if(t===cZ||t===Em)break e;case Ev:if(r.last){f>>>=h&7,h-=h&7,r.mode=Fv;break}for(;h<3;){if(A===0)break e;A--,f+=a[s++]<<h,h+=8}switch(r.last=f&1,f>>>=1,h-=1,f&3){case 0:r.mode=mC;break;case 1:if(vZ(r),r.mode=Nm,t===Em){f>>>=2,h-=2;break e}break;case 2:r.mode=bC;break;case 3:e.msg="invalid block type",r.mode=Un}f>>>=2,h-=2;break;case mC:for(f>>>=h&7,h-=h&7;h<32;){if(A===0)break e;A--,f+=a[s++]<<h,h+=8}if((f&65535)!==(f>>>16^65535)){e.msg="invalid stored block lengths",r.mode=Un;break}if(r.length=f&65535,f=0,h=0,r.mode=Nv,t===Em)break e;case Nv:r.mode=xC;case xC:if(m=r.length,m){if(m>A&&(m=A),m>u&&(m=u),m===0)break e;n.set(a.subarray(s,s+m),l),A-=m,s+=m,u-=m,l+=m,r.length-=m;break}r.mode=Dc;break;case bC:for(;h<14;){if(A===0)break e;A--,f+=a[s++]<<h,h+=8}if(r.nlen=(f&31)+257,f>>>=5,h-=5,r.ndist=(f&31)+1,f>>>=5,h-=5,r.ncode=(f&15)+4,f>>>=4,h-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=Un;break}r.have=0,r.mode=vC;case vC:for(;r.have<r.ncode;){for(;h<3;){if(A===0)break e;A--,f+=a[s++]<<h,h+=8}r.lens[Q[r.have++]]=f&7,f>>>=3,h-=3}for(;r.have<19;)r.lens[Q[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,W={bits:r.lenbits},H=ip(AZ,r.lens,0,19,r.lencode,0,r.work,W),r.lenbits=W.bits,H){e.msg="invalid code lengths set",r.mode=Un;break}r.have=0,r.mode=wC;case wC:for(;r.have<r.nlen+r.ndist;){for(;B=r.lencode[f&(1<<r.lenbits)-1],k=B>>>24,N=B>>>16&255,S=B&65535,!(k<=h);){if(A===0)break e;A--,f+=a[s++]<<h,h+=8}if(S<16)f>>>=k,h-=k,r.lens[r.have++]=S;else{if(S===16){for(I=k+2;h<I;){if(A===0)break e;A--,f+=a[s++]<<h,h+=8}if(f>>>=k,h-=k,r.have===0){e.msg="invalid bit length repeat",r.mode=Un;break}D=r.lens[r.have-1],m=3+(f&3),f>>>=2,h-=2}else if(S===17){for(I=k+3;h<I;){if(A===0)break e;A--,f+=a[s++]<<h,h+=8}f>>>=k,h-=k,D=0,m=3+(f&7),f>>>=3,h-=3}else{for(I=k+7;h<I;){if(A===0)break e;A--,f+=a[s++]<<h,h+=8}f>>>=k,h-=k,D=0,m=11+(f&127),f>>>=7,h-=7}if(r.have+m>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=Un;break}for(;m--;)r.lens[r.have++]=D}}if(r.mode===Un)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=Un;break}if(r.lenbits=9,W={bits:r.lenbits},H=ip(rT,r.lens,0,r.nlen,r.lencode,0,r.work,W),r.lenbits=W.bits,H){e.msg="invalid literal/lengths set",r.mode=Un;break}if(r.distbits=6,r.distcode=r.distdyn,W={bits:r.distbits},H=ip(aT,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,W),r.distbits=W.bits,H){e.msg="invalid distances set",r.mode=Un;break}if(r.mode=Nm,t===Em)break e;case Nm:r.mode=Fm;case Fm:if(A>=6&&u>=258){e.next_out=l,e.avail_out=u,e.next_in=s,e.avail_in=A,r.hold=f,r.bits=h,aZ(e,x),l=e.next_out,n=e.output,u=e.avail_out,s=e.next_in,a=e.input,A=e.avail_in,f=r.hold,h=r.bits,r.mode===Dc&&(r.back=-1);break}for(r.back=0;B=r.lencode[f&(1<<r.lenbits)-1],k=B>>>24,N=B>>>16&255,S=B&65535,!(k<=h);){if(A===0)break e;A--,f+=a[s++]<<h,h+=8}if(N&&(N&240)===0){for(O=k,T=N,U=S;B=r.lencode[U+((f&(1<<O+T)-1)>>O)],k=B>>>24,N=B>>>16&255,S=B&65535,!(O+k<=h);){if(A===0)break e;A--,f+=a[s++]<<h,h+=8}f>>>=O,h-=O,r.back+=O}if(f>>>=k,h-=k,r.back+=k,r.length=S,N===0){r.mode=CC;break}if(N&32){r.back=-1,r.mode=Dc;break}if(N&64){e.msg="invalid literal/length code",r.mode=Un;break}r.extra=N&15,r.mode=yC;case yC:if(r.extra){for(I=r.extra;h<I;){if(A===0)break e;A--,f+=a[s++]<<h,h+=8}r.length+=f&(1<<r.extra)-1,f>>>=r.extra,h-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=_C;case _C:for(;B=r.distcode[f&(1<<r.distbits)-1],k=B>>>24,N=B>>>16&255,S=B&65535,!(k<=h);){if(A===0)break e;A--,f+=a[s++]<<h,h+=8}if((N&240)===0){for(O=k,T=N,U=S;B=r.distcode[U+((f&(1<<O+T)-1)>>O)],k=B>>>24,N=B>>>16&255,S=B&65535,!(O+k<=h);){if(A===0)break e;A--,f+=a[s++]<<h,h+=8}f>>>=O,h-=O,r.back+=O}if(f>>>=k,h-=k,r.back+=k,N&64){e.msg="invalid distance code",r.mode=Un;break}r.offset=S,r.extra=N&15,r.mode=BC;case BC:if(r.extra){for(I=r.extra;h<I;){if(A===0)break e;A--,f+=a[s++]<<h,h+=8}r.offset+=f&(1<<r.extra)-1,f>>>=r.extra,h-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=Un;break}r.mode=kC;case kC:if(u===0)break e;if(m=x-u,r.offset>m){if(m=r.offset-m,m>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=Un;break}m>r.wnext?(m-=r.wnext,w=r.wsize-m):w=r.wnext-m,m>r.length&&(m=r.length),v=r.window}else v=n,w=l-r.offset,m=r.length;m>u&&(m=u),u-=m,r.length-=m;do n[l++]=v[w++];while(--m);r.length===0&&(r.mode=Fm);break;case CC:if(u===0)break e;n[l++]=r.length,u--,r.mode=Fm;break;case Fv:if(r.wrap){for(;h<32;){if(A===0)break e;A--,f|=a[s++]<<h,h+=8}if(x-=u,e.total_out+=x,r.total+=x,r.wrap&4&&x&&(e.adler=r.check=r.flags?PA(r.check,n,x,l-x):Jw(r.check,n,x,l-x)),x=u,r.wrap&4&&(r.flags?f:NC(f))!==r.check){e.msg="incorrect data check",r.mode=Un;break}f=0,h=0}r.mode=SC;case SC:if(r.wrap&&r.flags){for(;h<32;){if(A===0)break e;A--,f+=a[s++]<<h,h+=8}if(r.wrap&4&&f!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=Un;break}f=0,h=0}r.mode=EC;case EC:H=uZ;break e;case Un:H=nT;break e;case iT:return sT;case lT:default:return Ro}return e.next_out=l,e.avail_out=u,e.next_in=s,e.avail_in=A,r.hold=f,r.bits=h,(r.wsize||x!==e.avail_out&&r.mode<Un&&(r.mode<Fv||t!==iC))&&dT(e,e.output,e.next_out,x-e.avail_out),g-=e.avail_in,x-=e.avail_out,e.total_in+=g,e.total_out+=x,r.total+=x,r.wrap&4&&x&&(e.adler=r.check=r.flags?PA(r.check,n,x,e.next_out-x):Jw(r.check,n,x,e.next_out-x)),e.data_type=r.bits+(r.last?64:0)+(r.mode===Dc?128:0)+(r.mode===Nm||r.mode===Nv?256:0),(g===0&&x===0||t===iC)&&H===q0&&(H=fZ),H},yZ=e=>{if($0(e))return Ro;let t=e.state;return t.window&&(t.window=null),e.state=null,q0},_Z=(e,t)=>{if($0(e))return Ro;const r=e.state;return(r.wrap&2)===0?Ro:(r.head=t,t.done=!1,q0)},BZ=(e,t)=>{const r=t.length;let a,n,s;return $0(e)||(a=e.state,a.wrap!==0&&a.mode!==jx)?Ro:a.mode===jx&&(n=1,n=Jw(n,t,r,0),n!==a.check)?nT:(s=dT(e,t,r,r),s?(a.mode=iT,sT):(a.havedict=1,q0))};var kZ=AT,CZ=cT,SZ=oT,EZ=bZ,NZ=uT,FZ=wZ,TZ=yZ,LZ=_Z,UZ=BZ,jZ="pako inflate (from Nodeca project)",Qc={inflateReset:kZ,inflateReset2:CZ,inflateResetKeep:SZ,inflateInit:EZ,inflateInit2:NZ,inflate:FZ,inflateEnd:TZ,inflateGetHeader:LZ,inflateSetDictionary:UZ,inflateInfo:jZ};function DZ(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var IZ=DZ;const fT=Object.prototype.toString,{Z_NO_FLUSH:QZ,Z_FINISH:OZ,Z_OK:Fp,Z_STREAM_END:Uv,Z_NEED_DICT:jv,Z_STREAM_ERROR:RZ,Z_DATA_ERROR:TC,Z_MEM_ERROR:MZ}=ZF;function Vp(e){this.options=eT.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15)===0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new tZ,this.strm.avail_out=0;let r=Qc.inflateInit2(this.strm,t.windowBits);if(r!==Fp)throw new Error(Zw[r]);if(this.header=new IZ,Qc.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=e2.string2buf(t.dictionary):fT.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=Qc.inflateSetDictionary(this.strm,t.dictionary),r!==Fp)))throw new Error(Zw[r])}Vp.prototype.push=function(e,t){const r=this.strm,a=this.options.chunkSize,n=this.options.dictionary;let s,l,A;if(this.ended)return!1;for(t===~~t?l=t:l=t===!0?OZ:QZ,fT.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(a),r.next_out=0,r.avail_out=a),s=Qc.inflate(r,l),s===jv&&n&&(s=Qc.inflateSetDictionary(r,n),s===Fp?s=Qc.inflate(r,l):s===TC&&(s=jv));r.avail_in>0&&s===Uv&&r.state.wrap>0&&e[r.next_in]!==0;)Qc.inflateReset(r),s=Qc.inflate(r,l);switch(s){case RZ:case TC:case jv:case MZ:return this.onEnd(s),this.ended=!0,!1}if(A=r.avail_out,r.next_out&&(r.avail_out===0||s===Uv))if(this.options.to==="string"){let u=e2.utf8border(r.output,r.next_out),f=r.next_out-u,h=e2.buf2string(r.output,u);r.next_out=f,r.avail_out=a-f,f&&r.output.set(r.output.subarray(u,u+f),0),this.onData(h)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(s===Fp&&A===0)){if(s===Uv)return s=Qc.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};Vp.prototype.onData=function(e){this.chunks.push(e)};Vp.prototype.onEnd=function(e){e===Fp&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=eT.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function HZ(e,t){const r=new Vp(t);if(r.push(e),r.err)throw r.msg||Zw[r.err];return r.result}var PZ=Vp,KZ=HZ,qZ={Inflate:PZ,inflate:KZ};const{Inflate:zZ,inflate:VZ}=qZ;var LC=zZ,GZ=VZ;const hT=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;hT[e]=t}const UC=4294967295;function WZ(e,t,r){let a=e;for(let n=0;n<r;n++)a=hT[(a^t[n])&255]^a>>>8;return a}function XZ(e,t){return(WZ(UC,e,t)^UC)>>>0}function jC(e,t,r){const a=e.readUint32(),n=XZ(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(n!==a)throw new Error(`CRC mismatch for chunk ${r}. Expected ${a}, found ${n}`)}function pT(e,t,r){for(let a=0;a<r;a++)t[a]=e[a]}function gT(e,t,r,a){let n=0;for(;n<a;n++)t[n]=e[n];for(;n<r;n++)t[n]=e[n]+t[n-a]&255}function mT(e,t,r,a){let n=0;if(r.length===0)for(;n<a;n++)t[n]=e[n];else for(;n<a;n++)t[n]=e[n]+r[n]&255}function xT(e,t,r,a,n){let s=0;if(r.length===0){for(;s<n;s++)t[s]=e[s];for(;s<a;s++)t[s]=e[s]+(t[s-n]>>1)&255}else{for(;s<n;s++)t[s]=e[s]+(r[s]>>1)&255;for(;s<a;s++)t[s]=e[s]+(t[s-n]+r[s]>>1)&255}}function bT(e,t,r,a,n){let s=0;if(r.length===0){for(;s<n;s++)t[s]=e[s];for(;s<a;s++)t[s]=e[s]+t[s-n]&255}else{for(;s<n;s++)t[s]=e[s]+r[s]&255;for(;s<a;s++)t[s]=e[s]+YZ(t[s-n],r[s],r[s-n])&255}}function YZ(e,t,r){const a=e+t-r,n=Math.abs(a-e),s=Math.abs(a-t),l=Math.abs(a-r);return n<=s&&n<=l?e:s<=l?t:r}function $Z(e,t,r,a,n,s){switch(e){case 0:pT(t,r,n);break;case 1:gT(t,r,n,s);break;case 2:mT(t,r,a,n);break;case 3:xT(t,r,a,n,s);break;case 4:bT(t,r,a,n,s);break;default:throw new Error(`Unsupported filter: ${e}`)}}const JZ=new Uint16Array([255]),ZZ=new Uint8Array(JZ.buffer),eee=ZZ[0]===255;function tee(e){const{data:t,width:r,height:a,channels:n,depth:s}=e,l=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],A=Math.ceil(s/8)*n,u=new Uint8Array(a*r*A);let f=0;for(let h=0;h<7;h++){const g=l[h],x=Math.ceil((r-g.x)/g.xStep),m=Math.ceil((a-g.y)/g.yStep);if(x<=0||m<=0)continue;const w=x*A,v=new Uint8Array(w);for(let B=0;B<m;B++){const k=t[f++],N=t.subarray(f,f+w);f+=w;const S=new Uint8Array(w);$Z(k,N,S,v,w,A),v.set(S);for(let O=0;O<x;O++){const T=g.x+O*g.xStep,U=g.y+B*g.yStep;if(!(T>=r||U>=a))for(let D=0;D<A;D++)u[(U*r+T)*A+D]=S[O*A+D]}}}if(s===16){const h=new Uint16Array(u.buffer);if(eee)for(let g=0;g<h.length;g++)h[g]=ree(h[g]);return h}else return u}function ree(e){return(e&255)<<8|e>>8&255}const aee=new Uint16Array([255]),nee=new Uint8Array(aee.buffer),see=nee[0]===255,iee=new Uint8Array(0);function DC(e){const{data:t,width:r,height:a,channels:n,depth:s}=e,l=Math.ceil(s/8)*n,A=Math.ceil(s/8*n*r),u=new Uint8Array(a*A);let f=iee,h=0,g,x;for(let m=0;m<a;m++){switch(g=t.subarray(h+1,h+1+A),x=u.subarray(m*A,(m+1)*A),t[h]){case 0:pT(g,x,A);break;case 1:gT(g,x,A,l);break;case 2:mT(g,x,f,A);break;case 3:xT(g,x,f,A,l);break;case 4:bT(g,x,f,A,l);break;default:throw new Error(`Unsupported filter: ${t[h]}`)}f=x,h+=A+1}if(s===16){const m=new Uint16Array(u.buffer);if(see)for(let w=0;w<m.length;w++)m[w]=lee(m[w]);return m}else return u}function lee(e){return(e&255)<<8|e>>8&255}const Pm=Uint8Array.of(137,80,78,71,13,10,26,10);function IC(e){if(!oee(e.readBytes(Pm.length)))throw new Error("wrong PNG signature")}function oee(e){if(e.length<Pm.length)return!1;for(let t=0;t<Pm.length;t++)if(e[t]!==Pm[t])return!1;return!0}const Aee="tEXt",cee=0,vT=new TextDecoder("latin1");function uee(e){if(fee(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const dee=/^[\u0000-\u00FF]*$/;function fee(e){if(!dee.test(e))throw new Error("invalid latin1 text")}function hee(e,t,r){const a=wT(t);e[a]=pee(t,r-a.length-1)}function wT(e){for(e.mark();e.readByte()!==cee;);const t=e.offset;e.reset();const r=vT.decode(e.readBytes(t-e.offset-1));return e.skip(1),uee(r),r}function pee(e,t){return vT.decode(e.readBytes(t))}const no={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},Dv={UNKNOWN:-1,DEFLATE:0},QC={UNKNOWN:-1,ADAPTIVE:0},Iv={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Tm={NONE:0,BACKGROUND:1,PREVIOUS:2},Qv={SOURCE:0,OVER:1};class gee extends ky{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(t,r={}){super(t);const{checkCrc:a=!1}=r;this._checkCrc=a,this._inflator=new LC,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Dv.UNKNOWN,this._filterMethod=QC.UNKNOWN,this._interlaceMethod=Iv.UNKNOWN,this._colorType=no.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(IC(this);!this._end;){const t=this.readUint32(),r=this.readChars(4);this.decodeChunk(t,r)}return this.decodeImage(),this._png}decodeApng(){for(IC(this);!this._end;){const t=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(t,r)}return this.decodeApngImage(),this._apng}decodeChunk(t,r){const a=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(t);break;case"IDAT":this.decodeIDAT(t);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(t);break;case"iCCP":this.decodeiCCP(t);break;case Aee:hee(this._png.text,this,t);break;case"pHYs":this.decodepHYs();break;default:this.skip(t);break}if(this.offset-a!==t)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?jC(this,t+4,r):this.skip(4)}decodeApngChunk(t,r){const a=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(t);break;default:this.decodeChunk(t,r),this.offset=a+t;break}if(this.offset-a!==t)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?jC(this,t+4,r):this.skip(4)}decodeIHDR(){const t=this._png;t.width=this.readUint32(),t.height=this.readUint32(),t.depth=mee(this.readUint8());const r=this.readUint8();this._colorType=r;let a;switch(r){case no.GREYSCALE:a=1;break;case no.TRUECOLOUR:a=3;break;case no.INDEXED_COLOUR:a=1;break;case no.GREYSCALE_ALPHA:a=2;break;case no.TRUECOLOUR_ALPHA:a=4;break;case no.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=a,this._compressionMethod=this.readUint8(),this._compressionMethod!==Dv.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const t={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(t)}decodePLTE(t){if(t%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${t}`);const r=t/3;this._hasPalette=!0;const a=[];this._palette=a;for(let n=0;n<r;n++)a.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(t){this._writingDataChunks=!0;const r=t,a=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,a,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodeFDAT(t){this._writingDataChunks=!0;let r=t,a=this.offset+this.byteOffset;if(a+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,a,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodetRNS(t){switch(this._colorType){case no.GREYSCALE:case no.TRUECOLOUR:{if(t%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${t}`);if(t/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${t/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(t/2);for(let r=0;r<t/2;r++)this._transparency[r]=this.readUint16();break}case no.INDEXED_COLOUR:{if(t>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${t} vs ${this._palette.length})`);let r=0;for(;r<t;r++){const a=this.readByte();this._palette[r].push(a)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case no.UNKNOWN:case no.GREYSCALE_ALPHA:case no.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(t){const r=wT(this),a=this.readUint8();if(a!==Dv.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${a}`);const n=this.readBytes(t-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:GZ(n)}}decodepHYs(){const t=this.readUint32(),r=this.readUint32(),a=this.readByte();this._png.resolution={x:t,y:r,unit:a}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let t=0;t<this._numberOfFrames;t++){const r={sequenceNumber:this._frames[t].sequenceNumber,delayNumber:this._frames[t].delayNumber,delayDenominator:this._frames[t].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},a=this._frames.at(t);if(a){if(a.data=DC({data:a.data,width:a.width,height:a.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),t===0||a.xOffset===0&&a.yOffset===0&&a.width===this._png.width&&a.height===this._png.height)r.data=a.data;else{const n=this._apng.frames.at(t-1);this.disposeFrame(a,n,r),this.addFrameDataToCanvas(r,a)}this._apng.frames.push(r)}}return this._apng}disposeFrame(t,r,a){switch(t.disposeOp){case Tm.NONE:break;case Tm.BACKGROUND:for(let n=0;n<this._png.height;n++)for(let s=0;s<this._png.width;s++){const l=(n*t.width+s)*this._png.channels;for(let A=0;A<this._png.channels;A++)a.data[l+A]=0}break;case Tm.PREVIOUS:a.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(t,r){const a=1<<this._png.depth,n=(s,l)=>{const A=((s+r.yOffset)*this._png.width+r.xOffset+l)*this._png.channels,u=(s*r.width+l)*this._png.channels;return{index:A,frameIndex:u}};switch(r.blendOp){case Qv.SOURCE:for(let s=0;s<r.height;s++)for(let l=0;l<r.width;l++){const{index:A,frameIndex:u}=n(s,l);for(let f=0;f<this._png.channels;f++)t.data[A+f]=r.data[u+f]}break;case Qv.OVER:for(let s=0;s<r.height;s++)for(let l=0;l<r.width;l++){const{index:A,frameIndex:u}=n(s,l);for(let f=0;f<this._png.channels;f++){const h=r.data[u+this._png.channels-1]/a,g=f%(this._png.channels-1)===0?1:r.data[u+f],x=Math.floor(h*g+(1-h)*t.data[A+f]);t.data[A+f]+=x}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const t=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==QC.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Iv.NO_INTERLACE)this._png.data=DC({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Iv.ADAM7)this._png.data=tee({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const t=this._inflator.result,r=this._frames.at(-1);r?r.data=t:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Tm.NONE,blendOp:Qv.SOURCE,data:t}),this._inflator=new LC,this._writingDataChunks=!1}}function mee(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var OC;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(OC||(OC={}));function xee(e,t){return new gee(e,t).decode()}var Rr=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function Ov(){Rr.console&&typeof Rr.console.log=="function"&&Rr.console.log.apply(Rr.console,arguments)}var cn={log:Ov,warn:function(e){Rr.console&&(typeof Rr.console.warn=="function"?Rr.console.warn.apply(Rr.console,arguments):Ov.call(null,arguments))},error:function(e){Rr.console&&(typeof Rr.console.error=="function"?Rr.console.error.apply(Rr.console,arguments):Ov(e))}};function Rv(e,t,r){var a=new XMLHttpRequest;a.open("GET",e),a.responseType="blob",a.onload=function(){w0(a.response,t,r)},a.onerror=function(){cn.error("could not download file")},a.send()}function RC(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function Lm(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var w0=Rr.saveAs||((typeof window>"u"?"undefined":za(window))!=="object"||window!==Rr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var a=Rr.URL||Rr.webkitURL,n=document.createElement("a");t=t||e.name||"download",n.download=t,n.rel="noopener",typeof e=="string"?(n.href=e,n.origin!==location.origin?RC(n.href)?Rv(e,t,r):Lm(n,n.target="_blank"):Lm(n)):(n.href=a.createObjectURL(e),setTimeout(function(){a.revokeObjectURL(n.href)},4e4),setTimeout(function(){Lm(n)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(RC(e))Rv(e,t,r);else{var a=document.createElement("a");a.href=e,a.target="_blank",setTimeout(function(){Lm(a)})}else navigator.msSaveOrOpenBlob((function(n,s){return s===void 0?s={autoBom:!1}:za(s)!=="object"&&(cn.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n})(e,r),t)}:function(e,t,r,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),typeof e=="string")return Rv(e,t,r);var n=e.type==="application/octet-stream",s=/constructor/i.test(Rr.HTMLElement)||Rr.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||n&&s)&&(typeof FileReader>"u"?"undefined":za(FileReader))==="object"){var A=new FileReader;A.onloadend=function(){var h=A.result;h=l?h:h.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=h:location=h,a=null},A.readAsDataURL(e)}else{var u=Rr.URL||Rr.webkitURL,f=u.createObjectURL(e);a?a.location=f:location.href=f,a=null,setTimeout(function(){u.revokeObjectURL(f)},4e4)}});function yT(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(A){return[parseInt(A[1]),parseInt(A[2]),parseInt(A[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(A){return[parseInt(A[1],16),parseInt(A[2],16),parseInt(A[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(A){return[parseInt(A[1]+A[1],16),parseInt(A[2]+A[2],16),parseInt(A[3]+A[3],16)]}}],a=0;a<r.length;a++){var n=r[a].re,s=r[a].process,l=n.exec(e);l&&(t=s(l),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var A=this.r.toString(16),u=this.g.toString(16),f=this.b.toString(16);return A.length==1&&(A="0"+A),u.length==1&&(u="0"+u),f.length==1&&(f="0"+f),"#"+A+u+f}}var Km=Rr.atob.bind(Rr),MC=Rr.btoa.bind(Rr);function Mv(e,t){var r=e[0],a=e[1],n=e[2],s=e[3];r=ji(r,a,n,s,t[0],7,-680876936),s=ji(s,r,a,n,t[1],12,-389564586),n=ji(n,s,r,a,t[2],17,606105819),a=ji(a,n,s,r,t[3],22,-1044525330),r=ji(r,a,n,s,t[4],7,-176418897),s=ji(s,r,a,n,t[5],12,1200080426),n=ji(n,s,r,a,t[6],17,-1473231341),a=ji(a,n,s,r,t[7],22,-45705983),r=ji(r,a,n,s,t[8],7,1770035416),s=ji(s,r,a,n,t[9],12,-1958414417),n=ji(n,s,r,a,t[10],17,-42063),a=ji(a,n,s,r,t[11],22,-1990404162),r=ji(r,a,n,s,t[12],7,1804603682),s=ji(s,r,a,n,t[13],12,-40341101),n=ji(n,s,r,a,t[14],17,-1502002290),r=Di(r,a=ji(a,n,s,r,t[15],22,1236535329),n,s,t[1],5,-165796510),s=Di(s,r,a,n,t[6],9,-1069501632),n=Di(n,s,r,a,t[11],14,643717713),a=Di(a,n,s,r,t[0],20,-373897302),r=Di(r,a,n,s,t[5],5,-701558691),s=Di(s,r,a,n,t[10],9,38016083),n=Di(n,s,r,a,t[15],14,-660478335),a=Di(a,n,s,r,t[4],20,-405537848),r=Di(r,a,n,s,t[9],5,568446438),s=Di(s,r,a,n,t[14],9,-1019803690),n=Di(n,s,r,a,t[3],14,-187363961),a=Di(a,n,s,r,t[8],20,1163531501),r=Di(r,a,n,s,t[13],5,-1444681467),s=Di(s,r,a,n,t[2],9,-51403784),n=Di(n,s,r,a,t[7],14,1735328473),r=Ii(r,a=Di(a,n,s,r,t[12],20,-1926607734),n,s,t[5],4,-378558),s=Ii(s,r,a,n,t[8],11,-2022574463),n=Ii(n,s,r,a,t[11],16,1839030562),a=Ii(a,n,s,r,t[14],23,-35309556),r=Ii(r,a,n,s,t[1],4,-1530992060),s=Ii(s,r,a,n,t[4],11,1272893353),n=Ii(n,s,r,a,t[7],16,-155497632),a=Ii(a,n,s,r,t[10],23,-1094730640),r=Ii(r,a,n,s,t[13],4,681279174),s=Ii(s,r,a,n,t[0],11,-358537222),n=Ii(n,s,r,a,t[3],16,-722521979),a=Ii(a,n,s,r,t[6],23,76029189),r=Ii(r,a,n,s,t[9],4,-640364487),s=Ii(s,r,a,n,t[12],11,-421815835),n=Ii(n,s,r,a,t[15],16,530742520),r=Qi(r,a=Ii(a,n,s,r,t[2],23,-995338651),n,s,t[0],6,-198630844),s=Qi(s,r,a,n,t[7],10,1126891415),n=Qi(n,s,r,a,t[14],15,-1416354905),a=Qi(a,n,s,r,t[5],21,-57434055),r=Qi(r,a,n,s,t[12],6,1700485571),s=Qi(s,r,a,n,t[3],10,-1894986606),n=Qi(n,s,r,a,t[10],15,-1051523),a=Qi(a,n,s,r,t[1],21,-2054922799),r=Qi(r,a,n,s,t[8],6,1873313359),s=Qi(s,r,a,n,t[15],10,-30611744),n=Qi(n,s,r,a,t[6],15,-1560198380),a=Qi(a,n,s,r,t[13],21,1309151649),r=Qi(r,a,n,s,t[4],6,-145523070),s=Qi(s,r,a,n,t[11],10,-1120210379),n=Qi(n,s,r,a,t[2],15,718787259),a=Qi(a,n,s,r,t[9],21,-343485551),e[0]=Qu(r,e[0]),e[1]=Qu(a,e[1]),e[2]=Qu(n,e[2]),e[3]=Qu(s,e[3])}function u1(e,t,r,a,n,s){return t=Qu(Qu(t,e),Qu(a,s)),Qu(t<<n|t>>>32-n,r)}function ji(e,t,r,a,n,s,l){return u1(t&r|~t&a,e,t,n,s,l)}function Di(e,t,r,a,n,s,l){return u1(t&a|r&~a,e,t,n,s,l)}function Ii(e,t,r,a,n,s,l){return u1(t^r^a,e,t,n,s,l)}function Qi(e,t,r,a,n,s,l){return u1(r^(t|~a),e,t,n,s,l)}function _T(e){var t,r=e.length,a=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)Mv(a,bee(e.substring(t-64,t)));e=e.substring(t-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)n[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(n[t>>2]|=128<<(t%4<<3),t>55)for(Mv(a,n),t=0;t<16;t++)n[t]=0;return n[14]=8*r,Mv(a,n),a}function bee(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var HC="0123456789abcdef".split("");function vee(e){for(var t="",r=0;r<4;r++)t+=HC[e>>8*r+4&15]+HC[e>>8*r&15];return t}function wee(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function t2(e){return _T(e).map(wee).join("")}var yee=(function(e){for(var t=0;t<e.length;t++)e[t]=vee(e[t]);return e.join("")})(_T("hello"))!="5d41402abc4b2a76b9719d911017c592";function Qu(e,t){if(yee){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}function r2(e,t){var r,a,n,s;if(e!==r){for(var l=(n=e,s=1+(256/e.length|0),new Array(s+1).join(n)),A=[],u=0;u<256;u++)A[u]=u;var f=0;for(u=0;u<256;u++){var h=A[u];f=(f+h+l.charCodeAt(u))%256,A[u]=A[f],A[f]=h}r=e,a=A}else A=a;var g=t.length,x=0,m=0,w="";for(u=0;u<g;u++)m=(m+(h=A[x=(x+1)%256]))%256,A[x]=A[m],A[m]=h,l=A[(A[x]+A[m])%256],w+=String.fromCharCode(t.charCodeAt(u)^l);return w}var PC={print:4,modify:8,copy:16,"annot-forms":32};function $d(e,t,r,a){this.v=1,this.r=2;var n=192;e.forEach(function(A){if(PC.perm!==void 0)throw new Error("Invalid permission: "+A);n+=PC[A]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(t+this.padding).substr(0,32),l=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,l),this.P=-(1+(255^n)),this.encryptionKey=t2(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(a)).substr(0,5),this.U=r2(this.encryptionKey,this.padding)}function Jd(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,a=0;a<r;a++){var n=e.charCodeAt(a);t+=n<33||n===35||n===37||n===40||n===41||n===47||n===60||n===62||n===91||n===93||n===123||n===125||n>126?"#"+("0"+n.toString(16)).slice(-2):e[a]}return t}function KC(e){if(za(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,a,n){if(n=n||!1,typeof r!="string"||typeof a!="function"||typeof n!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var s=Math.random().toString(35);return t[r][s]=[a,!!n],s},this.unsubscribe=function(r){for(var a in t)if(t[a][r])return delete t[a][r],Object.keys(t[a]).length===0&&delete t[a],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var a=Array.prototype.slice.call(arguments,1),n=[];for(var s in t[r]){var l=t[r][s];try{l[0].apply(e,a)}catch(A){Rr.console&&cn.error("jsPDF PubSub Error",A.message,A)}l[1]&&n.push(s)}n.length&&n.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Dx(e){if(!(this instanceof Dx))return new Dx(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function BT(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function B0(e,t,r,a,n){if(!(this instanceof B0))return new B0(e,t,r,a,n);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,BT.call(this,a,n)}function af(e,t,r,a,n){if(!(this instanceof af))return new af(e,t,r,a,n);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,BT.call(this,a,n)}function gr(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",a=arguments[1],n=arguments[2],s=arguments[3],l=[],A=1,u=16,f="S",h=null;za(e=e||{})==="object"&&(r=e.orientation,a=e.unit||a,n=e.format||n,s=e.compress||e.compressPdf||s,(h=e.encryption||null)!==null&&(h.userPassword=h.userPassword||"",h.ownerPassword=h.ownerPassword||"",h.userPermissions=h.userPermissions||[]),A=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(u=e.floatPrecision),f=e.defaultPathOperation||"S"),l=e.filters||(s===!0?["FlateEncode"]:l),a=a||"mm",r=(""+(r||"P")).toLowerCase();var g=e.putOnlyUsedFonts||!1,x={},m={internal:{},__private__:{}};m.__private__.PubSub=KC;var w="1.3",v=m.__private__.getPdfVersion=function(){return w};m.__private__.setPdfVersion=function(E){w=E};var B={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};m.__private__.getPageFormats=function(){return B};var k=m.__private__.getPageFormat=function(E){return B[E]};n=n||"a4";var N="compat",S="advanced",O=N;function T(){this.saveGraphicsState(),J(new Nt(ht,0,0,-ht,0,Wl()*ht).toString()+" cm"),this.setFontSize(this.getFontSize()/ht),f="n",O=S}function U(){this.restoreGraphicsState(),f="S",O=N}var D=m.__private__.combineFontStyleAndFontWeight=function(E,ee){if(E=="bold"&&ee=="normal"||E=="bold"&&ee==400||E=="normal"&&ee=="italic"||E=="bold"&&ee=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return ee&&(E=ee==400||ee==="normal"?E==="italic"?"italic":"normal":ee!=700&&ee!=="bold"||E!=="normal"?(ee==700?"bold":ee)+""+E:"bold"),E};m.advancedAPI=function(E){var ee=O===N;return ee&&T.call(this),typeof E!="function"||(E(this),ee&&U.call(this)),this},m.compatAPI=function(E){var ee=O===S;return ee&&U.call(this),typeof E!="function"||(E(this),ee&&T.call(this)),this},m.isAdvancedAPI=function(){return O===S};var H,j=function(E){if(O!==S)throw new Error(E+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},W=m.roundToPrecision=m.__private__.roundToPrecision=function(E,ee){var Be=t||ee;if(isNaN(E)||isNaN(Be))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return E.toFixed(Be).replace(/0+$/,"")};H=m.hpf=m.__private__.hpf=typeof u=="number"?function(E){if(isNaN(E))throw new Error("Invalid argument passed to jsPDF.hpf");return W(E,u)}:u==="smart"?function(E){if(isNaN(E))throw new Error("Invalid argument passed to jsPDF.hpf");return W(E,E>-1&&E<1?16:5)}:function(E){if(isNaN(E))throw new Error("Invalid argument passed to jsPDF.hpf");return W(E,16)};var I=m.f2=m.__private__.f2=function(E){if(isNaN(E))throw new Error("Invalid argument passed to jsPDF.f2");return W(E,2)},Q=m.__private__.f3=function(E){if(isNaN(E))throw new Error("Invalid argument passed to jsPDF.f3");return W(E,3)},Y=m.scale=m.__private__.scale=function(E){if(isNaN(E))throw new Error("Invalid argument passed to jsPDF.scale");return O===N?E*ht:O===S?E:void 0},z=function(E){return Y((function(ee){return O===N?Wl()-ee:O===S?ee:void 0})(E))};m.__private__.setPrecision=m.setPrecision=function(E){typeof parseInt(E,10)=="number"&&(t=parseInt(E,10))};var ue,Z="00000000000000000000000000000000",Ae=m.__private__.getFileId=function(){return Z},ve=m.__private__.setFileId=function(E){return Z=E!==void 0&&/^[a-fA-F0-9]{32}$/.test(E)?E.toUpperCase():Z.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),h!==null&&(Fa=new $d(h.userPermissions,h.userPassword,h.ownerPassword,Z)),Z};m.setFileId=function(E){return ve(E),this},m.getFileId=function(){return Ae()};var G=m.__private__.convertDateToPDFDate=function(E){var ee=E.getTimezoneOffset(),Be=ee<0?"+":"-",Ne=Math.floor(Math.abs(ee/60)),Ke=Math.abs(ee%60),At=[Be,M(Ne),"'",M(Ke),"'"].join("");return["D:",E.getFullYear(),M(E.getMonth()+1),M(E.getDate()),M(E.getHours()),M(E.getMinutes()),M(E.getSeconds()),At].join("")},Se=m.__private__.convertPDFDateToDate=function(E){var ee=parseInt(E.substr(2,4),10),Be=parseInt(E.substr(6,2),10)-1,Ne=parseInt(E.substr(8,2),10),Ke=parseInt(E.substr(10,2),10),At=parseInt(E.substr(12,2),10),wt=parseInt(E.substr(14,2),10);return new Date(ee,Be,Ne,Ke,At,wt,0)},we=m.__private__.setCreationDate=function(E){var ee;if(E===void 0&&(E=new Date),E instanceof Date)ee=G(E);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(E))throw new Error("Invalid argument passed to jsPDF.setCreationDate");ee=E}return ue=ee},F=m.__private__.getCreationDate=function(E){var ee=ue;return E==="jsDate"&&(ee=Se(ue)),ee};m.setCreationDate=function(E){return we(E),this},m.getCreationDate=function(E){return F(E)};var R,M=m.__private__.padd2=function(E){return("0"+parseInt(E)).slice(-2)},P=m.__private__.padd2Hex=function(E){return("00"+(E=E.toString())).substr(E.length)},re=0,ge=[],Ce=[],de=0,be=[],Le=[],ie=!1,_e=Ce;m.__private__.setCustomOutputDestination=function(E){ie=!0,_e=E};var je=function(E){ie||(_e=E)};m.__private__.resetCustomOutputDestination=function(){ie=!1,_e=Ce};var J=m.__private__.out=function(E){return E=E.toString(),de+=E.length+1,_e.push(E),_e},ze=m.__private__.write=function(E){return J(arguments.length===1?E.toString():Array.prototype.join.call(arguments," "))},He=m.__private__.getArrayBuffer=function(E){for(var ee=E.length,Be=new ArrayBuffer(ee),Ne=new Uint8Array(Be);ee--;)Ne[ee]=E.charCodeAt(ee);return Be},ct=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];m.__private__.getStandardFonts=function(){return ct};var Xe=e.fontSize||16;m.__private__.setFontSize=m.setFontSize=function(E){return Xe=O===S?E/ht:E,this};var Ut,yt=m.__private__.getFontSize=m.getFontSize=function(){return O===N?Xe:Xe*ht},qt=e.R2L||!1;m.__private__.setR2L=m.setR2L=function(E){return qt=E,this},m.__private__.getR2L=m.getR2L=function(){return qt};var Lt,jt=m.__private__.setZoomMode=function(E){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(E))Ut=E;else if(isNaN(E)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(E)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+E+'" is not recognized.');Ut=E}else Ut=parseInt(E,10)};m.__private__.getZoomMode=function(){return Ut};var Pt,zt=m.__private__.setPageMode=function(E){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(E)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+E+'" is not recognized.');Lt=E};m.__private__.getPageMode=function(){return Lt};var Jt=m.__private__.setLayoutMode=function(E){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(E)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+E+'" is not recognized.');Pt=E};m.__private__.getLayoutMode=function(){return Pt},m.__private__.setDisplayMode=m.setDisplayMode=function(E,ee,Be){return jt(E),Jt(ee),zt(Be),this};var It={title:"",subject:"",author:"",keywords:"",creator:""};m.__private__.getDocumentProperty=function(E){if(Object.keys(It).indexOf(E)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return It[E]},m.__private__.getDocumentProperties=function(){return It},m.__private__.setDocumentProperties=m.setProperties=m.setDocumentProperties=function(E){for(var ee in It)It.hasOwnProperty(ee)&&E[ee]&&(It[ee]=E[ee]);return this},m.__private__.setDocumentProperty=function(E,ee){if(Object.keys(It).indexOf(E)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return It[E]=ee};var xt,ht,Bt,pr,$t,Ee={},at={},it=[],bt={},Et={},mt={},Ot={},Ur=null,Vt=0,tt=[],Wt=new KC(m),Me=e.hotfixes||[],kt={},Tt={},ir=[],Nt=function E(ee,Be,Ne,Ke,At,wt){if(!(this instanceof E))return new E(ee,Be,Ne,Ke,At,wt);isNaN(ee)&&(ee=1),isNaN(Be)&&(Be=0),isNaN(Ne)&&(Ne=0),isNaN(Ke)&&(Ke=1),isNaN(At)&&(At=0),isNaN(wt)&&(wt=0),this._matrix=[ee,Be,Ne,Ke,At,wt]};Object.defineProperty(Nt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(E){this._matrix[0]=E}}),Object.defineProperty(Nt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(E){this._matrix[1]=E}}),Object.defineProperty(Nt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(E){this._matrix[2]=E}}),Object.defineProperty(Nt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(E){this._matrix[3]=E}}),Object.defineProperty(Nt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(E){this._matrix[4]=E}}),Object.defineProperty(Nt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(E){this._matrix[5]=E}}),Object.defineProperty(Nt.prototype,"a",{get:function(){return this._matrix[0]},set:function(E){this._matrix[0]=E}}),Object.defineProperty(Nt.prototype,"b",{get:function(){return this._matrix[1]},set:function(E){this._matrix[1]=E}}),Object.defineProperty(Nt.prototype,"c",{get:function(){return this._matrix[2]},set:function(E){this._matrix[2]=E}}),Object.defineProperty(Nt.prototype,"d",{get:function(){return this._matrix[3]},set:function(E){this._matrix[3]=E}}),Object.defineProperty(Nt.prototype,"e",{get:function(){return this._matrix[4]},set:function(E){this._matrix[4]=E}}),Object.defineProperty(Nt.prototype,"f",{get:function(){return this._matrix[5]},set:function(E){this._matrix[5]=E}}),Object.defineProperty(Nt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Nt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Nt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Nt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Nt.prototype.join=function(E){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(H).join(E)},Nt.prototype.multiply=function(E){var ee=E.sx*this.sx+E.shy*this.shx,Be=E.sx*this.shy+E.shy*this.sy,Ne=E.shx*this.sx+E.sy*this.shx,Ke=E.shx*this.shy+E.sy*this.sy,At=E.tx*this.sx+E.ty*this.shx+this.tx,wt=E.tx*this.shy+E.ty*this.sy+this.ty;return new Nt(ee,Be,Ne,Ke,At,wt)},Nt.prototype.decompose=function(){var E=this.sx,ee=this.shy,Be=this.shx,Ne=this.sy,Ke=this.tx,At=this.ty,wt=Math.sqrt(E*E+ee*ee),tr=(E/=wt)*Be+(ee/=wt)*Ne;Be-=E*tr,Ne-=ee*tr;var Ar=Math.sqrt(Be*Be+Ne*Ne);return tr/=Ar,E*(Ne/=Ar)<ee*(Be/=Ar)&&(E=-E,ee=-ee,tr=-tr,wt=-wt),{scale:new Nt(wt,0,0,Ar,0,0),translate:new Nt(1,0,0,1,Ke,At),rotate:new Nt(E,ee,-ee,E,0,0),skew:new Nt(1,0,tr,1,0,0)}},Nt.prototype.toString=function(E){return this.join(" ")},Nt.prototype.inversed=function(){var E=this.sx,ee=this.shy,Be=this.shx,Ne=this.sy,Ke=this.tx,At=this.ty,wt=1/(E*Ne-ee*Be),tr=Ne*wt,Ar=-ee*wt,kr=-Be*wt,Dr=E*wt;return new Nt(tr,Ar,kr,Dr,-tr*Ke-kr*At,-Ar*Ke-Dr*At)},Nt.prototype.applyToPoint=function(E){var ee=E.x*this.sx+E.y*this.shx+this.tx,Be=E.x*this.shy+E.y*this.sy+this.ty;return new Ai(ee,Be)},Nt.prototype.applyToRectangle=function(E){var ee=this.applyToPoint(E),Be=this.applyToPoint(new Ai(E.x+E.w,E.y+E.h));return new cl(ee.x,ee.y,Be.x-ee.x,Be.y-ee.y)},Nt.prototype.clone=function(){var E=this.sx,ee=this.shy,Be=this.shx,Ne=this.sy,Ke=this.tx,At=this.ty;return new Nt(E,ee,Be,Ne,Ke,At)},m.Matrix=Nt;var Sr=m.matrixMult=function(E,ee){return ee.multiply(E)},ca=new Nt(1,0,0,1,0,0);m.unitMatrix=m.identityMatrix=ca;var Hr=function(E,ee){if(!Et[E]){var Be=(ee instanceof B0?"Sh":"P")+(Object.keys(bt).length+1).toString(10);ee.id=Be,Et[E]=Be,bt[Be]=ee,Wt.publish("addPattern",ee)}};m.ShadingPattern=B0,m.TilingPattern=af,m.addShadingPattern=function(E,ee){return j("addShadingPattern()"),Hr(E,ee),this},m.beginTilingPattern=function(E){j("beginTilingPattern()"),mo(E.boundingBox[0],E.boundingBox[1],E.boundingBox[2]-E.boundingBox[0],E.boundingBox[3]-E.boundingBox[1],E.matrix)},m.endTilingPattern=function(E,ee){j("endTilingPattern()"),ee.stream=Le[R].join(`
`),Hr(E,ee),Wt.publish("endTilingPattern",ee),ir.pop().restore()};var Br,jr=m.__private__.newObject=function(){var E=Er();return ae(E,!0),E},Er=m.__private__.newObjectDeferred=function(){return re++,ge[re]=function(){return de},re},ae=function(E,ee){return ee=typeof ee=="boolean"&&ee,ge[E]=de,ee&&J(E+" 0 obj"),E},xe=m.__private__.newAdditionalObject=function(){var E={objId:Er(),content:""};return be.push(E),E},fe=Er(),pe=Er(),K=m.__private__.decodeColorString=function(E){var ee=E.split(" ");if(ee.length!==2||ee[1]!=="g"&&ee[1]!=="G")ee.length!==5||ee[4]!=="k"&&ee[4]!=="K"||(ee=[(1-ee[0])*(1-ee[3]),(1-ee[1])*(1-ee[3]),(1-ee[2])*(1-ee[3]),"r"]);else{var Be=parseFloat(ee[0]);ee=[Be,Be,Be,"r"]}for(var Ne="#",Ke=0;Ke<3;Ke++)Ne+=("0"+Math.floor(255*parseFloat(ee[Ke])).toString(16)).slice(-2);return Ne},se=m.__private__.encodeColorString=function(E){var ee;typeof E=="string"&&(E={ch1:E});var Be=E.ch1,Ne=E.ch2,Ke=E.ch3,At=E.ch4,wt=E.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Be=="string"&&Be.charAt(0)!=="#"){var tr=new yT(Be);if(tr.ok)Be=tr.toHex();else if(!/^\d*\.?\d*$/.test(Be))throw new Error('Invalid color "'+Be+'" passed to jsPDF.encodeColorString.')}if(typeof Be=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Be)&&(Be="#"+Be[1]+Be[1]+Be[2]+Be[2]+Be[3]+Be[3]),typeof Be=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Be)){var Ar=parseInt(Be.substr(1),16);Be=Ar>>16&255,Ne=Ar>>8&255,Ke=255&Ar}if(Ne===void 0||At===void 0&&Be===Ne&&Ne===Ke)ee=typeof Be=="string"?Be+" "+wt[0]:E.precision===2?I(Be/255)+" "+wt[0]:Q(Be/255)+" "+wt[0];else if(At===void 0||za(At)==="object"){if(At&&!isNaN(At.a)&&At.a===0)return["1.","1.","1.",wt[1]].join(" ");ee=typeof Be=="string"?[Be,Ne,Ke,wt[1]].join(" "):E.precision===2?[I(Be/255),I(Ne/255),I(Ke/255),wt[1]].join(" "):[Q(Be/255),Q(Ne/255),Q(Ke/255),wt[1]].join(" ")}else ee=typeof Be=="string"?[Be,Ne,Ke,At,wt[2]].join(" "):E.precision===2?[I(Be),I(Ne),I(Ke),I(At),wt[2]].join(" "):[Q(Be),Q(Ne),Q(Ke),Q(At),wt[2]].join(" ");return ee},Fe=m.__private__.getFilters=function(){return l},Re=m.__private__.putStream=function(E){var ee=(E=E||{}).data||"",Be=E.filters||Fe(),Ne=E.alreadyAppliedFilters||[],Ke=E.addLength1||!1,At=ee.length,wt=E.objectId,tr=function(pn){return pn};if(h!==null&&wt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");h!==null&&(tr=Fa.encryptor(wt,0));var Ar={};Be===!0&&(Be=["FlateEncode"]);var kr=E.additionalKeyValues||[],Dr=(Ar=gr.API.processDataByFilters!==void 0?gr.API.processDataByFilters(ee,Be):{data:ee,reverseChain:[]}).reverseChain+(Array.isArray(Ne)?Ne.join(" "):Ne.toString());if(Ar.data.length!==0&&(kr.push({key:"Length",value:Ar.data.length}),Ke===!0&&kr.push({key:"Length1",value:At})),Dr.length!=0)if(Dr.split("/").length-1==1)kr.push({key:"Filter",value:Dr});else{kr.push({key:"Filter",value:"["+Dr+"]"});for(var ea=0;ea<kr.length;ea+=1)if(kr[ea].key==="DecodeParms"){for(var nn=[],un=0;un<Ar.reverseChain.split("/").length-1;un+=1)nn.push("null");nn.push(kr[ea].value),kr[ea].value="["+nn.join(" ")+"]"}}J("<<");for(var La=0;La<kr.length;La++)J("/"+kr[La].key+" "+kr[La].value);J(">>"),Ar.data.length!==0&&(J("stream"),J(tr(Ar.data)),J("endstream"))},Qe=m.__private__.putPage=function(E){var ee=E.number,Be=E.data,Ne=E.objId,Ke=E.contentsObjId;ae(Ne,!0),J("<</Type /Page"),J("/Parent "+E.rootDictionaryObjId+" 0 R"),J("/Resources "+E.resourceDictionaryObjId+" 0 R"),J("/MediaBox ["+parseFloat(H(E.mediaBox.bottomLeftX))+" "+parseFloat(H(E.mediaBox.bottomLeftY))+" "+H(E.mediaBox.topRightX)+" "+H(E.mediaBox.topRightY)+"]"),E.cropBox!==null&&J("/CropBox ["+H(E.cropBox.bottomLeftX)+" "+H(E.cropBox.bottomLeftY)+" "+H(E.cropBox.topRightX)+" "+H(E.cropBox.topRightY)+"]"),E.bleedBox!==null&&J("/BleedBox ["+H(E.bleedBox.bottomLeftX)+" "+H(E.bleedBox.bottomLeftY)+" "+H(E.bleedBox.topRightX)+" "+H(E.bleedBox.topRightY)+"]"),E.trimBox!==null&&J("/TrimBox ["+H(E.trimBox.bottomLeftX)+" "+H(E.trimBox.bottomLeftY)+" "+H(E.trimBox.topRightX)+" "+H(E.trimBox.topRightY)+"]"),E.artBox!==null&&J("/ArtBox ["+H(E.artBox.bottomLeftX)+" "+H(E.artBox.bottomLeftY)+" "+H(E.artBox.topRightX)+" "+H(E.artBox.topRightY)+"]"),typeof E.userUnit=="number"&&E.userUnit!==1&&J("/UserUnit "+E.userUnit),Wt.publish("putPage",{objId:Ne,pageContext:tt[ee],pageNumber:ee,page:Be}),J("/Contents "+Ke+" 0 R"),J(">>"),J("endobj");var At=Be.join(`
`);return O===S&&(At+=`
Q`),ae(Ke,!0),Re({data:At,filters:Fe(),objectId:Ke}),J("endobj"),Ne},Pe=m.__private__.putPages=function(){var E,ee,Be=[];for(E=1;E<=Vt;E++)tt[E].objId=Er(),tt[E].contentsObjId=Er();for(E=1;E<=Vt;E++)Be.push(Qe({number:E,data:Le[E],objId:tt[E].objId,contentsObjId:tt[E].contentsObjId,mediaBox:tt[E].mediaBox,cropBox:tt[E].cropBox,bleedBox:tt[E].bleedBox,trimBox:tt[E].trimBox,artBox:tt[E].artBox,userUnit:tt[E].userUnit,rootDictionaryObjId:fe,resourceDictionaryObjId:pe}));ae(fe,!0),J("<</Type /Pages");var Ne="/Kids [";for(ee=0;ee<Vt;ee++)Ne+=Be[ee]+" 0 R ";J(Ne+"]"),J("/Count "+Vt),J(">>"),J("endobj"),Wt.publish("postPutPages")},qe=function(E){Wt.publish("putFont",{font:E,out:J,newObject:jr,putStream:Re}),E.isAlreadyPutted!==!0&&(E.objectNumber=jr(),J("<<"),J("/Type /Font"),J("/BaseFont /"+Jd(E.postScriptName)),J("/Subtype /Type1"),typeof E.encoding=="string"&&J("/Encoding /"+E.encoding),J("/FirstChar 32"),J("/LastChar 255"),J(">>"),J("endobj"))},pt=function(E){E.objectNumber=jr();var ee=[];ee.push({key:"Type",value:"/XObject"}),ee.push({key:"Subtype",value:"/Form"}),ee.push({key:"BBox",value:"["+[H(E.x),H(E.y),H(E.x+E.width),H(E.y+E.height)].join(" ")+"]"}),ee.push({key:"Matrix",value:"["+E.matrix.toString()+"]"});var Be=E.pages[1].join(`
`);Re({data:Be,additionalKeyValues:ee,objectId:E.objectNumber}),J("endobj")},et=function(E,ee){ee||(ee=21);var Be=jr(),Ne=(function(wt,tr){var Ar,kr=[],Dr=1/(tr-1);for(Ar=0;Ar<1;Ar+=Dr)kr.push(Ar);if(kr.push(1),wt[0].offset!=0){var ea={offset:0,color:wt[0].color};wt.unshift(ea)}if(wt[wt.length-1].offset!=1){var nn={offset:1,color:wt[wt.length-1].color};wt.push(nn)}for(var un="",La=0,pn=0;pn<kr.length;pn++){for(Ar=kr[pn];Ar>wt[La+1].offset;)La++;var Cn=wt[La].offset,ss=(Ar-Cn)/(wt[La+1].offset-Cn),fl=wt[La].color,Ji=wt[La+1].color;un+=P(Math.round((1-ss)*fl[0]+ss*Ji[0]).toString(16))+P(Math.round((1-ss)*fl[1]+ss*Ji[1]).toString(16))+P(Math.round((1-ss)*fl[2]+ss*Ji[2]).toString(16))}return un.trim()})(E.colors,ee),Ke=[];Ke.push({key:"FunctionType",value:"0"}),Ke.push({key:"Domain",value:"[0.0 1.0]"}),Ke.push({key:"Size",value:"["+ee+"]"}),Ke.push({key:"BitsPerSample",value:"8"}),Ke.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ke.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Re({data:Ne,additionalKeyValues:Ke,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Be}),J("endobj"),E.objectNumber=jr(),J("<< /ShadingType "+E.type),J("/ColorSpace /DeviceRGB");var At="/Coords ["+H(parseFloat(E.coords[0]))+" "+H(parseFloat(E.coords[1]))+" ";E.type===2?At+=H(parseFloat(E.coords[2]))+" "+H(parseFloat(E.coords[3])):At+=H(parseFloat(E.coords[2]))+" "+H(parseFloat(E.coords[3]))+" "+H(parseFloat(E.coords[4]))+" "+H(parseFloat(E.coords[5])),J(At+="]"),E.matrix&&J("/Matrix ["+E.matrix.toString()+"]"),J("/Function "+Be+" 0 R"),J("/Extend [true true]"),J(">>"),J("endobj")},Rt=function(E,ee){var Be=Er(),Ne=jr();ee.push({resourcesOid:Be,objectOid:Ne}),E.objectNumber=Ne;var Ke=[];Ke.push({key:"Type",value:"/Pattern"}),Ke.push({key:"PatternType",value:"1"}),Ke.push({key:"PaintType",value:"1"}),Ke.push({key:"TilingType",value:"1"}),Ke.push({key:"BBox",value:"["+E.boundingBox.map(H).join(" ")+"]"}),Ke.push({key:"XStep",value:H(E.xStep)}),Ke.push({key:"YStep",value:H(E.yStep)}),Ke.push({key:"Resources",value:Be+" 0 R"}),E.matrix&&Ke.push({key:"Matrix",value:"["+E.matrix.toString()+"]"}),Re({data:E.stream,additionalKeyValues:Ke,objectId:E.objectNumber}),J("endobj")},Ct=function(E){for(var ee in E.objectNumber=jr(),J("<<"),E)switch(ee){case"opacity":J("/ca "+I(E[ee]));break;case"stroke-opacity":J("/CA "+I(E[ee]))}J(">>"),J("endobj")},Qt=function(E){ae(E.resourcesOid,!0),J("<<"),J("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var ee in J("/Font <<"),Ee)Ee.hasOwnProperty(ee)&&(g===!1||g===!0&&x.hasOwnProperty(ee))&&J("/"+ee+" "+Ee[ee].objectNumber+" 0 R");J(">>")})(),(function(){if(Object.keys(bt).length>0){for(var ee in J("/Shading <<"),bt)bt.hasOwnProperty(ee)&&bt[ee]instanceof B0&&bt[ee].objectNumber>=0&&J("/"+ee+" "+bt[ee].objectNumber+" 0 R");Wt.publish("putShadingPatternDict"),J(">>")}})(),(function(ee){if(Object.keys(bt).length>0){for(var Be in J("/Pattern <<"),bt)bt.hasOwnProperty(Be)&&bt[Be]instanceof m.TilingPattern&&bt[Be].objectNumber>=0&&bt[Be].objectNumber<ee&&J("/"+Be+" "+bt[Be].objectNumber+" 0 R");Wt.publish("putTilingPatternDict"),J(">>")}})(E.objectOid),(function(){if(Object.keys(mt).length>0){var ee;for(ee in J("/ExtGState <<"),mt)mt.hasOwnProperty(ee)&&mt[ee].objectNumber>=0&&J("/"+ee+" "+mt[ee].objectNumber+" 0 R");Wt.publish("putGStateDict"),J(">>")}})(),(function(){for(var ee in J("/XObject <<"),kt)kt.hasOwnProperty(ee)&&kt[ee].objectNumber>=0&&J("/"+ee+" "+kt[ee].objectNumber+" 0 R");Wt.publish("putXobjectDict"),J(">>")})(),J(">>"),J("endobj")},Gt=function(E){at[E.fontName]=at[E.fontName]||{},at[E.fontName][E.fontStyle]=E.id},wa=function(E,ee,Be,Ne,Ke){var At={id:"F"+(Object.keys(Ee).length+1).toString(10),postScriptName:E,fontName:ee,fontStyle:Be,encoding:Ne,isStandardFont:Ke||!1,metadata:{}};return Wt.publish("addFont",{font:At,instance:this}),Ee[At.id]=At,Gt(At),At.id},Pr=m.__private__.pdfEscape=m.pdfEscape=function(E,ee){return(function(Be,Ne){var Ke,At,wt,tr,Ar,kr,Dr,ea,nn;if(wt=(Ne=Ne||{}).sourceEncoding||"Unicode",Ar=Ne.outputEncoding,(Ne.autoencode||Ar)&&Ee[xt].metadata&&Ee[xt].metadata[wt]&&Ee[xt].metadata[wt].encoding&&(tr=Ee[xt].metadata[wt].encoding,!Ar&&Ee[xt].encoding&&(Ar=Ee[xt].encoding),!Ar&&tr.codePages&&(Ar=tr.codePages[0]),typeof Ar=="string"&&(Ar=tr[Ar]),Ar)){for(Dr=!1,kr=[],Ke=0,At=Be.length;Ke<At;Ke++)(ea=Ar[Be.charCodeAt(Ke)])?kr.push(String.fromCharCode(ea)):kr.push(Be[Ke]),kr[Ke].charCodeAt(0)>>8&&(Dr=!0);Be=kr.join("")}for(Ke=Be.length;Dr===void 0&&Ke!==0;)Be.charCodeAt(Ke-1)>>8&&(Dr=!0),Ke--;if(!Dr)return Be;for(kr=Ne.noBOM?[]:[254,255],Ke=0,At=Be.length;Ke<At;Ke++){if((nn=(ea=Be.charCodeAt(Ke))>>8)>>8)throw new Error("Character at position "+Ke+" of string '"+Be+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");kr.push(nn),kr.push(ea-(nn<<8))}return String.fromCharCode.apply(void 0,kr)})(E,ee).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},sa=m.__private__.beginPage=function(E){Le[++Vt]=[],tt[Vt]={objId:0,contentsObjId:0,userUnit:Number(A),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(E[0]),topRightY:Number(E[1])}},Wi(Vt),je(Le[R])},vs=function(E,ee){var Be,Ne,Ke;switch(r=ee||r,typeof E=="string"&&(Be=k(E.toLowerCase()),Array.isArray(Be)&&(Ne=Be[0],Ke=Be[1])),Array.isArray(E)&&(Ne=E[0]*ht,Ke=E[1]*ht),isNaN(Ne)&&(Ne=n[0],Ke=n[1]),(Ne>14400||Ke>14400)&&(cn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Ne=Math.min(14400,Ne),Ke=Math.min(14400,Ke)),n=[Ne,Ke],r.substr(0,1)){case"l":Ke>Ne&&(n=[Ke,Ne]);break;case"p":Ne>Ke&&(n=[Ke,Ne])}sa(n),_r(_s),J(Bs),wA!==0&&J(wA+" J"),zn!==0&&J(zn+" j"),Wt.publish("addPage",{pageNumber:Vt})},Bi=function(E){E>0&&E<=Vt&&(Le.splice(E,1),tt.splice(E,1),Vt--,R>Vt&&(R=Vt),this.setPage(R))},Wi=function(E){E>0&&E<=Vt&&(R=E)},rn=m.__private__.getNumberOfPages=m.getNumberOfPages=function(){return Le.length-1},ki=function(E,ee,Be){var Ne,Ke=void 0;return Be=Be||{},E=E!==void 0?E:Ee[xt].fontName,ee=ee!==void 0?ee:Ee[xt].fontStyle,Ne=E.toLowerCase(),at[Ne]!==void 0&&at[Ne][ee]!==void 0?Ke=at[Ne][ee]:at[E]!==void 0&&at[E][ee]!==void 0?Ke=at[E][ee]:Be.disableWarning===!1&&cn.warn("Unable to look up font label for font '"+E+"', '"+ee+"'. Refer to getFontList() for available fonts."),Ke||Be.noFallback||(Ke=at.times[ee])==null&&(Ke=at.times.normal),Ke},Ca=m.__private__.putInfo=function(){var E=jr(),ee=function(Ne){return Ne};for(var Be in h!==null&&(ee=Fa.encryptor(E,0)),J("<<"),J("/Producer ("+Pr(ee("jsPDF "+gr.version))+")"),It)It.hasOwnProperty(Be)&&It[Be]&&J("/"+Be.substr(0,1).toUpperCase()+Be.substr(1)+" ("+Pr(ee(It[Be]))+")");J("/CreationDate ("+Pr(ee(ue))+")"),J(">>"),J("endobj")},Vs=m.__private__.putCatalog=function(E){var ee=(E=E||{}).rootDictionaryObjId||fe;switch(jr(),J("<<"),J("/Type /Catalog"),J("/Pages "+ee+" 0 R"),Ut||(Ut="fullwidth"),Ut){case"fullwidth":J("/OpenAction [3 0 R /FitH null]");break;case"fullheight":J("/OpenAction [3 0 R /FitV null]");break;case"fullpage":J("/OpenAction [3 0 R /Fit]");break;case"original":J("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Be=""+Ut;Be.substr(Be.length-1)==="%"&&(Ut=parseInt(Ut)/100),typeof Ut=="number"&&J("/OpenAction [3 0 R /XYZ null null "+I(Ut)+"]")}switch(Pt||(Pt="continuous"),Pt){case"continuous":J("/PageLayout /OneColumn");break;case"single":J("/PageLayout /SinglePage");break;case"two":case"twoleft":J("/PageLayout /TwoColumnLeft");break;case"tworight":J("/PageLayout /TwoColumnRight")}Lt&&J("/PageMode /"+Lt),Wt.publish("putCatalog"),J(">>"),J("endobj")},ii=m.__private__.putTrailer=function(){J("trailer"),J("<<"),J("/Size "+(re+1)),J("/Root "+re+" 0 R"),J("/Info "+(re-1)+" 0 R"),h!==null&&J("/Encrypt "+Fa.oid+" 0 R"),J("/ID [ <"+Z+"> <"+Z+"> ]"),J(">>")},ia=m.__private__.putHeader=function(){J("%PDF-"+w),J("%")},li=m.__private__.putXRef=function(){var E="0000000000";J("xref"),J("0 "+(re+1)),J("0000000000 65535 f ");for(var ee=1;ee<=re;ee++)typeof ge[ee]=="function"?J((E+ge[ee]()).slice(-10)+" 00000 n "):ge[ee]!==void 0?J((E+ge[ee]).slice(-10)+" 00000 n "):J("0000000000 00000 n ")},Xi=m.__private__.buildDocument=function(){var E;re=0,de=0,Ce=[],ge=[],be=[],fe=Er(),pe=Er(),je(Ce),Wt.publish("buildDocument"),ia(),Pe(),(function(){Wt.publish("putAdditionalObjects");for(var Be=0;Be<be.length;Be++){var Ne=be[Be];ae(Ne.objId,!0),J(Ne.content),J("endobj")}Wt.publish("postPutAdditionalObjects")})(),E=[],(function(){for(var Be in Ee)Ee.hasOwnProperty(Be)&&(g===!1||g===!0&&x.hasOwnProperty(Be))&&qe(Ee[Be])})(),(function(){var Be;for(Be in mt)mt.hasOwnProperty(Be)&&Ct(mt[Be])})(),(function(){for(var Be in kt)kt.hasOwnProperty(Be)&&pt(kt[Be])})(),(function(Be){var Ne;for(Ne in bt)bt.hasOwnProperty(Ne)&&(bt[Ne]instanceof B0?et(bt[Ne]):bt[Ne]instanceof af&&Rt(bt[Ne],Be))})(E),Wt.publish("putResources"),E.forEach(Qt),Qt({resourcesOid:pe,objectOid:Number.MAX_SAFE_INTEGER}),Wt.publish("postPutResources"),h!==null&&(Fa.oid=jr(),J("<<"),J("/Filter /Standard"),J("/V "+Fa.v),J("/R "+Fa.r),J("/U <"+Fa.toHexString(Fa.U)+">"),J("/O <"+Fa.toHexString(Fa.O)+">"),J("/P "+Fa.P),J(">>"),J("endobj")),Ca(),Vs();var ee=de;return li(),ii(),J("startxref"),J(""+ee),J("%%EOF"),je(Le[R]),Ce.join(`
`)},Pl=m.__private__.getBlob=function(E){return new Blob([He(E)],{type:"application/pdf"})},Ko=m.output=m.__private__.output=(Br=function(E,ee){switch(typeof(ee=ee||{})=="string"?ee={filename:ee}:ee.filename=ee.filename||"generated.pdf",E){case void 0:return Xi();case"save":m.save(ee.filename);break;case"arraybuffer":return He(Xi());case"blob":return Pl(Xi());case"bloburi":case"bloburl":if(Rr.URL!==void 0&&typeof Rr.URL.createObjectURL=="function")return Rr.URL&&Rr.URL.createObjectURL(Pl(Xi()))||void 0;cn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Be="",Ne=Xi();try{Be=MC(Ne)}catch{Be=MC(unescape(encodeURIComponent(Ne)))}return"data:application/pdf;filename="+ee.filename+";base64,"+Be;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Rr)==="[object Window]"){var Ke="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",At=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';ee.pdfObjectUrl&&(Ke=ee.pdfObjectUrl,At="");var wt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ke+'"'+At+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(ee)+");<\/script></body></html>",tr=Rr.open();return tr!==null&&tr.document.write(wt),tr}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Rr)==="[object Window]"){var Ar='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(ee.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+ee.filename+'" width="500px" height="400px" /></body></html>',kr=Rr.open();if(kr!==null){kr.document.write(Ar);var Dr=this;kr.document.documentElement.querySelector("#pdfViewer").onload=function(){kr.document.title=ee.filename,kr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Dr.output("bloburl"))}}return kr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Rr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var ea='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",ee)+'"></iframe></body></html>',nn=Rr.open();if(nn!==null&&(nn.document.write(ea),nn.document.title=ee.filename),nn||typeof safari>"u")return nn;break;case"datauri":case"dataurl":return Rr.document.location.href=this.output("datauristring",ee);default:return null}},Br.foo=function(){try{return Br.apply(this,arguments)}catch(Be){var E=Be.stack||"";~E.indexOf(" at ")&&(E=E.split(" at ")[1]);var ee="Error in function "+E.split(`
`)[0].split("<")[0]+": "+Be.message;if(!Rr.console)throw new Error(ee);Rr.console.error(ee,Be),Rr.alert&&alert(ee)}},Br.foo.bar=Br,Br.foo),ws=function(E){return Array.isArray(Me)===!0&&Me.indexOf(E)>-1};switch(a){case"pt":ht=1;break;case"mm":ht=72/25.4;break;case"cm":ht=72/2.54;break;case"in":ht=72;break;case"px":ht=ws("px_scaling")==1?.75:96/72;break;case"pc":case"em":ht=12;break;case"ex":ht=6;break;default:if(typeof a!="number")throw new Error("Invalid unit: "+a);ht=a}var Fa=null;we(),ve();var an=m.__private__.getPageInfo=m.getPageInfo=function(E){if(isNaN(E)||E%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:tt[E].objId,pageNumber:E,pageContext:tt[E]}},mA=m.__private__.getPageInfoByObjId=function(E){if(isNaN(E)||E%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var ee in tt)if(tt[ee].objId===E)break;return an(ee)},oi=m.__private__.getCurrentPageInfo=m.getCurrentPageInfo=function(){return{objId:tt[R].objId,pageNumber:R,pageContext:tt[R]}};m.addPage=function(){return vs.apply(this,arguments),this},m.setPage=function(){return Wi.apply(this,arguments),je.call(this,Le[R]),this},m.insertPage=function(E){return this.addPage(),this.movePage(R,E),this},m.movePage=function(E,ee){var Be,Ne;if(E>ee){Be=Le[E],Ne=tt[E];for(var Ke=E;Ke>ee;Ke--)Le[Ke]=Le[Ke-1],tt[Ke]=tt[Ke-1];Le[ee]=Be,tt[ee]=Ne,this.setPage(ee)}else if(E<ee){Be=Le[E],Ne=tt[E];for(var At=E;At<ee;At++)Le[At]=Le[At+1],tt[At]=tt[At+1];Le[ee]=Be,tt[ee]=Ne,this.setPage(ee)}return this},m.deletePage=function(){return Bi.apply(this,arguments),this},m.__private__.text=m.text=function(E,ee,Be,Ne,Ke){var At,wt,tr,Ar,kr,Dr,ea,nn,un,La=(Ne=Ne||{}).scope||this;if(typeof E=="number"&&typeof ee=="number"&&(typeof Be=="string"||Array.isArray(Be))){var pn=Be;Be=ee,ee=E,E=pn}if(arguments[3]instanceof Nt==0?(tr=arguments[4],Ar=arguments[5],za(ea=arguments[3])==="object"&&ea!==null||(typeof tr=="string"&&(Ar=tr,tr=null),typeof ea=="string"&&(Ar=ea,ea=null),typeof ea=="number"&&(tr=ea,ea=null),Ne={flags:ea,angle:tr,align:Ar})):(j("The transform parameter of text() with a Matrix value"),un=Ke),isNaN(ee)||isNaN(Be)||E==null)throw new Error("Invalid arguments passed to jsPDF.text");if(E.length===0)return La;var Cn,ss="",fl=typeof Ne.lineHeightFactor=="number"?Ne.lineHeightFactor:ys,Ji=La.internal.scaleFactor;function Xl(ya){return ya=ya.split("	").join(Array(Ne.TabLen||9).join(" ")),Pr(ya,ea)}function dc(ya){for(var ha,Wa=ya.concat(),Qn=[],xo=Wa.length;xo--;)typeof(ha=Wa.shift())=="string"?Qn.push(ha):Array.isArray(ya)&&(ha.length===1||ha[1]===void 0&&ha[2]===void 0)?Qn.push(ha[0]):Qn.push([ha[0],ha[1],ha[2]]);return Qn}function _A(ya,ha){var Wa;if(typeof ya=="string")Wa=ha(ya)[0];else if(Array.isArray(ya)){for(var Qn,xo,Zl=ya.concat(),fc=[],r0=Zl.length;r0--;)typeof(Qn=Zl.shift())=="string"?fc.push(ha(Qn)[0]):Array.isArray(Qn)&&typeof Qn[0]=="string"&&(xo=ha(Qn[0],Qn[1],Qn[2]),fc.push([xo[0],xo[1],xo[2]]));Wa=fc}return Wa}var Ei=!1,Ni=!0;if(typeof E=="string")Ei=!0;else if(Array.isArray(E)){var Go=E.concat();wt=[];for(var Yl,gn=Go.length;gn--;)(typeof(Yl=Go.shift())!="string"||Array.isArray(Yl)&&typeof Yl[0]!="string")&&(Ni=!1);Ei=Ni}if(Ei===!1)throw new Error('Type of text must be string or Array. "'+E+'" is not recognized.');typeof E=="string"&&(E=E.match(/[\r?\n]/)?E.split(/\r\n|\r|\n/g):[E]);var Dn=Xe/La.internal.scaleFactor,hl=Dn*(fl-1);switch(Ne.baseline){case"bottom":Be-=hl;break;case"top":Be+=Dn-hl;break;case"hanging":Be+=Dn-2*hl;break;case"middle":Be+=Dn/2-hl}if((Dr=Ne.maxWidth||0)>0&&(typeof E=="string"?E=La.splitTextToSize(E,Dr):Object.prototype.toString.call(E)==="[object Array]"&&(E=E.reduce(function(ya,ha){return ya.concat(La.splitTextToSize(ha,Dr))},[]))),At={text:E,x:ee,y:Be,options:Ne,mutex:{pdfEscape:Pr,activeFontKey:xt,fonts:Ee,activeFontSize:Xe}},Wt.publish("preProcessText",At),E=At.text,tr=(Ne=At.options).angle,un instanceof Nt==0&&tr&&typeof tr=="number"){tr*=Math.PI/180,Ne.rotationDirection===0&&(tr=-tr),O===S&&(tr=-tr);var BA=Math.cos(tr),Fi=Math.sin(tr);un=new Nt(BA,Fi,-Fi,BA,0,0)}else tr&&tr instanceof Nt&&(un=tr);O!==S||un||(un=ca),(kr=Ne.charSpace||Si)!==void 0&&(ss+=H(Y(kr))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(nn=Ne.horizontalScale)!==void 0&&(ss+=H(100*nn)+` Tz
`),Ne.lang;var Sn=-1,$l=Ne.renderingMode!==void 0?Ne.renderingMode:Ne.stroke,kA=La.internal.getCurrentPageInfo().pageContext;switch($l){case 0:case!1:case"fill":Sn=0;break;case 1:case!0:case"stroke":Sn=1;break;case 2:case"fillThenStroke":Sn=2;break;case 3:case"invisible":Sn=3;break;case 4:case"fillAndAddForClipping":Sn=4;break;case 5:case"strokeAndAddPathForClipping":Sn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Sn=6;break;case 7:case"addToPathForClipping":Sn=7}var ne=kA.usedRenderingMode!==void 0?kA.usedRenderingMode:-1;Sn!==-1?ss+=Sn+` Tr
`:ne!==-1&&(ss+=`0 Tr
`),Sn!==-1&&(kA.usedRenderingMode=Sn),Ar=Ne.align||"left";var De,ut=Xe*fl,Ft=La.internal.pageSize.getWidth(),ur=Ee[xt];kr=Ne.charSpace||Si,Dr=Ne.maxWidth||0,ea=Object.assign({autoencode:!0,noBOM:!0},Ne.flags);var dr=[],qr=function(ya){return La.getStringUnitWidth(ya,{font:ur,charSpace:kr,fontSize:Xe,doKerning:!1})*Xe/Ji};if(Object.prototype.toString.call(E)==="[object Array]"){var Fr;wt=dc(E),Ar!=="left"&&(De=wt.map(qr));var mr,$r=0;if(Ar==="right"){ee-=De[0],E=[],gn=wt.length;for(var sn=0;sn<gn;sn++)sn===0?(mr=Ga(ee),Fr=Kn(Be)):(mr=Y($r-De[sn]),Fr=-ut),E.push([wt[sn],mr,Fr]),$r=De[sn]}else if(Ar==="center"){ee-=De[0]/2,E=[],gn=wt.length;for(var Tr=0;Tr<gn;Tr++)Tr===0?(mr=Ga(ee),Fr=Kn(Be)):(mr=Y(($r-De[Tr])/2),Fr=-ut),E.push([wt[Tr],mr,Fr]),$r=De[Tr]}else if(Ar==="left"){E=[],gn=wt.length;for(var xr=0;xr<gn;xr++)E.push(wt[xr])}else if(Ar==="justify"&&ur.encoding==="Identity-H"){E=[],gn=wt.length,Dr=Dr!==0?Dr:Ft;for(var ta=0,ra=0;ra<gn;ra++)if(Fr=ra===0?Kn(Be):-ut,mr=ra===0?Ga(ee):ta,ra<gn-1){var js=Y((Dr-De[ra])/(wt[ra].split(" ").length-1)),mn=wt[ra].split(" ");E.push([mn[0]+" ",mr,Fr]),ta=0;for(var pl=1;pl<mn.length;pl++){var is=(qr(mn[pl-1]+" "+mn[pl])-qr(mn[pl]))*Ji+js;pl==mn.length-1?E.push([mn[pl],is,0]):E.push([mn[pl]+" ",is,0]),ta-=is}}else E.push([wt[ra],mr,Fr]);E.push(["",ta,0])}else{if(Ar!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(E=[],gn=wt.length,Dr=Dr!==0?Dr:Ft,ra=0;ra<gn;ra++){Fr=ra===0?Kn(Be):-ut,mr=ra===0?Ga(ee):0;var gl=wt[ra].split(" ").length-1,CA=gl>0?(Dr-De[ra])/gl:0;ra<gn-1?dr.push(H(Y(CA))):dr.push(0),E.push([wt[ra],mr,Fr])}}}(typeof Ne.R2L=="boolean"?Ne.R2L:qt)===!0&&(E=_A(E,function(ya,ha,Wa){return[ya.split("").reverse().join(""),ha,Wa]})),At={text:E,x:ee,y:Be,options:Ne,mutex:{pdfEscape:Pr,activeFontKey:xt,fonts:Ee,activeFontSize:Xe}},Wt.publish("postProcessText",At),E=At.text,Cn=At.mutex.isHex||!1;var ml=Ee[xt].encoding;ml!=="WinAnsiEncoding"&&ml!=="StandardEncoding"||(E=_A(E,function(ya,ha,Wa){return[Xl(ya),ha,Wa]})),wt=dc(E),E=[];for(var Jl,ci,Ti,Wo=Array.isArray(wt[0])?1:0,ui="",di=function(ya,ha,Wa){var Qn="";return Wa instanceof Nt?(Wa=typeof Ne.angle=="number"?Sr(Wa,new Nt(1,0,0,1,ya,ha)):Sr(new Nt(1,0,0,1,ya,ha),Wa),O===S&&(Wa=Sr(new Nt(1,0,0,-1,0,0),Wa)),Qn=Wa.join(" ")+` Tm
`):Qn=H(ya)+" "+H(ha)+` Td
`,Qn},cr=0;cr<wt.length;cr++){switch(ui="",Wo){case 1:Ti=(Cn?"<":"(")+wt[cr][0]+(Cn?">":")"),Jl=parseFloat(wt[cr][1]),ci=parseFloat(wt[cr][2]);break;case 0:Ti=(Cn?"<":"(")+wt[cr]+(Cn?">":")"),Jl=Ga(ee),ci=Kn(Be)}dr!==void 0&&dr[cr]!==void 0&&(ui=dr[cr]+` Tw
`),cr===0?E.push(ui+di(Jl,ci,un)+Ti):Wo===0?E.push(ui+Ti):Wo===1&&E.push(ui+di(Jl,ci,un)+Ti)}E=Wo===0?E.join(` Tj
T* `):E.join(` Tj
`),E+=` Tj
`;var In=`BT
/`;return In+=xt+" "+Xe+` Tf
`,In+=H(Xe*fl)+` TL
`,In+=qn+`
`,In+=ss,In+=E,J(In+="ET"),x[xt]=!0,La};var xA=m.__private__.clip=m.clip=function(E){return J(E==="evenodd"?"W*":"W"),this};m.clipEvenOdd=function(){return xA("evenodd")},m.__private__.discardPath=m.discardPath=function(){return J("n"),this};var hn=m.__private__.isValidStyle=function(E){var ee=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(E)!==-1&&(ee=!0),ee};m.__private__.setDefaultPathOperation=m.setDefaultPathOperation=function(E){return hn(E)&&(f=E),this};var qo=m.__private__.getStyle=m.getStyle=function(E){var ee=f;switch(E){case"D":case"S":ee="S";break;case"F":ee="f";break;case"FD":case"DF":ee="B";break;case"f":case"f*":case"B":case"B*":ee=E}return ee},Kl=m.close=function(){return J("h"),this};m.stroke=function(){return J("S"),this},m.fill=function(E){return Ci("f",E),this},m.fillEvenOdd=function(E){return Ci("f*",E),this},m.fillStroke=function(E){return Ci("B",E),this},m.fillStrokeEvenOdd=function(E){return Ci("B*",E),this};var Ci=function(E,ee){za(ee)==="object"?oc(ee,E):J(E)},ql=function(E){E===null||O===S&&E===void 0||(E=qo(E),J(E))};function bA(E,ee,Be,Ne,Ke){var At=new af(ee||this.boundingBox,Be||this.xStep,Ne||this.yStep,this.gState,Ke||this.matrix);At.stream=this.stream;var wt=E+"$$"+this.cloneIndex+++"$$";return Hr(wt,At),At}var oc=function(E,ee){var Be=Et[E.key],Ne=bt[Be];if(Ne instanceof B0)J("q"),J(vA(ee)),Ne.gState&&m.setGState(Ne.gState),J(E.matrix.toString()+" cm"),J("/"+Be+" sh"),J("Q");else if(Ne instanceof af){var Ke=new Nt(1,0,0,-1,0,Wl());E.matrix&&(Ke=Ke.multiply(E.matrix||ca),Be=bA.call(Ne,E.key,E.boundingBox,E.xStep,E.yStep,Ke).id),J("q"),J("/Pattern cs"),J("/"+Be+" scn"),Ne.gState&&m.setGState(Ne.gState),J(ee),J("Q")}},vA=function(E){switch(E){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Ac=m.moveTo=function(E,ee){return J(H(Y(E))+" "+H(z(ee))+" m"),this},Yi=m.lineTo=function(E,ee){return J(H(Y(E))+" "+H(z(ee))+" l"),this},Ta=m.curveTo=function(E,ee,Be,Ne,Ke,At){return J([H(Y(E)),H(z(ee)),H(Y(Be)),H(z(Ne)),H(Y(Ke)),H(z(At)),"c"].join(" ")),this};m.__private__.line=m.line=function(E,ee,Be,Ne,Ke){if(isNaN(E)||isNaN(ee)||isNaN(Be)||isNaN(Ne)||!hn(Ke))throw new Error("Invalid arguments passed to jsPDF.line");return O===N?this.lines([[Be-E,Ne-ee]],E,ee,[1,1],Ke||"S"):this.lines([[Be-E,Ne-ee]],E,ee,[1,1]).stroke()},m.__private__.lines=m.lines=function(E,ee,Be,Ne,Ke,At){var wt,tr,Ar,kr,Dr,ea,nn,un,La,pn,Cn,ss;if(typeof E=="number"&&(ss=Be,Be=ee,ee=E,E=ss),Ne=Ne||[1,1],At=At||!1,isNaN(ee)||isNaN(Be)||!Array.isArray(E)||!Array.isArray(Ne)||!hn(Ke)||typeof At!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Ac(ee,Be),wt=Ne[0],tr=Ne[1],kr=E.length,pn=ee,Cn=Be,Ar=0;Ar<kr;Ar++)(Dr=E[Ar]).length===2?(pn=Dr[0]*wt+pn,Cn=Dr[1]*tr+Cn,Yi(pn,Cn)):(ea=Dr[0]*wt+pn,nn=Dr[1]*tr+Cn,un=Dr[2]*wt+pn,La=Dr[3]*tr+Cn,pn=Dr[4]*wt+pn,Cn=Dr[5]*tr+Cn,Ta(ea,nn,un,La,pn,Cn));return At&&Kl(),ql(Ke),this},m.path=function(E){for(var ee=0;ee<E.length;ee++){var Be=E[ee],Ne=Be.c;switch(Be.op){case"m":Ac(Ne[0],Ne[1]);break;case"l":Yi(Ne[0],Ne[1]);break;case"c":Ta.apply(this,Ne);break;case"h":Kl()}}return this},m.__private__.rect=m.rect=function(E,ee,Be,Ne,Ke){if(isNaN(E)||isNaN(ee)||isNaN(Be)||isNaN(Ne)||!hn(Ke))throw new Error("Invalid arguments passed to jsPDF.rect");return O===N&&(Ne=-Ne),J([H(Y(E)),H(z(ee)),H(Y(Be)),H(Y(Ne)),"re"].join(" ")),ql(Ke),this},m.__private__.triangle=m.triangle=function(E,ee,Be,Ne,Ke,At,wt){if(isNaN(E)||isNaN(ee)||isNaN(Be)||isNaN(Ne)||isNaN(Ke)||isNaN(At)||!hn(wt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Be-E,Ne-ee],[Ke-Be,At-Ne],[E-Ke,ee-At]],E,ee,[1,1],wt,!0),this},m.__private__.roundedRect=m.roundedRect=function(E,ee,Be,Ne,Ke,At,wt){if(isNaN(E)||isNaN(ee)||isNaN(Be)||isNaN(Ne)||isNaN(Ke)||isNaN(At)||!hn(wt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var tr=4/3*(Math.SQRT2-1);return Ke=Math.min(Ke,.5*Be),At=Math.min(At,.5*Ne),this.lines([[Be-2*Ke,0],[Ke*tr,0,Ke,At-At*tr,Ke,At],[0,Ne-2*At],[0,At*tr,-Ke*tr,At,-Ke,At],[2*Ke-Be,0],[-Ke*tr,0,-Ke,-At*tr,-Ke,-At],[0,2*At-Ne],[0,-At*tr,Ke*tr,-At,Ke,-At]],E+Ke,ee,[1,1],wt,!0),this},m.__private__.ellipse=m.ellipse=function(E,ee,Be,Ne,Ke){if(isNaN(E)||isNaN(ee)||isNaN(Be)||isNaN(Ne)||!hn(Ke))throw new Error("Invalid arguments passed to jsPDF.ellipse");var At=4/3*(Math.SQRT2-1)*Be,wt=4/3*(Math.SQRT2-1)*Ne;return Ac(E+Be,ee),Ta(E+Be,ee-wt,E+At,ee-Ne,E,ee-Ne),Ta(E-At,ee-Ne,E-Be,ee-wt,E-Be,ee),Ta(E-Be,ee+wt,E-At,ee+Ne,E,ee+Ne),Ta(E+At,ee+Ne,E+Be,ee+wt,E+Be,ee),ql(Ke),this},m.__private__.circle=m.circle=function(E,ee,Be,Ne){if(isNaN(E)||isNaN(ee)||isNaN(Be)||!hn(Ne))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(E,ee,Be,Be,Ne)},m.setFont=function(E,ee,Be){return Be&&(ee=D(ee,Be)),xt=ki(E,ee,{disableWarning:!1}),this};var Us=m.__private__.getFont=m.getFont=function(){return Ee[ki.apply(m,arguments)]};m.__private__.getFontList=m.getFontList=function(){var E,ee,Be={};for(E in at)if(at.hasOwnProperty(E))for(ee in Be[E]=[],at[E])at[E].hasOwnProperty(ee)&&Be[E].push(ee);return Be},m.addFont=function(E,ee,Be,Ne,Ke){var At=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&At.indexOf(arguments[3])!==-1?Ke=arguments[3]:arguments[3]&&At.indexOf(arguments[3])==-1&&(Be=D(Be,Ne)),wa.call(this,E,ee,Be,Ke=Ke||"Identity-H")};var ys,_s=e.lineWidth||.200025,po=m.__private__.getLineWidth=m.getLineWidth=function(){return _s},_r=m.__private__.setLineWidth=m.setLineWidth=function(E){return _s=E,J(H(Y(E))+" w"),this};m.__private__.setLineDash=gr.API.setLineDash=gr.API.setLineDashPattern=function(E,ee){if(E=E||[],ee=ee||0,isNaN(ee)||!Array.isArray(E))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return E=E.map(function(Be){return H(Y(Be))}).join(" "),ee=H(Y(ee)),J("["+E+"] "+ee+" d"),this};var ma=m.__private__.getLineHeight=m.getLineHeight=function(){return Xe*ys};m.__private__.getLineHeight=m.getLineHeight=function(){return Xe*ys};var $i=m.__private__.setLineHeightFactor=m.setLineHeightFactor=function(E){return typeof(E=E||1.15)=="number"&&(ys=E),this},cc=m.__private__.getLineHeightFactor=m.getLineHeightFactor=function(){return ys};$i(e.lineHeight);var Ga=m.__private__.getHorizontalCoordinate=function(E){return Y(E)},Kn=m.__private__.getVerticalCoordinate=function(E){return O===S?E:tt[R].mediaBox.topRightY-tt[R].mediaBox.bottomLeftY-Y(E)},go=m.__private__.getHorizontalCoordinateString=m.getHorizontalCoordinateString=function(E){return H(Ga(E))},jn=m.__private__.getVerticalCoordinateString=m.getVerticalCoordinateString=function(E){return H(Kn(E))},Bs=e.strokeColor||"0 G";m.__private__.getStrokeColor=m.getDrawColor=function(){return K(Bs)},m.__private__.setStrokeColor=m.setDrawColor=function(E,ee,Be,Ne){return Bs=se({ch1:E,ch2:ee,ch3:Be,ch4:Ne,pdfColorType:"draw",precision:2}),J(Bs),this};var zl=e.fillColor||"0 g";m.__private__.getFillColor=m.getFillColor=function(){return K(zl)},m.__private__.setFillColor=m.setFillColor=function(E,ee,Be,Ne){return zl=se({ch1:E,ch2:ee,ch3:Be,ch4:Ne,pdfColorType:"fill",precision:2}),J(zl),this};var qn=e.textColor||"0 g",Yc=m.__private__.getTextColor=m.getTextColor=function(){return K(qn)};m.__private__.setTextColor=m.setTextColor=function(E,ee,Be,Ne){return qn=se({ch1:E,ch2:ee,ch3:Be,ch4:Ne,pdfColorType:"text",precision:3}),this};var Si=e.charSpace,zo=m.__private__.getCharSpace=m.getCharSpace=function(){return parseFloat(Si||0)};m.__private__.setCharSpace=m.setCharSpace=function(E){if(isNaN(E))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Si=E,this};var wA=0;m.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},m.__private__.setLineCap=m.setLineCap=function(E){var ee=m.CapJoinStyles[E];if(ee===void 0)throw new Error("Line cap style of '"+E+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return wA=ee,J(ee+" J"),this};var zn=0;m.__private__.setLineJoin=m.setLineJoin=function(E){var ee=m.CapJoinStyles[E];if(ee===void 0)throw new Error("Line join style of '"+E+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return zn=ee,J(ee+" j"),this},m.__private__.setLineMiterLimit=m.__private__.setMiterLimit=m.setLineMiterLimit=m.setMiterLimit=function(E){if(E=E||0,isNaN(E))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return J(H(Y(E))+" M"),this},m.GState=Dx,m.setGState=function(E){(E=typeof E=="string"?mt[Ot[E]]:Al(null,E)).equals(Ur)||(J("/"+E.id+" gs"),Ur=E)};var Al=function(E,ee){if(!E||!Ot[E]){var Be=!1;for(var Ne in mt)if(mt.hasOwnProperty(Ne)&&mt[Ne].equals(ee)){Be=!0;break}if(Be)ee=mt[Ne];else{var Ke="GS"+(Object.keys(mt).length+1).toString(10);mt[Ke]=ee,ee.id=Ke}return E&&(Ot[E]=ee.id),Wt.publish("addGState",ee),ee}};m.addGState=function(E,ee){return Al(E,ee),this},m.saveGraphicsState=function(){return J("q"),it.push({key:xt,size:Xe,color:qn}),this},m.restoreGraphicsState=function(){J("Q");var E=it.pop();return xt=E.key,Xe=E.size,qn=E.color,Ur=null,this},m.setCurrentTransformationMatrix=function(E){return J(E.toString()+" cm"),this},m.comment=function(E){return J("#"+E),this};var Ai=function(E,ee){var Be=E||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Be},set:function(At){isNaN(At)||(Be=parseFloat(At))}});var Ne=ee||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Ne},set:function(At){isNaN(At)||(Ne=parseFloat(At))}});var Ke="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ke},set:function(At){Ke=At.toString()}}),this},cl=function(E,ee,Be,Ne){Ai.call(this,E,ee),this.type="rect";var Ke=Be||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ke},set:function(wt){isNaN(wt)||(Ke=parseFloat(wt))}});var At=Ne||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return At},set:function(wt){isNaN(wt)||(At=parseFloat(wt))}}),this},Vn=function(){this.page=Vt,this.currentPage=R,this.pages=Le.slice(0),this.pagesContext=tt.slice(0),this.x=Bt,this.y=pr,this.matrix=$t,this.width=ul(R),this.height=yA(R),this.outputDestination=_e,this.id="",this.objectNumber=-1};Vn.prototype.restore=function(){Vt=this.page,R=this.currentPage,tt=this.pagesContext,Le=this.pages,Bt=this.x,pr=this.y,$t=this.matrix,Vo(R,this.width),dl(R,this.height),_e=this.outputDestination};var mo=function(E,ee,Be,Ne,Ke){ir.push(new Vn),Vt=R=0,Le=[],Bt=E,pr=ee,$t=Ke,sa([Be,Ne])};for(var Vl in m.beginFormObject=function(E,ee,Be,Ne,Ke){return mo(E,ee,Be,Ne,Ke),this},m.endFormObject=function(E){return(function(ee){if(Tt[ee])ir.pop().restore();else{var Be=new Vn,Ne="Xo"+(Object.keys(kt).length+1).toString(10);Be.id=Ne,Tt[ee]=Ne,kt[Ne]=Be,Wt.publish("addFormObject",Be),ir.pop().restore()}})(E),this},m.doFormObject=function(E,ee){var Be=kt[Tt[E]];return J("q"),J(ee.toString()+" cm"),J("/"+Be.id+" Do"),J("Q"),this},m.getFormObject=function(E){var ee=kt[Tt[E]];return{x:ee.x,y:ee.y,width:ee.width,height:ee.height,matrix:ee.matrix}},m.save=function(E,ee){return E=E||"generated.pdf",(ee=ee||{}).returnPromise=ee.returnPromise||!1,ee.returnPromise===!1?(w0(Pl(Xi()),E),typeof w0.unload=="function"&&Rr.setTimeout&&setTimeout(w0.unload,911),this):new Promise(function(Be,Ne){try{var Ke=w0(Pl(Xi()),E);typeof w0.unload=="function"&&Rr.setTimeout&&setTimeout(w0.unload,911),Be(Ke)}catch(At){Ne(At.message)}})},gr.API)gr.API.hasOwnProperty(Vl)&&(Vl==="events"&&gr.API.events.length?(function(E,ee){var Be,Ne,Ke;for(Ke=ee.length-1;Ke!==-1;Ke--)Be=ee[Ke][0],Ne=ee[Ke][1],E.subscribe.apply(E,[Be].concat(typeof Ne=="function"?[Ne]:Ne))})(Wt,gr.API.events):m[Vl]=gr.API[Vl]);function ul(E){return tt[E].mediaBox.topRightX-tt[E].mediaBox.bottomLeftX}function Vo(E,ee){tt[E].mediaBox.topRightX=ee+tt[E].mediaBox.bottomLeftX}function yA(E){return tt[E].mediaBox.topRightY-tt[E].mediaBox.bottomLeftY}function dl(E,ee){tt[E].mediaBox.topRightY=ee+tt[E].mediaBox.bottomLeftY}var Gl=m.getPageWidth=function(E){return ul(E=E||R)/ht},$c=m.setPageWidth=function(E,ee){Vo(E,ee*ht)},Wl=m.getPageHeight=function(E){return yA(E=E||R)/ht},uc=m.setPageHeight=function(E,ee){dl(E,ee*ht)};return m.internal={pdfEscape:Pr,getStyle:qo,getFont:Us,getFontSize:yt,getCharSpace:zo,getTextColor:Yc,getLineHeight:ma,getLineHeightFactor:cc,getLineWidth:po,write:ze,getHorizontalCoordinate:Ga,getVerticalCoordinate:Kn,getCoordinateString:go,getVerticalCoordinateString:jn,collections:{},newObject:jr,newAdditionalObject:xe,newObjectDeferred:Er,newObjectDeferredBegin:ae,getFilters:Fe,putStream:Re,events:Wt,scaleFactor:ht,pageSize:{getWidth:function(){return Gl(R)},setWidth:function(E){$c(R,E)},getHeight:function(){return Wl(R)},setHeight:function(E){uc(R,E)}},encryptionOptions:h,encryption:Fa,getEncryptor:function(E){return h!==null?Fa.encryptor(E,0):function(ee){return ee}},output:Ko,getNumberOfPages:rn,get pages(){return Le},out:J,f2:I,f3:Q,getPageInfo:an,getPageInfoByObjId:mA,getCurrentPageInfo:oi,getPDFVersion:v,Point:Ai,Rectangle:cl,Matrix:Nt,hasHotfix:ws},Object.defineProperty(m.internal.pageSize,"width",{get:function(){return Gl(R)},set:function(E){$c(R,E)},enumerable:!0,configurable:!0}),Object.defineProperty(m.internal.pageSize,"height",{get:function(){return Wl(R)},set:function(E){uc(R,E)},enumerable:!0,configurable:!0}),(function(E){for(var ee=0,Be=ct.length;ee<Be;ee++){var Ne=wa.call(this,E[ee][0],E[ee][1],E[ee][2],ct[ee][3],!0);g===!1&&(x[Ne]=!0);var Ke=E[ee][0].split("-");Gt({id:Ne,fontName:Ke[0],fontStyle:Ke[1]||""})}Wt.publish("addFonts",{fonts:Ee,dictionary:at})}).call(m,ct),xt="F1",vs(n,r),Wt.publish("initialized"),m}$d.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},$d.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},$d.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},$d.prototype.processOwnerPassword=function(e,t){return r2(t2(t).substr(0,5),e)},$d.prototype.encryptor=function(e,t){var r=t2(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(a){return r2(r,a)}},Dx.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||za(e)!==za(this))return!1;var a=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;a++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&a--;return a===0},gr.API={events:[]},gr.version="4.1.0";var es=gr.API,Cy=1,J0=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},zd=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Ix=function(e){return e.toString().replace(/#/g,"#23").replace(/[\s\n\r()<>[\]{}\/%]/g,function(t){var r=t.charCodeAt(0).toString(16).toUpperCase();return"#"+(r.length===1?"0"+r:r)})},Vr=function(e){return e.toFixed(2)},Bu=function(e){return e.toFixed(5)};es.__acroform__={};var Ml=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},qC=function(e){return e*Cy},zA=function(e){var t=new CT,r=or.internal.getHeight(e)||0,a=or.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Vr(a)),Number(Vr(r))],t},_ee=es.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},Bee=es.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},kee=es.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},fs=es.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return kee(e,t-1)},hs=es.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return _ee(e,t-1)},ps=es.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Bee(e,t-1)},Cee=es.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,a=t.internal.getVerticalCoordinate,n=e[0],s=e[1],l=e[2],A=e[3],u={};return u.lowerLeft_X=r(n)||0,u.lowerLeft_Y=a(s+A)||0,u.upperRight_X=r(n+l)||0,u.upperRight_Y=a(s)||0,[Number(Vr(u.lowerLeft_X)),Number(Vr(u.lowerLeft_Y)),Number(Vr(u.upperRight_X)),Number(Vr(u.upperRight_Y))]},See=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,a=a2(e,r),n=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+n+" "+Vr(a.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(a.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=zA(e);return s.scope=e.scope,s.stream=t.join(`
`),s}},a2=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,a={text:"",fontSize:""},n=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");n=e.multiline?n.map(function(I){return I.split(`
`)}):n.map(function(I){return[I]});var s=r,l=or.internal.getHeight(e)||0;l=l<0?-l:l;var A=or.internal.getWidth(e)||0;A=A<0?-A:A;var u=function(I,Q,Y){if(I+1<n.length){var z=Q+" "+n[I+1][0];return Um(z,e,Y).width<=A-4}return!1};s++;e:for(;s>0;){t="",s--;var f,h,g=Um("3",e,s).height,x=e.multiline?l-s:(l-g)/2,m=x+=2,w=0,v=0,B=0;if(s<=0){t=`(...) Tj
`,t+="% Width of Text: "+Um(t,e,s=12).width+", FieldWidth:"+A+`
`;break}for(var k="",N=0,S=0;S<n.length;S++)if(n.hasOwnProperty(S)){var O=!1;if(n[S].length!==1&&B!==n[S].length-1){if((g+2)*(N+2)+2>l)continue e;k+=n[S][B],O=!0,v=S,S--}else{k=(k+=n[S][B]+" ").substr(k.length-1)==" "?k.substr(0,k.length-1):k;var T=parseInt(S),U=u(T,k,s),D=S>=n.length-1;if(U&&!D){k+=" ",B=0;continue}if(U||D){if(D)v=T;else if(e.multiline&&(g+2)*(N+2)+2>l)continue e}else{if(!e.multiline||(g+2)*(N+2)+2>l)continue e;v=T}}for(var H="",j=w;j<=v;j++){var W=n[j];if(e.multiline){if(j===v){H+=W[B]+" ",B=(B+1)%W.length;continue}if(j===w){H+=W[W.length-1]+" ";continue}}H+=W[0]+" "}switch(H=H.substr(H.length-1)==" "?H.substr(0,H.length-1):H,h=Um(H,e,s).width,e.textAlign){case"right":f=A-h-2;break;case"center":f=(A-h)/2;break;default:f=2}t+=Vr(f)+" "+Vr(m)+` Td
`,t+="("+J0(H)+`) Tj
`,t+=-Vr(f)+` 0 Td
`,m=-(s+2),h=0,w=O?v:v+1,N++,k=""}break}return a.text=t,a.fontSize=s,a},Um=function(e,t,r){var a=t.scope.internal.getFont(t.fontName,t.fontStyle),n=t.scope.getStringUnitWidth(e,{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:n}},Eee={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Nee=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(a){return a.type===r.type&&a.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},Fee=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(pA.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(Eee)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Cy=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new ST,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var a=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in a)if(a.hasOwnProperty(n)){var s=a[n];s.objId=void 0,s.hasAnnotation&&Nee(s,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(a,n){var s=!a;for(var l in a||(n.internal.newObjectDeferredBegin(n.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),n.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),a=a||n.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(a.hasOwnProperty(l)){var A=a[l],u=[],f=A.Rect;if(A.Rect&&(A.Rect=Cee(A.Rect,n)),n.internal.newObjectDeferredBegin(A.objId,!0),A.DA=or.createDefaultAppearanceStream(A),za(A)==="object"&&typeof A.getKeyValueListForStream=="function"&&(u=A.getKeyValueListForStream()),A.Rect=f,A.hasAppearanceStream&&!A.appearanceStreamContent){var h=See(A);u.push({key:"AP",value:"<</N "+h+">>"}),n.internal.acroformPlugin.xForms.push(h)}if(A.appearanceStreamContent){var g="";for(var x in A.appearanceStreamContent)if(A.appearanceStreamContent.hasOwnProperty(x)){var m=A.appearanceStreamContent[x];if(g+="/"+x+" ",g+="<<",Object.keys(m).length>=1||Array.isArray(m)){for(var l in m)if(m.hasOwnProperty(l)){var w=m[l];typeof w=="function"&&(w=w.call(n,A)),g+="/"+l+" "+w+" ",n.internal.acroformPlugin.xForms.indexOf(w)>=0||n.internal.acroformPlugin.xForms.push(w)}}else typeof(w=m)=="function"&&(w=w.call(n,A)),g+="/"+l+" "+w,n.internal.acroformPlugin.xForms.indexOf(w)>=0||n.internal.acroformPlugin.xForms.push(w);g+=">>"}u.push({key:"AP",value:`<<
`+g+">>"})}n.internal.putStream({additionalKeyValues:u,objectId:A.objId}),n.internal.out("endobj")}s&&(function(v,B){for(var k in v)if(v.hasOwnProperty(k)){var N=k,S=v[k];B.internal.newObjectDeferredBegin(S.objId,!0),za(S)==="object"&&typeof S.putStream=="function"&&S.putStream(),delete v[N]}})(n.internal.acroformPlugin.xForms,n)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},kT=es.__acroform__.arrayToPdfArray=function(e,t,r){var a=function(l){return l};if(Array.isArray(e)){for(var n="[",s=0;s<e.length;s++)switch(s!==0&&(n+=" "),za(e[s])){case"boolean":case"number":case"object":n+=e[s].toString();break;case"string":e[s].substr(0,1)==="/"?n+="/"+Ix(e[s].substr(1)):(t!==void 0&&r&&(a=r.internal.getEncryptor(t)),n+="("+J0(a(e[s].toString()))+")")}return n+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Hv=function(e,t,r){var a=function(n){return n};return t!==void 0&&r&&(a=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+J0(a(e))+")"},tc=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};tc.prototype.toString=function(){return this.objId+" 0 R"},tc.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},tc.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var a=t[r],n=this[a];n&&(Array.isArray(n)?e.push({key:a,value:kT(n,this.objId,this.scope)}):n instanceof tc?(n.scope=this.scope,e.push({key:a,value:n.objId+" 0 R"})):typeof n!="function"&&e.push({key:a,value:n}))}return e};var CT=function(){tc.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};Ml(CT,tc);var ST=function(){tc.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(a){return a};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+J0(r(e))+")"}},set:function(r){e=r}})};Ml(ST,tc);var pA=function e(){tc.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(k){if(isNaN(k))throw new Error('Invalid value "'+k+'" for attribute F supplied.');t=k}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!fs(t,3)},set:function(k){k?this.F=hs(t,3):this.F=ps(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(k){if(isNaN(k))throw new Error('Invalid value "'+k+'" for attribute Ff supplied.');r=k}});var a=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(a.length!==0)return a},set:function(k){a=k!==void 0?k:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[0])?0:a[0]},set:function(k){a[0]=k}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[1])?0:a[1]},set:function(k){a[1]=k}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[2])?0:a[2]},set:function(k){a[2]=k}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[3])?0:a[3]},set:function(k){a[3]=k}});var n="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return n},set:function(k){switch(k){case"/Btn":case"/Tx":case"/Ch":case"/Sig":n=k;break;default:throw new Error('Invalid value "'+k+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof Qx)return;s="FieldObject"+e.FieldNum++}var k=function(N){return N};return this.scope&&(k=this.scope.internal.getEncryptor(this.objId)),"("+J0(k(s))+")"},set:function(k){s=k.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(k){s=k}});var l="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return l},set:function(k){l=k}});var A="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return A},set:function(k){A=k}});var u=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return u},set:function(k){u=k}});var f=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return f===void 0?50/Cy:f},set:function(k){f=k}});var h="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return h},set:function(k){h=k}});var g="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!g||this instanceof Qx||this instanceof D0))return Hv(g,this.objId,this.scope)},set:function(k){k=k.toString(),g=k}});var x=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(x)return this instanceof ei==0?Hv(x,this.objId,this.scope):x},set:function(k){k=k.toString(),x=this instanceof ei==0?k.substr(0,1)==="("?zd(k.substr(1,k.length-2)):zd(k):k}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ei==1?zd(x.substr(1,x.length-1)):x},set:function(k){k=k.toString(),x=this instanceof ei==1?"/"+Ix(k):k}});var m=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(m)return m},set:function(k){this.V=k}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof ei==0?Hv(m,this.objId,this.scope):m},set:function(k){k=k.toString(),m=this instanceof ei==0?k.substr(0,1)==="("?zd(k.substr(1,k.length-2)):zd(k):k}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ei==1?zd(m.substr(1,m.length-1)):m},set:function(k){k=k.toString(),m=this instanceof ei==1?"/"+Ix(k):k}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var w,v=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return v},set:function(k){k=!!k,v=k}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(w)return w},set:function(k){w=k}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,1)},set:function(k){k?this.Ff=hs(this.Ff,1):this.Ff=ps(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,2)},set:function(k){k?this.Ff=hs(this.Ff,2):this.Ff=ps(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,3)},set:function(k){k?this.Ff=hs(this.Ff,3):this.Ff=ps(this.Ff,3)}});var B=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(B!==null)return B},set:function(k){if([0,1,2].indexOf(k)===-1)throw new Error('Invalid value "'+k+'" for attribute Q supplied.');B=k}}),Object.defineProperty(this,"textAlign",{get:function(){var k;switch(B){case 0:default:k="left";break;case 1:k="center";break;case 2:k="right"}return k},configurable:!0,enumerable:!0,set:function(k){switch(k){case"right":case 2:B=2;break;case"center":case 1:B=1;break;default:B=0}}})};Ml(pA,tc);var ff=function(){pA.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return kT(t,this.objId,this.scope)},set:function(r){var a,n;n=[],typeof(a=r)=="string"&&(n=(function(s,l,A){A||(A=1);for(var u,f=[];u=l.exec(s);)f.push(u[A]);return f})(a,/\((.*?)\)/g)),t=n}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,a){for(a=a||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),a!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,18)},set:function(r){r?this.Ff=hs(this.Ff,18):this.Ff=ps(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=hs(this.Ff,19):this.Ff=ps(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,20)},set:function(r){r?(this.Ff=hs(this.Ff,20),t.sort()):this.Ff=ps(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,22)},set:function(r){r?this.Ff=hs(this.Ff,22):this.Ff=ps(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,23)},set:function(r){r?this.Ff=hs(this.Ff,23):this.Ff=ps(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,27)},set:function(r){r?this.Ff=hs(this.Ff,27):this.Ff=ps(this.Ff,27)}}),this.hasAppearanceStream=!1};Ml(ff,pA);var hf=function(){ff.call(this),this.fontName="helvetica",this.combo=!1};Ml(hf,ff);var pf=function(){hf.call(this),this.combo=!0};Ml(pf,hf);var qm=function(){pf.call(this),this.edit=!0};Ml(qm,pf);var ei=function(){pA.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,15)},set:function(r){r?this.Ff=hs(this.Ff,15):this.Ff=ps(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,16)},set:function(r){r?this.Ff=hs(this.Ff,16):this.Ff=ps(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,17)},set:function(r){r?this.Ff=hs(this.Ff,17):this.Ff=ps(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,26)},set:function(r){r?this.Ff=hs(this.Ff,26):this.Ff=ps(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(s){return s};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var a,n=[];for(a in n.push("<<"),t)n.push("/"+a+" ("+J0(r(t[a]))+")");return n.push(">>"),n.join(`
`)}},set:function(r){za(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+Ix(r)}})};Ml(ei,pA);var zm=function(){ei.call(this),this.pushButton=!0};Ml(zm,ei);var gf=function(){ei.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};Ml(gf,ei);var Qx=function(){var e,t;pA.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(n){t=n}});var r,a={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(A){return A};this.scope&&(n=this.scope.internal.getEncryptor(this.objId));var s,l=[];for(s in l.push("<<"),a)l.push("/"+s+" ("+J0(n(a[s]))+")");return l.push(">>"),l.join(`
`)},set:function(n){za(n)==="object"&&(a=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return a.CA||""},set:function(n){typeof n=="string"&&(a.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(n){r=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(n){r="/"+n}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=or.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Ml(Qx,pA),gf.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},gf.prototype.createOption=function(e){var t=new Qx;return t.Parent=this,t.optionName=e,this.Kids.push(t),Tee.call(this.scope,t),t};var Vm=function(){ei.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=or.CheckBox.createAppearanceStream()};Ml(Vm,ei);var D0=function(){pA.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,13)},set:function(t){t?this.Ff=hs(this.Ff,13):this.Ff=ps(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,21)},set:function(t){t?this.Ff=hs(this.Ff,21):this.Ff=ps(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,23)},set:function(t){t?this.Ff=hs(this.Ff,23):this.Ff=ps(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,24)},set:function(t){t?this.Ff=hs(this.Ff,24):this.Ff=ps(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,25)},set:function(t){t?this.Ff=hs(this.Ff,25):this.Ff=ps(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,26)},set:function(t){t?this.Ff=hs(this.Ff,26):this.Ff=ps(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Ml(D0,pA);var Gm=function(){D0.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!fs(this.Ff,14)},set:function(e){e?this.Ff=hs(this.Ff,14):this.Ff=ps(this.Ff,14)}}),this.password=!0};Ml(Gm,D0);var or={CheckBox:{createAppearanceStream:function(){return{N:{On:or.CheckBox.YesNormal},D:{On:or.CheckBox.YesPushDown,Off:or.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=zA(e);t.scope=e.scope;var r=[],a=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),s=a2(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+Vr(or.internal.getWidth(e))+" "+Vr(or.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+a+" "+Vr(s.fontSize)+" Tf "+n),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=zA(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),n=[],s=or.internal.getHeight(e),l=or.internal.getWidth(e),A=a2(e,e.caption);return n.push("1 g"),n.push("0 0 "+Vr(l)+" "+Vr(s)+" re"),n.push("f"),n.push("q"),n.push("0 0 1 rg"),n.push("0 0 "+Vr(l-1)+" "+Vr(s-1)+" re"),n.push("W"),n.push("n"),n.push("0 g"),n.push("BT"),n.push("/"+r+" "+Vr(A.fontSize)+" Tf "+a),n.push(A.text),n.push("ET"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=zA(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Vr(or.internal.getWidth(e))+" "+Vr(or.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:or.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=or.RadioButton.Circle.YesNormal,t.D[e]=or.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=zA(e);t.scope=e.scope;var r=[],a=or.internal.getWidth(e)<=or.internal.getHeight(e)?or.internal.getWidth(e)/4:or.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var n=or.internal.Bezier_C,s=Number((a*n).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Bu(or.internal.getWidth(e)/2)+" "+Bu(or.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=zA(e);t.scope=e.scope;var r=[],a=or.internal.getWidth(e)<=or.internal.getHeight(e)?or.internal.getWidth(e)/4:or.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),s=Number((n*or.internal.Bezier_C).toFixed(5)),l=Number((a*or.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Bu(or.internal.getWidth(e)/2)+" "+Bu(or.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Bu(or.internal.getWidth(e)/2)+" "+Bu(or.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+l+" "+l+" "+a+" 0 "+a+" c"),r.push("-"+l+" "+a+" -"+a+" "+l+" -"+a+" 0 c"),r.push("-"+a+" -"+l+" -"+l+" -"+a+" 0 -"+a+" c"),r.push(l+" -"+a+" "+a+" -"+l+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=zA(e);t.scope=e.scope;var r=[],a=or.internal.getWidth(e)<=or.internal.getHeight(e)?or.internal.getWidth(e)/4:or.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),s=Number((n*or.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Bu(or.internal.getWidth(e)/2)+" "+Bu(or.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:or.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=or.RadioButton.Cross.YesNormal,t.D[e]=or.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=zA(e);t.scope=e.scope;var r=[],a=or.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+Vr(or.internal.getWidth(e)-2)+" "+Vr(or.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Vr(a.x1.x)+" "+Vr(a.x1.y)+" m"),r.push(Vr(a.x2.x)+" "+Vr(a.x2.y)+" l"),r.push(Vr(a.x4.x)+" "+Vr(a.x4.y)+" m"),r.push(Vr(a.x3.x)+" "+Vr(a.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=zA(e);t.scope=e.scope;var r=or.internal.calculateCross(e),a=[];return a.push("0.749023 g"),a.push("0 0 "+Vr(or.internal.getWidth(e))+" "+Vr(or.internal.getHeight(e))+" re"),a.push("f"),a.push("q"),a.push("1 1 "+Vr(or.internal.getWidth(e)-2)+" "+Vr(or.internal.getHeight(e)-2)+" re"),a.push("W"),a.push("n"),a.push(Vr(r.x1.x)+" "+Vr(r.x1.y)+" m"),a.push(Vr(r.x2.x)+" "+Vr(r.x2.y)+" l"),a.push(Vr(r.x4.x)+" "+Vr(r.x4.y)+" m"),a.push(Vr(r.x3.x)+" "+Vr(r.x3.y)+" l"),a.push("s"),a.push("Q"),t.stream=a.join(`
`),t},OffPushDown:function(e){var t=zA(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Vr(or.internal.getWidth(e))+" "+Vr(or.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};or.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=or.internal.getWidth(e),r=or.internal.getHeight(e),a=Math.min(t,r);return{x1:{x:(t-a)/2,y:(r-a)/2+a},x2:{x:(t-a)/2+a,y:(r-a)/2},x3:{x:(t-a)/2,y:(r-a)/2},x4:{x:(t-a)/2+a,y:(r-a)/2+a}}}},or.internal.getWidth=function(e){var t=0;return za(e)==="object"&&(t=qC(e.Rect[2])),t},or.internal.getHeight=function(e){var t=0;return za(e)==="object"&&(t=qC(e.Rect[3])),t};var Tee=es.addField=function(e){if(Fee(this,e),!(e instanceof pA))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};es.AcroFormChoiceField=ff,es.AcroFormListBox=hf,es.AcroFormComboBox=pf,es.AcroFormEditBox=qm,es.AcroFormButton=ei,es.AcroFormPushButton=zm,es.AcroFormRadioButton=gf,es.AcroFormCheckBox=Vm,es.AcroFormTextField=D0,es.AcroFormPasswordField=Gm,es.AcroFormAppearance=or,es.AcroForm={ChoiceField:ff,ListBox:hf,ComboBox:pf,EditBox:qm,Button:ei,PushButton:zm,RadioButton:gf,CheckBox:Vm,TextField:D0,PasswordField:Gm,Appearance:or},gr.AcroForm={ChoiceField:ff,ListBox:hf,ComboBox:pf,EditBox:qm,Button:ei,PushButton:zm,RadioButton:gf,CheckBox:Vm,TextField:D0,PasswordField:Gm,Appearance:or};gr.AcroForm;function ET(e){return e.reduce(function(t,r,a){return t[r]=a,t},{})}(function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",a={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=e.__addimage__.getImageFileTypeByImageData=function(I,Q){var Y,z,ue,Z,Ae,ve=r;if((Q=Q||r)==="RGBA"||I.data!==void 0&&I.data instanceof Uint8ClampedArray&&"height"in I&&"width"in I)return"RGBA";if(U(I))for(Ae in a)for(ue=a[Ae],Y=0;Y<ue.length;Y+=1){for(Z=!0,z=0;z<ue[Y].length;z+=1)if(ue[Y][z]!==void 0&&ue[Y][z]!==I[z]){Z=!1;break}if(Z===!0){ve=Ae;break}}else for(Ae in a)for(ue=a[Ae],Y=0;Y<ue.length;Y+=1){for(Z=!0,z=0;z<ue[Y].length;z+=1)if(ue[Y][z]!==void 0&&ue[Y][z]!==I.charCodeAt(z)){Z=!1;break}if(Z===!0){ve=Ae;break}}return ve===r&&Q!==r&&(ve=Q),ve},s=function I(Q){for(var Y=this.internal.write,z=this.internal.putStream,ue=(0,this.internal.getFilters)();ue.indexOf("FlateEncode")!==-1;)ue.splice(ue.indexOf("FlateEncode"),1);Q.objectId=this.internal.newObject();var Z=[];if(Z.push({key:"Type",value:"/XObject"}),Z.push({key:"Subtype",value:"/Image"}),Z.push({key:"Width",value:Q.width}),Z.push({key:"Height",value:Q.height}),Q.colorSpace===k.INDEXED?Z.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(Q.palette.length/3-1)+" "+("sMask"in Q&&Q.sMask!==void 0?Q.objectId+2:Q.objectId+1)+" 0 R]"}):(Z.push({key:"ColorSpace",value:"/"+Q.colorSpace}),Q.colorSpace===k.DEVICE_CMYK&&Z.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),Z.push({key:"BitsPerComponent",value:Q.bitsPerComponent}),"decodeParameters"in Q&&Q.decodeParameters!==void 0&&Z.push({key:"DecodeParms",value:"<<"+Q.decodeParameters+">>"}),"transparency"in Q&&Array.isArray(Q.transparency)&&Q.transparency.length>0){for(var Ae="",ve=0,G=Q.transparency.length;ve<G;ve++)Ae+=Q.transparency[ve]+" "+Q.transparency[ve]+" ";Z.push({key:"Mask",value:"["+Ae+"]"})}Q.sMask!==void 0&&Z.push({key:"SMask",value:Q.objectId+1+" 0 R"});var Se=Q.filter!==void 0?["/"+Q.filter]:void 0;if(z({data:Q.data,additionalKeyValues:Z,alreadyAppliedFilters:Se,objectId:Q.objectId}),Y("endobj"),"sMask"in Q&&Q.sMask!==void 0){var we,F=(we=Q.sMaskBitsPerComponent)!==null&&we!==void 0?we:Q.bitsPerComponent,R={width:Q.width,height:Q.height,colorSpace:"DeviceGray",bitsPerComponent:F,data:Q.sMask};"filter"in Q&&(R.decodeParameters="/Predictor ".concat(Q.predictor," /Colors 1 /BitsPerComponent ").concat(F," /Columns ").concat(Q.width),R.filter=Q.filter),I.call(this,R)}if(Q.colorSpace===k.INDEXED){var M=this.internal.newObject();z({data:H(new Uint8Array(Q.palette)),objectId:M}),Y("endobj")}},l=function(){var I=this.internal.collections[t+"images"];for(var Q in I)s.call(this,I[Q])},A=function(){var I,Q=this.internal.collections[t+"images"],Y=this.internal.write;for(var z in Q)Y("/I"+(I=Q[z]).index,I.objectId,"0","R")},u=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",l),this.internal.events.subscribe("putXobjectDict",A))},f=function(){var I=this.internal.collections[t+"images"];return u.call(this),I},h=function(){return Object.keys(this.internal.collections[t+"images"]).length},g=function(I){return typeof e["process"+I.toUpperCase()]=="function"},x=function(I){return za(I)==="object"&&I.nodeType===1},m=function(I,Q){if(I.nodeName==="IMG"&&I.hasAttribute("src")){var Y=""+I.getAttribute("src");if(Y.indexOf("data:image/")===0)return Km(unescape(Y).split("base64,").pop());var z=e.loadFile(Y,!0);if(z!==void 0)return z}if(I.nodeName==="CANVAS"){if(I.width===0||I.height===0)throw new Error("Given canvas must have data. Canvas width: "+I.width+", height: "+I.height);var ue;switch(Q){case"PNG":ue="image/png";break;case"WEBP":ue="image/webp";break;default:ue="image/jpeg"}return Km(I.toDataURL(ue,1).split("base64,").pop())}},w=function(I){var Q=this.internal.collections[t+"images"];if(Q){for(var Y in Q)if(I===Q[Y].alias)return Q[Y]}},v=function(I,Q,Y){return I||Q||(I=-96,Q=-96),I<0&&(I=-1*Y.width*72/I/this.internal.scaleFactor),Q<0&&(Q=-1*Y.height*72/Q/this.internal.scaleFactor),I===0&&(I=Q*Y.width/Y.height),Q===0&&(Q=I*Y.height/Y.width),[I,Q]},B=function(I,Q,Y,z,ue,Z){var Ae=v.call(this,Y,z,ue),ve=this.internal.getCoordinateString,G=this.internal.getVerticalCoordinateString,Se=f.call(this);if(Y=Ae[0],z=Ae[1],Se[ue.index]=ue,Z){Z*=Math.PI/180;var we=Math.cos(Z),F=Math.sin(Z),R=function(P){return P.toFixed(4)},M=[R(we),R(F),R(-1*F),R(we),0,0,"cm"]}this.internal.write("q"),Z?(this.internal.write([1,"0","0",1,ve(I),G(Q+z),"cm"].join(" ")),this.internal.write(M.join(" ")),this.internal.write([ve(Y),"0","0",ve(z),"0","0","cm"].join(" "))):this.internal.write([ve(Y),"0","0",ve(z),ve(I),G(Q+z),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ue.index+" Do"),this.internal.write("Q")},k=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var N=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},S=e.__addimage__.sHashCode=function(I){var Q,Y,z=0;if(typeof I=="string")for(Y=I.length,Q=0;Q<Y;Q++)z=(z<<5)-z+I.charCodeAt(Q),z|=0;else if(U(I))for(Y=I.byteLength/2,Q=0;Q<Y;Q++)z=(z<<5)-z+I[Q],z|=0;return z},O=e.__addimage__.validateStringAsBase64=function(I){(I=I||"").toString().trim();var Q=!0;return I.length===0&&(Q=!1),I.length%4!=0&&(Q=!1),/^[A-Za-z0-9+/]+$/.test(I.substr(0,I.length-2))===!1&&(Q=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(I.substr(-2))===!1&&(Q=!1),Q},T=e.__addimage__.extractImageFromDataUrl=function(I){if(I==null||!(I=I.trim()).startsWith("data:"))return null;var Q=I.indexOf(",");return Q<0?null:I.substring(0,Q).trim().endsWith("base64")?I.substring(Q+1):null};e.__addimage__.isArrayBuffer=function(I){return I instanceof ArrayBuffer};var U=e.__addimage__.isArrayBufferView=function(I){return I instanceof Int8Array||I instanceof Uint8Array||I instanceof Uint8ClampedArray||I instanceof Int16Array||I instanceof Uint16Array||I instanceof Int32Array||I instanceof Uint32Array||I instanceof Float32Array||I instanceof Float64Array},D=e.__addimage__.binaryStringToUint8Array=function(I){for(var Q=I.length,Y=new Uint8Array(Q),z=0;z<Q;z++)Y[z]=I.charCodeAt(z);return Y},H=e.__addimage__.arrayBufferToBinaryString=function(I){for(var Q="",Y=U(I)?I:new Uint8Array(I),z=0;z<Y.length;z+=8192)Q+=String.fromCharCode.apply(null,Y.subarray(z,z+8192));return Q};e.addImage=function(){var I,Q,Y,z,ue,Z,Ae,ve,G;if(typeof arguments[1]=="number"?(Q=r,Y=arguments[1],z=arguments[2],ue=arguments[3],Z=arguments[4],Ae=arguments[5],ve=arguments[6],G=arguments[7]):(Q=arguments[1],Y=arguments[2],z=arguments[3],ue=arguments[4],Z=arguments[5],Ae=arguments[6],ve=arguments[7],G=arguments[8]),za(I=arguments[0])==="object"&&!x(I)&&"imageData"in I){var Se=I;I=Se.imageData,Q=Se.format||Q||r,Y=Se.x||Y||0,z=Se.y||z||0,ue=Se.w||Se.width||ue,Z=Se.h||Se.height||Z,Ae=Se.alias||Ae,ve=Se.compression||ve,G=Se.rotation||Se.angle||G}var we=this.internal.getFilters();if(ve===void 0&&we.indexOf("FlateEncode")!==-1&&(ve="SLOW"),isNaN(Y)||isNaN(z))throw new Error("Invalid coordinates passed to jsPDF.addImage");u.call(this);var F=j.call(this,I,Q,Ae,ve);return B.call(this,Y,z,ue,Z,F,G),this};var j=function(I,Q,Y,z){var ue,Z,Ae;if(typeof I=="string"&&n(I)===r){I=unescape(I);var ve=W(I,!1);(ve!==""||(ve=e.loadFile(I,!0))!==void 0)&&(I=ve)}if(x(I)&&(I=m(I,Q)),Q=n(I,Q),!g(Q))throw new Error("addImage does not support files of type '"+Q+"', please ensure that a plugin for '"+Q+"' support is added.");if(((Ae=Y)==null||Ae.length===0)&&(Y=(function(G){return typeof G=="string"||U(G)?S(G):U(G.data)?S(G.data):null})(I)),(ue=w.call(this,Y))||(I instanceof Uint8Array||Q==="RGBA"||(Z=I,I=D(I)),ue=this["process"+Q.toUpperCase()](I,h.call(this),Y,(function(G){return G&&typeof G=="string"&&(G=G.toUpperCase()),G in e.image_compression?G:N.NONE})(z),Z)),!ue)throw new Error("An unknown error occurred whilst processing the image.");return ue},W=e.__addimage__.convertBase64ToBinaryString=function(I,Q){Q=typeof Q!="boolean"||Q;var Y,z="";if(typeof I=="string"){var ue;Y=(ue=T(I))!==null&&ue!==void 0?ue:I;try{z=Km(Y)}catch(Z){if(Q)throw O(Y)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+Z.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return z};e.getImageProperties=function(I){var Q,Y,z="";if(x(I)&&(I=m(I)),typeof I=="string"&&n(I)===r&&((z=W(I,!1))===""&&(z=e.loadFile(I)||""),I=z),Y=n(I),!g(Y))throw new Error("addImage does not support files of type '"+Y+"', please ensure that a plugin for '"+Y+"' support is added.");if(I instanceof Uint8Array||(I=D(I)),!(Q=this["process"+Y.toUpperCase()](I)))throw new Error("An unknown error occurred whilst processing the image");return Q.fileType=Y,Q}})(gr.API),(function(e){var t=function(r){if(r!==void 0&&r!="")return!0};gr.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var a,n,s,l=this.internal.getCoordinateString,A=this.internal.getVerticalCoordinateString,u=this.internal.getPageInfoByObjId(r.objId),f=r.pageContext.annotations,h=!1,g=0;g<f.length&&!h;g++)switch((a=f[g]).type){case"link":(t(a.options.url)||t(a.options.pageNumber))&&(h=!0);break;case"reference":case"text":case"freetext":h=!0}if(h!=0){this.internal.write("/Annots [");for(var x=0;x<f.length;x++){a=f[x];var m=this.internal.pdfEscape,w=this.internal.getEncryptor(r.objId);switch(a.type){case"reference":this.internal.write(" "+a.object.objId+" 0 R ");break;case"text":var v=this.internal.newAdditionalObject(),B=this.internal.newAdditionalObject(),k=this.internal.getEncryptor(v.objId),N=a.title||"Note";s="<</Type /Annot /Subtype /Text "+(n="/Rect ["+l(a.bounds.x)+" "+A(a.bounds.y+a.bounds.h)+" "+l(a.bounds.x+a.bounds.w)+" "+A(a.bounds.y)+"] ")+"/Contents ("+m(k(a.contents))+")",s+=" /Popup "+B.objId+" 0 R",s+=" /P "+u.objId+" 0 R",s+=" /T ("+m(k(N))+") >>",v.content=s;var S=v.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(n="/Rect ["+l(a.bounds.x+30)+" "+A(a.bounds.y+a.bounds.h)+" "+l(a.bounds.x+a.bounds.w+30)+" "+A(a.bounds.y)+"] ")+" /Parent "+S,a.open&&(s+=" /Open true"),s+=" >>",B.content=s,this.internal.write(v.objId,"0 R",B.objId,"0 R");break;case"freetext":n="/Rect ["+l(a.bounds.x)+" "+A(a.bounds.y)+" "+l(a.bounds.x+a.bounds.w)+" "+A(a.bounds.y+a.bounds.h)+"] ";var O=a.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+n+"/Contents ("+m(w(a.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+O+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(a.options.name){var T=this.annotations._nameMap[a.options.name];a.options.pageNumber=T.page,a.options.top=T.y}else a.options.top||(a.options.top=0);if(n="/Rect ["+a.finalBounds.x+" "+a.finalBounds.y+" "+a.finalBounds.w+" "+a.finalBounds.h+"] ",s="",a.options.url)s="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /A <</S /URI /URI ("+m(w(a.options.url))+") >>";else if(a.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(a.options.pageNumber).objId+" 0 R",a.options.magFactor=a.options.magFactor||"XYZ",a.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+a.options.top+"]";break;case"FitV":a.options.left=a.options.left||0,s+=" /FitV "+a.options.left+"]";break;default:var U=A(a.options.top);a.options.left=a.options.left||0,a.options.zoom===void 0&&(a.options.zoom=0),s+=" /XYZ "+a.options.left+" "+U+" "+a.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var a=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":a.pageContext.annotations.push(r)}},e.link=function(r,a,n,s,l){var A=this.internal.getCurrentPageInfo(),u=this.internal.getCoordinateString,f=this.internal.getVerticalCoordinateString;A.pageContext.annotations.push({finalBounds:{x:u(r),y:f(a),w:u(r+n),h:f(a+s)},options:l,type:"link"})},e.textWithLink=function(r,a,n,s){var l,A,u=this.getTextWidth(r),f=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){A=s.maxWidth;var h=this.splitTextToSize(r,A).length;l=Math.ceil(f*h)}else A=u,l=f;return this.text(r,a,n,s),n+=.2*f,s.align==="center"&&(a-=u/2),s.align==="right"&&(a-=u),this.link(a,n-f,A,l,s),u},e.getTextWidth=function(r){var a=this.internal.getFontSize();return this.getStringUnitWidth(r)*a/this.internal.scaleFactor}})(gr.API),(function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},a={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},n=[1570,1571,1573,1575];e.__arabicParser__={};var s=e.__arabicParser__.isInArabicSubstitutionA=function(v){return t[v.charCodeAt(0)]!==void 0},l=e.__arabicParser__.isArabicLetter=function(v){return typeof v=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(v)},A=e.__arabicParser__.isArabicEndLetter=function(v){return l(v)&&s(v)&&t[v.charCodeAt(0)].length<=2},u=e.__arabicParser__.isArabicAlfLetter=function(v){return l(v)&&n.indexOf(v.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(v){return l(v)&&s(v)&&t[v.charCodeAt(0)].length>=1};var f=e.__arabicParser__.arabicLetterHasFinalForm=function(v){return l(v)&&s(v)&&t[v.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(v){return l(v)&&s(v)&&t[v.charCodeAt(0)].length>=3};var h=e.__arabicParser__.arabicLetterHasMedialForm=function(v){return l(v)&&s(v)&&t[v.charCodeAt(0)].length==4},g=e.__arabicParser__.resolveLigatures=function(v){var B=0,k=r,N="",S=0;for(B=0;B<v.length;B+=1)k[v.charCodeAt(B)]!==void 0?(S++,typeof(k=k[v.charCodeAt(B)])=="number"&&(N+=String.fromCharCode(k),k=r,S=0),B===v.length-1&&(k=r,N+=v.charAt(B-(S-1)),B-=S-1,S=0)):(k=r,N+=v.charAt(B-S),B-=S,S=0);return N};e.__arabicParser__.isArabicDiacritic=function(v){return v!==void 0&&a[v.charCodeAt(0)]!==void 0};var x=e.__arabicParser__.getCorrectForm=function(v,B,k){return l(v)?s(v)===!1?-1:!f(v)||!l(B)&&!l(k)||!l(k)&&A(B)||A(v)&&!l(B)||A(v)&&u(B)||A(v)&&A(B)?0:h(v)&&l(B)&&!A(B)&&l(k)&&f(k)?3:A(v)||!l(k)?1:2:-1},m=function(v){var B=0,k=0,N=0,S="",O="",T="",U=(v=v||"").split("\\s+"),D=[];for(B=0;B<U.length;B+=1){for(D.push(""),k=0;k<U[B].length;k+=1)S=U[B][k],O=U[B][k-1],T=U[B][k+1],l(S)?(N=x(S,O,T),D[B]+=N!==-1?String.fromCharCode(t[S.charCodeAt(0)][N]):S):D[B]+=S;D[B]=g(D[B])}return D.join(" ")},w=e.__arabicParser__.processArabic=e.processArabic=function(){var v,B=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,k=[];if(Array.isArray(B)){var N=0;for(k=[],N=0;N<B.length;N+=1)Array.isArray(B[N])?k.push([m(B[N][0]),B[N][1],B[N][2]]):k.push([m(B[N])]);v=k}else v=m(B);return typeof arguments[0]=="string"?v:(arguments[0].text=v,arguments[0])};e.events.push(["preProcessText",w])})(gr.API),gr.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},(function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(A){r=A}});var a=150;Object.defineProperty(this,"width",{get:function(){return a},set:function(A){a=isNaN(A)||Number.isInteger(A)===!1||A<0?150:A,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=a+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(A){n=isNaN(A)||Number.isInteger(A)===!1||A<0?300:A,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(A){s=A}});var l={};Object.defineProperty(this,"style",{get:function(){return l},set:function(A){l=A}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,a){var n;if((r=r||"2d")!=="2d")return null;for(n in a)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=a[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])})(gr.API),(function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,a=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),n.call(this))},n=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var u=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return u},set:function(v){u=v}});var f=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return f},set:function(v){f=v}});var h=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return h},set:function(v){h=v}});var g=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return g},set:function(v){g=v}});var x=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return x},set:function(v){x=v}});var m=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return m},set:function(v){m=v}});var w=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return w},set:function(v){w=v}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(u){return a.call(this),this.internal.__cell__.headerFunction=typeof u=="function"?u:void 0,this},e.getTextDimensions=function(u,f){a.call(this);var h=(f=f||{}).fontSize||this.getFontSize(),g=f.font||this.getFont(),x=f.scaleFactor||this.internal.scaleFactor,m=0,w=0,v=0,B=this;if(!Array.isArray(u)&&typeof u!="string"){if(typeof u!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");u=String(u)}var k=f.maxWidth;k>0?typeof u=="string"?u=this.splitTextToSize(u,k):Object.prototype.toString.call(u)==="[object Array]"&&(u=u.reduce(function(S,O){return S.concat(B.splitTextToSize(O,k))},[])):u=Array.isArray(u)?u:[u];for(var N=0;N<u.length;N++)m<(v=this.getStringUnitWidth(u[N],{font:g})*h)&&(m=v);return m!==0&&(w=u.length),{w:m/=x,h:Math.max((w*h*this.getLineHeightFactor()-h*(this.getLineHeightFactor()-1))/x,0)}},e.cellAddPage=function(){a.call(this),this.addPage();var u=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new s(u.left,u.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var l=e.cell=function(){var u;u=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),a.call(this);var f=this.internal.__cell__.lastCell,h=this.internal.__cell__.padding,g=this.internal.__cell__.margins||t,x=this.internal.__cell__.tableHeaderRow,m=this.internal.__cell__.printHeaders;return f.lineNumber!==void 0&&(f.lineNumber===u.lineNumber?(u.x=(f.x||0)+(f.width||0),u.y=f.y||0):f.y+f.height+u.height+g.bottom>this.getPageHeight()?(this.cellAddPage(),u.y=g.top,m&&x&&(this.printHeaderRow(u.lineNumber,!0),u.y+=x[0].height)):u.y=f.y+f.height||u.y),u.text[0]!==void 0&&(this.rect(u.x,u.y,u.width,u.height,r===!0?"FD":void 0),u.align==="right"?this.text(u.text,u.x+u.width-h,u.y+h,{align:"right",baseline:"top"}):u.align==="center"?this.text(u.text,u.x+u.width/2,u.y+h,{align:"center",baseline:"top",maxWidth:u.width-h-h}):this.text(u.text,u.x+h,u.y+h,{align:"left",baseline:"top",maxWidth:u.width-h-h})),this.internal.__cell__.lastCell=u,this};e.table=function(u,f,h,g,x){if(a.call(this),!h)throw new Error("No data for PDF table.");var m,w,v,B,k=[],N=[],S=[],O={},T={},U=[],D=[],H=(x=x||{}).autoSize||!1,j=x.printHeaders!==!1,W=x.css&&x.css["font-size"]!==void 0?16*x.css["font-size"]:x.fontSize||12,I=x.margins||Object.assign({width:this.getPageWidth()},t),Q=typeof x.padding=="number"?x.padding:3,Y=x.headerBackgroundColor||"#c8c8c8",z=x.headerTextColor||"#000";if(n.call(this),this.internal.__cell__.printHeaders=j,this.internal.__cell__.margins=I,this.internal.__cell__.table_font_size=W,this.internal.__cell__.padding=Q,this.internal.__cell__.headerBackgroundColor=Y,this.internal.__cell__.headerTextColor=z,this.setFontSize(W),g==null)N=k=Object.keys(h[0]),S=k.map(function(){return"left"});else if(Array.isArray(g)&&za(g[0])==="object")for(k=g.map(function(Se){return Se.name}),N=g.map(function(Se){return Se.prompt||Se.name||""}),S=g.map(function(Se){return Se.align||"left"}),m=0;m<g.length;m+=1)T[g[m].name]=.7499990551181103*g[m].width;else Array.isArray(g)&&typeof g[0]=="string"&&(N=k=g,S=k.map(function(){return"left"}));if(H||Array.isArray(g)&&typeof g[0]=="string")for(m=0;m<k.length;m+=1){for(O[B=k[m]]=h.map(function(Se){return Se[B]}),this.setFont(void 0,"bold"),U.push(this.getTextDimensions(N[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),w=O[B],this.setFont(void 0,"normal"),v=0;v<w.length;v+=1)U.push(this.getTextDimensions(w[v],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);T[B]=Math.max.apply(null,U)+Q+Q,U=[]}if(j){var ue={};for(m=0;m<k.length;m+=1)ue[k[m]]={},ue[k[m]].text=N[m],ue[k[m]].align=S[m];var Z=A.call(this,ue,T);D=k.map(function(Se){return new s(u,f,T[Se],Z,ue[Se].text,void 0,ue[Se].align)}),this.setTableHeaderRow(D),this.printHeaderRow(1,!1)}var Ae=g.reduce(function(Se,we){return Se[we.name]=we.align,Se},{});for(m=0;m<h.length;m+=1){"rowStart"in x&&x.rowStart instanceof Function&&x.rowStart({row:m,data:h[m]},this);var ve=A.call(this,h[m],T);for(v=0;v<k.length;v+=1){var G=h[m][k[v]];"cellStart"in x&&x.cellStart instanceof Function&&x.cellStart({row:m,col:v,data:G},this),l.call(this,new s(u,f,T[k[v]],ve,G,m+2,Ae[k[v]]))}}return this.internal.__cell__.table_x=u,this.internal.__cell__.table_y=f,this};var A=function(u,f){var h=this.internal.__cell__.padding,g=this.internal.__cell__.table_font_size,x=this.internal.scaleFactor;return Object.keys(u).map(function(m){var w=u[m];return this.splitTextToSize(w.hasOwnProperty("text")?w.text:w,f[m]-h-h)},this).map(function(m){return this.getLineHeightFactor()*m.length*g/x+h+h},this).reduce(function(m,w){return Math.max(m,w)},0)};e.setTableHeaderRow=function(u){a.call(this),this.internal.__cell__.tableHeaderRow=u},e.printHeaderRow=function(u,f){if(a.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var h;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var g=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(g[0],g[1],g[2],g[3],void 0,-1)}this.setFont(void 0,"bold");for(var x=[],m=0;m<this.internal.__cell__.tableHeaderRow.length;m+=1){h=this.internal.__cell__.tableHeaderRow[m].clone(),f&&(h.y=this.internal.__cell__.margins.top||0,x.push(h)),h.lineNumber=u;var w=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),l.call(this,h),this.setTextColor(w)}x.length>0&&this.setTableHeaderRow(x),this.setFont(void 0,"normal"),r=!1}})(gr.API);var NT={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},FT=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],n2=ET(FT),TT=[100,200,300,400,500,600,700,800,900],Lee=ET(TT);function Pv(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=(function(s){return NT[s=s||"normal"]?s:"normal"})(e.style),a=(function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400})(e.weight),n=(function(s){return typeof n2[s=s||"normal"]=="number"?s:"normal"})(e.stretch);return{family:t,style:r,weight:a,stretch:n,src:e.src||[],ref:e.ref||{name:t,style:[n,r,a].join(" ")}}}function zC(e,t,r,a){var n;for(n=r;n>=0&&n<t.length;n+=a)if(e[t[n]])return e[t[n]];for(n=r;n>=0&&n<t.length;n-=a)if(e[t[n]])return e[t[n]]}var Uee={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},VC={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function GC(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function WC(e){return e.trimLeft()}function jee(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function Dee(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var Vd,jm,XC,YC,$C,Kv=["times"];function JC(e,t,r,a,n){var s=4,l=eS;switch(n){case gr.API.image_compression.FAST:s=1,l=ZC;break;case gr.API.image_compression.MEDIUM:s=6,l=tS;break;case gr.API.image_compression.SLOW:s=9,l=rS}e=(function(u,f,h,g){for(var x,m=u.length/f,w=new Uint8Array(u.length+m),v=[Iee,ZC,eS,tS,rS],B=0;B<m;B+=1){var k=B*f,N=u.subarray(k,k+f);if(g)w.set(g(N,h,x),k+B);else{for(var S=v.length,O=[],T=0;T<S;T+=1)O[T]=v[T](N,h,x);var U=Oee(O.concat());w.set(O[U],k+B)}x=N}return w})(e,t,Math.ceil(r*a/8),l);var A=$w(e,{level:s});return gr.API.__addimage__.arrayBufferToBinaryString(A)}function Iee(e){var t=Array.apply([],e);return t.unshift(0),t}function ZC(e,t){var r=e.length,a=[];a[0]=1;for(var n=0;n<r;n+=1){var s=e[n-t]||0;a[n+1]=e[n]-s+256&255}return a}function eS(e,t,r){var a=e.length,n=[];n[0]=2;for(var s=0;s<a;s+=1){var l=r&&r[s]||0;n[s+1]=e[s]-l+256&255}return n}function tS(e,t,r){var a=e.length,n=[];n[0]=3;for(var s=0;s<a;s+=1){var l=e[s-t]||0,A=r&&r[s]||0;n[s+1]=e[s]+256-(l+A>>>1)&255}return n}function rS(e,t,r){var a=e.length,n=[];n[0]=4;for(var s=0;s<a;s+=1){var l=Qee(e[s-t]||0,r&&r[s]||0,r&&r[s-t]||0);n[s+1]=e[s]-l+256&255}return n}function Qee(e,t,r){if(e===t&&t===r)return e;var a=Math.abs(t-r),n=Math.abs(e-r),s=Math.abs(e+t-r-r);return a<=n&&a<=s?e:n<=s?t:r}function Oee(e){var t=e.map(function(r){return r.reduce(function(a,n){return a+Math.abs(n)},0)});return t.indexOf(Math.min.apply(null,t))}function qv(e,t,r){var a=t*r,n=Math.floor(a/8),s=16-(a-8*n+r),l=(1<<r)-1;return LT(e,n)>>s&l}function aS(e,t,r,a){var n=r*a,s=Math.floor(n/8),l=16-(n-8*s+a),A=(1<<a)-1,u=(t&A)<<l;(function(f,h,g){if(h+1<f.byteLength)f.setUint16(h,g,!1);else{var x=g>>8&255;f.setUint8(h,x)}})(e,s,LT(e,s)&~(A<<l)&65535|u)}function LT(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function Ree(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,a=e[t++]|e[t++]<<8,n=e[t++],s=n>>7,l=1<<1+(7&n);e[t++],e[t++];var A=null,u=null;s&&(A=t,u=l,t+=3*l);var f=!0,h=[],g=0,x=null,m=0,w=null;for(this.width=r,this.height=a;f&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,w=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((I=e[t++])>=0))throw Error("Invalid block size");if(I===0)break;t+=I}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var v=e[t++];g=e[t++]|e[t++]<<8,x=e[t++],1&v||(x=null),m=v>>2&7,t++;break;case 254:for(;;){if(!((I=e[t++])>=0))throw Error("Invalid block size");if(I===0)break;t+=I}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var B=e[t++]|e[t++]<<8,k=e[t++]|e[t++]<<8,N=e[t++]|e[t++]<<8,S=e[t++]|e[t++]<<8,O=e[t++],T=O>>6&1,U=1<<1+(7&O),D=A,H=u,j=!1;O>>7&&(j=!0,D=t,H=U,t+=3*U);var W=t;for(t++;;){var I;if(!((I=e[t++])>=0))throw Error("Invalid block size");if(I===0)break;t+=I}h.push({x:B,y:k,width:N,height:S,has_local_palette:j,palette_offset:D,palette_size:H,data_offset:W,data_length:t-W,transparent_index:x,interlaced:!!T,delay:g,disposal:m});break;case 59:f=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return h.length},this.loopCount=function(){return w},this.frameInfo=function(Q){if(Q<0||Q>=h.length)throw new Error("Frame index out of range.");return h[Q]},this.decodeAndBlitFrameBGRA=function(Q,Y){var z=this.frameInfo(Q),ue=z.width*z.height,Z=new Uint8Array(ue);nS(e,z.data_offset,Z,ue);var Ae=z.palette_offset,ve=z.transparent_index;ve===null&&(ve=256);var G=z.width,Se=r-G,we=G,F=4*(z.y*r+z.x),R=4*((z.y+z.height)*r+z.x),M=F,P=4*Se;z.interlaced===!0&&(P+=4*r*7);for(var re=8,ge=0,Ce=Z.length;ge<Ce;++ge){var de=Z[ge];if(we===0&&(we=G,(M+=P)>=R&&(P=4*Se+4*r*(re-1),M=F+(G+Se)*(re<<1),re>>=1)),de===ve)M+=4;else{var be=e[Ae+3*de],Le=e[Ae+3*de+1],ie=e[Ae+3*de+2];Y[M++]=ie,Y[M++]=Le,Y[M++]=be,Y[M++]=255}--we}},this.decodeAndBlitFrameRGBA=function(Q,Y){var z=this.frameInfo(Q),ue=z.width*z.height,Z=new Uint8Array(ue);nS(e,z.data_offset,Z,ue);var Ae=z.palette_offset,ve=z.transparent_index;ve===null&&(ve=256);var G=z.width,Se=r-G,we=G,F=4*(z.y*r+z.x),R=4*((z.y+z.height)*r+z.x),M=F,P=4*Se;z.interlaced===!0&&(P+=4*r*7);for(var re=8,ge=0,Ce=Z.length;ge<Ce;++ge){var de=Z[ge];if(we===0&&(we=G,(M+=P)>=R&&(P=4*Se+4*r*(re-1),M=F+(G+Se)*(re<<1),re>>=1)),de===ve)M+=4;else{var be=e[Ae+3*de],Le=e[Ae+3*de+1],ie=e[Ae+3*de+2];Y[M++]=be,Y[M++]=Le,Y[M++]=ie,Y[M++]=255}--we}}}function nS(e,t,r,a){for(var n=e[t++],s=1<<n,l=s+1,A=l+1,u=n+1,f=(1<<u)-1,h=0,g=0,x=0,m=e[t++],w=new Int32Array(4096),v=null;;){for(;h<16&&m!==0;)g|=e[t++]<<h,h+=8,m===1?m=e[t++]:--m;if(h<u)break;var B=g&f;if(g>>=u,h-=u,B!==s){if(B===l)break;for(var k=B<A?B:v,N=0,S=k;S>s;)S=w[S]>>8,++N;var O=S;if(x+N+(k!==B?1:0)>a)return void cn.log("Warning, gif stream longer than expected.");r[x++]=O;var T=x+=N;for(k!==B&&(r[x++]=O),S=k;N--;)S=w[S],r[--T]=255&S,S>>=8;v!==null&&A<4096&&(w[A++]=v<<8|O,A>=f+1&&u<12&&(++u,f=f<<1|1)),v=B}else A=l+1,f=(1<<(u=n+1))-1,v=null}return x!==a&&cn.log("Warning, gif stream shorter than expected."),r}function zv(e){var t,r,a,n,s,l=Math.floor,A=new Array(64),u=new Array(64),f=new Array(64),h=new Array(64),g=new Array(65535),x=new Array(65535),m=new Array(64),w=new Array(64),v=[],B=0,k=7,N=new Array(64),S=new Array(64),O=new Array(64),T=new Array(256),U=new Array(2048),D=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],H=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],j=[0,1,2,3,4,5,6,7,8,9,10,11],W=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],I=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],Q=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],Y=[0,1,2,3,4,5,6,7,8,9,10,11],z=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ue=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function Z(F,R){for(var M=0,P=0,re=new Array,ge=1;ge<=16;ge++){for(var Ce=1;Ce<=F[ge];Ce++)re[R[P]]=[],re[R[P]][0]=M,re[R[P]][1]=ge,P++,M++;M*=2}return re}function Ae(F){for(var R=F[0],M=F[1]-1;M>=0;)R&1<<M&&(B|=1<<k),M--,--k<0&&(B==255?(ve(255),ve(0)):ve(B),k=7,B=0)}function ve(F){v.push(F)}function G(F){ve(F>>8&255),ve(255&F)}function Se(F,R,M,P,re){for(var ge,Ce=re[0],de=re[240],be=(function(Xe,Ut){var yt,qt,Lt,jt,Pt,zt,Jt,It,xt,ht,Bt=0;for(xt=0;xt<8;++xt){yt=Xe[Bt],qt=Xe[Bt+1],Lt=Xe[Bt+2],jt=Xe[Bt+3],Pt=Xe[Bt+4],zt=Xe[Bt+5],Jt=Xe[Bt+6];var pr=yt+(It=Xe[Bt+7]),$t=yt-It,Ee=qt+Jt,at=qt-Jt,it=Lt+zt,bt=Lt-zt,Et=jt+Pt,mt=jt-Pt,Ot=pr+Et,Ur=pr-Et,Vt=Ee+it,tt=Ee-it;Xe[Bt]=Ot+Vt,Xe[Bt+4]=Ot-Vt;var Wt=.707106781*(tt+Ur);Xe[Bt+2]=Ur+Wt,Xe[Bt+6]=Ur-Wt;var Me=.382683433*((Ot=mt+bt)-(tt=at+$t)),kt=.5411961*Ot+Me,Tt=1.306562965*tt+Me,ir=.707106781*(Vt=bt+at),Nt=$t+ir,Sr=$t-ir;Xe[Bt+5]=Sr+kt,Xe[Bt+3]=Sr-kt,Xe[Bt+1]=Nt+Tt,Xe[Bt+7]=Nt-Tt,Bt+=8}for(Bt=0,xt=0;xt<8;++xt){yt=Xe[Bt],qt=Xe[Bt+8],Lt=Xe[Bt+16],jt=Xe[Bt+24],Pt=Xe[Bt+32],zt=Xe[Bt+40],Jt=Xe[Bt+48];var ca=yt+(It=Xe[Bt+56]),Hr=yt-It,Br=qt+Jt,jr=qt-Jt,Er=Lt+zt,ae=Lt-zt,xe=jt+Pt,fe=jt-Pt,pe=ca+xe,K=ca-xe,se=Br+Er,Fe=Br-Er;Xe[Bt]=pe+se,Xe[Bt+32]=pe-se;var Re=.707106781*(Fe+K);Xe[Bt+16]=K+Re,Xe[Bt+48]=K-Re;var Qe=.382683433*((pe=fe+ae)-(Fe=jr+Hr)),Pe=.5411961*pe+Qe,qe=1.306562965*Fe+Qe,pt=.707106781*(se=ae+jr),et=Hr+pt,Rt=Hr-pt;Xe[Bt+40]=Rt+Pe,Xe[Bt+24]=Rt-Pe,Xe[Bt+8]=et+qe,Xe[Bt+56]=et-qe,Bt++}for(xt=0;xt<64;++xt)ht=Xe[xt]*Ut[xt],m[xt]=ht>0?ht+.5|0:ht-.5|0;return m})(F,R),Le=0;Le<64;++Le)w[D[Le]]=be[Le];var ie=w[0]-M;M=w[0],ie==0?Ae(P[0]):(Ae(P[x[ge=32767+ie]]),Ae(g[ge]));for(var _e=63;_e>0&&w[_e]==0;)_e--;if(_e==0)return Ae(Ce),M;for(var je,J=1;J<=_e;){for(var ze=J;w[J]==0&&J<=_e;)++J;var He=J-ze;if(He>=16){je=He>>4;for(var ct=1;ct<=je;++ct)Ae(de);He&=15}ge=32767+w[J],Ae(re[(He<<4)+x[ge]]),Ae(g[ge]),J++}return _e!=63&&Ae(Ce),M}function we(F){F=Math.min(Math.max(F,1),100),s!=F&&((function(R){for(var M=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],P=0;P<64;P++){var re=l((M[P]*R+50)/100);re=Math.min(Math.max(re,1),255),A[D[P]]=re}for(var ge=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Ce=0;Ce<64;Ce++){var de=l((ge[Ce]*R+50)/100);de=Math.min(Math.max(de,1),255),u[D[Ce]]=de}for(var be=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Le=0,ie=0;ie<8;ie++)for(var _e=0;_e<8;_e++)f[Le]=1/(A[D[Le]]*be[ie]*be[_e]*8),h[Le]=1/(u[D[Le]]*be[ie]*be[_e]*8),Le++})(F<50?Math.floor(5e3/F):Math.floor(200-2*F)),s=F)}this.encode=function(F,R){R&&we(R),v=new Array,B=0,k=7,G(65496),G(65504),G(16),ve(74),ve(70),ve(73),ve(70),ve(0),ve(1),ve(1),ve(0),G(1),G(1),ve(0),ve(0),(function(){G(65499),G(132),ve(0);for(var qt=0;qt<64;qt++)ve(A[qt]);ve(1);for(var Lt=0;Lt<64;Lt++)ve(u[Lt])})(),(function(qt,Lt){G(65472),G(17),ve(8),G(Lt),G(qt),ve(3),ve(1),ve(17),ve(0),ve(2),ve(17),ve(1),ve(3),ve(17),ve(1)})(F.width,F.height),(function(){G(65476),G(418),ve(0);for(var qt=0;qt<16;qt++)ve(H[qt+1]);for(var Lt=0;Lt<=11;Lt++)ve(j[Lt]);ve(16);for(var jt=0;jt<16;jt++)ve(W[jt+1]);for(var Pt=0;Pt<=161;Pt++)ve(I[Pt]);ve(1);for(var zt=0;zt<16;zt++)ve(Q[zt+1]);for(var Jt=0;Jt<=11;Jt++)ve(Y[Jt]);ve(17);for(var It=0;It<16;It++)ve(z[It+1]);for(var xt=0;xt<=161;xt++)ve(ue[xt])})(),G(65498),G(12),ve(3),ve(1),ve(0),ve(2),ve(17),ve(3),ve(17),ve(0),ve(63),ve(0);var M=0,P=0,re=0;B=0,k=7,this.encode.displayName="_encode_";for(var ge,Ce,de,be,Le,ie,_e,je,J,ze=F.data,He=F.width,ct=F.height,Xe=4*He,Ut=0;Ut<ct;){for(ge=0;ge<Xe;){for(Le=Xe*Ut+ge,_e=-1,je=0,J=0;J<64;J++)ie=Le+(je=J>>3)*Xe+(_e=4*(7&J)),Ut+je>=ct&&(ie-=Xe*(Ut+1+je-ct)),ge+_e>=Xe&&(ie-=ge+_e-Xe+4),Ce=ze[ie++],de=ze[ie++],be=ze[ie++],N[J]=(U[Ce]+U[de+256|0]+U[be+512|0]>>16)-128,S[J]=(U[Ce+768|0]+U[de+1024|0]+U[be+1280|0]>>16)-128,O[J]=(U[Ce+1280|0]+U[de+1536|0]+U[be+1792|0]>>16)-128;M=Se(N,f,M,t,a),P=Se(S,h,P,r,n),re=Se(O,h,re,r,n),ge+=32}Ut+=8}if(k>=0){var yt=[];yt[1]=k+1,yt[0]=(1<<k+1)-1,Ae(yt)}return G(65497),new Uint8Array(v)},e=e||50,(function(){for(var F=String.fromCharCode,R=0;R<256;R++)T[R]=F(R)})(),t=Z(H,j),r=Z(Q,Y),a=Z(W,I),n=Z(z,ue),(function(){for(var F=1,R=2,M=1;M<=15;M++){for(var P=F;P<R;P++)x[32767+P]=M,g[32767+P]=[],g[32767+P][1]=M,g[32767+P][0]=P;for(var re=-(R-1);re<=-F;re++)x[32767+re]=M,g[32767+re]=[],g[32767+re][1]=M,g[32767+re][0]=R-1+re;F<<=1,R<<=1}})(),(function(){for(var F=0;F<256;F++)U[F]=19595*F,U[F+256|0]=38470*F,U[F+512|0]=7471*F+32768,U[F+768|0]=-11059*F,U[F+1024|0]=-21709*F,U[F+1280|0]=32768*F+8421375,U[F+1536|0]=-27439*F,U[F+1792|0]=-5329*F})(),we(e)}function nA(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function sS(e){function t(j){if(!j)throw Error("assert :P")}function r(j,W,I){for(var Q=0;4>Q;Q++)if(j[W+Q]!=I.charCodeAt(Q))return!0;return!1}function a(j,W,I,Q,Y){for(var z=0;z<Y;z++)j[W+z]=I[Q+z]}function n(j,W,I,Q){for(var Y=0;Y<Q;Y++)j[W+Y]=I}function s(j){return new Int32Array(j)}function l(j,W){for(var I=[],Q=0;Q<j;Q++)I.push(new W);return I}function A(j,W){var I=[];return(function Q(Y,z,ue){for(var Z=ue[z],Ae=0;Ae<Z&&(Y.push(ue.length>z+1?[]:new W),!(ue.length<z+1));Ae++)Q(Y[Ae],z+1,ue)})(I,0,j),I}var u=function(){var j=this;function W(b,_){for(var L=1<<_-1>>>0;b&L;)L>>>=1;return L?(b&L-1)+L:b}function I(b,_,L,q,te){t(!(q%L));do b[_+(q-=L)]=te;while(0<q)}function Q(b,_,L,q,te){if(t(2328>=te),512>=te)var le=s(512);else if((le=s(te))==null)return 0;return(function(oe,he,me,ke,Ue,Ye){var ye,Oe,Ge=he,st=1<<me,We=s(16),nt=s(16);for(t(Ue!=0),t(ke!=null),t(oe!=null),t(0<me),Oe=0;Oe<Ue;++Oe){if(15<ke[Oe])return 0;++We[ke[Oe]]}if(We[0]==Ue)return 0;for(nt[1]=0,ye=1;15>ye;++ye){if(We[ye]>1<<ye)return 0;nt[ye+1]=nt[ye]+We[ye]}for(Oe=0;Oe<Ue;++Oe)ye=ke[Oe],0<ke[Oe]&&(Ye[nt[ye]++]=Oe);if(nt[15]==1)return(ke=new Y).g=0,ke.value=Ye[0],I(oe,Ge,1,st,ke),st;var dt,St=-1,vt=st-1,lr=0,Zt=1,Or=1,nr=1<<me;for(Oe=0,ye=1,Ue=2;ye<=me;++ye,Ue<<=1){if(Zt+=Or<<=1,0>(Or-=We[ye]))return 0;for(;0<We[ye];--We[ye])(ke=new Y).g=ye,ke.value=Ye[Oe++],I(oe,Ge+lr,Ue,nr,ke),lr=W(lr,ye)}for(ye=me+1,Ue=2;15>=ye;++ye,Ue<<=1){if(Zt+=Or<<=1,0>(Or-=We[ye]))return 0;for(;0<We[ye];--We[ye]){if(ke=new Y,(lr&vt)!=St){for(Ge+=nr,dt=1<<(St=ye)-me;15>St&&!(0>=(dt-=We[St]));)++St,dt<<=1;st+=nr=1<<(dt=St-me),oe[he+(St=lr&vt)].g=dt+me,oe[he+St].value=Ge-he-St}ke.g=ye-me,ke.value=Ye[Oe++],I(oe,Ge+(lr>>me),Ue,nr,ke),lr=W(lr,ye)}}return Zt!=2*nt[15]-1?0:st})(b,_,L,q,te,le)}function Y(){this.value=this.g=0}function z(){this.value=this.g=0}function ue(){this.G=l(5,Y),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=l(qr,z)}function Z(b,_,L,q){t(b!=null),t(_!=null),t(2147483648>q),b.Ca=254,b.I=0,b.b=-8,b.Ka=0,b.oa=_,b.pa=L,b.Jd=_,b.Yc=L+q,b.Zc=4<=q?L+q-4+1:L,Ce(b)}function Ae(b,_){for(var L=0;0<_--;)L|=be(b,128)<<_;return L}function ve(b,_){var L=Ae(b,_);return de(b)?-L:L}function G(b,_,L,q){var te,le=0;for(t(b!=null),t(_!=null),t(4294967288>q),b.Sb=q,b.Ra=0,b.u=0,b.h=0,4<q&&(q=4),te=0;te<q;++te)le+=_[L+te]<<8*te;b.Ra=le,b.bb=q,b.oa=_,b.pa=L}function Se(b){for(;8<=b.u&&b.bb<b.Sb;)b.Ra>>>=8,b.Ra+=b.oa[b.pa+b.bb]<<$r-8>>>0,++b.bb,b.u-=8;P(b)&&(b.h=1,b.u=0)}function we(b,_){if(t(0<=_),!b.h&&_<=mr){var L=M(b)&Fr[_];return b.u+=_,Se(b),L}return b.h=1,b.u=0}function F(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function R(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function M(b){return b.Ra>>>(b.u&$r-1)>>>0}function P(b){return t(b.bb<=b.Sb),b.h||b.bb==b.Sb&&b.u>$r}function re(b,_){b.u=_,b.h=P(b)}function ge(b){b.u>=sn&&(t(b.u>=sn),Se(b))}function Ce(b){t(b!=null&&b.oa!=null),b.pa<b.Zc?(b.I=(b.oa[b.pa++]|b.I<<8)>>>0,b.b+=8):(t(b!=null&&b.oa!=null),b.pa<b.Yc?(b.b+=8,b.I=b.oa[b.pa++]|b.I<<8):b.Ka?b.b=0:(b.I<<=8,b.b+=8,b.Ka=1))}function de(b){return Ae(b,1)}function be(b,_){var L=b.Ca;0>b.b&&Ce(b);var q=b.b,te=L*_>>>8,le=(b.I>>>q>te)+0;for(le?(L-=te,b.I-=te+1<<q>>>0):L=te+1,q=L,te=0;256<=q;)te+=8,q>>=8;return q=7^te+Tr[q],b.b-=q,b.Ca=(L<<q)-1,le}function Le(b,_,L){b[_+0]=L>>24&255,b[_+1]=L>>16&255,b[_+2]=L>>8&255,b[_+3]=255&L}function ie(b,_){return b[_+0]|b[_+1]<<8}function _e(b,_){return ie(b,_)|b[_+2]<<16}function je(b,_){return ie(b,_)|ie(b,_+2)<<16}function J(b,_){var L=1<<_;return t(b!=null),t(0<_),b.X=s(L),b.X==null?0:(b.Mb=32-_,b.Xa=_,1)}function ze(b,_){t(b!=null),t(_!=null),t(b.Xa==_.Xa),a(_.X,0,b.X,0,1<<_.Xa)}function He(){this.X=[],this.Xa=this.Mb=0}function ct(b,_,L,q){t(L!=null),t(q!=null);var te=L[0],le=q[0];return te==0&&(te=(b*le+_/2)/_),le==0&&(le=(_*te+b/2)/b),0>=te||0>=le?0:(L[0]=te,q[0]=le,1)}function Xe(b,_){return b+(1<<_)-1>>>_}function Ut(b,_){return((4278255360&b)+(4278255360&_)>>>0&4278255360)+((16711935&b)+(16711935&_)>>>0&16711935)>>>0}function yt(b,_){j[_]=function(L,q,te,le,oe,he,me){var ke;for(ke=0;ke<oe;++ke){var Ue=j[b](he[me+ke-1],te,le+ke);he[me+ke]=Ut(L[q+ke],Ue)}}}function qt(){this.ud=this.hd=this.jd=0}function Lt(b,_){return((4278124286&(b^_))>>>1)+(b&_)>>>0}function jt(b){return 0<=b&&256>b?b:0>b?0:255<b?255:void 0}function Pt(b,_){return jt(b+(b-_+.5>>1))}function zt(b,_,L){return Math.abs(_-L)-Math.abs(b-L)}function Jt(b,_,L,q,te,le,oe){for(q=le[oe-1],L=0;L<te;++L)le[oe+L]=q=Ut(b[_+L],q)}function It(b,_,L,q,te){var le;for(le=0;le<L;++le){var oe=b[_+le],he=oe>>8&255,me=16711935&(me=(me=16711935&oe)+((he<<16)+he));q[te+le]=(4278255360&oe)+me>>>0}}function xt(b,_){_.jd=255&b,_.hd=b>>8&255,_.ud=b>>16&255}function ht(b,_,L,q,te,le){var oe;for(oe=0;oe<q;++oe){var he=_[L+oe],me=he>>>8,ke=he,Ue=255&(Ue=(Ue=he>>>16)+((b.jd<<24>>24)*(me<<24>>24)>>>5));ke=255&(ke=(ke+=(b.hd<<24>>24)*(me<<24>>24)>>>5)+((b.ud<<24>>24)*(Ue<<24>>24)>>>5)),te[le+oe]=(4278255360&he)+(Ue<<16)+ke}}function Bt(b,_,L,q,te){j[_]=function(le,oe,he,me,ke,Ue,Ye,ye,Oe){for(me=Ye;me<ye;++me)for(Ye=0;Ye<Oe;++Ye)ke[Ue++]=te(he[q(le[oe++])])},j[b]=function(le,oe,he,me,ke,Ue,Ye){var ye=8>>le.b,Oe=le.Ea,Ge=le.K[0],st=le.w;if(8>ye)for(le=(1<<le.b)-1,st=(1<<ye)-1;oe<he;++oe){var We,nt=0;for(We=0;We<Oe;++We)We&le||(nt=q(me[ke++])),Ue[Ye++]=te(Ge[nt&st]),nt>>=ye}else j["VP8LMapColor"+L](me,ke,Ge,st,Ue,Ye,oe,he,Oe)}}function pr(b,_,L,q,te){for(L=_+L;_<L;){var le=b[_++];q[te++]=le>>16&255,q[te++]=le>>8&255,q[te++]=255&le}}function $t(b,_,L,q,te){for(L=_+L;_<L;){var le=b[_++];q[te++]=le>>16&255,q[te++]=le>>8&255,q[te++]=255&le,q[te++]=le>>24&255}}function Ee(b,_,L,q,te){for(L=_+L;_<L;){var le=(oe=b[_++])>>16&240|oe>>12&15,oe=240&oe|oe>>28&15;q[te++]=le,q[te++]=oe}}function at(b,_,L,q,te){for(L=_+L;_<L;){var le=(oe=b[_++])>>16&248|oe>>13&7,oe=oe>>5&224|oe>>3&31;q[te++]=le,q[te++]=oe}}function it(b,_,L,q,te){for(L=_+L;_<L;){var le=b[_++];q[te++]=255&le,q[te++]=le>>8&255,q[te++]=le>>16&255}}function bt(b,_,L,q,te,le){if(le==0)for(L=_+L;_<L;)Le(q,((le=b[_++])[0]>>24|le[1]>>8&65280|le[2]<<8&16711680|le[3]<<24)>>>0),te+=32;else a(q,te,b,_,L)}function Et(b,_){j[_][0]=j[b+"0"],j[_][1]=j[b+"1"],j[_][2]=j[b+"2"],j[_][3]=j[b+"3"],j[_][4]=j[b+"4"],j[_][5]=j[b+"5"],j[_][6]=j[b+"6"],j[_][7]=j[b+"7"],j[_][8]=j[b+"8"],j[_][9]=j[b+"9"],j[_][10]=j[b+"10"],j[_][11]=j[b+"11"],j[_][12]=j[b+"12"],j[_][13]=j[b+"13"],j[_][14]=j[b+"0"],j[_][15]=j[b+"0"]}function mt(b){return b==o0||b==ad||b==Zc||b==nd}function Ot(){this.eb=[],this.size=this.A=this.fb=0}function Ur(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Vt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Ot,this.f.kb=new Ur,this.sd=null}function tt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Wt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Me(b){return alert("todo:WebPSamplerProcessPlane"),b.T}function kt(b,_){var L=b.T,q=_.ba.f.RGBA,te=q.eb,le=q.fb+b.ka*q.A,oe=Qs[_.ba.S],he=b.y,me=b.O,ke=b.f,Ue=b.N,Ye=b.ea,ye=b.W,Oe=_.cc,Ge=_.dc,st=_.Mc,We=_.Nc,nt=b.ka,dt=b.ka+b.T,St=b.U,vt=St+1>>1;for(nt==0?oe(he,me,null,null,ke,Ue,Ye,ye,ke,Ue,Ye,ye,te,le,null,null,St):(oe(_.ec,_.fc,he,me,Oe,Ge,st,We,ke,Ue,Ye,ye,te,le-q.A,te,le,St),++L);nt+2<dt;nt+=2)Oe=ke,Ge=Ue,st=Ye,We=ye,Ue+=b.Rc,ye+=b.Rc,le+=2*q.A,oe(he,(me+=2*b.fa)-b.fa,he,me,Oe,Ge,st,We,ke,Ue,Ye,ye,te,le-q.A,te,le,St);return me+=b.fa,b.j+dt<b.o?(a(_.ec,_.fc,he,me,St),a(_.cc,_.dc,ke,Ue,vt),a(_.Mc,_.Nc,Ye,ye,vt),L--):1&dt||oe(he,me,null,null,ke,Ue,Ye,ye,ke,Ue,Ye,ye,te,le+q.A,null,null,St),L}function Tt(b,_,L){var q=b.F,te=[b.J];if(q!=null){var le=b.U,oe=_.ba.S,he=oe==l0||oe==Zc;_=_.ba.f.RGBA;var me=[0],ke=b.ka;me[0]=b.T,b.Kb&&(ke==0?--me[0]:(--ke,te[0]-=b.width),b.j+b.ka+b.T==b.o&&(me[0]=b.o-b.j-ke));var Ue=_.eb;ke=_.fb+ke*_.A,b=a0(q,te[0],b.width,le,me,Ue,ke+(he?0:3),_.A),t(L==me),b&&mt(oe)&&hc(Ue,ke,he,le,me,_.A)}return 0}function ir(b){var _=b.ma,L=_.ba.S,q=11>L,te=L==Ws||L==bl||L==l0||L==Jc||L==12||mt(L);if(_.memory=null,_.Ib=null,_.Jb=null,_.Nd=null,!Ft(_.Oa,b,te?11:12))return 0;if(te&&mt(L)&&dc(),b.da)alert("todo:use_scaling");else{if(q){if(_.Ib=Me,b.Kb){if(L=b.U+1>>1,_.memory=s(b.U+2*L),_.memory==null)return 0;_.ec=_.memory,_.fc=0,_.cc=_.ec,_.dc=_.fc+b.U,_.Mc=_.cc,_.Nc=_.dc+L,_.Ib=kt,dc()}}else alert("todo:EmitYUV");te&&(_.Jb=Tt,q&&Ji())}if(q&&!UA){for(b=0;256>b;++b)Os[b]=89858*(b-128)+ru>>kl,m1[b]=-22014*(b-128)+ru,rg[b]=-45773*(b-128),Ad[b]=113618*(b-128)+ru>>kl;for(b=xc;b<LA;++b)_=76283*(b-16)+ru>>kl,x1[b-xc]=Ca(_,255),b1[b-xc]=Ca(_+8>>4,15);UA=1}return 1}function Nt(b){var _=b.ma,L=b.U,q=b.T;return t(!(1&b.ka)),0>=L||0>=q?0:(L=_.Ib(b,_),_.Jb!=null&&_.Jb(b,_,L),_.Dc+=L,1)}function Sr(b){b.ma.memory=null}function ca(b,_,L,q){return we(b,8)!=47?0:(_[0]=we(b,14)+1,L[0]=we(b,14)+1,q[0]=we(b,1),we(b,3)!=0?0:!b.h)}function Hr(b,_){if(4>b)return b+1;var L=b-2>>1;return(2+(1&b)<<L)+we(_,L)+1}function Br(b,_){return 120<_?_-120:1<=(L=((L=wl[_-1])>>4)*b+(8-(15&L)))?L:1;var L}function jr(b,_,L){var q=M(L),te=b[_+=255&q].g-8;return 0<te&&(re(L,L.u+8),q=M(L),_+=b[_].value,_+=q&(1<<te)-1),re(L,L.u+b[_].g),b[_].value}function Er(b,_,L){return L.g+=b.g,L.value+=b.value<<_>>>0,t(8>=L.g),b.g}function ae(b,_,L){var q=b.xc;return t((_=q==0?0:b.vc[b.md*(L>>q)+(_>>q)])<b.Wb),b.Ya[_]}function xe(b,_,L,q){var te=b.ab,le=b.c*_,oe=b.C;_=oe+_;var he=L,me=q;for(q=b.Ta,L=b.Ua;0<te--;){var ke=b.gc[te],Ue=oe,Ye=_,ye=he,Oe=me,Ge=(me=q,he=L,ke.Ea);switch(t(Ue<Ye),t(Ye<=ke.nc),ke.hc){case 2:ra(ye,Oe,(Ye-Ue)*Ge,me,he);break;case 0:var st=Ue,We=Ye,nt=me,dt=he,St=(nr=ke).Ea;st==0&&(xr(ye,Oe,null,null,1,nt,dt),Jt(ye,Oe+1,0,0,St-1,nt,dt+1),Oe+=St,dt+=St,++st);for(var vt=1<<nr.b,lr=vt-1,Zt=Xe(St,nr.b),Or=nr.K,nr=nr.w+(st>>nr.b)*Zt;st<We;){var aa=Or,on=nr,zr=1;for(ta(ye,Oe,nt,dt-St,1,nt,dt);zr<St;){var er=(zr&~lr)+vt;er>St&&(er=St),(0,gl[aa[on++]>>8&15])(ye,Oe+ +zr,nt,dt+zr-St,er-zr,nt,dt+zr),zr=er}Oe+=St,dt+=St,++st&lr||(nr+=Zt)}Ye!=ke.nc&&a(me,he-Ge,me,he+(Ye-Ue-1)*Ge,Ge);break;case 1:for(Ge=ye,We=Oe,St=(ye=ke.Ea)-(dt=ye&~(nt=(Oe=1<<ke.b)-1)),st=Xe(ye,ke.b),vt=ke.K,ke=ke.w+(Ue>>ke.b)*st;Ue<Ye;){for(lr=vt,Zt=ke,Or=new qt,nr=We+dt,aa=We+ye;We<nr;)xt(lr[Zt++],Or),CA(Or,Ge,We,Oe,me,he),We+=Oe,he+=Oe;We<aa&&(xt(lr[Zt++],Or),CA(Or,Ge,We,St,me,he),We+=St,he+=St),++Ue&nt||(ke+=st)}break;case 3:if(ye==me&&Oe==he&&0<ke.b){for(We=me,ye=Ge=he+(Ye-Ue)*Ge-(dt=(Ye-Ue)*Xe(ke.Ea,ke.b)),Oe=me,nt=he,st=[],dt=(St=dt)-1;0<=dt;--dt)st[dt]=Oe[nt+dt];for(dt=St-1;0<=dt;--dt)We[ye+dt]=st[dt];js(ke,Ue,Ye,me,Ge,me,he)}else js(ke,Ue,Ye,ye,Oe,me,he)}he=q,me=L}me!=L&&a(q,L,he,me,le)}function fe(b,_){var L=b.V,q=b.Ba+b.c*b.C,te=_-b.C;if(t(_<=b.l.o),t(16>=te),0<te){var le=b.l,oe=b.Ta,he=b.Ua,me=le.width;if(xe(b,te,L,q),te=he=[he],t((L=b.C)<(q=_)),t(le.v<le.va),q>le.o&&(q=le.o),L<le.j){var ke=le.j-L;L=le.j,te[0]+=ke*me}if(L>=q?L=0:(te[0]+=4*le.v,le.ka=L-le.j,le.U=le.va-le.v,le.T=q-L,L=1),L){if(he=he[0],11>(L=b.ca).S){var Ue=L.f.RGBA,Ye=(q=L.S,te=le.U,le=le.T,ke=Ue.eb,Ue.A),ye=le;for(Ue=Ue.fb+b.Ma*Ue.A;0<ye--;){var Oe=oe,Ge=he,st=te,We=ke,nt=Ue;switch(q){case td:ml(Oe,Ge,st,We,nt);break;case Ws:Jl(Oe,Ge,st,We,nt);break;case o0:Jl(Oe,Ge,st,We,nt),hc(We,nt,0,st,1,0);break;case rd:Wo(Oe,Ge,st,We,nt);break;case bl:bt(Oe,Ge,st,We,nt,1);break;case ad:bt(Oe,Ge,st,We,nt,1),hc(We,nt,0,st,1,0);break;case l0:bt(Oe,Ge,st,We,nt,0);break;case Zc:bt(Oe,Ge,st,We,nt,0),hc(We,nt,1,st,1,0);break;case Jc:ci(Oe,Ge,st,We,nt);break;case nd:ci(Oe,Ge,st,We,nt),xl(We,nt,st,1,0);break;case SA:Ti(Oe,Ge,st,We,nt);break;default:t(0)}he+=me,Ue+=Ye}b.Ma+=le}else alert("todo:EmitRescaledRowsYUVA");t(b.Ma<=L.height)}}b.C=_,t(b.C<=b.i)}function pe(b){var _;if(0<b.ua)return 0;for(_=0;_<b.Wb;++_){var L=b.Ya[_].G,q=b.Ya[_].H;if(0<L[1][q[1]+0].g||0<L[2][q[2]+0].g||0<L[3][q[3]+0].g)return 0}return 1}function K(b,_,L,q,te,le){if(b.Z!=0){var oe=b.qd,he=b.rd;for(t(Yo[b.Z]!=null);_<L;++_)Yo[b.Z](oe,he,q,te,q,te,le),oe=q,he=te,te+=le;b.qd=oe,b.rd=he}}function se(b,_){var L=b.l.ma,q=L.Z==0||L.Z==1?b.l.j:b.C;if(q=b.C<q?q:b.C,t(_<=b.l.o),_>q){var te=b.l.width,le=L.ca,oe=L.tb+te*q,he=b.V,me=b.Ba+b.c*q,ke=b.gc;t(b.ab==1),t(ke[0].hc==3),pl(ke[0],q,_,he,me,le,oe),K(L,q,_,le,oe,te)}b.C=b.Ma=_}function Fe(b,_,L,q,te,le,oe){var he=b.$/q,me=b.$%q,ke=b.m,Ue=b.s,Ye=L+b.$,ye=Ye;te=L+q*te;var Oe=L+q*le,Ge=280+Ue.ua,st=b.Pb?he:16777216,We=0<Ue.ua?Ue.Wa:null,nt=Ue.wc,dt=Ye<Oe?ae(Ue,me,he):null;t(b.C<le),t(Oe<=te);var St=!1;e:for(;;){for(;St||Ye<Oe;){var vt=0;if(he>=st){var lr=Ye-L;t((st=b).Pb),st.wd=st.m,st.xd=lr,0<st.s.ua&&ze(st.s.Wa,st.s.vb),st=he+EA}if(me&nt||(dt=ae(Ue,me,he)),t(dt!=null),dt.Qb&&(_[Ye]=dt.qb,St=!0),!St)if(ge(ke),dt.jc){vt=ke,lr=_;var Zt=Ye,Or=dt.pd[M(vt)&qr-1];t(dt.jc),256>Or.g?(re(vt,vt.u+Or.g),lr[Zt]=Or.value,vt=0):(re(vt,vt.u+Or.g-256),t(256<=Or.value),vt=Or.value),vt==0&&(St=!0)}else vt=jr(dt.G[0],dt.H[0],ke);if(ke.h)break;if(St||256>vt){if(!St)if(dt.nd)_[Ye]=(dt.qb|vt<<8)>>>0;else{if(ge(ke),St=jr(dt.G[1],dt.H[1],ke),ge(ke),lr=jr(dt.G[2],dt.H[2],ke),Zt=jr(dt.G[3],dt.H[3],ke),ke.h)break;_[Ye]=(Zt<<24|St<<16|vt<<8|lr)>>>0}if(St=!1,++Ye,++me>=q&&(me=0,++he,oe!=null&&he<=le&&!(he%16)&&oe(b,he),We!=null))for(;ye<Ye;)vt=_[ye++],We.X[(506832829*vt&4294967295)>>>We.Mb]=vt}else if(280>vt){if(vt=Hr(vt-256,ke),lr=jr(dt.G[4],dt.H[4],ke),ge(ke),lr=Br(q,lr=Hr(lr,ke)),ke.h)break;if(Ye-L<lr||te-Ye<vt)break e;for(Zt=0;Zt<vt;++Zt)_[Ye+Zt]=_[Ye+Zt-lr];for(Ye+=vt,me+=vt;me>=q;)me-=q,++he,oe!=null&&he<=le&&!(he%16)&&oe(b,he);if(t(Ye<=te),me&nt&&(dt=ae(Ue,me,he)),We!=null)for(;ye<Ye;)vt=_[ye++],We.X[(506832829*vt&4294967295)>>>We.Mb]=vt}else{if(!(vt<Ge))break e;for(St=vt-280,t(We!=null);ye<Ye;)vt=_[ye++],We.X[(506832829*vt&4294967295)>>>We.Mb]=vt;vt=Ye,t(!(St>>>(lr=We).Xa)),_[vt]=lr.X[St],St=!0}St||t(ke.h==P(ke))}if(b.Pb&&ke.h&&Ye<te)t(b.m.h),b.a=5,b.m=b.wd,b.$=b.xd,0<b.s.ua&&ze(b.s.vb,b.s.Wa);else{if(ke.h)break e;oe?.(b,he>le?le:he),b.a=0,b.$=Ye-L}return 1}return b.a=3,0}function Re(b){t(b!=null),b.vc=null,b.yc=null,b.Ya=null;var _=b.Wa;_!=null&&(_.X=null),b.vb=null,t(b!=null)}function Qe(){var b=new kr;return b==null?null:(b.a=0,b.xb=Rf,Et("Predictor","VP8LPredictors"),Et("Predictor","VP8LPredictors_C"),Et("PredictorAdd","VP8LPredictorsAdd"),Et("PredictorAdd","VP8LPredictorsAdd_C"),ra=It,CA=ht,ml=pr,Jl=$t,ci=Ee,Ti=at,Wo=it,j.VP8LMapColor32b=mn,j.VP8LMapColor8b=is,b)}function Pe(b,_,L,q,te){var le=1,oe=[b],he=[_],me=q.m,ke=q.s,Ue=null,Ye=0;e:for(;;){if(L)for(;le&&we(me,1);){var ye=oe,Oe=he,Ge=q,st=1,We=Ge.m,nt=Ge.gc[Ge.ab],dt=we(We,2);if(Ge.Oc&1<<dt)le=0;else{switch(Ge.Oc|=1<<dt,nt.hc=dt,nt.Ea=ye[0],nt.nc=Oe[0],nt.K=[null],++Ge.ab,t(4>=Ge.ab),dt){case 0:case 1:nt.b=we(We,3)+2,st=Pe(Xe(nt.Ea,nt.b),Xe(nt.nc,nt.b),0,Ge,nt.K),nt.K=nt.K[0];break;case 3:var St,vt=we(We,8)+1,lr=16<vt?0:4<vt?1:2<vt?2:3;if(ye[0]=Xe(nt.Ea,lr),nt.b=lr,St=st=Pe(vt,1,0,Ge,nt.K)){var Zt,Or=vt,nr=nt,aa=1<<(8>>nr.b),on=s(aa);if(on==null)St=0;else{var zr=nr.K[0],er=nr.w;for(on[0]=nr.K[0][0],Zt=1;Zt<1*Or;++Zt)on[Zt]=Ut(zr[er+Zt],on[Zt-1]);for(;Zt<4*aa;++Zt)on[Zt]=0;nr.K[0]=null,nr.K[0]=on,St=1}}st=St;break;case 2:break;default:t(0)}le=st}}if(oe=oe[0],he=he[0],le&&we(me,1)&&!(le=1<=(Ye=we(me,4))&&11>=Ye)){q.a=3;break e}var Kt;if(Kt=le)t:{var xn,Cr,Gr,Ua=q,ls=oe,Rs=he,Xa=Ye,Gn=L,Xs=Ua.m,Wn=Ua.s,Jr=[null],xa=1,bn=0,_a=yl[Xa];r:for(;;){if(Gn&&we(Xs,1)){var os=we(Xs,3)+2,vn=Xe(ls,os),ba=Xe(Rs,os),Rn=vn*ba;if(!Pe(vn,ba,0,Ua,Jr))break r;for(Jr=Jr[0],Wn.xc=os,xn=0;xn<Rn;++xn){var ja=Jr[xn]>>8&65535;Jr[xn]=ja,ja>=xa&&(xa=ja+1)}}if(Xs.h)break r;for(Cr=0;5>Cr;++Cr){var Xn=gc[Cr];!Cr&&0<Xa&&(Xn+=1<<Xa),bn<Xn&&(bn=Xn)}var Yn=l(xa*_a,Y),Ra=xa,pa=l(Ra,ue);if(pa==null)var Ys=null;else t(65536>=Ra),Ys=pa;var Nn=s(bn);if(Ys==null||Nn==null||Yn==null){Ua.a=1;break r}var br=Yn;for(xn=Gr=0;xn<xa;++xn){var vr=Ys[xn],va=vr.G,Li=vr.H,Cl=0,hi=1,$n=0;for(Cr=0;5>Cr;++Cr){Xn=gc[Cr],va[Cr]=br,Li[Cr]=Gr,!Cr&&0<Xa&&(Xn+=1<<Xa);n:{var jA,DA=Xn,ud=Ua,Ya=Nn,Hf=br,Pf=Gr,dd=0,$o=ud.m,v1=we($o,1);if(n(Ya,0,0,DA),v1){var Kf=we($o,1)+1,qf=we($o,1),fd=we($o,qf==0?1:8);Ya[fd]=1,Kf==2&&(Ya[fd=we($o,8)]=1);var ks=1}else{var Fn=s(19),d0=we($o,4)+4;if(19<d0){ud.a=3;var IA=0;break n}for(jA=0;jA<d0;++jA)Fn[A0[jA]]=we($o,3);var nu=void 0,bc=void 0,vo=ud,hd=Fn,su=DA,pd=Ya,gd=0,Jo=vo.m,zf=8,Vf=l(128,Y);a:for(;Q(Vf,0,7,hd,19);){if(we(Jo,1)){var ag=2+2*we(Jo,3);if((nu=2+we(Jo,ag))>su)break a}else nu=su;for(bc=0;bc<su&&nu--;){ge(Jo);var Gf=Vf[0+(127&M(Jo))];re(Jo,Jo.u+Gf.g);var QA=Gf.value;if(16>QA)pd[bc++]=QA,QA!=0&&(zf=QA);else{var ng=QA==16,sg=QA-16,ig=eu[sg],Wf=we(Jo,vl[sg])+ig;if(bc+Wf>su)break a;for(var lg=ng?zf:0;0<Wf--;)pd[bc++]=lg}}gd=1;break a}gd||(vo.a=3),ks=gd}(ks=ks&&!$o.h)&&(dd=Q(Hf,Pf,8,Ya,DA)),ks&&dd!=0?IA=dd:(ud.a=3,IA=0)}if(IA==0)break r;if(hi&&sd[Cr]==1&&(hi=br[Gr].g==0),Cl+=br[Gr].g,Gr+=IA,3>=Cr){var vc,md=Nn[0];for(vc=1;vc<Xn;++vc)Nn[vc]>md&&(md=Nn[vc]);$n+=md}}if(vr.nd=hi,vr.Qb=0,hi&&(vr.qb=(va[3][Li[3]+0].value<<24|va[1][Li[1]+0].value<<16|va[2][Li[2]+0].value)>>>0,Cl==0&&256>va[0][Li[0]+0].value&&(vr.Qb=1,vr.qb+=va[0][Li[0]+0].value<<8)),vr.jc=!vr.Qb&&6>$n,vr.jc){var f0,wo=vr;for(f0=0;f0<qr;++f0){var Zo=f0,eA=wo.pd[Zo],xd=wo.G[0][wo.H[0]+Zo];256<=xd.value?(eA.g=xd.g+256,eA.value=xd.value):(eA.g=0,eA.value=0,Zo>>=Er(xd,8,eA),Zo>>=Er(wo.G[1][wo.H[1]+Zo],16,eA),Zo>>=Er(wo.G[2][wo.H[2]+Zo],0,eA),Er(wo.G[3][wo.H[3]+Zo],24,eA))}}}Wn.vc=Jr,Wn.Wb=xa,Wn.Ya=Ys,Wn.yc=Yn,Kt=1;break t}Kt=0}if(!(le=Kt)){q.a=3;break e}if(0<Ye){if(ke.ua=1<<Ye,!J(ke.Wa,Ye)){q.a=1,le=0;break e}}else ke.ua=0;var bd=q,wc=oe,og=he,iu=bd.s,lu=iu.xc;if(bd.c=wc,bd.i=og,iu.md=Xe(wc,lu),iu.wc=lu==0?-1:(1<<lu)-1,L){q.xb=NA;break e}if((Ue=s(oe*he))==null){q.a=1,le=0;break e}le=(le=Fe(q,Ue,0,oe,he,he,null))&&!me.h;break e}return le?(te!=null?te[0]=Ue:(t(Ue==null),t(L)),q.$=0,L||Re(ke)):Re(ke),le}function qe(b,_){var L=b.c*b.i,q=L+_+16*_;return t(b.c<=_),b.V=s(q),b.V==null?(b.Ta=null,b.Ua=0,b.a=1,0):(b.Ta=b.V,b.Ua=b.Ba+L+_,1)}function pt(b,_){var L=b.C,q=_-L,te=b.V,le=b.Ba+b.c*L;for(t(_<=b.l.o);0<q;){var oe=16<q?16:q,he=b.l.ma,me=b.l.width,ke=me*oe,Ue=he.ca,Ye=he.tb+me*L,ye=b.Ta,Oe=b.Ua;xe(b,oe,te,le),Zi(ye,Oe,Ue,Ye,ke),K(he,L,L+oe,Ue,Ye,me),q-=oe,te+=oe*b.c,L+=oe}t(L==_),b.C=b.Ma=_}function et(){this.ub=this.yd=this.td=this.Rb=0}function Rt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ct(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Qt(){this.Yb=(function(){var b=[];return(function _(L,q,te){for(var le=te[q],oe=0;oe<le&&(L.push(te.length>q+1?[]:0),!(te.length<q+1));oe++)_(L[oe],q+1,te)})(b,0,[3,11]),b})()}function Gt(){this.jb=s(3),this.Wc=A([4,8],Qt),this.Xc=A([4,17],Qt)}function wa(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Pr(){this.ld=this.La=this.dd=this.tc=0}function sa(){this.Na=this.la=0}function vs(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Bi(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Wi(){this.uc=this.M=this.Nb=0,this.wa=Array(new Pr),this.Y=0,this.ya=Array(new Bi),this.aa=0,this.l=new Vs}function rn(){this.y=s(16),this.f=s(8),this.ea=s(8)}function ki(){this.cb=this.a=0,this.sc="",this.m=new F,this.Od=new et,this.Kc=new Rt,this.ed=new wa,this.Qa=new Ct,this.Ic=this.$c=this.Aa=0,this.D=new Wi,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=l(8,F),this.ia=0,this.pb=l(4,vs),this.Pa=new Gt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new rn),this.Hd=0,this.rb=Array(new sa),this.sb=0,this.wa=Array(new Pr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Bi),this.L=this.aa=0,this.gd=A([4,2],Pr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Ca(b,_){return 0>b?0:b>_?_:b}function Vs(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function ii(){var b=new ki;return b!=null&&(b.a=0,b.sc="OK",b.cb=0,b.Xb=0,el||(el=Pl)),b}function ia(b,_,L){return b.a==0&&(b.a=_,b.sc=L,b.cb=0),0}function li(b,_,L){return 3<=L&&b[_+0]==157&&b[_+1]==1&&b[_+2]==42}function Xi(b,_){if(b==null)return 0;if(b.a=0,b.sc="OK",_==null)return ia(b,2,"null VP8Io passed to VP8GetHeaders()");var L=_.data,q=_.w,te=_.ha;if(4>te)return ia(b,7,"Truncated header.");var le=L[q+0]|L[q+1]<<8|L[q+2]<<16,oe=b.Od;if(oe.Rb=!(1&le),oe.td=le>>1&7,oe.yd=le>>4&1,oe.ub=le>>5,3<oe.td)return ia(b,3,"Incorrect keyframe parameters.");if(!oe.yd)return ia(b,4,"Frame not displayable.");q+=3,te-=3;var he=b.Kc;if(oe.Rb){if(7>te)return ia(b,7,"cannot parse picture header");if(!li(L,q,te))return ia(b,3,"Bad code word");he.c=16383&(L[q+4]<<8|L[q+3]),he.Td=L[q+4]>>6,he.i=16383&(L[q+6]<<8|L[q+5]),he.Ud=L[q+6]>>6,q+=7,te-=7,b.za=he.c+15>>4,b.Ub=he.i+15>>4,_.width=he.c,_.height=he.i,_.Da=0,_.j=0,_.v=0,_.va=_.width,_.o=_.height,_.da=0,_.ib=_.width,_.hb=_.height,_.U=_.width,_.T=_.height,n((le=b.Pa).jb,0,255,le.jb.length),t((le=b.Qa)!=null),le.Cb=0,le.Bb=0,le.Fb=1,n(le.Zb,0,0,le.Zb.length),n(le.Lb,0,0,le.Lb)}if(oe.ub>te)return ia(b,7,"bad partition length");Z(le=b.m,L,q,oe.ub),q+=oe.ub,te-=oe.ub,oe.Rb&&(he.Ld=de(le),he.Kd=de(le)),he=b.Qa;var me,ke=b.Pa;if(t(le!=null),t(he!=null),he.Cb=de(le),he.Cb){if(he.Bb=de(le),de(le)){for(he.Fb=de(le),me=0;4>me;++me)he.Zb[me]=de(le)?ve(le,7):0;for(me=0;4>me;++me)he.Lb[me]=de(le)?ve(le,6):0}if(he.Bb)for(me=0;3>me;++me)ke.jb[me]=de(le)?Ae(le,8):255}else he.Bb=0;if(le.Ka)return ia(b,3,"cannot parse segment header");if((he=b.ed).zd=de(le),he.Tb=Ae(le,6),he.wb=Ae(le,3),he.Pc=de(le),he.Pc&&de(le)){for(ke=0;4>ke;++ke)de(le)&&(he.vd[ke]=ve(le,6));for(ke=0;4>ke;++ke)de(le)&&(he.od[ke]=ve(le,6))}if(b.L=he.Tb==0?0:he.zd?1:2,le.Ka)return ia(b,3,"cannot parse filter header");var Ue=te;if(te=me=q,q=me+Ue,he=Ue,b.Xb=(1<<Ae(b.m,2))-1,Ue<3*(ke=b.Xb))L=7;else{for(me+=3*ke,he-=3*ke,Ue=0;Ue<ke;++Ue){var Ye=L[te+0]|L[te+1]<<8|L[te+2]<<16;Ye>he&&(Ye=he),Z(b.Jc[+Ue],L,me,Ye),me+=Ye,he-=Ye,te+=3}Z(b.Jc[+ke],L,me,he),L=me<q?0:5}if(L!=0)return ia(b,L,"cannot parse partitions");for(L=Ae(me=b.m,7),te=de(me)?ve(me,4):0,q=de(me)?ve(me,4):0,he=de(me)?ve(me,4):0,ke=de(me)?ve(me,4):0,me=de(me)?ve(me,4):0,Ue=b.Qa,Ye=0;4>Ye;++Ye){if(Ue.Cb){var ye=Ue.Zb[Ye];Ue.Fb||(ye+=L)}else{if(0<Ye){b.pb[Ye]=b.pb[0];continue}ye=L}var Oe=b.pb[Ye];Oe.Sc[0]=_l[Ca(ye+te,127)],Oe.Sc[1]=Bl[Ca(ye+0,127)],Oe.Eb[0]=2*_l[Ca(ye+q,127)],Oe.Eb[1]=101581*Bl[Ca(ye+he,127)]>>16,8>Oe.Eb[1]&&(Oe.Eb[1]=8),Oe.Qc[0]=_l[Ca(ye+ke,117)],Oe.Qc[1]=Bl[Ca(ye+me,127)],Oe.lc=ye+me}if(!oe.Rb)return ia(b,4,"Not a key frame.");for(de(le),oe=b.Pa,L=0;4>L;++L){for(te=0;8>te;++te)for(q=0;3>q;++q)for(he=0;11>he;++he)ke=be(le,ln[L][te][q][he])?Ae(le,8):tg[L][te][q][he],oe.Wc[L][te].Yb[q][he]=ke;for(te=0;17>te;++te)oe.Xc[L][te]=oe.Wc[L][la[te]]}return b.kc=de(le),b.kc&&(b.Bd=Ae(le,8)),b.cb=1}function Pl(b,_,L,q,te,le,oe){var he=_[te].Yb[L];for(L=0;16>te;++te){if(!be(b,he[L+0]))return te;for(;!be(b,he[L+1]);)if(he=_[++te].Yb[0],L=0,te==16)return 16;var me=_[te+1].Yb;if(be(b,he[L+2])){var ke=b,Ue=0;if(be(ke,(ye=he)[(Ye=L)+3]))if(be(ke,ye[Ye+6])){for(he=0,Ye=2*(Ue=be(ke,ye[Ye+8]))+(ye=be(ke,ye[Ye+9+Ue])),Ue=0,ye=eg[Ye];ye[he];++he)Ue+=Ue+be(ke,ye[he]);Ue+=3+(8<<Ye)}else be(ke,ye[Ye+7])?(Ue=7+2*be(ke,165),Ue+=be(ke,145)):Ue=5+be(ke,159);else Ue=be(ke,ye[Ye+4])?3+be(ke,ye[Ye+5]):2;he=me[2]}else Ue=1,he=me[1];me=oe+Of[te],0>(ke=b).b&&Ce(ke);var Ye,ye=ke.b,Oe=(Ye=ke.Ca>>1)-(ke.I>>ye)>>31;--ke.b,ke.Ca+=Oe,ke.Ca|=1,ke.I-=(Ye+1&Oe)<<ye,le[me]=((Ue^Oe)-Oe)*q[(0<te)+0]}return 16}function Ko(b){var _=b.rb[b.sb-1];_.la=0,_.Na=0,n(b.zc,0,0,b.zc.length),b.ja=0}function ws(b,_,L,q,te){te=b[_+L+32*q]+(te>>3),b[_+L+32*q]=-256&te?0>te?0:255:te}function Fa(b,_,L,q,te,le){ws(b,_,0,L,q+te),ws(b,_,1,L,q+le),ws(b,_,2,L,q-le),ws(b,_,3,L,q-te)}function an(b){return(20091*b>>16)+b}function mA(b,_,L,q){var te,le=0,oe=s(16);for(te=0;4>te;++te){var he=b[_+0]+b[_+8],me=b[_+0]-b[_+8],ke=(35468*b[_+4]>>16)-an(b[_+12]),Ue=an(b[_+4])+(35468*b[_+12]>>16);oe[le+0]=he+Ue,oe[le+1]=me+ke,oe[le+2]=me-ke,oe[le+3]=he-Ue,le+=4,_++}for(te=le=0;4>te;++te)he=(b=oe[le+0]+4)+oe[le+8],me=b-oe[le+8],ke=(35468*oe[le+4]>>16)-an(oe[le+12]),ws(L,q,0,0,he+(Ue=an(oe[le+4])+(35468*oe[le+12]>>16))),ws(L,q,1,0,me+ke),ws(L,q,2,0,me-ke),ws(L,q,3,0,he-Ue),le++,q+=32}function oi(b,_,L,q){var te=b[_+0]+4,le=35468*b[_+4]>>16,oe=an(b[_+4]),he=35468*b[_+1]>>16;Fa(L,q,0,te+oe,b=an(b[_+1]),he),Fa(L,q,1,te+le,b,he),Fa(L,q,2,te-le,b,he),Fa(L,q,3,te-oe,b,he)}function xA(b,_,L,q,te){mA(b,_,L,q),te&&mA(b,_+16,L,q+4)}function hn(b,_,L,q){di(b,_+0,L,q,1),di(b,_+32,L,q+128,1)}function qo(b,_,L,q){var te;for(b=b[_+0]+4,te=0;4>te;++te)for(_=0;4>_;++_)ws(L,q,_,te,b)}function Kl(b,_,L,q){b[_+0]&&ya(b,_+0,L,q),b[_+16]&&ya(b,_+16,L,q+4),b[_+32]&&ya(b,_+32,L,q+128),b[_+48]&&ya(b,_+48,L,q+128+4)}function Ci(b,_,L,q){var te,le=s(16);for(te=0;4>te;++te){var oe=b[_+0+te]+b[_+12+te],he=b[_+4+te]+b[_+8+te],me=b[_+4+te]-b[_+8+te],ke=b[_+0+te]-b[_+12+te];le[0+te]=oe+he,le[8+te]=oe-he,le[4+te]=ke+me,le[12+te]=ke-me}for(te=0;4>te;++te)oe=(b=le[0+4*te]+3)+le[3+4*te],he=le[1+4*te]+le[2+4*te],me=le[1+4*te]-le[2+4*te],ke=b-le[3+4*te],L[q+0]=oe+he>>3,L[q+16]=ke+me>>3,L[q+32]=oe-he>>3,L[q+48]=ke-me>>3,q+=64}function ql(b,_,L){var q,te=_-32,le=Gs,oe=255-b[te-1];for(q=0;q<L;++q){var he,me=le,ke=oe+b[_-1];for(he=0;he<L;++he)b[_+he]=me[ke+b[te+he]];_+=32}}function bA(b,_){ql(b,_,4)}function oc(b,_){ql(b,_,8)}function vA(b,_){ql(b,_,16)}function Ac(b,_){var L;for(L=0;16>L;++L)a(b,_+32*L,b,_-32,16)}function Yi(b,_){var L;for(L=16;0<L;--L)n(b,_,b[_-1],16),_+=32}function Ta(b,_,L){var q;for(q=0;16>q;++q)n(_,L+32*q,b,16)}function Us(b,_){var L,q=16;for(L=0;16>L;++L)q+=b[_-1+32*L]+b[_+L-32];Ta(q>>5,b,_)}function ys(b,_){var L,q=8;for(L=0;16>L;++L)q+=b[_-1+32*L];Ta(q>>4,b,_)}function _s(b,_){var L,q=8;for(L=0;16>L;++L)q+=b[_+L-32];Ta(q>>4,b,_)}function po(b,_){Ta(128,b,_)}function _r(b,_,L){return b+2*_+L+2>>2}function ma(b,_){var L,q=_-32;for(q=new Uint8Array([_r(b[q-1],b[q+0],b[q+1]),_r(b[q+0],b[q+1],b[q+2]),_r(b[q+1],b[q+2],b[q+3]),_r(b[q+2],b[q+3],b[q+4])]),L=0;4>L;++L)a(b,_+32*L,q,0,q.length)}function $i(b,_){var L=b[_-1],q=b[_-1+32],te=b[_-1+64],le=b[_-1+96];Le(b,_+0,16843009*_r(b[_-1-32],L,q)),Le(b,_+32,16843009*_r(L,q,te)),Le(b,_+64,16843009*_r(q,te,le)),Le(b,_+96,16843009*_r(te,le,le))}function cc(b,_){var L,q=4;for(L=0;4>L;++L)q+=b[_+L-32]+b[_-1+32*L];for(q>>=3,L=0;4>L;++L)n(b,_+32*L,q,4)}function Ga(b,_){var L=b[_-1+0],q=b[_-1+32],te=b[_-1+64],le=b[_-1-32],oe=b[_+0-32],he=b[_+1-32],me=b[_+2-32],ke=b[_+3-32];b[_+0+96]=_r(q,te,b[_-1+96]),b[_+1+96]=b[_+0+64]=_r(L,q,te),b[_+2+96]=b[_+1+64]=b[_+0+32]=_r(le,L,q),b[_+3+96]=b[_+2+64]=b[_+1+32]=b[_+0+0]=_r(oe,le,L),b[_+3+64]=b[_+2+32]=b[_+1+0]=_r(he,oe,le),b[_+3+32]=b[_+2+0]=_r(me,he,oe),b[_+3+0]=_r(ke,me,he)}function Kn(b,_){var L=b[_+1-32],q=b[_+2-32],te=b[_+3-32],le=b[_+4-32],oe=b[_+5-32],he=b[_+6-32],me=b[_+7-32];b[_+0+0]=_r(b[_+0-32],L,q),b[_+1+0]=b[_+0+32]=_r(L,q,te),b[_+2+0]=b[_+1+32]=b[_+0+64]=_r(q,te,le),b[_+3+0]=b[_+2+32]=b[_+1+64]=b[_+0+96]=_r(te,le,oe),b[_+3+32]=b[_+2+64]=b[_+1+96]=_r(le,oe,he),b[_+3+64]=b[_+2+96]=_r(oe,he,me),b[_+3+96]=_r(he,me,me)}function go(b,_){var L=b[_-1+0],q=b[_-1+32],te=b[_-1+64],le=b[_-1-32],oe=b[_+0-32],he=b[_+1-32],me=b[_+2-32],ke=b[_+3-32];b[_+0+0]=b[_+1+64]=le+oe+1>>1,b[_+1+0]=b[_+2+64]=oe+he+1>>1,b[_+2+0]=b[_+3+64]=he+me+1>>1,b[_+3+0]=me+ke+1>>1,b[_+0+96]=_r(te,q,L),b[_+0+64]=_r(q,L,le),b[_+0+32]=b[_+1+96]=_r(L,le,oe),b[_+1+32]=b[_+2+96]=_r(le,oe,he),b[_+2+32]=b[_+3+96]=_r(oe,he,me),b[_+3+32]=_r(he,me,ke)}function jn(b,_){var L=b[_+0-32],q=b[_+1-32],te=b[_+2-32],le=b[_+3-32],oe=b[_+4-32],he=b[_+5-32],me=b[_+6-32],ke=b[_+7-32];b[_+0+0]=L+q+1>>1,b[_+1+0]=b[_+0+64]=q+te+1>>1,b[_+2+0]=b[_+1+64]=te+le+1>>1,b[_+3+0]=b[_+2+64]=le+oe+1>>1,b[_+0+32]=_r(L,q,te),b[_+1+32]=b[_+0+96]=_r(q,te,le),b[_+2+32]=b[_+1+96]=_r(te,le,oe),b[_+3+32]=b[_+2+96]=_r(le,oe,he),b[_+3+64]=_r(oe,he,me),b[_+3+96]=_r(he,me,ke)}function Bs(b,_){var L=b[_-1+0],q=b[_-1+32],te=b[_-1+64],le=b[_-1+96];b[_+0+0]=L+q+1>>1,b[_+2+0]=b[_+0+32]=q+te+1>>1,b[_+2+32]=b[_+0+64]=te+le+1>>1,b[_+1+0]=_r(L,q,te),b[_+3+0]=b[_+1+32]=_r(q,te,le),b[_+3+32]=b[_+1+64]=_r(te,le,le),b[_+3+64]=b[_+2+64]=b[_+0+96]=b[_+1+96]=b[_+2+96]=b[_+3+96]=le}function zl(b,_){var L=b[_-1+0],q=b[_-1+32],te=b[_-1+64],le=b[_-1+96],oe=b[_-1-32],he=b[_+0-32],me=b[_+1-32],ke=b[_+2-32];b[_+0+0]=b[_+2+32]=L+oe+1>>1,b[_+0+32]=b[_+2+64]=q+L+1>>1,b[_+0+64]=b[_+2+96]=te+q+1>>1,b[_+0+96]=le+te+1>>1,b[_+3+0]=_r(he,me,ke),b[_+2+0]=_r(oe,he,me),b[_+1+0]=b[_+3+32]=_r(L,oe,he),b[_+1+32]=b[_+3+64]=_r(q,L,oe),b[_+1+64]=b[_+3+96]=_r(te,q,L),b[_+1+96]=_r(le,te,q)}function qn(b,_){var L;for(L=0;8>L;++L)a(b,_+32*L,b,_-32,8)}function Yc(b,_){var L;for(L=0;8>L;++L)n(b,_,b[_-1],8),_+=32}function Si(b,_,L){var q;for(q=0;8>q;++q)n(_,L+32*q,b,8)}function zo(b,_){var L,q=8;for(L=0;8>L;++L)q+=b[_+L-32]+b[_-1+32*L];Si(q>>4,b,_)}function wA(b,_){var L,q=4;for(L=0;8>L;++L)q+=b[_+L-32];Si(q>>3,b,_)}function zn(b,_){var L,q=4;for(L=0;8>L;++L)q+=b[_-1+32*L];Si(q>>3,b,_)}function Al(b,_){Si(128,b,_)}function Ai(b,_,L){var q=b[_-L],te=b[_+0],le=3*(te-q)+Xo[1020+b[_-2*L]-b[_+L]],oe=i0[112+(le+4>>3)];b[_-L]=Gs[255+q+i0[112+(le+3>>3)]],b[_+0]=Gs[255+te-oe]}function cl(b,_,L,q){var te=b[_+0],le=b[_+L];return Ds[255+b[_-2*L]-b[_-L]]>q||Ds[255+le-te]>q}function Vn(b,_,L,q){return 4*Ds[255+b[_-L]-b[_+0]]+Ds[255+b[_-2*L]-b[_+L]]<=q}function mo(b,_,L,q,te){var le=b[_-3*L],oe=b[_-2*L],he=b[_-L],me=b[_+0],ke=b[_+L],Ue=b[_+2*L],Ye=b[_+3*L];return 4*Ds[255+he-me]+Ds[255+oe-ke]>q?0:Ds[255+b[_-4*L]-le]<=te&&Ds[255+le-oe]<=te&&Ds[255+oe-he]<=te&&Ds[255+Ye-Ue]<=te&&Ds[255+Ue-ke]<=te&&Ds[255+ke-me]<=te}function Vl(b,_,L,q){var te=2*q+1;for(q=0;16>q;++q)Vn(b,_+q,L,te)&&Ai(b,_+q,L)}function ul(b,_,L,q){var te=2*q+1;for(q=0;16>q;++q)Vn(b,_+q*L,1,te)&&Ai(b,_+q*L,1)}function Vo(b,_,L,q){var te;for(te=3;0<te;--te)Vl(b,_+=4*L,L,q)}function yA(b,_,L,q){var te;for(te=3;0<te;--te)ul(b,_+=4,L,q)}function dl(b,_,L,q,te,le,oe,he){for(le=2*le+1;0<te--;){if(mo(b,_,L,le,oe))if(cl(b,_,L,he))Ai(b,_,L);else{var me=b,ke=_,Ue=L,Ye=me[ke-2*Ue],ye=me[ke-Ue],Oe=me[ke+0],Ge=me[ke+Ue],st=me[ke+2*Ue],We=27*(dt=Xo[1020+3*(Oe-ye)+Xo[1020+Ye-Ge]])+63>>7,nt=18*dt+63>>7,dt=9*dt+63>>7;me[ke-3*Ue]=Gs[255+me[ke-3*Ue]+dt],me[ke-2*Ue]=Gs[255+Ye+nt],me[ke-Ue]=Gs[255+ye+We],me[ke+0]=Gs[255+Oe-We],me[ke+Ue]=Gs[255+Ge-nt],me[ke+2*Ue]=Gs[255+st-dt]}_+=q}}function Gl(b,_,L,q,te,le,oe,he){for(le=2*le+1;0<te--;){if(mo(b,_,L,le,oe))if(cl(b,_,L,he))Ai(b,_,L);else{var me=b,ke=_,Ue=L,Ye=me[ke-Ue],ye=me[ke+0],Oe=me[ke+Ue],Ge=i0[112+(4+(st=3*(ye-Ye))>>3)],st=i0[112+(st+3>>3)],We=Ge+1>>1;me[ke-2*Ue]=Gs[255+me[ke-2*Ue]+We],me[ke-Ue]=Gs[255+Ye+st],me[ke+0]=Gs[255+ye-Ge],me[ke+Ue]=Gs[255+Oe-We]}_+=q}}function $c(b,_,L,q,te,le){dl(b,_,L,1,16,q,te,le)}function Wl(b,_,L,q,te,le){dl(b,_,1,L,16,q,te,le)}function uc(b,_,L,q,te,le){var oe;for(oe=3;0<oe;--oe)Gl(b,_+=4*L,L,1,16,q,te,le)}function E(b,_,L,q,te,le){var oe;for(oe=3;0<oe;--oe)Gl(b,_+=4,1,L,16,q,te,le)}function ee(b,_,L,q,te,le,oe,he){dl(b,_,te,1,8,le,oe,he),dl(L,q,te,1,8,le,oe,he)}function Be(b,_,L,q,te,le,oe,he){dl(b,_,1,te,8,le,oe,he),dl(L,q,1,te,8,le,oe,he)}function Ne(b,_,L,q,te,le,oe,he){Gl(b,_+4*te,te,1,8,le,oe,he),Gl(L,q+4*te,te,1,8,le,oe,he)}function Ke(b,_,L,q,te,le,oe,he){Gl(b,_+4,1,te,8,le,oe,he),Gl(L,q+4,1,te,8,le,oe,he)}function At(){this.ba=new Vt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Wt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function wt(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function tr(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Ar(){this.ua=0,this.Wa=new He,this.vb=new He,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new ue,this.yc=new Y}function kr(){this.xb=this.a=0,this.l=new Vs,this.ca=new Vt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new R,this.Pb=0,this.wd=new R,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Ar,this.ab=0,this.gc=l(4,tr),this.Oc=0}function Dr(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Vs,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function ea(b,_,L,q,te,le,oe){for(b=b==null?0:b[_+0],_=0;_<oe;++_)te[le+_]=b+L[q+_]&255,b=te[le+_]}function nn(b,_,L,q,te,le,oe){var he;if(b==null)ea(null,null,L,q,te,le,oe);else for(he=0;he<oe;++he)te[le+he]=b[_+he]+L[q+he]&255}function un(b,_,L,q,te,le,oe){if(b==null)ea(null,null,L,q,te,le,oe);else{var he,me=b[_+0],ke=me,Ue=me;for(he=0;he<oe;++he)ke=Ue+(me=b[_+he])-ke,Ue=L[q+he]+(-256&ke?0>ke?0:255:ke)&255,ke=me,te[le+he]=Ue}}function La(b,_,L,q){var te=_.width,le=_.o;if(t(b!=null&&_!=null),0>L||0>=q||L+q>le)return null;if(!b.Cc){if(b.ga==null){var oe;if(b.ga=new Dr,(oe=b.ga==null)||(oe=_.width*_.o,t(b.Gb.length==0),b.Gb=s(oe),b.Uc=0,b.Gb==null?oe=0:(b.mb=b.Gb,b.nb=b.Uc,b.rc=null,oe=1),oe=!oe),!oe){oe=b.ga;var he=b.Fa,me=b.P,ke=b.qc,Ue=b.mb,Ye=b.nb,ye=me+1,Oe=ke-1,Ge=oe.l;if(t(he!=null&&Ue!=null&&_!=null),Yo[0]=null,Yo[1]=ea,Yo[2]=nn,Yo[3]=un,oe.ca=Ue,oe.tb=Ye,oe.c=_.width,oe.i=_.height,t(0<oe.c&&0<oe.i),1>=ke)_=0;else if(oe.$a=3&he[me+0],oe.Z=he[me+0]>>2&3,oe.Lc=he[me+0]>>4&3,me=he[me+0]>>6&3,0>oe.$a||1<oe.$a||4<=oe.Z||1<oe.Lc||me)_=0;else if(Ge.put=Nt,Ge.ac=ir,Ge.bc=Sr,Ge.ma=oe,Ge.width=_.width,Ge.height=_.height,Ge.Da=_.Da,Ge.v=_.v,Ge.va=_.va,Ge.j=_.j,Ge.o=_.o,oe.$a)e:{t(oe.$a==1),_=Qe();t:for(;;){if(_==null){_=0;break e}if(t(oe!=null),oe.mc=_,_.c=oe.c,_.i=oe.i,_.l=oe.l,_.l.ma=oe,_.l.width=oe.c,_.l.height=oe.i,_.a=0,G(_.m,he,ye,Oe),!Pe(oe.c,oe.i,1,_,null)||(_.ab==1&&_.gc[0].hc==3&&pe(_.s)?(oe.ic=1,he=_.c*_.i,_.Ta=null,_.Ua=0,_.V=s(he),_.Ba=0,_.V==null?(_.a=1,_=0):_=1):(oe.ic=0,_=qe(_,oe.c)),!_))break t;_=1;break e}oe.mc=null,_=0}else _=Oe>=oe.c*oe.i;oe=!_}if(oe)return null;b.ga.Lc!=1?b.Ga=0:q=le-L}t(b.ga!=null),t(L+q<=le);e:{if(_=(he=b.ga).c,le=he.l.o,he.$a==0){if(ye=b.rc,Oe=b.Vc,Ge=b.Fa,me=b.P+1+L*_,ke=b.mb,Ue=b.nb+L*_,t(me<=b.P+b.qc),he.Z!=0)for(t(Yo[he.Z]!=null),oe=0;oe<q;++oe)Yo[he.Z](ye,Oe,Ge,me,ke,Ue,_),ye=ke,Oe=Ue,Ue+=_,me+=_;else for(oe=0;oe<q;++oe)a(ke,Ue,Ge,me,_),ye=ke,Oe=Ue,Ue+=_,me+=_;b.rc=ye,b.Vc=Oe}else{if(t(he.mc!=null),_=L+q,t((oe=he.mc)!=null),t(_<=oe.i),oe.C>=_)_=1;else if(he.ic||Ji(),he.ic){he=oe.V,ye=oe.Ba,Oe=oe.c;var st=oe.i,We=(Ge=1,me=oe.$/Oe,ke=oe.$%Oe,Ue=oe.m,Ye=oe.s,oe.$),nt=Oe*st,dt=Oe*_,St=Ye.wc,vt=We<dt?ae(Ye,ke,me):null;t(We<=nt),t(_<=st),t(pe(Ye));t:for(;;){for(;!Ue.h&&We<dt;){if(ke&St||(vt=ae(Ye,ke,me)),t(vt!=null),ge(Ue),256>(st=jr(vt.G[0],vt.H[0],Ue)))he[ye+We]=st,++We,++ke>=Oe&&(ke=0,++me<=_&&!(me%16)&&se(oe,me));else{if(!(280>st)){Ge=0;break t}st=Hr(st-256,Ue);var lr,Zt=jr(vt.G[4],vt.H[4],Ue);if(ge(Ue),!(We>=(Zt=Br(Oe,Zt=Hr(Zt,Ue)))&&nt-We>=st)){Ge=0;break t}for(lr=0;lr<st;++lr)he[ye+We+lr]=he[ye+We+lr-Zt];for(We+=st,ke+=st;ke>=Oe;)ke-=Oe,++me<=_&&!(me%16)&&se(oe,me);We<dt&&ke&St&&(vt=ae(Ye,ke,me))}t(Ue.h==P(Ue))}se(oe,me>_?_:me);break t}!Ge||Ue.h&&We<nt?(Ge=0,oe.a=Ue.h?5:3):oe.$=We,_=Ge}else _=Fe(oe,oe.V,oe.Ba,oe.c,oe.i,_,pt);if(!_){q=0;break e}}L+q>=le&&(b.Cc=1),q=1}if(!q)return null;if(b.Cc&&((q=b.ga)!=null&&(q.mc=null),b.ga=null,0<b.Ga))return alert("todo:WebPDequantizeLevels"),null}return b.nb+L*te}function pn(b,_,L,q,te,le){for(;0<te--;){var oe,he=b,me=_+(L?1:0),ke=b,Ue=_+(L?0:3);for(oe=0;oe<q;++oe){var Ye=ke[Ue+4*oe];Ye!=255&&(Ye*=32897,he[me+4*oe+0]=he[me+4*oe+0]*Ye>>23,he[me+4*oe+1]=he[me+4*oe+1]*Ye>>23,he[me+4*oe+2]=he[me+4*oe+2]*Ye>>23)}_+=le}}function Cn(b,_,L,q,te){for(;0<q--;){var le;for(le=0;le<L;++le){var oe=b[_+2*le+0],he=15&(ke=b[_+2*le+1]),me=4369*he,ke=(240&ke|ke>>4)*me>>16;b[_+2*le+0]=(240&oe|oe>>4)*me>>16&240|(15&oe|oe<<4)*me>>16>>4&15,b[_+2*le+1]=240&ke|he}_+=te}}function ss(b,_,L,q,te,le,oe,he){var me,ke,Ue=255;for(ke=0;ke<te;++ke){for(me=0;me<q;++me){var Ye=b[_+me];le[oe+4*me]=Ye,Ue&=Ye}_+=L,oe+=he}return Ue!=255}function fl(b,_,L,q,te){var le;for(le=0;le<te;++le)L[q+le]=b[_+le]>>8}function Ji(){hc=pn,xl=Cn,a0=ss,Zi=fl}function Xl(b,_,L){j[b]=function(q,te,le,oe,he,me,ke,Ue,Ye,ye,Oe,Ge,st,We,nt,dt,St){var vt,lr=St-1>>1,Zt=he[me+0]|ke[Ue+0]<<16,Or=Ye[ye+0]|Oe[Ge+0]<<16;t(q!=null);var nr=3*Zt+Or+131074>>2;for(_(q[te+0],255&nr,nr>>16,st,We),le!=null&&(nr=3*Or+Zt+131074>>2,_(le[oe+0],255&nr,nr>>16,nt,dt)),vt=1;vt<=lr;++vt){var aa=he[me+vt]|ke[Ue+vt]<<16,on=Ye[ye+vt]|Oe[Ge+vt]<<16,zr=Zt+aa+Or+on+524296,er=zr+2*(aa+Or)>>3;nr=er+Zt>>1,Zt=(zr=zr+2*(Zt+on)>>3)+aa>>1,_(q[te+2*vt-1],255&nr,nr>>16,st,We+(2*vt-1)*L),_(q[te+2*vt-0],255&Zt,Zt>>16,st,We+(2*vt-0)*L),le!=null&&(nr=zr+Or>>1,Zt=er+on>>1,_(le[oe+2*vt-1],255&nr,nr>>16,nt,dt+(2*vt-1)*L),_(le[oe+2*vt+0],255&Zt,Zt>>16,nt,dt+(2*vt+0)*L)),Zt=aa,Or=on}1&St||(nr=3*Zt+Or+131074>>2,_(q[te+St-1],255&nr,nr>>16,st,We+(St-1)*L),le!=null&&(nr=3*Or+Zt+131074>>2,_(le[oe+St-1],255&nr,nr>>16,nt,dt+(St-1)*L)))}}function dc(){Qs[td]=mc,Qs[Ws]=tu,Qs[rd]=Mf,Qs[bl]=ld,Qs[l0]=FA,Qs[Jc]=bo,Qs[SA]=TA,Qs[o0]=tu,Qs[ad]=ld,Qs[Zc]=FA,Qs[nd]=bo}function _A(b){return b&-16384?0>b?0:255:b>>od}function Ei(b,_){return _A((19077*b>>8)+(26149*_>>8)-14234)}function Ni(b,_,L){return _A((19077*b>>8)-(6419*_>>8)-(13320*L>>8)+8708)}function Go(b,_){return _A((19077*b>>8)+(33050*_>>8)-17685)}function Yl(b,_,L,q,te){q[te+0]=Ei(b,L),q[te+1]=Ni(b,_,L),q[te+2]=Go(b,_)}function gn(b,_,L,q,te){q[te+0]=Go(b,_),q[te+1]=Ni(b,_,L),q[te+2]=Ei(b,L)}function Dn(b,_,L,q,te){var le=Ni(b,_,L);_=le<<3&224|Go(b,_)>>3,q[te+0]=248&Ei(b,L)|le>>5,q[te+1]=_}function hl(b,_,L,q,te){var le=240&Go(b,_)|15;q[te+0]=240&Ei(b,L)|Ni(b,_,L)>>4,q[te+1]=le}function BA(b,_,L,q,te){q[te+0]=255,Yl(b,_,L,q,te+1)}function Fi(b,_,L,q,te){gn(b,_,L,q,te),q[te+3]=255}function Sn(b,_,L,q,te){Yl(b,_,L,q,te),q[te+3]=255}function $l(b,_,L){j[b]=function(q,te,le,oe,he,me,ke,Ue,Ye){for(var ye=Ue+(-2&Ye)*L;Ue!=ye;)_(q[te+0],le[oe+0],he[me+0],ke,Ue),_(q[te+1],le[oe+0],he[me+0],ke,Ue+L),te+=2,++oe,++me,Ue+=2*L;1&Ye&&_(q[te+0],le[oe+0],he[me+0],ke,Ue)}}function kA(b,_,L){return L==0?b==0?_==0?6:5:_==0?4:0:L}function ne(b,_,L,q,te){switch(b>>>30){case 3:di(_,L,q,te,0);break;case 2:cr(_,L,q,te);break;case 1:ya(_,L,q,te)}}function De(b,_){var L,q,te=_.M,le=_.Nb,oe=b.oc,he=b.pc+40,me=b.oc,ke=b.pc+584,Ue=b.oc,Ye=b.pc+600;for(L=0;16>L;++L)oe[he+32*L-1]=129;for(L=0;8>L;++L)me[ke+32*L-1]=129,Ue[Ye+32*L-1]=129;for(0<te?oe[he-1-32]=me[ke-1-32]=Ue[Ye-1-32]=129:(n(oe,he-32-1,127,21),n(me,ke-32-1,127,9),n(Ue,Ye-32-1,127,9)),q=0;q<b.za;++q){var ye=_.ya[_.aa+q];if(0<q){for(L=-1;16>L;++L)a(oe,he+32*L-4,oe,he+32*L+12,4);for(L=-1;8>L;++L)a(me,ke+32*L-4,me,ke+32*L+4,4),a(Ue,Ye+32*L-4,Ue,Ye+32*L+4,4)}var Oe=b.Gd,Ge=b.Hd+q,st=ye.ad,We=ye.Hc;if(0<te&&(a(oe,he-32,Oe[Ge].y,0,16),a(me,ke-32,Oe[Ge].f,0,8),a(Ue,Ye-32,Oe[Ge].ea,0,8)),ye.Za){var nt=oe,dt=he-32+16;for(0<te&&(q>=b.za-1?n(nt,dt,Oe[Ge].y[15],4):a(nt,dt,Oe[Ge+1].y,0,4)),L=0;4>L;L++)nt[dt+128+L]=nt[dt+256+L]=nt[dt+384+L]=nt[dt+0+L];for(L=0;16>L;++L,We<<=2)nt=oe,dt=he+On[L],En[ye.Ob[L]](nt,dt),ne(We,st,16*+L,nt,dt)}else if(nt=kA(q,te,ye.Ob[0]),fi[nt](oe,he),We!=0)for(L=0;16>L;++L,We<<=2)ne(We,st,16*+L,oe,he+On[L]);for(L=ye.Gc,nt=kA(q,te,ye.Dd),eo[nt](me,ke),eo[nt](Ue,Ye),We=st,nt=me,dt=ke,255&(ye=0|L)&&(170&ye?In(We,256,nt,dt):ha(We,256,nt,dt)),ye=Ue,We=Ye,255&(L>>=8)&&(170&L?In(st,320,ye,We):ha(st,320,ye,We)),te<b.Ub-1&&(a(Oe[Ge].y,0,oe,he+480,16),a(Oe[Ge].f,0,me,ke+224,8),a(Oe[Ge].ea,0,Ue,Ye+224,8)),L=8*le*b.B,Oe=b.sa,Ge=b.ta+16*q+16*le*b.R,st=b.qa,ye=b.ra+8*q+L,We=b.Ha,nt=b.Ia+8*q+L,L=0;16>L;++L)a(Oe,Ge+L*b.R,oe,he+32*L,16);for(L=0;8>L;++L)a(st,ye+L*b.B,me,ke+32*L,8),a(We,nt+L*b.B,Ue,Ye+32*L,8)}}function ut(b,_,L,q,te,le,oe,he,me){var ke=[0],Ue=[0],Ye=0,ye=me!=null?me.kd:0,Oe=me??new wt;if(b==null||12>L)return 7;Oe.data=b,Oe.w=_,Oe.ha=L,_=[_],L=[L],Oe.gb=[Oe.gb];e:{var Ge=_,st=L,We=Oe.gb;if(t(b!=null),t(st!=null),t(We!=null),We[0]=0,12<=st[0]&&!r(b,Ge[0],"RIFF")){if(r(b,Ge[0]+8,"WEBP")){We=3;break e}var nt=je(b,Ge[0]+4);if(12>nt||4294967286<nt){We=3;break e}if(ye&&nt>st[0]-8){We=7;break e}We[0]=nt,Ge[0]+=12,st[0]-=12}We=0}if(We!=0)return We;for(nt=0<Oe.gb[0],L=L[0];;){e:{var dt=b;st=_,We=L;var St=ke,vt=Ue,lr=Ge=[0];if((nr=Ye=[Ye])[0]=0,8>We[0])We=7;else{if(!r(dt,st[0],"VP8X")){if(je(dt,st[0]+4)!=10){We=3;break e}if(18>We[0]){We=7;break e}var Zt=je(dt,st[0]+8),Or=1+_e(dt,st[0]+12);if(2147483648<=Or*(dt=1+_e(dt,st[0]+15))){We=3;break e}lr!=null&&(lr[0]=Zt),St!=null&&(St[0]=Or),vt!=null&&(vt[0]=dt),st[0]+=18,We[0]-=18,nr[0]=1}We=0}}if(Ye=Ye[0],Ge=Ge[0],We!=0)return We;if(st=!!(2&Ge),!nt&&Ye)return 3;if(le!=null&&(le[0]=!!(16&Ge)),oe!=null&&(oe[0]=st),he!=null&&(he[0]=0),oe=ke[0],Ge=Ue[0],Ye&&st&&me==null){We=0;break}if(4>L){We=7;break}if(nt&&Ye||!nt&&!Ye&&!r(b,_[0],"ALPH")){L=[L],Oe.na=[Oe.na],Oe.P=[Oe.P],Oe.Sa=[Oe.Sa];e:{Zt=b,We=_,nt=L;var nr=Oe.gb;St=Oe.na,vt=Oe.P,lr=Oe.Sa,Or=22,t(Zt!=null),t(nt!=null),dt=We[0];var aa=nt[0];for(t(St!=null),t(lr!=null),St[0]=null,vt[0]=null,lr[0]=0;;){if(We[0]=dt,nt[0]=aa,8>aa){We=7;break e}var on=je(Zt,dt+4);if(4294967286<on){We=3;break e}var zr=8+on+1&-2;if(Or+=zr,0<nr&&Or>nr){We=3;break e}if(!r(Zt,dt,"VP8 ")||!r(Zt,dt,"VP8L")){We=0;break e}if(aa[0]<zr){We=7;break e}r(Zt,dt,"ALPH")||(St[0]=Zt,vt[0]=dt+8,lr[0]=on),dt+=zr,aa-=zr}}if(L=L[0],Oe.na=Oe.na[0],Oe.P=Oe.P[0],Oe.Sa=Oe.Sa[0],We!=0)break}L=[L],Oe.Ja=[Oe.Ja],Oe.xa=[Oe.xa];e:if(nr=b,We=_,nt=L,St=Oe.gb[0],vt=Oe.Ja,lr=Oe.xa,Zt=We[0],dt=!r(nr,Zt,"VP8 "),Or=!r(nr,Zt,"VP8L"),t(nr!=null),t(nt!=null),t(vt!=null),t(lr!=null),8>nt[0])We=7;else{if(dt||Or){if(nr=je(nr,Zt+4),12<=St&&nr>St-12){We=3;break e}if(ye&&nr>nt[0]-8){We=7;break e}vt[0]=nr,We[0]+=8,nt[0]-=8,lr[0]=Or}else lr[0]=5<=nt[0]&&nr[Zt+0]==47&&!(nr[Zt+4]>>5),vt[0]=nt[0];We=0}if(L=L[0],Oe.Ja=Oe.Ja[0],Oe.xa=Oe.xa[0],_=_[0],We!=0)break;if(4294967286<Oe.Ja)return 3;if(he==null||st||(he[0]=Oe.xa?2:1),oe=[oe],Ge=[Ge],Oe.xa){if(5>L){We=7;break}he=oe,ye=Ge,st=le,b==null||5>L?b=0:5<=L&&b[_+0]==47&&!(b[_+4]>>5)?(nt=[0],nr=[0],St=[0],G(vt=new R,b,_,L),ca(vt,nt,nr,St)?(he!=null&&(he[0]=nt[0]),ye!=null&&(ye[0]=nr[0]),st!=null&&(st[0]=St[0]),b=1):b=0):b=0}else{if(10>L){We=7;break}he=Ge,b==null||10>L||!li(b,_+3,L-3)?b=0:(ye=b[_+0]|b[_+1]<<8|b[_+2]<<16,st=16383&(b[_+7]<<8|b[_+6]),b=16383&(b[_+9]<<8|b[_+8]),1&ye||3<(ye>>1&7)||!(ye>>4&1)||ye>>5>=Oe.Ja||!st||!b?b=0:(oe&&(oe[0]=st),he&&(he[0]=b),b=1))}if(!b||(oe=oe[0],Ge=Ge[0],Ye&&(ke[0]!=oe||Ue[0]!=Ge)))return 3;me!=null&&(me[0]=Oe,me.offset=_-me.w,t(4294967286>_-me.w),t(me.offset==me.ha-L));break}return We==0||We==7&&Ye&&me==null?(le!=null&&(le[0]|=Oe.na!=null&&0<Oe.na.length),q!=null&&(q[0]=oe),te!=null&&(te[0]=Ge),0):We}function Ft(b,_,L){var q=_.width,te=_.height,le=0,oe=0,he=q,me=te;if(_.Da=b!=null&&0<b.Da,_.Da&&(he=b.cd,me=b.bd,le=b.v,oe=b.j,11>L||(le&=-2,oe&=-2),0>le||0>oe||0>=he||0>=me||le+he>q||oe+me>te))return 0;if(_.v=le,_.j=oe,_.va=le+he,_.o=oe+me,_.U=he,_.T=me,_.da=b!=null&&0<b.da,_.da){if(!ct(he,me,L=[b.ib],le=[b.hb]))return 0;_.ib=L[0],_.hb=le[0]}return _.ob=b!=null&&b.ob,_.Kb=b==null||!b.Sd,_.da&&(_.ob=_.ib<3*q/4&&_.hb<3*te/4,_.Kb=0),1}function ur(b){if(b==null)return 2;if(11>b.S){var _=b.f.RGBA;_.fb+=(b.height-1)*_.A,_.A=-_.A}else _=b.f.kb,b=b.height,_.O+=(b-1)*_.fa,_.fa=-_.fa,_.N+=(b-1>>1)*_.Ab,_.Ab=-_.Ab,_.W+=(b-1>>1)*_.Db,_.Db=-_.Db,_.F!=null&&(_.J+=(b-1)*_.lb,_.lb=-_.lb);return 0}function dr(b,_,L,q){if(q==null||0>=b||0>=_)return 2;if(L!=null){if(L.Da){var te=L.cd,le=L.bd,oe=-2&L.v,he=-2&L.j;if(0>oe||0>he||0>=te||0>=le||oe+te>b||he+le>_)return 2;b=te,_=le}if(L.da){if(!ct(b,_,te=[L.ib],le=[L.hb]))return 2;b=te[0],_=le[0]}}q.width=b,q.height=_;e:{var me=q.width,ke=q.height;if(b=q.S,0>=me||0>=ke||!(b>=td&&13>b))b=2;else{if(0>=q.Rd&&q.sd==null){oe=le=te=_=0;var Ue=(he=me*cd[b])*ke;if(11>b||(le=(ke+1)/2*(_=(me+1)/2),b==12&&(oe=(te=me)*ke)),(ke=s(Ue+2*le+oe))==null){b=1;break e}q.sd=ke,11>b?((me=q.f.RGBA).eb=ke,me.fb=0,me.A=he,me.size=Ue):((me=q.f.kb).y=ke,me.O=0,me.fa=he,me.Fd=Ue,me.f=ke,me.N=0+Ue,me.Ab=_,me.Cd=le,me.ea=ke,me.W=0+Ue+le,me.Db=_,me.Ed=le,b==12&&(me.F=ke,me.J=0+Ue+2*le),me.Tc=oe,me.lb=te)}if(_=1,te=q.S,le=q.width,oe=q.height,te>=td&&13>te)if(11>te)b=q.f.RGBA,_&=(he=Math.abs(b.A))*(oe-1)+le<=b.size,_&=he>=le*cd[te],_&=b.eb!=null;else{b=q.f.kb,he=(le+1)/2,Ue=(oe+1)/2,me=Math.abs(b.fa),ke=Math.abs(b.Ab);var Ye=Math.abs(b.Db),ye=Math.abs(b.lb),Oe=ye*(oe-1)+le;_&=me*(oe-1)+le<=b.Fd,_&=ke*(Ue-1)+he<=b.Cd,_=(_&=Ye*(Ue-1)+he<=b.Ed)&me>=le&ke>=he&Ye>=he,_&=b.y!=null,_&=b.f!=null,_&=b.ea!=null,te==12&&(_&=ye>=le,_&=Oe<=b.Tc,_&=b.F!=null)}else _=0;b=_?0:2}}return b!=0||L!=null&&L.fd&&(b=ur(q)),b}var qr=64,Fr=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],mr=24,$r=32,sn=8,Tr=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];yt("Predictor0","PredictorAdd0"),j.Predictor0=function(){return 4278190080},j.Predictor1=function(b){return b},j.Predictor2=function(b,_,L){return _[L+0]},j.Predictor3=function(b,_,L){return _[L+1]},j.Predictor4=function(b,_,L){return _[L-1]},j.Predictor5=function(b,_,L){return Lt(Lt(b,_[L+1]),_[L+0])},j.Predictor6=function(b,_,L){return Lt(b,_[L-1])},j.Predictor7=function(b,_,L){return Lt(b,_[L+0])},j.Predictor8=function(b,_,L){return Lt(_[L-1],_[L+0])},j.Predictor9=function(b,_,L){return Lt(_[L+0],_[L+1])},j.Predictor10=function(b,_,L){return Lt(Lt(b,_[L-1]),Lt(_[L+0],_[L+1]))},j.Predictor11=function(b,_,L){var q=_[L+0];return 0>=zt(q>>24&255,b>>24&255,(_=_[L-1])>>24&255)+zt(q>>16&255,b>>16&255,_>>16&255)+zt(q>>8&255,b>>8&255,_>>8&255)+zt(255&q,255&b,255&_)?q:b},j.Predictor12=function(b,_,L){var q=_[L+0];return(jt((b>>24&255)+(q>>24&255)-((_=_[L-1])>>24&255))<<24|jt((b>>16&255)+(q>>16&255)-(_>>16&255))<<16|jt((b>>8&255)+(q>>8&255)-(_>>8&255))<<8|jt((255&b)+(255&q)-(255&_)))>>>0},j.Predictor13=function(b,_,L){var q=_[L-1];return(Pt((b=Lt(b,_[L+0]))>>24&255,q>>24&255)<<24|Pt(b>>16&255,q>>16&255)<<16|Pt(b>>8&255,q>>8&255)<<8|Pt(255&b,255&q))>>>0};var xr=j.PredictorAdd0;j.PredictorAdd1=Jt,yt("Predictor2","PredictorAdd2"),yt("Predictor3","PredictorAdd3"),yt("Predictor4","PredictorAdd4"),yt("Predictor5","PredictorAdd5"),yt("Predictor6","PredictorAdd6"),yt("Predictor7","PredictorAdd7"),yt("Predictor8","PredictorAdd8"),yt("Predictor9","PredictorAdd9"),yt("Predictor10","PredictorAdd10"),yt("Predictor11","PredictorAdd11"),yt("Predictor12","PredictorAdd12"),yt("Predictor13","PredictorAdd13");var ta=j.PredictorAdd2;Bt("ColorIndexInverseTransform","MapARGB","32b",function(b){return b>>8&255},function(b){return b}),Bt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(b){return b},function(b){return b>>8&255});var ra,js=j.ColorIndexInverseTransform,mn=j.MapARGB,pl=j.VP8LColorIndexInverseTransformAlpha,is=j.MapAlpha,gl=j.VP8LPredictorsAdd=[];gl.length=16,(j.VP8LPredictors=[]).length=16,(j.VP8LPredictorsAdd_C=[]).length=16,(j.VP8LPredictors_C=[]).length=16;var CA,ml,Jl,ci,Ti,Wo,ui,di,cr,In,ya,ha,Wa,Qn,xo,Zl,fc,r0,Df,$p,Jp,Zp,If,Qf,hc,xl,a0,Zi,pc=s(511),Z0=s(2041),n0=s(225),s0=s(767),ed=0,Xo=Z0,i0=n0,Gs=s0,Ds=pc,td=0,Ws=1,rd=2,bl=3,l0=4,Jc=5,SA=6,o0=7,ad=8,Zc=9,nd=10,vl=[2,3,7],eu=[3,3,11],gc=[280,256,256,256,40],sd=[0,1,1,1,0],A0=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],wl=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],yl=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],EA=8,_l=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Bl=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],el=null,eg=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Of=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],id=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],tg=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Is=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],ln=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],la=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],fi=[],En=[],eo=[],NA=1,Rf=2,Yo=[],Qs=[];Xl("UpsampleRgbLinePair",Yl,3),Xl("UpsampleBgrLinePair",gn,3),Xl("UpsampleRgbaLinePair",Sn,4),Xl("UpsampleBgraLinePair",Fi,4),Xl("UpsampleArgbLinePair",BA,4),Xl("UpsampleRgba4444LinePair",hl,2),Xl("UpsampleRgb565LinePair",Dn,2);var mc=j.UpsampleRgbLinePair,Mf=j.UpsampleBgrLinePair,tu=j.UpsampleRgbaLinePair,ld=j.UpsampleBgraLinePair,FA=j.UpsampleArgbLinePair,bo=j.UpsampleRgba4444LinePair,TA=j.UpsampleRgb565LinePair,kl=16,ru=1<<kl-1,xc=-227,LA=482,od=6,UA=0,Os=s(256),Ad=s(256),rg=s(256),m1=s(256),x1=s(LA-xc),b1=s(LA-xc);$l("YuvToRgbRow",Yl,3),$l("YuvToBgrRow",gn,3),$l("YuvToRgbaRow",Sn,4),$l("YuvToBgraRow",Fi,4),$l("YuvToArgbRow",BA,4),$l("YuvToRgba4444Row",hl,2),$l("YuvToRgb565Row",Dn,2);var On=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],au=[0,2,8],c0=[8,7,6,4,4,2,2,2,1,1,1,1],u0=1;this.WebPDecodeRGBA=function(b,_,L,q,te){var le=Ws,oe=new At,he=new Vt;oe.ba=he,he.S=le,he.width=[he.width],he.height=[he.height];var me=he.width,ke=he.height,Ue=new tt;if(Ue==null||b==null)var Ye=2;else t(Ue!=null),Ye=ut(b,_,L,Ue.width,Ue.height,Ue.Pd,Ue.Qd,Ue.format,null);if(Ye!=0?me=0:(me!=null&&(me[0]=Ue.width[0]),ke!=null&&(ke[0]=Ue.height[0]),me=1),me){he.width=he.width[0],he.height=he.height[0],q!=null&&(q[0]=he.width),te!=null&&(te[0]=he.height);e:{if(q=new Vs,(te=new wt).data=b,te.w=_,te.ha=L,te.kd=1,_=[0],t(te!=null),((b=ut(te.data,te.w,te.ha,null,null,null,_,null,te))==0||b==7)&&_[0]&&(b=4),(_=b)==0){if(t(oe!=null),q.data=te.data,q.w=te.w+te.offset,q.ha=te.ha-te.offset,q.put=Nt,q.ac=ir,q.bc=Sr,q.ma=oe,te.xa){if((b=Qe())==null){oe=1;break e}if((function(ye,Oe){var Ge=[0],st=[0],We=[0];t:for(;;){if(ye==null)return 0;if(Oe==null)return ye.a=2,0;if(ye.l=Oe,ye.a=0,G(ye.m,Oe.data,Oe.w,Oe.ha),!ca(ye.m,Ge,st,We)){ye.a=3;break t}if(ye.xb=Rf,Oe.width=Ge[0],Oe.height=st[0],!Pe(Ge[0],st[0],1,ye,null))break t;return 1}return t(ye.a!=0),0})(b,q)){if(q=(_=dr(q.width,q.height,oe.Oa,oe.ba))==0){t:{q=b;r:for(;;){if(q==null){q=0;break t}if(t(q.s.yc!=null),t(q.s.Ya!=null),t(0<q.s.Wb),t((L=q.l)!=null),t((te=L.ma)!=null),q.xb!=0){if(q.ca=te.ba,q.tb=te.tb,t(q.ca!=null),!Ft(te.Oa,L,bl)){q.a=2;break r}if(!qe(q,L.width)||L.da)break r;if((L.da||mt(q.ca.S))&&Ji(),11>q.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),q.ca.f.kb.F!=null&&Ji()),q.Pb&&0<q.s.ua&&q.s.vb.X==null&&!J(q.s.vb,q.s.Wa.Xa)){q.a=1;break r}q.xb=0}if(!Fe(q,q.V,q.Ba,q.c,q.i,L.o,fe))break r;te.Dc=q.Ma,q=1;break t}t(q.a!=0),q=0}q=!q}q&&(_=b.a)}else _=b.a}else{if((b=new ii)==null){oe=1;break e}if(b.Fa=te.na,b.P=te.P,b.qc=te.Sa,Xi(b,q)){if((_=dr(q.width,q.height,oe.Oa,oe.ba))==0){if(b.Aa=0,L=oe.Oa,t((te=b)!=null),L!=null){if(0<(me=0>(me=L.Md)?0:100<me?255:255*me/100)){for(ke=Ue=0;4>ke;++ke)12>(Ye=te.pb[ke]).lc&&(Ye.ia=me*c0[0>Ye.lc?0:Ye.lc]>>3),Ue|=Ye.ia;Ue&&(alert("todo:VP8InitRandom"),te.ia=1)}te.Ga=L.Id,100<te.Ga?te.Ga=100:0>te.Ga&&(te.Ga=0)}(function(ye,Oe){if(ye==null)return 0;if(Oe==null)return ia(ye,2,"NULL VP8Io parameter in VP8Decode().");if(!ye.cb&&!Xi(ye,Oe))return 0;if(t(ye.cb),Oe.ac==null||Oe.ac(Oe)){Oe.ob&&(ye.L=0);var Ge=au[ye.L];if(ye.L==2?(ye.yb=0,ye.zb=0):(ye.yb=Oe.v-Ge>>4,ye.zb=Oe.j-Ge>>4,0>ye.yb&&(ye.yb=0),0>ye.zb&&(ye.zb=0)),ye.Va=Oe.o+15+Ge>>4,ye.Hb=Oe.va+15+Ge>>4,ye.Hb>ye.za&&(ye.Hb=ye.za),ye.Va>ye.Ub&&(ye.Va=ye.Ub),0<ye.L){var st=ye.ed;for(Ge=0;4>Ge;++Ge){var We;if(ye.Qa.Cb){var nt=ye.Qa.Lb[Ge];ye.Qa.Fb||(nt+=st.Tb)}else nt=st.Tb;for(We=0;1>=We;++We){var dt=ye.gd[Ge][We],St=nt;if(st.Pc&&(St+=st.vd[0],We&&(St+=st.od[0])),0<(St=0>St?0:63<St?63:St)){var vt=St;0<st.wb&&(vt=4<st.wb?vt>>2:vt>>1)>9-st.wb&&(vt=9-st.wb),1>vt&&(vt=1),dt.dd=vt,dt.tc=2*St+vt,dt.ld=40<=St?2:15<=St?1:0}else dt.tc=0;dt.La=We}}}Ge=0}else ia(ye,6,"Frame setup failed"),Ge=ye.a;if(Ge=Ge==0){if(Ge){ye.$c=0,0<ye.Aa||(ye.Ic=u0);t:{Ge=ye.Ic,st=4*(vt=ye.za);var lr=32*vt,Zt=vt+1,Or=0<ye.L?vt*(0<ye.Aa?2:1):0,nr=(ye.Aa==2?2:1)*vt;if((dt=st+832+(We=3*(16*Ge+au[ye.L])/2*lr)+(nt=ye.Fa!=null&&0<ye.Fa.length?ye.Kc.c*ye.Kc.i:0))!=dt)Ge=0;else{if(dt>ye.Vb){if(ye.Vb=0,ye.Ec=s(dt),ye.Fc=0,ye.Ec==null){Ge=ia(ye,1,"no memory during frame initialization.");break t}ye.Vb=dt}dt=ye.Ec,St=ye.Fc,ye.Ac=dt,ye.Bc=St,St+=st,ye.Gd=l(lr,rn),ye.Hd=0,ye.rb=l(Zt+1,sa),ye.sb=1,ye.wa=Or?l(Or,Pr):null,ye.Y=0,ye.D.Nb=0,ye.D.wa=ye.wa,ye.D.Y=ye.Y,0<ye.Aa&&(ye.D.Y+=vt),t(!0),ye.oc=dt,ye.pc=St,St+=832,ye.ya=l(nr,Bi),ye.aa=0,ye.D.ya=ye.ya,ye.D.aa=ye.aa,ye.Aa==2&&(ye.D.aa+=vt),ye.R=16*vt,ye.B=8*vt,vt=(lr=au[ye.L])*ye.R,lr=lr/2*ye.B,ye.sa=dt,ye.ta=St+vt,ye.qa=ye.sa,ye.ra=ye.ta+16*Ge*ye.R+lr,ye.Ha=ye.qa,ye.Ia=ye.ra+8*Ge*ye.B+lr,ye.$c=0,St+=We,ye.mb=nt?dt:null,ye.nb=nt?St:null,t(St+nt<=ye.Fc+ye.Vb),Ko(ye),n(ye.Ac,ye.Bc,0,st),Ge=1}}if(Ge){if(Oe.ka=0,Oe.y=ye.sa,Oe.O=ye.ta,Oe.f=ye.qa,Oe.N=ye.ra,Oe.ea=ye.Ha,Oe.Vd=ye.Ia,Oe.fa=ye.R,Oe.Rc=ye.B,Oe.F=null,Oe.J=0,!ed){for(Ge=-255;255>=Ge;++Ge)pc[255+Ge]=0>Ge?-Ge:Ge;for(Ge=-1020;1020>=Ge;++Ge)Z0[1020+Ge]=-128>Ge?-128:127<Ge?127:Ge;for(Ge=-112;112>=Ge;++Ge)n0[112+Ge]=-16>Ge?-16:15<Ge?15:Ge;for(Ge=-255;510>=Ge;++Ge)s0[255+Ge]=0>Ge?0:255<Ge?255:Ge;ed=1}ui=Ci,di=xA,In=hn,ya=qo,ha=Kl,cr=oi,Wa=$c,Qn=Wl,xo=ee,Zl=Be,fc=uc,r0=E,Df=Ne,$p=Ke,Jp=Vl,Zp=ul,If=Vo,Qf=yA,En[0]=cc,En[1]=bA,En[2]=ma,En[3]=$i,En[4]=Ga,En[5]=go,En[6]=Kn,En[7]=jn,En[8]=zl,En[9]=Bs,fi[0]=Us,fi[1]=vA,fi[2]=Ac,fi[3]=Yi,fi[4]=ys,fi[5]=_s,fi[6]=po,eo[0]=zo,eo[1]=oc,eo[2]=qn,eo[3]=Yc,eo[4]=zn,eo[5]=wA,eo[6]=Al,Ge=1}else Ge=0}Ge&&(Ge=(function(aa,on){for(aa.M=0;aa.M<aa.Va;++aa.M){var zr,er=aa.Jc[aa.M&aa.Xb],Kt=aa.m,xn=aa;for(zr=0;zr<xn.za;++zr){var Cr=Kt,Gr=xn,Ua=Gr.Ac,ls=Gr.Bc+4*zr,Rs=Gr.zc,Xa=Gr.ya[Gr.aa+zr];if(Gr.Qa.Bb?Xa.$b=be(Cr,Gr.Pa.jb[0])?2+be(Cr,Gr.Pa.jb[2]):be(Cr,Gr.Pa.jb[1]):Xa.$b=0,Gr.kc&&(Xa.Ad=be(Cr,Gr.Bd)),Xa.Za=!be(Cr,145)+0,Xa.Za){var Gn=Xa.Ob,Xs=0;for(Gr=0;4>Gr;++Gr){var Wn,Jr=Rs[0+Gr];for(Wn=0;4>Wn;++Wn){Jr=Is[Ua[ls+Wn]][Jr];for(var xa=id[be(Cr,Jr[0])];0<xa;)xa=id[2*xa+be(Cr,Jr[xa])];Jr=-xa,Ua[ls+Wn]=Jr}a(Gn,Xs,Ua,ls,4),Xs+=4,Rs[0+Gr]=Jr}}else Jr=be(Cr,156)?be(Cr,128)?1:3:be(Cr,163)?2:0,Xa.Ob[0]=Jr,n(Ua,ls,Jr,4),n(Rs,0,Jr,4);Xa.Dd=be(Cr,142)?be(Cr,114)?be(Cr,183)?1:3:2:0}if(xn.m.Ka)return ia(aa,7,"Premature end-of-partition0 encountered.");for(;aa.ja<aa.za;++aa.ja){if(xn=er,Cr=(Kt=aa).rb[Kt.sb-1],Ua=Kt.rb[Kt.sb+Kt.ja],zr=Kt.ya[Kt.aa+Kt.ja],ls=Kt.kc?zr.Ad:0)Cr.la=Ua.la=0,zr.Za||(Cr.Na=Ua.Na=0),zr.Hc=0,zr.Gc=0,zr.ia=0;else{var bn,_a;if(Cr=Ua,Ua=xn,ls=Kt.Pa.Xc,Rs=Kt.ya[Kt.aa+Kt.ja],Xa=Kt.pb[Rs.$b],Gr=Rs.ad,Gn=0,Xs=Kt.rb[Kt.sb-1],Jr=Wn=0,n(Gr,Gn,0,384),Rs.Za)var os=0,vn=ls[3];else{xa=s(16);var ba=Cr.Na+Xs.Na;if(ba=el(Ua,ls[1],ba,Xa.Eb,0,xa,0),Cr.Na=Xs.Na=(0<ba)+0,1<ba)ui(xa,0,Gr,Gn);else{var Rn=xa[0]+3>>3;for(xa=0;256>xa;xa+=16)Gr[Gn+xa]=Rn}os=1,vn=ls[0]}var ja=15&Cr.la,Xn=15&Xs.la;for(xa=0;4>xa;++xa){var Yn=1&Xn;for(Rn=_a=0;4>Rn;++Rn)ja=ja>>1|(Yn=(ba=el(Ua,vn,ba=Yn+(1&ja),Xa.Sc,os,Gr,Gn))>os)<<7,_a=_a<<2|(3<ba?3:1<ba?2:Gr[Gn+0]!=0),Gn+=16;ja>>=4,Xn=Xn>>1|Yn<<7,Wn=(Wn<<8|_a)>>>0}for(vn=ja,os=Xn>>4,bn=0;4>bn;bn+=2){for(_a=0,ja=Cr.la>>4+bn,Xn=Xs.la>>4+bn,xa=0;2>xa;++xa){for(Yn=1&Xn,Rn=0;2>Rn;++Rn)ba=Yn+(1&ja),ja=ja>>1|(Yn=0<(ba=el(Ua,ls[2],ba,Xa.Qc,0,Gr,Gn)))<<3,_a=_a<<2|(3<ba?3:1<ba?2:Gr[Gn+0]!=0),Gn+=16;ja>>=2,Xn=Xn>>1|Yn<<5}Jr|=_a<<4*bn,vn|=ja<<4<<bn,os|=(240&Xn)<<bn}Cr.la=vn,Xs.la=os,Rs.Hc=Wn,Rs.Gc=Jr,Rs.ia=43690&Jr?0:Xa.ia,ls=!(Wn|Jr)}if(0<Kt.L&&(Kt.wa[Kt.Y+Kt.ja]=Kt.gd[zr.$b][zr.Za],Kt.wa[Kt.Y+Kt.ja].La|=!ls),xn.Ka)return ia(aa,7,"Premature end-of-file encountered.")}if(Ko(aa),Kt=on,xn=1,zr=(er=aa).D,Cr=0<er.L&&er.M>=er.zb&&er.M<=er.Va,er.Aa==0)t:{if(zr.M=er.M,zr.uc=Cr,De(er,zr),xn=1,zr=(_a=er.D).Nb,Cr=(Jr=au[er.L])*er.R,Ua=Jr/2*er.B,xa=16*zr*er.R,Rn=8*zr*er.B,ls=er.sa,Rs=er.ta-Cr+xa,Xa=er.qa,Gr=er.ra-Ua+Rn,Gn=er.Ha,Xs=er.Ia-Ua+Rn,Xn=(ja=_a.M)==0,Wn=ja>=er.Va-1,er.Aa==2&&De(er,_a),_a.uc)for(Yn=(ba=er).D.M,t(ba.D.uc),_a=ba.yb;_a<ba.Hb;++_a){os=_a,vn=Yn;var Ra=(pa=($n=ba).D).Nb;bn=$n.R;var pa=pa.wa[pa.Y+os],Ys=$n.sa,Nn=$n.ta+16*Ra*bn+16*os,br=pa.dd,vr=pa.tc;if(vr!=0)if(t(3<=vr),$n.L==1)0<os&&Zp(Ys,Nn,bn,vr+4),pa.La&&Qf(Ys,Nn,bn,vr),0<vn&&Jp(Ys,Nn,bn,vr+4),pa.La&&If(Ys,Nn,bn,vr);else{var va=$n.B,Li=$n.qa,Cl=$n.ra+8*Ra*va+8*os,hi=$n.Ha,$n=$n.Ia+8*Ra*va+8*os;Ra=pa.ld,0<os&&(Qn(Ys,Nn,bn,vr+4,br,Ra),Zl(Li,Cl,hi,$n,va,vr+4,br,Ra)),pa.La&&(r0(Ys,Nn,bn,vr,br,Ra),$p(Li,Cl,hi,$n,va,vr,br,Ra)),0<vn&&(Wa(Ys,Nn,bn,vr+4,br,Ra),xo(Li,Cl,hi,$n,va,vr+4,br,Ra)),pa.La&&(fc(Ys,Nn,bn,vr,br,Ra),Df(Li,Cl,hi,$n,va,vr,br,Ra))}}if(er.ia&&alert("todo:DitherRow"),Kt.put!=null){if(_a=16*ja,ja=16*(ja+1),Xn?(Kt.y=er.sa,Kt.O=er.ta+xa,Kt.f=er.qa,Kt.N=er.ra+Rn,Kt.ea=er.Ha,Kt.W=er.Ia+Rn):(_a-=Jr,Kt.y=ls,Kt.O=Rs,Kt.f=Xa,Kt.N=Gr,Kt.ea=Gn,Kt.W=Xs),Wn||(ja-=Jr),ja>Kt.o&&(ja=Kt.o),Kt.F=null,Kt.J=null,er.Fa!=null&&0<er.Fa.length&&_a<ja&&(Kt.J=La(er,Kt,_a,ja-_a),Kt.F=er.mb,Kt.F==null&&Kt.F.length==0)){xn=ia(er,3,"Could not decode alpha data.");break t}_a<Kt.j&&(Jr=Kt.j-_a,_a=Kt.j,t(!(1&Jr)),Kt.O+=er.R*Jr,Kt.N+=er.B*(Jr>>1),Kt.W+=er.B*(Jr>>1),Kt.F!=null&&(Kt.J+=Kt.width*Jr)),_a<ja&&(Kt.O+=Kt.v,Kt.N+=Kt.v>>1,Kt.W+=Kt.v>>1,Kt.F!=null&&(Kt.J+=Kt.v),Kt.ka=_a-Kt.j,Kt.U=Kt.va-Kt.v,Kt.T=ja-_a,xn=Kt.put(Kt))}zr+1!=er.Ic||Wn||(a(er.sa,er.ta-Cr,ls,Rs+16*er.R,Cr),a(er.qa,er.ra-Ua,Xa,Gr+8*er.B,Ua),a(er.Ha,er.Ia-Ua,Gn,Xs+8*er.B,Ua))}if(!xn)return ia(aa,6,"Output aborted.")}return 1})(ye,Oe)),Oe.bc!=null&&Oe.bc(Oe),Ge&=1}return Ge?(ye.cb=0,Ge):0})(b,q)||(_=b.a)}}else _=b.a}_==0&&oe.Oa!=null&&oe.Oa.fd&&(_=ur(oe.ba))}oe=_}le=oe!=0?null:11>le?he.f.RGBA.eb:he.f.kb.y}else le=null;return le};var cd=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function f(j,W){for(var I="",Q=0;Q<4;Q++)I+=String.fromCharCode(j[W++]);return I}function h(j,W){return j[W+0]|j[W+1]<<8}function g(j,W){return(j[W+0]|j[W+1]<<8|j[W+2]<<16)>>>0}function x(j,W){return(j[W+0]|j[W+1]<<8|j[W+2]<<16|j[W+3]<<24)>>>0}new u;var m=[0],w=[0],v=[],B=new u,k=e,N=(function(j,W){var I={},Q=0,Y=!1,z=0,ue=0;if(I.frames=[],!(function(F,R){for(var M=0;M<4;M++)if(F[R+M]!="RIFF".charCodeAt(M))return!0;return!1})(j,W)){for(x(j,W+=4),W+=8;W<j.length;){var Z=f(j,W),Ae=x(j,W+=4);W+=4;var ve=Ae+(1&Ae);switch(Z){case"VP8 ":case"VP8L":I.frames[Q]===void 0&&(I.frames[Q]={}),(we=I.frames[Q]).src_off=Y?ue:W-8,we.src_size=z+Ae+8,Q++,Y&&(Y=!1,z=0,ue=0);break;case"VP8X":(we=I.header={}).feature_flags=j[W];var G=W+4;we.canvas_width=1+g(j,G),G+=3,we.canvas_height=1+g(j,G),G+=3;break;case"ALPH":Y=!0,z=ve+8,ue=W-8;break;case"ANIM":(we=I.header).bgcolor=x(j,W),G=W+4,we.loop_count=h(j,G),G+=2;break;case"ANMF":var Se,we;(we=I.frames[Q]={}).offset_x=2*g(j,W),W+=3,we.offset_y=2*g(j,W),W+=3,we.width=1+g(j,W),W+=3,we.height=1+g(j,W),W+=3,we.duration=g(j,W),W+=3,Se=j[W++],we.dispose=1&Se,we.blend=Se>>1&1}Z!="ANMF"&&(W+=ve)}return I}})(k,0);N.response=k,N.rgbaoutput=!0,N.dataurl=!1;var S=N.header?N.header:null,O=N.frames?N.frames:null;if(S){S.loop_counter=S.loop_count,m=[S.canvas_height],w=[S.canvas_width];for(var T=0;T<O.length&&O[T].blend!=0;T++);}var U=O[0],D=B.WebPDecodeRGBA(k,U.src_off,U.src_size,w,m);U.rgba=D,U.imgwidth=w[0],U.imgheight=m[0];for(var H=0;H<w[0]*m[0]*4;H++)v[H]=D[H];return this.width=w,this.height=m,this.data=v,this}function Mee(){var e,t=this.internal.__metadata__.metadata,r=unescape(encodeURIComponent(t));e=this.internal.__metadata__.rawXml?r:'<x:xmpmeta xmlns:x="adobe:ns:meta/"><rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceUri+'"><jspdf:metadata>'+r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")+"</jspdf:metadata></rdf:Description></rdf:RDF></x:xmpmeta>",this.internal.__metadata__.metadataObjectNumber=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+e.length+" >>"),this.internal.write("stream"),this.internal.write(e),this.internal.write("endstream"),this.internal.write("endobj")}function Hee(){this.internal.__metadata__.metadataObjectNumber&&this.internal.write("/Metadata "+this.internal.__metadata__.metadataObjectNumber+" 0 R")}(function(e){var t,r,a,n,s,l,A,u,f,h=function(F){return F=F||{},this.isStrokeTransparent=F.isStrokeTransparent||!1,this.strokeOpacity=F.strokeOpacity||1,this.strokeStyle=F.strokeStyle||"#000000",this.fillStyle=F.fillStyle||"#000000",this.isFillTransparent=F.isFillTransparent||!1,this.fillOpacity=F.fillOpacity||1,this.font=F.font||"10px sans-serif",this.textBaseline=F.textBaseline||"alphabetic",this.textAlign=F.textAlign||"left",this.lineWidth=F.lineWidth||1,this.lineJoin=F.lineJoin||"miter",this.lineCap=F.lineCap||"butt",this.path=F.path||[],this.transform=F.transform!==void 0?F.transform.clone():new u,this.globalCompositeOperation=F.globalCompositeOperation||"normal",this.globalAlpha=F.globalAlpha||1,this.clip_path=F.clip_path||[],this.currentPoint=F.currentPoint||new l,this.miterLimit=F.miterLimit||10,this.lastPoint=F.lastPoint||new l,this.lineDashOffset=F.lineDashOffset||0,this.lineDash=F.lineDash||[],this.margin=F.margin||[0,0,0,0],this.prevPageLastElemOffset=F.prevPageLastElemOffset||0,this.ignoreClearRect=typeof F.ignoreClearRect!="boolean"||F.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new g(this),t=this.internal.f2,r=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,n=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,l=this.internal.Point,A=this.internal.Rectangle,u=this.internal.Matrix,f=new h}]);var g=function(F){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var R=F;Object.defineProperty(this,"pdf",{get:function(){return R}});var M=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return M},set:function(J){M=!!J}});var P=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return P},set:function(J){P=!!J}});var re=0;Object.defineProperty(this,"posX",{get:function(){return re},set:function(J){isNaN(J)||(re=J)}});var ge=0;Object.defineProperty(this,"posY",{get:function(){return ge},set:function(J){isNaN(J)||(ge=J)}}),Object.defineProperty(this,"margin",{get:function(){return f.margin},set:function(J){var ze;typeof J=="number"?ze=[J,J,J,J]:((ze=new Array(4))[0]=J[0],ze[1]=J.length>=2?J[1]:ze[0],ze[2]=J.length>=3?J[2]:ze[0],ze[3]=J.length>=4?J[3]:ze[1]),f.margin=ze}});var Ce=!1;Object.defineProperty(this,"autoPaging",{get:function(){return Ce},set:function(J){Ce=J}});var de=0;Object.defineProperty(this,"lastBreak",{get:function(){return de},set:function(J){de=J}});var be=[];Object.defineProperty(this,"pageBreaks",{get:function(){return be},set:function(J){be=J}}),Object.defineProperty(this,"ctx",{get:function(){return f},set:function(J){J instanceof h&&(f=J)}}),Object.defineProperty(this,"path",{get:function(){return f.path},set:function(J){f.path=J}});var Le=[];Object.defineProperty(this,"ctxStack",{get:function(){return Le},set:function(J){Le=J}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(J){var ze;ze=x(J),this.ctx.fillStyle=ze.style,this.ctx.isFillTransparent=ze.a===0,this.ctx.fillOpacity=ze.a,this.pdf.setFillColor(ze.r,ze.g,ze.b,{a:ze.a}),this.pdf.setTextColor(ze.r,ze.g,ze.b,{a:ze.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(J){var ze=x(J);this.ctx.strokeStyle=ze.style,this.ctx.isStrokeTransparent=ze.a===0,this.ctx.strokeOpacity=ze.a,ze.a===0?this.pdf.setDrawColor(255,255,255):(ze.a,this.pdf.setDrawColor(ze.r,ze.g,ze.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(J){["butt","round","square"].indexOf(J)!==-1&&(this.ctx.lineCap=J,this.pdf.setLineCap(J))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(J){isNaN(J)||(this.ctx.lineWidth=J,this.pdf.setLineWidth(J))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(J){["bevel","round","miter"].indexOf(J)!==-1&&(this.ctx.lineJoin=J,this.pdf.setLineJoin(J))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(J){isNaN(J)||(this.ctx.miterLimit=J,this.pdf.setMiterLimit(J))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(J){this.ctx.textBaseline=J}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(J){["right","end","center","left","start"].indexOf(J)!==-1&&(this.ctx.textAlign=J)}});var ie=null,_e=null,je=null;Object.defineProperty(this,"fontFaces",{get:function(){return je},set:function(J){ie=null,_e=null,je=J}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(J){var ze;if(this.ctx.font=J,(ze=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(J))!==null){var He=ze[1];ze[2];var ct=ze[3],Xe=ze[4];ze[5];var Ut=ze[6],yt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Xe)[2];Xe=Math.floor(yt==="px"?parseFloat(Xe)*this.pdf.internal.scaleFactor:yt==="em"?parseFloat(Xe)*this.pdf.getFontSize():parseFloat(Xe)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Xe);var qt=(function(Bt){var pr,$t,Ee=[],at=Bt.trim();if(at==="")return Kv;if(at in VC)return[VC[at]];for(;at!=="";){switch($t=null,pr=(at=WC(at)).charAt(0)){case'"':case"'":$t=jee(at.substring(1),pr);break;default:$t=Dee(at)}if($t===null||(Ee.push($t[0]),(at=WC($t[1]))!==""&&at.charAt(0)!==","))return Kv;at=at.replace(/^,/,"")}return Ee})(Ut);if(this.fontFaces){var Lt=(function(Bt,pr){var $t=Bt.getFontList(),Ee=JSON.stringify($t);if(ie===null||_e!==Ee){var at=(function(it){var bt=[];return Object.keys(it).forEach(function(Et){it[Et].forEach(function(mt){var Ot=null;switch(mt){case"bold":Ot={family:Et,weight:"bold"};break;case"italic":Ot={family:Et,style:"italic"};break;case"bolditalic":Ot={family:Et,weight:"bold",style:"italic"};break;case"":case"normal":Ot={family:Et}}Ot!==null&&(Ot.ref={name:Et,style:mt},bt.push(Ot))})}),bt})($t);ie=(function(it){for(var bt={},Et=0;Et<it.length;++Et){var mt=Pv(it[Et]),Ot=mt.family,Ur=mt.stretch,Vt=mt.style,tt=mt.weight;bt[Ot]=bt[Ot]||{},bt[Ot][Ur]=bt[Ot][Ur]||{},bt[Ot][Ur][Vt]=bt[Ot][Ur][Vt]||{},bt[Ot][Ur][Vt][tt]=mt}return bt})(at.concat(pr)),_e=Ee}return ie})(this.pdf,this.fontFaces),jt=qt.map(function(Bt){return{family:Bt,stretch:"normal",weight:ct,style:He}}),Pt=(function(Bt,pr,$t){for(var Ee=($t=$t||{}).defaultFontFamily||"times",at=Object.assign({},Uee,$t.genericFontFamilies||{}),it=null,bt=null,Et=0;Et<pr.length;++Et)if(at[(it=Pv(pr[Et])).family]&&(it.family=at[it.family]),Bt.hasOwnProperty(it.family)){bt=Bt[it.family];break}if(!(bt=bt||Bt[Ee]))throw new Error("Could not find a font-family for the rule '"+GC(it)+"' and default family '"+Ee+"'.");if(bt=(function(mt,Ot){if(Ot[mt])return Ot[mt];var Ur=n2[mt],Vt=Ur<=n2.normal?-1:1,tt=zC(Ot,FT,Ur,Vt);if(!tt)throw new Error("Could not find a matching font-stretch value for "+mt);return tt})(it.stretch,bt),bt=(function(mt,Ot){if(Ot[mt])return Ot[mt];for(var Ur=NT[mt],Vt=0;Vt<Ur.length;++Vt)if(Ot[Ur[Vt]])return Ot[Ur[Vt]];throw new Error("Could not find a matching font-style for "+mt)})(it.style,bt),!(bt=(function(mt,Ot){if(Ot[mt])return Ot[mt];if(mt===400&&Ot[500])return Ot[500];if(mt===500&&Ot[400])return Ot[400];var Ur=Lee[mt],Vt=zC(Ot,TT,Ur,mt<400?-1:1);if(!Vt)throw new Error("Could not find a matching font-weight for value "+mt);return Vt})(it.weight,bt)))throw new Error("Failed to resolve a font for the rule '"+GC(it)+"'.");return bt})(Lt,jt);this.pdf.setFont(Pt.ref.name,Pt.ref.style)}else{var zt="";(ct==="bold"||parseInt(ct,10)>=700||He==="bold")&&(zt="bold"),He==="italic"&&(zt+="italic"),zt.length===0&&(zt="normal");for(var Jt="",It={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},xt=0;xt<qt.length;xt++){if(this.pdf.internal.getFont(qt[xt],zt,{noFallback:!0,disableWarning:!0})!==void 0){Jt=qt[xt];break}if(zt==="bolditalic"&&this.pdf.internal.getFont(qt[xt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Jt=qt[xt],zt="bold";else if(this.pdf.internal.getFont(qt[xt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Jt=qt[xt],zt="normal";break}}if(Jt===""){for(var ht=0;ht<qt.length;ht++)if(It[qt[ht]]){Jt=It[qt[ht]];break}}Jt=Jt===""?"Times":Jt,this.pdf.setFont(Jt,zt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(J){this.ctx.globalCompositeOperation=J}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(J){this.ctx.globalAlpha=J}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(J){this.ctx.lineDashOffset=J,we.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(J){this.ctx.lineDash=J,we.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(J){this.ctx.ignoreClearRect=!!J}})};g.prototype.setLineDash=function(F){this.lineDash=F},g.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},g.prototype.fill=function(){O.call(this,"fill",!1)},g.prototype.stroke=function(){O.call(this,"stroke",!1)},g.prototype.beginPath=function(){this.path=[{type:"begin"}]},g.prototype.moveTo=function(F,R){if(isNaN(F)||isNaN(R))throw cn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var M=this.ctx.transform.applyToPoint(new l(F,R));this.path.push({type:"mt",x:M.x,y:M.y}),this.ctx.lastPoint=new l(F,R)},g.prototype.closePath=function(){var F=new l(0,0),R=0;for(R=this.path.length-1;R!==-1;R--)if(this.path[R].type==="begin"&&za(this.path[R+1])==="object"&&typeof this.path[R+1].x=="number"){F=new l(this.path[R+1].x,this.path[R+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new l(F.x,F.y)},g.prototype.lineTo=function(F,R){if(isNaN(F)||isNaN(R))throw cn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var M=this.ctx.transform.applyToPoint(new l(F,R));this.path.push({type:"lt",x:M.x,y:M.y}),this.ctx.lastPoint=new l(M.x,M.y)},g.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),O.call(this,null,!0)},g.prototype.quadraticCurveTo=function(F,R,M,P){if(isNaN(M)||isNaN(P)||isNaN(F)||isNaN(R))throw cn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var re=this.ctx.transform.applyToPoint(new l(M,P)),ge=this.ctx.transform.applyToPoint(new l(F,R));this.path.push({type:"qct",x1:ge.x,y1:ge.y,x:re.x,y:re.y}),this.ctx.lastPoint=new l(re.x,re.y)},g.prototype.bezierCurveTo=function(F,R,M,P,re,ge){if(isNaN(re)||isNaN(ge)||isNaN(F)||isNaN(R)||isNaN(M)||isNaN(P))throw cn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var Ce=this.ctx.transform.applyToPoint(new l(re,ge)),de=this.ctx.transform.applyToPoint(new l(F,R)),be=this.ctx.transform.applyToPoint(new l(M,P));this.path.push({type:"bct",x1:de.x,y1:de.y,x2:be.x,y2:be.y,x:Ce.x,y:Ce.y}),this.ctx.lastPoint=new l(Ce.x,Ce.y)},g.prototype.arc=function(F,R,M,P,re,ge){if(isNaN(F)||isNaN(R)||isNaN(M)||isNaN(P)||isNaN(re))throw cn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ge=!!ge,!this.ctx.transform.isIdentity){var Ce=this.ctx.transform.applyToPoint(new l(F,R));F=Ce.x,R=Ce.y;var de=this.ctx.transform.applyToPoint(new l(0,M)),be=this.ctx.transform.applyToPoint(new l(0,0));M=Math.sqrt(Math.pow(de.x-be.x,2)+Math.pow(de.y-be.y,2))}Math.abs(re-P)>=2*Math.PI&&(P=0,re=2*Math.PI),this.path.push({type:"arc",x:F,y:R,radius:M,startAngle:P,endAngle:re,counterclockwise:ge})},g.prototype.arcTo=function(F,R,M,P,re){throw new Error("arcTo not implemented.")},g.prototype.rect=function(F,R,M,P){if(isNaN(F)||isNaN(R)||isNaN(M)||isNaN(P))throw cn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(F,R),this.lineTo(F+M,R),this.lineTo(F+M,R+P),this.lineTo(F,R+P),this.lineTo(F,R),this.lineTo(F+M,R),this.lineTo(F,R)},g.prototype.fillRect=function(F,R,M,P){if(isNaN(F)||isNaN(R)||isNaN(M)||isNaN(P))throw cn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!m.call(this)){var re={};this.lineCap!=="butt"&&(re.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(re.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(F,R,M,P),this.fill(),re.hasOwnProperty("lineCap")&&(this.lineCap=re.lineCap),re.hasOwnProperty("lineJoin")&&(this.lineJoin=re.lineJoin)}},g.prototype.strokeRect=function(F,R,M,P){if(isNaN(F)||isNaN(R)||isNaN(M)||isNaN(P))throw cn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");w.call(this)||(this.beginPath(),this.rect(F,R,M,P),this.stroke())},g.prototype.clearRect=function(F,R,M,P){if(isNaN(F)||isNaN(R)||isNaN(M)||isNaN(P))throw cn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(F,R,M,P))},g.prototype.save=function(F){F=typeof F!="boolean"||F;for(var R=this.pdf.internal.getCurrentPageInfo().pageNumber,M=0;M<this.pdf.internal.getNumberOfPages();M++)this.pdf.setPage(M+1),this.pdf.internal.out("q");if(this.pdf.setPage(R),F){this.ctx.fontSize=this.pdf.internal.getFontSize();var P=new h(this.ctx);this.ctxStack.push(this.ctx),this.ctx=P}},g.prototype.restore=function(F){F=typeof F!="boolean"||F;for(var R=this.pdf.internal.getCurrentPageInfo().pageNumber,M=0;M<this.pdf.internal.getNumberOfPages();M++)this.pdf.setPage(M+1),this.pdf.internal.out("Q");this.pdf.setPage(R),F&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},g.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var x=function(F){var R,M,P,re;if(F.isCanvasGradient===!0&&(F=F.getColor()),!F)return{r:0,g:0,b:0,a:0,style:F};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(F))R=0,M=0,P=0,re=0;else{var ge=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(F);if(ge!==null)R=parseInt(ge[1]),M=parseInt(ge[2]),P=parseInt(ge[3]),re=1;else if((ge=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(F))!==null)R=parseInt(ge[1]),M=parseInt(ge[2]),P=parseInt(ge[3]),re=parseFloat(ge[4]);else{if(re=1,typeof F=="string"&&F.charAt(0)!=="#"){var Ce=new yT(F);F=Ce.ok?Ce.toHex():"#000000"}F.length===4?(R=F.substring(1,2),R+=R,M=F.substring(2,3),M+=M,P=F.substring(3,4),P+=P):(R=F.substring(1,3),M=F.substring(3,5),P=F.substring(5,7)),R=parseInt(R,16),M=parseInt(M,16),P=parseInt(P,16)}}return{r:R,g:M,b:P,a:re,style:F}},m=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},w=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};g.prototype.fillText=function(F,R,M,P){if(isNaN(R)||isNaN(M)||typeof F!="string")throw cn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(P=isNaN(P)?void 0:P,!m.call(this)){var re=ve(this.ctx.transform.rotation),ge=this.ctx.transform.scaleX;Q.call(this,{text:F,x:R,y:M,scale:ge,angle:re,align:this.textAlign,maxWidth:P})}},g.prototype.strokeText=function(F,R,M,P){if(isNaN(R)||isNaN(M)||typeof F!="string")throw cn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!w.call(this)){P=isNaN(P)?void 0:P;var re=ve(this.ctx.transform.rotation),ge=this.ctx.transform.scaleX;Q.call(this,{text:F,x:R,y:M,scale:ge,renderingMode:"stroke",angle:re,align:this.textAlign,maxWidth:P})}},g.prototype.measureText=function(F){if(typeof F!="string")throw cn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var R=this.pdf,M=this.pdf.internal.scaleFactor,P=R.internal.getFontSize(),re=R.getStringUnitWidth(F)*P/R.internal.scaleFactor;return new function(ge){var Ce=(ge=ge||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Ce}}),this}({width:re*=Math.round(96*M/72*1e4)/1e4})},g.prototype.scale=function(F,R){if(isNaN(F)||isNaN(R))throw cn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var M=new u(F,0,0,R,0,0);this.ctx.transform=this.ctx.transform.multiply(M)},g.prototype.rotate=function(F){if(isNaN(F))throw cn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var R=new u(Math.cos(F),Math.sin(F),-Math.sin(F),Math.cos(F),0,0);this.ctx.transform=this.ctx.transform.multiply(R)},g.prototype.translate=function(F,R){if(isNaN(F)||isNaN(R))throw cn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var M=new u(1,0,0,1,F,R);this.ctx.transform=this.ctx.transform.multiply(M)},g.prototype.transform=function(F,R,M,P,re,ge){if(isNaN(F)||isNaN(R)||isNaN(M)||isNaN(P)||isNaN(re)||isNaN(ge))throw cn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var Ce=new u(F,R,M,P,re,ge);this.ctx.transform=this.ctx.transform.multiply(Ce)},g.prototype.setTransform=function(F,R,M,P,re,ge){F=isNaN(F)?1:F,R=isNaN(R)?0:R,M=isNaN(M)?0:M,P=isNaN(P)?1:P,re=isNaN(re)?0:re,ge=isNaN(ge)?0:ge,this.ctx.transform=new u(F,R,M,P,re,ge)};var v=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};g.prototype.drawImage=function(F,R,M,P,re,ge,Ce,de,be){var Le=this.pdf.getImageProperties(F),ie=1,_e=1,je=1,J=1;P!==void 0&&de!==void 0&&(je=de/P,J=be/re,ie=Le.width/P*de/P,_e=Le.height/re*be/re),ge===void 0&&(ge=R,Ce=M,R=0,M=0),P!==void 0&&de===void 0&&(de=P,be=re),P===void 0&&de===void 0&&(de=Le.width,be=Le.height);var ze=this.ctx.transform.decompose(),He=ve(ze.rotate.shx),ct=new u,Xe=(ct=(ct=(ct=ct.multiply(ze.translate)).multiply(ze.skew)).multiply(ze.scale)).applyToRectangle(new A(ge-R*je,Ce-M*J,P*ie,re*_e));if(this.autoPaging){for(var Ut,yt=B.call(this,Xe),qt=[],Lt=0;Lt<yt.length;Lt+=1)qt.indexOf(yt[Lt])===-1&&qt.push(yt[Lt]);S(qt);for(var jt=qt[0],Pt=qt[qt.length-1],zt=jt;zt<Pt+1;zt++){this.pdf.setPage(zt);var Jt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],It=zt===1?this.posY+this.margin[0]:this.margin[0],xt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ht=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Bt=zt===1?0:xt+(zt-2)*ht;if(this.ctx.clip_path.length!==0){var pr=this.path;Ut=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=N(Ut,this.posX+this.margin[3],-Bt+It+this.ctx.prevPageLastElemOffset),T.call(this,"fill",!0),this.path=pr}var $t=JSON.parse(JSON.stringify(Xe));$t=N([$t],this.posX+this.margin[3],-Bt+It+this.ctx.prevPageLastElemOffset)[0];var Ee=(zt>jt||zt<Pt)&&v.call(this);Ee&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Jt,ht,null).clip().discardPath()),this.pdf.addImage(F,"JPEG",$t.x,$t.y,$t.w,$t.h,null,null,He),Ee&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(F,"JPEG",Xe.x,Xe.y,Xe.w,Xe.h,null,null,He)};var B=function(F,R,M){var P=[];R=R||this.pdf.internal.pageSize.width,M=M||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var re=this.posY+this.ctx.prevPageLastElemOffset;switch(F.type){default:case"mt":case"lt":P.push(Math.floor((F.y+re)/M)+1);break;case"arc":P.push(Math.floor((F.y+re-F.radius)/M)+1),P.push(Math.floor((F.y+re+F.radius)/M)+1);break;case"qct":var ge=G(this.ctx.lastPoint.x,this.ctx.lastPoint.y,F.x1,F.y1,F.x,F.y);P.push(Math.floor((ge.y+re)/M)+1),P.push(Math.floor((ge.y+ge.h+re)/M)+1);break;case"bct":var Ce=Se(this.ctx.lastPoint.x,this.ctx.lastPoint.y,F.x1,F.y1,F.x2,F.y2,F.x,F.y);P.push(Math.floor((Ce.y+re)/M)+1),P.push(Math.floor((Ce.y+Ce.h+re)/M)+1);break;case"rect":P.push(Math.floor((F.y+re)/M)+1),P.push(Math.floor((F.y+F.h+re)/M)+1)}for(var de=0;de<P.length;de+=1)for(;this.pdf.internal.getNumberOfPages()<P[de];)k.call(this);return P},k=function(){var F=this.fillStyle,R=this.strokeStyle,M=this.font,P=this.lineCap,re=this.lineWidth,ge=this.lineJoin;this.pdf.addPage(),this.fillStyle=F,this.strokeStyle=R,this.font=M,this.lineCap=P,this.lineWidth=re,this.lineJoin=ge},N=function(F,R,M){for(var P=0;P<F.length;P++)switch(F[P].type){case"bct":F[P].x2+=R,F[P].y2+=M;case"qct":F[P].x1+=R,F[P].y1+=M;default:F[P].x+=R,F[P].y+=M}return F},S=function(F){return F.sort(function(R,M){return R-M})},O=function(F,R){var M=this.fillStyle,P=this.strokeStyle,re=this.lineCap,ge=this.lineWidth,Ce=Math.abs(ge*this.ctx.transform.scaleX),de=this.lineJoin;if(this.autoPaging){for(var be,Le,ie=JSON.parse(JSON.stringify(this.path)),_e=JSON.parse(JSON.stringify(this.path)),je=[],J=0;J<_e.length;J++)if(_e[J].x!==void 0)for(var ze=B.call(this,_e[J]),He=0;He<ze.length;He+=1)je.indexOf(ze[He])===-1&&je.push(ze[He]);for(var ct=0;ct<je.length;ct++)for(;this.pdf.internal.getNumberOfPages()<je[ct];)k.call(this);S(je);for(var Xe=je[0],Ut=je[je.length-1],yt=Xe;yt<Ut+1;yt++){this.pdf.setPage(yt),this.fillStyle=M,this.strokeStyle=P,this.lineCap=re,this.lineWidth=Ce,this.lineJoin=de;var qt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Lt=yt===1?this.posY+this.margin[0]:this.margin[0],jt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Pt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],zt=yt===1?0:jt+(yt-2)*Pt;if(this.ctx.clip_path.length!==0){var Jt=this.path;be=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=N(be,this.posX+this.margin[3],-zt+Lt+this.ctx.prevPageLastElemOffset),T.call(this,F,!0),this.path=Jt}if(Le=JSON.parse(JSON.stringify(ie)),this.path=N(Le,this.posX+this.margin[3],-zt+Lt+this.ctx.prevPageLastElemOffset),R===!1||yt===0){var It=(yt>Xe||yt<Ut)&&v.call(this);It&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],qt,Pt,null).clip().discardPath()),T.call(this,F,R),It&&this.pdf.restoreGraphicsState()}this.lineWidth=ge}this.path=ie}else this.lineWidth=Ce,T.call(this,F,R),this.lineWidth=ge},T=function(F,R){if((F!=="stroke"||R||!w.call(this))&&(F==="stroke"||R||!m.call(this))){for(var M,P,re=[],ge=this.path,Ce=0;Ce<ge.length;Ce++){var de=ge[Ce];switch(de.type){case"begin":re.push({begin:!0});break;case"close":re.push({close:!0});break;case"mt":re.push({start:de,deltas:[],abs:[]});break;case"lt":var be=re.length;if(ge[Ce-1]&&!isNaN(ge[Ce-1].x)&&(M=[de.x-ge[Ce-1].x,de.y-ge[Ce-1].y],be>0)){for(;be>=0;be--)if(re[be-1].close!==!0&&re[be-1].begin!==!0){re[be-1].deltas.push(M),re[be-1].abs.push(de);break}}break;case"bct":M=[de.x1-ge[Ce-1].x,de.y1-ge[Ce-1].y,de.x2-ge[Ce-1].x,de.y2-ge[Ce-1].y,de.x-ge[Ce-1].x,de.y-ge[Ce-1].y],re[re.length-1].deltas.push(M);break;case"qct":var Le=ge[Ce-1].x+2/3*(de.x1-ge[Ce-1].x),ie=ge[Ce-1].y+2/3*(de.y1-ge[Ce-1].y),_e=de.x+2/3*(de.x1-de.x),je=de.y+2/3*(de.y1-de.y),J=de.x,ze=de.y;M=[Le-ge[Ce-1].x,ie-ge[Ce-1].y,_e-ge[Ce-1].x,je-ge[Ce-1].y,J-ge[Ce-1].x,ze-ge[Ce-1].y],re[re.length-1].deltas.push(M);break;case"arc":re.push({deltas:[],abs:[],arc:!0}),Array.isArray(re[re.length-1].abs)&&re[re.length-1].abs.push(de)}}P=R?null:F==="stroke"?"stroke":"fill";for(var He=!1,ct=0;ct<re.length;ct++)if(re[ct].arc)for(var Xe=re[ct].abs,Ut=0;Ut<Xe.length;Ut++){var yt=Xe[Ut];yt.type==="arc"?H.call(this,yt.x,yt.y,yt.radius,yt.startAngle,yt.endAngle,yt.counterclockwise,void 0,R,!He):Y.call(this,yt.x,yt.y),He=!0}else if(re[ct].close===!0)this.pdf.internal.out("h"),He=!1;else if(re[ct].begin!==!0){var qt=re[ct].start.x,Lt=re[ct].start.y;z.call(this,re[ct].deltas,qt,Lt),He=!0}P&&j.call(this,P),R&&W.call(this)}},U=function(F){var R=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,M=R*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return F-M;case"top":return F+R-M;case"hanging":return F+R-2*M;case"middle":return F+R/2-M;default:return F}},D=function(F){return F+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};g.prototype.createLinearGradient=function(){var F=function(){};return F.colorStops=[],F.addColorStop=function(R,M){this.colorStops.push([R,M])},F.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},F.isCanvasGradient=!0,F},g.prototype.createPattern=function(){return this.createLinearGradient()},g.prototype.createRadialGradient=function(){return this.createLinearGradient()};var H=function(F,R,M,P,re,ge,Ce,de,be){for(var Le=Z.call(this,M,P,re,ge),ie=0;ie<Le.length;ie++){var _e=Le[ie];ie===0&&(be?I.call(this,_e.x1+F,_e.y1+R):Y.call(this,_e.x1+F,_e.y1+R)),ue.call(this,F,R,_e.x2,_e.y2,_e.x3,_e.y3,_e.x4,_e.y4)}de?W.call(this):j.call(this,Ce)},j=function(F){switch(F){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},W=function(){this.pdf.clip(),this.pdf.discardPath()},I=function(F,R){this.pdf.internal.out(r(F)+" "+a(R)+" m")},Q=function(F){var R;switch(F.align){case"right":case"end":R="right";break;case"center":R="center";break;default:R="left"}var M,P,re,ge=this.pdf.getTextDimensions(F.text),Ce=U.call(this,F.y),de=D.call(this,Ce)-ge.h,be=this.ctx.transform.applyToPoint(new l(F.x,Ce));if(this.autoPaging){var Le=this.ctx.transform.decompose(),ie=new u;ie=(ie=(ie=ie.multiply(Le.translate)).multiply(Le.skew)).multiply(Le.scale);for(var _e=this.ctx.transform.applyToRectangle(new A(F.x,Ce,ge.w,ge.h)),je=ie.applyToRectangle(new A(F.x,de,ge.w,ge.h)),J=B.call(this,je),ze=[],He=0;He<J.length;He+=1)ze.indexOf(J[He])===-1&&ze.push(J[He]);S(ze);for(var ct=ze[0],Xe=ze[ze.length-1],Ut=ct;Ut<Xe+1;Ut++){this.pdf.setPage(Ut);var yt=Ut===1?this.posY+this.margin[0]:this.margin[0],qt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Lt=this.pdf.internal.pageSize.height-this.margin[2],jt=Lt-this.margin[0],Pt=this.pdf.internal.pageSize.width-this.margin[1],zt=Pt-this.margin[3],Jt=Ut===1?0:qt+(Ut-2)*jt;if(this.ctx.clip_path.length!==0){var It=this.path;M=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=N(M,this.posX+this.margin[3],-1*Jt+yt),T.call(this,"fill",!0),this.path=It}var xt=N([JSON.parse(JSON.stringify(je))],this.posX+this.margin[3],-Jt+yt+this.ctx.prevPageLastElemOffset)[0];F.scale>=.01&&(P=this.pdf.internal.getFontSize(),this.pdf.setFontSize(P*F.scale),re=this.lineWidth,this.lineWidth=re*F.scale);var ht=this.autoPaging!=="text";if(ht||xt.y+xt.h<=Lt){if(ht||xt.y>=yt&&xt.x<=Pt){var Bt=ht?F.text:this.pdf.splitTextToSize(F.text,F.maxWidth||Pt-xt.x)[0],pr=N([JSON.parse(JSON.stringify(_e))],this.posX+this.margin[3],-Jt+yt+this.ctx.prevPageLastElemOffset)[0],$t=ht&&(Ut>ct||Ut<Xe)&&v.call(this);$t&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],zt,jt,null).clip().discardPath()),this.pdf.text(Bt,pr.x,pr.y,{angle:F.angle,align:R,renderingMode:F.renderingMode}),$t&&this.pdf.restoreGraphicsState()}}else xt.y<Lt&&(this.ctx.prevPageLastElemOffset+=Lt-xt.y);F.scale>=.01&&(this.pdf.setFontSize(P),this.lineWidth=re)}}else F.scale>=.01&&(P=this.pdf.internal.getFontSize(),this.pdf.setFontSize(P*F.scale),re=this.lineWidth,this.lineWidth=re*F.scale),this.pdf.text(F.text,be.x+this.posX,be.y+this.posY,{angle:F.angle,align:R,renderingMode:F.renderingMode,maxWidth:F.maxWidth}),F.scale>=.01&&(this.pdf.setFontSize(P),this.lineWidth=re)},Y=function(F,R,M,P){M=M||0,P=P||0,this.pdf.internal.out(r(F+M)+" "+a(R+P)+" l")},z=function(F,R,M){return this.pdf.lines(F,R,M,null,null)},ue=function(F,R,M,P,re,ge,Ce,de){this.pdf.internal.out([t(n(M+F)),t(s(P+R)),t(n(re+F)),t(s(ge+R)),t(n(Ce+F)),t(s(de+R)),"c"].join(" "))},Z=function(F,R,M,P){for(var re=2*Math.PI,ge=Math.PI/2;R>M;)R-=re;var Ce=Math.abs(M-R);Ce<re&&P&&(Ce=re-Ce);for(var de=[],be=P?-1:1,Le=R;Ce>1e-5;){var ie=Le+be*Math.min(Ce,ge);de.push(Ae.call(this,F,Le,ie)),Ce-=Math.abs(ie-Le),Le=ie}return de},Ae=function(F,R,M){var P=(M-R)/2,re=F*Math.cos(P),ge=F*Math.sin(P),Ce=re,de=-ge,be=Ce*Ce+de*de,Le=be+Ce*re+de*ge,ie=4/3*(Math.sqrt(2*be*Le)-Le)/(Ce*ge-de*re),_e=Ce-ie*de,je=de+ie*Ce,J=_e,ze=-je,He=P+R,ct=Math.cos(He),Xe=Math.sin(He);return{x1:F*Math.cos(R),y1:F*Math.sin(R),x2:_e*ct-je*Xe,y2:_e*Xe+je*ct,x3:J*ct-ze*Xe,y3:J*Xe+ze*ct,x4:F*Math.cos(M),y4:F*Math.sin(M)}},ve=function(F){return 180*F/Math.PI},G=function(F,R,M,P,re,ge){var Ce=F+.5*(M-F),de=R+.5*(P-R),be=re+.5*(M-re),Le=ge+.5*(P-ge),ie=Math.min(F,re,Ce,be),_e=Math.max(F,re,Ce,be),je=Math.min(R,ge,de,Le),J=Math.max(R,ge,de,Le);return new A(ie,je,_e-ie,J-je)},Se=function(F,R,M,P,re,ge,Ce,de){var be,Le,ie,_e,je,J,ze,He,ct,Xe,Ut,yt,qt,Lt,jt=M-F,Pt=P-R,zt=re-M,Jt=ge-P,It=Ce-re,xt=de-ge;for(Le=0;Le<41;Le++)ct=(ze=(ie=F+(be=Le/40)*jt)+be*((je=M+be*zt)-ie))+be*(je+be*(re+be*It-je)-ze),Xe=(He=(_e=R+be*Pt)+be*((J=P+be*Jt)-_e))+be*(J+be*(ge+be*xt-J)-He),Le==0?(Ut=ct,yt=Xe,qt=ct,Lt=Xe):(Ut=Math.min(Ut,ct),yt=Math.min(yt,Xe),qt=Math.max(qt,ct),Lt=Math.max(Lt,Xe));return new A(Math.round(Ut),Math.round(yt),Math.round(qt-Ut),Math.round(Lt-yt))},we=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var F,R,M=(F=this.ctx.lineDash,R=this.ctx.lineDashOffset,JSON.stringify({lineDash:F,lineDashOffset:R}));this.prevLineDash!==M&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=M)}}})(gr.API),(function(e){var t=function(l){var A,u,f,h,g,x,m,w,v,B;for(u=[],f=0,h=(l+=A="\0\0\0\0".slice(l.length%4||4)).length;h>f;f+=4)(g=(l.charCodeAt(f)<<24)+(l.charCodeAt(f+1)<<16)+(l.charCodeAt(f+2)<<8)+l.charCodeAt(f+3))!==0?(x=(g=((g=((g=((g=(g-(B=g%85))/85)-(v=g%85))/85)-(w=g%85))/85)-(m=g%85))/85)%85,u.push(x+33,m+33,w+33,v+33,B+33)):u.push(122);return(function(k,N){for(var S=N;S>0;S--)k.pop()})(u,A.length),String.fromCharCode.apply(String,u)+"~>"},r=function(l){var A,u,f,h,g,x=String,m="length",w=255,v="charCodeAt",B="slice",k="replace";for(l[B](-2),l=l[B](0,-2)[k](/\s/g,"")[k]("z","!!!!!"),f=[],h=0,g=(l+=A="uuuuu"[B](l[m]%5||5))[m];g>h;h+=5)u=52200625*(l[v](h)-33)+614125*(l[v](h+1)-33)+7225*(l[v](h+2)-33)+85*(l[v](h+3)-33)+(l[v](h+4)-33),f.push(w&u>>24,w&u>>16,w&u>>8,w&u);return(function(N,S){for(var O=S;O>0;O--)N.pop()})(f,A[m]),x.fromCharCode.apply(x,f)},a=function(l){return l.split("").map(function(A){return("0"+A.charCodeAt().toString(16)).slice(-2)}).join("")+">"},n=function(l){var A=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((l=l.replace(/\s/g,"")).indexOf(">")!==-1&&(l=l.substr(0,l.indexOf(">"))),l.length%2&&(l+="0"),A.test(l)===!1)return"";for(var u="",f=0;f<l.length;f+=2)u+=String.fromCharCode("0x"+(l[f]+l[f+1]));return u},s=function(l){for(var A=new Uint8Array(l.length),u=l.length;u--;)A[u]=l.charCodeAt(u);return(A=$w(A)).reduce(function(f,h){return f+String.fromCharCode(h)},"")};e.processDataByFilters=function(l,A){var u=0,f=l||"",h=[];for(typeof(A=A||[])=="string"&&(A=[A]),u=0;u<A.length;u+=1)switch(A[u]){case"ASCII85Decode":case"/ASCII85Decode":f=r(f),h.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":f=t(f),h.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":f=n(f),h.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":f=a(f),h.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":f=s(f),h.push("/FlateDecode");break;default:throw new Error('The filter: "'+A[u]+'" is not implemented')}return{data:f,reverseChain:h.reverse().join(" ")}}})(gr.API),(function(e){e.loadFile=function(t,r,a){return(function(n,s,l){s=s!==!1,l=typeof l=="function"?l:function(){};var A=void 0;try{A=(function(u,f,h){var g=new XMLHttpRequest,x=0,m=function(w){var v=w.length,B=[],k=String.fromCharCode;for(x=0;x<v;x+=1)B.push(k(255&w.charCodeAt(x)));return B.join("")};if(g.open("GET",u,!f),g.overrideMimeType("text/plain; charset=x-user-defined"),f===!1&&(g.onload=function(){g.status===200?h(m(this.responseText)):h(void 0)}),g.send(null),f&&g.status===200)return m(g.responseText)})(n,s,l)}catch{}return A})(t,r,a)},e.allowFsRead=void 0,e.loadImageFile=e.loadFile})(gr.API),(function(e){function t(){return(Rr.html2canvas?Promise.resolve(Rr.html2canvas):iA(()=>Promise.resolve().then(()=>dJ),void 0)).catch(function(A){return Promise.reject(new Error("Could not load html2canvas: "+A))}).then(function(A){return A.default?A.default:A})}function r(){return(Rr.DOMPurify?Promise.resolve(Rr.DOMPurify):iA(()=>import("./purify.es-Bzr520pe.js"),[])).catch(function(A){return Promise.reject(new Error("Could not load dompurify: "+A))}).then(function(A){return A.default?A.default:A})}var a=function(A){var u=za(A);return u==="undefined"?"undefined":u==="string"||A instanceof String?"string":u==="number"||A instanceof Number?"number":u==="function"||A instanceof Function?"function":A&&A.constructor===Array?"array":A&&A.nodeType===1?"element":u==="object"?"object":"unknown"},n=function(A,u){var f=document.createElement(A);for(var h in u.className&&(f.className=u.className),u.innerHTML&&u.dompurify&&(f.innerHTML=u.dompurify.sanitize(u.innerHTML)),u.style)f.style[h]=u.style[h];return f},s=function A(u,f){for(var h=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),g=u.firstChild;g;g=g.nextSibling)f!==!0&&g.nodeType===1&&g.nodeName==="SCRIPT"||h.appendChild(A(g,f));return u.nodeType===1&&(u.nodeName==="CANVAS"?(h.width=u.width,h.height=u.height,h.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(h.value=u.value),h.addEventListener("load",function(){h.scrollTop=u.scrollTop,h.scrollLeft=u.scrollLeft},!0)),h},l=function A(u){var f=Object.assign(A.convert(Promise.resolve()),JSON.parse(JSON.stringify(A.template))),h=A.convert(Promise.resolve(),f);return(h=h.setProgress(1,A,1,[A])).set(u)};(l.prototype=Object.create(Promise.prototype)).constructor=l,l.convert=function(A,u){return A.__proto__=u||l.prototype,A},l.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},l.prototype.from=function(A,u){return this.then(function(){switch(u=u||(function(f){switch(a(f)){case"string":return"string";case"element":return f.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(A),u){case"string":return this.then(r).then(function(f){return this.set({src:n("div",{innerHTML:A,dompurify:f})})});case"element":return this.set({src:A});case"canvas":return this.set({canvas:A});case"img":return this.set({img:A});default:return this.error("Unknown source type.")}})},l.prototype.to=function(A){switch(A){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},l.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var A={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},u=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);u.tagName==="BODY"&&(A.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=n("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=n("div",{className:"html2pdf__container",style:A}),this.prop.container.appendChild(u),this.prop.container.firstChild.appendChild(n("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},l.prototype.toCanvas=function(){var A=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(A).then(t).then(function(u){var f=Object.assign({},this.opt.html2canvas);return delete f.onrendered,u(this.prop.container,f)}).then(function(u){(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},l.prototype.toContext2d=function(){var A=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(A).then(t).then(function(u){var f=this.opt.jsPDF,h=this.opt.fontFaces,g=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,x=Object.assign({async:!0,allowTaint:!0,scale:g,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete x.onrendered,f.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,f.context2d.posX=this.opt.x,f.context2d.posY=this.opt.y,f.context2d.margin=this.opt.margin,f.context2d.fontFaces=h,h)for(var m=0;m<h.length;++m){var w=h[m],v=w.src.find(function(B){return B.format==="truetype"});v&&f.addFont(v.url,w.ref.name,w.ref.style)}return x.windowHeight=x.windowHeight||0,x.windowHeight=x.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):x.windowHeight,f.context2d.save(!0),u(this.prop.container,x)}).then(function(u){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},l.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var A=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=A})},l.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},l.prototype.output=function(A,u,f){return(f=f||"pdf").toLowerCase()==="img"||f.toLowerCase()==="image"?this.outputImg(A,u):this.outputPdf(A,u)},l.prototype.outputPdf=function(A,u){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(A,u)})},l.prototype.outputImg=function(A){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(A){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+A+'" is not supported.'}})},l.prototype.save=function(A){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(A?{filename:A}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},l.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},l.prototype.set=function(A){if(a(A)!=="object")return this;var u=Object.keys(A||{}).map(function(f){if(f in l.template.prop)return function(){this.prop[f]=A[f]};switch(f){case"margin":return this.setMargin.bind(this,A.margin);case"jsPDF":return function(){return this.opt.jsPDF=A.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,A.pageSize);default:return function(){this.opt[f]=A[f]}}},this);return this.then(function(){return this.thenList(u)})},l.prototype.get=function(A,u){return this.then(function(){var f=A in l.template.prop?this.prop[A]:this.opt[A];return u?u(f):f})},l.prototype.setMargin=function(A){return this.then(function(){switch(a(A)){case"number":A=[A,A,A,A];case"array":if(A.length===2&&(A=[A[0],A[1],A[0],A[1]]),A.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=A}).then(this.setPageSize)},l.prototype.setPageSize=function(A){function u(f,h){return Math.floor(f*h/72*96)}return this.then(function(){(A=A||gr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(A.inner={width:A.width-this.opt.margin[1]-this.opt.margin[3],height:A.height-this.opt.margin[0]-this.opt.margin[2]},A.inner.px={width:u(A.inner.width,A.k),height:u(A.inner.height,A.k)},A.inner.ratio=A.inner.height/A.inner.width),this.prop.pageSize=A})},l.prototype.setProgress=function(A,u,f,h){return A!=null&&(this.progress.val=A),u!=null&&(this.progress.state=u),f!=null&&(this.progress.n=f),h!=null&&(this.progress.stack=h),this.progress.ratio=this.progress.val/this.progress.state,this},l.prototype.updateProgress=function(A,u,f,h){return this.setProgress(A?this.progress.val+A:null,u||null,f?this.progress.n+f:null,h?this.progress.stack.concat(h):null)},l.prototype.then=function(A,u){var f=this;return this.thenCore(A,u,function(h,g){return f.updateProgress(null,null,1,[h]),Promise.prototype.then.call(this,function(x){return f.updateProgress(null,h),x}).then(h,g).then(function(x){return f.updateProgress(1),x})})},l.prototype.thenCore=function(A,u,f){f=f||Promise.prototype.then;var h=this;A&&(A=A.bind(h)),u&&(u=u.bind(h));var g=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?h:l.convert(Object.assign({},h),Promise.prototype),x=f.call(g,A,u);return l.convert(x,h.__proto__)},l.prototype.thenExternal=function(A,u){return Promise.prototype.then.call(this,A,u)},l.prototype.thenList=function(A){var u=this;return A.forEach(function(f){u=u.thenCore(f)}),u},l.prototype.catch=function(A){A&&(A=A.bind(this));var u=Promise.prototype.catch.call(this,A);return l.convert(u,this)},l.prototype.catchExternal=function(A){return Promise.prototype.catch.call(this,A)},l.prototype.error=function(A){return this.then(function(){throw new Error(A)})},l.prototype.using=l.prototype.set,l.prototype.saveAs=l.prototype.save,l.prototype.export=l.prototype.output,l.prototype.run=l.prototype.then,gr.getPageSize=function(A,u,f){if(za(A)==="object"){var h=A;A=h.orientation,u=h.unit||u,f=h.format||f}u=u||"mm",f=f||"a4",A=(""+(A||"P")).toLowerCase();var g,x=(""+f).toLowerCase(),m={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(u){case"pt":g=1;break;case"mm":g=72/25.4;break;case"cm":g=72/2.54;break;case"in":g=72;break;case"px":g=.75;break;case"pc":case"em":g=12;break;case"ex":g=6;break;default:throw"Invalid unit: "+u}var w,v=0,B=0;if(m.hasOwnProperty(x))v=m[x][1]/g,B=m[x][0]/g;else try{v=f[1],B=f[0]}catch{throw new Error("Invalid format: "+f)}if(A==="p"||A==="portrait")A="p",B>v&&(w=B,B=v,v=w);else{if(A!=="l"&&A!=="landscape")throw"Invalid orientation: "+A;A="l",v>B&&(w=B,B=v,v=w)}return{width:B,height:v,unit:u,k:g,orientation:A}},e.html=function(A,u){(u=u||{}).callback=u.callback||function(){},u.html2canvas=u.html2canvas||{},u.html2canvas.canvas=u.html2canvas.canvas||this.canvas,u.jsPDF=u.jsPDF||this,u.fontFaces=u.fontFaces?u.fontFaces.map(Pv):null;var f=new l(u);return u.worker?f:f.from(A).doCallback()}})(gr.API),gr.API.addJS=function(e){var t,r,a=e;return this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(t+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),r=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+a+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){t!==void 0&&r!==void 0&&this.internal.out("/Names <</JavaScript "+t+" 0 R>>")}),this},(function(e){var t;e.events.push(["postPutResources",function(){var r=this,a=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var n=r.outline.render().split(/\r\n/),s=0;s<n.length;s++){var l=n[s],A=a.exec(l);if(A!=null){var u=A[1];r.internal.newObjectDeferredBegin(u,!1)}r.internal.write(l)}if(this.outline.createNamedDestinations){var f=this.internal.pages.length,h=[];for(s=0;s<f;s++){var g=r.internal.newObject();h.push(g);var x=r.internal.getPageInfo(s+1);r.internal.write("<< /D["+x.objId+" 0 R /XYZ null null null]>> endobj")}var m=r.internal.newObject();for(r.internal.write("<< /Names [ "),s=0;s<h.length;s++)r.internal.write("(page_"+(s+1)+")"+h[s]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+m+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(a,n,s){var l={title:n,options:s,children:[]};return a==null&&(a=this.root),a.children.push(l),l},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(a){a.id=r.internal.newObjectDeferred();for(var n=0;n<a.children.length;n++)this.genIds_r(a.children[n])},r.outline.renderRoot=function(a){this.objStart(a),this.line("/Type /Outlines"),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1]))),this.line("/Count "+this.count_r({count:0},a)),this.objEnd()},r.outline.renderItems=function(a){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<a.children.length;s++){var l=a.children[s];this.objStart(l),this.line("/Title "+this.makeString(l.title)),this.line("/Parent "+this.makeRef(a)),s>0&&this.line("/Prev "+this.makeRef(a.children[s-1])),s<a.children.length-1&&this.line("/Next "+this.makeRef(a.children[s+1])),l.children.length>0&&(this.line("/First "+this.makeRef(l.children[0])),this.line("/Last "+this.makeRef(l.children[l.children.length-1])));var A=this.count=this.count_r({count:0},l);if(A>0&&this.line("/Count "+A),l.options&&l.options.pageNumber){var u=r.internal.getPageInfo(l.options.pageNumber);this.line("/Dest ["+u.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var f=0;f<a.children.length;f++)this.renderItems(a.children[f])},r.outline.line=function(a){this.ctx.val+=a+`\r
`},r.outline.makeRef=function(a){return a.id+" 0 R"},r.outline.makeString=function(a){return"("+r.internal.pdfEscape(a)+")"},r.outline.objStart=function(a){this.ctx.val+=`\r
`+a.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(a,n){for(var s=0;s<n.children.length;s++)a.count++,this.count_r(a,n.children[s]);return a.count}}])})(gr.API),(function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,a,n,s,l,A){var u,f=this.decode.DCT_DECODE,h=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=l||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,u=(function(g){for(var x,m=256*g.charCodeAt(4)+g.charCodeAt(5),w=g.length,v={width:0,height:0,numcomponents:1},B=4;B<w;B+=2){if(B+=m,t.indexOf(g.charCodeAt(B+1))!==-1){x=256*g.charCodeAt(B+5)+g.charCodeAt(B+6),v={width:256*g.charCodeAt(B+7)+g.charCodeAt(B+8),height:x,numcomponents:g.charCodeAt(B+9)};break}m=256*g.charCodeAt(B+2)+g.charCodeAt(B+3)}return v})(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),u.numcomponents){case 1:A=this.color_spaces.DEVICE_GRAY;break;case 4:A=this.color_spaces.DEVICE_CMYK;break;case 3:A=this.color_spaces.DEVICE_RGB}h={data:r,width:u.width,height:u.height,colorSpace:A,bitsPerComponent:8,filter:f,index:a,alias:n}}return h}})(gr.API),gr.API.processPNG=function(e,t,r,a){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var n,s=xee(e,{checkCrc:!0}),l=s.width,A=s.height,u=s.channels,f=s.palette,h=s.depth;n=f&&u===1?(function(H){for(var j=H.width,W=H.height,I=H.data,Q=H.palette,Y=H.depth,z=!1,ue=[],Z=[],Ae=void 0,ve=!1,G=0,Se=0;Se<Q.length;Se++){var we=eC(Q[Se],4),F=we[0],R=we[1],M=we[2],P=we[3];ue.push(F,R,M),P!=null&&(P===0?(G++,Z.length<1&&Z.push(Se)):P<255&&(ve=!0))}if(ve||G>1){z=!0,Z=void 0;var re=j*W;Ae=new Uint8Array(re);for(var ge=new DataView(I.buffer),Ce=0;Ce<re;Ce++){var de=qv(ge,Ce,Y),be=eC(Q[de],4)[3];Ae[Ce]=be}}else G===0&&(Z=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:z?8:void 0,colorBytes:I,alphaBytes:Ae,needSMask:z,palette:ue,mask:Z}})(s):u===2||u===4?(function(H){for(var j=H.data,W=H.width,I=H.height,Q=H.channels,Y=H.depth,z=Q===2?"DeviceGray":"DeviceRGB",ue=Q-1,Z=W*I,Ae=ue,ve=Z*Ae,G=1*Z,Se=Math.ceil(ve*Y/8),we=Math.ceil(G*Y/8),F=new Uint8Array(Se),R=new Uint8Array(we),M=new DataView(j.buffer),P=new DataView(F.buffer),re=new DataView(R.buffer),ge=!1,Ce=0;Ce<Z;Ce++){for(var de=Ce*Q,be=0;be<Ae;be++)aS(P,qv(M,de+be,Y),Ce*Ae+be,Y);var Le=qv(M,de+Ae,Y);Le<(1<<Y)-1&&(ge=!0),aS(re,Le,1*Ce,Y)}return{colorSpace:z,colorsPerPixel:ue,sMaskBitsPerComponent:ge?Y:void 0,colorBytes:F,alphaBytes:R,needSMask:ge}})(s):(function(H){var j=H.data,W=H.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:W,colorsPerPixel:W==="DeviceGray"?1:3,colorBytes:j instanceof Uint16Array?(function(I){for(var Q=I.length,Y=new Uint8Array(2*Q),z=new DataView(Y.buffer,Y.byteOffset,Y.byteLength),ue=0;ue<Q;ue++)z.setUint16(2*ue,I[ue],!1);return Y})(j):j,needSMask:!1}})(s);var g,x,m,w=n,v=w.colorSpace,B=w.colorsPerPixel,k=w.sMaskBitsPerComponent,N=w.colorBytes,S=w.alphaBytes,O=w.needSMask,T=w.palette,U=w.mask,D=null;return a!==gr.API.image_compression.NONE&&typeof $w=="function"?(D=(function(H){var j;switch(H){case gr.API.image_compression.FAST:j=11;break;case gr.API.image_compression.MEDIUM:j=13;break;case gr.API.image_compression.SLOW:j=14;break;default:j=12}return j})(a),g=this.decode.FLATE_DECODE,x="/Predictor ".concat(D," /Colors ").concat(B," /BitsPerComponent ").concat(h," /Columns ").concat(l),e=JC(N,Math.ceil(l*B*h/8),B,h,a),O&&(m=JC(S,Math.ceil(l*k/8),1,k,a))):(g=void 0,x=void 0,e=N,O&&(m=S)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(m&&this.__addimage__.isArrayBuffer(m)||this.__addimage__.isArrayBufferView(m))&&(m=this.__addimage__.arrayBufferToBinaryString(m)),{alias:r,data:e,index:t,filter:g,decodeParameters:x,transparency:U,palette:T,sMask:m,predictor:D,width:l,height:A,bitsPerComponent:h,sMaskBitsPerComponent:k,colorSpace:v}}},(function(e){e.processGIF89A=function(t,r,a,n){var s=new Ree(t),l=s.width,A=s.height,u=[];s.decodeAndBlitFrameRGBA(0,u);var f={data:u,width:l,height:A},h=new zv(100).encode(f,100);return e.processJPEG.call(this,h,r,a,n)},e.processGIF87A=e.processGIF89A})(gr.API),nA.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:n,green:a,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},nA.prototype.parseBGR=function(){this.pos=this.offset;var e="bit"+this.bitPP,t=this.width*this.height*4;if(t>536870912)throw new Error("Image dimensions exceed 512MB, which is too large.");this.data=new Uint8Array(t);try{this[e]()}catch(r){cn.log("bit decode error:"+r)}},nA.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var a=this.bottom_up?e:this.height-1-e,n=0;n<t;n++)for(var s=this.datav.getUint8(this.pos++,!0),l=a*this.width*4+8*n*4,A=0;A<8&&8*n+A<this.width;A++){var u=this.palette[s>>7-A&1];this.data[l+4*A]=u.blue,this.data[l+4*A+1]=u.green,this.data[l+4*A+2]=u.red,this.data[l+4*A+3]=255}r!==0&&(this.pos+=4-r)}},nA.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<e;n++){var s=this.datav.getUint8(this.pos++,!0),l=a*this.width*4+2*n*4,A=s>>4,u=15&s,f=this.palette[A];if(this.data[l]=f.blue,this.data[l+1]=f.green,this.data[l+2]=f.red,this.data[l+3]=255,2*n+1>=this.width)break;f=this.palette[u],this.data[l+4]=f.blue,this.data[l+4+1]=f.green,this.data[l+4+2]=f.red,this.data[l+4+3]=255}t!==0&&(this.pos+=4-t)}},nA.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,a=0;a<this.width;a++){var n=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*a;if(n<this.palette.length){var l=this.palette[n];this.data[s]=l.red,this.data[s+1]=l.green,this.data[s+2]=l.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}e!==0&&(this.pos+=4-e)}},nA.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<this.width;n++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(s&t)/t*255|0,A=(s>>5&t)/t*255|0,u=(s>>10&t)/t*255|0,f=s>>15?255:0,h=a*this.width*4+4*n;this.data[h]=u,this.data[h+1]=A,this.data[h+2]=l,this.data[h+3]=f}this.pos+=e}},nA.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),a=this.height-1;a>=0;a--){for(var n=this.bottom_up?a:this.height-1-a,s=0;s<this.width;s++){var l=this.datav.getUint16(this.pos,!0);this.pos+=2;var A=(l&t)/t*255|0,u=(l>>5&r)/r*255|0,f=(l>>11)/t*255|0,h=n*this.width*4+4*s;this.data[h]=f,this.data[h+1]=u,this.data[h+2]=A,this.data[h+3]=255}this.pos+=e}},nA.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*r;this.data[l]=s,this.data[l+1]=n,this.data[l+2]=a,this.data[l+3]=255}this.pos+=this.width%4}},nA.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),A=t*this.width*4+4*r;this.data[A]=s,this.data[A+1]=n,this.data[A+2]=a,this.data[A+3]=l}},nA.prototype.getData=function(){return this.data},(function(e){e.processBMP=function(t,r,a,n){var s=new nA(t,!1),l=s.width,A=s.height,u={data:s.getData(),width:l,height:A},f=new zv(100).encode(u,100);return e.processJPEG.call(this,f,r,a,n)}})(gr.API),sS.prototype.getData=function(){return this.data},(function(e){e.processWEBP=function(t,r,a,n){var s=new sS(t),l=s.width,A=s.height,u={data:s.getData(),width:l,height:A},f=new zv(100).encode(u,100);return e.processJPEG.call(this,f,r,a,n)}})(gr.API),gr.API.processRGBA=function(e,t,r){for(var a=e.data,n=a.length,s=new Uint8Array(n/4*3),l=new Uint8Array(n/4),A=0,u=0,f=0;f<n;f+=4){var h=a[f],g=a[f+1],x=a[f+2],m=a[f+3];s[A++]=h,s[A++]=g,s[A++]=x,l[u++]=m}var w=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(l),data:w,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},gr.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Vd=gr.API,jm=Vd.getCharWidthsArray=function(e,t){var r,a,n=(t=t||{}).font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),l=t.charSpace||this.internal.getCharSpace(),A=t.widths?t.widths:n.metadata.Unicode.widths,u=A.fof?A.fof:1,f=t.kerning?t.kerning:n.metadata.Unicode.kerning,h=f.fof?f.fof:1,g=t.doKerning!==!1,x=0,m=e.length,w=0,v=A[0]||u,B=[];for(r=0;r<m;r++)a=e.charCodeAt(r),typeof n.metadata.widthOfString=="function"?B.push((n.metadata.widthOfGlyph(n.metadata.characterToGlyph(a))+l*(1e3/s)||0)/1e3):(x=g&&za(f[a])==="object"&&!isNaN(parseInt(f[a][w],10))?f[a][w]/h:0,B.push((A[a]||v)/u+x)),w=a;return B},XC=Vd.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),a=t.font||this.internal.getFont(),n=t.charSpace||this.internal.getCharSpace();return Vd.processArabic&&(e=Vd.processArabic(e)),typeof a.metadata.widthOfString=="function"?a.metadata.widthOfString(e,r,n)/r:jm.apply(this,arguments).reduce(function(s,l){return s+l},0)},YC=function(e,t,r,a){for(var n=[],s=0,l=e.length,A=0;s!==l&&A+t[s]<r;)A+=t[s],s++;n.push(e.slice(0,s));var u=s;for(A=0;s!==l;)A+t[s]>a&&(n.push(e.slice(u,s)),A=0,u=s),A+=t[s],s++;return u!==s&&n.push(e.slice(u,s)),n},$C=function(e,t,r){r||(r={});var a,n,s,l,A,u,f,h=[],g=[h],x=r.textIndent||0,m=0,w=0,v=e.split(" "),B=jm.apply(this,[" ",r])[0];if(u=r.lineIndent===-1?v[0].length+2:r.lineIndent||0){var k=Array(u).join(" "),N=[];v.map(function(O){(O=O.split(/\s*\n/)).length>1?N=N.concat(O.map(function(T,U){return(U&&T.length?`
`:"")+T})):N.push(O[0])}),v=N,u=XC.apply(this,[k,r])}for(s=0,l=v.length;s<l;s++){var S=0;if(a=v[s],u&&a[0]==`
`&&(a=a.substr(1),S=1),x+m+(w=(n=jm.apply(this,[a,r])).reduce(function(O,T){return O+T},0))>t||S){if(w>t){for(A=YC.apply(this,[a,n,t-(x+m),t]),h.push(A.shift()),h=[A.pop()];A.length;)g.push([A.shift()]);w=n.slice(a.length-(h[0]?h[0].length:0)).reduce(function(O,T){return O+T},0)}else h=[a];g.push(h),x=w+u,m=B}else h.push(a),x+=m+w,m=B}return f=u?function(O,T){return(T?k:"")+O.join(" ")}:function(O){return O.join(" ")},g.map(f)},Vd.splitTextToSize=function(e,t,r){var a,n=(r=r||{}).fontSize||this.internal.getFontSize(),s=(function(h){if(h.widths&&h.kerning)return{widths:h.widths,kerning:h.kerning};var g=this.internal.getFont(h.fontName,h.fontStyle),x="Unicode";return g.metadata[x]?{widths:g.metadata[x].widths||{0:1},kerning:g.metadata[x].kerning||{}}:{font:g.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);a=Array.isArray(e)?e:String(e).split(/\r?\n/);var l=1*this.internal.scaleFactor*t/n;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/n:0,s.lineIndent=r.lineIndent;var A,u,f=[];for(A=0,u=a.length;A<u;A++)f=f.concat($C.apply(this,[a[A],l,s]));return f},(function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",a={},n={},s=0;s<16;s++)a[r[s]]=t[s],n[t[s]]=r[s];var l=function(x){return"0x"+parseInt(x,10).toString(16)},A=e.__fontmetrics__.compress=function(x){var m,w,v,B,k=["{"];for(var N in x){if(m=x[N],isNaN(parseInt(N,10))?w="'"+N+"'":(N=parseInt(N,10),w=(w=l(N).slice(2)).slice(0,-1)+n[w.slice(-1)]),typeof m=="number")m<0?(v=l(m).slice(3),B="-"):(v=l(m).slice(2),B=""),v=B+v.slice(0,-1)+n[v.slice(-1)];else{if(za(m)!=="object")throw new Error("Don't know what to do with value type "+za(m)+".");v=A(m)}k.push(w+v)}return k.push("}"),k.join("")},u=e.__fontmetrics__.uncompress=function(x){if(typeof x!="string")throw new Error("Invalid argument passed to uncompress.");for(var m,w,v,B,k={},N=1,S=k,O=[],T="",U="",D=x.length-1,H=1;H<D;H+=1)(B=x[H])=="'"?m?(v=m.join(""),m=void 0):m=[]:m?m.push(B):B=="{"?(O.push([S,v]),S={},v=void 0):B=="}"?((w=O.pop())[0][w[1]]=S,v=void 0,S=w[0]):B=="-"?N=-1:v===void 0?a.hasOwnProperty(B)?(T+=a[B],v=parseInt(T,16)*N,N=1,T=""):T+=B:a.hasOwnProperty(B)?(U+=a[B],S[v]=parseInt(U,16)*N,N=1,v=void 0,U=""):U+=B;return k},f={codePages:["WinAnsiEncoding"],WinAnsiEncoding:u("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},h={Unicode:{Courier:f,"Courier-Bold":f,"Courier-BoldOblique":f,"Courier-Oblique":f,Helvetica:f,"Helvetica-Bold":f,"Helvetica-BoldOblique":f,"Helvetica-Oblique":f,"Times-Roman":f,"Times-Bold":f,"Times-BoldItalic":f,"Times-Italic":f}},g={Unicode:{"Courier-Oblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":u("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":u("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:u("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:u("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":u("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":u("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(x){var m=x.font,w=g.Unicode[m.postScriptName];w&&(m.metadata.Unicode={},m.metadata.Unicode.widths=w.widths,m.metadata.Unicode.kerning=w.kerning);var v=h.Unicode[m.postScriptName];v&&(m.metadata.Unicode.encoding=v,m.encoding=v.codePages[0])}])})(gr.API),(function(e){var t=function(r){for(var a=r.length,n=new Uint8Array(a),s=0;s<a;s++)n[s]=r.charCodeAt(s);return n};e.API.events.push(["addFont",function(r){var a=void 0,n=r.font,s=r.instance;if(!n.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");if(typeof(a=s.existsFileInVFS(n.postScriptName)===!1?s.loadFile(n.postScriptName):s.getFileFromVFS(n.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");(function(l,A){A=/^\x00\x01\x00\x00/.test(A)?t(A):t(Km(A)),l.metadata=e.API.TTFFont.open(A),l.metadata.Unicode=l.metadata.Unicode||{encoding:{},kerning:{},widths:[]},l.metadata.glyIdsUsed=[0]})(n,a)}}])})(gr),gr.API.addSvgAsImage=function(e,t,r,a,n,s,l,A){if(isNaN(t)||isNaN(r))throw cn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(a)||isNaN(n))throw cn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=a,u.height=n;var f=u.getContext("2d");f.fillStyle="#fff",f.fillRect(0,0,u.width,u.height);var h={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},g=this;return(Rr.canvg?Promise.resolve(Rr.canvg):iA(()=>import("./index.es-CGVu7kzj.js"),__vite__mapDeps([0,1,2,3,4]))).catch(function(x){return Promise.reject(new Error("Could not load canvg: "+x))}).then(function(x){return x.default?x.default:x}).then(function(x){return x.fromString(f,e,h)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(x){return x.render(h)}).then(function(){g.addImage(u.toDataURL("image/jpeg",1),t,r,a,n,l,A)})},gr.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var a=1;a<=this.internal.getNumberOfPages();a++)for(var n=0;n<this.internal.pages[a].length;n++)this.internal.pages[a][n]=this.internal.pages[a][n].replace(t,r);return this},gr.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var a,n,s,l={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},A=Object.keys(l),u=[],f=0,h=0,g=0;function x(w,v){var B,k=!1;for(B=0;B<w.length;B+=1)w[B]===v&&(k=!0);return k}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(l)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var m=A.length;for(g=0;g<m;g+=1)r[A[g]].value=r[A[g]].defaultValue,r[A[g]].explicitSet=!1}if(za(e)==="object"){for(n in e)if(s=e[n],x(A,n)&&s!==void 0){if(r[n].type==="boolean"&&typeof s=="boolean")r[n].value=s;else if(r[n].type==="name"&&x(r[n].valueSet,s))r[n].value=s;else if(r[n].type==="integer"&&Number.isInteger(s))r[n].value=s;else if(r[n].type==="array"){for(f=0;f<s.length;f+=1)if(a=!0,s[f].length===1&&typeof s[f][0]=="number")u.push(String(s[f]-1));else if(s[f].length>1){for(h=0;h<s[f].length;h+=1)typeof s[f][h]!="number"&&(a=!1);a===!0&&u.push([s[f][0]-1,s[f][1]-1].join(" "))}r[n].value="["+u.join(" ")+"]"}else r[n].value=r[n].defaultValue;r[n].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var w,v=[];for(w in r)r[w].explicitSet===!0&&(r[w].type==="name"?v.push("/"+w+" /"+r[w].value):v.push("/"+w+" "+r[w].value));v.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+v.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},gr.API.addMetadata=function(e,t){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:e,namespaceUri:t??"http://jspdf.default.namespaceuri/",rawXml:typeof t=="boolean"&&t},this.internal.events.subscribe("putCatalog",Hee),this.internal.events.subscribe("postPutResources",Mee)),this},(function(e){var t=e.API,r=t.pdfEscape16=function(s,l){for(var A,u=l.metadata.Unicode.widths,f=["","0","00","000","0000"],h=[""],g=0,x=s.length;g<x;++g){if(A=l.metadata.characterToGlyph(s.charCodeAt(g)),l.metadata.glyIdsUsed.push(A),l.metadata.toUnicode[A]=s.charCodeAt(g),u.indexOf(A)==-1&&(u.push(A),u.push([parseInt(l.metadata.widthOfGlyph(A),10)])),A=="0")return h.join("");A=A.toString(16),h.push(f[4-A.length],A)}return h.join("")},a=function(s){var l,A,u,f,h,g,x;for(h=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,u=[],g=0,x=(A=Object.keys(s).sort(function(m,w){return m-w})).length;g<x;g++)l=A[g],u.length>=100&&(h+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar`,u=[]),s[l]!==void 0&&s[l]!==null&&typeof s[l].toString=="function"&&(f=("0000"+s[l].toString(16)).slice(-4),l=("0000"+(+l).toString(16)).slice(-4),u.push("<"+l+"><"+f+">"));return u.length&&(h+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar
`),h+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(s){(function(l){var A=l.font,u=l.out,f=l.newObject,h=l.putStream;if(A.metadata instanceof e.API.TTFFont&&A.encoding==="Identity-H"){for(var g=A.metadata.Unicode.widths,x=A.metadata.subset.encode(A.metadata.glyIdsUsed,1),m="",w=0;w<x.length;w++)m+=String.fromCharCode(x[w]);var v=f();h({data:m,addLength1:!0,objectId:v}),u("endobj");var B=f();h({data:a(A.metadata.toUnicode),addLength1:!0,objectId:B}),u("endobj");var k=f();u("<<"),u("/Type /FontDescriptor"),u("/FontName /"+Jd(A.fontName)),u("/FontFile2 "+v+" 0 R"),u("/FontBBox "+e.API.PDFObject.convert(A.metadata.bbox)),u("/Flags "+A.metadata.flags),u("/StemV "+A.metadata.stemV),u("/ItalicAngle "+A.metadata.italicAngle),u("/Ascent "+A.metadata.ascender),u("/Descent "+A.metadata.decender),u("/CapHeight "+A.metadata.capHeight),u(">>"),u("endobj");var N=f();u("<<"),u("/Type /Font"),u("/BaseFont /"+Jd(A.fontName)),u("/FontDescriptor "+k+" 0 R"),u("/W "+e.API.PDFObject.convert(g)),u("/CIDToGIDMap /Identity"),u("/DW 1000"),u("/Subtype /CIDFontType2"),u("/CIDSystemInfo"),u("<<"),u("/Supplement 0"),u("/Registry (Adobe)"),u("/Ordering ("+A.encoding+")"),u(">>"),u(">>"),u("endobj"),A.objectNumber=f(),u("<<"),u("/Type /Font"),u("/Subtype /Type0"),u("/ToUnicode "+B+" 0 R"),u("/BaseFont /"+Jd(A.fontName)),u("/Encoding /"+A.encoding),u("/DescendantFonts ["+N+" 0 R]"),u(">>"),u("endobj"),A.isAlreadyPutted=!0}})(s)}]),t.events.push(["putFont",function(s){(function(l){var A=l.font,u=l.out,f=l.newObject,h=l.putStream;if(A.metadata instanceof e.API.TTFFont&&A.encoding==="WinAnsiEncoding"){for(var g=A.metadata.rawData,x="",m=0;m<g.length;m++)x+=String.fromCharCode(g[m]);var w=f();h({data:x,addLength1:!0,objectId:w}),u("endobj");var v=f();h({data:a(A.metadata.toUnicode),addLength1:!0,objectId:v}),u("endobj");var B=f();u("<<"),u("/Descent "+A.metadata.decender),u("/CapHeight "+A.metadata.capHeight),u("/StemV "+A.metadata.stemV),u("/Type /FontDescriptor"),u("/FontFile2 "+w+" 0 R"),u("/Flags 96"),u("/FontBBox "+e.API.PDFObject.convert(A.metadata.bbox)),u("/FontName /"+Jd(A.fontName)),u("/ItalicAngle "+A.metadata.italicAngle),u("/Ascent "+A.metadata.ascender),u(">>"),u("endobj"),A.objectNumber=f();for(var k=0;k<A.metadata.hmtx.widths.length;k++)A.metadata.hmtx.widths[k]=parseInt(A.metadata.hmtx.widths[k]*(1e3/A.metadata.head.unitsPerEm));u("<</Subtype/TrueType/Type/Font/ToUnicode "+v+" 0 R/BaseFont/"+Jd(A.fontName)+"/FontDescriptor "+B+" 0 R/Encoding/"+A.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(A.metadata.hmtx.widths)+">>"),u("endobj"),A.isAlreadyPutted=!0}})(s)}]);var n=function(s){var l,A=s.text||"",u=s.x,f=s.y,h=s.options||{},g=s.mutex||{},x=g.pdfEscape,m=g.activeFontKey,w=g.fonts,v=m,B="",k=0,N="",S=w[v].encoding;if(w[v].encoding!=="Identity-H")return{text:A,x:u,y:f,options:h,mutex:g};for(N=A,v=m,Array.isArray(A)&&(N=A[0]),k=0;k<N.length;k+=1)w[v].metadata.hasOwnProperty("cmap")&&(l=w[v].metadata.cmap.unicode.codeMap[N[k].charCodeAt(0)]),l||N[k].charCodeAt(0)<256&&w[v].metadata.hasOwnProperty("Unicode")?B+=N[k]:B+="";var O="";return parseInt(v.slice(1))<14||S==="WinAnsiEncoding"?O=x(B,v).split("").map(function(T){return T.charCodeAt(0).toString(16)}).join(""):S==="Identity-H"&&(O=r(B,w[v])),g.isHex=!0,{text:O,x:u,y:f,options:h,mutex:g}};t.events.push(["postProcessText",function(s){var l=s.text||"",A=[],u={text:l,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(l)){var f=0;for(f=0;f<l.length;f+=1)Array.isArray(l[f])&&l[f].length===3?A.push([n(Object.assign({},u,{text:l[f][0]})).text,l[f][1],l[f][2]]):A.push(n(Object.assign({},u,{text:l[f]})).text);s.text=A}else s.text=n(Object.assign({},u,{text:l})).text}])})(gr),(function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,a){return t.call(this),this.internal.vFS[r]=a,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}})(gr.API),(function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(a){var n,s,l,A,u,f,h,g=t,x=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],m=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],w={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},v={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},B=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],k=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),N=!1,S=0;this.__bidiEngine__={};var O=function(I){var Q=I.charCodeAt(),Y=Q>>8,z=v[Y];return z!==void 0?g[256*z+(255&Q)]:Y===252||Y===253?"AL":k.test(Y)?"L":Y===8?"R":"N"},T=function(I){for(var Q,Y=0;Y<I.length;Y++){if((Q=O(I.charAt(Y)))==="L")return!1;if(Q==="R")return!0}return!1},U=function(I,Q,Y,z){var ue,Z,Ae,ve,G=Q[z];switch(G){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":N=!1;break;case"N":case"AN":break;case"EN":N&&(G="AN");break;case"AL":N=!0,G="R";break;case"WS":case"BN":G="N";break;case"CS":z<1||z+1>=Q.length||(ue=Y[z-1])!=="EN"&&ue!=="AN"||(Z=Q[z+1])!=="EN"&&Z!=="AN"?G="N":N&&(Z="AN"),G=Z===ue?Z:"N";break;case"ES":G=(ue=z>0?Y[z-1]:"B")==="EN"&&z+1<Q.length&&Q[z+1]==="EN"?"EN":"N";break;case"ET":if(z>0&&Y[z-1]==="EN"){G="EN";break}if(N){G="N";break}for(Ae=z+1,ve=Q.length;Ae<ve&&Q[Ae]==="ET";)Ae++;G=Ae<ve&&Q[Ae]==="EN"?"EN":"N";break;case"NSM":if(l&&!A){for(ve=Q.length,Ae=z+1;Ae<ve&&Q[Ae]==="NSM";)Ae++;if(Ae<ve){var Se=I[z],we=Se>=1425&&Se<=2303||Se===64286;if(ue=Q[Ae],we&&(ue==="R"||ue==="AL")){G="R";break}}}G=z<1||(ue=Q[z-1])==="B"?"N":Y[z-1];break;case"B":N=!1,n=!0,G=S;break;case"S":s=!0,G="N"}return G},D=function(I,Q,Y){var z=I.split("");return Y&&H(z,Y,{hiLevel:S}),z.reverse(),Q&&Q.reverse(),z.join("")},H=function(I,Q,Y){var z,ue,Z,Ae,ve,G=-1,Se=I.length,we=0,F=[],R=S?m:x,M=[];for(N=!1,n=!1,s=!1,ue=0;ue<Se;ue++)M[ue]=O(I[ue]);for(Z=0;Z<Se;Z++){if(ve=we,F[Z]=U(I,M,F,Z),z=240&(we=R[ve][w[F[Z]]]),we&=15,Q[Z]=Ae=R[we][5],z>0)if(z===16){for(ue=G;ue<Z;ue++)Q[ue]=1;G=-1}else G=-1;if(R[we][6])G===-1&&(G=Z);else if(G>-1){for(ue=G;ue<Z;ue++)Q[ue]=Ae;G=-1}M[Z]==="B"&&(Q[Z]=0),Y.hiLevel|=Ae}s&&(function(P,re,ge){for(var Ce=0;Ce<ge;Ce++)if(P[Ce]==="S"){re[Ce]=S;for(var de=Ce-1;de>=0&&P[de]==="WS";de--)re[de]=S}})(M,Q,Se)},j=function(I,Q,Y,z,ue){if(!(ue.hiLevel<I)){if(I===1&&S===1&&!n)return Q.reverse(),void(Y&&Y.reverse());for(var Z,Ae,ve,G,Se=Q.length,we=0;we<Se;){if(z[we]>=I){for(ve=we+1;ve<Se&&z[ve]>=I;)ve++;for(G=we,Ae=ve-1;G<Ae;G++,Ae--)Z=Q[G],Q[G]=Q[Ae],Q[Ae]=Z,Y&&(Z=Y[G],Y[G]=Y[Ae],Y[Ae]=Z);we=ve}we++}}},W=function(I,Q,Y){var z=I.split(""),ue={hiLevel:S};return Y||(Y=[]),H(z,Y,ue),(function(Z,Ae,ve){if(ve.hiLevel!==0&&h)for(var G,Se=0;Se<Z.length;Se++)Ae[Se]===1&&(G=B.indexOf(Z[Se]))>=0&&(Z[Se]=B[G+1])})(z,Y,ue),j(2,z,Q,Y,ue),j(1,z,Q,Y,ue),z.join("")};return this.__bidiEngine__.doBidiReorder=function(I,Q,Y){if((function(ue,Z){if(Z)for(var Ae=0;Ae<ue.length;Ae++)Z[Ae]=Ae;A===void 0&&(A=T(ue)),f===void 0&&(f=T(ue))})(I,Q),l||!u||f)if(l&&u&&A^f)S=A?1:0,I=D(I,Q,Y);else if(!l&&u&&f)S=A?1:0,I=W(I,Q,Y),I=D(I,Q);else if(!l||A||u||f){if(l&&!u&&A^f)I=D(I,Q),A?(S=0,I=W(I,Q,Y)):(S=1,I=W(I,Q,Y),I=D(I,Q));else if(l&&A&&!u&&f)S=1,I=W(I,Q,Y),I=D(I,Q);else if(!l&&!u&&A^f){var z=h;A?(S=1,I=W(I,Q,Y),S=0,h=!1,I=W(I,Q,Y),h=z):(S=0,I=W(I,Q,Y),I=D(I,Q),S=1,h=!1,I=W(I,Q,Y),h=z,I=D(I,Q))}}else S=0,I=W(I,Q,Y);else S=A?1:0,I=W(I,Q,Y);return I},this.__bidiEngine__.setOptions=function(I){I&&(l=I.isInputVisual,u=I.isOutputVisual,A=I.isInputRtl,f=I.isOutputRtl,h=I.isSymmetricSwapping)},this.__bidiEngine__.setOptions(a),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(a){var n=a.text;a.x,a.y;var s=a.options||{};a.mutex,s.lang;var l=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,r.setOptions(s),Object.prototype.toString.call(n)==="[object Array]"){var A=0;for(l=[],A=0;A<n.length;A+=1)Object.prototype.toString.call(n[A])==="[object Array]"?l.push([r.doBidiReorder(n[A][0]),n[A][1],n[A][2]]):l.push([r.doBidiReorder(n[A])]);a.text=l}else a.text=r.doBidiReorder(n);r.setOptions({isInputVisual:!0})}])})(gr),gr.API.TTFFont=(function(){function e(t){var r;if(this.rawData=t,r=this.contents=new Yu(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new rte(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new Pee(this.contents),this.head=new qee(this),this.name=new Xee(this),this.cmap=new UT(this),this.toUnicode={},this.hhea=new zee(this),this.maxp=new Yee(this),this.hmtx=new $ee(this),this.post=new Gee(this),this.os2=new Vee(this),this.loca=new tte(this),this.glyf=new Jee(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,a,n,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var l,A,u,f;for(f=[],l=0,A=(u=this.bbox).length;l<A;l++)t=u[l],f.push(Math.round(t*this.scaleFactor));return f}).call(this),this.stemV=0,this.post.exists?(a=255&(n=this.post.italic_angle),32768&(r=n>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+a)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,a){var n,s,l,A;for(l=0,s=0,A=(t=""+t).length;0<=A?s<A:s>A;s=0<=A?++s:--s)n=t.charCodeAt(s),l+=this.widthOfGlyph(this.characterToGlyph(n))+a*(1e3/r)||0;return l*(r/1e3)},e.prototype.lineHeight=function(t,r){var a;return r==null&&(r=!1),a=r?this.lineGap:0,(this.ascender+a-this.decender)/1e3*t},e})();var gA,Yu=(function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,a;for(a=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)a[r]=String.fromCharCode(this.readByte());return a.join("")},e.prototype.writeString=function(t){var r,a,n;for(n=[],r=0,a=t.length;0<=a?r<a:r>a;r=0<=a?++r:--r)n.push(this.writeByte(t.charCodeAt(r)));return n},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,a,n,s,l,A,u;return t=this.readByte(),r=this.readByte(),a=this.readByte(),n=this.readByte(),s=this.readByte(),l=this.readByte(),A=this.readByte(),u=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^a)+4294967296*(255^n)+16777216*(255^s)+65536*(255^l)+256*(255^A)+(255^u)+1):72057594037927940*t+281474976710656*r+1099511627776*a+4294967296*n+16777216*s+65536*l+256*A+u},e.prototype.writeLongLong=function(t){var r,a;return r=Math.floor(t/4294967296),a=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(a>>24&255),this.writeByte(a>>16&255),this.writeByte(a>>8&255),this.writeByte(255&a)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,a;for(r=[],a=0;0<=t?a<t:a>t;a=0<=t?++a:--a)r.push(this.readByte());return r},e.prototype.write=function(t){var r,a,n,s;for(s=[],a=0,n=t.length;a<n;a++)r=t[a],s.push(this.writeByte(r));return s},e})(),Pee=(function(){var e;function t(r){var a,n,s;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},n=0,s=this.tableCount;0<=s?n<s:n>s;n=0<=s?++n:--n)a={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[a.tag]=a}return t.prototype.encode=function(r){var a,n,s,l,A,u,f,h,g,x,m,w,v;for(v in m=Object.keys(r).length,u=Math.log(2),g=16*Math.floor(Math.log(m)/u),l=Math.floor(g/u),h=16*m-g,(n=new Yu).writeInt(this.scalarType),n.writeShort(m),n.writeShort(g),n.writeShort(l),n.writeShort(h),s=16*m,f=n.pos+s,A=null,w=[],r)for(x=r[v],n.writeString(v),n.writeInt(e(x)),n.writeInt(f),n.writeInt(x.length),w=w.concat(x),v==="head"&&(A=f),f+=x.length;f%4;)w.push(0),f++;return n.write(w),a=2981146554-e(n.data),n.pos=A+8,n.writeUInt32(a),n.data},e=function(r){var a,n,s,l;for(r=jT.call(r);r.length%4;)r.push(0);for(s=new Yu(r),n=0,a=0,l=r.length;a<l;a=a+=4)n+=s.readUInt32();return 4294967295&n},t})(),Kee={}.hasOwnProperty,lc=function(e,t){for(var r in t)Kee.call(t,r)&&(e[r]=t[r]);function a(){this.constructor=e}return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e};gA=(function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e})();var qee=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return lc(e,gA),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new Yu).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e})(),iS=(function(){function e(t,r){var a,n,s,l,A,u,f,h,g,x,m,w,v,B,k,N,S;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),g=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(u=0;u<256;++u)this.codeMap[u]=t.readByte();break;case 4:for(m=t.readUInt16(),x=m/2,t.pos+=6,s=(function(){var O,T;for(T=[],u=O=0;0<=x?O<x:O>x;u=0<=x?++O:--O)T.push(t.readUInt16());return T})(),t.pos+=2,v=(function(){var O,T;for(T=[],u=O=0;0<=x?O<x:O>x;u=0<=x?++O:--O)T.push(t.readUInt16());return T})(),f=(function(){var O,T;for(T=[],u=O=0;0<=x?O<x:O>x;u=0<=x?++O:--O)T.push(t.readUInt16());return T})(),h=(function(){var O,T;for(T=[],u=O=0;0<=x?O<x:O>x;u=0<=x?++O:--O)T.push(t.readUInt16());return T})(),n=(this.length-t.pos+this.offset)/2,A=(function(){var O,T;for(T=[],u=O=0;0<=n?O<n:O>n;u=0<=n?++O:--O)T.push(t.readUInt16());return T})(),u=k=0,S=s.length;k<S;u=++k)for(B=s[u],a=N=w=v[u];w<=B?N<=B:N>=B;a=w<=B?++N:--N)h[u]===0?l=a+f[u]:(l=A[h[u]/2+(a-w)-(x-u)]||0)!==0&&(l+=f[u]),this.codeMap[a]=65535&l}t.pos=g}return e.encode=function(t,r){var a,n,s,l,A,u,f,h,g,x,m,w,v,B,k,N,S,O,T,U,D,H,j,W,I,Q,Y,z,ue,Z,Ae,ve,G,Se,we,F,R,M,P,re,ge,Ce,de,be,Le,ie;switch(z=new Yu,l=Object.keys(t).sort(function(_e,je){return _e-je}),r){case"macroman":for(v=0,B=(function(){var _e=[];for(w=0;w<256;++w)_e.push(0);return _e})(),N={0:0},s={},ue=0,G=l.length;ue<G;ue++)N[de=t[n=l[ue]]]==null&&(N[de]=++v),s[n]={old:t[n],new:N[t[n]]},B[n]=N[t[n]];return z.writeUInt16(1),z.writeUInt16(0),z.writeUInt32(12),z.writeUInt16(0),z.writeUInt16(262),z.writeUInt16(0),z.write(B),{charMap:s,subtable:z.data,maxGlyphID:v+1};case"unicode":for(Q=[],g=[],S=0,N={},a={},k=f=null,Z=0,Se=l.length;Z<Se;Z++)N[T=t[n=l[Z]]]==null&&(N[T]=++S),a[n]={old:T,new:N[T]},A=N[T]-n,k!=null&&A===f||(k&&g.push(k),Q.push(n),f=A),k=n;for(k&&g.push(k),g.push(65535),Q.push(65535),W=2*(j=Q.length),H=2*Math.pow(Math.log(j)/Math.LN2,2),x=Math.log(H/2)/Math.LN2,D=2*j-H,u=[],U=[],m=[],w=Ae=0,we=Q.length;Ae<we;w=++Ae){if(I=Q[w],h=g[w],I===65535){u.push(0),U.push(0);break}if(I-(Y=a[I].new)>=32768)for(u.push(0),U.push(2*(m.length+j-w)),n=ve=I;I<=h?ve<=h:ve>=h;n=I<=h?++ve:--ve)m.push(a[n].new);else u.push(Y-I),U.push(0)}for(z.writeUInt16(3),z.writeUInt16(1),z.writeUInt32(12),z.writeUInt16(4),z.writeUInt16(16+8*j+2*m.length),z.writeUInt16(0),z.writeUInt16(W),z.writeUInt16(H),z.writeUInt16(x),z.writeUInt16(D),ge=0,F=g.length;ge<F;ge++)n=g[ge],z.writeUInt16(n);for(z.writeUInt16(0),Ce=0,R=Q.length;Ce<R;Ce++)n=Q[Ce],z.writeUInt16(n);for(be=0,M=u.length;be<M;be++)A=u[be],z.writeUInt16(A);for(Le=0,P=U.length;Le<P;Le++)O=U[Le],z.writeUInt16(O);for(ie=0,re=m.length;ie<re;ie++)v=m[ie],z.writeUInt16(v);return{charMap:a,subtable:z.data,maxGlyphID:S+1}}},e})(),UT=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return lc(e,gA),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,a,n;for(t.pos=this.offset,this.version=t.readUInt16(),n=t.readUInt16(),this.tables=[],this.unicode=null,a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)r=new iS(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var a,n;return r==null&&(r="macroman"),a=iS.encode(t,r),(n=new Yu).writeUInt16(0),n.writeUInt16(1),a.table=n.data.concat(a.subtable),a},e})(),zee=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return lc(e,gA),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e})(),Vee=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return lc(e,gA),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=(function(){var r,a;for(a=[],r=0;r<10;++r)a.push(t.readByte());return a})(),this.charRange=(function(){var r,a;for(a=[],r=0;r<4;++r)a.push(t.readInt());return a})(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=(function(){var r,a;for(a=[],r=0;r<2;r=++r)a.push(t.readInt());return a})(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e})(),Gee=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return lc(e,gA),e.prototype.tag="post",e.prototype.parse=function(t){var r,a,n;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(a=t.readUInt16(),this.glyphNameIndex=[],s=0;0<=a?s<a:s>a;s=0<=a?++s:--s)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],n=[];t.pos<this.offset+this.length;)r=t.readByte(),n.push(this.names.push(t.readString(r)));return n;case 151552:return a=t.readUInt16(),this.offsets=t.read(a);case 262144:return this.map=(function(){var l,A,u;for(u=[],s=l=0,A=this.file.maxp.numGlyphs;0<=A?l<A:l>A;s=0<=A?++l:--l)u.push(t.readUInt32());return u}).call(this)}},e})(),Wee=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},Xee=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return lc(e,gA),e.prototype.tag="name",e.prototype.parse=function(t){var r,a,n,s,l,A,u,f,h,g,x;for(t.pos=this.offset,t.readShort(),r=t.readShort(),A=t.readShort(),a=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)a.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+A+t.readShort()});for(u={},s=h=0,g=a.length;h<g;s=++h)n=a[s],t.pos=n.offset,f=t.readString(n.length),l=new Wee(f,n),u[x=n.nameID]==null&&(u[x]=[]),u[n.nameID].push(l);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},e})(),Yee=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return lc(e,gA),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e})(),$ee=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return lc(e,gA),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,a,n,s,l,A,u;for(t.pos=this.offset,this.metrics=[],r=0,A=this.file.hhea.numberOfMetrics;0<=A?r<A:r>A;r=0<=A?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(n=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var f,h;for(h=[],r=f=0;0<=n?f<n:f>n;r=0<=n?++f:--f)h.push(t.readInt16());return h})(),this.widths=(function(){var f,h,g,x;for(x=[],f=0,h=(g=this.metrics).length;f<h;f++)s=g[f],x.push(s.advance);return x}).call(this),a=this.widths[this.widths.length-1],u=[],r=l=0;0<=n?l<n:l>n;r=0<=n?++l:--l)u.push(this.widths.push(a));return u},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e})(),jT=[].slice,Jee=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return lc(e,gA),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,a,n,s,l,A,u,f,h,g;return t in this.cache?this.cache[t]:(s=this.file.loca,r=this.file.contents,a=s.indexOf(t),(n=s.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+a,l=(A=new Yu(r.read(n))).readShort(),f=A.readShort(),g=A.readShort(),u=A.readShort(),h=A.readShort(),this.cache[t]=l===-1?new ete(A,f,g,u,h):new Zee(A,l,f,g,u,h),this.cache[t]))},e.prototype.encode=function(t,r,a){var n,s,l,A,u;for(l=[],s=[],A=0,u=r.length;A<u;A++)n=t[r[A]],s.push(l.length),n&&(l=l.concat(n.encode(a)));return s.push(l.length),{table:l,offsets:s}},e})(),Zee=(function(){function e(t,r,a,n,s,l){this.raw=t,this.numberOfContours=r,this.xMin=a,this.yMin=n,this.xMax=s,this.yMax=l,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e})(),ete=(function(){function e(t,r,a,n,s){var l,A;for(this.raw=t,this.xMin=r,this.yMin=a,this.xMax=n,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],l=this.raw;A=l.readShort(),this.glyphOffsets.push(l.pos),this.glyphIDs.push(l.readUInt16()),32&A;)l.pos+=1&A?4:2,128&A?l.pos+=8:64&A?l.pos+=4:8&A&&(l.pos+=2)}return e.prototype.encode=function(){var t,r,a;for(r=new Yu(jT.call(this.raw.data)),t=0,a=this.glyphIDs.length;t<a;++t)r.pos=this.glyphOffsets[t];return r.data},e})(),tte=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return lc(e,gA),e.prototype.tag="loca",e.prototype.parse=function(t){var r,a;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var n,s;for(s=[],a=0,n=this.length;a<n;a+=2)s.push(2*t.readUInt16());return s}).call(this):(function(){var n,s;for(s=[],a=0,n=this.length;a<n;a+=4)s.push(t.readUInt32());return s}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var a=new Uint32Array(this.offsets.length),n=0,s=0,l=0;l<a.length;++l)if(a[l]=n,s<r.length&&r[s]==l){++s,a[l]=n;var A=this.offsets[l],u=this.offsets[l+1]-A;u>0&&(n+=u)}for(var f=new Array(4*a.length),h=0;h<a.length;++h)f[4*h+3]=255&a[h],f[4*h+2]=(65280&a[h])>>8,f[4*h+1]=(16711680&a[h])>>16,f[4*h]=(4278190080&a[h])>>24;return f},e})(),rte=(function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,a,n,s;for(r in n=this.font.cmap.tables[0].codeMap,t={},s=this.subset)a=s[r],t[r]=n[a];return t},e.prototype.glyphsFor=function(t){var r,a,n,s,l,A,u;for(n={},l=0,A=t.length;l<A;l++)n[s=t[l]]=this.font.glyf.glyphFor(s);for(s in r=[],n)(a=n[s])!=null&&a.compound&&r.push.apply(r,a.glyphIDs);if(r.length>0)for(s in u=this.glyphsFor(r))a=u[s],n[s]=a;return n},e.prototype.encode=function(t,r){var a,n,s,l,A,u,f,h,g,x,m,w,v,B,k;for(n in a=UT.encode(this.generateCmap(),"unicode"),l=this.glyphsFor(t),m={0:0},k=a.charMap)m[(u=k[n]).old]=u.new;for(w in x=a.maxGlyphID,l)w in m||(m[w]=x++);return h=(function(N){var S,O;for(S in O={},N)O[N[S]]=S;return O})(m),g=Object.keys(h).sort(function(N,S){return N-S}),v=(function(){var N,S,O;for(O=[],N=0,S=g.length;N<S;N++)A=g[N],O.push(h[A]);return O})(),s=this.font.glyf.encode(l,v,m),f=this.font.loca.encode(s.offsets,v),B={cmap:this.font.cmap.raw(),glyf:s.table,loca:f,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(B["OS/2"]=this.font.os2.raw()),this.font.directory.encode(B)},e})();gr.API.PDFObject=(function(){var e;function t(){}return e=function(r,a){return(Array(a+1).join("0")+r).slice(-a)},t.convert=function(r){var a,n,s,l;if(Array.isArray(r))return"["+(function(){var A,u,f;for(f=[],A=0,u=r.length;A<u;A++)a=r[A],f.push(t.convert(a));return f})().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(n in s=["<<"],r)l=r[n],s.push("/"+n+" "+t.convert(l));return s.push(">>"),s.join(`
`)}return""+r},t})();const Sy=()=>{const{t:e}=tn(),t=fA("ReportExport"),[r,a]=X.useState(!1),[n,s]=X.useState(0),l=v=>{const B=v.replace("#","");if(!/^[0-9a-fA-F]{6}$/.test(B))return[30,41,59];const k=parseInt(B.slice(0,2),16),N=parseInt(B.slice(2,4),16),S=parseInt(B.slice(4,6),16);return[k,N,S]},A=v=>new Promise((B,k)=>{const N=new FileReader;N.onloadend=()=>B(String(N.result||"")),N.onerror=()=>k(new Error("Failed to read image blob")),N.readAsDataURL(v)}),u=(v,B)=>{const k=v.toLowerCase();if(k.includes("jpeg")||k.includes("jpg"))return"JPEG";if(k.includes("webp"))return"WEBP";if(k.includes("png"))return"PNG";const N=B.toLowerCase();return N.endsWith(".jpg")||N.endsWith(".jpeg")?"JPEG":N.endsWith(".webp")?"WEBP":"PNG"},f=async v=>{if(v.startsWith("data:image/")){const O=v.includes("image/jpeg")||v.includes("image/jpg")?"JPEG":v.includes("image/webp")?"WEBP":"PNG";return{data:v,format:O}}const B=await fetch(v,{mode:"cors",referrerPolicy:"no-referrer"});if(!B.ok)throw new Error(`Image request failed with status ${B.status}`);const k=await B.blob(),N=u(k.type,v);return{data:await A(k),format:N}},h=(v,B,k,N,S)=>{const O=S?.showHeader??!0,T=S?.showFooter??!0,U=v.internal.pageSize.getWidth(),D=v.internal.pageSize.getHeight();if(O&&(v.setFontSize(10),v.setTextColor(120,120,120),v.text(S?.headerText||B.title,10,10),v.line(10,12,U-10,12)),T){v.setFontSize(9),v.setTextColor(130,130,130);const H=S?.footerText||`${e("reports.generated_on")}: ${new Date().toLocaleDateString()}`;v.text(H,10,D-8);const j=`${k}/${N}`;v.text(j,U-10,D-8,{align:"right"})}},g=async(v,B)=>{const k=document.getElementById(v);if(!k)return null;const N=k.cloneNode(!0);N.style.position="fixed",N.style.top="0",N.style.left="500vw",N.style.width=B?`${B}px`:`${k.scrollWidth||1200}px`,N.style.height="auto",N.style.minHeight=`${k.scrollHeight||800}px`,N.style.overflow="visible",N.style.zIndex="-100",N.style.padding="40px",N.style.backgroundColor="#ffffff",N.querySelectorAll(".overflow-auto, .overflow-y-auto, .overflow-x-auto").forEach(U=>{U.style.overflow="visible",U.style.height="auto"}),N.querySelectorAll("h1, h2, h3, h4, h5, h6, .truncate").forEach(U=>{const D=U;D.style.overflow="visible",D.style.textOverflow="clip",D.style.lineHeight="1.35",D.style.paddingBottom="2px"}),document.body.appendChild(N),await new Promise(U=>setTimeout(U,800)),"fonts"in document&&await document.fonts.ready;const T=await Gw(N,{scale:2,useCORS:!0,logging:!1,backgroundColor:"#ffffff",width:N.offsetWidth,height:N.offsetHeight});return document.body.removeChild(N),{imgData:T.toDataURL("image/png"),width:T.width,height:T.height}};return{isExporting:r,exportProgress:n,exportToPdf:async(v,B,k="landscape")=>{a(!0),s(0);try{const N=await g(v);if(!N)return;const S=new gr({orientation:k,unit:"mm",format:"a4"}),O=S.internal.pageSize.getWidth(),T=S.internal.pageSize.getHeight(),U=Math.min(O/(N.width/2),T/(N.height/2)),D=N.width/2*U,H=N.height/2*U;S.addImage(N.imgData,"PNG",(O-D)/2,(T-H)/2,D,H),S.save(`${B}.pdf`)}catch(N){t.error("Export failed:",N)}finally{a(!1)}},exportPackageToPdf:async(v,B,k,N)=>{a(!0),s(0);const S=new gr({orientation:"portrait",unit:"mm",format:"a4"});try{if(k){const[U,D,H]=k.themeColor?l(k.themeColor):[30,41,59];if(S.setFillColor(U,D,H),S.rect(0,0,210,297,"F"),S.setTextColor(255,255,255),S.setFontSize(32),S.text(k.title,20,100),k.subtitle&&(S.setFontSize(16),S.setTextColor(148,163,184),S.text(k.subtitle,20,115)),S.setFontSize(12),S.setTextColor(100,116,139),S.text(`${e("reports.generated_on")}: ${new Date().toLocaleDateString()}`,20,260),k.author&&S.text(`${e("reports.author_prefix")}: ${k.author}`,20,267),k.logoUrl)try{const j=await f(k.logoUrl),W=30,Q=210-20-W;S.addImage(j.data,j.format,Q,25,W,W)}catch(j){t.warn("Cover logo could not be loaded for PDF export. The host likely blocks cross-origin image access.",j)}S.addPage()}const O=k?2:1,T=(k?1:0)+B.length;for(let U=0;U<B.length;U++){s(Math.round((U+1)/B.length*100));const D=B[U],H=await g(D.elementId,D.orientation==="landscape"?1400:1e3);if(H){const j=D.orientation||"portrait";(U>0||k)&&S.addPage(void 0,j);const W=S.internal.pageSize.getWidth(),I=S.internal.pageSize.getHeight();((N?.footerMode??"all")==="all"||(N?.footerMode??"all")==="content_only")&&h(S,D,O+U,T,N);const Q=N?.showHeader===!1?12:20,Y=N?.showFooter===!1?12:18,z=Math.min((W-20)/(H.width/2),(I-(Q+Y))/(H.height/2)),ue=H.width/2*z,Z=H.height/2*z;S.addImage(H.imgData,"PNG",(W-ue)/2,Q,ue,Z)}}S.save(`${v}.pdf`)}catch(O){t.error("Batch Export failed:",O),await Xt.error(e("reports.export_failed","Export failed."))}finally{a(!1),s(0)}},exportToImage:async(v,B)=>{a(!0);try{const k=document.getElementById(v);if(!k)return;await new Promise(O=>setTimeout(O,500));const N=await Gw(k,{scale:2,useCORS:!0,logging:!1,backgroundColor:"#ffffff"}),S=document.createElement("a");S.download=`${B}.png`,S.href=N.toDataURL("image/png"),S.click()}catch(k){t.error("Export failed:",k)}finally{a(!1)}}}},ate=e=>{const t=e.toLowerCase();return t.includes("price")||t.includes("amount")||t.includes("preis")||t.includes("betrag")||t.includes("summe")||t.includes("kosten")||t.includes("total")},Ia=(e,t)=>{if(typeof e!="number"){if(typeof e=="string")return e;if(typeof e=="boolean")return e?"true":"false";if(e==null)return"";if(typeof e=="object")try{return JSON.stringify(e)}catch{return String(e)}return String(e)}return t&&ate(t)?new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(e):new Intl.NumberFormat("de-DE").format(e)},nte=({onChange:e,initialConfig:t,isAdminMode:r=!1})=>{const[a,n]=X.useState([]),[s,l]=X.useState([]),[A,u]=X.useState(t||{table:"",columns:[],filters:[],aggregations:[],groupBy:[],orderBy:[],limit:100,filterLogic:"AND"}),[f,h]=X.useState(""),[g,x]=X.useState({filters:!0,aggregations:!1,sorting:!1}),m=T=>{x(U=>({...U,[T]:!U[T]}))};X.useEffect(()=>{Dt.getTables().then(T=>{const U=r?T:T.filter(D=>!D.startsWith("sys_"));n(U),u(D=>!D.table&&U.length>0?{...D,table:U[0]}:D)})},[r]),X.useEffect(()=>{A.table&&Dt.getTableSchema(A.table).then(T=>{l(T.map(U=>({name:U.name,type:U.type.toLowerCase()})))})},[A.table]);const w=X.useCallback(T=>{if(!T.table)return"";let U=T.columns.length>0?T.columns.join(", "):"*";if(T.aggregations.length>0){const H=T.aggregations.map(j=>`${j.type.toUpperCase()}(${j.column}) AS ${j.alias||`${j.type}_${j.column}`}`);T.columns.length>0?U=[...T.columns,...H].join(", "):U=H.join(", ")}let D=`SELECT ${U} FROM ${T.table}`;if(T.filters.length>0){const H=T.filters.map(W=>{let I=W.value;if(W.operator==="contains")return`${W.column} LIKE '%${I.replace(/'/g,"''")}%'`;if(W.operator==="is null")return`${W.column} IS NULL`;if(W.operator==="is not null")return`${W.column} IS NOT NULL`;const Q=s.find(Y=>Y.name===W.column)?.type||"";return(Q.includes("char")||Q.includes("text"))&&(I=`'${I.replace(/'/g,"''")}'`),`${W.column} ${W.operator} ${I}`}),j=T.filterLogic||"AND";D+=` WHERE ${H.join(` ${j} `)}`}if(T.groupBy.length>0&&(D+=` GROUP BY ${T.groupBy.join(", ")}`),T.orderBy.length>0){const H=T.orderBy.map(j=>`${j.column} ${j.direction}`);D+=` ORDER BY ${H.join(", ")}`}return T.limit&&(D+=` LIMIT ${T.limit}`),D},[s]);X.useEffect(()=>{const T=w(A);e(T,A)},[A,w,e]);const v=T=>{u(U=>({...U,columns:U.columns.includes(T)?U.columns.filter(D=>D!==T):[...U.columns,T]}))},B=()=>{s.length!==0&&u(T=>({...T,filters:[...T.filters,{column:s[0].name,operator:"=",value:""}]}))},k=(T,U,D)=>{u(H=>{const j=[...H.filters];return U==="operator"?j[T]={...j[T],operator:D}:U==="column"?j[T]={...j[T],column:D}:j[T]={...j[T],value:D},{...H,filters:j}})},N=T=>{u(U=>({...U,filters:U.filters.filter((D,H)=>H!==T)}))},S=()=>{s.length!==0&&u(T=>({...T,aggregations:[...T.aggregations,{column:s[0].name,type:"sum"}]}))},O=T=>{u(U=>({...U,aggregations:U.aggregations.filter((D,H)=>H!==T)}))};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center gap-4 bg-slate-50 dark:bg-slate-900/50 p-4 rounded-xl border border-slate-200 dark:border-slate-800",children:[c.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg text-blue-600",children:c.jsx(_i,{className:"w-5 h-5"})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("label",{className:"block text-[10px] font-black uppercase text-slate-400 mb-1",children:"Datenquelle / Tabelle"}),c.jsx("select",{value:A.table,onChange:T=>u({...A,table:T.target.value,columns:[],filters:[],aggregations:[],groupBy:[]}),className:"bg-transparent text-sm font-bold text-slate-900 dark:text-white outline-none w-full cursor-pointer",children:a.map(T=>c.jsx("option",{value:T,children:T},T))})]})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex items-center justify-between gap-4",children:[c.jsxs("h4",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider flex items-center gap-2",children:[c.jsx(Im,{className:"w-4 h-4"})," Spalten"]}),c.jsxs("div",{className:"relative flex-1 max-w-[150px]",children:[c.jsx(fo,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-3 h-3 text-slate-400"}),c.jsx("input",{type:"text",placeholder:"Suchen...",value:f,onChange:T=>h(T.target.value),className:"w-full pl-7 pr-2 py-1 text-[10px] bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-md outline-none focus:ring-1 focus:ring-blue-500"})]})]}),c.jsx("div",{className:"flex flex-wrap gap-1.5 max-h-[120px] overflow-y-auto pr-1 custom-scrollbar",children:s.filter(T=>T.name.toLowerCase().includes(f.toLowerCase())).map(T=>{const U=A.columns.includes(T.name);return c.jsxs("button",{onClick:()=>v(T.name),className:`
                                    flex items-center gap-1.5 px-2 py-1 rounded-md text-[10px] font-medium border transition-all
                                    ${U?"bg-blue-600 border-blue-600 text-white shadow-sm":"bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-400 hover:border-blue-400"}
                                `,children:[T.type.includes("int")||T.type.includes("real")?c.jsx(U8,{className:"w-2.5 h-2.5 opacity-60"}):T.type.includes("date")?c.jsx(m2,{className:"w-2.5 h-2.5 opacity-60"}):c.jsx(US,{className:"w-2.5 h-2.5 opacity-60"}),T.name]},T.name)})})]}),c.jsxs("div",{className:"border-t border-slate-300 dark:border-slate-600 pt-5 mt-1",children:[c.jsxs("button",{onClick:()=>m("filters"),className:"w-full flex items-center justify-between mb-3 group",children:[c.jsxs("h4",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider flex items-center gap-2",children:[c.jsx(sf,{className:"w-4 h-4"})," Filter (",A.filters.length,")"]}),g.filters?c.jsx(Fb,{className:"w-4 h-4 text-slate-300 group-hover:text-slate-500"}):c.jsx(lf,{className:"w-4 h-4 text-slate-300 group-hover:text-slate-500"})]}),g.filters&&c.jsxs("div",{className:"space-y-2 animate-in fade-in slide-in-from-top-1 duration-200",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[A.filters.length>1&&c.jsxs("div",{className:"flex items-center p-0.5 bg-slate-100 dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700",children:[c.jsx("button",{onClick:()=>u({...A,filterLogic:"AND"}),className:`px-3 py-1 text-[9px] font-black rounded-md transition-all ${A.filterLogic==="AND"?"bg-white dark:bg-slate-700 text-blue-600 shadow-sm":"text-slate-400 hover:text-slate-600"}`,children:"ALLE (UND)"}),c.jsx("button",{onClick:()=>u({...A,filterLogic:"OR"}),className:`px-3 py-1 text-[9px] font-black rounded-md transition-all ${A.filterLogic==="OR"?"bg-white dark:bg-slate-700 text-blue-600 shadow-sm":"text-slate-400 hover:text-slate-600"}`,children:"EINE (ODER)"})]}),c.jsx("div",{className:"flex-1"}),c.jsxs("button",{onClick:B,className:"p-1 px-2 text-[10px] font-bold bg-slate-100 dark:bg-slate-800 hover:bg-slate-200 text-slate-600 rounded flex items-center gap-1 transition-colors",children:[c.jsx(Io,{className:"w-3 h-3"})," Filter hinzufgen"]})]}),A.filters.map((T,U)=>c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("select",{value:T.column,onChange:D=>k(U,"column",D.target.value),className:"flex-1 min-w-0 p-1.5 text-[10px] bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded outline-none focus:ring-1 focus:ring-blue-500",children:s.map(D=>c.jsx("option",{value:D.name,children:D.name},D.name))}),c.jsxs("select",{value:T.operator,onChange:D=>k(U,"operator",D.target.value),className:"w-20 p-1.5 text-[10px] bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded outline-none focus:ring-1 focus:ring-blue-500",children:[c.jsx("option",{value:"=",children:"="}),c.jsx("option",{value:"!=",children:"!="}),c.jsx("option",{value:">",children:">"}),c.jsx("option",{value:"<",children:"<"}),c.jsx("option",{value:"contains",children:"enthlt"}),c.jsx("option",{value:"is null",children:"ist leer"}),c.jsx("option",{value:"is not null",children:"nicht leer"})]}),!T.operator.includes("null")&&c.jsx("input",{type:"text",value:T.value,onChange:D=>k(U,"value",D.target.value),placeholder:"Wert...",className:"flex-1 min-w-0 p-1.5 text-[10px] bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded outline-none focus:ring-1 focus:ring-blue-500"}),c.jsx("button",{onClick:()=>N(U),className:"p-1.5 text-slate-300 hover:text-red-500 transition-colors",children:c.jsx(ds,{className:"w-3.5 h-3.5"})})]},U))]})]}),c.jsxs("div",{className:"border-t border-slate-300 dark:border-slate-600 pt-5 mt-1",children:[c.jsxs("button",{onClick:()=>m("aggregations"),className:"w-full flex items-center justify-between mb-3 group",children:[c.jsxs("h4",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider flex items-center gap-2",children:[c.jsx(Im,{className:"w-4 h-4"})," Aggregation (",A.aggregations.length,")"]}),g.aggregations?c.jsx(Fb,{className:"w-4 h-4 text-slate-300 group-hover:text-slate-500"}):c.jsx(lf,{className:"w-4 h-4 text-slate-300 group-hover:text-slate-500"})]}),g.aggregations&&c.jsxs("div",{className:"space-y-3 animate-in fade-in slide-in-from-top-1 duration-200",children:[c.jsx("div",{className:"flex justify-end",children:c.jsxs("button",{onClick:S,className:"p-1 px-2 text-[10px] font-bold bg-slate-100 dark:bg-slate-800 hover:bg-slate-200 text-slate-600 rounded flex items-center gap-1 transition-colors",children:[c.jsx(Io,{className:"w-3 h-3"})," Aggregation hinzufgen"]})}),c.jsx("div",{className:"space-y-2",children:A.aggregations.map((T,U)=>c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("select",{value:T.type,onChange:D=>{const H=[...A.aggregations];H[U].type=D.target.value,u({...A,aggregations:H})},className:"w-20 p-1.5 text-[10px] bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded outline-none focus:ring-1 focus:ring-blue-500",children:[c.jsx("option",{value:"sum",children:"Summe"}),c.jsx("option",{value:"avg",children:"Durchschn."}),c.jsx("option",{value:"count",children:"Anzahl"}),c.jsx("option",{value:"min",children:"Min"}),c.jsx("option",{value:"max",children:"Max"})]}),c.jsx("span",{className:"text-[9px] font-bold text-slate-400 uppercase",children:"von"}),c.jsx("select",{value:T.column,onChange:D=>{const H=[...A.aggregations];H[U].column=D.target.value,u({...A,aggregations:H})},className:"flex-1 p-1.5 text-[10px] bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded outline-none focus:ring-1 focus:ring-blue-500",children:s.map(D=>c.jsx("option",{value:D.name,children:D.name},D.name))}),c.jsx("button",{onClick:()=>O(U),className:"p-1.5 text-slate-300 hover:text-red-500 transition-colors",children:c.jsx(ds,{className:"w-3.5 h-3.5"})})]},U))}),A.aggregations.length>0&&c.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-900/40 rounded-lg border border-slate-100 dark:border-slate-800",children:[c.jsx("label",{className:"block text-[9px] font-black uppercase text-slate-400 mb-2",children:"Gruppieren nach"}),c.jsx("div",{className:"flex flex-wrap gap-1",children:s.map(T=>{const U=A.groupBy.includes(T.name);return c.jsx("button",{onClick:()=>{u(D=>({...D,groupBy:U?D.groupBy.filter(H=>H!==T.name):[...D.groupBy,T.name]}))},className:`px-1.5 py-0.5 rounded text-[9px] font-bold transition-all ${U?"bg-slate-900 text-white shadow-sm":"bg-white dark:bg-slate-800 text-slate-500 border border-slate-200 dark:border-slate-700 hover:border-slate-300"}`,children:T.name},T.name)})})]})]})]}),c.jsxs("div",{className:"border-t border-slate-300 dark:border-slate-600 pt-5 pb-2 mt-1",children:[c.jsxs("button",{onClick:()=>m("sorting"),className:"w-full flex items-center justify-between mb-3 group",children:[c.jsxs("h4",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider flex items-center gap-2",children:[c.jsx(Im,{className:"w-4 h-4"})," Sortierung & Limit"]}),g.sorting?c.jsx(Fb,{className:"w-4 h-4 text-slate-300 group-hover:text-slate-500"}):c.jsx(lf,{className:"w-4 h-4 text-slate-300 group-hover:text-slate-500"})]}),g.sorting&&c.jsxs("div",{className:"flex gap-4 animate-in fade-in slide-in-from-top-1 duration-200",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("label",{className:"block text-[9px] font-black uppercase text-slate-400 mb-1",children:"LIMIT"}),c.jsx("input",{type:"number",value:A.limit,onChange:T=>u({...A,limit:parseInt(T.target.value,10)||0}),className:"w-full p-1.5 text-[10px] bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded outline-none focus:ring-1 focus:ring-blue-500"})]}),c.jsxs("div",{className:"flex-1",children:[c.jsx("label",{className:"block text-[9px] font-black uppercase text-slate-400 mb-1",children:"Sortierung"}),c.jsxs("select",{value:A.orderBy[0]?.column||"",onChange:T=>u({...A,orderBy:T.target.value?[{column:T.target.value,direction:"DESC"}]:[]}),className:"w-full p-1.5 text-[10px] bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded outline-none focus:ring-1 focus:ring-blue-500",children:[c.jsx("option",{value:"",children:"Keine"}),s.map(T=>c.jsx("option",{value:T.name,children:T.name},T.name))]})]})]})]})]})},ste=[{id:"group_by_month",label:"Grouping by Month",description:"Groups a date column into YYYY-MM format.",sql:"strftime('%Y-%m', PostingDate) as Month",category:"date"},{id:"sum_currency",label:"Sum with Currency",description:"Sums a column and rounds to 2 decimal places.",sql:"ROUND(SUM(Amount), 2) as Total",category:"aggregation"},{id:"case_when",label:"Conditional Metric (Case When)",description:"Creates a metric based on a condition.",sql:"SUM(CASE WHEN Category = 'Licenses' THEN Amount ELSE 0 END) as LicenseCosts",category:"advanced"},{id:"perc_total",label:"Percentage of Total (Window)",description:"Calculates percentage of the total column.",sql:"Amount * 100.0 / SUM(Amount) OVER() as SharePercent",category:"advanced"},{id:"format_eur",label:"Format as EUR String",description:"Formats a number with  suffix.",sql:"printf('%.2f ', Amount) as FormattedPrice",category:"formatting"}],ite=({onSelectSnippet:e,tableName:t,columns:r})=>{const{t:a}=tn(),[n,s]=X.useState(!1),[l,A]=X.useState(""),[u,f]=X.useState(null),h=[{id:"schema",label:a("sql_assistant.cat_schema","Schema"),icon:c.jsx(_i,{className:"w-3.5 h-3.5"})},{id:"date",label:a("sql_assistant.cat_date","Dates"),icon:c.jsx(m2,{className:"w-3.5 h-3.5"})},{id:"aggregation",label:a("sql_assistant.cat_aggregation","Aggregations"),icon:c.jsx(j8,{className:"w-3.5 h-3.5"})},{id:"formatting",label:a("sql_assistant.cat_formatting","Formatting"),icon:c.jsx(US,{className:"w-3.5 h-3.5"})},{id:"advanced",label:a("sql_assistant.cat_advanced","Advanced"),icon:c.jsx(f2,{className:"w-3.5 h-3.5"})}],m=[...t?[{id:"schema-select-all",label:`Select All from ${t}`,description:"Basic select all from the current table",sql:`SELECT * FROM ${t} LIMIT 10`,category:"schema"},{id:"schema-count",label:`Count Rows in ${t}`,description:"Simple row count",sql:`SELECT COUNT(*) as total FROM ${t}`,category:"schema"},...r&&r.length>0?[{id:"schema-select-cols",label:"Select Columns",description:`Select specific columns from ${t}`,sql:`SELECT ${r.slice(0,3).map(w=>w.name).join(", ")} FROM ${t} LIMIT 10`,category:"schema"},{id:"schema-group",label:"Group by First Column",description:`Aggregation group by ${r[0].name}`,sql:`SELECT ${r[0].name}, COUNT(*) as count FROM ${t} GROUP BY ${r[0].name} ORDER BY count DESC`,category:"schema"}]:[]]:[],...ste].filter(w=>{const v=w.label.toLowerCase().includes(l.toLowerCase())||w.description.toLowerCase().includes(l.toLowerCase()),B=!u||w.category===u;return v&&B});return c.jsxs("div",{className:"relative",children:[c.jsxs("button",{onClick:()=>{s(!n),!n&&t&&f("schema")},className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-bold transition-all ${n?"bg-blue-600 text-white shadow-lg shadow-blue-200":"bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-700"}`,children:[c.jsx(D8,{className:`w-3.5 h-3.5 ${n?"animate-pulse":""}`}),a("sql_assistant.title","Assistant"),t&&c.jsx("span",{className:"ml-1 px-1 bg-blue-500/20 text-[8px] rounded uppercase",children:t})]}),n&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>s(!1)}),c.jsxs("div",{className:"absolute right-0 top-full mt-2 w-80 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl shadow-2xl z-50 overflow-hidden animate-in zoom-in-95 duration-200 origin-top-right",children:[c.jsx("div",{className:"p-3 border-b border-slate-100 dark:border-slate-800 bg-slate-50 dark:bg-slate-800/50",children:c.jsxs("div",{className:"relative",children:[c.jsx(fo,{className:"absolute left-2.5 top-2.5 w-3.5 h-3.5 text-slate-400"}),c.jsx("input",{autoFocus:!0,placeholder:a("sql_assistant.search","Search patterns..."),className:"w-full pl-8 pr-3 py-1.5 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-xs outline-none focus:ring-1 focus:ring-blue-500",value:l,onChange:w=>A(w.target.value)})]})}),c.jsxs("div",{className:"flex bg-slate-50/50 dark:bg-slate-800/30 border-b border-slate-100 dark:border-slate-800",children:[c.jsx("button",{onClick:()=>f(null),className:`flex-1 py-2 text-[10px] font-black uppercase transition-colors ${u?"text-slate-400 hover:text-slate-600":"text-blue-600 border-b-2 border-blue-600"}`,children:a("common.all","All")}),h.map(w=>c.jsx("button",{onClick:()=>f(w.id),className:`flex-1 py-2 text-[10px] font-black uppercase transition-colors flex items-center justify-center gap-1 ${u===w.id?"text-blue-600 border-b-2 border-blue-600":"text-slate-400 hover:text-slate-600"}`,title:w.label,children:w.icon},w.id))]}),c.jsxs("div",{className:"max-h-64 overflow-y-auto custom-scrollbar",children:[m.map(w=>c.jsxs("button",{onClick:()=>{e(w.sql),s(!1)},className:"w-full text-left p-3 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors border-b border-slate-50 dark:border-slate-800/50 last:border-0 group",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsx("span",{className:"text-[11px] font-bold text-slate-700 dark:text-slate-200",children:w.label}),c.jsx(Ul,{className:"w-3 h-3 text-slate-300 group-hover:text-blue-500 transform group-hover:translate-x-0.5 transition-all"})]}),c.jsx("p",{className:"text-[10px] text-slate-500 dark:text-slate-400 leading-relaxed",children:w.description}),c.jsx("code",{className:"block mt-2 p-1.5 bg-slate-100 dark:bg-slate-950 rounded text-[9px] font-mono text-slate-400 dark:text-slate-500 truncate",children:w.sql})]},w.id)),m.length===0&&c.jsxs("div",{className:"p-8 text-center text-slate-400",children:[c.jsx(fo,{className:"w-8 h-8 mx-auto mb-2 opacity-20"}),c.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest",children:a("sql_assistant.no_results","No matches")})]})]}),c.jsx("div",{className:"p-2 border-top border-slate-100 dark:border-slate-800 bg-slate-50 dark:bg-slate-800/50 flex justify-center",children:c.jsx("span",{className:"text-[9px] font-medium text-slate-400 italic",children:a("sql_assistant.hint","Click to insert into editor")})})]})]})]})},s2=({data:e,rows:t,cols:r,measures:a})=>{const{t:n}=tn(),s=X.useMemo(()=>{if(!e||e.length===0||a.length===0)return null;const l=new Set,A=new Set,u={};e.forEach(x=>{const m=t.map(v=>String(x[v]??"")).join(" | "),w=r.map(v=>String(x[v]??"")).join(" | ");l.add(m),A.add(w),u[m]||(u[m]={}),u[m][w]||(u[m][w]={}),a.forEach(v=>{u[m][w][v.field]||(u[m][w][v.field]=[]);const B=Number(x[v.field]);isNaN(B)?v.agg==="count"&&u[m][w][v.field].push(1):u[m][w][v.field].push(B)})});const f=Array.from(l).sort(),h=Array.from(A).sort(),g={};return f.forEach(x=>{g[x]={},h.forEach(m=>{g[x][m]={},a.forEach(w=>{const v=u[x]?.[m]?.[w.field]||[];let B=0;if(v.length>0)switch(w.agg){case"sum":B=v.reduce((k,N)=>k+N,0);break;case"count":B=v.length;break;case"avg":B=v.reduce((k,N)=>k+N,0)/v.length;break;case"min":B=Math.min(...v);break;case"max":B=Math.max(...v);break}g[x][m][w.field]=B})})}),{rowLabels:f,colLabels:h,values:g}},[e,t,r,a]);return s?c.jsx("div",{className:"w-full h-full overflow-auto bg-white dark:bg-slate-900 shadow-inner rounded-lg border border-slate-200 dark:border-slate-700",children:c.jsxs("table",{className:"min-w-full text-xs border-collapse",children:[c.jsxs("thead",{className:"sticky top-0 z-20 bg-slate-50 dark:bg-slate-800 border-b border-slate-300 dark:border-slate-700",children:[c.jsxs("tr",{children:[c.jsx("th",{colSpan:t.length,className:"p-2 border border-slate-300 dark:border-slate-700 font-bold bg-slate-100 dark:bg-slate-800 text-slate-500 uppercase tracking-wider",children:t.join(" / ")}),s.colLabels.map(l=>c.jsx("th",{colSpan:a.length,className:"p-2 border border-slate-300 dark:border-slate-700 font-bold text-center bg-blue-50/50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300",children:l||"--"},l))]}),a.length>1&&c.jsxs("tr",{children:[c.jsx("th",{colSpan:t.length,className:"border border-slate-300 dark:border-slate-700"}),s.colLabels.map(l=>a.map(A=>c.jsxs("th",{className:"p-1 border border-slate-300 dark:border-slate-700 text-[10px] text-slate-400 font-medium",children:[A.field," (",n(`querybuilder.pivot_agg_${A.agg}`),")"]},`${l}-${A.field}`)))]}),a.length===1&&c.jsxs("tr",{children:[c.jsx("th",{colSpan:t.length,className:"border border-slate-300 dark:border-slate-700"}),s.colLabels.map(l=>c.jsx("th",{className:"p-1 border border-slate-300 dark:border-slate-700 text-[10px] text-slate-400 font-medium italic",children:n(`querybuilder.pivot_agg_${a[0].agg}`)},`measure-${l}`))]})]}),c.jsx("tbody",{children:s.rowLabels.map((l,A)=>c.jsxs("tr",{className:A%2===0?"bg-white dark:bg-slate-900":"bg-slate-50/30 dark:bg-slate-800/20",children:[l.split(" | ").map((u,f)=>c.jsx("td",{className:"p-2 border border-slate-200 dark:border-slate-800 font-medium text-slate-700 dark:text-slate-300 whitespace-nowrap",children:u},f)),s.colLabels.map(u=>a.map(f=>{const h=s.values[l][u][f.field];return c.jsx("td",{className:"p-2 border border-slate-200 dark:border-slate-800 text-right font-mono tabular-nums",children:Ia(h,f.field)},`${u}-${f.field}`)}))]},l))})]})}):c.jsx("div",{className:"p-8 text-center text-slate-400 italic",children:n("common.no_data")})},lS="SELECT * FROM sqlite_master LIMIT 10",Zn=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8","#82ca9d"],lte=fA("QueryBuilderView"),ote=()=>{const{t:e}=tn(),[t,r]=X.useState(lS),[a,n]=X.useState([]),[s,l]=X.useState(""),[A,u]=X.useState(!1),[f,h]=X.useState(""),[g,x]=X.useState(0),[m,w]=X.useState(""),[v,B]=X.useState(()=>localStorage.getItem("query_builder_default_mode")==="sql"?"sql":"visual"),[k,N]=X.useState("query"),[S,O]=X.useState("new"),[T,U]=X.useState(!1),[D,H]=X.useState(1),[j,W]=hr("query_builder_config",void 0),[I]=hr("query_builder_sql_editor_height",384),[Q,Y]=X.useState("table"),[z,ue]=X.useState({type:"table",color:"#3b82f6"}),[Z,Ae]=X.useState(null),[ve,G]=X.useState(!1),[Se,we]=X.useState(""),[F,R]=X.useState(""),[M,P]=X.useState(!1),[re,ge]=X.useState(0),[Ce,de]=X.useState(null),{isExporting:be,exportToPdf:Le}=Sy(),{togglePresentationMode:ie,isReadOnly:_e,isAdminMode:je}=Mo(),{data:J,refresh:ze}=ri(async()=>await Dt.getUserWidgets(),[]);X.useEffect(()=>{const K=j?.table;if(!K){de(null);return}Dt.getTableSchema(K).then(se=>{if(se&&se.length>0){const Fe={title:`Tabelle: ${K}`,description:`Automatisch generiertes Schema fr die Tabelle "${K}".`,type:"object",properties:se.reduce((Re,Qe)=>(Re[Qe.name]={type:Qe.type.toLowerCase().includes("int")||Qe.type.toLowerCase().includes("real")?"number":"string",description:`Feld: ${Qe.name} (Typ: ${Qe.type})`},Re),{})};de(Fe)}})},[j?.table]);const He=X.useCallback(async K=>{u(!0),l("");try{const se=K||t,Fe=await Dt.executeRaw(se);if(n(Fe),h(se),Fe.length>0){const Re=Object.keys(Fe[0]).filter(Pe=>typeof Fe[0][Pe]=="number"),Qe=Object.keys(Fe[0]).filter(Pe=>typeof Fe[0][Pe]=="string");z.xAxis||ue(Pe=>({...Pe,xAxis:Qe[0]||Object.keys(Fe[0])[0],yAxes:Pe.yAxes?.length?Pe.yAxes:Re.length>0?[Re[0]]:[]}))}return!0}catch(se){return l(se instanceof Error?se.message:String(se)),!1}finally{u(!1)}},[t,z.xAxis]),ct=K=>{let se={type:"table",color:"#3b82f6"},Fe="table",Re="sql",Qe;const Pe=(K.sql_query||"").trim()||lS;Ae(K.id),we(K.name),r(Pe),h(""),n([]),l(""),W(void 0),B("sql"),Y("table"),ue({type:"table",color:"#3b82f6"});try{const qe=JSON.parse(K.visualization_config);if(se=qe,Fe=qe.type||"table",Y(Fe),ue(se),K.visual_builder_config){const pt=JSON.parse(K.visual_builder_config);Qe=pt,Re="visual",W(pt),B(Re)}else Re="sql",Qe=void 0,B(Re),W(void 0)}catch(qe){lte.error("Error parsing widget config",qe)}N("query"),O("existing"),Fe==="text"?(r(""),h(""),B("visual"),W(void 0),H(3)):(r(Pe),H(2),setTimeout(()=>He(Pe),100)),N("query"),w(Nt({currentSql:Fe==="text"?"":Pe,currentBuilderMode:Re,currentQueryConfig:Fe==="text"?void 0:Qe,currentVisType:Fe,currentVisConfig:se,currentWidgetName:K.name,currentActiveWidgetId:K.id}))},Xe=async()=>{if(!(!Se||_e)){try{const K={id:Z||crypto.randomUUID(),name:Se,description:"",sql_query:t,visualization_config:{...z,type:Q},visual_builder_config:v==="visual"?j:null};await Dt.saveUserWidget(K),G(!1),Z||we(""),ze(),Ae(K.id),w(Nt({currentSql:K.sql_query,currentBuilderMode:v,currentQueryConfig:v==="visual"?j:void 0,currentVisType:Q,currentVisConfig:{...z,type:Q},currentWidgetName:K.name,currentActiveWidgetId:K.id}))}catch(K){await Xt.error(e("querybuilder.error_save")+(K instanceof Error?K.message:String(K)));return}await Xt.info(e(Z?"querybuilder.success_update":"querybuilder.success_save"))}},Ut=async K=>{if(_e)return;(!(localStorage.getItem("notifications_confirm_destructive")!=="false")||await Xt.confirm(e("dashboard.confirm_delete_report")))&&(await Dt.deleteUserWidget(K),ze(),Z===K&&(Ae(null),we("")))},yt=X.useMemo(()=>a.length===0?[]:Object.keys(a[0]).map(K=>({header:K,accessor:K,render:se=>Ia(se[K],K)})),[a]),qt=X.useMemo(()=>{const K=J||[],se=F.trim().toLowerCase();return se?K.filter(Fe=>Fe.name.toLowerCase().includes(se)||(Fe.sql_query||"").toLowerCase().includes(se)):K},[J,F]),Lt=a.length>0?Object.keys(a[0]):[],jt=X.useMemo(()=>a.length===0?[]:Lt.filter(K=>a.some(se=>se[K]!==null&&se[K]!==void 0&&typeof se[K]=="number")),[a,Lt]),Pt=Q==="text",zt=z.xAxis||"",Jt=(z.yAxes||[])[0]||"",It=X.useMemo(()=>Q!=="scatter"||!zt||!Jt?[]:a.map(K=>{const se=Number(K[zt]),Fe=Number(K[Jt]);return{...K,[zt]:se,[Jt]:Fe}}).filter(K=>Number.isFinite(K[zt])&&Number.isFinite(K[Jt])),[a,zt,Jt,Q]),xt=D===2&&!Pt?"table":Q,ht=Pt||a.length>0,Bt=be||!Pt&&a.length===0,pr=!ht||_e,$t=be?e("common.exporting"):!Pt&&a.length===0?e("querybuilder.hint_run_query_before_export"):"",Ee={sm:"text-sm",md:"text-base",lg:"text-lg",xl:"text-xl","2xl":"text-2xl"},at=S==="new"||S==="existing"&&!!Z,it=v==="visual"?!!j?.table:t.trim().length>0,bt=Pt||a.length>0&&!s&&f.trim()===t.trim(),Et=X.useMemo(()=>{if(Q==="text")return!!(z.textContent||"").trim();if(Q==="table"||Q==="pivot")return!0;const K=!!z.xAxis,se=!!(z.yAxes&&z.yAxes.length>0);if(!K||!se)return!1;if(Q==="scatter"){const Re=jt.includes(zt),Qe=jt.includes(Jt);return Re&&Qe&&It.length>0}return Q==="kpi"?a.length>0:a.some(Re=>{const Qe=Re[z.xAxis];return Qe==null||Qe===""?!1:(z.yAxes||[]).some(Pe=>{const qe=Re[Pe];return qe!=null&&qe!==""})})},[Q,z,jt,It.length,zt,Jt,a]),mt=!Pt&&a.length>0&&xt!=="table"&&xt!=="pivot"&&!Et,Ot=at?Pt?Et?4:3:!it||!bt?2:Et?4:3:1,Ur=K=>Pt&&K===2?!1:K<=Ot,Vt=A||(D===1?!at:D===2?Pt?!1:!it||!bt:D===3?!Et:pr),tt=D>=4?e("querybuilder.finish"):e("querybuilder.next"),Wt=D===2||D===3,Me=A||(D===2?Pt||!it:D!==3),kt=e(A?"common.loading":"querybuilder.apply"),Tt=k,ir=D===4&&Tt==="query",Nt=X.useCallback(K=>JSON.stringify({sql:(K?.currentSql??t).trim(),builderMode:K?.currentBuilderMode??v,queryConfig:K?.currentQueryConfig??j??null,visType:K?.currentVisType??Q,visConfig:K?.currentVisConfig??z,widgetName:(K?.currentWidgetName??Se).trim(),activeWidgetId:K?.currentActiveWidgetId??Z}),[t,v,j,Q,z,Se,Z]),Sr=X.useMemo(()=>Nt(),[Nt]),ca=m.length>0&&Sr!==m,Hr={1:e("querybuilder.step_start"),2:e("querybuilder.step_source_run"),3:e("querybuilder.step_visualize"),4:e("querybuilder.step_finalize")},Br={1:e("querybuilder.step_help_start"),2:e("querybuilder.step_help_source_run"),3:e("querybuilder.step_help_visualize"),4:e("querybuilder.step_help_finalize")},jr=[1,2,3,4],Er=S==="new"&&!Z?e(Pt?"querybuilder.mode_new_text_active":"querybuilder.mode_new_active"):e("querybuilder.mode_editing_active",{name:Se}),ae=X.useMemo(()=>{const K="w-5 h-5";switch(xt){case"table":return{icon:c.jsx(Oc,{className:K}),label:e("querybuilder.table")};case"bar":return{icon:c.jsx(aB,{className:K}),label:e("querybuilder.bar")};case"line":return{icon:c.jsx(rB,{className:K}),label:e("querybuilder.line")};case"text":return{icon:c.jsx(Kg,{className:K}),label:e("querybuilder.text")};default:return{icon:c.jsx(xi,{className:K}),label:xt.toUpperCase()}}},[xt,e]),xe=K=>{Ur(K)&&(H(K),K<=2&&N("query"),K===3&&N("vis"),K===4&&N("query"))},fe=async()=>{if(D===1){if(!at)return;xe(Pt?3:2);return}if(D===2){if(Pt){xe(3);return}if(!it||!bt)return;xe(3);return}if(D===3){if(!Et)return;xe(4);return}D===4&&!pr&&G(!0)},pe=async()=>{if(D===2){if(Pt||!it||A)return;await He();return}D===3&&x(K=>K+1)};return X.useEffect(()=>{m||w(Sr)},[m,Sr]),X.useEffect(()=>{const K=se=>{ca&&(se.preventDefault(),se.returnValue="")};return window.addEventListener("beforeunload",K),()=>window.removeEventListener("beforeunload",K)},[ca]),X.useEffect(()=>{H(K=>K>Ot?Ot:K)},[Ot]),X.useEffect(()=>{if(Q!=="scatter"||jt.length===0)return;const K=z.xAxis||"",se=(z.yAxes||[])[0]||"",Fe=jt.includes(K),Re=jt.includes(se);if(Fe&&Re)return;const Qe=Fe?K:jt[0],Pe=jt[1]||jt[0],qe=Re?se:Pe;ue(pt=>({...pt,xAxis:Qe,yAxes:qe?[qe]:[]}))},[Q,jt,z.xAxis,z.yAxes]),X.useEffect(()=>{const K=se=>{if(!(se.ctrlKey||se.metaKey))return;const Re=se.key.toLowerCase();Re==="enter"&&(se.preventDefault(),A||He()),Re==="s"&&(se.preventDefault(),pr||G(!0))};return window.addEventListener("keydown",K),()=>window.removeEventListener("keydown",K)},[A,pr,He]),c.jsxs(t0,{header:{title:e("sidebar.query_builder"),subtitle:e("querybuilder.subtitle"),actions:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:ie,className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors border border-transparent hover:border-blue-100",title:e("dashboard.presentation_mode"),children:c.jsx(Jm,{className:"w-5 h-5"})}),c.jsxs("button",{onClick:()=>Le("query-visualization",`report-${Se||"query"}`),disabled:Bt,title:Bt?$t:e("querybuilder.hint_export_shortcut"),className:"flex items-center gap-2 px-3 py-2 bg-white border border-slate-200 text-slate-600 rounded-lg hover:bg-slate-50 transition-colors shadow-sm font-medium text-sm disabled:opacity-50",children:[c.jsx(jp,{className:"w-4 h-4"}),e(be?"common.exporting":"common.export_pdf")]})]})},children:[c.jsx("div",{className:"flex flex-col gap-6 h-full min-h-0",children:c.jsxs("div",{className:"flex-1 flex flex-col lg:flex-row gap-4 lg:gap-6 min-h-0 overflow-hidden relative",children:[c.jsx("div",{className:`${T?"hidden":"w-full lg:w-96"} min-h-0 overflow-hidden transition-all duration-300`,children:c.jsxs("div",{className:"flex flex-col h-full max-h-[46vh] lg:max-h-none bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm overflow-hidden",children:[c.jsxs("div",{className:"border-b border-slate-100 dark:border-slate-800 bg-slate-50/50 dark:bg-slate-900/50",children:[c.jsx("div",{className:"p-3",children:c.jsx("h3",{className:"text-[10px] font-black text-slate-400 uppercase tracking-wider px-1",children:e("querybuilder.guided_panel")})}),c.jsx("div",{className:"border-t border-slate-100 dark:border-slate-800 px-3 pt-2 pb-2",children:c.jsx("div",{className:"grid grid-cols-4 gap-1",children:jr.map(K=>c.jsx("button",{onClick:()=>xe(K),disabled:!Ur(K),className:`px-1 py-1.5 rounded border text-[9px] font-black uppercase tracking-wide transition-all ${Pt&&K===2?"bg-slate-100 text-slate-300 border-slate-200":D===K?"bg-blue-50 text-blue-700 border-blue-200 ring-1 ring-blue-100":K<=Ot?"bg-white text-slate-600 border-slate-200":"bg-slate-100 text-slate-400 border-slate-200"} disabled:opacity-50`,children:Hr[K]},K))})}),c.jsx("div",{className:"mt-1 mb-2 px-4 space-y-1",children:c.jsx("p",{className:"text-[10px] text-slate-500 leading-relaxed",children:Br[D]})})]}),c.jsx("div",{className:"px-4 py-2 border-b border-amber-200 bg-amber-50",children:c.jsx("p",{className:"text-[10px] text-amber-800",children:Er})}),c.jsx("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar space-y-4",children:Tt==="query"?c.jsxs("div",{className:"space-y-4",children:[D===1&&c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"space-y-2 animate-in fade-in duration-300",children:[c.jsxs("h3",{className:"text-[10px] font-black uppercase text-slate-400 px-2 py-1 flex items-center justify-between",children:[e("querybuilder.new_report"),c.jsx("span",{className:"bg-slate-100 dark:bg-slate-800 px-1.5 py-0.5 rounded text-[9px]",children:"1"})]}),c.jsxs("button",{onClick:()=>{O("new"),Ae(null),we(""),n([]),l(""),Y("table"),xe(2)},className:`w-full p-3 rounded-lg border flex items-center gap-2 transition-all ${!Pt&&S==="new"&&!Z?"bg-blue-50 border-blue-200 ring-1 ring-blue-100 text-blue-700":"bg-white border-slate-200 text-slate-700 hover:border-blue-200"}`,children:[c.jsx(Kg,{className:"w-4 h-4 flex-shrink-0"}),c.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[c.jsx("div",{className:"flex items-center justify-between gap-2",children:c.jsx("span",{className:"text-sm font-bold truncate",children:e("querybuilder.new_query_card_title")})}),c.jsxs("div",{className:"flex items-center gap-2 text-[10px]",children:[c.jsx("span",{className:"text-slate-400 truncate max-w-[180px] font-mono",children:e("querybuilder.new_query_card_subtitle")}),c.jsx("span",{className:"ml-auto text-blue-400 flex items-center gap-1 font-bold italic",children:e("querybuilder.new_query_card_type")})]})]})]}),c.jsxs("button",{onClick:()=>{O("new"),Ae(null),we(""),n([]),l(""),Y("text"),ue(K=>({...K,type:"text",textContent:K.textContent||""})),xe(3)},className:`w-full p-3 rounded-lg border flex items-center gap-2 transition-all ${Pt&&S==="new"&&!Z?"bg-blue-50 border-blue-200 ring-1 ring-blue-100 text-blue-700":"bg-white border-slate-200 text-slate-700 hover:border-blue-200"}`,children:[c.jsx(Kg,{className:"w-4 h-4 flex-shrink-0"}),c.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[c.jsx("div",{className:"flex items-center justify-between gap-2",children:c.jsx("span",{className:"text-sm font-bold truncate",children:e("querybuilder.new_text_card_title")})}),c.jsxs("div",{className:"flex items-center gap-2 text-[10px]",children:[c.jsx("span",{className:"text-slate-400 truncate max-w-[180px] font-mono",children:e("querybuilder.new_text_card_subtitle")}),c.jsx("span",{className:"ml-auto text-blue-400 flex items-center gap-1 font-bold italic",children:e("querybuilder.new_text_card_type")})]})]})]})]}),c.jsxs("div",{className:"space-y-2 animate-in fade-in duration-300",children:[c.jsxs("h3",{className:"text-[10px] font-black uppercase text-slate-400 px-2 py-1 flex items-center justify-between",children:[e("querybuilder.saved_reports"),c.jsxs("span",{className:"bg-slate-100 dark:bg-slate-800 px-1.5 py-0.5 rounded text-[9px]",children:[qt.length,"/",J?.length||0]})]}),c.jsxs("div",{className:"relative",children:[c.jsx(fo,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-slate-400"}),c.jsx("input",{value:F,onChange:K=>R(K.target.value),placeholder:e("querybuilder.search_saved_reports","Search saved widgets..."),className:"w-full pl-8 pr-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 text-xs text-slate-700 dark:text-slate-200 outline-none focus:ring-2 focus:ring-blue-500"})]}),c.jsxs("div",{className:"space-y-1 max-h-72 overflow-y-auto custom-scrollbar pr-1",children:[qt.map(K=>c.jsxs("div",{className:`group p-2.5 rounded-lg border flex flex-col gap-1 transition-all cursor-pointer ${Z===K.id?"bg-blue-50 border-blue-200 ring-1 ring-blue-100":"bg-white dark:bg-slate-900 border-slate-200 dark:border-slate-800 hover:border-blue-200"}`,onClick:()=>ct(K),children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-200 text-xs truncate",children:K.name}),!_e&&c.jsx("button",{onClick:se=>{se.stopPropagation(),Ut(K.id)},className:"opacity-0 group-hover:opacity-100 p-1 text-slate-400 hover:text-red-500 rounded transition-all",children:c.jsx(ds,{className:"w-3.5 h-3.5"})})]}),c.jsxs("div",{className:"flex items-center gap-2 text-[9px]",children:[c.jsx("span",{className:"text-slate-400 truncate max-w-[150px] font-mono",children:K.sql_query||"-"}),c.jsx("span",{className:"ml-auto text-blue-400 flex items-center gap-1 font-bold italic",children:(()=>{try{return(JSON.parse(K.visualization_config).type||"table").toUpperCase()}catch{return"TABLE"}})()})]})]},K.id)),qt.length===0&&c.jsx("div",{className:"p-3 rounded-lg border border-dashed border-slate-200 text-[11px] text-slate-400 text-center",children:e("querybuilder.no_saved_reports_filtered","No matching widgets found.")})]})]})]}),D===1?null:ir?c.jsxs("div",{className:"p-4 rounded-xl border border-blue-200 bg-blue-50/60 space-y-3",children:[c.jsx("p",{className:"text-[10px] font-black uppercase tracking-wide text-blue-500",children:e("querybuilder.step_finalize")}),c.jsx("p",{className:"text-xs text-slate-700 font-semibold",children:Se||e("querybuilder.new_report")}),c.jsxs("div",{className:"space-y-2 text-[11px]",children:[c.jsxs("div",{className:"rounded-lg border border-blue-100 bg-white px-3 py-2",children:[c.jsx("div",{className:"text-[10px] font-black uppercase tracking-wide text-slate-400",children:e("querybuilder.finalize_mode")}),c.jsx("div",{className:"mt-1 text-slate-700",children:Er})]}),c.jsxs("div",{className:"rounded-lg border border-blue-100 bg-white px-3 py-2",children:[c.jsx("div",{className:"text-[10px] font-black uppercase tracking-wide text-slate-400",children:e("querybuilder.finalize_source")}),c.jsx("div",{className:"mt-1 text-slate-700",children:Pt?e("querybuilder.new_text_card_type"):v==="visual"?j?.table||e("querybuilder.please_select"):e("querybuilder.direct_editor")})]}),c.jsxs("div",{className:"rounded-lg border border-blue-100 bg-white px-3 py-2",children:[c.jsx("div",{className:"text-[10px] font-black uppercase tracking-wide text-slate-400",children:e("querybuilder.finalize_chart")}),c.jsx("div",{className:"mt-1 text-slate-700 font-semibold",children:ae.label}),!Pt&&c.jsx("div",{className:"mt-1 text-[10px] text-slate-500",children:e("querybuilder.finalize_axes",{x:z.xAxis||"-",count:(z.yAxes||[]).length})}),Pt&&c.jsx("div",{className:"mt-1 text-[10px] text-slate-500",children:e("querybuilder.finalize_text_length",{count:(z.textContent||"").trim().length})})]}),c.jsxs("div",{className:"rounded-lg border border-blue-100 bg-white px-3 py-2",children:[c.jsx("div",{className:"text-[10px] font-black uppercase tracking-wide text-slate-400",children:e("querybuilder.preview",{count:a.length})}),c.jsx("div",{className:`mt-1 text-[11px] font-semibold ${mt?"text-amber-700":"text-emerald-700"}`,children:e(mt?"querybuilder.preview_not_renderable_title":"querybuilder.finalize_ready")})]})]}),!_e&&c.jsx("button",{onClick:()=>G(!0),disabled:pr,className:"w-full px-3 py-2 rounded-lg bg-blue-600 text-white text-xs font-bold shadow-sm disabled:opacity-50",children:e(Z?"querybuilder.update_widget":"querybuilder.save_as_widget")})]}):c.jsxs("div",{className:"space-y-0",children:[c.jsxs("div",{className:"overflow-hidden rounded-t-xl border border-b-0 border-slate-200 dark:border-slate-800 bg-slate-50/70 dark:bg-slate-900/40 flex",children:[c.jsxs("button",{onClick:()=>B("visual"),className:`flex-1 flex items-center justify-center gap-2 py-2 text-[10px] font-bold uppercase transition-all border-r border-slate-200 dark:border-slate-800 ${v==="visual"?"bg-blue-50 dark:bg-blue-900/30 text-blue-600":"text-slate-400 hover:text-slate-600 bg-transparent"}`,children:[c.jsx(xi,{className:"w-3.5 h-3.5"})," ",e("querybuilder.visual_builder")]}),c.jsxs("button",{onClick:()=>B("sql"),className:`flex-1 flex items-center justify-center gap-2 py-2 text-[10px] font-bold uppercase transition-all ${v==="sql"?"bg-slate-900 dark:bg-slate-800 text-slate-100":"text-slate-400 hover:text-slate-600 bg-transparent"}`,children:[c.jsx("span",{className:"font-mono text-[10px]",children:"SQL"})," ",e("querybuilder.direct_editor")]})]}),c.jsx("div",{className:"p-4 rounded-b-xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950/30 space-y-2 -mt-px",children:v==="sql"?c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400",children:e("querybuilder.sql_query")}),c.jsx(ite,{tableName:j?.table,columns:a.length>0?Object.keys(a[0]).map(K=>({name:K,type:typeof a[0][K]})):[],onSelectSnippet:K=>r(se=>se+`
`+K)})]}),c.jsx("textarea",{value:t,onChange:K=>r(K.target.value),className:"w-full font-mono text-xs p-3 bg-slate-900 text-slate-100 rounded-lg outline-none resize-none",style:{height:`${Math.max(220,Math.min(700,I))}px`},placeholder:"SELECT * FROM..."})]}):c.jsx(nte,{initialConfig:j,isAdminMode:je,onChange:(K,se)=>{r(K),W(se)}})})]}),s&&c.jsxs("div",{className:"bg-red-50 text-red-600 text-[10px] p-3 rounded-lg border border-red-100 flex items-start gap-2 font-mono break-all",children:[c.jsx(il,{className:"w-3.5 h-3.5 flex-shrink-0 mt-0.5"}),s]})]}):c.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950/30 space-y-4 animate-in slide-in-from-right-4 duration-300",children:[c.jsxs("h3",{className:"text-xs font-black uppercase text-slate-400 flex items-center gap-2",children:[c.jsx(xi,{className:"w-3.5 h-3.5 text-blue-500"}),e("querybuilder.graph_type")]}),c.jsx("div",{className:"grid grid-cols-3 gap-2",children:(Pt?[{id:"text",icon:Kg,label:e("querybuilder.text")}]:[{id:"table",icon:Oc,label:e("querybuilder.table")},{id:"bar",icon:aB,label:e("querybuilder.bar")},{id:"line",icon:rB,label:e("querybuilder.line")},{id:"area",icon:xi,label:e("querybuilder.area")},{id:"pie",icon:xi,label:e("querybuilder.pie")},{id:"kpi",icon:xi,label:e("querybuilder.kpi")},{id:"composed",icon:xi,label:e("querybuilder.composed")},{id:"radar",icon:xi,label:e("querybuilder.radar")},{id:"scatter",icon:xi,label:e("querybuilder.scatter")},{id:"pivot",icon:xi,label:e("querybuilder.pivot")}]).map(K=>c.jsxs("button",{onClick:()=>Y(K.id),className:`p-2 rounded-lg flex flex-col items-center justify-center gap-1 border transition-all ${Q===K.id?"bg-blue-50 dark:bg-blue-900/30 border-blue-200 text-blue-600 shadow-sm":"bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 text-slate-400 hover:border-slate-300"}`,children:[c.jsx(K.icon,{className:"w-4 h-4"}),c.jsx("span",{className:"text-[9px] uppercase font-black",children:K.label})]},K.id))}),Q!=="table"&&Q!=="pivot"&&Q!=="text"&&c.jsxs("div",{className:"flex items-center justify-between rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[c.jsxs("span",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:[e("querybuilder.labels"),":"]}),c.jsx("button",{onClick:()=>ue({...z,showLabels:!z.showLabels}),className:`px-2 py-0.5 rounded text-[10px] font-black uppercase transition-all ${z.showLabels?"bg-blue-600 text-white":"bg-slate-200 text-slate-500"}`,children:z.showLabels?e("querybuilder.label_on"):e("querybuilder.label_off")})]}),Q!=="table"&&Q!=="pivot"&&a.length>0&&c.jsxs("div",{className:"space-y-4 pt-4 border-t border-slate-100 dark:border-slate-800 animate-in slide-in-from-top-2 duration-300",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.x_axis")}),c.jsxs("select",{value:z.xAxis||"",onChange:K=>ue({...z,xAxis:K.target.value}),className:"w-full p-2 border border-slate-200 rounded text-[11px] bg-white outline-none",children:[c.jsx("option",{value:"",children:e("querybuilder.select_column")}),(Q==="scatter"?jt:Lt).map(K=>c.jsx("option",{value:K,children:K},K))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.y_axes")}),c.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:(z.yAxes||[]).map(K=>c.jsxs("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 rounded text-[10px] font-bold flex items-center gap-1",children:[K,c.jsx("button",{onClick:()=>ue({...z,yAxes:(z.yAxes||[]).filter(se=>se!==K)}),children:c.jsx(nl,{className:"w-2.5 h-2.5"})})]},K))}),c.jsxs("select",{onChange:K=>{K.target.value&&(ue({...z,yAxes:[...z.yAxes||[],K.target.value]}),K.target.value="")},className:"w-full p-2 border border-slate-200 rounded text-[11px] bg-white outline-none",children:[c.jsx("option",{value:"",children:e("querybuilder.add_y_axis")}),(Q==="scatter"?jt:Lt).filter(K=>!(z.yAxes||[]).includes(K)).map(K=>c.jsx("option",{value:K,children:K},K))]})]})]}),Q==="text"&&c.jsxs("div",{className:"space-y-4 pt-4 border-t border-slate-100 dark:border-slate-800 animate-in slide-in-from-top-2 duration-300",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.text_content")}),c.jsx("textarea",{value:z.textContent||"",onChange:K=>ue({...z,textContent:K.target.value}),className:"w-full h-32 p-2 border border-slate-200 rounded text-[11px] bg-white outline-none resize-y",placeholder:e("querybuilder.text_placeholder")})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.text_size")}),c.jsxs("select",{value:z.textSize||"md",onChange:K=>ue({...z,textSize:K.target.value}),className:"w-full p-2 border border-slate-200 rounded text-[11px] bg-white outline-none",children:[c.jsx("option",{value:"sm",children:e("querybuilder.text_size_sm")}),c.jsx("option",{value:"md",children:e("querybuilder.text_size_md")}),c.jsx("option",{value:"lg",children:e("querybuilder.text_size_lg")}),c.jsx("option",{value:"xl",children:e("querybuilder.text_size_xl")}),c.jsx("option",{value:"2xl",children:e("querybuilder.text_size_2xl")})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.text_align")}),c.jsxs("select",{value:z.textAlign||"left",onChange:K=>ue({...z,textAlign:K.target.value}),className:"w-full p-2 border border-slate-200 rounded text-[11px] bg-white outline-none",children:[c.jsx("option",{value:"left",children:e("querybuilder.text_align_left")}),c.jsx("option",{value:"center",children:e("querybuilder.text_align_center")}),c.jsx("option",{value:"right",children:e("querybuilder.text_align_right")})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.text_style")}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:()=>ue({...z,textBold:!z.textBold}),className:`px-2 py-1 rounded border text-[11px] font-bold ${z.textBold?"bg-blue-50 border-blue-200 text-blue-700":"bg-white border-slate-200 text-slate-500"}`,children:e("querybuilder.text_bold")}),c.jsx("button",{onClick:()=>ue({...z,textItalic:!z.textItalic}),className:`px-2 py-1 rounded border text-[11px] italic ${z.textItalic?"bg-blue-50 border-blue-200 text-blue-700":"bg-white border-slate-200 text-slate-500"}`,children:e("querybuilder.text_italic")}),c.jsx("button",{onClick:()=>ue({...z,textUnderline:!z.textUnderline}),className:`px-2 py-1 rounded border text-[11px] underline ${z.textUnderline?"bg-blue-50 border-blue-200 text-blue-700":"bg-white border-slate-200 text-slate-500"}`,children:e("querybuilder.text_underline")})]})]})]}),Q==="pivot"&&a.length>0&&c.jsxs("div",{className:"space-y-4 pt-4 border-t border-slate-100 dark:border-slate-800 animate-in slide-in-from-top-2 duration-300",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.pivot_rows")}),c.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:(z.pivotRows||[]).map(K=>c.jsxs("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 rounded text-[10px] font-bold flex items-center gap-1",children:[K,c.jsx("button",{onClick:()=>ue({...z,pivotRows:(z.pivotRows||[]).filter(se=>se!==K)}),children:c.jsx(nl,{className:"w-2.5 h-2.5"})})]},K))}),c.jsxs("select",{onChange:K=>{K.target.value&&(ue({...z,pivotRows:[...z.pivotRows||[],K.target.value]}),K.target.value="")},className:"w-full p-2 border border-slate-200 rounded text-[11px] bg-white outline-none",children:[c.jsx("option",{value:"",children:e("querybuilder.pivot_add_row")}),Lt.filter(K=>!(z.pivotRows||[]).includes(K)).map(K=>c.jsx("option",{value:K,children:K},K))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-1",children:e("querybuilder.pivot_cols")}),c.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:(z.pivotCols||[]).map(K=>c.jsxs("span",{className:"px-2 py-0.5 bg-emerald-100 text-emerald-700 rounded text-[10px] font-bold flex items-center gap-1",children:[K,c.jsx("button",{onClick:()=>ue({...z,pivotCols:(z.pivotCols||[]).filter(se=>se!==K)}),children:c.jsx(nl,{className:"w-2.5 h-2.5"})})]},K))}),c.jsxs("select",{onChange:K=>{K.target.value&&(ue({...z,pivotCols:[...z.pivotCols||[],K.target.value]}),K.target.value="")},className:"w-full p-2 border border-slate-200 rounded text-[11px] bg-white outline-none",children:[c.jsx("option",{value:"",children:e("querybuilder.pivot_add_col")}),Lt.filter(K=>!(z.pivotCols||[]).includes(K)).map(K=>c.jsx("option",{value:K,children:K},K))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-left text-[10px] font-black uppercase text-slate-400 mb-2",children:e("querybuilder.pivot_measures")}),c.jsxs("div",{className:"space-y-2",children:[(z.pivotMeasures||[]).map((K,se)=>c.jsxs("div",{className:"flex items-center gap-1 bg-slate-50 dark:bg-slate-800/50 p-2 rounded border border-slate-100",children:[c.jsx("span",{className:"text-[10px] font-bold text-slate-600 truncate flex-1",children:K.field}),c.jsxs("select",{value:K.agg,onChange:Fe=>{const Re=[...z.pivotMeasures||[]],Qe=Fe.target.value;Re[se]={...K,agg:Qe},ue({...z,pivotMeasures:Re})},className:"bg-transparent text-[10px] font-bold text-blue-600 outline-none",children:[c.jsx("option",{value:"sum",children:e("querybuilder.pivot_agg_sum")}),c.jsx("option",{value:"count",children:e("querybuilder.pivot_agg_count")}),c.jsx("option",{value:"avg",children:e("querybuilder.pivot_agg_avg")}),c.jsx("option",{value:"min",children:e("querybuilder.pivot_agg_min")}),c.jsx("option",{value:"max",children:e("querybuilder.pivot_agg_max")})]}),c.jsx("button",{onClick:()=>ue({...z,pivotMeasures:(z.pivotMeasures||[]).filter((Fe,Re)=>Re!==se)}),className:"text-slate-300 hover:text-red-500",children:c.jsx(nl,{className:"w-3"})})]},se)),c.jsxs("select",{onChange:K=>{K.target.value&&(ue({...z,pivotMeasures:[...z.pivotMeasures||[],{field:K.target.value,agg:"sum"}]}),K.target.value="")},className:"w-full p-2 border border-slate-200 rounded text-[11px] bg-white outline-none",children:[c.jsx("option",{value:"",children:e("querybuilder.pivot_add_measure")}),Lt.map(K=>c.jsx("option",{value:K,children:K},K))]})]})]})]}),Q==="kpi"&&a.length>0&&c.jsxs("div",{className:"space-y-4 pt-4 border-t border-slate-100 dark:border-slate-800 animate-in slide-in-from-top-2 duration-300",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h4",{className:"text-[10px] font-black uppercase text-slate-400",children:e("querybuilder.kpi_rules")}),c.jsxs("button",{onClick:()=>ue({...z,rules:[...z.rules||[],{operator:">",value:0,color:"green"}]}),className:"p-1 px-2 bg-blue-50 text-blue-600 rounded text-[9px] font-bold hover:bg-blue-100 transition-colors",children:["+ ",e("querybuilder.add_rule")]})]}),c.jsx("div",{className:"space-y-2",children:(z.rules||[]).map((K,se)=>c.jsxs("div",{className:"flex items-center gap-1.5 p-2 bg-slate-50 dark:bg-slate-800/50 rounded-lg border border-slate-100 dark:border-slate-800",children:[c.jsxs("select",{value:K.operator,onChange:Fe=>{const Re=[...z.rules||[]],Qe=Fe.target.value;Re[se]={...K,operator:Qe},ue({...z,rules:Re})},className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded p-1 text-[10px] outline-none",children:[c.jsx("option",{value:">",children:">"}),c.jsx("option",{value:"<",children:"<"}),c.jsx("option",{value:">=",children:">="}),c.jsx("option",{value:"<=",children:"<="}),c.jsx("option",{value:"==",children:"=="})]}),c.jsx("input",{type:"number",value:K.value,onChange:Fe=>{const Re=[...z.rules||[]];Re[se]={...K,value:Number(Fe.target.value)},ue({...z,rules:Re})},className:"w-16 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded p-1 text-[10px] outline-none"}),c.jsx("div",{className:"flex gap-1",children:["green","yellow","red","blue"].map(Fe=>c.jsx("button",{onClick:()=>{const Re=[...z.rules||[]];Re[se]={...K,color:Fe},ue({...z,rules:Re})},className:`w-4 h-4 rounded-full border-2 ${K.color===Fe?"border-slate-400 scale-110":"border-transparent opacity-40 hover:opacity-100"}`,style:{backgroundColor:Fe==="green"?"#10b981":Fe==="red"?"#f43f5e":Fe==="yellow"?"#fbbf24":"#3b82f6"}},Fe))}),c.jsx("button",{onClick:()=>ue({...z,rules:(z.rules||[]).filter((Fe,Re)=>Re!==se)}),className:"ml-auto text-slate-300 hover:text-red-500",children:c.jsx(nl,{className:"w-3.5 h-3.5"})})]},se))})]})]})}),c.jsx("div",{className:"sticky bottom-0 z-20 border-t border-slate-200 bg-white/95 backdrop-blur px-4 py-3 shadow-[0_-6px_18px_-14px_rgba(15,23,42,0.5)]",children:c.jsx("div",{className:"flex items-center justify-center gap-3",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:()=>{const K=Pt&&D===3?1:Math.max(1,D-1);xe(K)},disabled:D<=1,className:"px-3 py-2 rounded-lg border border-slate-200 text-xs font-bold text-slate-500 disabled:opacity-40",children:e("querybuilder.back")}),Wt&&c.jsx("button",{onClick:()=>{pe()},disabled:Me,className:"px-4 py-2 rounded-lg border border-blue-200 bg-blue-50 text-blue-700 text-xs font-bold disabled:opacity-40",children:kt}),c.jsx("button",{onClick:()=>{fe()},disabled:Vt,className:"px-4 py-2 rounded-lg bg-blue-600 text-white text-xs font-bold shadow-sm disabled:opacity-40",children:tt})]})})})]})}),c.jsxs("div",{id:"query-visualization",className:"flex-1 min-w-0 bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm overflow-hidden flex flex-col h-full min-h-[320px] sm:min-h-[380px] lg:min-h-[460px] relative",children:[c.jsxs("div",{className:"p-3 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center bg-slate-50/50 dark:bg-slate-900/50",children:[c.jsx("h3",{className:"text-[10px] font-black text-slate-400 uppercase tracking-wider",children:e("querybuilder.preview",{count:a.length})}),c.jsxs("button",{onClick:()=>U(!T),className:"p-1.5 hover:bg-slate-200 dark:hover:bg-slate-800 rounded-md text-slate-400 transition-all flex items-center gap-1.5 shadow-sm bg-white dark:bg-slate-800 border border-slate-100 dark:border-slate-700",children:[T?c.jsx(h2,{className:"w-3.5 h-3.5"}):c.jsx(Jm,{className:"w-3.5 h-3.5"}),c.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest",children:e(T?"querybuilder.centered":"querybuilder.focus")})]})]}),c.jsx("div",{className:"flex-1 overflow-auto p-4 min-h-0 container-scrollbar",children:!Pt&&a.length===0?c.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-slate-300",children:[c.jsx(Zd,{className:"w-12 h-12 mb-4 opacity-10"}),c.jsx("p",{className:"text-xs font-black uppercase tracking-widest text-center whitespace-pre-wrap",children:e("querybuilder.no_data_prompt")})]}):c.jsx("div",{className:"h-full min-h-[260px] w-full flex flex-col",children:xt==="text"?c.jsx("div",{className:`flex-1 p-6 whitespace-pre-wrap break-words text-slate-800 dark:text-slate-100 ${Ee[z.textSize||"md"]} ${z.textBold?"font-bold":"font-normal"} ${z.textItalic?"italic":"not-italic"} ${z.textUnderline?"underline":"no-underline"} ${z.textAlign==="center"?"text-center":z.textAlign==="right"?"text-right":"text-left"}`,children:(z.textContent||"").trim()||e("querybuilder.text_placeholder")}):xt==="table"?c.jsx(hy,{columns:yt,data:a,onRowClick:K=>{ge(a.indexOf(K)),P(!0)}}):xt==="pivot"?c.jsx(s2,{data:a,rows:z.pivotRows||[],cols:z.pivotCols||[],measures:z.pivotMeasures||[]}):mt?c.jsx("div",{className:"flex-1 flex items-center justify-center p-6",children:c.jsx("div",{className:"max-w-md w-full rounded-xl border border-amber-200 bg-amber-50 text-amber-900 px-4 py-4",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("div",{className:"mt-0.5 text-amber-600",children:ae.icon}),c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"text-xs font-black uppercase tracking-wide text-amber-700",children:ae.label}),c.jsx("p",{className:"text-sm font-bold mt-1",children:e("querybuilder.preview_not_renderable_title")}),c.jsx("p",{className:"text-xs text-amber-800/90 mt-1",children:e("querybuilder.preview_not_renderable_hint")})]})]})})}):xt==="kpi"?(()=>{const K=a[0][Object.keys(a[0])[0]],se=Number(K);let Fe="text-slate-900 dark:text-white";if(z.rules&&!isNaN(se))for(const Re of z.rules){let Qe=!1;switch(Re.operator){case">":Qe=se>Re.value;break;case"<":Qe=se<Re.value;break;case">=":Qe=se>=Re.value;break;case"<=":Qe=se<=Re.value;break;case"==":Qe=se===Re.value;break}if(Qe){Re.color==="green"?Fe="text-emerald-500":Re.color==="red"?Fe="text-rose-500":Re.color==="yellow"?Fe="text-amber-500":Re.color==="blue"&&(Fe="text-blue-500");break}}return c.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-8 animate-in zoom-in-95 duration-500",children:[c.jsx("div",{className:`text-6xl lg:text-8xl font-black tracking-widest break-all transition-colors duration-300 ${Fe}`,children:Ia(K,Object.keys(a[0])[0])}),c.jsx("div",{className:"text-xs font-bold text-slate-400 mt-6 uppercase tracking-[0.4em] font-mono",children:(z.yAxes||[])[0]||Object.keys(a[0])[0]})]})})():c.jsx("div",{className:"flex-1 min-h-[280px] min-w-0",children:c.jsx(DS,{width:"100%",height:"100%",minWidth:320,minHeight:280,children:xt==="bar"?c.jsxs(IS,{data:a,children:[c.jsx(VA,{strokeDasharray:"3 3",vertical:!1,stroke:"#f1f5f9"}),c.jsx(GA,{dataKey:z.xAxis,axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#94a3b8",fontWeight:"bold"}}),c.jsx(WA,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#94a3b8",fontWeight:"bold"},tickFormatter:K=>Ia(K,(z.yAxes||[])[0])}),c.jsx(jl,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1)"},cursor:{fill:"#f8fafc"},formatter:(K,se)=>[Ia(K,se),se]}),c.jsx(Dl,{verticalAlign:"top",height:36,iconType:"circle",wrapperStyle:{fontSize:"10px",fontWeight:"bold"}}),(z.yAxes||[]).map((K,se)=>c.jsx(ex,{dataKey:K,fill:se===0?z.color||Zn[0]:Zn[se%Zn.length],radius:[4,4,0,0],children:z.showLabels&&c.jsx(XA,{dataKey:K,position:"top",style:{fontSize:"10px",fontWeight:"bold",fill:"#64748b"},formatter:Fe=>Ia(Fe,K)})},K))]}):xt==="line"?c.jsxs(QS,{data:a,children:[c.jsx(VA,{strokeDasharray:"3 3",vertical:!1,stroke:"#f1f5f9"}),c.jsx(GA,{dataKey:z.xAxis,axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#94a3b8",fontWeight:"bold"}}),c.jsx(WA,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#94a3b8",fontWeight:"bold"},tickFormatter:K=>Ia(K,(z.yAxes||[])[0])}),c.jsx(jl,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1)"},formatter:(K,se)=>[Ia(K,se),se]}),c.jsx(Dl,{verticalAlign:"top",height:36,iconType:"circle"}),(z.yAxes||[]).map((K,se)=>c.jsx(tx,{type:"monotone",dataKey:K,stroke:se===0?z.color||Zn[0]:Zn[se%Zn.length],strokeWidth:3,dot:{r:4},activeDot:{r:6},children:z.showLabels&&c.jsx(XA,{dataKey:K,position:"top",offset:10,style:{fontSize:"10px",fontWeight:"bold",fill:"#64748b"},formatter:Fe=>Ia(Fe,K)})},K))]}):xt==="area"?c.jsxs(OS,{data:a,children:[c.jsx(VA,{strokeDasharray:"3 3",vertical:!1,stroke:"#f1f5f9"}),c.jsx(GA,{dataKey:z.xAxis,axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#94a3b8",fontWeight:"bold"}}),c.jsx(WA,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#94a3b8",fontWeight:"bold"},tickFormatter:K=>Ia(K,(z.yAxes||[])[0])}),c.jsx(jl,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1)"},formatter:(K,se)=>[Ia(K,se),se]}),c.jsx(Dl,{verticalAlign:"top",height:36,iconType:"circle",wrapperStyle:{fontSize:"10px",fontWeight:"bold"}}),(z.yAxes||[]).map((K,se)=>c.jsx(RS,{type:"monotone",dataKey:K,stroke:se===0?z.color||Zn[0]:Zn[se%Zn.length],fill:se===0?z.color||Zn[0]:Zn[se%Zn.length],fillOpacity:.2,strokeWidth:2,children:z.showLabels&&c.jsx(XA,{dataKey:K,position:"top",style:{fontSize:"10px",fontWeight:"bold",fill:"#64748b"},formatter:Fe=>Ia(Fe,K)})},K))]}):xt==="pie"?c.jsxs(MS,{children:[c.jsx(HS,{data:a,cx:"50%",cy:"50%",labelLine:!1,label:({name:K,percent:se})=>`${K} ${((se||0)*100).toFixed(0)}%`,outerRadius:120,innerRadius:80,paddingAngle:5,dataKey:(z.yAxes||[])[0]||"",nameKey:z.xAxis,children:a.map((K,se)=>c.jsx(PS,{fill:Zn[se%Zn.length]},`cell-${se}`))}),c.jsx(jl,{contentStyle:{borderRadius:"12px",border:"none"}}),c.jsx(Dl,{layout:"vertical",align:"right",verticalAlign:"middle",iconType:"circle",wrapperStyle:{fontSize:"10px",fontWeight:"bold"}})]}):xt==="composed"?c.jsxs(KS,{data:a,children:[c.jsx(VA,{strokeDasharray:"3 3",vertical:!1,stroke:"#f1f5f9"}),c.jsx(GA,{dataKey:z.xAxis,axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#94a3b8",fontWeight:"bold"}}),c.jsx(WA,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#94a3b8",fontWeight:"bold"},tickFormatter:K=>Ia(K,(z.yAxes||[])[0])}),c.jsx(jl,{contentStyle:{borderRadius:"12px",border:"none"},formatter:(K,se)=>[Ia(K,se),se]}),c.jsx(Dl,{verticalAlign:"top",height:36,wrapperStyle:{fontSize:"10px",fontWeight:"bold"}}),(z.yAxes||[]).map((K,se)=>se===0?c.jsx(ex,{dataKey:K,fill:Zn[0],radius:[4,4,0,0],children:z.showLabels&&c.jsx(XA,{dataKey:K,position:"top",style:{fontSize:"10px",fontWeight:"bold",fill:"#64748b"},formatter:Fe=>Ia(Fe,K)})},K):c.jsx(tx,{type:"monotone",dataKey:K,stroke:Zn[se%Zn.length],strokeWidth:3,children:z.showLabels&&c.jsx(XA,{dataKey:K,position:"top",style:{fontSize:"10px",fontWeight:"bold",fill:"#64748b"},formatter:Fe=>Ia(Fe,K)})},K))]}):xt==="radar"?c.jsxs(qS,{cx:"50%",cy:"50%",outerRadius:"80%",data:a,children:[c.jsx(zS,{stroke:"#e2e8f0"}),c.jsx(VS,{dataKey:z.xAxis,tick:{fontSize:10,fill:"#94a3b8",fontWeight:"bold"}}),c.jsx(GS,{angle:30,domain:[0,"auto"],tick:{fontSize:10,fill:"#94a3b8"}}),(z.yAxes||[]).map((K,se)=>c.jsx(WS,{name:K,dataKey:K,stroke:Zn[se%Zn.length],fill:Zn[se%Zn.length],fillOpacity:.6},K)),c.jsx(Dl,{iconType:"circle",wrapperStyle:{fontSize:"10px",fontWeight:"bold"}}),c.jsx(jl,{contentStyle:{borderRadius:"12px",border:"none"}})]}):xt==="scatter"?c.jsxs(XS,{children:[c.jsx(VA,{strokeDasharray:"3 3",vertical:!1,stroke:"#f1f5f9"}),c.jsx(GA,{type:"number",dataKey:z.xAxis,name:z.xAxis,axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#94a3b8",fontWeight:"bold"}}),c.jsx(WA,{type:"number",dataKey:(z.yAxes||[])[0],name:(z.yAxes||[])[0],axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#94a3b8",fontWeight:"bold"}}),c.jsx(jl,{cursor:{strokeDasharray:"3 3"}}),c.jsx(Dl,{verticalAlign:"top",height:36,iconType:"circle",wrapperStyle:{fontSize:"10px",fontWeight:"bold"}}),c.jsx(YS,{name:Se||"Scatter",data:It,fill:z.color||Zn[0]})]}):null})})},`${xt}-${g}`)})]})]})}),c.jsx(Ol,{isOpen:ve,onClose:()=>G(!1),title:e(Z?"querybuilder.update_title":"querybuilder.save_title"),children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"bg-blue-50 p-4 rounded-xl border border-blue-100 flex items-center gap-3",children:[c.jsx(I8,{className:"w-8 h-8 text-blue-500"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-[10px] font-black uppercase text-blue-400",children:e("querybuilder.archive_name")}),c.jsx("input",{autoFocus:!0,value:Se,onChange:K=>we(K.target.value),placeholder:e("querybuilder.archive_placeholder"),className:"w-full bg-transparent border-none outline-none font-bold text-blue-900 placeholder:text-blue-200"})]})]}),c.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[Z&&c.jsx("button",{onClick:()=>{Ae(null),Xe()},className:"px-4 py-2 text-xs font-bold text-slate-500 hover:bg-slate-100 rounded-lg flex items-center gap-2",children:e("querybuilder.save_new")}),c.jsxs("button",{onClick:Xe,disabled:!Se,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-bold text-xs shadow-lg flex items-center gap-2",children:[c.jsx(Px,{className:"w-4 h-4"})," ",e("common.save")]})]})]})}),c.jsx(Zx,{isOpen:M,onClose:()=>P(!1),items:a,initialIndex:re,tableName:j?.table,schema:Ce||void 0})]})},d1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Uf(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Ey(e){return"nodeType"in e}function Hl(e){var t,r;return e?Uf(e)?e:Ey(e)&&(t=(r=e.ownerDocument)==null?void 0:r.defaultView)!=null?t:window:window}function Ny(e){const{Document:t}=Hl(e);return e instanceof t}function Gp(e){return Uf(e)?!1:e instanceof Hl(e).HTMLElement}function DT(e){return e instanceof Hl(e).SVGElement}function jf(e){return e?Uf(e)?e.document:Ey(e)?Ny(e)?e:Gp(e)||DT(e)?e.ownerDocument:document:document:document}const $u=d1?X.useLayoutEffect:X.useEffect;function Fy(e){const t=X.useRef(e);return $u(()=>{t.current=e}),X.useCallback(function(){for(var r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return t.current==null?void 0:t.current(...a)},[])}function Ate(){const e=X.useRef(null),t=X.useCallback((a,n)=>{e.current=setInterval(a,n)},[]),r=X.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,r]}function Tp(e,t){t===void 0&&(t=[e]);const r=X.useRef(e);return $u(()=>{r.current!==e&&(r.current=e)},t),r}function Wp(e,t){const r=X.useRef();return X.useMemo(()=>{const a=e(r.current);return r.current=a,a},[...t])}function Ox(e){const t=Fy(e),r=X.useRef(null),a=X.useCallback(n=>{n!==r.current&&t?.(n,r.current),r.current=n},[]);return[r,a]}function i2(e){const t=X.useRef();return X.useEffect(()=>{t.current=e},[e]),t.current}let Vv={};function f1(e,t){return X.useMemo(()=>{if(t)return t;const r=Vv[e]==null?0:Vv[e]+1;return Vv[e]=r,e+"-"+r},[e,t])}function IT(e){return function(t){for(var r=arguments.length,a=new Array(r>1?r-1:0),n=1;n<r;n++)a[n-1]=arguments[n];return a.reduce((s,l)=>{const A=Object.entries(l);for(const[u,f]of A){const h=s[u];h!=null&&(s[u]=h+e*f)}return s},{...t})}}const mf=IT(1),Lp=IT(-1);function cte(e){return"clientX"in e&&"clientY"in e}function QT(e){if(!e)return!1;const{KeyboardEvent:t}=Hl(e.target);return t&&e instanceof t}function ute(e){if(!e)return!1;const{TouchEvent:t}=Hl(e.target);return t&&e instanceof t}function l2(e){if(ute(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return cte(e)?{x:e.clientX,y:e.clientY}:null}const o2=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[o2.Translate.toString(e),o2.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:a}=e;return t+" "+r+"ms "+a}}}),oS="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function dte(e){return e.matches(oS)?e:e.querySelector(oS)}const fte={display:"none"};function hte(e){let{id:t,value:r}=e;return ar.createElement("div",{id:t,style:fte},r)}function pte(e){let{id:t,announcement:r,ariaLiveType:a="assertive"}=e;const n={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return ar.createElement("div",{id:t,style:n,role:"status","aria-live":a,"aria-atomic":!0},r)}function gte(){const[e,t]=X.useState("");return{announce:X.useCallback(a=>{a!=null&&t(a)},[]),announcement:e}}const OT=X.createContext(null);function mte(e){const t=X.useContext(OT);X.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function xte(){const[e]=X.useState(()=>new Set),t=X.useCallback(a=>(e.add(a),()=>e.delete(a)),[e]);return[X.useCallback(a=>{let{type:n,event:s}=a;e.forEach(l=>{var A;return(A=l[n])==null?void 0:A.call(l,s)})},[e]),t]}const bte={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},vte={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function wte(e){let{announcements:t=vte,container:r,hiddenTextDescribedById:a,screenReaderInstructions:n=bte}=e;const{announce:s,announcement:l}=gte(),A=f1("DndLiveRegion"),[u,f]=X.useState(!1);if(X.useEffect(()=>{f(!0)},[]),mte(X.useMemo(()=>({onDragStart(g){let{active:x}=g;s(t.onDragStart({active:x}))},onDragMove(g){let{active:x,over:m}=g;t.onDragMove&&s(t.onDragMove({active:x,over:m}))},onDragOver(g){let{active:x,over:m}=g;s(t.onDragOver({active:x,over:m}))},onDragEnd(g){let{active:x,over:m}=g;s(t.onDragEnd({active:x,over:m}))},onDragCancel(g){let{active:x,over:m}=g;s(t.onDragCancel({active:x,over:m}))}}),[s,t])),!u)return null;const h=ar.createElement(ar.Fragment,null,ar.createElement(hte,{id:a,value:n.draggable}),ar.createElement(pte,{id:A,announcement:l}));return r?k0.createPortal(h,r):h}var Ps;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(Ps||(Ps={}));function Rx(){}function AS(e,t){return X.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function yte(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return X.useMemo(()=>[...t].filter(a=>a!=null),[...t])}const dA=Object.freeze({x:0,y:0});function RT(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function MT(e,t){let{data:{value:r}}=e,{data:{value:a}}=t;return r-a}function _te(e,t){let{data:{value:r}}=e,{data:{value:a}}=t;return a-r}function cS(e){let{left:t,top:r,height:a,width:n}=e;return[{x:t,y:r},{x:t+n,y:r},{x:t,y:r+a},{x:t+n,y:r+a}]}function HT(e,t){if(!e||e.length===0)return null;const[r]=e;return r[t]}function uS(e,t,r){return t===void 0&&(t=e.left),r===void 0&&(r=e.top),{x:t+e.width*.5,y:r+e.height*.5}}const Bte=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:a}=e;const n=uS(t,t.left,t.top),s=[];for(const l of a){const{id:A}=l,u=r.get(A);if(u){const f=RT(uS(u),n);s.push({id:A,data:{droppableContainer:l,value:f}})}}return s.sort(MT)},kte=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:a}=e;const n=cS(t),s=[];for(const l of a){const{id:A}=l,u=r.get(A);if(u){const f=cS(u),h=n.reduce((x,m,w)=>x+RT(f[w],m),0),g=Number((h/4).toFixed(4));s.push({id:A,data:{droppableContainer:l,value:g}})}}return s.sort(MT)};function Cte(e,t){const r=Math.max(t.top,e.top),a=Math.max(t.left,e.left),n=Math.min(t.left+t.width,e.left+e.width),s=Math.min(t.top+t.height,e.top+e.height),l=n-a,A=s-r;if(a<n&&r<s){const u=t.width*t.height,f=e.width*e.height,h=l*A,g=h/(u+f-h);return Number(g.toFixed(4))}return 0}const Ste=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:a}=e;const n=[];for(const s of a){const{id:l}=s,A=r.get(l);if(A){const u=Cte(A,t);u>0&&n.push({id:l,data:{droppableContainer:s,value:u}})}}return n.sort(_te)};function Ete(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}function PT(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:dA}function Nte(e){return function(r){for(var a=arguments.length,n=new Array(a>1?a-1:0),s=1;s<a;s++)n[s-1]=arguments[s];return n.reduce((l,A)=>({...l,top:l.top+e*A.y,bottom:l.bottom+e*A.y,left:l.left+e*A.x,right:l.right+e*A.x}),{...r})}}const Fte=Nte(1);function Tte(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function Lte(e,t,r){const a=Tte(t);if(!a)return e;const{scaleX:n,scaleY:s,x:l,y:A}=a,u=e.left-l-(1-n)*parseFloat(r),f=e.top-A-(1-s)*parseFloat(r.slice(r.indexOf(" ")+1)),h=n?e.width/n:e.width,g=s?e.height/s:e.height;return{width:h,height:g,top:f,right:u+h,bottom:f+g,left:u}}const Ute={ignoreTransform:!1};function Xp(e,t){t===void 0&&(t=Ute);let r=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:f,transformOrigin:h}=Hl(e).getComputedStyle(e);f&&(r=Lte(r,f,h))}const{top:a,left:n,width:s,height:l,bottom:A,right:u}=r;return{top:a,left:n,width:s,height:l,bottom:A,right:u}}function dS(e){return Xp(e,{ignoreTransform:!0})}function jte(e){const t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}function Dte(e,t){return t===void 0&&(t=Hl(e).getComputedStyle(e)),t.position==="fixed"}function Ite(e,t){t===void 0&&(t=Hl(e).getComputedStyle(e));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(n=>{const s=t[n];return typeof s=="string"?r.test(s):!1})}function h1(e,t){const r=[];function a(n){if(t!=null&&r.length>=t||!n)return r;if(Ny(n)&&n.scrollingElement!=null&&!r.includes(n.scrollingElement))return r.push(n.scrollingElement),r;if(!Gp(n)||DT(n)||r.includes(n))return r;const s=Hl(e).getComputedStyle(n);return n!==e&&Ite(n,s)&&r.push(n),Dte(n,s)?r:a(n.parentNode)}return e?a(e):r}function KT(e){const[t]=h1(e,1);return t??null}function Gv(e){return!d1||!e?null:Uf(e)?e:Ey(e)?Ny(e)||e===jf(e).scrollingElement?window:Gp(e)?e:null:null}function qT(e){return Uf(e)?e.scrollX:e.scrollLeft}function zT(e){return Uf(e)?e.scrollY:e.scrollTop}function A2(e){return{x:qT(e),y:zT(e)}}var ti;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(ti||(ti={}));function VT(e){return!d1||!e?!1:e===document.scrollingElement}function GT(e){const t={x:0,y:0},r=VT(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},a={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},n=e.scrollTop<=t.y,s=e.scrollLeft<=t.x,l=e.scrollTop>=a.y,A=e.scrollLeft>=a.x;return{isTop:n,isLeft:s,isBottom:l,isRight:A,maxScroll:a,minScroll:t}}const Qte={x:.2,y:.2};function Ote(e,t,r,a,n){let{top:s,left:l,right:A,bottom:u}=r;a===void 0&&(a=10),n===void 0&&(n=Qte);const{isTop:f,isBottom:h,isLeft:g,isRight:x}=GT(e),m={x:0,y:0},w={x:0,y:0},v={height:t.height*n.y,width:t.width*n.x};return!f&&s<=t.top+v.height?(m.y=ti.Backward,w.y=a*Math.abs((t.top+v.height-s)/v.height)):!h&&u>=t.bottom-v.height&&(m.y=ti.Forward,w.y=a*Math.abs((t.bottom-v.height-u)/v.height)),!x&&A>=t.right-v.width?(m.x=ti.Forward,w.x=a*Math.abs((t.right-v.width-A)/v.width)):!g&&l<=t.left+v.width&&(m.x=ti.Backward,w.x=a*Math.abs((t.left+v.width-l)/v.width)),{direction:m,speed:w}}function Rte(e){if(e===document.scrollingElement){const{innerWidth:s,innerHeight:l}=window;return{top:0,left:0,right:s,bottom:l,width:s,height:l}}const{top:t,left:r,right:a,bottom:n}=e.getBoundingClientRect();return{top:t,left:r,right:a,bottom:n,width:e.clientWidth,height:e.clientHeight}}function WT(e){return e.reduce((t,r)=>mf(t,A2(r)),dA)}function Mte(e){return e.reduce((t,r)=>t+qT(r),0)}function Hte(e){return e.reduce((t,r)=>t+zT(r),0)}function Pte(e,t){if(t===void 0&&(t=Xp),!e)return;const{top:r,left:a,bottom:n,right:s}=t(e);KT(e)&&(n<=0||s<=0||r>=window.innerHeight||a>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Kte=[["x",["left","right"],Mte],["y",["top","bottom"],Hte]];class Ty{constructor(t,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const a=h1(r),n=WT(a);this.rect={...t},this.width=t.width,this.height=t.height;for(const[s,l,A]of Kte)for(const u of l)Object.defineProperty(this,u,{get:()=>{const f=A(a),h=n[s]-f;return this.rect[u]+h},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class lp{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var a;return(a=this.target)==null?void 0:a.removeEventListener(...r)})},this.target=t}add(t,r,a){var n;(n=this.target)==null||n.addEventListener(t,r,a),this.listeners.push([t,r,a])}}function qte(e){const{EventTarget:t}=Hl(e);return e instanceof t?e:jf(e)}function Wv(e,t){const r=Math.abs(e.x),a=Math.abs(e.y);return typeof t=="number"?Math.sqrt(r**2+a**2)>t:"x"in t&&"y"in t?r>t.x&&a>t.y:"x"in t?r>t.x:"y"in t?a>t.y:!1}var Lo;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Lo||(Lo={}));function fS(e){e.preventDefault()}function zte(e){e.stopPropagation()}var ga;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(ga||(ga={}));const XT={start:[ga.Space,ga.Enter],cancel:[ga.Esc],end:[ga.Space,ga.Enter,ga.Tab]},Vte=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case ga.Right:return{...r,x:r.x+25};case ga.Left:return{...r,x:r.x-25};case ga.Down:return{...r,y:r.y+25};case ga.Up:return{...r,y:r.y-25}}};class Ly{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:r}}=t;this.props=t,this.listeners=new lp(jf(r)),this.windowListeners=new lp(Hl(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Lo.Resize,this.handleCancel),this.windowListeners.add(Lo.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Lo.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:r}=this.props,a=t.node.current;a&&Pte(a),r(dA)}handleKeyDown(t){if(QT(t)){const{active:r,context:a,options:n}=this.props,{keyboardCodes:s=XT,coordinateGetter:l=Vte,scrollBehavior:A="smooth"}=n,{code:u}=t;if(s.end.includes(u)){this.handleEnd(t);return}if(s.cancel.includes(u)){this.handleCancel(t);return}const{collisionRect:f}=a.current,h=f?{x:f.left,y:f.top}:dA;this.referenceCoordinates||(this.referenceCoordinates=h);const g=l(t,{active:r,context:a.current,currentCoordinates:h});if(g){const x=Lp(g,h),m={x:0,y:0},{scrollableAncestors:w}=a.current;for(const v of w){const B=t.code,{isTop:k,isRight:N,isLeft:S,isBottom:O,maxScroll:T,minScroll:U}=GT(v),D=Rte(v),H={x:Math.min(B===ga.Right?D.right-D.width/2:D.right,Math.max(B===ga.Right?D.left:D.left+D.width/2,g.x)),y:Math.min(B===ga.Down?D.bottom-D.height/2:D.bottom,Math.max(B===ga.Down?D.top:D.top+D.height/2,g.y))},j=B===ga.Right&&!N||B===ga.Left&&!S,W=B===ga.Down&&!O||B===ga.Up&&!k;if(j&&H.x!==g.x){const I=v.scrollLeft+x.x,Q=B===ga.Right&&I<=T.x||B===ga.Left&&I>=U.x;if(Q&&!x.y){v.scrollTo({left:I,behavior:A});return}Q?m.x=v.scrollLeft-I:m.x=B===ga.Right?v.scrollLeft-T.x:v.scrollLeft-U.x,m.x&&v.scrollBy({left:-m.x,behavior:A});break}else if(W&&H.y!==g.y){const I=v.scrollTop+x.y,Q=B===ga.Down&&I<=T.y||B===ga.Up&&I>=U.y;if(Q&&!x.x){v.scrollTo({top:I,behavior:A});return}Q?m.y=v.scrollTop-I:m.y=B===ga.Down?v.scrollTop-T.y:v.scrollTop-U.y,m.y&&v.scrollBy({top:-m.y,behavior:A});break}}this.handleMove(t,mf(Lp(g,this.referenceCoordinates),m))}}}handleMove(t,r){const{onMove:a}=this.props;t.preventDefault(),a(r)}handleEnd(t){const{onEnd:r}=this.props;t.preventDefault(),this.detach(),r()}handleCancel(t){const{onCancel:r}=this.props;t.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Ly.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:a=XT,onActivation:n}=t,{active:s}=r;const{code:l}=e.nativeEvent;if(a.start.includes(l)){const A=s.activatorNode.current;return A&&e.target!==A?!1:(e.preventDefault(),n?.({event:e.nativeEvent}),!0)}return!1}}];function hS(e){return!!(e&&"distance"in e)}function pS(e){return!!(e&&"delay"in e)}class Uy{constructor(t,r,a){var n;a===void 0&&(a=qte(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=r;const{event:s}=t,{target:l}=s;this.props=t,this.events=r,this.document=jf(l),this.documentListeners=new lp(this.document),this.listeners=new lp(a),this.windowListeners=new lp(Hl(l)),this.initialCoordinates=(n=l2(s))!=null?n:dA,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:r,bypassActivationConstraint:a}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Lo.Resize,this.handleCancel),this.windowListeners.add(Lo.DragStart,fS),this.windowListeners.add(Lo.VisibilityChange,this.handleCancel),this.windowListeners.add(Lo.ContextMenu,fS),this.documentListeners.add(Lo.Keydown,this.handleKeydown),r){if(a!=null&&a({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(pS(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(hS(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,r){const{active:a,onPending:n}=this.props;n(a,t,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:t}=this,{onStart:r}=this.props;t&&(this.activated=!0,this.documentListeners.add(Lo.Click,zte,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Lo.SelectionChange,this.removeTextSelection),r(t))}handleMove(t){var r;const{activated:a,initialCoordinates:n,props:s}=this,{onMove:l,options:{activationConstraint:A}}=s;if(!n)return;const u=(r=l2(t))!=null?r:dA,f=Lp(n,u);if(!a&&A){if(hS(A)){if(A.tolerance!=null&&Wv(f,A.tolerance))return this.handleCancel();if(Wv(f,A.distance))return this.handleStart()}if(pS(A)&&Wv(f,A.tolerance))return this.handleCancel();this.handlePending(A,f);return}t.cancelable&&t.preventDefault(),l(u)}handleEnd(){const{onAbort:t,onEnd:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleCancel(){const{onAbort:t,onCancel:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleKeydown(t){t.code===ga.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Gte={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class jy extends Uy{constructor(t){const{event:r}=t,a=jf(r.target);super(t,Gte,a)}}jy.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:a}=t;return!r.isPrimary||r.button!==0?!1:(a?.({event:r}),!0)}}];const Wte={move:{name:"mousemove"},end:{name:"mouseup"}};var c2;(function(e){e[e.RightClick=2]="RightClick"})(c2||(c2={}));class Xte extends Uy{constructor(t){super(t,Wte,jf(t.event.target))}}Xte.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:a}=t;return r.button===c2.RightClick?!1:(a?.({event:r}),!0)}}];const Xv={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Yte extends Uy{constructor(t){super(t,Xv)}static setup(){return window.addEventListener(Xv.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(Xv.move.name,t)};function t(){}}}Yte.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:a}=t;const{touches:n}=r;return n.length>1?!1:(a?.({event:r}),!0)}}];var op;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(op||(op={}));var Mx;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Mx||(Mx={}));function $te(e){let{acceleration:t,activator:r=op.Pointer,canScroll:a,draggingRect:n,enabled:s,interval:l=5,order:A=Mx.TreeOrder,pointerCoordinates:u,scrollableAncestors:f,scrollableAncestorRects:h,delta:g,threshold:x}=e;const m=Zte({delta:g,disabled:!s}),[w,v]=Ate(),B=X.useRef({x:0,y:0}),k=X.useRef({x:0,y:0}),N=X.useMemo(()=>{switch(r){case op.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case op.DraggableRect:return n}},[r,n,u]),S=X.useRef(null),O=X.useCallback(()=>{const U=S.current;if(!U)return;const D=B.current.x*k.current.x,H=B.current.y*k.current.y;U.scrollBy(D,H)},[]),T=X.useMemo(()=>A===Mx.TreeOrder?[...f].reverse():f,[A,f]);X.useEffect(()=>{if(!s||!f.length||!N){v();return}for(const U of T){if(a?.(U)===!1)continue;const D=f.indexOf(U),H=h[D];if(!H)continue;const{direction:j,speed:W}=Ote(U,H,N,t,x);for(const I of["x","y"])m[I][j[I]]||(W[I]=0,j[I]=0);if(W.x>0||W.y>0){v(),S.current=U,w(O,l),B.current=W,k.current=j;return}}B.current={x:0,y:0},k.current={x:0,y:0},v()},[t,O,a,v,s,l,JSON.stringify(N),JSON.stringify(m),w,f,T,h,JSON.stringify(x)])}const Jte={x:{[ti.Backward]:!1,[ti.Forward]:!1},y:{[ti.Backward]:!1,[ti.Forward]:!1}};function Zte(e){let{delta:t,disabled:r}=e;const a=i2(t);return Wp(n=>{if(r||!a||!n)return Jte;const s={x:Math.sign(t.x-a.x),y:Math.sign(t.y-a.y)};return{x:{[ti.Backward]:n.x[ti.Backward]||s.x===-1,[ti.Forward]:n.x[ti.Forward]||s.x===1},y:{[ti.Backward]:n.y[ti.Backward]||s.y===-1,[ti.Forward]:n.y[ti.Forward]||s.y===1}}},[r,t,a])}function ere(e,t){const r=t!=null?e.get(t):void 0,a=r?r.node.current:null;return Wp(n=>{var s;return t==null?null:(s=a??n)!=null?s:null},[a,t])}function tre(e,t){return X.useMemo(()=>e.reduce((r,a)=>{const{sensor:n}=a,s=n.activators.map(l=>({eventName:l.eventName,handler:t(l.handler,a)}));return[...r,...s]},[]),[e,t])}var Up;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Up||(Up={}));var u2;(function(e){e.Optimized="optimized"})(u2||(u2={}));const gS=new Map;function rre(e,t){let{dragging:r,dependencies:a,config:n}=t;const[s,l]=X.useState(null),{frequency:A,measure:u,strategy:f}=n,h=X.useRef(e),g=B(),x=Tp(g),m=X.useCallback(function(k){k===void 0&&(k=[]),!x.current&&l(N=>N===null?k:N.concat(k.filter(S=>!N.includes(S))))},[x]),w=X.useRef(null),v=Wp(k=>{if(g&&!r)return gS;if(!k||k===gS||h.current!==e||s!=null){const N=new Map;for(let S of e){if(!S)continue;if(s&&s.length>0&&!s.includes(S.id)&&S.rect.current){N.set(S.id,S.rect.current);continue}const O=S.node.current,T=O?new Ty(u(O),O):null;S.rect.current=T,T&&N.set(S.id,T)}return N}return k},[e,s,r,g,u]);return X.useEffect(()=>{h.current=e},[e]),X.useEffect(()=>{g||m()},[r,g]),X.useEffect(()=>{s&&s.length>0&&l(null)},[JSON.stringify(s)]),X.useEffect(()=>{g||typeof A!="number"||w.current!==null||(w.current=setTimeout(()=>{m(),w.current=null},A))},[A,g,m,...a]),{droppableRects:v,measureDroppableContainers:m,measuringScheduled:s!=null};function B(){switch(f){case Up.Always:return!1;case Up.BeforeDragging:return r;default:return!r}}}function YT(e,t){return Wp(r=>e?r||(typeof t=="function"?t(e):e):null,[t,e])}function are(e,t){return YT(e,t)}function nre(e){let{callback:t,disabled:r}=e;const a=Fy(t),n=X.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:s}=window;return new s(a)},[a,r]);return X.useEffect(()=>()=>n?.disconnect(),[n]),n}function p1(e){let{callback:t,disabled:r}=e;const a=Fy(t),n=X.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:s}=window;return new s(a)},[r]);return X.useEffect(()=>()=>n?.disconnect(),[n]),n}function sre(e){return new Ty(Xp(e),e)}function mS(e,t,r){t===void 0&&(t=sre);const[a,n]=X.useState(null);function s(){n(u=>{if(!e)return null;if(e.isConnected===!1){var f;return(f=u??r)!=null?f:null}const h=t(e);return JSON.stringify(u)===JSON.stringify(h)?u:h})}const l=nre({callback(u){if(e)for(const f of u){const{type:h,target:g}=f;if(h==="childList"&&g instanceof HTMLElement&&g.contains(e)){s();break}}}}),A=p1({callback:s});return $u(()=>{s(),e?(A?.observe(e),l?.observe(document.body,{childList:!0,subtree:!0})):(A?.disconnect(),l?.disconnect())},[e]),a}function ire(e){const t=YT(e);return PT(e,t)}const xS=[];function lre(e){const t=X.useRef(e),r=Wp(a=>e?a&&a!==xS&&e&&t.current&&e.parentNode===t.current.parentNode?a:h1(e):xS,[e]);return X.useEffect(()=>{t.current=e},[e]),r}function ore(e){const[t,r]=X.useState(null),a=X.useRef(e),n=X.useCallback(s=>{const l=Gv(s.target);l&&r(A=>A?(A.set(l,A2(l)),new Map(A)):null)},[]);return X.useEffect(()=>{const s=a.current;if(e!==s){l(s);const A=e.map(u=>{const f=Gv(u);return f?(f.addEventListener("scroll",n,{passive:!0}),[f,A2(f)]):null}).filter(u=>u!=null);r(A.length?new Map(A):null),a.current=e}return()=>{l(e),l(s)};function l(A){A.forEach(u=>{const f=Gv(u);f?.removeEventListener("scroll",n)})}},[n,e]),X.useMemo(()=>e.length?t?Array.from(t.values()).reduce((s,l)=>mf(s,l),dA):WT(e):dA,[e,t])}function bS(e,t){t===void 0&&(t=[]);const r=X.useRef(null);return X.useEffect(()=>{r.current=null},t),X.useEffect(()=>{const a=e!==dA;a&&!r.current&&(r.current=e),!a&&r.current&&(r.current=null)},[e]),r.current?Lp(e,r.current):dA}function Are(e){X.useEffect(()=>{if(!d1)return;const t=e.map(r=>{let{sensor:a}=r;return a.setup==null?void 0:a.setup()});return()=>{for(const r of t)r?.()}},e.map(t=>{let{sensor:r}=t;return r}))}function cre(e,t){return X.useMemo(()=>e.reduce((r,a)=>{let{eventName:n,handler:s}=a;return r[n]=l=>{s(l,t)},r},{}),[e,t])}function $T(e){return X.useMemo(()=>e?jte(e):null,[e])}const vS=[];function ure(e,t){t===void 0&&(t=Xp);const[r]=e,a=$T(r?Hl(r):null),[n,s]=X.useState(vS);function l(){s(()=>e.length?e.map(u=>VT(u)?a:new Ty(t(u),u)):vS)}const A=p1({callback:l});return $u(()=>{A?.disconnect(),l(),e.forEach(u=>A?.observe(u))},[e]),n}function dre(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Gp(t)?t:e}function fre(e){let{measure:t}=e;const[r,a]=X.useState(null),n=X.useCallback(f=>{for(const{target:h}of f)if(Gp(h)){a(g=>{const x=t(h);return g?{...g,width:x.width,height:x.height}:x});break}},[t]),s=p1({callback:n}),l=X.useCallback(f=>{const h=dre(f);s?.disconnect(),h&&s?.observe(h),a(h?t(h):null)},[t,s]),[A,u]=Ox(l);return X.useMemo(()=>({nodeRef:A,rect:r,setRef:u}),[r,A,u])}const hre=[{sensor:jy,options:{}},{sensor:Ly,options:{}}],pre={current:{}},Wm={draggable:{measure:dS},droppable:{measure:dS,strategy:Up.WhileDragging,frequency:u2.Optimized},dragOverlay:{measure:Xp}};class Ap extends Map{get(t){var r;return t!=null&&(r=super.get(t))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:r}=t;return!r})}getNodeFor(t){var r,a;return(r=(a=this.get(t))==null?void 0:a.node.current)!=null?r:void 0}}const gre={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Ap,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Rx},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Wm,measureDroppableContainers:Rx,windowRect:null,measuringScheduled:!1},mre={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Rx,draggableNodes:new Map,over:null,measureDroppableContainers:Rx},g1=X.createContext(mre),xre=X.createContext(gre);function bre(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Ap}}}function vre(e,t){switch(t.type){case Ps.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case Ps.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case Ps.DragEnd:case Ps.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Ps.RegisterDroppable:{const{element:r}=t,{id:a}=r,n=new Ap(e.droppable.containers);return n.set(a,r),{...e,droppable:{...e.droppable,containers:n}}}case Ps.SetDroppableDisabled:{const{id:r,key:a,disabled:n}=t,s=e.droppable.containers.get(r);if(!s||a!==s.key)return e;const l=new Ap(e.droppable.containers);return l.set(r,{...s,disabled:n}),{...e,droppable:{...e.droppable,containers:l}}}case Ps.UnregisterDroppable:{const{id:r,key:a}=t,n=e.droppable.containers.get(r);if(!n||a!==n.key)return e;const s=new Ap(e.droppable.containers);return s.delete(r),{...e,droppable:{...e.droppable,containers:s}}}default:return e}}function wre(e){let{disabled:t}=e;const{active:r,activatorEvent:a,draggableNodes:n}=X.useContext(g1),s=i2(a),l=i2(r?.id);return X.useEffect(()=>{if(!t&&!a&&s&&l!=null){if(!QT(s)||document.activeElement===s.target)return;const A=n.get(l);if(!A)return;const{activatorNode:u,node:f}=A;if(!u.current&&!f.current)return;requestAnimationFrame(()=>{for(const h of[u.current,f.current]){if(!h)continue;const g=dte(h);if(g){g.focus();break}}})}},[a,t,n,l,s]),null}function yre(e,t){let{transform:r,...a}=t;return e!=null&&e.length?e.reduce((n,s)=>s({transform:n,...a}),r):r}function _re(e){return X.useMemo(()=>({draggable:{...Wm.draggable,...e?.draggable},droppable:{...Wm.droppable,...e?.droppable},dragOverlay:{...Wm.dragOverlay,...e?.dragOverlay}}),[e?.draggable,e?.droppable,e?.dragOverlay])}function Bre(e){let{activeNode:t,measure:r,initialRect:a,config:n=!0}=e;const s=X.useRef(!1),{x:l,y:A}=typeof n=="boolean"?{x:n,y:n}:n;$u(()=>{if(!l&&!A||!t){s.current=!1;return}if(s.current||!a)return;const f=t?.node.current;if(!f||f.isConnected===!1)return;const h=r(f),g=PT(h,a);if(l||(g.x=0),A||(g.y=0),s.current=!0,Math.abs(g.x)>0||Math.abs(g.y)>0){const x=KT(f);x&&x.scrollBy({top:g.y,left:g.x})}},[t,l,A,a,r])}const JT=X.createContext({...dA,scaleX:1,scaleY:1});var Eu;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Eu||(Eu={}));const kre=X.memo(function(t){var r,a,n,s;let{id:l,accessibility:A,autoScroll:u=!0,children:f,sensors:h=hre,collisionDetection:g=Ste,measuring:x,modifiers:m,...w}=t;const v=X.useReducer(vre,void 0,bre),[B,k]=v,[N,S]=xte(),[O,T]=X.useState(Eu.Uninitialized),U=O===Eu.Initialized,{draggable:{active:D,nodes:H,translate:j},droppable:{containers:W}}=B,I=D!=null?H.get(D):null,Q=X.useRef({initial:null,translated:null}),Y=X.useMemo(()=>{var Vt;return D!=null?{id:D,data:(Vt=I?.data)!=null?Vt:pre,rect:Q}:null},[D,I]),z=X.useRef(null),[ue,Z]=X.useState(null),[Ae,ve]=X.useState(null),G=Tp(w,Object.values(w)),Se=f1("DndDescribedBy",l),we=X.useMemo(()=>W.getEnabled(),[W]),F=_re(x),{droppableRects:R,measureDroppableContainers:M,measuringScheduled:P}=rre(we,{dragging:U,dependencies:[j.x,j.y],config:F.droppable}),re=ere(H,D),ge=X.useMemo(()=>Ae?l2(Ae):null,[Ae]),Ce=Ur(),de=are(re,F.draggable.measure);Bre({activeNode:D!=null?H.get(D):null,config:Ce.layoutShiftCompensation,initialRect:de,measure:F.draggable.measure});const be=mS(re,F.draggable.measure,de),Le=mS(re?re.parentElement:null),ie=X.useRef({activatorEvent:null,active:null,activeNode:re,collisionRect:null,collisions:null,droppableRects:R,draggableNodes:H,draggingNode:null,draggingNodeRect:null,droppableContainers:W,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),_e=W.getNodeFor((r=ie.current.over)==null?void 0:r.id),je=fre({measure:F.dragOverlay.measure}),J=(a=je.nodeRef.current)!=null?a:re,ze=U?(n=je.rect)!=null?n:be:null,He=!!(je.nodeRef.current&&je.rect),ct=ire(He?null:be),Xe=$T(J?Hl(J):null),Ut=lre(U?_e??re:null),yt=ure(Ut),qt=yre(m,{transform:{x:j.x-ct.x,y:j.y-ct.y,scaleX:1,scaleY:1},activatorEvent:Ae,active:Y,activeNodeRect:be,containerNodeRect:Le,draggingNodeRect:ze,over:ie.current.over,overlayNodeRect:je.rect,scrollableAncestors:Ut,scrollableAncestorRects:yt,windowRect:Xe}),Lt=ge?mf(ge,j):null,jt=ore(Ut),Pt=bS(jt),zt=bS(jt,[be]),Jt=mf(qt,Pt),It=ze?Fte(ze,qt):null,xt=Y&&It?g({active:Y,collisionRect:It,droppableRects:R,droppableContainers:we,pointerCoordinates:Lt}):null,ht=HT(xt,"id"),[Bt,pr]=X.useState(null),$t=He?qt:mf(qt,zt),Ee=Ete($t,(s=Bt?.rect)!=null?s:null,be),at=X.useRef(null),it=X.useCallback((Vt,tt)=>{let{sensor:Wt,options:Me}=tt;if(z.current==null)return;const kt=H.get(z.current);if(!kt)return;const Tt=Vt.nativeEvent,ir=new Wt({active:z.current,activeNode:kt,event:Tt,options:Me,context:ie,onAbort(Sr){if(!H.get(Sr))return;const{onDragAbort:Hr}=G.current,Br={id:Sr};Hr?.(Br),N({type:"onDragAbort",event:Br})},onPending(Sr,ca,Hr,Br){if(!H.get(Sr))return;const{onDragPending:Er}=G.current,ae={id:Sr,constraint:ca,initialCoordinates:Hr,offset:Br};Er?.(ae),N({type:"onDragPending",event:ae})},onStart(Sr){const ca=z.current;if(ca==null)return;const Hr=H.get(ca);if(!Hr)return;const{onDragStart:Br}=G.current,jr={activatorEvent:Tt,active:{id:ca,data:Hr.data,rect:Q}};k0.unstable_batchedUpdates(()=>{Br?.(jr),T(Eu.Initializing),k({type:Ps.DragStart,initialCoordinates:Sr,active:ca}),N({type:"onDragStart",event:jr}),Z(at.current),ve(Tt)})},onMove(Sr){k({type:Ps.DragMove,coordinates:Sr})},onEnd:Nt(Ps.DragEnd),onCancel:Nt(Ps.DragCancel)});at.current=ir;function Nt(Sr){return async function(){const{active:Hr,collisions:Br,over:jr,scrollAdjustedTranslate:Er}=ie.current;let ae=null;if(Hr&&Er){const{cancelDrop:xe}=G.current;ae={activatorEvent:Tt,active:Hr,collisions:Br,delta:Er,over:jr},Sr===Ps.DragEnd&&typeof xe=="function"&&await Promise.resolve(xe(ae))&&(Sr=Ps.DragCancel)}z.current=null,k0.unstable_batchedUpdates(()=>{k({type:Sr}),T(Eu.Uninitialized),pr(null),Z(null),ve(null),at.current=null;const xe=Sr===Ps.DragEnd?"onDragEnd":"onDragCancel";if(ae){const fe=G.current[xe];fe?.(ae),N({type:xe,event:ae})}})}}},[H]),bt=X.useCallback((Vt,tt)=>(Wt,Me)=>{const kt=Wt.nativeEvent,Tt=H.get(Me);if(z.current!==null||!Tt||kt.dndKit||kt.defaultPrevented)return;const ir={active:Tt};Vt(Wt,tt.options,ir)===!0&&(kt.dndKit={capturedBy:tt.sensor},z.current=Me,it(Wt,tt))},[H,it]),Et=tre(h,bt);Are(h),$u(()=>{be&&O===Eu.Initializing&&T(Eu.Initialized)},[be,O]),X.useEffect(()=>{const{onDragMove:Vt}=G.current,{active:tt,activatorEvent:Wt,collisions:Me,over:kt}=ie.current;if(!tt||!Wt)return;const Tt={active:tt,activatorEvent:Wt,collisions:Me,delta:{x:Jt.x,y:Jt.y},over:kt};k0.unstable_batchedUpdates(()=>{Vt?.(Tt),N({type:"onDragMove",event:Tt})})},[Jt.x,Jt.y]),X.useEffect(()=>{const{active:Vt,activatorEvent:tt,collisions:Wt,droppableContainers:Me,scrollAdjustedTranslate:kt}=ie.current;if(!Vt||z.current==null||!tt||!kt)return;const{onDragOver:Tt}=G.current,ir=Me.get(ht),Nt=ir&&ir.rect.current?{id:ir.id,rect:ir.rect.current,data:ir.data,disabled:ir.disabled}:null,Sr={active:Vt,activatorEvent:tt,collisions:Wt,delta:{x:kt.x,y:kt.y},over:Nt};k0.unstable_batchedUpdates(()=>{pr(Nt),Tt?.(Sr),N({type:"onDragOver",event:Sr})})},[ht]),$u(()=>{ie.current={activatorEvent:Ae,active:Y,activeNode:re,collisionRect:It,collisions:xt,droppableRects:R,draggableNodes:H,draggingNode:J,draggingNodeRect:ze,droppableContainers:W,over:Bt,scrollableAncestors:Ut,scrollAdjustedTranslate:Jt},Q.current={initial:ze,translated:It}},[Y,re,xt,It,H,J,ze,R,W,Bt,Ut,Jt]),$te({...Ce,delta:j,draggingRect:It,pointerCoordinates:Lt,scrollableAncestors:Ut,scrollableAncestorRects:yt});const mt=X.useMemo(()=>({active:Y,activeNode:re,activeNodeRect:be,activatorEvent:Ae,collisions:xt,containerNodeRect:Le,dragOverlay:je,draggableNodes:H,droppableContainers:W,droppableRects:R,over:Bt,measureDroppableContainers:M,scrollableAncestors:Ut,scrollableAncestorRects:yt,measuringConfiguration:F,measuringScheduled:P,windowRect:Xe}),[Y,re,be,Ae,xt,Le,je,H,W,R,Bt,M,Ut,yt,F,P,Xe]),Ot=X.useMemo(()=>({activatorEvent:Ae,activators:Et,active:Y,activeNodeRect:be,ariaDescribedById:{draggable:Se},dispatch:k,draggableNodes:H,over:Bt,measureDroppableContainers:M}),[Ae,Et,Y,be,k,Se,H,Bt,M]);return ar.createElement(OT.Provider,{value:S},ar.createElement(g1.Provider,{value:Ot},ar.createElement(xre.Provider,{value:mt},ar.createElement(JT.Provider,{value:Ee},f)),ar.createElement(wre,{disabled:A?.restoreFocus===!1})),ar.createElement(wte,{...A,hiddenTextDescribedById:Se}));function Ur(){const Vt=ue?.autoScrollEnabled===!1,tt=typeof u=="object"?u.enabled===!1:u===!1,Wt=U&&!Vt&&!tt;return typeof u=="object"?{...u,enabled:Wt}:{enabled:Wt}}}),Cre=X.createContext(null),wS="button",Sre="Draggable";function Ere(e){let{id:t,data:r,disabled:a=!1,attributes:n}=e;const s=f1(Sre),{activators:l,activatorEvent:A,active:u,activeNodeRect:f,ariaDescribedById:h,draggableNodes:g,over:x}=X.useContext(g1),{role:m=wS,roleDescription:w="draggable",tabIndex:v=0}=n??{},B=u?.id===t,k=X.useContext(B?JT:Cre),[N,S]=Ox(),[O,T]=Ox(),U=cre(l,t),D=Tp(r);$u(()=>(g.set(t,{id:t,key:s,node:N,activatorNode:O,data:D}),()=>{const j=g.get(t);j&&j.key===s&&g.delete(t)}),[g,t]);const H=X.useMemo(()=>({role:m,tabIndex:v,"aria-disabled":a,"aria-pressed":B&&m===wS?!0:void 0,"aria-roledescription":w,"aria-describedby":h.draggable}),[a,m,v,B,w,h.draggable]);return{active:u,activatorEvent:A,activeNodeRect:f,attributes:H,isDragging:B,listeners:a?void 0:U,node:N,over:x,setNodeRef:S,setActivatorNodeRef:T,transform:k}}const Nre="Droppable",Fre={timeout:25};function Tre(e){let{data:t,disabled:r=!1,id:a,resizeObserverConfig:n}=e;const s=f1(Nre),{active:l,dispatch:A,over:u,measureDroppableContainers:f}=X.useContext(g1),h=X.useRef({disabled:r}),g=X.useRef(!1),x=X.useRef(null),m=X.useRef(null),{disabled:w,updateMeasurementsFor:v,timeout:B}={...Fre,...n},k=Tp(v??a),N=X.useCallback(()=>{if(!g.current){g.current=!0;return}m.current!=null&&clearTimeout(m.current),m.current=setTimeout(()=>{f(Array.isArray(k.current)?k.current:[k.current]),m.current=null},B)},[B]),S=p1({callback:N,disabled:w||!l}),O=X.useCallback((H,j)=>{S&&(j&&(S.unobserve(j),g.current=!1),H&&S.observe(H))},[S]),[T,U]=Ox(O),D=Tp(t);return X.useEffect(()=>{!S||!T.current||(S.disconnect(),g.current=!1,S.observe(T.current))},[T,S]),X.useEffect(()=>(A({type:Ps.RegisterDroppable,element:{id:a,key:s,disabled:r,node:T,rect:x,data:D}}),()=>A({type:Ps.UnregisterDroppable,key:s,id:a})),[a]),X.useEffect(()=>{r!==h.current.disabled&&(A({type:Ps.SetDroppableDisabled,id:a,key:s,disabled:r}),h.current.disabled=r)},[a,s,r,A]),{active:l,rect:x,isOver:u?.id===a,node:T,over:u,setNodeRef:U}}function yS(e,t,r){const a=e.slice();return a.splice(r<0?a.length+r:r,0,a.splice(t,1)[0]),a}function Hx(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const Lre=[ga.Down,ga.Right,ga.Up,ga.Left],Ure=(e,t)=>{let{context:{active:r,collisionRect:a,droppableRects:n,droppableContainers:s,over:l,scrollableAncestors:A}}=t;if(Lre.includes(e.code)){if(e.preventDefault(),!r||!a)return;const u=[];s.getEnabled().forEach(g=>{if(!g||g!=null&&g.disabled)return;const x=n.get(g.id);if(x)switch(e.code){case ga.Down:a.top<x.top&&u.push(g);break;case ga.Up:a.top>x.top&&u.push(g);break;case ga.Left:a.left>x.left&&u.push(g);break;case ga.Right:a.left<x.left&&u.push(g);break}});const f=kte({collisionRect:a,droppableRects:n,droppableContainers:u});let h=HT(f,"id");if(h===l?.id&&f.length>1&&(h=f[1].id),h!=null){const g=s.get(r.id),x=s.get(h),m=x?n.get(x.id):null,w=x?.node.current;if(w&&m&&g&&x){const B=h1(w).some((U,D)=>A[D]!==U),k=ZT(g,x),N=jre(g,x),S=B||!k?{x:0,y:0}:{x:N?a.width-m.width:0,y:N?a.height-m.height:0},O={x:m.left,y:m.top};return S.x&&S.y?O:Lp(O,S)}}}};function ZT(e,t){return!Hx(e)||!Hx(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function jre(e,t){return!Hx(e)||!Hx(t)||!ZT(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const dn=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8","#82ca9d"],d2=({title:e,sql:t,config:r,globalFilters:a,showInspectorJump:n=!1,inspectorReturnHash:s})=>{const{t:l}=tn(),A=X.useMemo(()=>{let T=t;if(!a||a.length===0)return T;const U=a.filter(H=>H.column&&(H.operator==="is null"||H.value));if(U.length===0)return T;const D=U.map(H=>{const j=`"${H.column.replace(/"/g,'""')}"`,W=typeof H.value=="string"?`'${H.value.replace(/'/g,"''")}'`:H.value,I=H.operator==="contains"?"LIKE":H.operator==="is null"?"IS NULL":H.operator;if(H.operator==="is null")return`${j} IS NULL`;const Q=H.operator==="contains"?`'%${H.value}%'`:W;return`${j} ${I} ${Q}`}).join(" AND ");return T.toUpperCase().includes("WHERE")?T=T.replace(/WHERE/i,`WHERE (${D}) AND `):T.toUpperCase().includes("GROUP BY")?T=T.replace(/GROUP BY/i,`WHERE ${D} GROUP BY `):T.toUpperCase().includes("ORDER BY")?T=T.replace(/ORDER BY/i,`WHERE ${D} ORDER BY `):T.toUpperCase().includes("LIMIT")?T=T.replace(/LIMIT/i,`WHERE ${D} LIMIT `):T+=` WHERE ${D}`,T},[t,a]),u=n&&/^\s*SELECT\b/i.test(A),f=ar.useCallback(()=>{if(!u)return;localStorage.setItem(yw,A);const T=window.location.hash||"#/";localStorage.setItem(_w,s||T),window.location.hash="#/inspector"},[u,A,s]),{data:h,loading:g,error:x}=ri(async()=>r.type==="text"?[]:A?await Dt.executeRaw(A):[],[A,r.type]),[m,w]=ar.useState(!1),[v,B]=ar.useState(0),[k,N]=ar.useState(null);ar.useEffect(()=>{if(h&&h.length>0){const T=t.match(/FROM\s+([a-zA-Z0-9_]+)/i),U=T?T[1]:"Dataset",D={title:e,description:`${l("widgets.data_inspector.description")}: ${U}`,type:"object",properties:Object.keys(h[0]).reduce((H,j)=>{const I=typeof h[0][j]=="number"?"number":"string";return H[j]={type:I,description:j},H},{})};N(D)}},[h,t,e,l]);const S=X.useMemo(()=>!h||h.length===0?[]:Object.keys(h[0]).map(T=>({header:T,accessor:T,render:U=>Ia(U[T],T)})),[h]),O={sm:"text-sm",md:"text-base",lg:"text-lg",xl:"text-xl","2xl":"text-2xl"};return r.type==="text"?c.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-slate-800 rounded-xl border border-slate-300 dark:border-slate-700/50 shadow-sm hover:shadow-xl hover:shadow-slate-200/50 dark:hover:shadow-none transition-all duration-500 overflow-hidden",children:[c.jsx("div",{className:"flex items-center justify-between pt-2.5 pb-2.5 px-5 bg-slate-50/50 dark:bg-slate-900/20 border-b border-slate-200 dark:border-slate-800/50",children:c.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[c.jsx("div",{className:"p-1.5 rounded-xl shrink-0 shadow-sm text-blue-600 bg-blue-50 dark:bg-blue-900/20 dark:text-blue-400",children:c.jsx(nB,{className:"w-4 h-4"})}),c.jsxs("div",{className:"min-w-0",children:[c.jsx("h3",{className:"text-xs font-bold leading-snug text-slate-800 dark:text-white truncate tracking-tight",children:e}),c.jsx("div",{className:"h-0.5 w-4 bg-slate-200 dark:bg-slate-700 rounded-full mt-0.5"})]})]})}),c.jsx("div",{className:`flex-1 p-4 whitespace-pre-wrap break-words text-slate-800 dark:text-slate-100 ${O[r.textSize||"md"]} ${r.textBold?"font-bold":"font-normal"} ${r.textItalic?"italic":"not-italic"} ${r.textUnderline?"underline":"no-underline"} ${r.textAlign==="center"?"text-center":r.textAlign==="right"?"text-right":"text-left"}`,children:(r.textContent||"").trim()||l("querybuilder.text_placeholder")})]}):g?c.jsx("div",{className:"h-full flex items-center justify-center text-slate-400",children:c.jsx(Ym,{className:"w-6 h-6 animate-spin"})}):x?c.jsx("div",{className:"h-full flex items-center justify-center text-red-400 p-4 text-center",children:c.jsxs("div",{className:"flex flex-col items-center gap-2",children:[c.jsx(il,{className:"w-6 h-6"}),c.jsx("span",{className:"text-xs",children:x.message})]})}):!h||h.length===0?c.jsx("div",{className:"h-full flex items-center justify-center text-slate-400 text-sm",children:l("common.no_data")}):c.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-slate-800 rounded-xl border border-slate-300 dark:border-slate-700/50 shadow-sm hover:shadow-xl hover:shadow-slate-200/50 dark:hover:shadow-none transition-all duration-500 overflow-hidden",children:[c.jsxs("div",{className:"flex items-center justify-between pt-2.5 pb-2.5 px-5 bg-slate-50/50 dark:bg-slate-900/20 border-b border-slate-200 dark:border-slate-800/50",children:[c.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[c.jsx("div",{className:"p-1.5 rounded-xl shrink-0 shadow-sm text-blue-600 bg-blue-50 dark:bg-blue-900/20 dark:text-blue-400",children:c.jsx(nB,{className:"w-4 h-4"})}),c.jsxs("div",{className:"min-w-0",children:[c.jsx("h3",{className:"text-xs font-bold leading-snug text-slate-800 dark:text-white truncate tracking-tight",children:e}),c.jsx("div",{className:"h-0.5 w-4 bg-slate-200 dark:bg-slate-700 rounded-full mt-0.5"})]})]}),u&&c.jsxs("button",{type:"button",onClick:f,className:"inline-flex items-center gap-1.5 px-2 py-1 text-[10px] font-bold uppercase tracking-wider rounded-md border border-slate-200 dark:border-slate-700 text-slate-500 hover:text-blue-600 hover:border-blue-300 dark:hover:border-blue-600 transition-colors",title:l("common.open_in_inspector"),children:[c.jsx(Nu,{className:"w-3 h-3"}),l("common.open")]})]}),c.jsx("div",{className:"flex-1 min-h-0 p-2",children:r.type==="table"?c.jsx("div",{className:"h-full overflow-auto",children:c.jsx(hy,{columns:S,data:h,onRowClick:T=>{const U=h.indexOf(T);B(U>=0?U:0),w(!0)}})}):r.type==="pivot"?c.jsx(s2,{data:h,rows:r.pivotRows||[],cols:r.pivotCols||[],measures:r.pivotMeasures||[]}):r.type==="kpi"?c.jsx("div",{className:"h-full flex flex-col items-center justify-center p-4",children:h&&h.length>0?(()=>{const T=h[0][Object.keys(h[0])[0]],U=Number(T);let D="text-slate-900 dark:text-white";if(r.rules&&!isNaN(U))for(const H of r.rules){let j=!1;switch(H.operator){case">":j=U>H.value;break;case"<":j=U<H.value;break;case">=":j=U>=H.value;break;case"<=":j=U<=H.value;break;case"==":j=U===H.value;break}if(j){H.color==="green"?D="text-emerald-500":H.color==="red"?D="text-rose-500":H.color==="yellow"?D="text-amber-500":H.color==="blue"?D="text-blue-500":D=`text-[${H.color}]`;break}}return c.jsxs("div",{className:"flex flex-col items-center text-center animate-in zoom-in-95 duration-500",children:[c.jsx("div",{className:`text-4xl md:text-5xl lg:text-6xl font-black tracking-widest break-all transition-colors duration-300 ${D}`,children:Ia(T,Object.keys(h[0])[0])}),c.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-[0.3em] mt-3",children:Object.keys(h[0])[0]})]})})():c.jsx("div",{className:"text-slate-300 text-[10px] font-bold uppercase tracking-widest",children:l("common.no_data")})}):c.jsx(DS,{width:"100%",height:"100%",minWidth:0,children:r.type==="bar"?c.jsxs(IS,{data:h,children:[c.jsx(VA,{strokeDasharray:"3 3",vertical:!1,stroke:"#e2e8f0"}),c.jsx(GA,{dataKey:r.xAxis,axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#64748b"}}),c.jsx(WA,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#64748b"},tickFormatter:T=>Ia(T,(r.yAxes||[])[0])}),c.jsx(jl,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1)"},cursor:{fill:"#f1f5f9"},formatter:(T,U)=>[Ia(T,U),U]}),c.jsx(Dl,{verticalAlign:"top",height:36,iconType:"circle",wrapperStyle:{fontSize:"10px",fontWeight:"bold",textTransform:"uppercase"}}),(r.yAxes||(r.yAxis?[r.yAxis]:[])).map((T,U)=>c.jsx(ex,{dataKey:T,fill:U===0?r.color||dn[0]:dn[U%dn.length],radius:[4,4,0,0],children:r.showLabels&&c.jsx(XA,{dataKey:T,position:"top",style:{fontSize:"10px",fontWeight:"bold",fill:"#64748b"},formatter:D=>Ia(D,T)})},T))]}):r.type==="line"?c.jsxs(QS,{data:h,children:[c.jsx(VA,{strokeDasharray:"3 3",vertical:!1,stroke:"#e2e8f0"}),c.jsx(GA,{dataKey:r.xAxis,axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#64748b"}}),c.jsx(WA,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#64748b"},tickFormatter:T=>Ia(T,(r.yAxes||[])[0])}),c.jsx(jl,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1)"},formatter:(T,U)=>[Ia(T,U),U]}),c.jsx(Dl,{verticalAlign:"top",height:36,iconType:"circle",wrapperStyle:{fontSize:"10px",fontWeight:"bold",textTransform:"uppercase"}}),(r.yAxes||(r.yAxis?[r.yAxis]:[])).map((T,U)=>c.jsx(tx,{type:"monotone",dataKey:T,stroke:U===0?r.color||dn[0]:dn[U%dn.length],strokeWidth:3,dot:{r:4},activeDot:{r:6},children:r.showLabels&&c.jsx(XA,{dataKey:T,position:"top",offset:10,style:{fontSize:"10px",fontWeight:"bold",fill:"#64748b"},formatter:D=>Ia(D,T)})},T))]}):r.type==="area"?c.jsxs(OS,{data:h,children:[c.jsx("defs",{children:(r.yAxes||(r.yAxis?[r.yAxis]:[])).map((T,U)=>c.jsxs("linearGradient",{id:`color-${T}-${e.replace(/\s+/g,"")}`,x1:"0",y1:"0",x2:"0",y2:"1",children:[c.jsx("stop",{offset:"5%",stopColor:U===0?r.color||dn[0]:dn[U%dn.length],stopOpacity:.8}),c.jsx("stop",{offset:"95%",stopColor:U===0?r.color||dn[0]:dn[U%dn.length],stopOpacity:0})]},`grad-${T}`))}),c.jsx(GA,{dataKey:r.xAxis,axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#64748b"}}),c.jsx(WA,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#64748b"},tickFormatter:T=>Ia(T,(r.yAxes||[])[0])}),c.jsx(VA,{strokeDasharray:"3 3",vertical:!1,stroke:"#e2e8f0"}),c.jsx(jl,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1)"},formatter:(T,U)=>[Ia(T,U),U]}),c.jsx(Dl,{verticalAlign:"top",height:36,iconType:"circle",wrapperStyle:{fontSize:"10px",fontWeight:"bold"}}),(r.yAxes||(r.yAxis?[r.yAxis]:[])).map((T,U)=>c.jsx(RS,{type:"monotone",dataKey:T,stroke:U===0?r.color||dn[0]:dn[U%dn.length],strokeWidth:3,fillOpacity:1,fill:`url(#color-${T}-${e.replace(/\s+/g,"")})`,children:r.showLabels&&c.jsx(XA,{dataKey:T,position:"top",style:{fontSize:"10px",fontWeight:"bold",fill:"#64748b"},formatter:D=>Ia(D,T)})},T))]}):r.type==="pie"?c.jsxs(MS,{children:[c.jsx(HS,{data:h,cx:"50%",cy:"50%",labelLine:!1,label:({name:T,percent:U})=>`${T??""} ${(U?U*100:0).toFixed(0)}%`,outerRadius:80,innerRadius:50,paddingAngle:5,dataKey:(r.yAxes||(r.yAxis?[r.yAxis]:[]))[0]||"",nameKey:r.xAxis,children:h.map((T,U)=>c.jsx(PS,{fill:dn[U%dn.length],stroke:"white",strokeWidth:2},`cell-${U}`))}),c.jsx(jl,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1)"}}),c.jsx(Dl,{verticalAlign:"bottom",height:36,iconSize:8,wrapperStyle:{fontSize:"10px",fontWeight:"bold"}})]}):r.type==="composed"?c.jsxs(KS,{data:h,children:[c.jsx(VA,{strokeDasharray:"3 3",vertical:!1,stroke:"#e2e8f0"}),c.jsx(GA,{dataKey:r.xAxis,axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#64748b"}}),c.jsx(WA,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"#64748b"},tickFormatter:T=>Ia(T,(r.yAxes||[])[0])}),c.jsx(jl,{contentStyle:{borderRadius:"12px",border:"none"},formatter:(T,U)=>[Ia(T,U),U]}),c.jsx(Dl,{verticalAlign:"top",height:36,iconType:"circle"}),(r.yAxes||[]).map((T,U)=>r.lineSeries?.includes(T)?c.jsx(tx,{type:"monotone",dataKey:T,stroke:dn[U%dn.length],strokeWidth:3,children:r.showLabels&&c.jsx(XA,{dataKey:T,position:"top",style:{fontSize:"10px",fontWeight:"bold",fill:"#64748b"},formatter:D=>Ia(D,T)})},T):c.jsx(ex,{dataKey:T,fill:dn[U%dn.length],radius:[4,4,0,0],children:r.showLabels&&c.jsx(XA,{dataKey:T,position:"top",style:{fontSize:"10px",fontWeight:"bold",fill:"#64748b"},formatter:D=>Ia(D,T)})},T))]}):r.type==="radar"?c.jsxs(qS,{cx:"50%",cy:"50%",outerRadius:"80%",data:h,children:[c.jsx(zS,{stroke:"#e2e8f0"}),c.jsx(VS,{dataKey:r.xAxis,tick:{fontSize:10,fill:"#64748b"}}),c.jsx(GS,{angle:30,domain:[0,"auto"],tick:{fontSize:8}}),(r.yAxes||[]).map((T,U)=>c.jsx(WS,{name:T,dataKey:T,stroke:dn[U%dn.length],fill:dn[U%dn.length],fillOpacity:.6},T)),c.jsx(Dl,{iconType:"circle",wrapperStyle:{fontSize:"10px"}}),c.jsx(jl,{})]}):r.type==="scatter"?c.jsxs(XS,{children:[c.jsx(VA,{strokeDasharray:"3 3",vertical:!1,stroke:"#e2e8f0"}),c.jsx(GA,{type:"number",dataKey:r.xAxis,name:r.xAxis,axisLine:!1,tickLine:!1,tick:{fontSize:10}}),c.jsx(WA,{type:"number",dataKey:(r.yAxes||[])[0],name:(r.yAxes||[])[0],axisLine:!1,tickLine:!1,tick:{fontSize:10}}),c.jsx(jl,{cursor:{strokeDasharray:"3 3"}}),c.jsx(Dl,{verticalAlign:"top",height:36}),c.jsx(YS,{name:e,data:h,fill:r.color||dn[0]})]}):r.type==="pivot"?c.jsx(s2,{data:h,rows:r.pivotRows||[],cols:r.pivotCols||[],measures:r.pivotMeasures||[]}):null})}),h&&h.length>0&&c.jsx(Zx,{isOpen:m,onClose:()=>w(!1),items:h,initialIndex:v,title:e,schema:k||void 0,tableName:t.match(/FROM\s+([a-zA-Z0-9_]+)/i)?.[1]})]})},Dre={blue:"text-blue-600 bg-blue-50 dark:bg-blue-900/20 dark:text-blue-400",emerald:"text-emerald-600 bg-emerald-50 dark:bg-emerald-900/20 dark:text-emerald-400",rose:"text-rose-600 bg-rose-50 dark:bg-rose-900/20 dark:text-rose-400",amber:"text-amber-600 bg-amber-50 dark:bg-amber-900/20 dark:text-amber-400",indigo:"text-indigo-600 bg-indigo-50 dark:bg-indigo-900/20 dark:text-indigo-400",slate:"text-slate-600 bg-slate-50 dark:bg-slate-900/20 dark:text-slate-400"},Yp=({title:e,icon:t,iconColor:r="blue",children:a,onRemove:n,onClick:s,targetView:l,footerLeft:A,footerRight:u,className:f,backgroundIcon:h})=>{const{t:g}=tn(),x=u8(),m=A||u||l,w=A||(l&&!u?c.jsxs("button",{onClick:v=>{v.stopPropagation(),x(l)},className:"flex items-center gap-1.5 text-[10px] font-black text-slate-400 hover:text-blue-600 uppercase tracking-widest transition-colors group/footer",children:[g("common.open_details"),c.jsx(Ul,{className:"w-3 h-3 transition-transform group-hover/footer:translate-x-0.5"})]}):null);return c.jsxs("div",{className:Hs("group relative flex flex-col bg-white dark:bg-slate-800 rounded-xl border border-slate-300 dark:border-slate-700/50 shadow-sm hover:shadow-xl hover:shadow-slate-200/50 dark:hover:shadow-none transition-all duration-500 overflow-hidden h-full",s&&"cursor-pointer active:scale-[0.98]",f),children:[h&&c.jsx("div",{className:"absolute -right-8 -bottom-8 text-slate-50/50 dark:text-slate-900/20 group-hover:text-slate-100/50 dark:group-hover:text-slate-900/40 transition-colors duration-500",children:c.jsx(h,{size:160,strokeWidth:1})}),c.jsxs("div",{className:"relative flex items-center justify-between pt-2.5 pb-2.5 px-5 bg-slate-50/50 dark:bg-slate-900/20 border-b border-slate-200 dark:border-slate-800/50",children:[c.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[c.jsx("div",{className:Hs("p-1.5 rounded-xl shrink-0 shadow-sm",Dre[r]),children:c.jsx(t,{className:"w-4 h-4"})}),c.jsxs("div",{className:"min-w-0",children:[c.jsx("h3",{className:"text-xs font-bold leading-snug text-slate-800 dark:text-white truncate tracking-tight",children:e}),c.jsx("div",{className:"h-0.5 w-4 bg-slate-200 dark:bg-slate-700 rounded-full mt-0.5 group-hover:w-8 transition-all duration-500"})]})]}),c.jsx("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-all duration-300 translate-x-2 group-hover:translate-x-0",children:n&&c.jsx("button",{onClick:v=>{v.stopPropagation(),n()},className:"p-1 text-slate-400 hover:text-rose-600 hover:bg-rose-50 dark:hover:bg-rose-900/20 rounded-lg transition-colors",title:g("common.remove"),children:c.jsx(nl,{className:"w-3.5 h-3.5"})})})]}),c.jsx("div",{className:"relative flex-1 p-4 px-5 pt-2 min-h-0",onClick:s,children:a}),m&&c.jsxs("div",{className:"relative p-3 px-5 border-t border-slate-200 dark:border-slate-800/50 bg-slate-50/50 dark:bg-slate-900/30 flex items-center justify-between min-h-[40px]",children:[c.jsx("div",{className:"flex-1 min-w-0",children:w}),c.jsx("div",{className:"shrink-0",children:u})]}),c.jsx("div",{className:"absolute inset-0 pointer-events-none border border-transparent group-hover:border-blue-500/10 dark:group-hover:border-blue-400/10 rounded-xl transition-colors"})]})},Ire=({onRemove:e,dragHandleProps:t,onClick:r,targetView:a})=>{const{t:n,i18n:s}=tn(),[l,A]=X.useState(new Date);X.useEffect(()=>{const g=setInterval(()=>A(new Date),1e3);return()=>clearInterval(g)},[]);const u=X.useMemo(()=>new Intl.DateTimeFormat(s.language==="de"?"de-DE":"en-US",{weekday:"long",day:"2-digit",month:"long"}).format(l),[l,s.language]),f=l.toLocaleTimeString(s.language==="de"?"de-DE":"en-US",{hour:"2-digit",minute:"2-digit"});return c.jsx(Yp,{title:n("widgets.clock.title"),icon:Zm,iconColor:"indigo",onRemove:e,dragHandleProps:t,onClick:r,targetView:a,backgroundIcon:Zm,children:c.jsx("div",{className:"flex flex-col h-full items-center justify-center -mt-2",children:c.jsxs("div",{className:"text-center group-hover:scale-110 transition-transform duration-700",children:[c.jsxs("div",{className:"flex items-baseline justify-center gap-1.5",children:[c.jsx("span",{className:"text-6xl font-black text-slate-900 dark:text-white tracking-tighter tabular-nums leading-none",children:f}),c.jsx("span",{className:"text-xs font-black text-indigo-500/80 dark:text-indigo-400/80 uppercase tracking-widest tabular-nums",children:"CET"})]}),c.jsxs("div",{className:"mt-4 flex flex-col items-center",children:[c.jsx("div",{className:"h-px w-8 bg-slate-100 dark:bg-slate-800 mb-4"}),c.jsxs("div",{className:"flex items-center gap-2 px-4 py-1.5 bg-slate-50 dark:bg-slate-900/40 rounded-2xl border border-slate-100 dark:border-slate-800/50",children:[c.jsx(m2,{className:"w-3.5 h-3.5 text-slate-400 flex-shrink-0"}),c.jsx("span",{className:"text-xs font-bold text-slate-600 dark:text-slate-300 tracking-tight whitespace-nowrap",children:u})]})]})]})})})},Qre=({className:e=""})=>c.jsx("div",{className:`animate-shimmer bg-slate-100 dark:bg-slate-800 rounded ${e}`}),Ore=({onRemove:e,dragHandleProps:t,onClick:r,targetView:a})=>{const{t:n}=tn(),{data:s,loading:l,error:A}=ri(()=>Dt.getDatabaseStats(),[],{cacheKey:"db-stats-tile",ttl:600*1e3});if(A)return c.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-red-200 dark:border-red-900/50 p-4 h-full flex items-center justify-center text-center",children:c.jsx("p",{className:"text-red-500 font-bold text-[10px] uppercase",children:n("common.error")})});const u=()=>{r&&r(),window.location.hash="#/inspector"};return c.jsx(Yp,{title:n("widgets.data_inspector.title"),icon:fo,iconColor:"indigo",onClick:r||u,onRemove:e,targetView:a,dragHandleProps:t,backgroundIcon:fo,className:"cursor-pointer",footerLeft:c.jsxs("button",{onClick:f=>{f.stopPropagation(),window.location.hash="#/inspector"},className:"flex items-center gap-1.5 text-[10px] font-black text-slate-400 hover:text-indigo-600 uppercase tracking-widest transition-colors group/footer",children:[n("widgets.data_inspector.details"),c.jsx(fo,{className:"w-3 h-3 transition-transform group-hover/footer:scale-110"})]}),children:c.jsxs("div",{className:"flex flex-col h-full items-center justify-around py-2",children:[c.jsxs("div",{className:"text-center group-hover:scale-105 transition-transform duration-500",children:[c.jsxs("div",{className:"flex items-center justify-center gap-1.5 text-[10px] font-black text-indigo-600 dark:text-indigo-400 uppercase tracking-widest mb-1",children:[c.jsx(Oc,{className:"w-3 h-3"}),c.jsx("span",{children:n("widgets.data_inspector.records_total")})]}),c.jsx("div",{className:"text-4xl font-black text-slate-900 dark:text-white tracking-tighter tabular-nums leading-none",children:l||!s?c.jsx(Qre,{className:"h-8 w-20 mx-auto"}):s.records.toLocaleString()})]}),c.jsxs("div",{className:"w-full pt-4 border-t border-slate-200 dark:border-slate-800/50 text-center",children:[c.jsxs("div",{className:"flex items-center justify-center gap-1.5 text-[10px] font-black text-indigo-500 dark:text-indigo-400 uppercase tracking-widest mb-1",children:[c.jsx(_i,{className:"w-3 h-3"}),c.jsx("span",{children:n("widgets.data_inspector.tables")})]}),c.jsx("div",{className:"text-2xl font-black text-slate-700 dark:text-slate-300 tabular-nums leading-none",children:l||!s?"...":s.tables})]})]})})},Rre=({onRemove:e,dragHandleProps:t,onClick:r,targetView:a})=>{const{t:n}=tn(),[s,l]=X.useState(!1),[A,u]=X.useState(null),[f,h]=X.useState(null);ar.useEffect(()=>{const x=performance.getEntriesByType("navigation")[0];x&&h(Math.round(x.duration));const m=()=>{const v=performance;if(v.memory){const B=v.memory;u({used:Math.round(B.usedJSHeapSize/1024/1024),total:Math.round(B.jsHeapSizeLimit/1024/1024)})}};m();const w=setInterval(m,5e3);return()=>clearInterval(w)},[]);const g=()=>{l(!0),r&&r()};return c.jsxs(c.Fragment,{children:[c.jsx(Yp,{title:n("widgets.system_status.title"),icon:Ru,iconColor:"emerald",onRemove:e,dragHandleProps:t,onClick:g,targetView:a,backgroundIcon:Ru,className:"cursor-pointer",footerLeft:c.jsxs("button",{onClick:x=>{x.stopPropagation(),l(!0)},className:"flex items-center gap-1.5 text-[10px] font-black text-slate-400 hover:text-blue-600 uppercase tracking-widest transition-colors group/footer",children:[n("widgets.system_status.details"),c.jsx(Ru,{className:"w-3 h-3 transition-transform group-hover/footer:scale-110"})]}),children:c.jsxs("div",{className:"flex flex-col h-full items-center justify-around py-2",children:[c.jsxs("div",{className:"text-center group-hover:scale-105 transition-transform duration-500",children:[c.jsxs("div",{className:"flex items-center justify-center gap-1.5 text-[10px] font-black text-emerald-600 dark:text-emerald-400 uppercase tracking-widest mb-1",children:[c.jsx(f2,{className:"w-3 h-3"}),c.jsx("span",{children:n("widgets.system_status.memory_usage")})]}),c.jsx("div",{className:"text-4xl font-black text-slate-900 dark:text-white tracking-tighter tabular-nums leading-none",children:A?`${A.used} MB`:"---"}),c.jsx("div",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-tighter mt-1",children:n("widgets.system_status.heap_from",{total:A?A.total:"---"})})]}),c.jsxs("div",{className:"w-full pt-4 border-t border-slate-200 dark:border-slate-800/50 text-center",children:[c.jsxs("div",{className:"flex items-center justify-center gap-1.5 text-[10px] font-black text-blue-500 dark:text-blue-400 uppercase tracking-widest mb-1",children:[c.jsx(Q8,{className:"w-3 h-3"}),c.jsx("span",{children:n("widgets.system_status.load_time")})]}),c.jsx("div",{className:"text-2xl font-black text-slate-700 dark:text-slate-300 tabular-nums leading-none",children:f?`${f} ms`:"---"})]})]})}),c.jsx(ly,{isOpen:s,onClose:()=>l(!1)})]})},Mre=({onRemove:e,dragHandleProps:t,onClick:r,targetView:a,isOverlay:n})=>{const{t:s,i18n:l}=tn(),{lastBackup:A,changeCount:u,isBackupRecommended:f}=MN(),h=x=>x?x.toLocaleString(l.language==="de"?"de-DE":"en-US",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):s("widgets.database_status.never"),g=x=>{x.stopPropagation(),window.location.hash="#/datasource"};return c.jsx(Yp,{title:s("widgets.database_status.title"),icon:_i,iconColor:f?"amber":"emerald",onRemove:e,dragHandleProps:t,onClick:r,targetView:a,backgroundIcon:_i,className:n?"opacity-90":"",footerLeft:c.jsxs("button",{onClick:g,className:"flex items-center gap-1.5 text-[10px] font-black text-slate-400 hover:text-blue-600 uppercase tracking-widest transition-colors group/footer",children:[s("widgets.database_status.data_management"),c.jsx(cp,{className:"w-3 h-3 transition-transform group-hover/footer:rotate-90"})]}),children:c.jsxs("div",{className:"flex flex-col h-full items-center justify-around py-2",children:[c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:"flex items-center justify-center gap-1.5 text-[10px] font-black text-slate-500 dark:text-slate-400 uppercase tracking-widest mb-1",children:[c.jsx(g2,{className:"w-3 h-3"}),c.jsx("span",{children:s("widgets.database_status.last_backup")})]}),c.jsx("div",{className:"text-xl font-black text-slate-900 dark:text-white tracking-tight tabular-nums leading-none",children:h(A)})]}),c.jsxs("div",{className:"w-full pt-4 border-t border-slate-100 dark:border-slate-800/50 text-center",children:[c.jsxs("div",{className:`flex items-center justify-center gap-1.5 text-[10px] font-black uppercase tracking-widest mb-1 ${f?"text-amber-600 dark:text-amber-400":"text-emerald-600 dark:text-emerald-400"}`,children:[f?c.jsx(il,{className:"w-3 h-3"}):c.jsx(_i,{className:"w-3 h-3"}),c.jsx("span",{children:s("widgets.database_status.modifications")})]}),c.jsx("div",{className:`text-4xl font-black tabular-nums leading-none tracking-tighter ${f?"text-amber-600 dark:text-amber-400":"text-slate-900 dark:text-white"}`,children:u}),c.jsx("div",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-tighter mt-1",children:s("widgets.database_status.records_since_backup")})]})]})})},Hre=fA("WorklistComponent"),Pre=({onRemove:e,dragHandleProps:t,onClick:r,targetView:a,isOverlay:n})=>{const{t:s}=tn(),[l,A]=X.useState({total:0,pending:0}),[u,f]=X.useState(!0),h=async()=>{try{const x=await Dt.getWorklist(),m=x.length,w=x.filter(v=>v.status==="pending"||!v.status).length;A({total:m,pending:w})}catch(x){Hre.error("Failed to load worklist stats",x)}finally{f(!1)}};X.useEffect(()=>(h(),window.addEventListener("db-updated",h),window.addEventListener("db-changed",h),()=>{window.removeEventListener("db-updated",h),window.removeEventListener("db-changed",h)}),[]);const g=x=>{x.stopPropagation(),window.location.hash="#/worklist"};return c.jsx(Yp,{title:s("widgets.worklist.title"),icon:nf,iconColor:l.pending>0?"amber":"emerald",onRemove:e,dragHandleProps:t,onClick:r,targetView:a,backgroundIcon:nf,className:n?"opacity-90":"",footerLeft:c.jsxs("button",{onClick:g,className:"flex items-center gap-1.5 text-[10px] font-black text-slate-400 hover:text-blue-600 uppercase tracking-widest transition-colors group/footer",children:[s("widgets.worklist.open_list"),c.jsx(p2,{className:"w-3 h-3 transition-transform group-hover/footer:translate-x-1"})]}),children:c.jsxs("div",{className:"flex flex-col h-full items-center justify-around py-2",children:[c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:`flex items-center justify-center gap-1.5 text-[10px] font-black uppercase tracking-widest mb-1 ${l.pending>0?"text-amber-600 dark:text-amber-400":"text-emerald-600 dark:text-emerald-400"}`,children:[l.pending>0?c.jsx(il,{className:"w-3 h-3"}):c.jsx(Bf,{className:"w-3 h-3"}),c.jsx("span",{children:l.pending>0?s("widgets.worklist.open_tasks"):s("widgets.worklist.all_done")})]}),c.jsx("div",{className:`text-4xl font-black tracking-tighter tabular-nums leading-none ${l.pending>0?"text-amber-600 dark:text-amber-400":"text-slate-900 dark:text-white"}`,children:u?"---":l.pending})]}),c.jsxs("div",{className:"w-full pt-4 border-t border-slate-100 dark:border-slate-800/50 text-center",children:[c.jsxs("div",{className:"flex items-center justify-center gap-1.5 text-[10px] font-black text-slate-500 dark:text-slate-400 uppercase tracking-widest mb-1",children:[c.jsx(nf,{className:"w-3 h-3"}),c.jsx("span",{children:s("widgets.worklist.total_entries")})]}),c.jsx("div",{className:"text-xl font-black text-slate-700 dark:text-slate-300 tabular-nums leading-none",children:u?"---":l.total})]})]})})},Kre={ClockComponent:Ire,DataInspectorComponent:Ore,SystemStatusComponent:Rre,DatabaseStatusComponent:Mre,WorklistComponent:Pre},Yv=[{id:"SystemStatusComponent",titleKey:"widgets.system_status.title",descriptionKey:"widgets.system_status.description",icon:Ru,defaultColSpan:1},{id:"DataInspectorComponent",titleKey:"widgets.data_inspector.title",descriptionKey:"widgets.data_inspector.description",icon:fo,defaultColSpan:1},{id:"DatabaseStatusComponent",titleKey:"widgets.database_status.title",descriptionKey:"widgets.database_status.description",icon:BS,defaultColSpan:1},{id:"ClockComponent",titleKey:"widgets.clock.title",descriptionKey:"widgets.clock.description",icon:Zm,defaultColSpan:1},{id:"WorklistComponent",titleKey:"widgets.worklist.title",descriptionKey:"widgets.worklist.description",icon:nf,defaultColSpan:1}],qre=e=>Kre[e]||null,zre=fA("CustomDashboardView"),_S=({id:e,className:t,children:r})=>{const{attributes:a,listeners:n,setNodeRef:s,transform:l,isDragging:A}=Ere({id:e}),{setNodeRef:u,isOver:f}=Tre({id:e}),h=g=>{s(g),u(g)};return c.jsx("div",{ref:h,style:{transform:o2.Translate.toString(l)},className:`${t||""} ${A?"opacity-50 z-10":""} ${f&&!A?"ring-2 ring-blue-300 rounded-xl":""}`,...a,...n,children:r})},Vre=()=>{const{t:e}=tn(),[t,r]=X.useState([]),[a,n]=X.useState(null),[s,l]=X.useState(!1),[A,u]=X.useState(!1),[f,h]=X.useState(!1),[g,x]=X.useState("system"),[m,w]=X.useState(""),[v,B]=X.useState(!1),[k,N]=X.useState(!1),[S,O]=hr("dashboard_tools_open",!1),[T,U]=hr("dashboard_tools_tab_v1","layout"),[D,H]=X.useState([]),{visibleSidebarComponentIds:j,setVisibleSidebarComponentIds:W,togglePresentationMode:I,isReadOnly:Q}=Mo(),{isExporting:Y,exportToPdf:z}=Sy(),ue=yte(AS(jy,{activationConstraint:{distance:8}}),AS(Ly,{coordinateGetter:Ure})),{data:Z,refresh:Ae}=ri(async()=>await Dt.executeRaw("SELECT * FROM sys_user_widgets ORDER BY created_at DESC"),[]),ve=ar.useRef(!1);X.useEffect(()=>{(async()=>{if(ve.current)return;ve.current=!0;let J=await Dt.getDashboards();const ze=localStorage.getItem("custom_dashboard_layout");if(J.length===0){const yt={id:crypto.randomUUID(),name:e("dashboard.default_name"),layout:ze?JSON.parse(ze):[],is_default:!0};await Dt.saveDashboard(yt,!0),ze&&localStorage.removeItem("custom_dashboard_layout"),J=[yt]}else J.length>0&&(J=J.map(yt=>({...yt,layout:typeof yt.layout=="string"?JSON.parse(yt.layout):yt.layout})));r(J);const He=window.location.hash||"#/",ct=He.includes("?")?He.slice(He.indexOf("?")+1):"",Xe=ct?new URLSearchParams(ct).get("dashboard"):null,Ut=Xe&&J.some(yt=>yt.id===Xe)?Xe:J[0]?.id??null;n(Ut),l(!0)})()},[e]);const G=t.find(_e=>_e.id===a);X.useEffect(()=>{if(!G||!Z)return;(async()=>{const je=G.layout.map(ct=>ct.id),J=Z.filter(ct=>je.includes(ct.id)),ze=new Set;J.forEach(ct=>{const Xe=ct.sql_query.match(/FROM\s+([a-zA-Z0-9_]+)/i);Xe&&ze.add(Xe[1])});const He=new Set;for(const ct of Array.from(ze))try{const Xe=await Dt.getTableSchema(ct);Xe&&Array.isArray(Xe)&&Xe.forEach(Ut=>He.add(Ut.name))}catch(Xe){zre.error("Error fetching schema for table",ct,Xe)}H(Array.from(He).sort())})()},[G,Z]);const Se=async _e=>{await Dt.saveDashboard(_e),r(je=>je.map(J=>J.id===_e.id?_e:J))},we=async(_e,je)=>{if(!G||G.layout.find(ze=>ze.id===_e))return;const J={...G,layout:[...G.layout,{id:_e,type:je}]};await Se(J),u(!1)},F=async _e=>{if(!G)return;const je={...G,layout:G.layout.filter(J=>J.id!==_e)};await Se(je)},R=async _e=>{if(Q||!G)return;const{active:je,over:J}=_e;if(!J||je.id===J.id)return;const ze=G.layout.findIndex(Xe=>Xe.id===String(je.id)),He=G.layout.findIndex(Xe=>Xe.id===String(J.id));if(ze<0||He<0)return;const ct=yS(G.layout,ze,He);await Se({...G,layout:ct})},M=async(_e,je)=>{if(!G)return;const J=G.layout.findIndex(ct=>ct.id===_e);if(J<0)return;const ze=J+je;if(ze<0||ze>=G.layout.length)return;const He=yS(G.layout,J,ze);await Se({...G,layout:He})},P=async(_e="")=>{G&&await Se({...G,filters:[...G.filters||[],{column:_e,operator:"=",value:""}]})},re=async(_e,je)=>{if(!G)return;const J=[...G.filters||[]];J[_e]={...J[_e],...je},await Se({...G,filters:J})},ge=async _e=>{G&&await Se({...G,filters:(G.filters||[]).filter((je,J)=>J!==_e)})},Ce=async()=>{G&&await Se({...G,filters:[]})},de=_e=>{if(_e.type==="system"){const je=Yv.find(J=>J.id===_e.id);return je?e(je.titleKey):_e.id}return Z?.find(je=>je.id===_e.id)?.name||_e.id},be=async _e=>{await Xt.confirm(e("dashboard.confirm_delete_report"))&&(await Dt.executeRaw(`DELETE FROM sys_user_widgets WHERE id = '${_e}'`),Ae(),F(_e))},Le=async()=>{if(!m.trim())return;const _e={id:crypto.randomUUID(),name:m,layout:[],is_default:!1};await Dt.saveDashboard(_e),r([...t,_e]),n(_e.id),w(""),B(!1)},ie=async _e=>{if(t.length<=1||!await Xt.confirm(e("dashboard.delete_confirm")))return;await Dt.deleteDashboard(_e);const je=t.filter(J=>J.id!==_e);r(je),a===_e&&n(je[0].id)};return s?c.jsxs(t0,{header:{title:e("dashboard.title"),subtitle:e("dashboard.subtitle"),actions:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:I,className:"p-2 text-slate-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors border border-transparent hover:border-blue-100 dark:hover:border-blue-800/40",title:e("dashboard.presentation_mode"),children:c.jsx(Jm,{className:"w-5 h-5"})}),c.jsxs("button",{onClick:()=>z("dashboard-grid",`dashboard-${G?.name||"export"}`),disabled:Y,className:"flex items-center gap-2 px-3 py-2 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-300 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors shadow-sm font-medium text-sm disabled:opacity-50",children:[c.jsx(jp,{className:"w-4 h-4"}),e(Y?"common.exporting":"common.export_pdf")]}),c.jsx("button",{onClick:()=>N(!k),className:`p-2 rounded-lg transition-colors border ${k?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800 text-blue-600 dark:text-blue-300":"text-slate-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border-transparent hover:border-blue-100 dark:hover:border-blue-800/40"}`,title:e("querybuilder.filter"),children:c.jsx(sf,{className:"w-5 h-5"})}),!Q&&c.jsxs("button",{onClick:()=>u(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm font-medium text-sm",children:[c.jsx(Io,{className:"w-4 h-4"}),e("dashboard.add_title")]})]})},rightPanel:{title:e("dashboard.tools_title","Dashboard Tools"),enabled:!!G,triggerTitle:e("dashboard.tools_title","Dashboard Tools"),width:"sm",isOpen:S,onOpenChange:O,content:c.jsxs("div",{className:"h-full min-h-0 flex flex-col gap-4",children:[c.jsxs("div",{className:"inline-flex items-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 p-1 flex-shrink-0",children:[c.jsx("button",{type:"button",onClick:()=>U("layout"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${T==="layout"?"bg-blue-600 text-white":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:e("dashboard.tools_tab_layout","Layout")}),c.jsx("button",{type:"button",onClick:()=>U("filters"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${T==="filters"?"bg-blue-600 text-white":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:e("dashboard.tools_tab_filters","Filters")})]}),G?T==="layout"?c.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-2",children:[c.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:e("dashboard.tools_layout_hint","Reorder widgets and remove items without leaving the dashboard.")}),c.jsx("div",{className:"flex-1 min-h-0 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg divide-y divide-slate-100 dark:divide-slate-700",children:G.layout.length===0?c.jsx("div",{className:"p-3 text-xs text-slate-400 dark:text-slate-500",children:e("dashboard.no_reports")}):G.layout.map((_e,je)=>c.jsxs("div",{className:"p-3 flex items-center justify-between gap-2",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"text-xs font-semibold text-slate-700 dark:text-slate-200 truncate",children:de(_e)}),c.jsx("div",{className:"text-[10px] text-slate-400 dark:text-slate-500 uppercase",children:_e.type})]}),!Q&&c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("button",{type:"button",onClick:()=>{M(_e.id,-1)},disabled:je===0,className:"h-7 w-7 inline-flex items-center justify-center rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300 disabled:opacity-40",title:e("dashboard.tools_move_up","Move up"),children:c.jsx(O8,{className:"w-3.5 h-3.5"})}),c.jsx("button",{type:"button",onClick:()=>{M(_e.id,1)},disabled:je===G.layout.length-1,className:"h-7 w-7 inline-flex items-center justify-center rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300 disabled:opacity-40",title:e("dashboard.tools_move_down","Move down"),children:c.jsx(R8,{className:"w-3.5 h-3.5"})}),c.jsx("button",{type:"button",onClick:()=>{F(_e.id)},className:"h-7 w-7 inline-flex items-center justify-center rounded border border-rose-200 dark:border-rose-800 bg-rose-50 dark:bg-rose-900/20 hover:bg-rose-100 dark:hover:bg-rose-900/30 text-rose-700 dark:text-rose-300",title:e("common.remove"),children:c.jsx(ds,{className:"w-3.5 h-3.5"})})]})]},`${_e.type}:${_e.id}`))})]}):c.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-2",children:[c.jsxs("div",{className:"flex items-center justify-between gap-2",children:[c.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:e("dashboard.tools_filters_hint","Manage global dashboard filters in one place.")}),!Q&&c.jsx("button",{type:"button",onClick:()=>{P("")},className:"h-7 px-2 rounded border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/30 text-blue-700 dark:text-blue-300 text-[11px] font-semibold",children:e("dashboard.add_filter")})]}),!Q&&c.jsx("div",{className:"flex items-center justify-end",children:c.jsx("button",{type:"button",onClick:()=>{Ce()},className:"text-[11px] text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200",children:e("dashboard.tools_clear_filters","Clear filters")})}),c.jsx("div",{className:"flex-1 min-h-0 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg divide-y divide-slate-100 dark:divide-slate-700",children:(G.filters||[]).length===0?c.jsx("div",{className:"p-3 text-xs text-slate-400 dark:text-slate-500",children:e("dashboard.no_filters")}):(G.filters||[]).map((_e,je)=>c.jsxs("div",{className:"p-3 space-y-2",children:[c.jsx("input",{list:"suggested-columns",value:_e.column,onChange:J=>{re(je,{column:J.target.value})},placeholder:e("dashboard.filter_column"),className:"w-full h-8 px-2 border border-slate-200 dark:border-slate-700 rounded bg-white dark:bg-slate-900 text-xs text-slate-700 dark:text-slate-200 outline-none"}),c.jsxs("div",{className:"grid grid-cols-[1fr_1fr_auto] gap-2",children:[c.jsxs("select",{value:_e.operator,onChange:J=>{re(je,{operator:J.target.value})},className:"h-8 px-2 border border-slate-200 dark:border-slate-700 rounded bg-white dark:bg-slate-900 text-xs text-slate-700 dark:text-slate-200 outline-none",children:[c.jsx("option",{value:"=",children:"="}),c.jsx("option",{value:"!=",children:"!="}),c.jsx("option",{value:">",children:">"}),c.jsx("option",{value:"<",children:"<"}),c.jsx("option",{value:"contains",children:e("dashboard.op_contains")}),c.jsx("option",{value:"is null",children:e("dashboard.op_is_null")})]}),c.jsx("input",{value:_e.value,onChange:J=>{re(je,{value:J.target.value})},placeholder:e("dashboard.filter_value"),className:"h-8 px-2 border border-slate-200 dark:border-slate-700 rounded bg-white dark:bg-slate-900 text-xs text-slate-700 dark:text-slate-200 outline-none"}),!Q&&c.jsx("button",{type:"button",onClick:()=>{ge(je)},className:"h-8 w-8 inline-flex items-center justify-center rounded border border-rose-200 dark:border-rose-800 bg-rose-50 dark:bg-rose-900/20 hover:bg-rose-100 dark:hover:bg-rose-900/30 text-rose-700 dark:text-rose-300",title:e("common.remove"),children:c.jsx(ds,{className:"w-3.5 h-3.5"})})]})]},je))})]}):c.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:e("common.no_data")})]})},children:[k&&G&&c.jsxs("div",{className:"mb-6 p-4 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl shadow-sm animate-in slide-in-from-top-2 duration-300",children:[c.jsx("datalist",{id:"suggested-columns",children:D.map(_e=>c.jsx("option",{value:_e},_e))}),c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsxs("h4",{className:"text-xs font-black uppercase text-slate-400 flex items-center gap-2",children:[c.jsx(sf,{className:"w-3.5 h-3.5 text-blue-500"})," ",e("dashboard.filters_title")]}),c.jsx("p",{className:"text-[10px] text-slate-400",children:e("dashboard.filters_subtitle","Slicers that affect all dashboard charts simultaneously.")})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[D.filter(_e=>["Year","FiscalYear","Date","Month","Category","Group","Type","Status"].some(je=>_e.toLowerCase().includes(je.toLowerCase()))).slice(0,3).map(_e=>c.jsxs("button",{onClick:()=>Se({...G,filters:[...G.filters||[],{column:_e,operator:"=",value:""}]}),className:"px-2 py-1 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded text-[10px] font-bold text-slate-500 hover:text-blue-600 transition-colors",children:["+ ",_e]},_e)),c.jsx("button",{onClick:()=>Se({...G,filters:[...G.filters||[],{column:"",operator:"=",value:""}]}),className:"px-3 py-1 bg-blue-600 text-white rounded text-[10px] font-bold shadow-sm shadow-blue-100 hover:bg-blue-700 transition-colors",children:e("dashboard.add_filter")})]})]}),c.jsxs("div",{className:"space-y-2",children:[(G.filters||[]).map((_e,je)=>c.jsxs("div",{className:"flex items-center gap-2 group animate-in slide-in-from-left-2 duration-200",style:{animationDelay:`${je*50}ms`},children:[c.jsxs("div",{className:"flex-1 grid grid-cols-12 gap-2 p-1 bg-slate-50 dark:bg-slate-800/50 border border-slate-100 dark:border-slate-800 rounded-lg group-hover:border-slate-200 group-hover:bg-white dark:group-hover:bg-slate-800 transition-all",children:[c.jsx("input",{placeholder:e("dashboard.filter_column"),list:"suggested-columns",className:"col-span-4 p-1.5 text-[11px] bg-transparent outline-none font-bold text-slate-700 dark:text-slate-200",value:_e.column,onChange:J=>{const ze=[...G.filters||[]];ze[je].column=J.target.value,Se({...G,filters:ze})}}),c.jsxs("select",{className:"col-span-3 p-1.5 text-[11px] bg-transparent outline-none border-l border-slate-100 dark:border-slate-800 text-slate-500 font-medium cursor-pointer",value:_e.operator,onChange:J=>{const ze=[...G.filters||[]];ze[je].operator=J.target.value,Se({...G,filters:ze})},children:[c.jsx("option",{value:"=",children:"="}),c.jsx("option",{value:"!=",children:"!="}),c.jsx("option",{value:">",children:">"}),c.jsx("option",{value:"<",children:"<"}),c.jsx("option",{value:"contains",children:e("dashboard.op_contains")}),c.jsx("option",{value:"is null",children:e("dashboard.op_is_null")})]}),c.jsx("input",{placeholder:e("dashboard.filter_value"),className:"col-span-5 p-1.5 text-[11px] bg-transparent outline-none border-l border-slate-100 dark:border-slate-800 font-bold text-blue-600 dark:text-blue-400 placeholder:text-blue-200",value:_e.value,onChange:J=>{const ze=[...G.filters||[]];ze[je].value=J.target.value,Se({...G,filters:ze})}})]}),c.jsx("button",{onClick:()=>Se({...G,filters:(G.filters||[]).filter((J,ze)=>ze!==je)}),className:"p-1.5 text-slate-300 hover:text-red-500 transition-colors bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-lg shadow-sm",children:c.jsx(ds,{className:"w-3.5 h-3.5"})})]},je)),(G.filters||[]).length===0&&c.jsxs("div",{className:"py-8 text-center border-2 border-dashed border-slate-50 dark:border-slate-800 rounded-xl",children:[c.jsx(sf,{className:"w-8 h-8 mx-auto mb-2 text-slate-200"}),c.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-slate-300",children:e("dashboard.no_filters")})]})]})]}),c.jsxs("div",{className:"mb-6 flex items-center justify-between border-b border-slate-200 dark:border-slate-800",children:[c.jsxs("div",{className:"flex items-center gap-1 overflow-x-auto no-scrollbar pb-px",children:[t.map(_e=>c.jsx("button",{onClick:()=>n(_e.id),className:`px-4 py-2.5 text-sm font-bold transition-all border-b-2 whitespace-nowrap ${a===_e.id?"text-blue-600 border-blue-600":"text-slate-400 border-transparent hover:text-slate-600"}`,children:_e.name},_e.id)),!Q&&c.jsx("button",{onClick:()=>{B(!0),w("")},className:"px-4 py-2.5 text-slate-400 hover:text-blue-600 transition-all border-b-2 border-transparent",title:e("dashboard.new_dashboard_title"),children:c.jsx(Io,{className:"w-4 h-4"})})]}),!Q&&c.jsx("button",{onClick:()=>h(!0),className:"p-2 text-slate-400 hover:text-slate-600",title:e("dashboard.manage_title"),children:c.jsx(cp,{className:"w-4 h-4"})})]}),v&&c.jsxs("div",{className:"mb-6 p-4 bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-800 rounded-xl flex items-center gap-3",children:[c.jsx(xi,{className:"w-5 h-5 text-slate-400"}),c.jsx("input",{autoFocus:!0,type:"text",placeholder:e("dashboard.new_dashboard_placeholder"),className:"flex-1 bg-transparent border-none outline-none font-bold text-slate-700 dark:text-slate-200",value:m,onChange:_e=>w(_e.target.value),onKeyDown:_e=>_e.key==="Enter"&&Le()}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("button",{onClick:Le,className:"p-1.5 text-green-600 hover:bg-green-50 rounded",children:c.jsx(Px,{className:"w-4 h-4"})}),c.jsx("button",{onClick:()=>B(!1),className:"p-1.5 text-slate-400 hover:bg-slate-100 rounded",children:c.jsx(nl,{className:"w-4 h-4"})})]})]}),G&&G.layout.length===0?c.jsxs("div",{className:"flex flex-col items-center justify-center p-12 border-2 border-dashed border-slate-200 rounded-xl bg-slate-50 text-slate-400",children:[c.jsx(xi,{className:"w-12 h-12 mb-4 opacity-50"}),c.jsx("h3",{className:"font-bold text-lg text-slate-600",children:e("dashboard.empty_msg",{name:G.name})}),c.jsx("p",{className:"mb-4 text-sm text-center",children:e("dashboard.empty_hint")}),!Q&&c.jsx("button",{onClick:()=>u(!0),className:"px-6 py-2 bg-white border border-slate-200 rounded-lg text-blue-600 font-bold hover:shadow-sm transition-all text-sm",children:e("dashboard.add_title")})]}):G?c.jsx(kre,{sensors:ue,collisionDetection:Bte,onDragEnd:_e=>{R(_e)},children:c.jsx("div",{id:"dashboard-grid",className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6 auto-rows-[300px]",children:G.layout.map(_e=>{if(_e.type==="system"){const ze=Yv.find(ct=>ct.id===_e.id);if(!ze)return null;const He=qre(ze.id);return He?c.jsxs(_S,{id:_e.id,className:`relative group h-full ${ze.defaultColSpan===2?"md:col-span-2":""}`,children:[!Q&&c.jsx("div",{className:"absolute -top-2 -right-2 z-20 opacity-0 group-hover:opacity-100 transition-opacity",children:c.jsx("button",{onClick:ct=>{ct.stopPropagation(),F(_e.id)},className:"p-1.5 bg-white/95 backdrop-blur-sm border border-slate-200 rounded-full text-slate-400 hover:text-red-500 shadow-sm",title:e("common.remove"),children:c.jsx(ds,{className:"w-3 h-3"})})}),c.jsx("div",{className:"h-full",children:c.jsx(He,{onRemove:void 0,targetView:Fu.find(ct=>ct.component===ze.id)?.targetView})})]},_e.id):null}const je=Z?.find(ze=>ze.id===_e.id);if(!je)return null;let J;try{J=JSON.parse(je.visualization_config)}catch{J={type:"table"}}return c.jsxs(_S,{id:_e.id,className:"relative group md:col-span-1 xl:col-span-2 h-full",children:[!Q&&c.jsx("div",{className:"absolute -top-2 -right-2 z-20 opacity-0 group-hover:opacity-100 transition-opacity",children:c.jsx("button",{onClick:()=>F(_e.id),className:"p-1.5 bg-white/95 backdrop-blur-sm border border-slate-200 rounded-full text-slate-400 hover:text-red-500 shadow-sm",title:"Entfernen",children:c.jsx(ds,{className:"w-3 h-3"})})}),c.jsx(d2,{title:je.name,sql:je.sql_query,config:J,globalFilters:G.filters,showInspectorJump:!0,inspectorReturnHash:G?.id?`#/?dashboard=${encodeURIComponent(G.id)}`:"#/"})]},_e.id)})})}):null,c.jsx(Ol,{isOpen:f,onClose:()=>h(!1),title:e("dashboard.manage_title"),children:c.jsxs("div",{className:"space-y-3",children:[t.map(_e=>c.jsxs("div",{className:"flex items-center justify-between p-3 bg-white border border-slate-200 rounded-lg group",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(xi,{className:"w-4 h-4 text-slate-400"}),c.jsx("span",{className:"font-bold text-slate-700",children:_e.name}),_e.is_default&&c.jsx("span",{className:"text-[10px] bg-blue-50 text-blue-600 px-1.5 py-0.5 rounded font-black uppercase tracking-wider",children:"Default"})]}),c.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[c.jsx("button",{onClick:async()=>{const je=await Xt.prompt("Name fuer Dashboard:",{defaultValue:_e.name});je&&je!==_e.name&&Se({..._e,name:je})},className:"p-1.5 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded",children:c.jsx(jS,{className:"w-3.5 h-3.5"})}),c.jsx("button",{onClick:()=>ie(_e.id),disabled:t.length<=1,className:"p-1.5 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded disabled:opacity-30",children:c.jsx(ds,{className:"w-3.5 h-3.5"})})]})]},_e.id)),c.jsxs("button",{onClick:()=>{h(!1),B(!0)},className:"w-full p-3 border-2 border-dashed border-slate-100 rounded-lg text-slate-400 hover:text-blue-600 hover:border-blue-200 text-sm font-bold transition-all flex items-center justify-center gap-2",children:[c.jsx(Io,{className:"w-4 h-4"})," Neues Dashboard"]})]})}),c.jsxs(Ol,{isOpen:A,onClose:()=>u(!1),title:e("dashboard.add_title"),children:[c.jsxs("div",{className:"flex gap-4 mb-4 border-b border-slate-200",children:[c.jsx("button",{onClick:()=>x("system"),className:`pb-2 text-sm font-bold ${g==="system"?"text-blue-600 border-b-2 border-blue-600":"text-slate-400"}`,children:e("dashboard.system_widgets")}),c.jsx("button",{onClick:()=>x("custom"),className:`pb-2 text-sm font-bold ${g==="custom"?"text-blue-600 border-b-2 border-blue-600":"text-slate-400"}`,children:e("dashboard.custom_widgets")})]}),c.jsxs("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto min-h-[300px]",children:[g==="system"&&c.jsx("div",{className:"grid grid-cols-1 gap-2",children:Yv.map(_e=>{const je=G?.layout.some(ct=>ct.id===_e.id),J=Fu.find(ct=>ct.component===_e.id),ze=!!J?.targetView,He=ze&&j.includes(J.id);return c.jsxs("div",{className:"flex items-center justify-between p-3 border border-slate-200 rounded-lg hover:bg-slate-50",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-slate-100 rounded-lg text-slate-500",children:c.jsx(_e.icon,{className:"w-5 h-5"})}),c.jsxs("div",{children:[c.jsx("div",{className:"font-bold text-slate-700",children:e(_e.titleKey)}),c.jsx("div",{className:"text-xs text-slate-400",children:e(_e.descriptionKey)})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[ze&&c.jsx("button",{onClick:ct=>{ct.stopPropagation(),W(He?j.filter(Xe=>Xe!==J.id):[...j,J.id])},title:e(He?"dashboard.unpin_sidebar":"dashboard.pin_sidebar"),className:`p-1.5 rounded-md border transition-all ${He?"bg-amber-50 border-amber-200 text-amber-500":"bg-white border-slate-200 text-slate-300 hover:text-amber-400"}`,children:c.jsx(Qm,{className:`w-4 h-4 ${He?"fill-current":""}`})}),c.jsx("button",{onClick:()=>we(_e.id,"system"),disabled:je,className:`px-3 py-1.5 text-xs font-bold rounded ${je?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700 hover:bg-blue-200"}`,children:e(je?"dashboard.active":"common.add")})]})]},_e.id)})}),g==="custom"&&c.jsx("div",{className:"grid grid-cols-1 gap-2",children:Z&&Z.length>0?Z.map(_e=>{const je=G?.layout.some(J=>J.id===_e.id);return c.jsxs("div",{className:"flex items-center justify-between p-3 border border-slate-200 rounded-lg hover:bg-slate-50",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-blue-50 rounded-lg text-blue-500",children:c.jsx(_i,{className:"w-5 h-5"})}),c.jsxs("div",{children:[c.jsx("div",{className:"font-bold text-slate-700",children:_e.name}),c.jsx("div",{className:"text-xs text-slate-400 truncate max-w-[200px]",children:_e.sql_query})]})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:()=>be(_e.id),className:"p-2 text-slate-400 hover:text-red-500",title:e("common.delete"),children:c.jsx(ds,{className:"w-4 h-4"})}),c.jsx("button",{onClick:()=>we(_e.id,"custom"),disabled:je,className:`px-3 py-1.5 text-xs font-bold rounded ${je?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700 hover:bg-blue-200"}`,children:e(je?"dashboard.active":"common.add")})]})]},_e.id)}):c.jsx("p",{className:"text-center text-slate-400 py-4",children:e("dashboard.no_reports")})})]})]})]}):null},Gre=fA("WorklistView"),Wre=()=>{const{t:e}=tn(),[t,r]=X.useState([]),[a,n]=X.useState(!0),[s,l]=X.useState("all"),[A,u]=X.useState(""),{isReadOnly:f}=Mo(),[h,g]=X.useState(null),[x,m]=X.useState([]),[w,v]=X.useState(!1),B=X.useCallback(async()=>{n(!0);const T=await Dt.getWorklist(),U=await Promise.all(T.map(async D=>{const H=await Dt.checkRecordExists(D.source_table,D.source_id);return{...D,_exists:H}}));r(U),n(!1)},[]);X.useEffect(()=>{const T=window.setTimeout(()=>{B()},0);return window.addEventListener("db-updated",B),window.addEventListener("db-changed",B),()=>{window.clearTimeout(T),window.removeEventListener("db-updated",B),window.removeEventListener("db-changed",B)}},[B]);const k=async T=>{f||(await Dt.executeRaw("DELETE FROM sys_worklist WHERE id = ?",[T]),await B())},N=async T=>{let U=[];try{U=await Dt.executeRaw(`SELECT rowid as _rowid, * FROM "${T.source_table}" WHERE id = ?`,[T.source_id])}catch{try{const H=(await Dt.getTableSchema(T.source_table)).find(j=>j.pk===1||j.name.toLowerCase()==="id")?.name;H&&H.toLowerCase()!=="id"?U=await Dt.executeRaw(`SELECT rowid as _rowid, * FROM "${T.source_table}" WHERE "${H}" = ?`,[T.source_id]):U=await Dt.executeRaw(`SELECT rowid as _rowid, * FROM "${T.source_table}" WHERE rowid = ?`,[T.source_id])}catch(D){Gre.error("Failed to load details for",T,D)}}U.length>0?(m(U),g(T),v(!0)):(m([{...T,_deleted:!0}]),g(T),v(!0))},S=T=>{switch(T){case"done":return c.jsx(Bf,{className:"w-4 h-4 text-emerald-500"});case"in_progress":return c.jsx(Zm,{className:"w-4 h-4 text-blue-500"});case"closed":return c.jsx(H8,{className:"w-4 h-4 text-slate-400 opacity-50"});default:return c.jsx(il,{className:"w-4 h-4 text-amber-500"})}},O=t.filter(T=>s==="all"||T.status===s).filter(T=>T.display_label?.toLowerCase().includes(A.toLowerCase())||T.source_table?.toLowerCase().includes(A.toLowerCase())||T.comment?.toLowerCase().includes(A.toLowerCase()));return c.jsxs(t0,{header:{title:e("sidebar.worklist"),subtitle:e("worklist.subtitle"),onBack:()=>window.history.back()},children:[c.jsxs("div",{className:"max-w-5xl space-y-6",children:[c.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 bg-white dark:bg-slate-800 p-4 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("div",{className:"relative",children:[c.jsx(fo,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),c.jsx("input",{type:"text",placeholder:e("common.search"),value:A,onChange:T=>u(T.target.value),className:"pl-10 pr-4 py-2 bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-700 rounded-lg outline-none focus:ring-2 focus:ring-blue-500/20 w-64 text-sm font-medium"})]}),c.jsx("div",{className:"flex items-center gap-1 p-1 bg-slate-50 dark:bg-slate-900/50 rounded-lg border border-slate-200 dark:border-slate-700",children:[{id:"all",label:e("worklist.filter_all")},{id:"open",label:e("worklist.filter_open")},{id:"in_progress",label:e("worklist.filter_in_progress")},{id:"done",label:e("worklist.filter_done")},{id:"closed",label:e("worklist.filter_closed")}].map(T=>c.jsx("button",{onClick:()=>l(T.id),className:`px-3 py-1 text-[10px] font-black rounded-md transition-all ${s===T.id?"bg-white dark:bg-slate-700 text-blue-600 shadow-sm":"text-slate-400 hover:text-slate-600"}`,children:T.label.toUpperCase()},T.id))})]}),c.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:e("worklist.found_count",{count:O.length})})]}),a?c.jsxs("div",{className:"flex flex-col items-center justify-center py-20 animate-pulse",children:[c.jsx("div",{className:"w-12 h-12 bg-slate-200 dark:bg-slate-800 rounded-full mb-4"}),c.jsx("div",{className:"h-4 w-32 bg-slate-200 dark:bg-slate-800 rounded mb-2"}),c.jsx("div",{className:"h-3 w-48 bg-slate-200 dark:bg-slate-800 rounded opacity-50"})]}):O.length===0?c.jsxs("div",{className:"flex flex-col items-center justify-center py-20 bg-white dark:bg-slate-800/50 rounded-2xl border-2 border-dashed border-slate-200 dark:border-slate-800",children:[c.jsx("div",{className:"p-4 bg-slate-50 dark:bg-slate-900 rounded-full mb-4",children:c.jsx(nf,{className:"w-8 h-8 text-slate-300"})}),c.jsx("h3",{className:"text-sm font-bold text-slate-900 dark:text-white mb-1",children:e("worklist.empty_msg")}),c.jsx("p",{className:"text-xs text-slate-500 max-w-xs text-center",children:e("worklist.empty_hint")})]}):c.jsx("div",{className:"bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl shadow-sm overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full text-left text-sm whitespace-nowrap",children:[c.jsx("thead",{className:"bg-slate-50 dark:bg-slate-900/50 border-b border-slate-200 dark:border-slate-700 text-slate-500 dark:text-slate-400 uppercase text-[11px] font-black tracking-wider",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-3 w-40",children:e("worklist.status_label","Status")}),c.jsx("th",{className:"px-4 py-3",children:e("worklist.element_label","Element")}),c.jsx("th",{className:"px-4 py-3",children:e("worklist.table_label","Tabelle")}),c.jsx("th",{className:"px-4 py-3",children:e("worklist.context_label","Kontext")}),c.jsx("th",{className:"px-4 py-3 hidden md:table-cell",children:e("worklist.created_label","Erstellt am")}),c.jsx("th",{className:"px-4 py-3 text-right",children:e("common.actions","Aktionen")})]})}),c.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700/50",children:O.map(T=>c.jsxs("tr",{className:`group hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors ${T._exists?"":"bg-red-50/10"}`,children:[c.jsx("td",{className:"px-4 py-3",children:c.jsxs("select",{value:T.status,disabled:f,onChange:async U=>{f||(await Dt.updateWorklistItem(T.id,{status:U.target.value}),await B())},className:"w-full bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded p-1.5 text-[11px] font-bold outline-none cursor-pointer focus:ring-2 focus:ring-blue-500/20 text-slate-700 dark:text-slate-300",children:[c.jsx("option",{value:"open",children:e("worklist.status_open","Neu / Offen")}),c.jsx("option",{value:"in_progress",children:e("worklist.status_in_progress","In Bearbeitung")}),c.jsx("option",{value:"done",children:e("worklist.status_done","Erledigt")}),c.jsx("option",{value:"closed",children:e("worklist.status_closed","Geschlossen")})]})}),c.jsx("td",{className:"px-4 py-3",onClick:()=>N(T),children:c.jsxs("div",{className:"flex items-center gap-3 cursor-pointer",children:[S(T.status),c.jsx("span",{className:"font-bold text-slate-900 dark:text-white group-hover:text-blue-600 transition-colors",children:T.display_label||e("worklist.entry_id",{id:T.source_id})}),!T._exists&&c.jsxs("span",{className:"flex items-center gap-1 px-1.5 py-0.5 bg-red-100 dark:bg-red-900/30 text-[9px] font-black text-red-600 dark:text-red-400 rounded uppercase tracking-tighter shadow-sm",children:[c.jsx(il,{className:"w-2.5 h-2.5"})," ",e("common.deleted")]})]})}),c.jsx("td",{className:"px-4 py-3",children:c.jsx("span",{className:"px-2 py-1 bg-slate-100 dark:bg-slate-700/50 text-[10px] font-mono font-bold text-slate-500 dark:text-slate-400 rounded",children:T.source_table})}),c.jsx("td",{className:"px-4 py-3 text-slate-500 dark:text-slate-400",children:c.jsx("div",{className:"flex items-center gap-3 text-[11px]",children:T.comment?c.jsxs("span",{className:"flex items-center gap-1.5 text-slate-700 dark:text-slate-300 w-full max-w-[200px] truncate",title:T.comment,children:[c.jsx(M8,{className:"w-3 h-3 opacity-60 shrink-0"}),c.jsx("span",{className:"truncate",children:T.comment})]}):c.jsx("span",{className:"text-slate-400 dark:text-slate-600 italic",children:"-"})})}),c.jsx("td",{className:"px-4 py-3 text-slate-500 hidden md:table-cell text-[11px]",children:new Date(T.created_at).toLocaleDateString()}),c.jsx("td",{className:"px-4 py-3 text-right",children:c.jsxs("div",{className:"flex items-center justify-end gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[c.jsx("button",{onClick:()=>N(T),className:"p-1.5 text-slate-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-all",title:e("worklist.details_btn"),children:c.jsx(Nu,{className:"w-4 h-4"})}),!f&&c.jsx("button",{onClick:()=>k(T.id),className:"p-1.5 text-slate-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-all",title:e("worklist.remove_btn"),children:c.jsx(ds,{className:"w-4 h-4"})})]})})]},T.id))})]})})})]}),w&&h&&c.jsx(Zx,{isOpen:w,onClose:()=>v(!1),items:x,initialIndex:0,tableName:h.source_table,title:h.display_label??void 0})]})},Gd={github:"https://github.com/hrmnns/litebistudio",readme:"https://github.com/hrmnns/litebistudio/blob/main/README.md",changelog:"https://github.com/hrmnns/litebistudio/blob/main/CHANGELOG.md",docs:"https://github.com/hrmnns/litebistudio/wiki",website:"https://hrmnns.github.io/litebistudio/",contact:"https://www.cherware.de/contact/"},Xre=()=>{const{t:e}=tn(),t="1.1.0",r="20260226-1747",a=[{name:"React",description:e("about.tech_ui_framework")},{name:"TypeScript",description:e("about.tech_language")},{name:"Vite",description:e("about.tech_build_tool")},{name:"Tailwind CSS",description:e("about.tech_styling")},{name:"SQLite (WASM) + OPFS",description:e("about.tech_local_database")},{name:"Recharts",description:e("about.tech_visualization")},{name:"i18next + react-i18next",description:e("about.tech_i18n")},{name:"html2canvas + jsPDF",description:e("about.tech_pdf_export")},{name:"Lucide",description:e("about.tech_icon_system")}];return c.jsx(t0,{header:{title:e("about.title","About LiteBI Studio"),subtitle:e("about.subtitle","Information about the project and system"),onBack:()=>window.history.back()},breadcrumbs:[{label:e("sidebar.settings","Settings"),onClick:()=>window.location.hash="#/settings"},{label:e("about.title","About")}],children:c.jsxs("div",{className:"max-w-4xl space-y-8 pb-12",children:[c.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-indigo-700 rounded-3xl p-8 md:p-12 text-white shadow-xl relative overflow-hidden",children:[c.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row items-center gap-8",children:[c.jsx("div",{className:"p-4 bg-white/20 backdrop-blur-md rounded-2xl shadow-inner group transition-transform hover:scale-105",children:c.jsx(kS,{className:"w-16 h-16 md:w-20 md:h-20 text-white"})}),c.jsxs("div",{className:"text-center md:text-left",children:[c.jsx("h2",{className:"text-3xl md:text-4xl font-black tracking-tight mb-2",children:"LiteBI Studio"}),c.jsx("p",{className:"text-blue-100 text-lg md:text-xl font-medium max-w-xl",children:e("about.tagline","The lightweight business intelligence platform directly in your browser.")}),c.jsxs("div",{className:"mt-6 flex flex-wrap justify-center md:justify-start gap-3",children:[c.jsxs("span",{className:"px-3 py-1 bg-white/20 backdrop-blur-md rounded-full text-xs font-bold uppercase tracking-wider border border-white/30",children:["Version ",t]}),c.jsxs("span",{className:"px-3 py-1 bg-white/20 backdrop-blur-md rounded-full text-xs font-bold uppercase tracking-wider border border-white/30",children:["Build ",r]})]})]})]}),c.jsx("div",{className:"absolute top-0 right-0 -mr-16 -mt-16 w-64 h-64 bg-white/10 rounded-full blur-3xl"}),c.jsx("div",{className:"absolute bottom-0 left-0 -ml-16 -mb-16 w-64 h-64 bg-blue-900/20 rounded-full blur-3xl"})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"md:col-span-2 space-y-6",children:[c.jsxs("section",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm",children:[c.jsxs("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[c.jsx(P8,{className:"w-5 h-5 text-rose-500"}),e("about.philosophy_title","Our Philosophy")]}),c.jsxs("div",{className:"prose dark:prose-invert max-w-none text-slate-600 dark:text-slate-400 space-y-4",children:[c.jsx("p",{children:e("about.philosophy_description")}),c.jsxs("ul",{className:"list-disc pl-5 space-y-2",children:[c.jsxs("li",{children:[c.jsxs("strong",{children:[e("about.point_privacy_title"),":"]})," ",e("about.point_privacy_desc")]}),c.jsxs("li",{children:[c.jsxs("strong",{children:[e("about.point_speed_title"),":"]})," ",e("about.point_speed_desc")]}),c.jsxs("li",{children:[c.jsxs("strong",{children:[e("about.point_offline_title"),":"]})," ",e("about.point_offline_desc")]})]})]})]}),c.jsxs("section",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm",children:[c.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-4",children:e("about.tech_stack_title","Tech Stack")}),c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:a.map(n=>c.jsxs("div",{className:"p-4 rounded-xl bg-slate-50 dark:bg-slate-700/50 border border-slate-200 dark:border-slate-600 transition-colors hover:border-blue-500 group",children:[c.jsx("div",{className:"font-bold text-slate-900 dark:text-white group-hover:text-blue-600 transition-colors",children:n.name}),c.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:n.description})]},n.name))})]})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("section",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm",children:[c.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white mb-4",children:e("about.links_title","Links")}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("a",{href:Gd.github,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between p-3 rounded-xl bg-slate-50 dark:bg-slate-700/50 hover:bg-slate-100 dark:hover:bg-slate-700 transition-all group",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(K8,{className:"w-5 h-5 text-slate-700 dark:text-slate-300"}),c.jsx("span",{className:"text-sm font-medium",children:e("about.link_github","GitHub Repository")})]}),c.jsx(Nu,{className:"w-4 h-4 text-slate-400 opacity-0 group-hover:opacity-100 transition-opacity"})]}),c.jsxs("a",{href:Gd.readme,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between p-3 rounded-xl bg-slate-50 dark:bg-slate-700/50 hover:bg-slate-100 dark:hover:bg-slate-700 transition-all group",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Zv,{className:"w-5 h-5 text-indigo-500"}),c.jsx("span",{className:"text-sm font-medium",children:e("about.link_readme","README")})]}),c.jsx(Nu,{className:"w-4 h-4 text-slate-400 opacity-0 group-hover:opacity-100 transition-opacity"})]}),c.jsxs("a",{href:Gd.changelog,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between p-3 rounded-xl bg-slate-50 dark:bg-slate-700/50 hover:bg-slate-100 dark:hover:bg-slate-700 transition-all group",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Hh,{className:"w-5 h-5 text-amber-500"}),c.jsx("span",{className:"text-sm font-medium",children:e("about.link_changelog","Changelog")})]}),c.jsx(Nu,{className:"w-4 h-4 text-slate-400 opacity-0 group-hover:opacity-100 transition-opacity"})]}),c.jsxs("a",{href:Gd.docs,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between p-3 rounded-xl bg-slate-50 dark:bg-slate-700/50 hover:bg-slate-100 dark:hover:bg-slate-700 transition-all group",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Zv,{className:"w-5 h-5 text-blue-500"}),c.jsx("span",{className:"text-sm font-medium",children:e("about.link_docs","Documentation")})]}),c.jsx(Nu,{className:"w-4 h-4 text-slate-400 opacity-0 group-hover:opacity-100 transition-opacity"})]}),c.jsxs("a",{href:Gd.website,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between p-3 rounded-xl bg-slate-50 dark:bg-slate-700/50 hover:bg-slate-100 dark:hover:bg-slate-700 transition-all group",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Xm,{className:"w-5 h-5 text-emerald-500"}),c.jsx("span",{className:"text-sm font-medium",children:e("about.link_website","Website")})]}),c.jsx(Nu,{className:"w-4 h-4 text-slate-400 opacity-0 group-hover:opacity-100 transition-opacity"})]})]})]}),c.jsxs("section",{className:"bg-blue-50 dark:bg-blue-900/10 rounded-2xl border border-blue-100 dark:border-blue-900/30 p-6",children:[c.jsxs("h3",{className:"text-lg font-bold text-blue-900 dark:text-blue-100 mb-2 flex items-center gap-2",children:[c.jsx(q8,{className:"w-4 h-4"}),e("about.support_title","Support")]}),c.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300 mb-4 font-medium",children:e("about.support_text","Do you have questions or feedback? We look forward to your message.")}),c.jsx("a",{href:Gd.contact,target:"_blank",rel:"noopener noreferrer",className:"w-full inline-block text-center py-2.5 bg-blue-600 text-white rounded-lg font-bold text-sm shadow-lg shadow-blue-200 dark:shadow-none hover:bg-blue-700 transition-all active:scale-95",children:e("about.contact_cta","Contact us")})]}),c.jsx("div",{className:"px-2",children:c.jsxs("p",{className:"text-[10px] text-slate-400 dark:text-slate-500 uppercase tracking-widest font-bold",children:[e("about.copyright_prefix"," {{year}} LiteBI Studio Project. Released under ",{year:new Date().getFullYear()}),c.jsx("a",{href:"LICENSE",target:"_blank",rel:"noopener noreferrer",children:"MIT License"}),"."]})})]})]})]})})},Dm={async get(e){const t=await Kr("SELECT value FROM sys_settings WHERE key = ?",[e]);return t.length>0?t[0]?.value:null},async set(e,t){await Kr("INSERT OR REPLACE INTO sys_settings (key, value) VALUES (?, ?)",[e,t]),Oi()}},Yre=()=>{const{t:e}=tn(),t="report_pack_categories",r="report_pack_expanded_state",a=e("reports.default_category","General"),n="__all__",[s,l]=X.useState([]),[A,u]=X.useState([]),[f,h]=X.useState(n),[g,x]=X.useState(!1),[m,w]=X.useState(""),[v,B]=X.useState(!1),[k,N]=X.useState(null),[S,O]=X.useState({}),[T,U]=X.useState(!1),[D,H]=X.useState(!1),[j,W]=X.useState(null),[I,Q]=X.useState(null),Y=X.useRef(null),[z,ue]=X.useState({general:!0,cover:!0,headerFooter:!0,pageOptions:!0,preview:!0}),{isReadOnly:Z}=Mo(),{isExporting:Ae,exportProgress:ve,exportPackageToPdf:G}=Sy(),{data:Se}=ri(()=>Dt.getDashboards(),[]),{data:we}=ri(()=>Dt.getUserWidgets(),[]),F=X.useCallback(async()=>{const at=(await Dt.getReportPacks()).map(Et=>({...Et,category:typeof Et.category=="string"&&Et.category.trim().length>0?Et.category:a})),it=await Dm.get(r),bt={};if(it)try{const Et=JSON.parse(it);Object.entries(Et).forEach(([mt,Ot])=>{typeof Ot=="boolean"&&(bt[mt]=Ot)})}catch{}l(at),at.length>0&&!k&&N(at[0].id),O(()=>{const Et={};return at.forEach(mt=>{Et[mt.id]=bt[mt.id]??!0}),Et})},[k,a,r]),R=X.useCallback(async()=>{const Ee=await Dm.get(t);if(!Ee){u([]);return}try{const at=JSON.parse(Ee);if(!Array.isArray(at)){u([]);return}const it=Array.from(new Set(at.filter(bt=>typeof bt=="string").map(bt=>bt.trim()).filter(bt=>bt.length>0)));u(it)}catch{u([])}},[t]);X.useEffect(()=>{const Ee=window.setTimeout(()=>{F(),R()},0);return()=>window.clearTimeout(Ee)},[R,F]);const M=Ee=>{if(typeof Ee=="string")try{return JSON.parse(Ee)}catch{return{type:"table"}}return Ee&&typeof Ee=="object"?Ee:{type:"table"}},P=s.find(Ee=>Ee.id===k),re=(P?.config.coverLogoUrl||"").trim(),ge=X.useMemo(()=>{const Ee=s.map(at=>at.category||a);return Ee.push(a),Array.from(new Set([...Ee,...A])).sort((at,it)=>at.localeCompare(it))},[A,a,s]),Ce=m.trim(),de=ge.some(Ee=>Ee.toLowerCase()===Ce.toLowerCase()),be=Ce.length>0&&!de,Le=f===n||ge.includes(f)?f:n,ie=Le===n?s:s.filter(Ee=>(Ee.category||a)===Le),_e=Ee=>s.find(at=>at.id===Ee),je=Ee=>{ue(at=>({...at,[Ee]:!at[Ee]}))},J=Ee=>new Promise((at,it)=>{const bt=new FileReader;bt.onload=()=>at(String(bt.result||"")),bt.onerror=()=>it(new Error("Failed to read file")),bt.readAsDataURL(Ee)}),ze=async Ee=>{const at=Ee.target.files?.[0];if(!(!at||!P))try{const it=await J(at);W(null),await He({...P,config:{...P.config,coverLogoUrl:it}})}catch{await Xt.error(e("reports.logo_upload_failed","Logo upload failed."))}finally{Ee.target.value=""}},He=async Ee=>{if(Z)return;const at=typeof Ee.category=="string"&&Ee.category.trim().length>0?Ee.category.trim():a;await Dt.saveReportPack({...Ee,category:at}),await F()},ct=async Ee=>{const at=Array.from(new Set(Ee.map(it=>it.trim()).filter(it=>it.length>0)));u(at),await Dm.set(t,JSON.stringify(at))},Xe=async Ee=>{await Dm.set(r,JSON.stringify(Ee))},Ut=()=>{const Ee=Le===n?a:Le,at={id:crypto.randomUUID(),name:e("reports.new_pack_name"),category:Ee,description:"",config:{coverTitle:e("reports.new_pack_name"),coverSubtitle:new Date().toLocaleDateString(void 0,{month:"long",year:"numeric"}),author:"LiteBI Studio",coverLogoUrl:"",themeColor:"#1e293b",showTOC:!0,exportOptions:{showHeader:!0,showFooter:!0,headerText:"",footerText:"",footerMode:"content_only"},items:[]}};He(at),N(at.id),h(Ee)},yt=async()=>{Z||!be||(ge.includes(Ce)||await ct([...A,Ce]),h(Ce),x(!1),w(""))},qt=async Ee=>{if(Z||Ee===a)return;const it=(await Xt.prompt(e("reports.rename_category_prompt","New category name:"),{defaultValue:Ee}))?.trim();if(!it||it===Ee)return;if(ge.some(mt=>mt.toLowerCase()===it.toLowerCase()&&mt!==Ee)){await Xt.warning(e("reports.category_exists","A category with this name already exists."));return}const Et=s.filter(mt=>(mt.category||a)===Ee);await Promise.all(Et.map(mt=>Dt.saveReportPack({...mt,category:it}))),await ct(A.map(mt=>mt===Ee?it:mt)),f===Ee&&h(it),await F()},Lt=async Ee=>{if(Z||Ee===a)return;const at=s.filter(Et=>(Et.category||a)===Ee),it=at.length;(it===0?await Xt.confirm(e("reports.delete_category_confirm","Delete this category?")):await Xt.confirm(e("reports.delete_category_with_packs_confirm",{count:it,category:Ee,defaultValue:`Delete category "${Ee}" and all ${it} report packages in it?`})))&&(it>0&&(await Promise.all(at.map(Et=>Dt.deleteReportPack(Et.id))),k&&at.some(Et=>Et.id===k)&&N(null)),await ct(A.filter(Et=>Et!==Ee)),f===Ee&&h(n),await F())},jt=async Ee=>{Z||await Xt.confirm(e("common.confirm_delete"))&&(await Dt.deleteReportPack(Ee),await F(),k===Ee&&N(null))},Pt=Ee=>{O(at=>{const it={...at,[Ee]:!at[Ee]};return Xe(it),it})},zt=Ee=>{O(at=>{const it={...at};return s.forEach(bt=>{it[bt.id]=Ee}),Xe(it),it})},Jt=Ee=>{N(Ee),H(!0)},It=Ee=>{N(Ee),U(!0)},xt=(Ee,at,it)=>{const bt=_e(Ee);if(!bt)return;const Et=[...bt.config.items],mt=it==="up"?at-1:at+1;mt<0||mt>=Et.length||([Et[at],Et[mt]]=[Et[mt],Et[at]],He({...bt,config:{...bt.config,items:Et}}))},ht=(Ee,at)=>{const it=_e(Ee);if(!it)return;const bt=it.config.items.filter((Et,mt)=>mt!==at);He({...it,config:{...it.config,items:bt}})},Bt=Ee=>{P&&(He({...P,config:{...P.config,items:[...P.config.items,Ee]}}),H(!1))},pr=async(Ee,at)=>{Z||(await He({...Ee,category:at}),Q(null))},$t=async Ee=>{N(Ee.id),await new Promise(it=>requestAnimationFrame(()=>it()));const at=Ee.config.items.map(it=>{if(it.type==="dashboard"){const Et=Se?.find(mt=>mt.id===it.id);return{elementId:`export-dash-${it.id}`,title:it.titleOverride||Et?.name||"Dashboard",orientation:it.orientation||"landscape"}}const bt=we?.find(Et=>Et.id===it.id);return{elementId:`export-widget-${it.id}`,title:it.titleOverride||bt?.name||"Widget",orientation:it.orientation||"landscape"}});await G(Ee.name,at,{title:Ee.config.coverTitle,subtitle:Ee.config.coverSubtitle,author:Ee.config.author,logoUrl:Ee.config.coverLogoUrl?.trim(),themeColor:Ee.config.themeColor},Ee.config.exportOptions)};return c.jsxs(t0,{header:{title:e("reports.title","Report Packages"),subtitle:e("reports.subtitle","Build and export multi-page management reports."),actions:c.jsx("div",{className:"flex items-center gap-2",children:c.jsxs("button",{onClick:Ut,disabled:Z,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm font-medium text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:[c.jsx(Io,{className:"w-4 h-4"})," ",e("common.add")]})})},children:[c.jsxs("div",{className:`h-[calc(100vh-140px)] overflow-y-auto custom-scrollbar p-1 ${Z?"pointer-events-none opacity-80":""}`,children:[c.jsxs("div",{className:"space-y-5",children:[c.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200 dark:border-slate-800",children:[c.jsxs("div",{className:"flex items-center gap-1 overflow-x-auto no-scrollbar pb-px",children:[c.jsx("button",{onClick:()=>h(n),className:`px-4 py-2.5 text-sm font-bold transition-all border-b-2 whitespace-nowrap ${Le===n?"text-blue-600 border-blue-600":"text-slate-400 border-transparent hover:text-slate-600"}`,children:e("common.all","All")}),ge.map(Ee=>c.jsx("button",{onClick:()=>h(Ee),className:`px-4 py-2.5 text-sm font-bold transition-all border-b-2 whitespace-nowrap ${Le===Ee?"text-blue-600 border-blue-600":"text-slate-400 border-transparent hover:text-slate-600"}`,children:Ee},Ee)),!Z&&c.jsx("button",{onClick:()=>{x(!0),w("")},className:"px-4 py-2.5 text-slate-400 hover:text-blue-600 transition-all border-b-2 border-transparent",title:e("reports.new_category","New category"),children:c.jsx(Io,{className:"w-4 h-4"})})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("button",{onClick:()=>zt(!0),className:"p-2 text-slate-400 hover:text-slate-600",title:e("reports.expand_all_packs","Expand all reports"),children:c.jsx(Jm,{className:"w-4 h-4"})}),c.jsx("button",{onClick:()=>zt(!1),className:"p-2 text-slate-400 hover:text-slate-600",title:e("reports.collapse_all_packs","Collapse all reports"),children:c.jsx(h2,{className:"w-4 h-4"})}),!Z&&c.jsx("button",{onClick:()=>B(!0),className:"p-2 text-slate-400 hover:text-slate-600",title:e("reports.manage_categories","Manage categories"),children:c.jsx(cp,{className:"w-4 h-4"})})]})]}),g&&c.jsxs("div",{className:"mb-1 p-4 bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-800 rounded-xl flex items-center gap-3",children:[c.jsx(xi,{className:"w-5 h-5 text-slate-400"}),c.jsx("input",{autoFocus:!0,type:"text",placeholder:e("reports.new_category_placeholder","Category name (e.g. Management)"),className:"flex-1 bg-transparent border-none outline-none font-bold text-slate-700 dark:text-slate-200",value:m,onChange:Ee=>w(Ee.target.value),onKeyDown:Ee=>Ee.key==="Enter"&&void yt()}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("button",{onClick:()=>{yt()},disabled:!be,className:`p-1.5 rounded transition-colors ${be?"text-green-600 hover:bg-green-50":"text-slate-300 cursor-not-allowed"}`,children:c.jsx(Px,{className:"w-4 h-4"})}),c.jsx("button",{onClick:()=>{x(!1),w("")},className:"p-1.5 text-slate-400 hover:bg-slate-100 rounded",children:c.jsx(nl,{className:"w-4 h-4"})})]})]}),ie.map(Ee=>{const at=S[Ee.id]??!0,it=k===Ee.id,bt=Ee.category||a,Et=ge.filter(mt=>mt!==bt);return c.jsxs("section",{className:`bg-white dark:bg-slate-900 border rounded-2xl shadow-sm transition-all ${it?"border-blue-200 dark:border-blue-800":"border-slate-200 dark:border-slate-800"}`,children:[c.jsxs("div",{className:"flex items-center justify-between p-4",children:[c.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[c.jsx("button",{onClick:()=>Pt(Ee.id),className:"p-1 text-slate-400 hover:text-blue-600 rounded transition-colors",title:at?e("common.collapse","Collapse"):e("common.expand","Expand"),children:c.jsx(Ul,{className:`w-4 h-4 transition-transform ${at?"rotate-90":""}`})}),c.jsx("button",{onClick:()=>N(Ee.id),className:"w-10 h-10 bg-blue-50 dark:bg-blue-900/20 rounded-xl flex items-center justify-center text-blue-600 shrink-0",title:e("reports.pack_settings","Package Settings"),children:c.jsx(Zv,{className:"w-5 h-5"})}),c.jsxs("div",{className:"min-w-0",children:[c.jsx("h3",{className:"font-bold text-slate-800 dark:text-white leading-tight truncate",children:Ee.name}),c.jsxs("p",{className:"text-xs text-slate-400",children:[Ee.category||a,"  ",Ee.config.items.length," ",e("reports.pages","Pages")]})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[!Z&&c.jsxs("div",{className:"relative",children:[c.jsx("button",{onClick:()=>Q(mt=>mt===Ee.id?null:Ee.id),disabled:Et.length===0,className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors disabled:opacity-30 disabled:hover:text-slate-400 disabled:hover:bg-transparent",title:Et.length===0?e("reports.move_category_unavailable","No other category available"):e("reports.move_category","Move to category"),children:c.jsx(z8,{className:"w-4 h-4"})}),I===Ee.id&&Et.length>0&&c.jsx("div",{className:"absolute right-0 top-10 z-20 min-w-[170px] rounded-xl border border-slate-200 bg-white shadow-lg p-1",children:Et.map(mt=>c.jsx("button",{onClick:()=>{pr(Ee,mt)},className:"w-full text-left px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 rounded-lg transition-colors",children:mt},`${Ee.id}-move-${mt}`))})]}),!Z&&c.jsxs("button",{onClick:()=>Jt(Ee.id),className:"flex items-center gap-2 px-2 sm:px-3 py-2 border border-slate-200 dark:border-slate-700 rounded-lg text-slate-500 dark:text-slate-300 hover:text-blue-600 hover:border-blue-200 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors font-bold text-sm",title:e("reports.add_page","Add Page"),"aria-label":e("reports.add_page","Add Page"),children:[c.jsx(Io,{className:"w-4 h-4"}),c.jsx("span",{className:"hidden sm:inline",children:e("reports.add_page","Add Page")})]}),!Z&&c.jsx("button",{onClick:()=>It(Ee.id),className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:e("common.settings"),children:c.jsx(cp,{className:"w-5 h-5"})}),!Z&&c.jsx("button",{onClick:()=>jt(Ee.id),className:"p-2 text-slate-300 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors",title:e("common.delete"),children:c.jsx(ds,{className:"w-4 h-4"})}),c.jsxs("button",{onClick:()=>$t(Ee),disabled:Ae||Ee.config.items.length===0,className:"flex items-center gap-2 px-2 sm:px-4 py-2 bg-slate-900 dark:bg-white text-white dark:text-slate-900 rounded-lg hover:opacity-90 transition-all font-bold text-sm shadow-lg shadow-slate-200 dark:shadow-none disabled:opacity-50 disabled:cursor-not-allowed",title:Ae&&it?`${ve}%`:e("reports.export_batch"),"aria-label":Ae&&it?`${ve}%`:e("reports.export_batch"),children:[c.jsx(jp,{className:"w-4 h-4"}),c.jsx("span",{className:"hidden sm:inline",children:Ae&&it?`${ve}%`:e("reports.export_batch")})]})]})]}),at&&c.jsx("div",{className:"px-4 pb-4",children:Ee.config.items.length>0?c.jsx("div",{className:"space-y-3",children:Ee.config.items.map((mt,Ot)=>{const Ur=mt.type==="dashboard"?Se?.find(Vt=>Vt.id===mt.id):we?.find(Vt=>Vt.id===mt.id);return Ur?c.jsxs("div",{className:"flex items-center gap-4 p-4 bg-slate-50/70 dark:bg-slate-800/40 border border-slate-100 dark:border-slate-800 rounded-xl group hover:shadow-sm transition-all",children:[c.jsxs("div",{className:"flex flex-col gap-1 items-center",children:[c.jsx("button",{onClick:()=>xt(Ee.id,Ot,"up"),className:"text-slate-300 hover:text-blue-500 disabled:opacity-0",disabled:Ot===0,children:c.jsx(V8,{className:"w-3.5 h-3.5"})}),c.jsx("div",{className:"w-6 h-6 bg-white dark:bg-slate-900 rounded flex items-center justify-center text-[10px] font-black text-slate-400",children:Ot+1}),c.jsx("button",{onClick:()=>xt(Ee.id,Ot,"down"),className:"text-slate-300 hover:text-blue-500 disabled:opacity-0",disabled:Ot===Ee.config.items.length-1,children:c.jsx(G8,{className:"w-3.5 h-3.5"})})]}),c.jsx("div",{className:"w-10 h-10 bg-slate-100 dark:bg-slate-800 rounded-lg flex items-center justify-center",children:mt.type==="dashboard"?c.jsx(xi,{className:"w-5 h-5 text-slate-400"}):c.jsx(_i,{className:"w-5 h-5 text-slate-400"})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("div",{className:"text-sm font-bold text-slate-700 dark:text-slate-200 truncate",children:Ur.name}),c.jsx("div",{className:"text-[10px] font-black uppercase tracking-widest text-slate-400",children:mt.type})]}),c.jsx("button",{onClick:()=>ht(Ee.id,Ot),className:"p-2 text-slate-200 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-all",children:c.jsx(ds,{className:"w-4 h-4"})})]},Ot):null})}):c.jsx("div",{className:"text-center py-8 border border-dashed border-slate-200 dark:border-slate-700 rounded-xl text-slate-400 text-sm",children:e("reports.add_page","Add Page")})})]},Ee.id)}),s.length===0&&c.jsxs("div",{className:"text-center py-16 border-2 border-dashed border-slate-100 dark:border-slate-800 rounded-2xl",children:[c.jsx(Hh,{className:"w-10 h-10 mx-auto mb-3 text-slate-200"}),c.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-slate-300",children:e("reports.no_packages")})]}),s.length>0&&ie.length===0&&c.jsxs("div",{className:"text-center py-16 border-2 border-dashed border-slate-100 dark:border-slate-800 rounded-2xl",children:[c.jsx(Hh,{className:"w-10 h-10 mx-auto mb-3 text-slate-200"}),c.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-slate-300",children:e("reports.no_packages_in_category","No packages in this category yet.")})]})]}),c.jsx("div",{className:"fixed -left-[10000px] top-0 opacity-0 pointer-events-none w-[1400px]",children:P?.config.items.map((Ee,at)=>{if(Ee.type==="dashboard"){const Et=Se?.find(mt=>mt.id===Ee.id);return Et?c.jsxs("div",{id:`export-dash-${Ee.id}`,className:"bg-white p-10 min-h-[1000px]",children:[c.jsxs("div",{className:"mb-10 flex items-center justify-between border-b pb-4",children:[c.jsx("h1",{className:"text-3xl font-black text-slate-800",children:Et.name}),c.jsxs("span",{className:"text-sm text-slate-400 font-mono",children:[e("reports.page")," ",at+1]})]}),c.jsx("div",{className:"grid grid-cols-2 gap-10",children:Array.isArray(Et.layout)&&Et.layout.map(mt=>{const Ot=we?.find(Vt=>Vt.id===mt.id);if(!Ot)return null;const Ur=M(Ot.visualization_config);return c.jsx("div",{className:"h-[400px]",children:c.jsx(d2,{title:Ot.name,sql:Ot.sql_query,config:Ur})},mt.id)})})]},`ghost-dash-${at}`):null}const it=we?.find(Et=>Et.id===Ee.id);if(!it)return null;const bt=M(it.visualization_config);return c.jsx("div",{id:`export-widget-${Ee.id}`,className:"bg-white p-10 min-h-[1000px] flex flex-col items-center justify-center",children:c.jsx("div",{className:"w-full max-w-4xl h-[600px]",children:c.jsx(d2,{title:it.name,sql:it.sql_query,config:bt})})},`ghost-widget-${at}`)})})]}),c.jsx(Ol,{isOpen:T,onClose:()=>U(!1),title:e("reports.pack_settings","Package Settings"),children:P&&c.jsxs("div",{className:"space-y-6",children:[c.jsxs("section",{className:"space-y-3",children:[c.jsxs("button",{type:"button",onClick:()=>je("general"),className:"w-full flex items-center justify-between text-left",children:[c.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 tracking-wider cursor-pointer",children:e("reports.general")}),c.jsx(Ul,{className:`w-4 h-4 text-slate-400 transition-transform ${z.general?"rotate-90":""}`})]}),z.general&&c.jsxs("div",{className:"space-y-3",children:[c.jsx("input",{className:"w-full px-4 py-2 bg-slate-50 dark:bg-slate-800 border-none rounded-xl font-bold outline-none focus:ring-2 focus:ring-blue-500",value:P.name,onChange:Ee=>He({...P,name:Ee.target.value}),placeholder:e("reports.pack_name_placeholder")}),c.jsx("input",{className:"w-full px-4 py-2 bg-slate-50 dark:bg-slate-800 border-none rounded-xl font-medium outline-none focus:ring-2 focus:ring-blue-500",value:P.category||a,onChange:Ee=>He({...P,category:Ee.target.value}),placeholder:e("reports.category","Category")})]})]}),c.jsxs("section",{className:"space-y-3",children:[c.jsxs("button",{type:"button",onClick:()=>je("cover"),className:"w-full flex items-center justify-between text-left",children:[c.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 tracking-wider cursor-pointer",children:e("reports.cover_page")}),c.jsx(Ul,{className:`w-4 h-4 text-slate-400 transition-transform ${z.cover?"rotate-90":""}`})]}),z.cover&&c.jsxs("div",{className:"space-y-3 p-4 bg-slate-50 dark:bg-slate-800 rounded-2xl",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"flex items-center gap-2 text-[11px] font-bold text-slate-500",children:[c.jsx(Hh,{className:"w-3 h-3"})," ",e("reports.title_label")]}),c.jsx("input",{className:"w-full bg-white dark:bg-slate-900 px-3 py-1.5 rounded-lg text-sm border border-slate-100 dark:border-slate-700 outline-none",value:P.config.coverTitle,onChange:Ee=>He({...P,config:{...P.config,coverTitle:Ee.target.value}})})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"flex items-center gap-2 text-[11px] font-bold text-slate-500",children:[c.jsx(Ul,{className:"w-3 h-3"})," ",e("reports.subtitle_label")]}),c.jsx("input",{className:"w-full bg-white dark:bg-slate-900 px-3 py-1.5 rounded-lg text-sm border border-slate-100 dark:border-slate-700 outline-none",value:P.config.coverSubtitle||"",onChange:Ee=>He({...P,config:{...P.config,coverSubtitle:Ee.target.value}})})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"flex items-center gap-2 text-[11px] font-bold text-slate-500",children:[c.jsx(NS,{className:"w-3 h-3"})," ",e("reports.author")]}),c.jsx("input",{className:"w-full bg-white dark:bg-slate-900 px-3 py-1.5 rounded-lg text-sm border border-slate-100 dark:border-slate-700 outline-none",value:P.config.author||"",onChange:Ee=>He({...P,config:{...P.config,author:Ee.target.value}})})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("div",{className:"flex items-center gap-2 text-[11px] font-bold text-slate-500",children:e("reports.logo_url","Logo URL")}),c.jsx("input",{className:"w-full bg-white dark:bg-slate-900 px-3 py-1.5 rounded-lg text-sm border border-slate-100 dark:border-slate-700 outline-none",value:P.config.coverLogoUrl||"",onChange:Ee=>{W(null),He({...P,config:{...P.config,coverLogoUrl:Ee.target.value}})},placeholder:"https://..."}),c.jsxs("div",{className:"flex items-center gap-2 pt-1",children:[c.jsx("input",{ref:Y,type:"file",accept:"image/*",className:"hidden",onChange:Ee=>{ze(Ee)}}),c.jsx("button",{type:"button",onClick:()=>Y.current?.click(),className:"px-2.5 py-1.5 rounded-lg text-xs font-semibold bg-slate-100 hover:bg-slate-200 text-slate-700 transition-colors",children:e("reports.upload_logo","Upload logo")}),!!P.config.coverLogoUrl&&c.jsx("button",{type:"button",onClick:()=>{W(null),He({...P,config:{...P.config,coverLogoUrl:""}})},className:"px-2.5 py-1.5 rounded-lg text-xs font-semibold bg-red-50 hover:bg-red-100 text-red-600 transition-colors",children:e("common.remove","Remove")})]})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("div",{className:"flex items-center gap-2 text-[11px] font-bold text-slate-500",children:e("reports.theme_color","Theme Color")}),c.jsx("input",{type:"color",className:"w-full h-9 bg-white dark:bg-slate-900 px-1 py-1 rounded-lg border border-slate-100 dark:border-slate-700 outline-none",value:P.config.themeColor||"#1e293b",onChange:Ee=>He({...P,config:{...P.config,themeColor:Ee.target.value}})})]})]})]}),c.jsxs("section",{className:"space-y-3",children:[c.jsxs("button",{type:"button",onClick:()=>je("headerFooter"),className:"w-full flex items-center justify-between text-left",children:[c.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 tracking-wider cursor-pointer",children:e("reports.export_options","Header / Footer")}),c.jsx(Ul,{className:`w-4 h-4 text-slate-400 transition-transform ${z.headerFooter?"rotate-90":""}`})]}),z.headerFooter&&c.jsxs("div",{className:"space-y-3 p-4 bg-slate-50 dark:bg-slate-800 rounded-2xl",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("label",{className:"flex items-center gap-2 text-xs font-semibold text-slate-600",children:[c.jsx("input",{type:"checkbox",checked:P.config.exportOptions?.showHeader??!0,onChange:Ee=>He({...P,config:{...P.config,exportOptions:{...P.config.exportOptions||{},showHeader:Ee.target.checked}}})}),e("reports.show_header","Show header")]}),c.jsxs("label",{className:"flex items-center gap-2 text-xs font-semibold text-slate-600",children:[c.jsx("input",{type:"checkbox",checked:P.config.exportOptions?.showFooter??!0,onChange:Ee=>He({...P,config:{...P.config,exportOptions:{...P.config.exportOptions||{},showFooter:Ee.target.checked}}})}),e("reports.show_footer","Show footer")]})]}),c.jsx("input",{className:"w-full bg-white dark:bg-slate-900 px-3 py-1.5 rounded-lg text-sm border border-slate-100 dark:border-slate-700 outline-none",value:P.config.exportOptions?.headerText||"",onChange:Ee=>He({...P,config:{...P.config,exportOptions:{...P.config.exportOptions||{},headerText:Ee.target.value}}}),placeholder:e("reports.header_text","Header text (optional)")}),c.jsx("input",{className:"w-full bg-white dark:bg-slate-900 px-3 py-1.5 rounded-lg text-sm border border-slate-100 dark:border-slate-700 outline-none",value:P.config.exportOptions?.footerText||"",onChange:Ee=>He({...P,config:{...P.config,exportOptions:{...P.config.exportOptions||{},footerText:Ee.target.value}}}),placeholder:e("reports.footer_text","Footer text (optional)")})]})]}),c.jsxs("section",{className:"space-y-3",children:[c.jsxs("button",{type:"button",onClick:()=>je("pageOptions"),className:"w-full flex items-center justify-between text-left",children:[c.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 tracking-wider cursor-pointer",children:e("reports.page_options","Per-Page Options")}),c.jsx(Ul,{className:`w-4 h-4 text-slate-400 transition-transform ${z.pageOptions?"rotate-90":""}`})]}),z.pageOptions&&c.jsxs("div",{className:"space-y-2 p-4 bg-slate-50 dark:bg-slate-800 rounded-2xl max-h-[260px] overflow-y-auto custom-scrollbar",children:[P.config.items.length===0&&c.jsx("p",{className:"text-xs text-slate-400",children:e("reports.no_pages","No pages in this package yet.")}),P.config.items.map((Ee,at)=>{const it=Ee.type==="dashboard"?Se?.find(bt=>bt.id===Ee.id):we?.find(bt=>bt.id===Ee.id);return it?c.jsxs("div",{className:"p-3 bg-white dark:bg-slate-900 border border-slate-100 dark:border-slate-700 rounded-xl space-y-2",children:[c.jsxs("div",{className:"text-xs font-bold text-slate-700 dark:text-slate-200",children:[at+1,". ",it.name]}),c.jsx("input",{className:"w-full bg-slate-50 dark:bg-slate-800 px-2 py-1.5 rounded text-xs border border-slate-200 dark:border-slate-700 outline-none",value:Ee.titleOverride||"",onChange:bt=>{const Et=[...P.config.items];Et[at]={...Ee,titleOverride:bt.target.value},He({...P,config:{...P.config,items:Et}})},placeholder:e("reports.page_title_override","Page title override (optional)")}),c.jsxs("select",{className:"w-full bg-slate-50 dark:bg-slate-800 px-2 py-1.5 rounded text-xs border border-slate-200 dark:border-slate-700 outline-none",value:Ee.orientation||"landscape",onChange:bt=>{const Et=[...P.config.items];Et[at]={...Ee,orientation:bt.target.value},He({...P,config:{...P.config,items:Et}})},children:[c.jsx("option",{value:"landscape",children:e("reports.landscape","Landscape")}),c.jsx("option",{value:"portrait",children:e("reports.portrait","Portrait")})]})]},`${Ee.id}-${at}`):null})]})]}),c.jsxs("section",{className:"space-y-3",children:[c.jsxs("button",{type:"button",onClick:()=>je("preview"),className:"w-full flex items-center justify-between text-left",children:[c.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 tracking-wider cursor-pointer",children:e("reports.preview","Live Preview")}),c.jsx(Ul,{className:`w-4 h-4 text-slate-400 transition-transform ${z.preview?"rotate-90":""}`})]}),z.preview&&c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"rounded-2xl border border-slate-200 dark:border-slate-700 overflow-hidden shadow-sm",children:[c.jsxs("div",{className:"h-36 px-4 py-3 flex flex-col justify-between",style:{backgroundColor:P.config.themeColor||"#1e293b"},children:[c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsx("div",{className:"text-white text-sm font-black truncate",children:P.config.coverTitle||e("reports.title_label")}),re&&j!==re?c.jsx("img",{src:re,alt:"Logo preview",className:"w-10 h-10 object-contain rounded bg-white/80 p-1",referrerPolicy:"no-referrer",onError:()=>W(re)}):c.jsx("div",{className:"w-10 h-10 rounded bg-white/20 border border-white/30"})]}),c.jsx("div",{className:"text-xs text-slate-200",children:P.config.coverSubtitle||e("reports.subtitle_label")})]}),c.jsx("div",{className:"px-4 py-2 bg-white dark:bg-slate-900 border-t border-slate-100 dark:border-slate-800 text-[11px] text-slate-500",children:P.config.author||e("reports.author")})]}),c.jsxs("div",{className:"rounded-2xl border border-slate-200 dark:border-slate-700 overflow-hidden shadow-sm bg-white dark:bg-slate-900",children:[c.jsx("div",{className:"px-4 py-2 text-[10px] font-black uppercase tracking-wider text-slate-400 border-b border-slate-100 dark:border-slate-800",children:e("reports.content_page_preview","Content Page Preview")}),c.jsxs("div",{className:"p-4 space-y-3",children:[c.jsx("div",{className:`text-[11px] text-slate-500 ${P.config.exportOptions?.showHeader===!1?"opacity-30":""}`,children:P.config.exportOptions?.headerText||P.name||e("reports.header_text","Header text")}),c.jsx("div",{className:"h-16 rounded border border-dashed border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800/50 flex items-center justify-center text-xs text-slate-400",children:e("reports.page_content","Page content")}),c.jsxs("div",{className:`flex items-center justify-between text-[11px] text-slate-500 ${P.config.exportOptions?.showFooter===!1?"opacity-30":""}`,children:[c.jsx("span",{children:P.config.exportOptions?.footerText||e("reports.footer_text","Footer text")}),c.jsxs("span",{children:["1 / ",Math.max(1,P.config.items.length)]})]})]})]})]})]}),c.jsx("div",{className:"flex justify-end pt-4 border-t border-slate-100 dark:border-slate-800",children:c.jsx("button",{onClick:()=>U(!1),className:"px-6 py-2 bg-slate-900 text-white dark:bg-white dark:text-slate-900 rounded-xl font-bold text-sm",children:e("common.done","Done")})})]})}),c.jsx(Ol,{isOpen:D,onClose:()=>H(!1),title:e("reports.pick_content","Add Page"),children:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"text-[10px] font-black uppercase text-slate-400 mb-2",children:e("dashboard.dashboards")}),c.jsx("div",{className:"grid grid-cols-1 gap-1.5",children:Se?.map(Ee=>c.jsxs("button",{onClick:()=>Bt({type:"dashboard",id:Ee.id}),className:"flex items-center gap-3 p-3 text-left bg-slate-50 dark:bg-slate-800 hover:bg-blue-50 dark:hover:bg-blue-900/40 rounded-xl transition-all border border-transparent hover:border-blue-200 group",children:[c.jsx(xi,{className:"w-4 h-4 text-slate-400 group-hover:text-blue-500"}),c.jsx("span",{className:"text-sm font-bold text-slate-700 dark:text-slate-200",children:Ee.name})]},Ee.id))})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-[10px] font-black uppercase text-slate-400 mb-2",children:e("dashboard.reports")}),c.jsx("div",{className:"grid grid-cols-1 gap-1.5 max-h-[300px] overflow-y-auto custom-scrollbar",children:we?.map(Ee=>c.jsxs("button",{onClick:()=>Bt({type:"widget",id:Ee.id}),className:"flex items-center gap-3 p-3 text-left bg-slate-50 dark:bg-slate-800 hover:bg-blue-50 dark:hover:bg-blue-900/40 rounded-xl transition-all border border-transparent hover:border-blue-200 group",children:[c.jsx(_i,{className:"w-4 h-4 text-slate-400 group-hover:text-blue-500"}),c.jsx("span",{className:"text-sm font-bold text-slate-700 dark:text-slate-200",children:Ee.name})]},Ee.id))})]})]})}),c.jsx(Ol,{isOpen:v,onClose:()=>B(!1),title:e("reports.manage_categories","Manage categories"),children:c.jsxs("div",{className:"space-y-3",children:[ge.length===0&&c.jsx("div",{className:"text-center py-8 border border-dashed border-slate-200 dark:border-slate-700 rounded-xl text-slate-400 text-sm",children:e("reports.no_categories","No categories yet.")}),ge.map(Ee=>{const at=Ee===a,it=s.filter(bt=>(bt.category||a)===Ee).length;return c.jsxs("div",{className:"flex items-center justify-between p-3 bg-white border border-slate-200 rounded-lg group",children:[c.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[c.jsx(xi,{className:"w-4 h-4 text-slate-400 shrink-0"}),c.jsx("span",{className:"font-bold text-slate-700 truncate",children:Ee}),at&&c.jsx("span",{className:"text-[10px] bg-blue-50 text-blue-600 px-1.5 py-0.5 rounded font-black uppercase tracking-wider",children:e("common.default","Default")}),c.jsxs("span",{className:"text-[10px] bg-slate-100 text-slate-500 px-1.5 py-0.5 rounded font-black uppercase tracking-wider",children:[it," ",e("reports.packages","packages")]})]}),!Z&&c.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[c.jsx("button",{onClick:()=>{qt(Ee)},disabled:at,className:"p-1.5 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded disabled:opacity-30 disabled:hover:text-slate-400 disabled:hover:bg-transparent",title:e("common.rename","Rename"),children:c.jsx(jS,{className:"w-3.5 h-3.5"})}),c.jsx("button",{onClick:()=>{Lt(Ee)},disabled:at,className:"p-1.5 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded disabled:opacity-30 disabled:hover:text-slate-400 disabled:hover:bg-transparent",title:at?e("reports.default_category_protected","Default category cannot be deleted"):it>0?e("reports.delete_with_content","Delete category and its report packages"):e("reports.delete_empty_category","Delete empty category"),children:c.jsx(ds,{className:"w-3.5 h-3.5"})})]})]},Ee)})]})})]})},$re=()=>c.jsx(d8,{children:c.jsx(f8,{children:c.jsxs(Tc,{element:c.jsx(uq,{}),children:[c.jsx(Tc,{index:!0,element:c.jsx(Vre,{})}),c.jsx(Tc,{path:"datasource",element:c.jsx(RV,{onImportComplete:()=>{window.location.hash="#/"}})}),c.jsx(Tc,{path:"settings",element:c.jsx(Eq,{})}),c.jsx(Tc,{path:"inspector",element:c.jsx(HV,{onBack:()=>window.history.back()})}),c.jsx(Tc,{path:"query",element:c.jsx(ote,{})}),c.jsx(Tc,{path:"worklist",element:c.jsx(Wre,{})}),c.jsx(Tc,{path:"about",element:c.jsx(Xre,{})}),c.jsx(Tc,{path:"reports",element:c.jsx(Yre,{})})]})})}),Jre=()=>{const{t:e}=tn(),[t,r]=ar.useState(null),[a,n]=ar.useState("");if(ar.useEffect(()=>rq(h=>new Promise(g=>{n(h.defaultValue||""),r({...h,resolve:g})})),[]),!t)return null;const s=()=>{t.kind==="prompt"?t.resolve({confirmed:!1,value:void 0}):t.kind==="confirm"?t.resolve({confirmed:!1}):t.resolve({confirmed:!0}),r(null)},l=()=>{t.kind==="prompt"?t.resolve({confirmed:!0,value:a}):t.resolve({confirmed:!0}),r(null)},A=t.title||(t.kind==="error"?e("common.error"):t.kind==="warning"?e("common.warning","Warning"):t.kind==="confirm"?e("common.confirm_title"):t.kind==="prompt"?e("common.input","Input"):e("common.info","Information")),u=t.kind==="error"?il:t.kind==="warning"?Ou:t.kind==="info"?_i:qc,f=t.kind==="error"?"text-rose-700 bg-rose-50 ring-rose-200 dark:text-rose-300 dark:bg-rose-500/15 dark:ring-rose-400/30":t.kind==="warning"?"text-amber-700 bg-amber-50 ring-amber-200 dark:text-amber-300 dark:bg-amber-500/15 dark:ring-amber-400/30":"text-blue-700 bg-blue-50 ring-blue-200 dark:text-blue-300 dark:bg-blue-500/15 dark:ring-blue-400/30";return c.jsx(Ol,{isOpen:!0,onClose:s,title:A,variant:"dialog",noScroll:!0,children:c.jsxs("div",{className:"flex h-full min-h-[170px] flex-col",children:[c.jsx("div",{className:"flex-1 p-5",children:c.jsxs("div",{className:"grid grid-cols-[64px_minmax(0,1fr)] items-start gap-y-4",children:[c.jsx("div",{className:"flex justify-center pt-0.5",children:c.jsx("span",{className:`inline-flex h-12 w-12 items-center justify-center rounded-full ring-1 ${f}`,children:c.jsx(u,{className:"w-6 h-6"})})}),c.jsxs("div",{className:"pt-0.5 pl-[5px]",children:[c.jsx("div",{className:"text-sm font-semibold text-slate-800 dark:text-slate-100",children:A}),c.jsx("p",{className:"mt-1 text-sm text-slate-600 dark:text-slate-300 whitespace-pre-wrap",children:t.message})]}),t.kind==="prompt"&&c.jsxs(c.Fragment,{children:[c.jsx("div",{}),c.jsx("div",{className:"pl-[5px]",children:c.jsx("input",{autoFocus:!0,value:a,onChange:h=>n(h.target.value),placeholder:t.placeholder,className:"w-full p-2.5 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500/50 focus-visible:border-blue-300",onKeyDown:h=>{h.key==="Enter"&&l(),h.key==="Escape"&&s()}})})]})]})}),c.jsx("div",{className:"mt-auto border-t border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900/60 px-4 py-3",children:c.jsxs("div",{className:"flex justify-end gap-2",children:[(t.kind==="confirm"||t.kind==="prompt")&&c.jsx("button",{type:"button",onClick:s,className:"w-32 px-3 py-1.5 text-sm font-semibold rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400/60",children:e("common.cancel")}),c.jsx("button",{type:"button",onClick:l,className:"w-32 px-3 py-1.5 text-sm font-semibold rounded-lg bg-blue-600 text-white hover:bg-blue-700 shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500/70",children:e("common.ok","OK")})]})})]})})};function Zre(){return c.jsxs(c.Fragment,{children:[c.jsx($re,{}),c.jsx(Jre,{})]})}tL.createRoot(document.getElementById("root")).render(c.jsx(X.StrictMode,{children:c.jsx(dq,{children:c.jsx(FU,{children:c.jsx(Zre,{})})})}));export{za as _};
