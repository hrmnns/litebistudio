import{u as Pr,d as Ur,a as k,S as w,e as Ke,b as E,j as e,P as Wr,M as Hr}from"./index-BwrLLMel.js";import{u as Br,h as Vr,r as l,d as I}from"./vendor-react-D64xOC9_.js";import{H as $s,t as S,E as As,s as zr,a as Qr,b as Gr,k as Yr,i as Kr,c as Jr,R as Zr}from"./index-D1nsYRCC.js";import{D as Xr}from"./DataTable-CN3uIG45.js";import{R as el}from"./RecordDetailModal-BuVEuf7b.js";import{u as na,w as tl}from"./xlsx-BojT3SgY.js";import{I as oa,a as ia,b as da}from"./inspectorBridge-BnIEasIL.js";import{D as Ms,g as Os,V as Ie,P as ft,a2 as ca,O as al,a3 as xa,x as sl,a4 as rl,w as ll,a1 as nl,m as ol,a5 as il,a6 as kt,z as dl,a7 as te,a8 as cl,u as xl,K as Ds,a9 as Fs,aa as Ps,ab as ul,$ as bl,ac as ml,a0 as pl}from"./vendor-icons-DtiG8Nuk.js";import"./vendor-pdf-FXkUb51H.js";import"./vendor-ui-BNe0Xlio.js";import"./vendor-charts-BtQqxQq4.js";import"./SchemaDocumentation-AXcMGSW8.js";const hl=(vt,N,Je="Sheet1")=>{const _t=na.json_to_sheet(vt),a=na.book_new();na.book_append_sheet(a,_t,Je);const wt=N.endsWith(".xlsx")?N:`${N}.xlsx`;tl(a,wt)},ua=["SELECT","FROM","WHERE","GROUP BY","ORDER BY","HAVING","LIMIT","OFFSET","JOIN","LEFT JOIN","RIGHT JOIN","INNER JOIN","ON","AND","OR","NOT","IN","LIKE","IS NULL","IS NOT NULL","COUNT(*)","SUM()","AVG()","MIN()","MAX()","DISTINCT"],Tl=({onBack:vt,fixedMode:N,titleKey:Je,breadcrumbKey:_t})=>{const{t:a,i18n:wt}=Pr(),Nt=Br(),Ze=Vr(),{isAdminMode:jt}=Ur(),Y="global",Xe="data_inspector_sql_library_migrated_v1",Us=N==="sql"?"sql_workspace_sql_editor_height":"data_inspector_sql_editor_height",[c,B]=l.useState(N??"table"),[V,z]=l.useState(""),[ba,yt]=k("data_inspector_sql_history",[]),[ma]=k("data_inspector_explain_mode",!1),[Ws,ie]=k("data_inspector_sql_assist_open",!1),[et]=k("data_inspector_autocomplete_enabled",!0),[pa]=k("sql_editor_syntax_highlighting",!0),[ha]=k("sql_editor_autocomplete_on_typing",!0),[ga]=k("sql_editor_line_wrap",!0),[fa]=k("sql_editor_line_numbers",!1),[tt]=k("sql_editor_highlight_active_line",!0),[ka]=k("sql_editor_font_size",14),[va]=k("sql_editor_tab_size",4),[_a]=k("sql_editor_indent_with_tab",!0),[ae]=k("sql_editor_theme_intensity","normal"),[at]=k("sql_editor_uppercase_keywords",!1),[St]=k("sql_editor_schema_hints",!0),[$e]=k("sql_editor_remember_height",!0),[wa]=k("data_inspector_sql_require_limit_confirm",!0),[Ct]=k("data_inspector_sql_max_rows",5e3),[P,Hs]=l.useState([]),[qt,Bs]=l.useState(""),[Vs,zs]=k("data_inspector_last_saved_sql_template_name",""),[Qs,Gs]=k("data_inspector_last_saved_sql_template_description",""),[st,Et]=l.useState({name:"",description:""}),[Tt,Na]=l.useState("manager"),[Lt,se]=k("data_inspector_table_tools_open",!1),[de,Ae]=k("data_inspector_table_tools_tab_v1","columns"),[ce,Me]=l.useState([]),[we,ja]=l.useState([]),[Ne,Rt]=l.useState(""),[It,ya]=l.useState(""),[K,Sa]=k("data_inspector_sql_manager_panels_v1",{templates:!0,manager:!0,recent:!0}),[M,Ca]=k("data_inspector_sql_assistant_panels_v1",{table:!0,columns:!0,aggregation:!0,grouping:!0,filter:!0,sorting:!0,preview:!0}),[J,qa]=l.useState(""),[rt,Oe]=l.useState([]),[$t,Ea]=l.useState(""),[At,Ta]=l.useState("AND"),[Mt,La]=l.useState(""),[lt,je]=l.useState([{id:"f0",connector:"AND",column:"",operator:"=",value:""}]),[nt,ye]=l.useState([{id:"s0",column:"",direction:"DESC"}]),[Ot,Ra]=l.useState(100),[R,Ia]=l.useState("none"),[xe,De]=l.useState(""),[Dt,Ft]=l.useState([]),[Q,$a]=l.useState("metric_value"),[Se,Fe]=l.useState([]),[Aa,Pe]=l.useState(""),[Ys,ot]=l.useState(!1),[re,U]=l.useState(ma?"explain":"result"),[Pt,Ma]=l.useState(""),[Oa,it]=l.useState(""),[Ks,dt]=l.useState(!1),[Da,Fa]=l.useState(""),[Ce,Ut]=l.useState([]),[Wt,Pa]=l.useState(!1),[Ht,Ua]=l.useState(""),[ct,Wa]=l.useState(!1),[Ha,xt]=l.useState([]),[Ba,Va]=l.useState(!1),[za,Qa]=l.useState(""),[Ue,Ga]=k(Us,160),[ue,ut]=l.useState($e?Ue:160),Ya=l.useRef(new Map),be=l.useRef(0),Bt=l.useRef(!1),[fe,We]=l.useState(""),[i,Vt]=l.useState(""),[zt,Ka]=l.useState(null),[qe,Js]=k("data_inspector_page_size",100),[He,Ee]=l.useState(1),[Ja,Za]=l.useState(""),Zs=(He-1)*qe,[$,Be]=l.useState(null),[me,Te]=l.useState({}),[Qt]=k("data_table_default_show_filters",!1),[Gt,le]=l.useState(Qt),[Xa,es]=k("data_inspector_column_widths_v1",{}),[Yt,ts]=k("data_inspector_saved_views",[]),[ne,bt]=k("data_inspector_active_view",""),[Xs]=k("data_inspector_show_profiling",!0),[Z,as]=l.useState(Xs?"profiling":"data"),[ke,Kt]=k("data_inspector_profiling_thresholds",{nullRate:30,cardinalityRate:95}),[Jt,ss]=l.useState(!1),Zt=l.useRef(null),Xt=l.useRef(ue),er=l.useRef(0),rs=l.useRef(null),ls=180,[ns,tr]=l.useState(null),os=!!N,ar=a(Je||"sidebar.data_inspector"),sr=a(_t||Je||"sidebar.data_inspector"),[T,rr]=l.useState(typeof document<"u"&&document.documentElement.classList.contains("dark")),W=l.useCallback(t=>{const s=t.trim();s&&(localStorage.setItem(oa,s),localStorage.setItem(ia,`#${Ze.pathname}${Ze.search||""}`),Nt("/sql-workspace"))},[Ze.pathname,Ze.search,Nt]);l.useEffect(()=>{le(Qt)},[Qt,i]),l.useEffect(()=>{!N||c===N||B(N)},[N,c]),l.useEffect(()=>{const t=localStorage.getItem(oa),s=localStorage.getItem(ia);if(s){const r=s.startsWith("#/")?s:"#/";tr(r),localStorage.removeItem(ia)}if(t){if(localStorage.removeItem(oa),N==="table"){W(t);return}B("sql"),z(t),U("result")}},[N,W]),l.useEffect(()=>{if(N!=="sql"||Bt.current)return;if(V.trim()){Bt.current=!0;return}Bt.current=!0;const t=localStorage.getItem(da);!t||!/^\s*SELECT\b/i.test(t)||(z(t),U("result"))},[N,V]),l.useEffect(()=>{const t=document.documentElement,s=()=>rr(t.classList.contains("dark"));s();const r=new MutationObserver(s);return r.observe(t,{attributes:!0,attributeFilter:["class"]}),()=>r.disconnect()},[]);const X=l.useCallback(t=>t.trim().replace(/\s+/g," ").toLowerCase(),[]),O=l.useCallback(async()=>{const t=await w.listSqlStatements(Y);Hs(t)},[Y]);l.useEffect(()=>{O()},[O]),l.useEffect(()=>{(async()=>{if(localStorage.getItem(Xe)!=="true")try{const r=await w.listSqlStatements(Y),n=new Set(r.map(b=>X(b.sql_text))),o=localStorage.getItem("data_inspector_custom_sql_templates"),x=localStorage.getItem("data_inspector_favorite_queries"),g=o?JSON.parse(o):[],p=x?JSON.parse(x):[];for(const b of g){const y=(b.sql||"").trim();if(!y)continue;const _=X(y);n.has(_)||(await w.saveSqlStatement({id:crypto.randomUUID(),name:(b.name||a("datainspector.save_template")).trim()||`Template ${n.size+1}`,sql_text:y,scope:Y}),n.add(_))}for(const b of p){const y=b.trim();if(!y)continue;const _=X(y);if(n.has(_))continue;const j=y.split(`
`).map(C=>C.trim()).find(Boolean)||y;await w.saveSqlStatement({id:crypto.randomUUID(),name:`${a("datainspector.favorite_queries")}: ${j.slice(0,36)}`,sql_text:y,scope:Y,is_favorite:!0}),n.add(_)}localStorage.setItem(Xe,"true"),await O()}catch{localStorage.setItem(Xe,"true")}})()},[Xe,Y,O,X,a]);const{data:Ve}=Ke(async()=>{const t=await w.getDataSources(),s=jt?t:t.filter(r=>!r.name.startsWith("sys_"));return s.length>0&&(!i||i.startsWith("sys_")&&!jt)&&Vt(s[0].name),s},[jt]),pe=I.useMemo(()=>(Ve||[]).map(t=>t.name),[Ve]),ee=I.useMemo(()=>Ve?.find(t=>t.name===i)?.type??"table",[Ve,i]),lr=I.useMemo(()=>i?Xa[i]||{}:{},[Xa,i]),nr=l.useCallback(t=>{i&&es(s=>({...s,[i]:t}))},[i,es]),{data:v,loading:ve,error:is,refresh:H}=Ke(async()=>c==="table"?i?await w.inspectTable(i,qe,fe,Zs,ee):[]:Pt?await w.executeRaw(Pt):[],[c,i,ee,qe,He,Pt]),{data:ds}=Ke(async()=>c!=="table"||!i?0:await w.countTableRows(i,fe),[c,i,fe]),mt=Math.max(1,Math.ceil((ds||0)/qe)),{data:D}=Ke(async()=>i?await w.getTableSchema(i):[],[i]),{data:pt}=Ke(async()=>J?await w.getTableSchema(J):[],[J]);l.useEffect(()=>{const t=(D||[]).map(s=>s.name);if(t.length===0){Rt("");return}(!Ne||!t.includes(Ne))&&Rt(t[0])},[D,Ne]),l.useEffect(()=>{const t=(D||[]).map(s=>s.name);Me(s=>s.filter(r=>t.includes(r)))},[D]);const ea=I.useMemo(()=>{const t=v&&v.length>0?Object.keys(v[0]).filter(s=>s!=="_rowid"):[];return we.length>0?t.filter(s=>we.includes(s)):t},[v,we]);l.useEffect(()=>{c!=="table"||!Lt||de!=="columns"||ea.length!==0&&Me(ea)},[ea,c,Lt,de]),l.useEffect(()=>{ja([])},[i]),l.useEffect(()=>{if(c==="table"){const t=setTimeout(()=>{H()},500);return()=>clearTimeout(t)}},[fe,c,H]);const oe=l.useCallback(async t=>{const s=t.trim();if(!s)return;const r=s.toUpperCase();if(/^(INSERT|UPDATE|DELETE|DROP|CREATE|ALTER|REPLACE|TRUNCATE|VACUUM|ATTACH|DETACH)\b/.test(r)&&!await E.confirm(a("datainspector.write_confirm")))return;const o=/^\s*SELECT\b/i.test(s),x=/\bLIMIT\b/i.test(s);if(o&&!x&&wa&&!await E.confirm(a("datainspector.limit_confirm_prompt",{limit:Ct})))return;let g=s.replace(/;\s*$/,"");if(o){const p=Math.max(1,Math.floor(Ct||1));g=`SELECT * FROM (${g}) AS __litebi_guard LIMIT ${p}`,it(a("datainspector.limit_applied_notice",{limit:p}))}else it("");U("result"),Ma(g),H(),yt(p=>[s,...p.filter(b=>b!==s)].slice(0,12)),o&&localStorage.setItem(da,s)},[H,yt,Ct,wa,a]),or=async()=>{await oe(V)},ir=l.useCallback(()=>{z(""),Ma(""),it(""),U("result"),Fe([]),Pe(""),ot(!1),Et({name:"",description:""}),localStorage.removeItem(da)},[]),dr=async()=>{await w.abortActiveQueries()||await E.info(a("datainspector.cancel_not_available","No cancellable SQL query is currently running in this tab."))},cs=l.useCallback(async t=>{const s=t.trim();if(!s){Fe([]),Pe("");return}ot(!0),Pe("");try{const r=await w.executeRaw(`EXPLAIN QUERY PLAN ${s}`);Fe(r)}catch(r){Fe([]),Pe(r instanceof Error?r.message:String(r))}finally{ot(!1)}},[]),cr=async t=>{const s=t.trim();if(!s)return;const r=X(s),n=P.find(x=>X(x.sql_text)===r);if(n){await w.setSqlStatementFavorite(n.id,Number(n.is_favorite)!==1),await O();return}const o=s.split(`
`).map(x=>x.trim()).find(Boolean)||s;await w.saveSqlStatement({id:crypto.randomUUID(),name:o.slice(0,42),sql_text:s,scope:Y,is_favorite:!0}),await O()},xr=async()=>{const t=V.trim();if(!t)return;const s=X(t),r=P.find(d=>d.scope===Y&&X(d.sql_text)===s),n=r?.name||st.name||Vs||`${i||"Query"} Template`,o=r?.description||st.description||Qs||"",x=r?a("datainspector.custom_template_prompt_update","Template name (updates existing):"):a("datainspector.custom_template_prompt"),g=r?a("datainspector.custom_template_description_prompt_update","Template description (updates existing):"):a("datainspector.custom_template_description_prompt","Template description (optional):"),p=await E.prompt2(x,g,{title:r?a("datainspector.rename_template","Rename Template"):a("datainspector.save_template","Save Template"),defaultValue:n,secondDefaultValue:o});if(!p)return;const b=p.value.trim();if(!b)return;const y=p.secondValue.trim(),_=P.find(d=>d.name.toLowerCase()===b.toLowerCase()&&d.scope===Y);if(_&&r&&_.id!==r.id){if(!await E.confirm(a("datainspector.custom_template_overwrite_confirm",{name:b})))return;await w.deleteSqlStatement(_.id)}else if(_&&!r&&!await E.confirm(a("datainspector.custom_template_overwrite_confirm",{name:b})))return;const j=r?.id||_?.id||crypto.randomUUID(),C=r?Number(r.is_favorite)===1:_?Number(_.is_favorite)===1:!1;await w.saveSqlStatement({id:j,name:b,sql_text:t,description:y,scope:Y,is_favorite:C}),zs(b),Gs(y),await O()},ur=t=>{Vt(t.table),We(t.searchTerm),Be(t.sortConfig),Te(t.filters||{}),le(!!t.showFilters),os||B("table")},xs=async()=>{const t=Yt.find(n=>n.id===ne)?.name||`${i} View`,s=(await E.prompt(a("datainspector.new_view_prompt"),{defaultValue:t}))?.trim();if(!s)return;const r={id:ne||crypto.randomUUID(),name:s,table:i,searchTerm:fe,sortConfig:$,filters:me,showFilters:Gt};ts(n=>{const o=n.filter(x=>x.id!==r.id);return[r,...o].slice(0,20)}),bt(r.id)},us=async()=>{ne&&await E.confirm(a("datainspector.delete_view_confirm"))&&(ts(t=>t.filter(s=>s.id!==ne)),bt(""))},F=l.useCallback(t=>`"${t.replace(/"/g,'""')}"`,[]),bs=()=>{!i||ee!=="table"||(Fa(`idx_${i}_`),Ut([]),Pa(!1),Ua(""),dt(!0))},br=t=>{Ut(s=>s.includes(t)?s.filter(r=>r!==t):[...s,t])},ms=(t,s)=>{Ut(r=>{const n=r.indexOf(t);if(n===-1)return r;const o=s==="up"?n-1:n+1;if(o<0||o>=r.length)return r;const x=[...r];return[x[n],x[o]]=[x[o],x[n]],x})},mr=async()=>{const t=Da.trim();if(!(!i||ee!=="table")){if(!t){await E.warning(a("datasource.index_create_name_required","Please provide an index name."));return}if(Ce.length===0){await E.warning(a("datasource.index_create_columns_required","Please select at least one column."));return}Wa(!0);try{const s=Wt?"UNIQUE ":"",r=Ce.map(F).join(", "),n=Ht.trim()?` WHERE ${Ht.trim()}`:"",o=`CREATE ${s}INDEX ${F(t)} ON ${F(i)} (${r})${n};`;await w.executeRaw(o),dt(!1),H(),await E.info(a("datasource.index_create_success","Index created."))}catch(s){await E.error(a("common.error")+": "+(s instanceof Error?s.message:String(s)))}finally{Wa(!1)}}},ps=l.useCallback((t,s)=>`idx_${t}_${s.join("_")}`.toLowerCase().replace(/[^a-z0-9_]/g,"_").slice(0,60),[]),hs=l.useCallback(async t=>{const s=F(t),n=(await w.executeRaw(`PRAGMA index_list(${s});`)).map(x=>String(x.name??"")).filter(Boolean),o=[];for(const x of n){const p=(await w.executeRaw(`PRAGMA index_info(${F(x)});`)).map(b=>String(b.name??"")).filter(Boolean);p.length>0&&o.push(p)}return o},[F]),pr=l.useCallback(async()=>{if(!i||ee!=="table")return;const t=JSON.stringify({table:i,filters:me,sortKey:$?.key?String($.key):"",sortDir:$?.direction||"",schema:(D||[]).map(n=>n.name)}),s=Ya.current.get(t);if(s){xt(s);return}const r=++be.current;Va(!0);try{const n=(D||[]).map(u=>u.name);if(r!==be.current)return;if(n.length===0){xt([]);return}const o=await hs(i);if(r!==be.current)return;const x=await w.executeRaw(`SELECT COUNT(*) AS total_rows FROM ${F(i)};`);if(r!==be.current)return;const g=Number(x[0]?.total_rows??0),p=n.slice(0,14),b=Math.max(1,Math.min(g||1,5e3)),y=await Promise.all(p.map(async u=>{const h=await w.executeRaw(`SELECT COUNT(DISTINCT ${F(u)}) AS distinct_count
                     FROM (SELECT ${F(u)} FROM ${F(i)} LIMIT ${b});`),f=Number(h[0]?.distinct_count??0),q=b>0?b:g,G=q>0?f/q:0;return{column:u,distinctCount:f,ratio:G}}));if(r!==be.current)return;const _=[],j=new Set,C=(u,h,f)=>{const q=u.filter(Boolean);if(q.length===0)return;const G=q.join("|").toLowerCase();j.has(G)||(j.add(G),_.push({columns:q,reason:h,score:f}))},d=Object.keys(me).filter(u=>n.includes(u));if(d.forEach((u,h)=>{C([u],a("datainspector.index_suggestion_reason_filter","Used in active table filter"),95-h)}),$?.key&&n.includes(String($.key))&&C([String($.key)],a("datainspector.index_suggestion_reason_sort","Used as active sort column"),92),d.length>1)C(d.slice(0,2),a("datainspector.index_suggestion_reason_composite","Composite index for combined filters"),96);else if(d.length===1&&$?.key&&n.includes(String($.key))){const u=String($.key);u!==d[0]&&C([d[0],u],a("datainspector.index_suggestion_reason_filter_sort","Composite index for filter + sort"),97)}y.sort((u,h)=>h.ratio-u.ratio).slice(0,3).forEach((u,h)=>{u.ratio<.08||C([u.column],a("datainspector.index_suggestion_reason_cardinality","High cardinality column"),86-h)});const A=u=>o.some(h=>h.length>=u.length&&u.every((f,q)=>h[q]===f)),he=_.filter(u=>!A(u.columns)).sort((u,h)=>h.score-u.score).slice(0,5).map(u=>{const h=ps(i,u.columns),f=u.columns.map(q=>F(q)).join(", ");return{id:`${i}:${u.columns.join("|")}`,indexName:h,columns:u.columns,reason:u.reason,score:u.score,sql:`CREATE INDEX ${F(h)} ON ${F(i)} (${f});`}});xt(he),Ya.current.set(t,he)}catch(n){if(r!==be.current)return;await E.error(a("common.error")+": "+(n instanceof Error?n.message:String(n)))}finally{r===be.current&&Va(!1)}},[ps,hs,F,ee,i,D,me,$,a]);l.useEffect(()=>{be.current+=1},[i,me,$]);const hr=l.useCallback(async t=>{Qa(t.id);try{await w.executeRaw(t.sql),await E.info(a("datasource.index_create_success","Index created.")),xt(s=>s.filter(r=>r.id!==t.id)),H()}catch(s){await E.error(a("common.error")+": "+(s instanceof Error?s.message:String(s)))}finally{Qa("")}},[H,a]),gr=I.useMemo(()=>{if(!v||v.length===0)return[];const t=Object.keys(v[0]).filter(r=>r!=="_rowid"),s=we.length>0?t.filter(r=>we.includes(r)):t;return s.length===0?[]:s.map(r=>{const n=r.toLowerCase().includes("amount")||r.toLowerCase().includes("price"),o=r.toLowerCase().includes("id"),g=typeof v[0][r]=="number";return{header:r,accessor:r,align:g?"right":"left",className:o?"font-mono text-[10px] text-slate-400":r==="Period"||r==="PostingDate"?"font-mono":"",render:n?p=>e.jsx("span",{className:Number(p[r]??0)<0?"text-red-500":"text-slate-900 dark:text-slate-100",children:new Intl.NumberFormat("de-DE",{style:"currency",currency:p.Currency||"EUR"}).format(p[r]||0)}):void 0}})},[v,we]),gs=wt.language.startsWith("de")?"de-DE":"en-US",fs=new Date,fr=`${a("common.loading").replace("...","")} ${fs.toLocaleDateString(gs)}, ${fs.toLocaleTimeString(gs,{hour:"2-digit",minute:"2-digit"})}`;l.useEffect(()=>{c!=="sql"&&(Fe([]),Pe(""),ot(!1))},[c]),l.useEffect(()=>{if(c!=="sql"||re!=="explain")return;const t=window.setTimeout(()=>{cs(V)},250);return()=>window.clearTimeout(t)},[c,re,V,cs]);const ks=[{key:"top10",sql:`SELECT * FROM ${i||"table_name"} LIMIT 10`},{key:"count",sql:`SELECT COUNT(*) AS total_rows FROM ${i||"table_name"}`},{key:"nullscan",sql:`SELECT * FROM ${i||"table_name"} WHERE 1=1 LIMIT 50`},{key:"duplicates",sql:`SELECT key_column, COUNT(*) AS cnt FROM ${i||"table_name"} GROUP BY key_column HAVING COUNT(*) > 1 ORDER BY cnt DESC LIMIT 50`},{key:"outliers",sql:`SELECT * FROM ${i||"table_name"} WHERE value_column IS NOT NULL ORDER BY value_column DESC LIMIT 25`}];l.useEffect(()=>{pe.length&&(!J||!pe.includes(J))&&qa(i&&pe.includes(i)?i:pe[0])},[J,i,pe]);const L=I.useMemo(()=>(pt||[]).map(t=>t.name),[pt]),ta=I.useMemo(()=>(pt||[]).filter(t=>/int|real|num|dec|float|double/i.test(t.type||"")).map(t=>t.name),[pt]),vs=I.useMemo(()=>{const t=Mt.trim().toLowerCase();return t?L.filter(s=>s.toLowerCase().includes(t)):L},[Mt,L]),_s=R!=="none";l.useEffect(()=>{Oe(t=>t.filter(s=>L.includes(s))),R!=="none"&&R!=="count"&&xe&&!L.includes(xe)&&De(""),Ft(t=>t.filter(s=>L.includes(s))),je(t=>t.map(s=>s.column&&!L.includes(s.column)?{...s,column:""}:s)),ye(t=>t.map(s=>s.column&&!L.includes(s.column)&&s.column!==Q?{...s,column:""}:s))},[R,xe,L,Q]),l.useEffect(()=>{R==="none"||R==="count"||xe||(ta.length>0?De(ta[0]):L.length>0&&De(L[0]))},[R,xe,L,ta]);const kr=l.useCallback(()=>{Oe([]),La(""),je([{id:"f0",connector:"AND",column:"",operator:"=",value:""}]),Ea(""),Ta("AND"),ye([{id:"s0",column:"",direction:"DESC"}]),Ra(100),Ia("none"),De(""),Ft([]),$a("metric_value")},[]),vr=l.useCallback(()=>{const t=`f_${Date.now()}_${Math.random().toString(36).slice(2,7)}`;je(s=>[...s,{id:t,connector:"AND",column:"",operator:"=",value:""}])},[]),ht=l.useCallback((t,s)=>{je(r=>r.map(n=>n.id===t?{...n,...s}:n))},[]),_r=l.useCallback(t=>{je(s=>{const r=s.filter(n=>n.id!==t);return r.length>0?r:[{id:"f0",connector:"AND",column:"",operator:"=",value:""}]})},[]),ws=l.useCallback((t,s)=>{je(r=>{const n=r.findIndex(p=>p.id===t);if(n<0)return r;const o=s==="up"?n-1:n+1;if(o<0||o>=r.length)return r;const x=[...r],[g]=x.splice(n,1);return x.splice(o,0,g),x})},[]),wr=l.useCallback(()=>{const t=`s_${Date.now()}_${Math.random().toString(36).slice(2,7)}`;ye(s=>[...s,{id:t,column:"",direction:"DESC"}])},[]),Ns=l.useCallback((t,s)=>{ye(r=>r.map(n=>n.id===t?{...n,...s}:n))},[]),Nr=l.useCallback(t=>{ye(s=>{const r=s.filter(n=>n.id!==t);return r.length>0?r:[{id:"s0",column:"",direction:"DESC"}]})},[]),js=l.useCallback((t,s)=>{ye(r=>{const n=r.findIndex(p=>p.id===t);if(n<0)return r;const o=s==="up"?n-1:n+1;if(o<0||o>=r.length)return r;const x=[...r],[g]=x.splice(n,1);return x.splice(o,0,g),x})},[]),aa=l.useCallback(()=>{if(!J)return"";const t=h=>`"${h.replace(/"/g,'""')}"`,s=h=>{const f=h.trim();return f?/^'.*'$|^".*"$/.test(f)||/^-?\d+(\.\d+)?$/.test(f)?f:`'${f.replace(/'/g,"''")}'`:""},r=`FROM ${t(J)}`,n=R.toUpperCase(),o=R==="count"?`COUNT(*) AS ${t(Q||"metric_value")}`:`${n}(${t(xe)}) AS ${t(Q||"metric_value")}`;let x="SELECT *";const g=[];if(R==="none")x=`SELECT ${rt.length>0?rt.map(t).join(", "):"*"}`;else{const h=Dt.map(t);g.push(...h),x=`SELECT ${[...h,o].join(", ")}`}const p=lt.map(f=>{if(!f.column.trim()||!f.operator.trim())return null;const q=t(f.column.trim());if(f.operator==="IS NULL"||f.operator==="IS NOT NULL")return{connector:f.connector,expr:`${q} ${f.operator}`};const G=s(f.value);return G?{connector:f.connector,expr:`${q} ${f.operator} ${G}`}:null}).filter(f=>!!f).reduce((f,q,G)=>G===0?q.expr:`${f} ${q.connector} ${q.expr}`,""),b=$t.trim(),y=p&&b?`WHERE (${p}) ${At} (${b})`:p?`WHERE ${p}`:b?`WHERE ${b}`:"",_=g.length>0?`GROUP BY ${g.join(", ")}`:"",j=nt.filter(h=>h.column.trim()).map(h=>`${h.column===Q?t(Q||"metric_value"):t(h.column)} ${h.direction}`),C=R!=="none"?[`${t(Q||"metric_value")} DESC`]:[],d=j.length>0?j:C,A=d.length>0?`ORDER BY ${d.join(", ")}`:"",u=`LIMIT ${Math.max(1,Math.min(1e5,Math.floor(Number(Ot)||100)))}`;return[x,r,y,_,A,u].filter(Boolean).join(`
`)},[R,xe,lt,Dt,Ot,Q,nt,rt,J,At,$t])(),ys=l.useCallback(async t=>{const s=aa.trim();if(s){if(N==="table"){W(s);return}B("sql"),z(s),U("result"),ie(!1),t==="run"&&await oe(s)}},[aa,oe,N,W,ie]),jr=X(V),Le=P.find(t=>X(t.sql_text)===jr),gt=!!(Le&&Number(Le.is_favorite)===1),Ss=I.useMemo(()=>{const t=qt.trim().toLowerCase();return t?P.filter(s=>s.name.toLowerCase().includes(t)||s.sql_text.toLowerCase().includes(t)||(s.description||"").toLowerCase().includes(t)):P},[qt,P]),yr=I.useMemo(()=>P.filter(t=>Number(t.is_favorite)===1).length,[P]),ze=I.useMemo(()=>Le?{name:Le.name,description:(Le.description||"").trim()}:st,[Le,st]),Cs=l.useCallback(async(t,s)=>{if(N==="table"){W(t.sql_text);return}B("sql"),z(t.sql_text),Et({name:t.name,description:(t.description||"").trim()}),U("result"),ie(!1),await w.markSqlStatementUsed(t.id),s&&await oe(t.sql_text),await O()},[oe,N,W,O,ie]),qs=l.useCallback(async(t,s,r,n)=>{if(N==="table"){W(t);return}B("sql"),z(t),Et({name:(r||"").trim(),description:(n||"").trim()}),U("result"),ie(!1),s&&await oe(t)},[oe,N,W,ie]),sa=l.useCallback(t=>{Sa(s=>({...s,[t]:!s[t]}))},[Sa]),_e=l.useCallback(t=>{Ca(s=>({...s,[t]:!s[t]}))},[Ca]),Sr=l.useCallback(async t=>{await E.confirm(a("datainspector.custom_template_delete_confirm"))&&(await w.deleteSqlStatement(t.id),await O())},[O,a]),Cr=l.useCallback(async t=>{const s=await E.prompt2(a("datainspector.rename_template_prompt"),a("common.description","Description"),{title:a("datainspector.rename_template"),defaultValue:t.name,secondDefaultValue:t.description||"",secondPlaceholder:a("datainspector.custom_template_description_prompt","Template description (optional):")});if(!s)return;const r=s.value.trim(),n=s.secondValue.trim();if(!r||r===t.name&&n===(t.description||"").trim())return;const o=P.find(x=>x.id!==t.id&&x.name.toLowerCase()===r.toLowerCase()&&x.scope===t.scope);o&&!await E.confirm(a("datainspector.custom_template_overwrite_confirm",{name:r}))||(o&&await w.deleteSqlStatement(o.id),await w.saveSqlStatement({id:t.id,name:r,sql_text:t.sql_text,description:n,scope:t.scope,tags:t.tags,is_favorite:Number(t.is_favorite)===1}),await O())},[O,P,a]),Es=l.useCallback(()=>{if(!v||v.length===0)return;const t=new Date().toISOString().slice(0,10),s=v.map(r=>{const n={...r};return delete n._rowid,n});hl(s,`export_${t}`,"Export")},[v]),qr=l.useCallback(()=>{const t=Ne.trim();t&&(Te(s=>({...s,[t]:It})),le(!0))},[le,Ne,It]),Er=l.useCallback(t=>{Te(s=>{const r={...s};return delete r[t],r})},[]),Tr=l.useCallback(()=>{Te({}),We(""),le(!1),ya("")},[le]),Lr=l.useCallback(()=>{const s=`SELECT * FROM "${i.replace(/"/g,'""')}" LIMIT 100`;if(N==="table"){W(s);return}B("sql"),z(s),U("result"),se(!1)},[N,W,i,se]),ra=l.useCallback(t=>{Ae(t),se(!0)},[se,Ae]),Ts=l.useCallback(t=>{const s=i.replace(/"/g,'""'),r=o=>`"${o.replace(/"/g,'""')}"`;return`SELECT ${t.length>0?t.map(r).join(", "):"*"}
FROM "${s}"
LIMIT 100`},[i]),Rr=l.useCallback(async t=>{if(ce.length===0){await E.info(a("datainspector.table_tools_pick_fields_required","Select at least one field."));return}const s=Ts(ce);if(N==="table"){W(s);return}B("sql"),z(s),U("result"),se(!1),t&&await oe(s)},[Ts,oe,N,W,se,ce,a]),Ir=l.useCallback(async()=>{if(ce.length===0){await E.info(a("datainspector.table_tools_pick_fields_required","Select at least one field."));return}B("table"),ja(ce),se(!1)},[se,ce,a]),Ls=I.useMemo(()=>T?$s.define([{tag:S.keyword,color:"#60a5fa",fontWeight:"700"},{tag:[S.string,S.special(S.string)],color:"#fbbf24"},{tag:[S.number,S.float],color:"#34d399"},{tag:[S.comment,S.lineComment,S.blockComment],color:"#94a3b8",fontStyle:"italic"},{tag:[S.propertyName,S.attributeName],color:"#7dd3fc"},{tag:S.operator,color:"#c084fc"}]):$s.define([{tag:S.keyword,color:"#1d4ed8",fontWeight:"700"},{tag:[S.string,S.special(S.string)],color:"#b45309"},{tag:[S.number,S.float],color:"#059669"},{tag:[S.comment,S.lineComment,S.blockComment],color:"#64748b",fontStyle:"italic"},{tag:[S.propertyName,S.attributeName],color:"#0284c7"},{tag:S.operator,color:"#7c3aed"}]),[T]),Rs=I.useMemo(()=>{const t=ae==="subtle"?"rgba(96, 165, 250, 0.08)":ae==="high"?"rgba(96, 165, 250, 0.18)":"rgba(96, 165, 250, 0.12)",s=ae==="subtle"?"rgba(59, 130, 246, 0.05)":ae==="high"?"rgba(59, 130, 246, 0.14)":"rgba(59, 130, 246, 0.08)",r=ae==="subtle"?"rgba(96, 165, 250, 0.18)":ae==="high"?"rgba(96, 165, 250, 0.34)":"rgba(96, 165, 250, 0.24)",n=ae==="subtle"?"rgba(59, 130, 246, 0.18)":ae==="high"?"rgba(59, 130, 246, 0.34)":"rgba(59, 130, 246, 0.25)";return As.theme({"&":{height:"100%",fontSize:`${Math.max(12,Math.min(15,ka))}px`,borderRadius:"0.5rem"},".cm-editor":{backgroundColor:T?"#0b1220":"#f8fafc",color:T?"#e2e8f0":"#0f172a"},".cm-scroller":{overflow:"auto",backgroundColor:T?"#0b1220":"#f8fafc",fontFamily:'ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace'},".cm-content":{padding:"1rem",color:T?"#e2e8f0":"#0f172a",caretColor:T?"#60a5fa":"#2563eb"},".cm-focused":{outline:"none"},".cm-activeLine":{backgroundColor:tt?T?t:s:"transparent"},".cm-selectionBackground, ::selection":{backgroundColor:T?`${r} !important`:`${n} !important`},".cm-gutters":{backgroundColor:"transparent",border:"none",color:T?"#94a3b8":"#64748b"},".cm-cursor, .cm-dropCursor":{borderLeftColor:T?"#60a5fa":"#2563eb"},".cm-tooltip":{borderRadius:"0.5rem",border:`1px solid ${T?"#334155":"#cbd5e1"}`,backgroundColor:T?"#0f172a":"#ffffff",color:T?"#e2e8f0":"#0f172a",boxShadow:"0 10px 30px rgba(15, 23, 42, 0.25)"},".cm-tooltip-autocomplete > ul > li":{fontFamily:'ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace',fontSize:"12px"},".cm-tooltip-autocomplete > ul > li[aria-selected]":{backgroundColor:T?"rgba(37, 99, 235, 0.35)":"rgba(59, 130, 246, 0.16)",color:T?"#dbeafe":"#1e3a8a"}},{dark:T})},[T,ka,tt,ae]),Is=l.useCallback(t=>{if(c!=="sql"||!et)return null;const s=t.matchBefore(/["A-Za-z_][A-Za-z0-9_."-]*/);if(!s&&!t.explicit)return null;const r=s?s.from:t.pos,o=(s?s.text:"").replace(/"/g,"").toLowerCase(),x=t.state.doc.sliceString(Math.max(0,t.pos-120),t.pos).toUpperCase(),g=/\b(FROM|JOIN|INTO|UPDATE|TABLE)\s+["A-Z0-9_]*$/.test(x),p=/\b(SELECT|WHERE|AND|OR|ON|HAVING|BY|ORDER BY|GROUP BY)\s+["A-Z0-9_.,\s]*$/.test(x)||/\.\s*["A-Z0-9_]*$/.test(x),b=St?pe:[],y=St?(D||[]).map(d=>d.name):[],_=[],j=new Set,C=(d,A,he=0,u)=>{const h=`${A}:${d.toLowerCase()}`;j.has(h)||(j.add(h),_.push({label:d,type:A,boost:he,apply:u||d}))};if(g){for(const d of b)(!o||d.toLowerCase().startsWith(o))&&C(d,"variable",99);for(const d of ua)if(!o||d.toLowerCase().startsWith(o)){const A=at?d.toUpperCase():d.toLowerCase();C(d,"keyword",80,A)}}else if(p){for(const d of y)(!o||d.toLowerCase().startsWith(o))&&C(d,"property",99);for(const d of ua)if(!o||d.toLowerCase().startsWith(o)){const A=at?d.toUpperCase():d.toLowerCase();C(d,"keyword",80,A)}for(const d of b)(!o||d.toLowerCase().startsWith(o))&&C(d,"variable",70)}else{for(const d of ua)if(!o||d.toLowerCase().startsWith(o)){const A=at?d.toUpperCase():d.toLowerCase();C(d,"keyword",90,A)}for(const d of b)(!o||d.toLowerCase().startsWith(o))&&C(d,"variable",80);for(const d of y)(!o||d.toLowerCase().startsWith(o))&&C(d,"property",70)}return _.length===0&&!t.explicit?null:{from:r,options:_.slice(0,40),validFor:/^[A-Za-z0-9_."-]*$/}},[et,c,D,St,at,pe]),$r=I.useMemo(()=>{const t=[zr(),Rs,Qr.tabSize.of(Math.max(2,Math.min(4,va)))];return pa&&t.push(Gr(Ls)),ga&&t.push(As.lineWrapping),_a&&t.push(Yr.of([Kr])),et&&t.push(Jr({override:[Is],activateOnTyping:ha,maxRenderedOptions:12})),t},[et,Is,ha,_a,ga,pa,va,Rs,Ls]);l.useEffect(()=>{ut($e?Ue:160)},[$e,Ue]),l.useEffect(()=>{if(!$e||ue===Ue)return;const t=window.setTimeout(()=>{Ga(ue)},180);return()=>window.clearTimeout(t)},[ue,$e,Ue,Ga]);const Re=I.useMemo(()=>{if(c!=="table"||!v||v.length===0)return[];const t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,s=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,r=/^[A-Z]{2}\d{2}[A-Z0-9]{10,30}$/i,n=/^https?:\/\/[^\s/$.?#].[^\s]*$/i,o=g=>{if(!(/^\d{4}-\d{2}-\d{2}/.test(g)||/^\d{2}[./-]\d{2}[./-]\d{2,4}$/.test(g)))return!1;const b=Date.parse(g.replace(/\./g,"-"));return!Number.isNaN(b)};return Object.keys(v[0]).filter(g=>g!=="_rowid").map(g=>{const p=v.map(m=>m[g]),b=p.filter(m=>m!=null&&String(m).trim()!==""),y=p.length-b.length,_=p.length>0?y/p.length*100:0,j=b.map(m=>String(m).trim()),C=new Set(j).size,d=b.map(m=>typeof m=="number"?m:Number(m)).filter(m=>!Number.isNaN(m)),A=d.length,he=b.filter(m=>m instanceof Date||o(String(m).trim())).length;let u="unknown";if(b.length===0)u="unknown";else{const m=A/b.length,ge=he/b.length;m>.9?u="number":ge>.9?u="date":m>.1||ge>.1?u="mixed":u="text"}const h=d.length>0?Math.min(...d):null,f=d.length>0?Math.max(...d):null,q={email:j.filter(m=>t.test(m)).length,uuid:j.filter(m=>s.test(m)).length,iban:j.filter(m=>r.test(m)).length,url:j.filter(m=>n.test(m)).length,date:j.filter(m=>o(m)).length},G=Object.entries(q).filter(([,m])=>m>=2&&m/Math.max(1,j.length)>=.2).sort((m,ge)=>ge[1]-m[1]).map(([m])=>m),Qe=Object.entries(q).sort((m,ge)=>ge[1]-m[1])[0],Or=Qe?Qe[1]/Math.max(1,j.length):0;let Ge=0;u==="number"?Ge=Math.max(0,b.length-A):u==="date"?Ge=Math.max(0,b.length-he):Qe&&Qe[1]>=3&&Or>=.6&&(Ge=Math.max(0,b.length-Qe[1]));const la=new Map;j.forEach(m=>{la.set(m,(la.get(m)||0)+1)});const Dr=Array.from(la.entries()).sort((m,ge)=>ge[1]-m[1]).slice(0,3),Fr=b.length>0?C/b.length*100>ke.cardinalityRate:!1,Ye=[];return _>=ke.nullRate&&Ye.push("high_null"),u==="mixed"&&Ye.push("mixed_types"),Fr&&Ye.push("high_cardinality"),Ge>0&&Ye.push("suspicious_values"),{key:g,distinctCount:C,nullRate:_,min:h,max:f,topValues:Dr,detectedType:u,patterns:G,suspiciousCount:Ge,issues:Ye}})},[c,v,ke]),Ar=I.useMemo(()=>Re.reduce((t,s)=>t+s.issues.length,0),[Re]),Mr=t=>{t.preventDefault(),t.stopPropagation(),Zt.current={startY:t.clientY,startHeight:ue},Xt.current=ue,ss(!0)};return l.useEffect(()=>{if(!Jt)return;const t=r=>{const n=Zt.current;if(!n)return;const o=r.clientY-n.startY,x=120,g=Math.max(260,Math.floor(window.innerHeight*.62)),p=rs.current?.getBoundingClientRect().top??0,y=Math.floor(window.innerHeight-p-ls-24),_=Math.max(x,y>0?y:g),j=Math.max(x,Math.min(_,n.startHeight+o));Xt.current=j,ut(j)},s=()=>{const r=Math.round(Xt.current);er.current=Date.now(),ut(r),ss(!1),Zt.current=null};return document.body.style.cursor="row-resize",document.body.style.userSelect="none",document.body.style.overflowAnchor="none",window.addEventListener("mousemove",t),window.addEventListener("mouseup",s),()=>{document.body.style.cursor="",document.body.style.userSelect="",document.body.style.overflowAnchor="",window.removeEventListener("mousemove",t),window.removeEventListener("mouseup",s)}},[Jt,ut]),e.jsxs(Wr,{header:{title:ar,subtitle:a("datainspector.subtitle",{count:c==="sql"&&re==="explain"?Se.length:c==="table"&&Z==="profiling"?Re.length:v?.length||0,mode:c==="table"?i:a("datainspector.sql_mode")}),onBack:vt,actions:e.jsxs(e.Fragment,{children:[ns&&e.jsxs("button",{onClick:()=>{Nt(ns.replace(/^#/,""))},className:"h-10 flex items-center gap-2 px-3 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-sm font-semibold rounded-lg border border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-700 transition-all",title:a("datainspector.back_to_dashboard"),children:[e.jsx(ul,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:a("datainspector.back_to_dashboard")})]}),!os&&e.jsxs("div",{className:"flex items-center bg-slate-100 dark:bg-slate-800 p-1 rounded-lg",children:[e.jsxs("button",{onClick:()=>{B("table"),H()},className:`px-3 py-1.5 rounded-md text-sm font-medium transition-all flex items-center gap-2 ${c==="table"?"bg-white dark:bg-slate-700 shadow text-blue-600 dark:text-blue-400":"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"}`,children:[e.jsx(bl,{className:"w-4 h-4"}),a("datainspector.table_mode")]}),e.jsxs("button",{onClick:()=>{B("sql"),U(ma?"explain":"result"),V||z(`SELECT * FROM ${i} LIMIT 10`)},className:`px-3 py-1.5 rounded-md text-sm font-medium transition-all flex items-center gap-2 ${c==="sql"?"bg-white dark:bg-slate-700 shadow text-blue-600 dark:text-blue-400":"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"}`,children:[e.jsx(ml,{className:"w-4 h-4"}),a("datainspector.sql_mode")]})]}),e.jsx("button",{onClick:H,className:"h-10 w-10 flex items-center justify-center bg-white dark:bg-slate-800 text-slate-500 dark:text-slate-400 rounded-lg border border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-700 hover:text-slate-700 dark:hover:text-slate-200 transition-all",title:a("datainspector.refresh_title"),children:e.jsx(Ie,{className:`w-4 h-4 ${ve?"animate-spin":""}`})}),e.jsxs("button",{onClick:Es,className:"h-10 flex items-center gap-2 px-4 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-sm font-semibold rounded-lg border border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-700 transition-all",children:[e.jsx(pl,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:a("datainspector.export_excel")})]})]})},rightPanel:{title:c==="table"?a("datainspector.table_tools","Table Tools"):a("datainspector.sql_assist","SQL Workspace"),enabled:c==="sql"||c==="table",triggerTitle:c==="table"?a("datainspector.table_tools","Table Tools"):a("datainspector.sql_assist","SQL Workspace"),width:"sm",isOpen:c==="table"?Lt:Ws,onOpenChange:c==="table"?se:ie,content:c==="table"?e.jsxs("div",{className:"h-full min-h-0 flex flex-col gap-4",children:[e.jsxs("div",{className:"inline-flex items-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 p-1 flex-shrink-0",children:[e.jsx("button",{type:"button",onClick:()=>Ae("columns"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${de==="columns"?"bg-blue-600 text-white":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:a("datainspector.table_tools_tab_columns","Columns")}),e.jsx("button",{type:"button",onClick:()=>Ae("filters"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${de==="filters"?"bg-blue-600 text-white":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:a("datainspector.table_tools_tab_filters","Filters")}),e.jsx("button",{type:"button",onClick:()=>Ae("actions"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${de==="actions"?"bg-blue-600 text-white":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:a("datainspector.table_tools_tab_actions","Actions")})]}),de==="columns"&&e.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-2",children:[e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:a("datainspector.table_tools_columns_hint","Inspect schema and set sorting per column.")}),e.jsxs("div",{className:"rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900/40 p-2 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:a("datainspector.table_tools_field_picker","Field Picker")}),e.jsx("span",{className:"text-[11px] text-slate-500 dark:text-slate-400",children:a("datainspector.table_tools_selected_count",{count:ce.length,defaultValue:"{{count}} selected"})})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>Me((D||[]).map(t=>t.name)),className:"h-7 w-7 inline-flex items-center justify-center rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:a("datainspector.table_tools_select_all_fields","Select all"),"aria-label":a("datainspector.table_tools_select_all_fields","Select all"),children:e.jsx(il,{className:"w-3.5 h-3.5"})}),e.jsx("button",{type:"button",onClick:()=>Me([]),className:"h-7 w-7 inline-flex items-center justify-center rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:a("datainspector.table_tools_clear_field_selection","Clear"),"aria-label":a("datainspector.table_tools_clear_field_selection","Clear"),children:e.jsx(kt,{className:"w-3.5 h-3.5"})}),e.jsxs("button",{type:"button",onClick:()=>{Rr(!1)},className:"h-7 px-2 inline-flex items-center gap-1 text-[11px] rounded border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/30 text-blue-700 dark:text-blue-300",children:[e.jsx(dl,{className:"w-3.5 h-3.5"}),a("datainspector.sql_assist","SQL Workspace")]}),e.jsx("button",{type:"button",onClick:()=>{Ir()},className:"h-7 w-7 inline-flex items-center justify-center text-[11px] rounded border border-blue-200 bg-blue-600 hover:bg-blue-700 text-white",title:a("datainspector.table_tools_apply_to_table","Apply to Table"),"aria-label":a("datainspector.table_tools_apply_to_table","Apply to Table"),children:e.jsx(ft,{className:"w-3.5 h-3.5 fill-current"})})]})]}),e.jsx("div",{className:"flex-1 min-h-0 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg divide-y divide-slate-100 dark:divide-slate-700",children:(D||[]).length===0?e.jsx("div",{className:"p-3 text-xs text-slate-400 dark:text-slate-500",children:a("common.no_data")}):(D||[]).map(t=>{const s=$?.key===t.name,r=s?$?.direction:null,n=ce.includes(t.name);return e.jsx("div",{className:`p-3 space-y-2 ${s?"bg-blue-50/60 dark:bg-blue-900/20":""} ${n?"ring-1 ring-inset ring-blue-200 dark:ring-blue-700/60":""}`,children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("label",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("input",{type:"checkbox",checked:n,onChange:()=>{Me(o=>o.includes(t.name)?o.filter(x=>x!==t.name):[...o,t.name])}}),e.jsxs("div",{className:"text-xs font-semibold text-slate-700 dark:text-slate-200 truncate flex items-center gap-2",children:[e.jsx("span",{className:"truncate",children:t.name}),s&&e.jsx("span",{className:"px-1.5 py-0.5 rounded bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 text-[10px] font-bold",children:r==="asc"?"ASC":"DESC"})]})]}),e.jsx("div",{className:"text-[10px] text-slate-400 dark:text-slate-500",children:t.type||"-"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{type:"button",onClick:()=>Be({key:t.name,direction:"asc"}),className:`h-7 px-2 text-[11px] rounded border ${s&&r==="asc"?"border-blue-300 dark:border-blue-800 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300":"border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300"}`,title:a("datainspector.table_tools_sort_asc","Sort ascending"),children:"ASC"}),e.jsx("button",{type:"button",onClick:()=>Be({key:t.name,direction:"desc"}),className:`h-7 px-2 text-[11px] rounded border ${s&&r==="desc"?"border-blue-300 dark:border-blue-800 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300":"border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300"}`,title:a("datainspector.table_tools_sort_desc","Sort descending"),children:"DESC"})]})]})},t.name)})})]}),de==="filters"&&e.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-3",children:[e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:a("datainspector.table_tools_filters_hint","Manage global search and column filters.")}),e.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:a("datainspector.table_tools_global_search","Global Search")}),e.jsx("input",{type:"text",value:fe,onChange:t=>We(t.target.value),placeholder:a("datainspector.search_placeholder"),className:"w-full h-9 px-3 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none focus:ring-2 focus:ring-blue-500"}),e.jsxs("div",{className:"grid grid-cols-[1fr_1fr_auto] gap-2 items-end",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:a("datainspector.table_tools_column","Column")}),e.jsx("select",{value:Ne,onChange:t=>Rt(t.target.value),className:"w-full h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none",children:(D||[]).map(t=>e.jsx("option",{value:t.name,children:t.name},t.name))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:a("datainspector.table_tools_filter_value","Filter")}),e.jsx("input",{type:"text",value:It,onChange:t=>ya(t.target.value),className:"w-full h-9 px-3 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsx("button",{type:"button",onClick:qr,className:"h-9 px-3 rounded-lg border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 text-xs font-semibold hover:bg-blue-100 dark:hover:bg-blue-900/30",children:a("datainspector.table_tools_filter_apply","Apply")})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"inline-flex items-center gap-2 text-xs text-slate-600 dark:text-slate-300",children:[e.jsx("input",{type:"checkbox",checked:Gt,onChange:t=>le(t.target.checked)}),a("datainspector.table_tools_toggle_filter_row","Show filter row in table")]}),e.jsx("button",{type:"button",onClick:Tr,className:"text-[11px] text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200",children:a("datainspector.table_tools_clear_all","Clear all")})]}),e.jsx("div",{className:"flex-1 min-h-0 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg divide-y divide-slate-100 dark:divide-slate-700",children:Object.keys(me).length===0?e.jsx("div",{className:"p-3 text-xs text-slate-400 dark:text-slate-500",children:a("datainspector.table_tools_no_filters","No active column filters")}):Object.entries(me).map(([t,s])=>e.jsxs("div",{className:"p-3 flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-700 dark:text-slate-200 truncate",children:t}),e.jsx("div",{className:"text-[11px] text-slate-500 dark:text-slate-400 truncate",children:s||"-"})]}),e.jsx("button",{type:"button",onClick:()=>Er(t),className:"h-7 px-2 text-[11px] rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",children:a("common.remove","Remove")})]},t))})]}),de==="actions"&&e.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-3",children:[e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:a("datainspector.table_tools_actions_hint","Quick actions for current table context.")}),e.jsx("button",{type:"button",onClick:()=>H(),className:"h-9 px-3 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-xs font-semibold hover:bg-slate-50 dark:hover:bg-slate-700 text-left",children:a("common.refresh","Refresh")}),e.jsx("button",{type:"button",onClick:Es,className:"h-9 px-3 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-xs font-semibold hover:bg-slate-50 dark:hover:bg-slate-700 text-left",children:a("datainspector.table_tools_export_rows","Export current rows")}),e.jsx("button",{type:"button",onClick:Lr,className:"h-9 px-3 rounded-lg border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 text-xs font-semibold hover:bg-blue-100 dark:hover:bg-blue-900/30 text-left",children:a("datainspector.table_tools_open_sql","Open as SQL")}),e.jsx("button",{type:"button",onClick:xs,className:"h-9 px-3 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-xs font-semibold hover:bg-slate-50 dark:hover:bg-slate-700 text-left",children:a(ne?"datainspector.update_view":"datainspector.save_view")}),e.jsx("button",{type:"button",onClick:()=>{us()},disabled:!ne,className:"h-9 px-3 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-xs font-semibold hover:bg-slate-50 dark:hover:bg-slate-700 text-left disabled:opacity-40",children:a("datainspector.delete_view")}),ee==="table"&&e.jsx("button",{type:"button",onClick:bs,className:"h-9 px-3 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-xs font-semibold hover:bg-slate-50 dark:hover:bg-slate-700 text-left",children:a("datainspector.table_tools_create_index","Create index")}),ee==="table"&&e.jsxs("div",{className:"mt-1 pt-3 border-t border-slate-200 dark:border-slate-700 min-h-0 flex-1 flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:a("datainspector.index_suggestions_title","Index Suggestions")}),e.jsx("button",{type:"button",onClick:()=>{pr()},disabled:Ba,className:"h-7 px-2 rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300 text-[11px] disabled:opacity-40",children:Ba?a("common.loading","Loading..."):a("datainspector.index_suggestions_generate","Generate")})]}),e.jsx("div",{className:"text-[11px] text-slate-500 dark:text-slate-400",children:a("datainspector.index_suggestions_hint","Based on active filters, sorting, cardinality and existing indexes.")}),e.jsx("div",{className:"min-h-0 flex-1 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg divide-y divide-slate-100 dark:divide-slate-700",children:Ha.length===0?e.jsx("div",{className:"p-3 text-xs text-slate-400 dark:text-slate-500",children:a("datainspector.index_suggestions_empty","No suggestions yet. Generate to analyze this table.")}):Ha.map(t=>e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-700 dark:text-slate-200",children:t.indexName}),e.jsx("div",{className:"text-[11px] text-slate-500 dark:text-slate-400",children:t.reason}),e.jsxs("div",{className:"text-[11px] text-slate-500 dark:text-slate-400",children:[a("datainspector.index_suggestions_columns","Columns"),": ",e.jsx("span",{className:"font-mono",children:t.columns.join(", ")})]}),e.jsx("div",{className:"font-mono text-[10px] text-slate-400 dark:text-slate-500 break-all",children:t.sql}),e.jsx("button",{type:"button",onClick:()=>{hr(t)},disabled:za===t.id,className:"h-7 px-2 rounded border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/30 text-blue-700 dark:text-blue-300 text-[11px] disabled:opacity-40",children:za===t.id?a("common.saving","Saving..."):a("datainspector.index_suggestions_apply","Create")})]},t.id))})]})]})]}):e.jsxs("div",{className:"h-full min-h-0 flex flex-col gap-4",children:[e.jsxs("div",{className:"inline-flex items-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 p-1 flex-shrink-0",children:[e.jsx("button",{type:"button",onClick:()=>Na("manager"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${Tt==="manager"?"bg-blue-600 text-white":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:a("datainspector.sql_manager_tab","SQL Manager")}),e.jsx("button",{type:"button",onClick:()=>Na("assistant"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${Tt==="assistant"?"bg-blue-600 text-white":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:a("datainspector.assistant_tab","SQL Builder")})]}),Tt==="manager"?e.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-3 overflow-hidden",children:[e.jsxs("div",{className:K.templates?"min-h-0 flex-[0.9] flex flex-col gap-2":"flex-shrink-0",children:[e.jsxs("button",{type:"button",onClick:()=>sa("templates"),className:"flex items-center justify-between text-left",children:[e.jsx("span",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:a("datainspector.templates")}),e.jsx(te,{className:`w-4 h-4 text-slate-400 dark:text-slate-500 transition-transform ${K.templates?"rotate-180":""}`})]}),K.templates&&e.jsx("div",{className:"flex-1 min-h-0 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg divide-y divide-slate-100 dark:divide-slate-700",children:ks.map(t=>e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-700 dark:text-slate-200",children:a(`datainspector.template_${t.key}`)}),e.jsx("div",{className:"font-mono text-[10px] text-slate-400 dark:text-slate-500 truncate",children:t.sql}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx("button",{type:"button",onClick:()=>{qs(t.sql,!1,a(`datainspector.template_${t.key}`),a(`datainspector.template_${t.key}_description`,""))},className:"h-7 w-7 inline-flex items-center justify-center rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:a("common.open","Open"),"aria-label":a("common.open","Open"),children:e.jsx(ca,{className:"w-3.5 h-3.5"})}),e.jsx("button",{type:"button",onClick:()=>{qs(t.sql,!0,a(`datainspector.template_${t.key}`),a(`datainspector.template_${t.key}_description`,""))},className:"h-7 w-7 inline-flex items-center justify-center rounded border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/30 text-blue-700 dark:text-blue-300",title:a("datainspector.run_sql"),"aria-label":a("datainspector.run_sql"),children:e.jsx(ft,{className:"w-3.5 h-3.5"})})]})]},t.key))})]}),e.jsxs("div",{className:K.manager?"min-h-0 flex-[1.3] flex flex-col gap-2":"flex-shrink-0",children:[e.jsxs("button",{type:"button",onClick:()=>sa("manager"),className:"flex items-center justify-between text-left",children:[e.jsxs("span",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:[a("datainspector.sql_manager_tab","SQL Manager")," (",P.length,")"]}),e.jsx(te,{className:`w-4 h-4 text-slate-400 dark:text-slate-500 transition-transform ${K.manager?"rotate-180":""}`})]}),K.manager&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"text",value:qt,onChange:t=>Bs(t.target.value),placeholder:a("datainspector.sql_manager_search_placeholder","Search patterns..."),className:"w-full h-9 px-3 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none focus:ring-2 focus:ring-blue-500 flex-shrink-0"}),e.jsx("div",{className:"flex-1 min-h-0 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg divide-y divide-slate-100 dark:divide-slate-700",children:Ss.length===0?e.jsx("div",{className:"p-4 text-xs text-slate-400 dark:text-slate-500",children:a("datainspector.sql_manager_no_results","No matches")}):Ss.map(t=>e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsx("div",{className:"flex items-start justify-between gap-2",children:e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs font-semibold text-slate-700 dark:text-slate-200 flex items-center gap-2",children:[t.name,Number(t.is_favorite)===1&&e.jsx(xa,{className:"w-3.5 h-3.5 text-amber-500 fill-current"})]}),e.jsx("div",{className:"font-mono text-[10px] text-slate-400 dark:text-slate-500 truncate",children:t.sql_text})]})}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx("button",{type:"button",onClick:()=>{Cs(t,!1)},className:"h-7 w-7 inline-flex items-center justify-center rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:a("common.open","Open"),"aria-label":a("common.open","Open"),children:e.jsx(ca,{className:"w-3.5 h-3.5"})}),e.jsx("button",{type:"button",onClick:()=>{Cs(t,!0)},className:"h-7 w-7 inline-flex items-center justify-center rounded border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/30 text-blue-700 dark:text-blue-300",title:a("datainspector.run_sql"),"aria-label":a("datainspector.run_sql"),children:e.jsx(ft,{className:"w-3.5 h-3.5"})}),e.jsx("button",{type:"button",onClick:()=>{w.setSqlStatementFavorite(t.id,Number(t.is_favorite)!==1).then(O)},className:"h-7 w-7 inline-flex items-center justify-center rounded border border-amber-200 dark:border-amber-800 bg-amber-50 dark:bg-amber-900/20 hover:bg-amber-100 dark:hover:bg-amber-900/30 text-amber-700 dark:text-amber-300",title:Number(t.is_favorite)===1?a("datainspector.unpin"):a("datainspector.pin"),"aria-label":Number(t.is_favorite)===1?a("datainspector.unpin"):a("datainspector.pin"),children:e.jsx(xa,{className:`w-3.5 h-3.5 ${Number(t.is_favorite)===1?"fill-current":""}`})}),e.jsx("button",{type:"button",onClick:()=>{Cr(t)},className:"px-2 py-1 text-[11px] rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:a("datainspector.rename_template"),children:e.jsx(cl,{className:"w-3 h-3"})}),e.jsx("button",{type:"button",onClick:()=>{Sr(t)},className:"px-2 py-1 text-[11px] rounded border border-rose-200 dark:border-rose-800 bg-rose-50 dark:bg-rose-900/20 hover:bg-rose-100 dark:hover:bg-rose-900/30 text-rose-700 dark:text-rose-300",title:a("datainspector.delete_template"),children:e.jsx(xl,{className:"w-3 h-3"})})]})]},t.id))})]})]}),e.jsxs("div",{className:K.recent?"min-h-0 flex-[0.8] flex flex-col gap-2":"flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{type:"button",onClick:()=>sa("recent"),className:"flex items-center justify-between gap-2 text-left flex-1",children:[e.jsx("span",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:a("datainspector.recent_queries")}),e.jsx(te,{className:`w-4 h-4 text-slate-400 dark:text-slate-500 transition-transform ${K.recent?"rotate-180":""}`})]}),K.recent&&e.jsx("button",{type:"button",onClick:()=>yt([]),className:"text-[11px] text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200",children:a("datainspector.clear_history")})]}),K.recent&&e.jsx("div",{className:"flex-1 min-h-0 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg divide-y divide-slate-100 dark:divide-slate-700",children:ba.length===0?e.jsx("div",{className:"p-3 text-xs text-slate-400 dark:text-slate-500",children:a("common.no_data")}):ba.map((t,s)=>e.jsx("button",{type:"button",onClick:()=>z(t),className:"w-full text-left p-3 hover:bg-slate-50 dark:hover:bg-slate-700/60",children:e.jsx("div",{className:"font-mono text-[11px] text-slate-600 dark:text-slate-300 truncate",children:t})},`${s}-${t.slice(0,16)}`))})]})]}):e.jsxs("div",{className:"h-full min-h-0 flex flex-col",children:[e.jsxs("div",{className:"flex-1 min-h-0 overflow-auto pr-1 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:a("datainspector.assistant_hint","Build SQL by selecting table, columns and optional aggregation.")}),e.jsxs("button",{type:"button",onClick:kr,className:"inline-flex items-center gap-1 px-2 py-1 rounded-md border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-[11px] hover:bg-slate-50 dark:hover:bg-slate-700",children:[e.jsx(kt,{className:"w-3 h-3"}),a("datainspector.assistant_reset","Reset")]})]}),e.jsxs("div",{className:"space-y-1 rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50/40 dark:bg-slate-900/40 px-2 py-2",children:[e.jsxs("button",{type:"button",onClick:()=>_e("table"),className:"w-full flex items-center justify-between text-left rounded-md px-1 py-1 hover:bg-slate-100/70 dark:hover:bg-slate-800/70",children:[e.jsx("span",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:a("datainspector.assistant_table","Table")}),e.jsx(te,{className:`w-4 h-4 text-slate-400 dark:text-slate-500 transition-transform ${M.table?"rotate-180":""}`})]}),M.table&&e.jsx("select",{value:J,onChange:t=>qa(t.target.value),className:"w-full h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none focus:ring-2 focus:ring-blue-500",children:pe.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{className:"space-y-1 rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50/40 dark:bg-slate-900/40 px-2 py-2",children:[e.jsxs("button",{type:"button",onClick:()=>_e("columns"),className:"w-full flex items-center justify-between text-left rounded-md px-1 py-1 hover:bg-slate-100/70 dark:hover:bg-slate-800/70",children:[e.jsx("span",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:a("datainspector.assistant_columns","Columns")}),e.jsx(te,{className:`w-4 h-4 text-slate-400 dark:text-slate-500 transition-transform ${M.columns?"rotate-180":""}`})]}),M.columns&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>Oe(L),className:"text-[11px] text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200",children:a("datainspector.assistant_select_all","Select all")}),e.jsx("button",{type:"button",onClick:()=>Oe([]),className:"text-[11px] text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200",children:a("datainspector.assistant_clear_all","Clear")})]}),e.jsx("input",{type:"text",value:Mt,onChange:t=>La(t.target.value),placeholder:a("datainspector.assistant_column_search_placeholder","Search columns..."),className:"w-full h-8 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-xs text-slate-700 dark:text-slate-200 outline-none"}),e.jsxs("div",{className:"max-h-28 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg p-2 space-y-1",children:[vs.map(t=>e.jsxs("label",{className:"flex items-center gap-2 text-xs text-slate-600 dark:text-slate-300",children:[e.jsx("input",{type:"checkbox",checked:rt.includes(t),onChange:()=>{Oe(s=>s.includes(t)?s.filter(r=>r!==t):[...s,t])},className:"h-4 w-4 rounded border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-900 text-blue-600 dark:text-blue-400 accent-blue-600 dark:accent-blue-500 focus:ring-blue-500/50"}),e.jsx("span",{className:"font-mono",children:t})]},t)),vs.length===0&&e.jsx("p",{className:"text-[11px] text-slate-400 dark:text-slate-500 px-1 py-0.5",children:a("datainspector.sql_manager_no_results","No matches")})]})]})]}),e.jsxs("div",{className:"space-y-1 rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50/40 dark:bg-slate-900/40 px-2 py-2",children:[e.jsxs("button",{type:"button",onClick:()=>_e("aggregation"),className:"w-full flex items-center justify-between text-left rounded-md px-1 py-1 hover:bg-slate-100/70 dark:hover:bg-slate-800/70",children:[e.jsx("span",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:a("datainspector.assistant_aggregation","Aggregation")}),e.jsx(te,{className:`w-4 h-4 text-slate-400 dark:text-slate-500 transition-transform ${M.aggregation?"rotate-180":""}`})]}),M.aggregation&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:a("datainspector.assistant_aggregation_function","Function")}),e.jsxs("select",{value:R,onChange:t=>Ia(t.target.value),className:"w-full h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none",children:[e.jsx("option",{value:"none",children:a("datainspector.assistant_none","None")}),e.jsx("option",{value:"count",children:"COUNT"}),e.jsx("option",{value:"sum",children:"SUM"}),e.jsx("option",{value:"avg",children:"AVG"}),e.jsx("option",{value:"min",children:"MIN"}),e.jsx("option",{value:"max",children:"MAX"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:a("datainspector.assistant_aggregation_field","Aggregation Field")}),e.jsxs("select",{value:xe,disabled:R==="none"||R==="count",onChange:t=>De(t.target.value),className:"w-full h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none disabled:opacity-40",children:[e.jsx("option",{value:"",children:"-"}),L.map(t=>e.jsx("option",{value:t,children:t},t))]})]})]})})]}),e.jsxs("div",{className:"space-y-1 rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50/40 dark:bg-slate-900/40 px-2 py-2",children:[e.jsxs("button",{type:"button",onClick:()=>_e("grouping"),disabled:!_s,className:"w-full flex items-center justify-between text-left rounded-md px-1 py-1 hover:bg-slate-100/70 dark:hover:bg-slate-800/70 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("span",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:a("datainspector.assistant_group_by","Group by")}),e.jsx(te,{className:`w-4 h-4 text-slate-400 dark:text-slate-500 transition-transform ${M.grouping?"rotate-180":""}`})]}),_s?M.grouping&&e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:a("datainspector.assistant_grouping_columns","Grouping Columns")}),e.jsx("div",{className:"max-h-20 overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg p-2 space-y-1",children:L.map(t=>e.jsxs("label",{className:"flex items-center gap-2 text-xs text-slate-600 dark:text-slate-300",children:[e.jsx("input",{type:"checkbox",checked:Dt.includes(t),onChange:()=>{Ft(s=>s.includes(t)?s.filter(r=>r!==t):[...s,t])},className:"h-4 w-4 rounded border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-900 text-blue-600 dark:text-blue-400 accent-blue-600 dark:accent-blue-500 focus:ring-blue-500/50"}),e.jsx("span",{className:"font-mono",children:t})]},t))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:a("datainspector.assistant_metric_alias","Metric Alias")}),e.jsx("input",{type:"text",value:Q,onChange:t=>$a(t.target.value),className:"w-full h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none"})]})]}):e.jsx("p",{className:"text-[11px] text-slate-400 dark:text-slate-500 px-1 py-1",children:a("datainspector.assistant_grouping_requires_aggregation","Enable aggregation to configure grouping.")})]}),e.jsxs("div",{className:"space-y-1 rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50/40 dark:bg-slate-900/40 px-2 py-2",children:[e.jsxs("button",{type:"button",onClick:()=>_e("filter"),className:"w-full flex items-center justify-between text-left rounded-md px-1 py-1 hover:bg-slate-100/70 dark:hover:bg-slate-800/70",children:[e.jsx("span",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:a("datainspector.assistant_filter","Filter")}),e.jsx(te,{className:`w-4 h-4 text-slate-400 dark:text-slate-500 transition-transform ${M.filter?"rotate-180":""}`})]}),M.filter&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center justify-end",children:e.jsxs("button",{type:"button",onClick:vr,className:"h-7 px-2 inline-flex items-center gap-1 rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-[11px] hover:bg-slate-50 dark:hover:bg-slate-700",children:[e.jsx(Ds,{className:"w-3 h-3"}),a("datainspector.assistant_add_filter","Add filter")]})}),e.jsx("div",{className:"space-y-2",children:lt.map((t,s)=>e.jsxs("div",{className:"rounded-lg border border-slate-200 dark:border-slate-700 p-2 bg-white/60 dark:bg-slate-900/40 space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-[70px_minmax(0,1fr)] gap-2",children:[s>0?e.jsxs("select",{value:t.connector,onChange:r=>ht(t.id,{connector:r.target.value}),className:"h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-xs text-slate-700 dark:text-slate-200 outline-none",children:[e.jsx("option",{value:"AND",children:"AND"}),e.jsx("option",{value:"OR",children:"OR"})]}):e.jsx("div",{className:"h-9 flex items-center text-[11px] font-semibold text-slate-400 dark:text-slate-500 px-1",children:"WHERE"}),e.jsxs("select",{value:t.column,onChange:r=>ht(t.id,{column:r.target.value}),className:"h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none",children:[e.jsx("option",{value:"",children:a("datainspector.assistant_sort_field","Field")}),L.map(r=>e.jsx("option",{value:r,children:r},r))]})]}),e.jsxs("div",{className:"grid grid-cols-[110px_minmax(0,1fr)_auto] gap-2",children:[e.jsxs("select",{value:t.operator,onChange:r=>ht(t.id,{operator:r.target.value}),className:"h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none",children:[e.jsx("option",{value:"=",children:"="}),e.jsx("option",{value:"!=",children:"!="}),e.jsx("option",{value:">",children:">"}),e.jsx("option",{value:">=",children:">="}),e.jsx("option",{value:"<",children:"<"}),e.jsx("option",{value:"<=",children:"<="}),e.jsx("option",{value:"LIKE",children:"LIKE"}),e.jsx("option",{value:"NOT LIKE",children:"NOT LIKE"}),e.jsx("option",{value:"IS NULL",children:"IS NULL"}),e.jsx("option",{value:"IS NOT NULL",children:"IS NOT NULL"})]}),e.jsx("input",{type:"text",value:t.value,onChange:r=>ht(t.id,{value:r.target.value}),placeholder:a("datainspector.assistant_filter_value","Value"),disabled:t.operator==="IS NULL"||t.operator==="IS NOT NULL",className:"h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none disabled:opacity-40"}),e.jsxs("div",{className:"h-9 flex items-center gap-1",children:[e.jsx("button",{type:"button",onClick:()=>ws(t.id,"up"),disabled:s===0,className:"h-9 w-7 inline-flex items-center justify-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700 disabled:opacity-40",title:a("common.move_up","Move up"),children:e.jsx(Fs,{className:"w-3.5 h-3.5"})}),e.jsx("button",{type:"button",onClick:()=>ws(t.id,"down"),disabled:s===lt.length-1,className:"h-9 w-7 inline-flex items-center justify-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700 disabled:opacity-40",title:a("common.move_down","Move down"),children:e.jsx(Ps,{className:"w-3.5 h-3.5"})}),e.jsx("button",{type:"button",onClick:()=>_r(t.id),className:"h-9 w-7 inline-flex items-center justify-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700",title:a("datainspector.assistant_clear_all","Clear"),children:e.jsx(kt,{className:"w-3.5 h-3.5"})})]})]})]},t.id))}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:a("datainspector.assistant_where","WHERE")}),e.jsxs("select",{value:At,onChange:t=>Ta(t.target.value),className:"h-7 px-2 border border-slate-200 dark:border-slate-700 rounded bg-white dark:bg-slate-900 text-[11px] text-slate-700 dark:text-slate-200 outline-none",title:a("datainspector.assistant_where_connector","Join with filters"),children:[e.jsx("option",{value:"AND",children:"AND"}),e.jsx("option",{value:"OR",children:"OR"})]})]}),e.jsx("input",{type:"text",value:$t,onChange:t=>Ea(t.target.value),placeholder:a("datainspector.assistant_where_placeholder","status = 'active'"),className:"w-full h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none"})]})]})]}),e.jsxs("div",{className:"space-y-1 rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50/40 dark:bg-slate-900/40 px-2 py-2",children:[e.jsxs("button",{type:"button",onClick:()=>_e("sorting"),className:"w-full flex items-center justify-between text-left rounded-md px-1 py-1 hover:bg-slate-100/70 dark:hover:bg-slate-800/70",children:[e.jsx("span",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:a("datainspector.assistant_order_by","Order by")}),e.jsx(te,{className:`w-4 h-4 text-slate-400 dark:text-slate-500 transition-transform ${M.sorting?"rotate-180":""}`})]}),M.sorting&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center justify-end",children:e.jsxs("button",{type:"button",onClick:wr,className:"h-7 px-2 inline-flex items-center gap-1 rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-[11px] hover:bg-slate-50 dark:hover:bg-slate-700",children:[e.jsx(Ds,{className:"w-3 h-3"}),a("datainspector.assistant_add_sort","Add sort")]})}),e.jsx("div",{className:"space-y-2",children:nt.map((t,s)=>e.jsxs("div",{className:"grid grid-cols-[minmax(0,1fr)_110px_auto] gap-2",children:[e.jsxs("select",{value:t.column,onChange:r=>Ns(t.id,{column:r.target.value}),className:"h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none",children:[e.jsx("option",{value:"",children:a("datainspector.assistant_auto","Auto")}),R!=="none"&&e.jsx("option",{value:Q||"metric_value",children:Q||"metric_value"}),L.map(r=>e.jsx("option",{value:r,children:r},r))]}),e.jsxs("select",{value:t.direction,onChange:r=>Ns(t.id,{direction:r.target.value}),className:"h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none",children:[e.jsx("option",{value:"DESC",children:"DESC"}),e.jsx("option",{value:"ASC",children:"ASC"})]}),e.jsxs("div",{className:"h-9 flex items-center gap-1",children:[e.jsx("button",{type:"button",onClick:()=>js(t.id,"up"),disabled:s===0,className:"h-9 w-7 inline-flex items-center justify-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700 disabled:opacity-40",title:a("common.move_up","Move up"),children:e.jsx(Fs,{className:"w-3.5 h-3.5"})}),e.jsx("button",{type:"button",onClick:()=>js(t.id,"down"),disabled:s===nt.length-1,className:"h-9 w-7 inline-flex items-center justify-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700 disabled:opacity-40",title:a("common.move_down","Move down"),children:e.jsx(Ps,{className:"w-3.5 h-3.5"})}),e.jsx("button",{type:"button",onClick:()=>Nr(t.id),className:"h-9 w-7 inline-flex items-center justify-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700",title:a("datainspector.assistant_clear_all","Clear"),children:e.jsx(kt,{className:"w-3.5 h-3.5"})})]})]},t.id))}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:a("datainspector.assistant_limit","Limit")}),e.jsx("input",{type:"number",min:1,max:1e5,value:Ot,onChange:t=>Ra(Number(t.target.value)),className:"w-full h-9 px-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-900 text-sm text-slate-700 dark:text-slate-200 outline-none"})]})]})]}),e.jsxs("div",{className:"space-y-1 rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50/40 dark:bg-slate-900/40 px-2 py-2",children:[e.jsxs("button",{type:"button",onClick:()=>_e("preview"),className:"w-full flex items-center justify-between text-left rounded-md px-1 py-1 hover:bg-slate-100/70 dark:hover:bg-slate-800/70",children:[e.jsx("span",{className:"text-[11px] uppercase tracking-wider font-bold text-slate-500 dark:text-slate-400",children:a("datainspector.assistant_generated_sql","Generated SQL")}),e.jsx(te,{className:`w-4 h-4 text-slate-400 dark:text-slate-500 transition-transform ${M.preview?"rotate-180":""}`})]}),M.preview&&e.jsx("textarea",{readOnly:!0,value:aa,className:"w-full h-32 p-2 font-mono text-xs border border-slate-200 dark:border-slate-700 rounded-lg bg-slate-50 dark:bg-slate-900 text-slate-700 dark:text-slate-200"})]})]}),e.jsx("div",{className:"mt-3 -mx-5 -mb-5 px-5 py-3 border-t border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-950/90",children:e.jsxs("div",{className:"flex flex-wrap justify-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>{ys("replace")},className:"px-3 py-1.5 rounded-md border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-xs hover:bg-slate-50 dark:hover:bg-slate-700",children:a("datainspector.assistant_replace_editor","Replace Editor")}),e.jsx("button",{type:"button",onClick:()=>{ys("run")},className:"px-3 py-1.5 rounded-md border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 text-xs hover:bg-blue-100 dark:hover:bg-blue-900/30",children:a("datainspector.run_sql")})]})})]})]})},footer:fr,breadcrumbs:[{label:sr}],fillHeight:!0,children:[e.jsx("div",{className:"fixed top-0 left-0 w-full h-[3px] bg-blue-100 dark:bg-blue-900/30 z-[100] overflow-hidden",children:ve&&e.jsx("div",{className:"h-full bg-blue-600 dark:bg-blue-400 animate-pulse",style:{width:"40%"}})}),c==="table"?e.jsx("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm flex-shrink-0",children:e.jsx("div",{className:"grid grid-cols-1 gap-3",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[minmax(220px,320px)_minmax(280px,1fr)_auto] gap-3",children:[e.jsxs("div",{className:"relative min-w-0",children:[e.jsx("select",{value:i,onChange:t=>{Vt(t.target.value),We(""),Be(null),Te({}),le(!1),bt(""),Ee(1)},className:"w-full h-10 appearance-none pl-10 pr-10 border border-slate-200 dark:border-slate-700 rounded-lg bg-slate-50 dark:bg-slate-900 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 cursor-pointer text-sm font-medium",children:Ve?.map(t=>e.jsx("option",{value:t.name,children:t.type==="view"?`${t.name} (view)`:t.name},t.name))}),e.jsx(Ms,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none"}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 w-2 h-2 border-r-2 border-b-2 border-slate-400 rotate-45 pointer-events-none"})]}),e.jsxs("div",{className:"relative min-w-0",children:[e.jsx("input",{type:"text",placeholder:a("datainspector.search_placeholder"),value:fe,onChange:t=>{We(t.target.value),Ee(1)},className:"w-full h-10 pl-10 pr-4 border border-slate-200 dark:border-slate-700 rounded-lg bg-slate-50 dark:bg-slate-900 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx(Os,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"})]}),e.jsxs("button",{onClick:()=>H(),className:"h-10 px-3 flex items-center justify-center gap-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300 text-sm font-medium",title:a("datainspector.refresh_title"),children:[e.jsx(Ie,{className:`w-4 h-4 ${ve?"animate-spin":""}`}),e.jsx("span",{children:a("common.refresh","Refresh")})]})]})})}):e.jsxs("div",{ref:rs,className:"flex flex-col gap-2 bg-white dark:bg-slate-800 p-4 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm ring-1 ring-slate-900/5 flex-shrink-0",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-full bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden text-slate-800 dark:text-slate-200 min-h-[120px]",style:{height:`${ue}px`},children:e.jsx(Zr,{value:V,height:`${ue}px`,basicSetup:{lineNumbers:fa,foldGutter:!1,highlightActiveLine:tt,highlightActiveLineGutter:fa&&tt},extensions:$r,placeholder:a("datainspector.sql_placeholder"),onChange:t=>{z(t),U("explain")}})}),e.jsxs("div",{className:"absolute bottom-4 right-4 flex gap-2",children:[e.jsx("button",{onClick:ir,className:"px-3 py-1 text-xs text-slate-500 hover:text-slate-700 dark:hover:text-slate-300",children:a("datainspector.clear_sql")}),e.jsxs("button",{onClick:()=>{or()},className:"flex items-center gap-2 px-4 py-1.5 bg-blue-600 hover:bg-blue-700 text-white rounded-md text-sm font-medium shadow-sm transition-colors",children:[ve?e.jsx(Ie,{className:"w-3 h-3 animate-spin"}):e.jsx(ft,{className:"w-3 h-3 fill-current"}),a("datainspector.run_sql")]}),ve&&e.jsx("button",{onClick:()=>{dr()},className:"px-3 py-1.5 rounded-md text-sm font-medium border bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 text-slate-500 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700",children:a("datainspector.stop_sql","Stop")}),e.jsx("button",{onClick:()=>ie(!0),className:"h-9 w-9 flex items-center justify-center rounded-md border bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 text-slate-500 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700",title:a("datainspector.sql_assist","SQL Workspace"),"aria-label":a("datainspector.sql_assist","SQL Workspace"),children:e.jsx(ca,{className:"w-4 h-4"})}),e.jsxs("button",{onClick:xr,className:"flex items-center gap-1 px-3 py-1.5 rounded-md text-sm font-medium border bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 text-slate-500 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700",title:a("common.save","Save"),children:[e.jsx(al,{className:"w-3.5 h-3.5"}),a("common.save","Save")]}),e.jsxs("button",{onClick:()=>{cr(V)},className:`flex items-center gap-1 px-3 py-1.5 rounded-md text-sm font-medium border transition-colors ${gt?"bg-amber-50 dark:bg-amber-900/20 border-amber-200 dark:border-amber-800 text-amber-700 dark:text-amber-300":"bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 text-slate-500 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700"}`,title:a(gt?"datainspector.unpin_query":"datainspector.pin_query"),children:[e.jsx(xa,{className:`w-3.5 h-3.5 ${gt?"fill-current":""}`}),a(gt?"datainspector.unpin":"datainspector.pin")]})]})]}),Oa&&e.jsxs("div",{className:"mt-2 px-3 py-2 text-xs rounded-md border border-amber-200 dark:border-amber-800/60 bg-amber-50 dark:bg-amber-900/20 text-amber-800 dark:text-amber-200 flex items-start justify-between gap-3",children:[e.jsx("span",{children:Oa}),e.jsx("button",{type:"button",onClick:()=>it(""),className:"shrink-0 text-amber-700 dark:text-amber-300 hover:text-amber-900 dark:hover:text-amber-100 font-bold leading-none","aria-label":a("common.close","Close"),title:a("common.close","Close"),children:"x"})]}),e.jsxs("div",{className:"px-3 py-2 text-[11px] rounded-md border border-slate-200 dark:border-slate-700 bg-slate-50/70 dark:bg-slate-900/40 text-slate-500 dark:text-slate-400 flex items-center justify-between gap-3 flex-wrap",children:[e.jsxs("div",{className:"min-w-0 inline-flex items-center gap-1 text-left",children:[e.jsxs("span",{className:"font-semibold text-slate-600 dark:text-slate-300",children:[a("datainspector.active_template","Template"),":"]}),ze.name?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"font-medium text-slate-700 dark:text-slate-200",children:ze.name}),e.jsx("span",{className:"truncate max-w-[22rem] text-slate-500 dark:text-slate-400",title:ze.description||a("datainspector.no_template_description","No description"),children:ze.description?`(${ze.description})`:`(${a("datainspector.no_template_description","No description")})`})]}):e.jsx("span",{className:"text-slate-400 dark:text-slate-500",children:"-"})]}),e.jsxs("div",{className:"inline-flex items-center gap-1 whitespace-nowrap ml-auto text-right",children:[e.jsxs("span",{children:[a("datainspector.sql_assist","SQL Workspace"),":"]}),e.jsxs("span",{children:[ks.length," ",a("datainspector.templates")]}),e.jsx("span",{children:"|"}),e.jsxs("span",{children:[yr," ",a("datainspector.favorite_queries")]}),e.jsx("span",{children:"|"}),e.jsxs("span",{children:[P.length," ",a("datainspector.custom_templates")]})]})]})]}),c==="sql"&&e.jsx("div",{onMouseDown:Mr,className:`h-3 -mt-2 -mb-1 flex items-center justify-center cursor-row-resize ${Jt?"opacity-100":"opacity-70 hover:opacity-100"}`,title:a("datainspector.resize_sql_split","Resize SQL and results panes"),children:e.jsx("div",{className:"h-1 w-12 rounded-full bg-slate-300 dark:bg-slate-600"})}),e.jsxs("div",{className:"flex-1 bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 shadow-sm overflow-hidden flex flex-col min-h-0 relative",style:c==="sql"?{minHeight:`${ls}px`}:void 0,children:[ve&&v&&v.length>0&&!(c==="sql"&&re==="explain")&&e.jsx("div",{className:"absolute inset-0 bg-white/40 dark:bg-slate-800/40 z-10 flex items-center justify-center backdrop-blur-[1px]",children:e.jsx("div",{className:"bg-white dark:bg-slate-900 p-4 rounded-full shadow-xl border border-slate-100 dark:border-slate-700",children:e.jsx(Ie,{className:"w-8 h-8 text-blue-600 dark:text-blue-400 animate-spin"})})}),c==="sql"&&e.jsxs("div",{className:"px-4 py-2 border-b border-slate-100 dark:border-slate-700 bg-slate-50/60 dark:bg-slate-900/30 flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"inline-flex items-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 p-1",children:[e.jsx("button",{onClick:()=>U("result"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${re==="result"?"bg-blue-600 text-white":"text-slate-500 hover:text-slate-700 dark:text-slate-300 dark:hover:text-slate-100"}`,children:a("datainspector.output_results","Results")}),e.jsx("button",{onClick:()=>{U("explain")},className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${re==="explain"?"bg-indigo-600 text-white":"text-slate-500 hover:text-slate-700 dark:text-slate-300 dark:hover:text-slate-100"}`,children:a("datainspector.output_explain","Explain")})]}),e.jsx("span",{className:"text-[11px] text-slate-400",children:a("datainspector.explain_hint")})]}),c==="table"&&e.jsxs("div",{className:"px-4 py-2 border-b border-slate-100 dark:border-slate-700 bg-slate-50/60 dark:bg-slate-900/30 flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"inline-flex items-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 p-1",children:[e.jsx("button",{onClick:()=>as("data"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${Z==="data"?"bg-blue-600 text-white":"text-slate-500 hover:text-slate-700 dark:text-slate-300 dark:hover:text-slate-100"}`,children:a("datainspector.result_tab_data","Data")}),e.jsx("button",{onClick:()=>as("profiling"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-colors ${Z==="profiling"?"bg-indigo-600 text-white":"text-slate-500 hover:text-slate-700 dark:text-slate-300 dark:hover:text-slate-100"}`,children:a("datainspector.result_tab_profile","Profiling")})]}),e.jsx("span",{className:"text-[11px] text-slate-400",children:Z==="profiling"?a("datainspector.profiling_issues",{count:Ar}):a("datainspector.auto_limit",{limit:qe})})]}),c==="table"&&Z==="profiling"&&e.jsxs("div",{className:"px-4 py-2 border-b border-slate-100 dark:border-slate-700 bg-white dark:bg-slate-800 flex items-center justify-between gap-3 text-[11px]",children:[e.jsx("div",{className:"font-semibold uppercase tracking-wider text-slate-500",children:a("datainspector.profiling_settings","Profiling Settings")}),e.jsxs("div",{className:"flex items-center gap-2 text-slate-500 dark:text-slate-400",children:[e.jsxs("label",{className:"flex items-center gap-1",children:[e.jsx("span",{children:a("datainspector.null_threshold")}),e.jsx("input",{type:"number",min:0,max:100,value:ke.nullRate,onChange:t=>{const s=Number(t.target.value);Number.isNaN(s)||Kt({...ke,nullRate:Math.max(0,Math.min(100,s))})},className:"w-14 px-1.5 py-0.5 border border-slate-200 dark:border-slate-700 rounded bg-white dark:bg-slate-900 text-slate-700 dark:text-slate-200"}),e.jsx("span",{children:"%"})]}),e.jsxs("label",{className:"flex items-center gap-1",children:[e.jsx("span",{children:a("datainspector.cardinality_threshold")}),e.jsx("input",{type:"number",min:0,max:100,value:ke.cardinalityRate,onChange:t=>{const s=Number(t.target.value);Number.isNaN(s)||Kt({...ke,cardinalityRate:Math.max(0,Math.min(100,s))})},className:"w-14 px-1.5 py-0.5 border border-slate-200 dark:border-slate-700 rounded bg-white dark:bg-slate-900 text-slate-700 dark:text-slate-200"}),e.jsx("span",{children:"%"})]}),e.jsx("button",{onClick:()=>Kt({nullRate:30,cardinalityRate:95}),className:"px-2 py-0.5 rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-500 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-700",children:a("datainspector.reset_thresholds")})]})]}),c==="table"&&Z==="data"&&e.jsxs("div",{className:"px-4 py-2 border-b border-slate-100 dark:border-slate-700 bg-white dark:bg-slate-800 flex items-center justify-between gap-3 text-[11px]",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("button",{onClick:()=>ra("columns"),className:"h-7 w-7 inline-flex items-center justify-center rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:a("datainspector.table_tools_tab_columns","Columns"),"aria-label":a("datainspector.table_tools_tab_columns","Columns"),children:e.jsx(sl,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:()=>ra("filters"),className:"h-7 w-7 inline-flex items-center justify-center rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:a("datainspector.table_tools_tab_filters","Filters"),"aria-label":a("datainspector.table_tools_tab_filters","Filters"),children:e.jsx(rl,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:()=>ra("actions"),className:"h-7 w-7 inline-flex items-center justify-center rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:a("datainspector.table_tools_tab_actions","Actions"),"aria-label":a("datainspector.table_tools_tab_actions","Actions"),children:e.jsx(ll,{className:"w-3.5 h-3.5"})}),e.jsxs("button",{onClick:bs,disabled:ee!=="table",className:"h-7 px-2 text-[11px] rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300 disabled:opacity-40 flex items-center gap-1",title:ee!=="table"?a("datasource.view_type","VIEW"):a("datasource.create_index_title","Create index"),children:[e.jsx(nl,{className:"w-3.5 h-3.5"}),a("datasource.create_index_btn","Create index")]})]}),e.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[e.jsx("span",{className:"text-slate-500 dark:text-slate-400 font-semibold uppercase tracking-wider",children:a("datainspector.saved_views","Saved Views")}),e.jsxs("select",{value:ne,onChange:t=>{const s=t.target.value;if(bt(s),!s)return;const r=Yt.find(n=>n.id===s);r&&ur(r)},className:"h-7 px-2 border border-slate-200 dark:border-slate-700 rounded bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-[11px] outline-none min-w-[180px]",children:[e.jsx("option",{value:"",children:a("datainspector.select_view")}),Yt.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx("button",{onClick:xs,className:"h-7 px-2 text-[11px] rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",children:a(ne?"datainspector.update_view":"datainspector.save_view")}),e.jsx("button",{onClick:us,disabled:!ne,className:"h-7 px-2 text-[11px] rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-500 dark:text-slate-300 disabled:opacity-40",children:a("datainspector.delete_view")})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden flex flex-col relative min-h-0",children:c==="sql"&&re==="explain"?Ys?e.jsxs("div",{className:"flex-1 flex items-center justify-center p-6 text-xs text-slate-400 gap-2",children:[e.jsx(Ie,{className:"w-3.5 h-3.5 animate-spin"}),a("common.loading")]}):Aa?e.jsx("div",{className:"flex-1 p-4 text-xs text-rose-600",children:Aa}):Se.length===0?e.jsx("div",{className:"flex-1 p-4 text-xs text-slate-400",children:a("datainspector.explain_empty")}):e.jsx("div",{className:"flex-1 overflow-auto custom-scrollbar",children:e.jsxs("table",{className:"w-full text-xs min-w-[520px]",children:[e.jsx("thead",{className:"sticky top-0 bg-slate-50 dark:bg-slate-900 text-slate-400 uppercase text-[10px] z-[1]",children:e.jsx("tr",{children:Object.keys(Se[0]).map(t=>e.jsx("th",{className:"text-left px-2 py-1.5",children:t},t))})}),e.jsx("tbody",{children:Se.map((t,s)=>e.jsx("tr",{className:"border-t border-slate-100 dark:border-slate-700",children:Object.keys(Se[0]).map(r=>e.jsx("td",{className:"px-2 py-1.5 text-slate-600 dark:text-slate-300",children:String(t[r]??"")},r))},s))})]})}):c==="table"&&Z==="profiling"?Re.length===0?e.jsx("div",{className:"flex-1 p-4 text-xs text-slate-400",children:a("datainspector.no_profile")}):e.jsx("div",{className:"flex-1 overflow-auto custom-scrollbar",children:e.jsxs("table",{className:"w-full text-xs min-w-[760px]",children:[e.jsx("thead",{className:"text-slate-400 uppercase text-[10px] sticky top-0 bg-slate-50 dark:bg-slate-900 z-[1]",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-1.5 px-2",children:a("querybuilder.value")}),e.jsx("th",{className:"text-left py-1.5 px-2",children:a("datainspector.type")}),e.jsx("th",{className:"text-left py-1.5 px-2",children:a("datainspector.distinct_values")}),e.jsx("th",{className:"text-left py-1.5 px-2",children:a("datainspector.null_rate")}),e.jsx("th",{className:"text-left py-1.5 px-2",children:a("datainspector.min")}),e.jsx("th",{className:"text-left py-1.5 px-2",children:a("datainspector.max")}),e.jsx("th",{className:"text-left py-1.5 px-2",children:a("datainspector.top_values")}),e.jsx("th",{className:"text-left py-1.5 px-2",children:a("datainspector.patterns")}),e.jsx("th",{className:"text-left py-1.5 px-2",children:a("datainspector.suspicious_values")}),e.jsx("th",{className:"text-left py-1.5 px-2",children:a("datainspector.issues")})]})}),e.jsx("tbody",{children:Re.map(t=>e.jsxs("tr",{className:"border-t border-slate-100 dark:border-slate-700",children:[e.jsx("td",{className:"py-1.5 px-2 font-semibold text-slate-700 dark:text-slate-200",children:t.key}),e.jsx("td",{className:"py-1.5 px-2 text-slate-600 dark:text-slate-300",children:a(`datainspector.type_${t.detectedType}`)}),e.jsx("td",{className:"py-1.5 px-2 text-slate-600 dark:text-slate-300",children:t.distinctCount}),e.jsxs("td",{className:"py-1.5 px-2 text-slate-600 dark:text-slate-300",children:[t.nullRate.toFixed(1),"%"]}),e.jsx("td",{className:"py-1.5 px-2 text-slate-600 dark:text-slate-300",children:t.min??"-"}),e.jsx("td",{className:"py-1.5 px-2 text-slate-600 dark:text-slate-300",children:t.max??"-"}),e.jsx("td",{className:"py-1.5 px-2 text-slate-600 dark:text-slate-300 truncate max-w-[260px]",title:t.topValues.map(s=>`${s[0]} (${s[1]})`).join(", "),children:t.topValues.length>0?t.topValues.map(s=>`${s[0]} (${s[1]})`).join(", "):"-"}),e.jsx("td",{className:"py-1.5 px-2",children:t.patterns.length>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:t.patterns.map(s=>e.jsx("span",{className:"px-1.5 py-0.5 rounded bg-indigo-50 text-indigo-700 border border-indigo-200 text-[10px] font-semibold",children:a(`datainspector.pattern_${s}`)},s))}):e.jsx("span",{className:"text-slate-400",children:"-"})}),e.jsx("td",{className:"py-1.5 px-2 text-slate-600 dark:text-slate-300",children:t.suspiciousCount}),e.jsx("td",{className:"py-1.5 px-2",children:t.issues.length>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:t.issues.map(s=>e.jsx("span",{className:"px-1.5 py-0.5 rounded bg-amber-50 text-amber-700 border border-amber-200 text-[10px] font-semibold",children:a(`datainspector.issue_${s}`)},s))}):e.jsx("span",{className:"text-slate-400",children:"-"})})]},t.key))})]})}):ve&&!v?e.jsx("div",{className:"flex-1 flex items-center justify-center p-12 text-center text-slate-400 animate-pulse",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(Os,{className:"w-12 h-12 opacity-20"}),e.jsx("p",{className:"text-lg",children:a("common.loading")})]})}):e.jsx(Xr,{data:v||[],columns:gr,searchTerm:"",emptyMessage:a(c==="sql"&&!V?"datainspector.empty_sql":"common.no_data"),onRowClick:t=>Ka(t),sortConfig:c==="table"?$:void 0,onSortConfigChange:c==="table"?Be:void 0,filters:c==="table"?me:void 0,onFiltersChange:c==="table"?Te:void 0,showFilters:c==="table"?Gt:void 0,onShowFiltersChange:c==="table"?le:void 0,columnWidths:c==="table"?lr:void 0,onColumnWidthsChange:c==="table"?nr:void 0})}),e.jsxs("div",{className:"px-4 py-2 border-t border-slate-100 dark:border-slate-700 text-[10px] flex justify-between items-center text-slate-400 bg-slate-50/50 dark:bg-slate-900/50",children:[e.jsx("div",{className:"font-medium",children:c==="table"?Z==="profiling"?a("datainspector.result_tab_profile","Profiling"):e.jsx("select",{value:String(qe),onChange:t=>{Js(Number(t.target.value)),Ee(1)},className:"h-7 px-2 border border-slate-200 dark:border-slate-700 rounded bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-[10px] outline-none",title:a("datainspector.page_size"),children:[50,100,250,500].map(t=>e.jsx("option",{value:t,children:a("datainspector.page_size_value",{size:t})},t))}):re==="explain"?a("datainspector.output_explain","Explain"):a("datainspector.sql_mode")}),e.jsxs("div",{className:"flex items-center gap-4",children:[c==="table"&&Z==="data"&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("button",{onClick:()=>Ee(t=>Math.max(1,t-1)),disabled:He<=1,className:"px-2 py-1 rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-500 dark:text-slate-300 disabled:opacity-40",children:a("datainspector.prev_page")}),e.jsx("span",{className:"text-[10px] font-semibold text-slate-500 dark:text-slate-300",children:a("datainspector.page_info",{page:He,pages:mt,total:ds||0})}),e.jsx("button",{onClick:()=>Ee(t=>t+1),disabled:He>=mt,className:"px-2 py-1 rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-500 dark:text-slate-300 disabled:opacity-40",children:a("datainspector.next_page")}),e.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[e.jsx("input",{type:"number",min:1,max:mt,value:Ja,onChange:t=>Za(t.target.value),placeholder:a("datainspector.page_number_placeholder"),className:"w-16 px-2 py-1 rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 text-[10px] outline-none"}),e.jsx("button",{onClick:()=>{const t=Number(Ja);if(Number.isNaN(t))return;const s=Math.max(1,Math.min(mt,Math.floor(t)));Ee(s),Za("")},className:"px-2 py-1 rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-500 dark:text-slate-300 text-[10px]",children:a("datainspector.go")})]})]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ms,{className:"w-3 h-3"})," LiteBI Studio DB"]}),e.jsx("span",{className:"font-medium",children:a("common.results_count",{count:c==="sql"&&re==="explain"?Se.length:c==="table"&&Z==="profiling"?Re.length:v?.length||0})})]})]})]}),e.jsx(el,{isOpen:!!zt,onClose:()=>Ka(null),items:v||[],initialIndex:v&&zt?Math.max(0,v.indexOf(zt)):0,title:a("common.details"),tableName:c==="table"?i:void 0,schema:void 0}),e.jsx(Hr,{isOpen:Ks,onClose:()=>{ct||dt(!1)},title:a("datasource.create_index_title","Create index"),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-xs text-slate-500",children:[a("datasource.index_create_for_table","Table"),": ",e.jsx("span",{className:"font-mono font-semibold text-slate-700",children:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:a("datasource.index_name","Index name")}),e.jsx("input",{type:"text",value:Da,onChange:t=>Fa(t.target.value),className:"w-full p-2 border border-slate-200 rounded-lg bg-white outline-none focus:ring-2 focus:ring-blue-500 text-sm",placeholder:`idx_${i}_...`})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-slate-600",children:[e.jsx("input",{type:"checkbox",checked:Wt,onChange:()=>Pa(!Wt),className:"h-4 w-4"}),a("datasource.index_unique","Unique index")]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase",children:a("datasource.index_columns","Columns")}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-40 overflow-auto border border-slate-200 rounded p-2 bg-slate-50",children:(D||[]).map(t=>e.jsxs("label",{className:"flex items-center gap-2 text-sm text-slate-700",children:[e.jsx("input",{type:"checkbox",checked:Ce.includes(t.name),onChange:()=>br(t.name),className:"h-4 w-4"}),e.jsx("span",{className:"font-mono",children:t.name})]},t.name))})]}),Ce.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase",children:a("datasource.index_order","Column order")}),e.jsx("div",{className:"space-y-1 border border-slate-200 rounded p-2 bg-white",children:Ce.map((t,s)=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"font-mono text-slate-700",children:[s+1,". ",t]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{type:"button",onClick:()=>ms(t,"up"),disabled:s===0,className:"px-2 py-0.5 text-xs border border-slate-200 rounded disabled:opacity-40",children:""}),e.jsx("button",{type:"button",onClick:()=>ms(t,"down"),disabled:s===Ce.length-1,className:"px-2 py-0.5 text-xs border border-slate-200 rounded disabled:opacity-40",children:""})]})]},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:a("datasource.index_where_optional","WHERE (optional)")}),e.jsx("input",{type:"text",value:Ht,onChange:t=>Ua(t.target.value),className:"w-full p-2 border border-slate-200 rounded-lg bg-white outline-none focus:ring-2 focus:ring-blue-500 text-sm font-mono",placeholder:"status = 'open'"})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2",children:[e.jsx("button",{onClick:()=>dt(!1),disabled:ct,className:"px-3 py-1.5 rounded border border-slate-200 text-slate-600 text-sm hover:bg-slate-50 disabled:opacity-40",children:a("common.cancel","Cancel")}),e.jsx("button",{onClick:()=>{mr()},disabled:ct,className:"px-4 py-1.5 rounded bg-indigo-600 text-white text-sm font-semibold hover:bg-indigo-700 disabled:opacity-40",children:ct?a("common.saving","Saving..."):a("datasource.create_index_btn","Create index")})]})]})}),is&&e.jsxs("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 bg-red-100 dark:bg-red-900/50 border border-red-200 dark:border-red-800 text-red-700 dark:text-red-200 px-4 py-3 rounded-lg shadow-lg flex items-center gap-3 animate-in slide-in-from-bottom-2 fade-in",children:[e.jsx(ol,{className:"w-5 h-5 shrink-0"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-sm font-bold",children:a("datainspector.sql_error")}),e.jsx("p",{className:"text-xs opacity-90",children:String(is)})]}),e.jsx("button",{onClick:H,className:"ml-auto p-1.5 hover:bg-red-200 dark:hover:bg-red-800 rounded-md transition-colors",children:e.jsx(Ie,{className:"w-4 h-4"})})]})]})};export{Tl as DataInspector};
