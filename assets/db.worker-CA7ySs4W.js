(function(){"use strict";async function Ot(Ie={}){var se,c=Ie,pe=!!globalThis.window,Le=!!globalThis.WorkerGlobalScope;globalThis.process?.versions?.node&&globalThis.process?.type;var Ne="./this.program",We=self.location.href,pt="";function St(e){return c.locateFile?c.locateFile(e,pt):pt+e}var Je,it;if(pe||Le){try{pt=new URL(".",We).href}catch{}Le&&(it=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),Je=async e=>{var t=await fetch(e,{credentials:"same-origin"});if(t.ok)return t.arrayBuffer();throw new Error(t.status+" : "+t.url)}}var ge=console.log.bind(console),Ce=console.error.bind(console),Qe,ut=!1,Et,wt,He,st,ht,Oe,Fe,ze,jt=!1;function Mt(){var e=Ze.buffer;He=new Int8Array(e),ht=new Int16Array(e),st=new Uint8Array(e),Oe=new Int32Array(e),Fe=new Uint32Array(e),ze=new BigInt64Array(e),new BigUint64Array(e)}function hn(){if(c.wasmMemory)Ze=c.wasmMemory;else{var e=c.INITIAL_MEMORY||8388608;Ze=new WebAssembly.Memory({initial:e/65536,maximum:32768})}Mt()}function mn(){if(c.preRun)for(typeof c.preRun=="function"&&(c.preRun=[c.preRun]);c.preRun.length;)Tn(c.preRun.shift());zt(Ut)}function gn(){jt=!0,!c.noFSInit&&!l.initialized&&l.init(),dt.__wasm_call_ctors(),l.ignorePermissions=!1}function bn(){if(c.postRun)for(typeof c.postRun=="function"&&(c.postRun=[c.postRun]);c.postRun.length;)An(c.postRun.shift());zt(Bt)}function Xe(e){c.onAbort?.(e),e="Aborted("+e+")",Ce(e),ut=!0,e+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(e);throw wt?.(t),t}var xt;function yn(){return c.locateFile?St("sqlite3.wasm"):new URL("/itdashboard/assets/sqlite3-DGXXSD5r.wasm",self.location.href).href}function qn(e){if(e==xt&&Qe)return new Uint8Array(Qe);if(it)return it(e);throw"both async and sync fetching of the wasm failed"}async function vn(e){if(!Qe)try{var t=await Je(e);return new Uint8Array(t)}catch{}return qn(e)}async function Sn(e,t){try{var o=await vn(e);return await WebAssembly.instantiate(o,t)}catch(s){Ce(`failed to asynchronously prepare wasm: ${s}`),Xe(s)}}async function En(e,t,o){if(!e)try{var s=fetch(t,{credentials:"same-origin"});return await WebAssembly.instantiateStreaming(s,o)}catch(n){Ce(`wasm streaming compile failed: ${n}`),Ce("falling back to ArrayBuffer instantiation")}return Sn(t,o)}function wn(){return{env:nn,wasi_snapshot_preview1:nn}}async function In(){function e(s,n){return dt=s.exports,Or(dt),dt}function t(s){return e(s.instance)}var o=wn();return c.instantiateWasm?new Promise((s,n)=>{c.instantiateWasm(o,(i,r)=>{s(e(i))})}):(xt??=yn(),t(await En(Qe,xt,o)))}var zt=e=>{for(;e.length>0;)e.shift()(c)},Bt=[],An=e=>Bt.push(e),Ut=[],Tn=e=>Ut.push(e),Ze,Pe={isAbs:e=>e.charAt(0)==="/",splitPath:e=>/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1),normalizeArray:(e,t)=>{for(var o=0,s=e.length-1;s>=0;s--){var n=e[s];n==="."?e.splice(s,1):n===".."?(e.splice(s,1),o++):o&&(e.splice(s,1),o--)}if(t)for(;o;o--)e.unshift("..");return e},normalize:e=>{var t=Pe.isAbs(e),o=e.slice(-1)==="/";return e=Pe.normalizeArray(e.split("/").filter(s=>!!s),!t).join("/"),!e&&!t&&(e="."),e&&o&&(e+="/"),(t?"/":"")+e},dirname:e=>{var t=Pe.splitPath(e),o=t[0],s=t[1];return!o&&!s?".":(s&&(s=s.slice(0,-1)),o+s)},basename:e=>e&&e.match(/([^\/]+|\/)\/*$/)[1],join:(...e)=>Pe.normalize(e.join("/")),join2:(e,t)=>Pe.normalize(e+"/"+t)},kn=()=>e=>crypto.getRandomValues(e),Wt=e=>{(Wt=kn())(e)},_t={resolve:(...e)=>{for(var t="",o=!1,s=e.length-1;s>=-1&&!o;s--){var n=s>=0?e[s]:l.cwd();if(typeof n!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!n)return"";t=n+"/"+t,o=Pe.isAbs(n)}return t=Pe.normalizeArray(t.split("/").filter(i=>!!i),!o).join("/"),(o?"/":"")+t||"."},relative:(e,t)=>{e=_t.resolve(e).slice(1),t=_t.resolve(t).slice(1);function o(T){for(var J=0;J<T.length&&T[J]==="";J++);for(var C=T.length-1;C>=0&&T[C]==="";C--);return J>C?[]:T.slice(J,C-J+1)}for(var s=o(e.split("/")),n=o(t.split("/")),i=Math.min(s.length,n.length),r=i,u=0;u<i;u++)if(s[u]!==n[u]){r=u;break}for(var F=[],u=r;u<s.length;u++)F.push("..");return F=F.concat(n.slice(r)),F.join("/")}},Qt=new TextDecoder,Vt=(e,t,o,s)=>{for(var n=t+o;e[t]&&!(t>=n);)++t;return t},mt=(e,t=0,o,s)=>{var n=Vt(e,t,o);return Qt.decode(e.buffer?e.subarray(t,n):new Uint8Array(e.slice(t,n)))},Ft=[],It=e=>{for(var t=0,o=0;o<e.length;++o){var s=e.charCodeAt(o);s<=127?t++:s<=2047?t+=2:s>=55296&&s<=57343?(t+=4,++o):t+=3}return t},Ht=(e,t,o,s)=>{if(!(s>0))return 0;for(var n=o,i=o+s-1,r=0;r<e.length;++r){var u=e.codePointAt(r);if(u<=127){if(o>=i)break;t[o++]=u}else if(u<=2047){if(o+1>=i)break;t[o++]=192|u>>6,t[o++]=128|u&63}else if(u<=65535){if(o+2>=i)break;t[o++]=224|u>>12,t[o++]=128|u>>6&63,t[o++]=128|u&63}else{if(o+3>=i)break;t[o++]=240|u>>18,t[o++]=128|u>>12&63,t[o++]=128|u>>6&63,t[o++]=128|u&63,r++}}return t[o]=0,o-n},Lt=(e,t,o)=>{var s=It(e)+1,n=new Array(s),i=Ht(e,n,0,n.length);return n.length=i,n},On=()=>{if(!Ft.length){var e=null;if(globalThis.window?.prompt&&(e=window.prompt("Input: "),e!==null&&(e+=`
`)),!e)return null;Ft=Lt(e)}return Ft.shift()},ot={ttys:[],init(){},shutdown(){},register(e,t){ot.ttys[e]={input:[],output:[],ops:t},l.registerDevice(e,ot.stream_ops)},stream_ops:{open(e){var t=ot.ttys[e.node.rdev];if(!t)throw new l.ErrnoError(43);e.tty=t,e.seekable=!1},close(e){e.tty.ops.fsync(e.tty)},fsync(e){e.tty.ops.fsync(e.tty)},read(e,t,o,s,n){if(!e.tty||!e.tty.ops.get_char)throw new l.ErrnoError(60);for(var i=0,r=0;r<s;r++){var u;try{u=e.tty.ops.get_char(e.tty)}catch{throw new l.ErrnoError(29)}if(u===void 0&&i===0)throw new l.ErrnoError(6);if(u==null)break;i++,t[o+r]=u}return i&&(e.node.atime=Date.now()),i},write(e,t,o,s,n){if(!e.tty||!e.tty.ops.put_char)throw new l.ErrnoError(60);try{for(var i=0;i<s;i++)e.tty.ops.put_char(e.tty,t[o+i])}catch{throw new l.ErrnoError(29)}return s&&(e.node.mtime=e.node.ctime=Date.now()),i}},default_tty_ops:{get_char(e){return On()},put_char(e,t){t===null||t===10?(ge(mt(e.output)),e.output=[]):t!=0&&e.output.push(t)},fsync(e){e.output?.length>0&&(ge(mt(e.output)),e.output=[])},ioctl_tcgets(e){return{c_iflag:25856,c_oflag:5,c_cflag:191,c_lflag:35387,c_cc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},ioctl_tcsets(e,t,o){return 0},ioctl_tiocgwinsz(e){return[24,80]}},default_tty1_ops:{put_char(e,t){t===null||t===10?(Ce(mt(e.output)),e.output=[]):t!=0&&e.output.push(t)},fsync(e){e.output?.length>0&&(Ce(mt(e.output)),e.output=[])}}},Pn=(e,t)=>st.fill(0,e,e+t),Gt=(e,t)=>Math.ceil(e/t)*t,$t=e=>{e=Gt(e,65536);var t=tn(65536,e);return t&&Pn(t,e),t},ye={ops_table:null,mount(e){return ye.createNode(null,"/",16895,0)},createNode(e,t,o,s){if(l.isBlkdev(o)||l.isFIFO(o))throw new l.ErrnoError(63);ye.ops_table||={dir:{node:{getattr:ye.node_ops.getattr,setattr:ye.node_ops.setattr,lookup:ye.node_ops.lookup,mknod:ye.node_ops.mknod,rename:ye.node_ops.rename,unlink:ye.node_ops.unlink,rmdir:ye.node_ops.rmdir,readdir:ye.node_ops.readdir,symlink:ye.node_ops.symlink},stream:{llseek:ye.stream_ops.llseek}},file:{node:{getattr:ye.node_ops.getattr,setattr:ye.node_ops.setattr},stream:{llseek:ye.stream_ops.llseek,read:ye.stream_ops.read,write:ye.stream_ops.write,mmap:ye.stream_ops.mmap,msync:ye.stream_ops.msync}},link:{node:{getattr:ye.node_ops.getattr,setattr:ye.node_ops.setattr,readlink:ye.node_ops.readlink},stream:{}},chrdev:{node:{getattr:ye.node_ops.getattr,setattr:ye.node_ops.setattr},stream:l.chrdev_stream_ops}};var n=l.createNode(e,t,o,s);return l.isDir(n.mode)?(n.node_ops=ye.ops_table.dir.node,n.stream_ops=ye.ops_table.dir.stream,n.contents={}):l.isFile(n.mode)?(n.node_ops=ye.ops_table.file.node,n.stream_ops=ye.ops_table.file.stream,n.usedBytes=0,n.contents=null):l.isLink(n.mode)?(n.node_ops=ye.ops_table.link.node,n.stream_ops=ye.ops_table.link.stream):l.isChrdev(n.mode)&&(n.node_ops=ye.ops_table.chrdev.node,n.stream_ops=ye.ops_table.chrdev.stream),n.atime=n.mtime=n.ctime=Date.now(),e&&(e.contents[t]=n,e.atime=e.mtime=e.ctime=n.atime),n},getFileDataAsTypedArray(e){return e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array(0)},expandFileStorage(e,t){var o=e.contents?e.contents.length:0;if(!(o>=t)){t=Math.max(t,o*(o<1024*1024?2:1.125)>>>0),o!=0&&(t=Math.max(t,256));var s=e.contents;e.contents=new Uint8Array(t),e.usedBytes>0&&e.contents.set(s.subarray(0,e.usedBytes),0)}},resizeFileStorage(e,t){if(e.usedBytes!=t)if(t==0)e.contents=null,e.usedBytes=0;else{var o=e.contents;e.contents=new Uint8Array(t),o&&e.contents.set(o.subarray(0,Math.min(t,e.usedBytes))),e.usedBytes=t}},node_ops:{getattr(e){var t={};return t.dev=l.isChrdev(e.mode)?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,l.isDir(e.mode)?t.size=4096:l.isFile(e.mode)?t.size=e.usedBytes:l.isLink(e.mode)?t.size=e.link.length:t.size=0,t.atime=new Date(e.atime),t.mtime=new Date(e.mtime),t.ctime=new Date(e.ctime),t.blksize=4096,t.blocks=Math.ceil(t.size/t.blksize),t},setattr(e,t){for(const o of["mode","atime","mtime","ctime"])t[o]!=null&&(e[o]=t[o]);t.size!==void 0&&ye.resizeFileStorage(e,t.size)},lookup(e,t){throw ye.doesNotExistError||(ye.doesNotExistError=new l.ErrnoError(44),ye.doesNotExistError.stack="<generic error, no stack>"),ye.doesNotExistError},mknod(e,t,o,s){return ye.createNode(e,t,o,s)},rename(e,t,o){var s;try{s=l.lookupNode(t,o)}catch{}if(s){if(l.isDir(e.mode))for(var n in s.contents)throw new l.ErrnoError(55);l.hashRemoveNode(s)}delete e.parent.contents[e.name],t.contents[o]=e,e.name=o,t.ctime=t.mtime=e.parent.ctime=e.parent.mtime=Date.now()},unlink(e,t){delete e.contents[t],e.ctime=e.mtime=Date.now()},rmdir(e,t){for(var o in l.lookupNode(e,t).contents)throw new l.ErrnoError(55);delete e.contents[t],e.ctime=e.mtime=Date.now()},readdir(e){return[".","..",...Object.keys(e.contents)]},symlink(e,t,o){var s=ye.createNode(e,t,41471,0);return s.link=o,s},readlink(e){if(!l.isLink(e.mode))throw new l.ErrnoError(28);return e.link}},stream_ops:{read(e,t,o,s,n){var i=e.node.contents;if(n>=e.node.usedBytes)return 0;var r=Math.min(e.node.usedBytes-n,s);if(r>8&&i.subarray)t.set(i.subarray(n,n+r),o);else for(var u=0;u<r;u++)t[o+u]=i[n+u];return r},write(e,t,o,s,n,i){if(t.buffer===He.buffer&&(i=!1),!s)return 0;var r=e.node;if(r.mtime=r.ctime=Date.now(),t.subarray&&(!r.contents||r.contents.subarray)){if(i)return r.contents=t.subarray(o,o+s),r.usedBytes=s,s;if(r.usedBytes===0&&n===0)return r.contents=t.slice(o,o+s),r.usedBytes=s,s;if(n+s<=r.usedBytes)return r.contents.set(t.subarray(o,o+s),n),s}if(ye.expandFileStorage(r,n+s),r.contents.subarray&&t.subarray)r.contents.set(t.subarray(o,o+s),n);else for(var u=0;u<s;u++)r.contents[n+u]=t[o+u];return r.usedBytes=Math.max(r.usedBytes,n+s),s},llseek(e,t,o){var s=t;if(o===1?s+=e.position:o===2&&l.isFile(e.node.mode)&&(s+=e.node.usedBytes),s<0)throw new l.ErrnoError(28);return s},mmap(e,t,o,s,n){if(!l.isFile(e.node.mode))throw new l.ErrnoError(43);var i,r,u=e.node.contents;if(!(n&2)&&u&&u.buffer===He.buffer)r=!1,i=u.byteOffset;else{if(r=!0,i=$t(t),!i)throw new l.ErrnoError(48);u&&((o>0||o+t<u.length)&&(u.subarray?u=u.subarray(o,o+t):u=Array.prototype.slice.call(u,o,o+t)),He.set(u,i))}return{ptr:i,allocated:r}},msync(e,t,o,s,n){return ye.stream_ops.write(e,t,0,s,o,!1),0}}},xn=e=>{var t={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[e];if(typeof t>"u")throw new Error(`Unknown file open mode: ${e}`);return t},Ct=(e,t)=>{var o=0;return e&&(o|=365),t&&(o|=146),o},Fn=async e=>{var t=await Je(e);return new Uint8Array(t)},Ln=(...e)=>l.createDataFile(...e),at=0,gt=null,Cn=e=>{if(at--,c.monitorRunDependencies?.(at),at==0&&gt){var t=gt;gt=null,t()}},Nn=e=>{at++,c.monitorRunDependencies?.(at)},Kt=[],Rn=async(e,t)=>{typeof Browser<"u"&&Browser.init();for(var o of Kt)if(o.canHandle(t))return o.handle(e,t);return e},Jt=async(e,t,o,s,n,i,r,u)=>{var F=t?_t.resolve(Pe.join2(e,t)):e;Nn();try{var T=o;typeof o=="string"&&(T=await Fn(o)),T=await Rn(T,F),u?.(),i||Ln(e,t,T,s,n,r)}finally{Cn()}},Dn=(e,t,o,s,n,i,r,u,F,T)=>{Jt(e,t,o,s,n,u,F,T).then(i).catch(r)},l={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,filesystems:null,syncFSRequests:0,readFiles:{},ErrnoError:class{name="ErrnoError";constructor(e){this.errno=e}},FSStream:class{shared={};get object(){return this.node}set object(e){this.node=e}get isRead(){return(this.flags&2097155)!==1}get isWrite(){return(this.flags&2097155)!==0}get isAppend(){return this.flags&1024}get flags(){return this.shared.flags}set flags(e){this.shared.flags=e}get position(){return this.shared.position}set position(e){this.shared.position=e}},FSNode:class{node_ops={};stream_ops={};readMode=365;writeMode=146;mounted=null;constructor(e,t,o,s){e||(e=this),this.parent=e,this.mount=e.mount,this.id=l.nextInode++,this.name=t,this.mode=o,this.rdev=s,this.atime=this.mtime=this.ctime=Date.now()}get read(){return(this.mode&this.readMode)===this.readMode}set read(e){e?this.mode|=this.readMode:this.mode&=~this.readMode}get write(){return(this.mode&this.writeMode)===this.writeMode}set write(e){e?this.mode|=this.writeMode:this.mode&=~this.writeMode}get isFolder(){return l.isDir(this.mode)}get isDevice(){return l.isChrdev(this.mode)}},lookupPath(e,t={}){if(!e)throw new l.ErrnoError(44);t.follow_mount??=!0,Pe.isAbs(e)||(e=l.cwd()+"/"+e);e:for(var o=0;o<40;o++){for(var s=e.split("/").filter(T=>!!T),n=l.root,i="/",r=0;r<s.length;r++){var u=r===s.length-1;if(u&&t.parent)break;if(s[r]!=="."){if(s[r]===".."){if(i=Pe.dirname(i),l.isRoot(n)){e=i+"/"+s.slice(r+1).join("/"),o--;continue e}else n=n.parent;continue}i=Pe.join2(i,s[r]);try{n=l.lookupNode(n,s[r])}catch(T){if(T?.errno===44&&u&&t.noent_okay)return{path:i};throw T}if(l.isMountpoint(n)&&(!u||t.follow_mount)&&(n=n.mounted.root),l.isLink(n.mode)&&(!u||t.follow)){if(!n.node_ops.readlink)throw new l.ErrnoError(52);var F=n.node_ops.readlink(n);Pe.isAbs(F)||(F=Pe.dirname(i)+"/"+F),e=F+"/"+s.slice(r+1).join("/");continue e}}}return{path:i,node:n}}throw new l.ErrnoError(32)},getPath(e){for(var t;;){if(l.isRoot(e)){var o=e.mount.mountpoint;return t?o[o.length-1]!=="/"?`${o}/${t}`:o+t:o}t=t?`${e.name}/${t}`:e.name,e=e.parent}},hashName(e,t){for(var o=0,s=0;s<t.length;s++)o=(o<<5)-o+t.charCodeAt(s)|0;return(e+o>>>0)%l.nameTable.length},hashAddNode(e){var t=l.hashName(e.parent.id,e.name);e.name_next=l.nameTable[t],l.nameTable[t]=e},hashRemoveNode(e){var t=l.hashName(e.parent.id,e.name);if(l.nameTable[t]===e)l.nameTable[t]=e.name_next;else for(var o=l.nameTable[t];o;){if(o.name_next===e){o.name_next=e.name_next;break}o=o.name_next}},lookupNode(e,t){var o=l.mayLookup(e);if(o)throw new l.ErrnoError(o);for(var s=l.hashName(e.id,t),n=l.nameTable[s];n;n=n.name_next){var i=n.name;if(n.parent.id===e.id&&i===t)return n}return l.lookup(e,t)},createNode(e,t,o,s){var n=new l.FSNode(e,t,o,s);return l.hashAddNode(n),n},destroyNode(e){l.hashRemoveNode(e)},isRoot(e){return e===e.parent},isMountpoint(e){return!!e.mounted},isFile(e){return(e&61440)===32768},isDir(e){return(e&61440)===16384},isLink(e){return(e&61440)===40960},isChrdev(e){return(e&61440)===8192},isBlkdev(e){return(e&61440)===24576},isFIFO(e){return(e&61440)===4096},isSocket(e){return(e&49152)===49152},flagsToPermissionString(e){var t=["r","w","rw"][e&3];return e&512&&(t+="w"),t},nodePermissions(e,t){return l.ignorePermissions?0:t.includes("r")&&!(e.mode&292)||t.includes("w")&&!(e.mode&146)||t.includes("x")&&!(e.mode&73)?2:0},mayLookup(e){if(!l.isDir(e.mode))return 54;var t=l.nodePermissions(e,"x");return t||(e.node_ops.lookup?0:2)},mayCreate(e,t){if(!l.isDir(e.mode))return 54;try{return l.lookupNode(e,t),20}catch{}return l.nodePermissions(e,"wx")},mayDelete(e,t,o){var s;try{s=l.lookupNode(e,t)}catch(i){return i.errno}var n=l.nodePermissions(e,"wx");if(n)return n;if(o){if(!l.isDir(s.mode))return 54;if(l.isRoot(s)||l.getPath(s)===l.cwd())return 10}else if(l.isDir(s.mode))return 31;return 0},mayOpen(e,t){return e?l.isLink(e.mode)?32:l.isDir(e.mode)&&(l.flagsToPermissionString(t)!=="r"||t&576)?31:l.nodePermissions(e,l.flagsToPermissionString(t)):44},checkOpExists(e,t){if(!e)throw new l.ErrnoError(t);return e},MAX_OPEN_FDS:4096,nextfd(){for(var e=0;e<=l.MAX_OPEN_FDS;e++)if(!l.streams[e])return e;throw new l.ErrnoError(33)},getStreamChecked(e){var t=l.getStream(e);if(!t)throw new l.ErrnoError(8);return t},getStream:e=>l.streams[e],createStream(e,t=-1){return e=Object.assign(new l.FSStream,e),t==-1&&(t=l.nextfd()),e.fd=t,l.streams[t]=e,e},closeStream(e){l.streams[e]=null},dupStream(e,t=-1){var o=l.createStream(e,t);return o.stream_ops?.dup?.(o),o},doSetAttr(e,t,o){var s=e?.stream_ops.setattr,n=s?e:t;s??=t.node_ops.setattr,l.checkOpExists(s,63),s(n,o)},chrdev_stream_ops:{open(e){e.stream_ops=l.getDevice(e.node.rdev).stream_ops,e.stream_ops.open?.(e)},llseek(){throw new l.ErrnoError(70)}},major:e=>e>>8,minor:e=>e&255,makedev:(e,t)=>e<<8|t,registerDevice(e,t){l.devices[e]={stream_ops:t}},getDevice:e=>l.devices[e],getMounts(e){for(var t=[],o=[e];o.length;){var s=o.pop();t.push(s),o.push(...s.mounts)}return t},syncfs(e,t){typeof e=="function"&&(t=e,e=!1),l.syncFSRequests++,l.syncFSRequests>1&&Ce(`warning: ${l.syncFSRequests} FS.syncfs operations in flight at once, probably just doing extra work`);var o=l.getMounts(l.root.mount),s=0;function n(u){return l.syncFSRequests--,t(u)}function i(u){if(u)return i.errored?void 0:(i.errored=!0,n(u));++s>=o.length&&n(null)}for(var r of o)r.type.syncfs?r.type.syncfs(r,e,i):i(null)},mount(e,t,o){var s=o==="/",n=!o,i;if(s&&l.root)throw new l.ErrnoError(10);if(!s&&!n){var r=l.lookupPath(o,{follow_mount:!1});if(o=r.path,i=r.node,l.isMountpoint(i))throw new l.ErrnoError(10);if(!l.isDir(i.mode))throw new l.ErrnoError(54)}var u={type:e,opts:t,mountpoint:o,mounts:[]},F=e.mount(u);return F.mount=u,u.root=F,s?l.root=F:i&&(i.mounted=u,i.mount&&i.mount.mounts.push(u)),F},unmount(e){var t=l.lookupPath(e,{follow_mount:!1});if(!l.isMountpoint(t.node))throw new l.ErrnoError(28);var o=t.node,s=o.mounted,n=l.getMounts(s);for(var[i,r]of Object.entries(l.nameTable))for(;r;){var u=r.name_next;n.includes(r.mount)&&l.destroyNode(r),r=u}o.mounted=null;var F=o.mount.mounts.indexOf(s);o.mount.mounts.splice(F,1)},lookup(e,t){return e.node_ops.lookup(e,t)},mknod(e,t,o){var s=l.lookupPath(e,{parent:!0}).node,n=Pe.basename(e);if(!n)throw new l.ErrnoError(28);if(n==="."||n==="..")throw new l.ErrnoError(20);var i=l.mayCreate(s,n);if(i)throw new l.ErrnoError(i);if(!s.node_ops.mknod)throw new l.ErrnoError(63);return s.node_ops.mknod(s,n,t,o)},statfs(e){return l.statfsNode(l.lookupPath(e,{follow:!0}).node)},statfsStream(e){return l.statfsNode(e.node)},statfsNode(e){var t={bsize:4096,frsize:4096,blocks:1e6,bfree:5e5,bavail:5e5,files:l.nextInode,ffree:l.nextInode-1,fsid:42,flags:2,namelen:255};return e.node_ops.statfs&&Object.assign(t,e.node_ops.statfs(e.mount.opts.root)),t},create(e,t=438){return t&=4095,t|=32768,l.mknod(e,t,0)},mkdir(e,t=511){return t&=1023,t|=16384,l.mknod(e,t,0)},mkdirTree(e,t){var o=e.split("/"),s="";for(var n of o)if(n){(s||Pe.isAbs(e))&&(s+="/"),s+=n;try{l.mkdir(s,t)}catch(i){if(i.errno!=20)throw i}}},mkdev(e,t,o){return typeof o>"u"&&(o=t,t=438),t|=8192,l.mknod(e,t,o)},symlink(e,t){if(!_t.resolve(e))throw new l.ErrnoError(44);var o=l.lookupPath(t,{parent:!0}).node;if(!o)throw new l.ErrnoError(44);var s=Pe.basename(t),n=l.mayCreate(o,s);if(n)throw new l.ErrnoError(n);if(!o.node_ops.symlink)throw new l.ErrnoError(63);return o.node_ops.symlink(o,s,e)},rename(e,t){var o=Pe.dirname(e),s=Pe.dirname(t),n=Pe.basename(e),i=Pe.basename(t),r=l.lookupPath(e,{parent:!0}),u=r.node,F;if(r=l.lookupPath(t,{parent:!0}),F=r.node,!u||!F)throw new l.ErrnoError(44);if(u.mount!==F.mount)throw new l.ErrnoError(75);var T=l.lookupNode(u,n),J=_t.relative(e,s);if(J.charAt(0)!==".")throw new l.ErrnoError(28);if(J=_t.relative(t,o),J.charAt(0)!==".")throw new l.ErrnoError(55);var C;try{C=l.lookupNode(F,i)}catch{}if(T!==C){var G=l.isDir(T.mode),p=l.mayDelete(u,n,G);if(p)throw new l.ErrnoError(p);if(p=C?l.mayDelete(F,i,G):l.mayCreate(F,i),p)throw new l.ErrnoError(p);if(!u.node_ops.rename)throw new l.ErrnoError(63);if(l.isMountpoint(T)||C&&l.isMountpoint(C))throw new l.ErrnoError(10);if(F!==u&&(p=l.nodePermissions(u,"w"),p))throw new l.ErrnoError(p);l.hashRemoveNode(T);try{u.node_ops.rename(T,F,i),T.parent=F}catch(z){throw z}finally{l.hashAddNode(T)}}},rmdir(e){var t=l.lookupPath(e,{parent:!0}).node,o=Pe.basename(e),s=l.lookupNode(t,o),n=l.mayDelete(t,o,!0);if(n)throw new l.ErrnoError(n);if(!t.node_ops.rmdir)throw new l.ErrnoError(63);if(l.isMountpoint(s))throw new l.ErrnoError(10);t.node_ops.rmdir(t,o),l.destroyNode(s)},readdir(e){var t=l.lookupPath(e,{follow:!0}).node;return l.checkOpExists(t.node_ops.readdir,54)(t)},unlink(e){var t=l.lookupPath(e,{parent:!0}).node;if(!t)throw new l.ErrnoError(44);var o=Pe.basename(e),s=l.lookupNode(t,o),n=l.mayDelete(t,o,!1);if(n)throw new l.ErrnoError(n);if(!t.node_ops.unlink)throw new l.ErrnoError(63);if(l.isMountpoint(s))throw new l.ErrnoError(10);t.node_ops.unlink(t,o),l.destroyNode(s)},readlink(e){var t=l.lookupPath(e).node;if(!t)throw new l.ErrnoError(44);if(!t.node_ops.readlink)throw new l.ErrnoError(28);return t.node_ops.readlink(t)},stat(e,t){var o=l.lookupPath(e,{follow:!t}).node;return l.checkOpExists(o.node_ops.getattr,63)(o)},fstat(e){var t=l.getStreamChecked(e),o=t.node,s=t.stream_ops.getattr,n=s?t:o;return s??=o.node_ops.getattr,l.checkOpExists(s,63),s(n)},lstat(e){return l.stat(e,!0)},doChmod(e,t,o,s){l.doSetAttr(e,t,{mode:o&4095|t.mode&-4096,ctime:Date.now(),dontFollow:s})},chmod(e,t,o){var s;typeof e=="string"?s=l.lookupPath(e,{follow:!o}).node:s=e,l.doChmod(null,s,t,o)},lchmod(e,t){l.chmod(e,t,!0)},fchmod(e,t){var o=l.getStreamChecked(e);l.doChmod(o,o.node,t,!1)},doChown(e,t,o){l.doSetAttr(e,t,{timestamp:Date.now(),dontFollow:o})},chown(e,t,o,s){var n;typeof e=="string"?n=l.lookupPath(e,{follow:!s}).node:n=e,l.doChown(null,n,s)},lchown(e,t,o){l.chown(e,t,o,!0)},fchown(e,t,o){var s=l.getStreamChecked(e);l.doChown(s,s.node,!1)},doTruncate(e,t,o){if(l.isDir(t.mode))throw new l.ErrnoError(31);if(!l.isFile(t.mode))throw new l.ErrnoError(28);var s=l.nodePermissions(t,"w");if(s)throw new l.ErrnoError(s);l.doSetAttr(e,t,{size:o,timestamp:Date.now()})},truncate(e,t){if(t<0)throw new l.ErrnoError(28);var o;typeof e=="string"?o=l.lookupPath(e,{follow:!0}).node:o=e,l.doTruncate(null,o,t)},ftruncate(e,t){var o=l.getStreamChecked(e);if(t<0||(o.flags&2097155)===0)throw new l.ErrnoError(28);l.doTruncate(o,o.node,t)},utime(e,t,o){var s=l.lookupPath(e,{follow:!0}).node;l.checkOpExists(s.node_ops.setattr,63)(s,{atime:t,mtime:o})},open(e,t,o=438){if(e==="")throw new l.ErrnoError(44);t=typeof t=="string"?xn(t):t,t&64?o=o&4095|32768:o=0;var s,n;if(typeof e=="object")s=e;else{n=e.endsWith("/");var i=l.lookupPath(e,{follow:!(t&131072),noent_okay:!0});s=i.node,e=i.path}var r=!1;if(t&64)if(s){if(t&128)throw new l.ErrnoError(20)}else{if(n)throw new l.ErrnoError(31);s=l.mknod(e,o|511,0),r=!0}if(!s)throw new l.ErrnoError(44);if(l.isChrdev(s.mode)&&(t&=-513),t&65536&&!l.isDir(s.mode))throw new l.ErrnoError(54);if(!r){var u=l.mayOpen(s,t);if(u)throw new l.ErrnoError(u)}t&512&&!r&&l.truncate(s,0),t&=-131713;var F=l.createStream({node:s,path:l.getPath(s),flags:t,seekable:!0,position:0,stream_ops:s.stream_ops,ungotten:[],error:!1});return F.stream_ops.open&&F.stream_ops.open(F),r&&l.chmod(s,o&511),c.logReadFiles&&!(t&1)&&(e in l.readFiles||(l.readFiles[e]=1)),F},close(e){if(l.isClosed(e))throw new l.ErrnoError(8);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(t){throw t}finally{l.closeStream(e.fd)}e.fd=null},isClosed(e){return e.fd===null},llseek(e,t,o){if(l.isClosed(e))throw new l.ErrnoError(8);if(!e.seekable||!e.stream_ops.llseek)throw new l.ErrnoError(70);if(o!=0&&o!=1&&o!=2)throw new l.ErrnoError(28);return e.position=e.stream_ops.llseek(e,t,o),e.ungotten=[],e.position},read(e,t,o,s,n){if(s<0||n<0)throw new l.ErrnoError(28);if(l.isClosed(e))throw new l.ErrnoError(8);if((e.flags&2097155)===1)throw new l.ErrnoError(8);if(l.isDir(e.node.mode))throw new l.ErrnoError(31);if(!e.stream_ops.read)throw new l.ErrnoError(28);var i=typeof n<"u";if(!i)n=e.position;else if(!e.seekable)throw new l.ErrnoError(70);var r=e.stream_ops.read(e,t,o,s,n);return i||(e.position+=r),r},write(e,t,o,s,n,i){if(s<0||n<0)throw new l.ErrnoError(28);if(l.isClosed(e))throw new l.ErrnoError(8);if((e.flags&2097155)===0)throw new l.ErrnoError(8);if(l.isDir(e.node.mode))throw new l.ErrnoError(31);if(!e.stream_ops.write)throw new l.ErrnoError(28);e.seekable&&e.flags&1024&&l.llseek(e,0,2);var r=typeof n<"u";if(!r)n=e.position;else if(!e.seekable)throw new l.ErrnoError(70);var u=e.stream_ops.write(e,t,o,s,n,i);return r||(e.position+=u),u},mmap(e,t,o,s,n){if((s&2)!==0&&(n&2)===0&&(e.flags&2097155)!==2)throw new l.ErrnoError(2);if((e.flags&2097155)===1)throw new l.ErrnoError(2);if(!e.stream_ops.mmap)throw new l.ErrnoError(43);if(!t)throw new l.ErrnoError(28);return e.stream_ops.mmap(e,t,o,s,n)},msync(e,t,o,s,n){return e.stream_ops.msync?e.stream_ops.msync(e,t,o,s,n):0},ioctl(e,t,o){if(!e.stream_ops.ioctl)throw new l.ErrnoError(59);return e.stream_ops.ioctl(e,t,o)},readFile(e,t={}){t.flags=t.flags||0,t.encoding=t.encoding||"binary",t.encoding!=="utf8"&&t.encoding!=="binary"&&Xe(`Invalid encoding type "${t.encoding}"`);var o=l.open(e,t.flags),s=l.stat(e).size,n=new Uint8Array(s);return l.read(o,n,0,s,0),t.encoding==="utf8"&&(n=mt(n)),l.close(o),n},writeFile(e,t,o={}){o.flags=o.flags||577;var s=l.open(e,o.flags,o.mode);typeof t=="string"&&(t=new Uint8Array(Lt(t))),ArrayBuffer.isView(t)?l.write(s,t,0,t.byteLength,void 0,o.canOwn):Xe("Unsupported data type"),l.close(s)},cwd:()=>l.currentPath,chdir(e){var t=l.lookupPath(e,{follow:!0});if(t.node===null)throw new l.ErrnoError(44);if(!l.isDir(t.node.mode))throw new l.ErrnoError(54);var o=l.nodePermissions(t.node,"x");if(o)throw new l.ErrnoError(o);l.currentPath=t.path},createDefaultDirectories(){l.mkdir("/tmp"),l.mkdir("/home"),l.mkdir("/home/web_user")},createDefaultDevices(){l.mkdir("/dev"),l.registerDevice(l.makedev(1,3),{read:()=>0,write:(s,n,i,r,u)=>r,llseek:()=>0}),l.mkdev("/dev/null",l.makedev(1,3)),ot.register(l.makedev(5,0),ot.default_tty_ops),ot.register(l.makedev(6,0),ot.default_tty1_ops),l.mkdev("/dev/tty",l.makedev(5,0)),l.mkdev("/dev/tty1",l.makedev(6,0));var e=new Uint8Array(1024),t=0,o=()=>(t===0&&(Wt(e),t=e.byteLength),e[--t]);l.createDevice("/dev","random",o),l.createDevice("/dev","urandom",o),l.mkdir("/dev/shm"),l.mkdir("/dev/shm/tmp")},createSpecialDirectories(){l.mkdir("/proc");var e=l.mkdir("/proc/self");l.mkdir("/proc/self/fd"),l.mount({mount(){var t=l.createNode(e,"fd",16895,73);return t.stream_ops={llseek:ye.stream_ops.llseek},t.node_ops={lookup(o,s){var n=+s,i=l.getStreamChecked(n),r={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>i.path},id:n+1};return r.parent=r,r},readdir(){return Array.from(l.streams.entries()).filter(([o,s])=>s).map(([o,s])=>o.toString())}},t}},{},"/proc/self/fd")},createStandardStreams(e,t,o){e?l.createDevice("/dev","stdin",e):l.symlink("/dev/tty","/dev/stdin"),t?l.createDevice("/dev","stdout",null,t):l.symlink("/dev/tty","/dev/stdout"),o?l.createDevice("/dev","stderr",null,o):l.symlink("/dev/tty1","/dev/stderr"),l.open("/dev/stdin",0),l.open("/dev/stdout",1),l.open("/dev/stderr",1)},staticInit(){l.nameTable=new Array(4096),l.mount(ye,{},"/"),l.createDefaultDirectories(),l.createDefaultDevices(),l.createSpecialDirectories(),l.filesystems={MEMFS:ye}},init(e,t,o){l.initialized=!0,e??=c.stdin,t??=c.stdout,o??=c.stderr,l.createStandardStreams(e,t,o)},quit(){l.initialized=!1;for(var e of l.streams)e&&l.close(e)},findObject(e,t){var o=l.analyzePath(e,t);return o.exists?o.object:null},analyzePath(e,t){try{var o=l.lookupPath(e,{follow:!t});e=o.path}catch{}var s={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var o=l.lookupPath(e,{parent:!0});s.parentExists=!0,s.parentPath=o.path,s.parentObject=o.node,s.name=Pe.basename(e),o=l.lookupPath(e,{follow:!t}),s.exists=!0,s.path=o.path,s.object=o.node,s.name=o.node.name,s.isRoot=o.path==="/"}catch(n){s.error=n.errno}return s},createPath(e,t,o,s){e=typeof e=="string"?e:l.getPath(e);for(var n=t.split("/").reverse();n.length;){var i=n.pop();if(i){var r=Pe.join2(e,i);try{l.mkdir(r)}catch(u){if(u.errno!=20)throw u}e=r}}return r},createFile(e,t,o,s,n){var i=Pe.join2(typeof e=="string"?e:l.getPath(e),t),r=Ct(s,n);return l.create(i,r)},createDataFile(e,t,o,s,n,i){var r=t;e&&(e=typeof e=="string"?e:l.getPath(e),r=t?Pe.join2(e,t):e);var u=Ct(s,n),F=l.create(r,u);if(o){if(typeof o=="string"){for(var T=new Array(o.length),J=0,C=o.length;J<C;++J)T[J]=o.charCodeAt(J);o=T}l.chmod(F,u|146);var G=l.open(F,577);l.write(G,o,0,o.length,0,i),l.close(G),l.chmod(F,u)}},createDevice(e,t,o,s){var n=Pe.join2(typeof e=="string"?e:l.getPath(e),t),i=Ct(!!o,!!s);l.createDevice.major??=64;var r=l.makedev(l.createDevice.major++,0);return l.registerDevice(r,{open(u){u.seekable=!1},close(u){s?.buffer?.length&&s(10)},read(u,F,T,J,C){for(var G=0,p=0;p<J;p++){var z;try{z=o()}catch{throw new l.ErrnoError(29)}if(z===void 0&&G===0)throw new l.ErrnoError(6);if(z==null)break;G++,F[T+p]=z}return G&&(u.node.atime=Date.now()),G},write(u,F,T,J,C){for(var G=0;G<J;G++)try{s(F[T+G])}catch{throw new l.ErrnoError(29)}return J&&(u.node.mtime=u.node.ctime=Date.now()),G}}),l.mkdev(n,i,r)},forceLoadFile(e){if(e.isDevice||e.isFolder||e.link||e.contents)return!0;if(globalThis.XMLHttpRequest)Xe("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");else try{e.contents=it(e.url)}catch{throw new l.ErrnoError(29)}},createLazyFile(e,t,o,s,n){class i{lengthKnown=!1;chunks=[];get(C){if(!(C>this.length-1||C<0)){var G=C%this.chunkSize,p=C/this.chunkSize|0;return this.getter(p)[G]}}setDataGetter(C){this.getter=C}cacheLength(){var C=new XMLHttpRequest;C.open("HEAD",o,!1),C.send(null),C.status>=200&&C.status<300||C.status===304||Xe("Couldn't load "+o+". Status: "+C.status);var G=Number(C.getResponseHeader("Content-length")),p,z=(p=C.getResponseHeader("Accept-Ranges"))&&p==="bytes",N=(p=C.getResponseHeader("Content-Encoding"))&&p==="gzip",te=1024*1024;z||(te=G);var y=(R,U)=>{R>U&&Xe("invalid range ("+R+", "+U+") or no bytes requested!"),U>G-1&&Xe("only "+G+" bytes available! programmer error!");var w=new XMLHttpRequest;return w.open("GET",o,!1),G!==te&&w.setRequestHeader("Range","bytes="+R+"-"+U),w.responseType="arraybuffer",w.overrideMimeType&&w.overrideMimeType("text/plain; charset=x-user-defined"),w.send(null),w.status>=200&&w.status<300||w.status===304||Xe("Couldn't load "+o+". Status: "+w.status),w.response!==void 0?new Uint8Array(w.response||[]):Lt(w.responseText||"")},b=this;b.setDataGetter(R=>{var U=R*te,w=(R+1)*te-1;return w=Math.min(w,G-1),typeof b.chunks[R]>"u"&&(b.chunks[R]=y(U,w)),typeof b.chunks[R]>"u"&&Xe("doXHR failed!"),b.chunks[R]}),(N||!G)&&(te=G=1,G=this.getter(0).length,te=G,ge("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=G,this._chunkSize=te,this.lengthKnown=!0}get length(){return this.lengthKnown||this.cacheLength(),this._length}get chunkSize(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}if(globalThis.XMLHttpRequest){Le||Xe("Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc");var r={isDevice:!1,contents:new i}}else var r={isDevice:!1,url:o};var u=l.createFile(e,t,r,s,n);r.contents?u.contents=r.contents:r.url&&(u.contents=null,u.url=r.url),Object.defineProperties(u,{usedBytes:{get:function(){return this.contents.length}}});var F={};for(const[J,C]of Object.entries(u.stream_ops))F[J]=(...G)=>(l.forceLoadFile(u),C(...G));function T(J,C,G,p,z){var N=J.node.contents;if(z>=N.length)return 0;var te=Math.min(N.length-z,p);if(N.slice)for(var y=0;y<te;y++)C[G+y]=N[z+y];else for(var y=0;y<te;y++)C[G+y]=N.get(z+y);return te}return F.read=(J,C,G,p,z)=>(l.forceLoadFile(u),T(J,C,G,p,z)),F.mmap=(J,C,G,p,z)=>{l.forceLoadFile(u);var N=$t(C);if(!N)throw new l.ErrnoError(48);return T(J,He,N,C,G),{ptr:N,allocated:!0}},u.stream_ops=F,u}},jn=(e,t,o)=>{if(!e)return"";var s=Vt(st,e,t);return Qt.decode(st.subarray(e,s))},we={calculateAt(e,t,o){if(Pe.isAbs(t))return t;var s;if(e===-100?s=l.cwd():s=we.getStreamFromFD(e).path,t.length==0){if(!o)throw new l.ErrnoError(44);return s}return s+"/"+t},writeStat(e,t){Fe[e>>2]=t.dev,Fe[e+4>>2]=t.mode,Fe[e+8>>2]=t.nlink,Fe[e+12>>2]=t.uid,Fe[e+16>>2]=t.gid,Fe[e+20>>2]=t.rdev,ze[e+24>>3]=BigInt(t.size),Oe[e+32>>2]=4096,Oe[e+36>>2]=t.blocks;var o=t.atime.getTime(),s=t.mtime.getTime(),n=t.ctime.getTime();return ze[e+40>>3]=BigInt(Math.floor(o/1e3)),Fe[e+48>>2]=o%1e3*1e3*1e3,ze[e+56>>3]=BigInt(Math.floor(s/1e3)),Fe[e+64>>2]=s%1e3*1e3*1e3,ze[e+72>>3]=BigInt(Math.floor(n/1e3)),Fe[e+80>>2]=n%1e3*1e3*1e3,ze[e+88>>3]=BigInt(t.ino),0},writeStatFs(e,t){Fe[e+4>>2]=t.bsize,Fe[e+60>>2]=t.bsize,ze[e+8>>3]=BigInt(t.blocks),ze[e+16>>3]=BigInt(t.bfree),ze[e+24>>3]=BigInt(t.bavail),ze[e+32>>3]=BigInt(t.files),ze[e+40>>3]=BigInt(t.ffree),Fe[e+48>>2]=t.fsid,Fe[e+64>>2]=t.flags,Fe[e+56>>2]=t.namelen},doMsync(e,t,o,s,n){if(!l.isFile(t.node.mode))throw new l.ErrnoError(43);if(s&2)return 0;var i=st.slice(e,e+o);l.msync(t,i,n,o,s)},getStreamFromFD(e){return l.getStreamChecked(e)},varargs:void 0,getStr(e){return jn(e)}};function Mn(e,t){try{return e=we.getStr(e),l.chmod(e,t),0}catch(o){if(typeof l>"u"||o.name!=="ErrnoError")throw o;return-o.errno}}function zn(e,t,o,s){try{if(t=we.getStr(t),t=we.calculateAt(e,t),o&-8)return-28;var n=l.lookupPath(t,{follow:!0}).node;if(!n)return-44;var i="";return o&4&&(i+="r"),o&2&&(i+="w"),o&1&&(i+="x"),i&&l.nodePermissions(n,i)?-2:0}catch(r){if(typeof l>"u"||r.name!=="ErrnoError")throw r;return-r.errno}}function Bn(e,t){try{return l.fchmod(e,t),0}catch(o){if(typeof l>"u"||o.name!=="ErrnoError")throw o;return-o.errno}}function Un(e,t,o){try{return l.fchown(e,t,o),0}catch(s){if(typeof l>"u"||s.name!=="ErrnoError")throw s;return-s.errno}}var At=()=>{var e=Oe[+we.varargs>>2];return we.varargs+=4,e},ft=At;function Wn(e,t,o){we.varargs=o;try{var s=we.getStreamFromFD(e);switch(t){case 0:var n=At();if(n<0)return-28;for(;l.streams[n];)n++;return l.dupStream(s,n).fd;case 1:case 2:return 0;case 3:return s.flags;case 4:var n=At();return s.flags|=n,0;case 12:var n=ft(),i=0;return ht[n+i>>1]=2,0;case 13:case 14:return 0}return-28}catch(r){if(typeof l>"u"||r.name!=="ErrnoError")throw r;return-r.errno}}function Qn(e,t){try{return we.writeStat(t,l.fstat(e))}catch(o){if(typeof l>"u"||o.name!=="ErrnoError")throw o;return-o.errno}}var Vn=9007199254740992,Hn=-9007199254740992,bt=e=>e<Hn||e>Vn?NaN:Number(e);function Gn(e,t){t=bt(t);try{return isNaN(t)?-61:(l.ftruncate(e,t),0)}catch(o){if(typeof l>"u"||o.name!=="ErrnoError")throw o;return-o.errno}}var lt=(e,t,o)=>Ht(e,st,t,o);function $n(e,t){try{if(t===0)return-28;var o=l.cwd(),s=It(o)+1;return t<s?-68:(lt(o,e,t),s)}catch(n){if(typeof l>"u"||n.name!=="ErrnoError")throw n;return-n.errno}}function Kn(e,t,o){we.varargs=o;try{var s=we.getStreamFromFD(e);switch(t){case 21509:return s.tty?0:-59;case 21505:if(!s.tty)return-59;if(s.tty.ops.ioctl_tcgets){var n=s.tty.ops.ioctl_tcgets(s),C=ft();Oe[C>>2]=n.c_iflag||0,Oe[C+4>>2]=n.c_oflag||0,Oe[C+8>>2]=n.c_cflag||0,Oe[C+12>>2]=n.c_lflag||0;for(var i=0;i<32;i++)He[C+i+17]=n.c_cc[i]||0;return 0}return 0;case 21510:case 21511:case 21512:return s.tty?0:-59;case 21506:case 21507:case 21508:if(!s.tty)return-59;if(s.tty.ops.ioctl_tcsets){for(var C=ft(),r=Oe[C>>2],u=Oe[C+4>>2],F=Oe[C+8>>2],T=Oe[C+12>>2],J=[],i=0;i<32;i++)J.push(He[C+i+17]);return s.tty.ops.ioctl_tcsets(s.tty,t,{c_iflag:r,c_oflag:u,c_cflag:F,c_lflag:T,c_cc:J})}return 0;case 21519:if(!s.tty)return-59;var C=ft();return Oe[C>>2]=0,0;case 21520:return s.tty?-28:-59;case 21537:case 21531:var C=ft();return l.ioctl(s,t,C);case 21523:if(!s.tty)return-59;if(s.tty.ops.ioctl_tiocgwinsz){var G=s.tty.ops.ioctl_tiocgwinsz(s.tty),C=ft();ht[C>>1]=G[0],ht[C+2>>1]=G[1]}return 0;case 21524:return s.tty?0:-59;case 21515:return s.tty?0:-59;default:return-28}}catch(p){if(typeof l>"u"||p.name!=="ErrnoError")throw p;return-p.errno}}function Jn(e,t){try{return e=we.getStr(e),we.writeStat(t,l.lstat(e))}catch(o){if(typeof l>"u"||o.name!=="ErrnoError")throw o;return-o.errno}}function Xn(e,t,o){try{return t=we.getStr(t),t=we.calculateAt(e,t),l.mkdir(t,o,0),0}catch(s){if(typeof l>"u"||s.name!=="ErrnoError")throw s;return-s.errno}}function Yn(e,t,o,s){try{t=we.getStr(t);var n=s&256,i=s&4096;return s=s&-6401,t=we.calculateAt(e,t,i),we.writeStat(o,n?l.lstat(t):l.stat(t))}catch(r){if(typeof l>"u"||r.name!=="ErrnoError")throw r;return-r.errno}}function Zn(e,t,o,s){we.varargs=s;try{t=we.getStr(t),t=we.calculateAt(e,t);var n=s?At():0;return l.open(t,o,n).fd}catch(i){if(typeof l>"u"||i.name!=="ErrnoError")throw i;return-i.errno}}function er(e,t,o,s){try{if(t=we.getStr(t),t=we.calculateAt(e,t),s<=0)return-28;var n=l.readlink(t),i=Math.min(s,It(n)),r=He[o+i];return lt(n,o,s+1),He[o+i]=r,i}catch(u){if(typeof l>"u"||u.name!=="ErrnoError")throw u;return-u.errno}}function tr(e){try{return e=we.getStr(e),l.rmdir(e),0}catch(t){if(typeof l>"u"||t.name!=="ErrnoError")throw t;return-t.errno}}function nr(e,t){try{return e=we.getStr(e),we.writeStat(t,l.stat(e))}catch(o){if(typeof l>"u"||o.name!=="ErrnoError")throw o;return-o.errno}}function rr(e,t,o){try{if(t=we.getStr(t),t=we.calculateAt(e,t),!o)l.unlink(t);else if(o===512)l.rmdir(t);else return-28;return 0}catch(s){if(typeof l>"u"||s.name!=="ErrnoError")throw s;return-s.errno}}var Xt=e=>Fe[e>>2]+Oe[e+4>>2]*4294967296;function ir(e,t,o,s){try{t=we.getStr(t),t=we.calculateAt(e,t,!0);var n=Date.now(),i,r;if(!o)i=n,r=n;else{var u=Xt(o),F=Oe[o+8>>2];F==1073741823?i=n:F==1073741822?i=null:i=u*1e3+F/(1e3*1e3),o+=16,u=Xt(o),F=Oe[o+8>>2],F==1073741823?r=n:F==1073741822?r=null:r=u*1e3+F/(1e3*1e3)}return(r??i)!==null&&l.utime(t,i,r),0}catch(T){if(typeof l>"u"||T.name!=="ErrnoError")throw T;return-T.errno}}var sr=e=>e%4===0&&(e%100!==0||e%400===0),or=[0,31,60,91,121,152,182,213,244,274,305,335],ar=[0,31,59,90,120,151,181,212,243,273,304,334],lr=e=>(sr(e.getFullYear())?or:ar)[e.getMonth()]+e.getDate()-1;function cr(e,t){e=bt(e);var o=new Date(e*1e3);Oe[t>>2]=o.getSeconds(),Oe[t+4>>2]=o.getMinutes(),Oe[t+8>>2]=o.getHours(),Oe[t+12>>2]=o.getDate(),Oe[t+16>>2]=o.getMonth(),Oe[t+20>>2]=o.getFullYear()-1900,Oe[t+24>>2]=o.getDay();var s=lr(o)|0;Oe[t+28>>2]=s,Oe[t+36>>2]=-(o.getTimezoneOffset()*60);var n=new Date(o.getFullYear(),0,1),i=new Date(o.getFullYear(),6,1).getTimezoneOffset(),r=n.getTimezoneOffset(),u=(i!=r&&o.getTimezoneOffset()==Math.min(r,i))|0;Oe[t+32>>2]=u}function ur(e,t,o,s,n,i,r){n=bt(n);try{var u=we.getStreamFromFD(s),F=l.mmap(u,e,n,t,o),T=F.ptr;return Oe[i>>2]=F.allocated,Fe[r>>2]=T,0}catch(J){if(typeof l>"u"||J.name!=="ErrnoError")throw J;return-J.errno}}function _r(e,t,o,s,n,i){i=bt(i);try{var r=we.getStreamFromFD(n);o&2&&we.doMsync(e,r,t,s,i)}catch(u){if(typeof l>"u"||u.name!=="ErrnoError")throw u;return-u.errno}}var fr=(e,t,o,s)=>{var n=new Date().getFullYear(),i=new Date(n,0,1),r=new Date(n,6,1),u=i.getTimezoneOffset(),F=r.getTimezoneOffset(),T=Math.max(u,F);Fe[e>>2]=T*60,Oe[t>>2]=+(u!=F);var J=p=>{var z=p>=0?"-":"+",N=Math.abs(p);return`UTC${z}${String(Math.floor(N/60)).padStart(2,"0")}${String(N%60).padStart(2,"0")}`},C=J(u),G=J(F);F<u?(lt(C,o,17),lt(G,s,17)):(lt(C,s,17),lt(G,o,17))},Yt=()=>performance.now(),Zt=()=>Date.now(),dr=e=>e>=0&&e<=3;function pr(e,t,o){if(!dr(e))return 28;var s;e===0?s=Zt():s=Yt();var n=Math.round(s*1e3*1e3);return ze[o>>3]=BigInt(n),0}var en=()=>2147483648,hr=()=>en(),mr=e=>{var t=(e-Ze.buffer.byteLength+65535)/65536|0;try{return Ze.grow(t),Mt(),1}catch{}},gr=e=>{var t=st.length;e>>>=0;var o=en();if(e>o)return!1;for(var s=1;s<=4;s*=2){var n=t*(1+.2/s);if(n=Math.min(n,e+100663296),mr(Math.min(o,Gt(Math.max(e,n),65536))))return!0}return!1},Nt={},br=()=>Ne||"./this.program",yt=()=>{if(!yt.strings){var e=(globalThis.navigator?.language??"C").replace("-","_")+".UTF-8",t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:e,_:br()};for(var o in Nt)Nt[o]===void 0?delete t[o]:t[o]=Nt[o];var s=[];for(var o in t)s.push(`${o}=${t[o]}`);yt.strings=s}return yt.strings},yr=(e,t)=>{var o=0,s=0;for(var n of yt()){var i=t+o;Fe[e+s>>2]=i,o+=lt(n,i,1/0)+1,s+=4}return 0},qr=(e,t)=>{var o=yt();Fe[e>>2]=o.length;var s=0;for(var n of o)s+=It(n)+1;return Fe[t>>2]=s,0};function vr(e){try{var t=we.getStreamFromFD(e);return l.close(t),0}catch(o){if(typeof l>"u"||o.name!=="ErrnoError")throw o;return o.errno}}function Sr(e,t){try{var o=0,s=0,n=0,i=we.getStreamFromFD(e),r=i.tty?2:l.isDir(i.mode)?3:l.isLink(i.mode)?7:4;return He[t]=r,ht[t+2>>1]=n,ze[t+8>>3]=BigInt(o),ze[t+16>>3]=BigInt(s),0}catch(u){if(typeof l>"u"||u.name!=="ErrnoError")throw u;return u.errno}}var Er=(e,t,o,s)=>{for(var n=0,i=0;i<o;i++){var r=Fe[t>>2],u=Fe[t+4>>2];t+=8;var F=l.read(e,He,r,u,s);if(F<0)return-1;if(n+=F,F<u)break}return n};function wr(e,t,o,s){try{var n=Er(we.getStreamFromFD(e),t,o);return Fe[s>>2]=n,0}catch(i){if(typeof l>"u"||i.name!=="ErrnoError")throw i;return i.errno}}function Ir(e,t,o,s){t=bt(t);try{if(isNaN(t))return 61;var n=we.getStreamFromFD(e);return l.llseek(n,t,o),ze[s>>3]=BigInt(n.position),n.getdents&&t===0&&o===0&&(n.getdents=null),0}catch(i){if(typeof l>"u"||i.name!=="ErrnoError")throw i;return i.errno}}function Ar(e){try{var t=we.getStreamFromFD(e);return t.stream_ops?.fsync?.(t)}catch(o){if(typeof l>"u"||o.name!=="ErrnoError")throw o;return o.errno}}var Tr=(e,t,o,s)=>{for(var n=0,i=0;i<o;i++){var r=Fe[t>>2],u=Fe[t+4>>2];t+=8;var F=l.write(e,He,r,u,s);if(F<0)return-1;if(n+=F,F<u)break}return n};function kr(e,t,o,s){try{var n=Tr(we.getStreamFromFD(e),t,o);return Fe[s>>2]=n,0}catch(i){if(typeof l>"u"||i.name!=="ErrnoError")throw i;return i.errno}}if(l.createPreloadedFile=Dn,l.preloadFile=Jt,l.staticInit(),hn(),c.noExitRuntime&&c.noExitRuntime,c.preloadPlugins&&(Kt=c.preloadPlugins),c.print&&(ge=c.print),c.printErr&&(Ce=c.printErr),c.wasmBinary&&(Qe=c.wasmBinary),c.arguments&&c.arguments,c.thisProgram&&(Ne=c.thisProgram),c.preInit)for(typeof c.preInit=="function"&&(c.preInit=[c.preInit]);c.preInit.length>0;)c.preInit.shift()();c.wasmMemory=Ze;var tn;function Or(e){c._sqlite3_status64=e.sqlite3_status64,c._sqlite3_status=e.sqlite3_status,c._sqlite3_db_status64=e.sqlite3_db_status64,c._sqlite3_msize=e.sqlite3_msize,c._sqlite3_db_status=e.sqlite3_db_status,c._sqlite3_vfs_find=e.sqlite3_vfs_find,c._sqlite3_initialize=e.sqlite3_initialize,c._sqlite3_malloc=e.sqlite3_malloc,c._sqlite3_free=e.sqlite3_free,c._sqlite3_vfs_register=e.sqlite3_vfs_register,c._sqlite3_vfs_unregister=e.sqlite3_vfs_unregister,c._sqlite3_malloc64=e.sqlite3_malloc64,c._sqlite3_realloc=e.sqlite3_realloc,c._sqlite3_realloc64=e.sqlite3_realloc64,c._sqlite3_value_text=e.sqlite3_value_text,c._sqlite3_randomness=e.sqlite3_randomness,c._sqlite3_stricmp=e.sqlite3_stricmp,c._sqlite3_strnicmp=e.sqlite3_strnicmp,c._sqlite3_uri_parameter=e.sqlite3_uri_parameter,c._sqlite3_uri_boolean=e.sqlite3_uri_boolean,c._sqlite3_serialize=e.sqlite3_serialize,c._sqlite3_prepare_v2=e.sqlite3_prepare_v2,c._sqlite3_step=e.sqlite3_step,c._sqlite3_column_int64=e.sqlite3_column_int64,c._sqlite3_reset=e.sqlite3_reset,c._sqlite3_exec=e.sqlite3_exec,c._sqlite3_column_int=e.sqlite3_column_int,c._sqlite3_finalize=e.sqlite3_finalize,c._sqlite3_file_control=e.sqlite3_file_control,c._sqlite3_column_name=e.sqlite3_column_name,c._sqlite3_column_text=e.sqlite3_column_text,c._sqlite3_column_type=e.sqlite3_column_type,c._sqlite3_errmsg=e.sqlite3_errmsg,c._sqlite3_deserialize=e.sqlite3_deserialize,c._sqlite3_clear_bindings=e.sqlite3_clear_bindings,c._sqlite3_value_blob=e.sqlite3_value_blob,c._sqlite3_value_bytes=e.sqlite3_value_bytes,c._sqlite3_value_double=e.sqlite3_value_double,c._sqlite3_value_int=e.sqlite3_value_int,c._sqlite3_value_int64=e.sqlite3_value_int64,c._sqlite3_value_subtype=e.sqlite3_value_subtype,c._sqlite3_value_pointer=e.sqlite3_value_pointer,c._sqlite3_value_type=e.sqlite3_value_type,c._sqlite3_value_nochange=e.sqlite3_value_nochange,c._sqlite3_value_frombind=e.sqlite3_value_frombind,c._sqlite3_value_dup=e.sqlite3_value_dup,c._sqlite3_value_free=e.sqlite3_value_free,c._sqlite3_result_blob=e.sqlite3_result_blob,c._sqlite3_result_error_toobig=e.sqlite3_result_error_toobig,c._sqlite3_result_error_nomem=e.sqlite3_result_error_nomem,c._sqlite3_result_double=e.sqlite3_result_double,c._sqlite3_result_error=e.sqlite3_result_error,c._sqlite3_result_int=e.sqlite3_result_int,c._sqlite3_result_int64=e.sqlite3_result_int64,c._sqlite3_result_null=e.sqlite3_result_null,c._sqlite3_result_pointer=e.sqlite3_result_pointer,c._sqlite3_result_subtype=e.sqlite3_result_subtype,c._sqlite3_result_text=e.sqlite3_result_text,c._sqlite3_result_zeroblob=e.sqlite3_result_zeroblob,c._sqlite3_result_zeroblob64=e.sqlite3_result_zeroblob64,c._sqlite3_result_error_code=e.sqlite3_result_error_code,c._sqlite3_user_data=e.sqlite3_user_data,c._sqlite3_context_db_handle=e.sqlite3_context_db_handle,c._sqlite3_vtab_nochange=e.sqlite3_vtab_nochange,c._sqlite3_vtab_in_first=e.sqlite3_vtab_in_first,c._sqlite3_vtab_in_next=e.sqlite3_vtab_in_next,c._sqlite3_aggregate_context=e.sqlite3_aggregate_context,c._sqlite3_get_auxdata=e.sqlite3_get_auxdata,c._sqlite3_set_auxdata=e.sqlite3_set_auxdata,c._sqlite3_column_count=e.sqlite3_column_count,c._sqlite3_data_count=e.sqlite3_data_count,c._sqlite3_column_blob=e.sqlite3_column_blob,c._sqlite3_column_bytes=e.sqlite3_column_bytes,c._sqlite3_column_double=e.sqlite3_column_double,c._sqlite3_column_value=e.sqlite3_column_value,c._sqlite3_column_decltype=e.sqlite3_column_decltype,c._sqlite3_column_database_name=e.sqlite3_column_database_name,c._sqlite3_column_table_name=e.sqlite3_column_table_name,c._sqlite3_column_origin_name=e.sqlite3_column_origin_name,c._sqlite3_bind_blob=e.sqlite3_bind_blob,c._sqlite3_bind_double=e.sqlite3_bind_double,c._sqlite3_bind_int=e.sqlite3_bind_int,c._sqlite3_bind_int64=e.sqlite3_bind_int64,c._sqlite3_bind_null=e.sqlite3_bind_null,c._sqlite3_bind_pointer=e.sqlite3_bind_pointer,c._sqlite3_bind_text=e.sqlite3_bind_text,c._sqlite3_bind_parameter_count=e.sqlite3_bind_parameter_count,c._sqlite3_bind_parameter_name=e.sqlite3_bind_parameter_name,c._sqlite3_bind_parameter_index=e.sqlite3_bind_parameter_index,c._sqlite3_db_handle=e.sqlite3_db_handle,c._sqlite3_stmt_readonly=e.sqlite3_stmt_readonly,c._sqlite3_stmt_isexplain=e.sqlite3_stmt_isexplain,c._sqlite3_stmt_explain=e.sqlite3_stmt_explain,c._sqlite3_stmt_busy=e.sqlite3_stmt_busy,c._sqlite3_next_stmt=e.sqlite3_next_stmt,c._sqlite3_stmt_status=e.sqlite3_stmt_status,c._sqlite3_sql=e.sqlite3_sql,c._sqlite3_expanded_sql=e.sqlite3_expanded_sql,c._sqlite3_preupdate_old=e.sqlite3_preupdate_old,c._sqlite3_preupdate_count=e.sqlite3_preupdate_count,c._sqlite3_preupdate_depth=e.sqlite3_preupdate_depth,c._sqlite3_preupdate_blobwrite=e.sqlite3_preupdate_blobwrite,c._sqlite3_preupdate_new=e.sqlite3_preupdate_new,c._sqlite3_value_numeric_type=e.sqlite3_value_numeric_type,c._sqlite3_set_authorizer=e.sqlite3_set_authorizer,c._sqlite3_strglob=e.sqlite3_strglob,c._sqlite3_strlike=e.sqlite3_strlike,c._sqlite3_auto_extension=e.sqlite3_auto_extension,c._sqlite3_cancel_auto_extension=e.sqlite3_cancel_auto_extension,c._sqlite3_reset_auto_extension=e.sqlite3_reset_auto_extension,c._sqlite3_prepare_v3=e.sqlite3_prepare_v3,c._sqlite3_create_module=e.sqlite3_create_module,c._sqlite3_create_module_v2=e.sqlite3_create_module_v2,c._sqlite3_drop_modules=e.sqlite3_drop_modules,c._sqlite3_declare_vtab=e.sqlite3_declare_vtab,c._sqlite3_vtab_on_conflict=e.sqlite3_vtab_on_conflict,c._sqlite3_vtab_collation=e.sqlite3_vtab_collation,c._sqlite3_vtab_in=e.sqlite3_vtab_in,c._sqlite3_vtab_rhs_value=e.sqlite3_vtab_rhs_value,c._sqlite3_vtab_distinct=e.sqlite3_vtab_distinct,c._sqlite3_keyword_name=e.sqlite3_keyword_name,c._sqlite3_keyword_count=e.sqlite3_keyword_count,c._sqlite3_keyword_check=e.sqlite3_keyword_check,c._sqlite3_complete=e.sqlite3_complete,c._sqlite3_libversion=e.sqlite3_libversion,c._sqlite3_libversion_number=e.sqlite3_libversion_number,c._sqlite3_shutdown=e.sqlite3_shutdown,c._sqlite3_last_insert_rowid=e.sqlite3_last_insert_rowid,c._sqlite3_set_last_insert_rowid=e.sqlite3_set_last_insert_rowid,c._sqlite3_changes64=e.sqlite3_changes64,c._sqlite3_changes=e.sqlite3_changes,c._sqlite3_total_changes64=e.sqlite3_total_changes64,c._sqlite3_total_changes=e.sqlite3_total_changes,c._sqlite3_txn_state=e.sqlite3_txn_state,c._sqlite3_close_v2=e.sqlite3_close_v2,c._sqlite3_busy_handler=e.sqlite3_busy_handler,c._sqlite3_progress_handler=e.sqlite3_progress_handler,c._sqlite3_busy_timeout=e.sqlite3_busy_timeout,c._sqlite3_interrupt=e.sqlite3_interrupt,c._sqlite3_is_interrupted=e.sqlite3_is_interrupted,c._sqlite3_create_function=e.sqlite3_create_function,c._sqlite3_create_function_v2=e.sqlite3_create_function_v2,c._sqlite3_create_window_function=e.sqlite3_create_window_function,c._sqlite3_overload_function=e.sqlite3_overload_function,c._sqlite3_trace_v2=e.sqlite3_trace_v2,c._sqlite3_commit_hook=e.sqlite3_commit_hook,c._sqlite3_update_hook=e.sqlite3_update_hook,c._sqlite3_rollback_hook=e.sqlite3_rollback_hook,c._sqlite3_preupdate_hook=e.sqlite3_preupdate_hook,c._sqlite3_set_errmsg=e.sqlite3_set_errmsg,c._sqlite3_error_offset=e.sqlite3_error_offset,c._sqlite3_errcode=e.sqlite3_errcode,c._sqlite3_extended_errcode=e.sqlite3_extended_errcode,c._sqlite3_errstr=e.sqlite3_errstr,c._sqlite3_limit=e.sqlite3_limit,c._sqlite3_open=e.sqlite3_open,c._sqlite3_open_v2=e.sqlite3_open_v2,c._sqlite3_create_collation=e.sqlite3_create_collation,c._sqlite3_create_collation_v2=e.sqlite3_create_collation_v2,c._sqlite3_collation_needed=e.sqlite3_collation_needed,c._sqlite3_get_autocommit=e.sqlite3_get_autocommit,c._sqlite3_table_column_metadata=e.sqlite3_table_column_metadata,c._sqlite3_extended_result_codes=e.sqlite3_extended_result_codes,c._sqlite3_uri_key=e.sqlite3_uri_key,c._sqlite3_uri_int64=e.sqlite3_uri_int64,c._sqlite3_db_name=e.sqlite3_db_name,c._sqlite3_db_filename=e.sqlite3_db_filename,c._sqlite3_db_readonly=e.sqlite3_db_readonly,c._sqlite3_compileoption_used=e.sqlite3_compileoption_used,c._sqlite3_compileoption_get=e.sqlite3_compileoption_get,c._sqlite3session_diff=e.sqlite3session_diff,c._sqlite3session_attach=e.sqlite3session_attach,c._sqlite3session_create=e.sqlite3session_create,c._sqlite3session_delete=e.sqlite3session_delete,c._sqlite3session_table_filter=e.sqlite3session_table_filter,c._sqlite3session_changeset=e.sqlite3session_changeset,c._sqlite3session_changeset_strm=e.sqlite3session_changeset_strm,c._sqlite3session_patchset_strm=e.sqlite3session_patchset_strm,c._sqlite3session_patchset=e.sqlite3session_patchset,c._sqlite3session_enable=e.sqlite3session_enable,c._sqlite3session_indirect=e.sqlite3session_indirect,c._sqlite3session_isempty=e.sqlite3session_isempty,c._sqlite3session_memory_used=e.sqlite3session_memory_used,c._sqlite3session_object_config=e.sqlite3session_object_config,c._sqlite3session_changeset_size=e.sqlite3session_changeset_size,c._sqlite3changeset_start=e.sqlite3changeset_start,c._sqlite3changeset_start_v2=e.sqlite3changeset_start_v2,c._sqlite3changeset_start_strm=e.sqlite3changeset_start_strm,c._sqlite3changeset_start_v2_strm=e.sqlite3changeset_start_v2_strm,c._sqlite3changeset_next=e.sqlite3changeset_next,c._sqlite3changeset_op=e.sqlite3changeset_op,c._sqlite3changeset_pk=e.sqlite3changeset_pk,c._sqlite3changeset_old=e.sqlite3changeset_old,c._sqlite3changeset_new=e.sqlite3changeset_new,c._sqlite3changeset_conflict=e.sqlite3changeset_conflict,c._sqlite3changeset_fk_conflicts=e.sqlite3changeset_fk_conflicts,c._sqlite3changeset_finalize=e.sqlite3changeset_finalize,c._sqlite3changeset_invert=e.sqlite3changeset_invert,c._sqlite3changeset_invert_strm=e.sqlite3changeset_invert_strm,c._sqlite3changeset_apply_v2=e.sqlite3changeset_apply_v2,c._sqlite3changeset_apply_v3=e.sqlite3changeset_apply_v3,c._sqlite3changeset_apply=e.sqlite3changeset_apply,c._sqlite3changeset_apply_v3_strm=e.sqlite3changeset_apply_v3_strm,c._sqlite3changeset_apply_v2_strm=e.sqlite3changeset_apply_v2_strm,c._sqlite3changeset_apply_strm=e.sqlite3changeset_apply_strm,c._sqlite3changegroup_new=e.sqlite3changegroup_new,c._sqlite3changegroup_add=e.sqlite3changegroup_add,c._sqlite3changegroup_output=e.sqlite3changegroup_output,c._sqlite3changegroup_add_strm=e.sqlite3changegroup_add_strm,c._sqlite3changegroup_output_strm=e.sqlite3changegroup_output_strm,c._sqlite3changegroup_delete=e.sqlite3changegroup_delete,c._sqlite3changeset_concat=e.sqlite3changeset_concat,c._sqlite3changeset_concat_strm=e.sqlite3changeset_concat_strm,c._sqlite3session_config=e.sqlite3session_config,c._sqlite3_sourceid=e.sqlite3_sourceid,c._sqlite3__wasm_pstack_ptr=e.sqlite3__wasm_pstack_ptr,c._sqlite3__wasm_pstack_restore=e.sqlite3__wasm_pstack_restore,c._sqlite3__wasm_pstack_alloc=e.sqlite3__wasm_pstack_alloc,c._sqlite3__wasm_pstack_remaining=e.sqlite3__wasm_pstack_remaining,c._sqlite3__wasm_pstack_quota=e.sqlite3__wasm_pstack_quota,c._sqlite3__wasm_test_struct=e.sqlite3__wasm_test_struct,c._sqlite3__wasm_enum_json=e.sqlite3__wasm_enum_json,c._sqlite3__wasm_vfs_unlink=e.sqlite3__wasm_vfs_unlink,c._sqlite3__wasm_db_vfs=e.sqlite3__wasm_db_vfs,c._sqlite3__wasm_db_reset=e.sqlite3__wasm_db_reset,c._sqlite3__wasm_db_export_chunked=e.sqlite3__wasm_db_export_chunked,c._sqlite3__wasm_db_serialize=e.sqlite3__wasm_db_serialize,c._sqlite3__wasm_vfs_create_file=e.sqlite3__wasm_vfs_create_file,c._sqlite3__wasm_posix_create_file=e.sqlite3__wasm_posix_create_file,c._sqlite3__wasm_kvvfsMakeKey=e.sqlite3__wasm_kvvfsMakeKey,c._sqlite3__wasm_kvvfs_methods=e.sqlite3__wasm_kvvfs_methods,c._sqlite3__wasm_vtab_config=e.sqlite3__wasm_vtab_config,c._sqlite3__wasm_db_config_ip=e.sqlite3__wasm_db_config_ip,c._sqlite3__wasm_db_config_pii=e.sqlite3__wasm_db_config_pii,c._sqlite3__wasm_db_config_s=e.sqlite3__wasm_db_config_s,c._sqlite3__wasm_config_i=e.sqlite3__wasm_config_i,c._sqlite3__wasm_config_ii=e.sqlite3__wasm_config_ii,c._sqlite3__wasm_config_j=e.sqlite3__wasm_config_j,c._sqlite3__wasm_qfmt_token=e.sqlite3__wasm_qfmt_token,c._sqlite3__wasm_kvvfs_decode=e.sqlite3__wasm_kvvfs_decode,c._sqlite3__wasm_kvvfs_encode=e.sqlite3__wasm_kvvfs_encode,c._sqlite3__wasm_init_wasmfs=e.sqlite3__wasm_init_wasmfs,c._sqlite3__wasm_test_intptr=e.sqlite3__wasm_test_intptr,c._sqlite3__wasm_test_voidptr=e.sqlite3__wasm_test_voidptr,c._sqlite3__wasm_test_int64_max=e.sqlite3__wasm_test_int64_max,c._sqlite3__wasm_test_int64_min=e.sqlite3__wasm_test_int64_min,c._sqlite3__wasm_test_int64_times2=e.sqlite3__wasm_test_int64_times2,c._sqlite3__wasm_test_int64_minmax=e.sqlite3__wasm_test_int64_minmax,c._sqlite3__wasm_test_int64ptr=e.sqlite3__wasm_test_int64ptr,c._sqlite3__wasm_test_stack_overflow=e.sqlite3__wasm_test_stack_overflow,c._sqlite3__wasm_test_str_hello=e.sqlite3__wasm_test_str_hello,c._sqlite3__wasm_SQLTester_strglob=e.sqlite3__wasm_SQLTester_strglob,c._malloc=e.malloc,c._free=e.free,c._realloc=e.realloc,tn=e.emscripten_builtin_memalign,e._emscripten_stack_restore,e._emscripten_stack_alloc,e.emscripten_stack_get_current,e.__indirect_function_table}var nn={__syscall_chmod:Mn,__syscall_faccessat:zn,__syscall_fchmod:Bn,__syscall_fchown32:Un,__syscall_fcntl64:Wn,__syscall_fstat64:Qn,__syscall_ftruncate64:Gn,__syscall_getcwd:$n,__syscall_ioctl:Kn,__syscall_lstat64:Jn,__syscall_mkdirat:Xn,__syscall_newfstatat:Yn,__syscall_openat:Zn,__syscall_readlinkat:er,__syscall_rmdir:tr,__syscall_stat64:nr,__syscall_unlinkat:rr,__syscall_utimensat:ir,_localtime_js:cr,_mmap_js:ur,_munmap_js:_r,_tzset_js:fr,clock_time_get:pr,emscripten_date_now:Zt,emscripten_get_heap_max:hr,emscripten_get_now:Yt,emscripten_resize_heap:gr,environ_get:yr,environ_sizes_get:qr,fd_close:vr,fd_fdstat_get:Sr,fd_read:wr,fd_seek:Ir,fd_sync:Ar,fd_write:kr,memory:Ze};function Rt(){if(at>0){gt=Rt;return}if(mn(),at>0){gt=Rt;return}function e(){c.calledRun=!0,!ut&&(gn(),Et?.(c),c.onRuntimeInitialized?.(),bn())}c.setStatus?(c.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>c.setStatus(""),1),e()},1)):e()}var dt=await In();return Rt(),c.runSQLite3PostLoadInit=async function(e,t,o){delete t.runSQLite3PostLoadInit,globalThis.sqlite3ApiBootstrap=async function s(n=globalThis.sqlite3ApiConfig||s.defaultConfig){if(s.sqlite3)return(s.sqlite3.config||console).warn("sqlite3ApiBootstrap() called multiple times.","Config and external initializers are ignored on calls after the first."),s.sqlite3;const i=Object.assign(Object.create(null),{exports:void 0,memory:void 0,bigIntEnabled:!!globalThis.BigInt64Array,debug:console.debug.bind(console),warn:console.warn.bind(console),error:console.error.bind(console),log:console.log.bind(console),wasmfsOpfsDir:"/opfs",useStdAlloc:!1},n||{});Object.assign(i,{allocExportName:i.useStdAlloc?"malloc":"sqlite3_malloc",deallocExportName:i.useStdAlloc?"free":"sqlite3_free",reallocExportName:i.useStdAlloc?"realloc":"sqlite3_realloc"}),["exports","memory","functionTable","wasmfsOpfsDir"].forEach(f=>{typeof i[f]=="function"&&(i[f]=i[f]())});const r=Object.create(null),u=Object.create(null),F=f=>r.sqlite3_js_rc_str&&r.sqlite3_js_rc_str(f)||"Unknown result code #"+f,T=f=>typeof f=="number"&&f===(f|0)&&f<=2147483647&&f>=-2147483648;class J extends Error{constructor(...m){let q;if(m.length)if(T(m[0]))if(q=m[0],m.length===1)super(F(m[0]));else{const j=F(q);typeof m[1]=="object"?super(j,m[1]):(m[0]=j+":",super(m.join(" ")))}else m.length===2&&typeof m[1]=="object"?super(...m):super(m.join(" "));this.resultCode=q||r.SQLITE_ERROR,this.name="SQLite3Error"}}J.toss=(...f)=>{throw new J(...f)};const C=J.toss;i.wasmfsOpfsDir&&!/^\/[^/]+$/.test(i.wasmfsOpfsDir)&&C("config.wasmfsOpfsDir must be falsy or in the form '/dir-name'.");const G=function f(m){return f._max||(f._max=BigInt("0x7fffffffffffffff"),f._min=~f._max),m>=f._min&&m<=f._max},p=f=>f>=-2147483647n-1n&&f<=2147483647n,z=function f(m){return f._min||(f._min=Number.MIN_SAFE_INTEGER,f._max=Number.MAX_SAFE_INTEGER),m>=f._min&&m<=f._max},N=f=>f&&f.constructor&&T(f.constructor.BYTES_PER_ELEMENT)?f:!1,te=f=>f&&(f instanceof Uint8Array||f instanceof Int8Array||f instanceof ArrayBuffer),y=f=>f&&(f instanceof Uint8Array||f instanceof Int8Array||f instanceof ArrayBuffer),b=f=>te(f)||C("Value is not of a supported TypedArray type."),R=function(f){return y(f)?u.typedArrayToString(f instanceof ArrayBuffer?new Uint8Array(f):f,0,f.length):Array.isArray(f)?f.join(""):(u.isPtr(f)&&(f=u.cstrToJs(f)),f)};class U extends Error{constructor(...m){m.length===2&&typeof m[1]=="object"?super(...m):m.length?super(m.join(" ")):super("Allocation failed."),this.resultCode=r.SQLITE_NOMEM,this.name="WasmAllocError"}}U.toss=(...f)=>{throw new U(...f)},Object.assign(r,{sqlite3_bind_blob:void 0,sqlite3_bind_text:void 0,sqlite3_create_function_v2:(f,m,q,j,Y,oe,be,qe,fe)=>{},sqlite3_create_function:(f,m,q,j,Y,oe,be,qe)=>{},sqlite3_create_window_function:(f,m,q,j,Y,oe,be,qe,fe,V)=>{},sqlite3_prepare_v3:(f,m,q,j,Y,oe)=>{},sqlite3_prepare_v2:(f,m,q,j,Y)=>{},sqlite3_exec:(f,m,q,j,Y)=>{},sqlite3_randomness:(f,m)=>{}});const w={affirmBindableTypedArray:b,flexibleString:R,bigIntFits32:p,bigIntFits64:G,bigIntFitsDouble:z,isBindableTypedArray:te,isInt32:T,isSQLableTypedArray:y,isTypedArray:N,isUIThread:()=>globalThis.window===globalThis&&!!globalThis.document,toss:function(...f){throw new Error(f.join(" "))},toss3:C,typedArrayPart:u.typedArrayPart,assert:function(f,m){f||w.toss("Assertion failed:",m)},affirmDbHeader:function(f){f instanceof ArrayBuffer&&(f=new Uint8Array(f));const m="SQLite format 3";15>f.byteLength&&C("Input does not contain an SQLite3 database header.");for(let q=0;q<15;++q)m.charCodeAt(q)!==f[q]&&C("Input does not contain an SQLite3 database header.")},affirmIsDb:function(f){f instanceof ArrayBuffer&&(f=new Uint8Array(f));const m=f.byteLength;(m<512||m%512!==0)&&C("Byte array size",m,"is invalid for an SQLite3 db."),w.affirmDbHeader(f)}};Object.assign(u,{exports:i.exports||C("Missing API config.exports (WASM module exports)."),memory:i.memory||i.exports.memory||C("API config object requires a WebAssembly.Memory object","in either config.exports.memory (exported)","or config.memory (imported)."),pointerSize:typeof i.exports.sqlite3_libversion()=="number"?4:8,bigIntEnabled:!!i.bigIntEnabled,functionTable:i.functionTable,alloc:void 0,realloc:void 0,dealloc:void 0}),u.allocFromTypedArray=function(f){f instanceof ArrayBuffer&&(f=new Uint8Array(f)),b(f);const m=u.alloc(f.byteLength||1);return u.heapForSize(f.constructor).set(f.byteLength?f:[0],Number(m)),m};{const f=i.allocExportName,m=i.deallocExportName,q=i.reallocExportName;for(const j of[f,m,q])u.exports[j]instanceof Function||C("Missing required exports[",j,"] function.");u.alloc=function j(Y){return j.impl(Y)||U.toss("Failed to allocate",Y," bytes.")},u.alloc.impl=u.exports[f],u.realloc=function j(Y,oe){const be=j.impl(u.ptr.coerce(Y),oe);return oe?be||U.toss("Failed to reallocate",oe," bytes."):u.ptr.null},u.realloc.impl=u.exports[q],u.dealloc=function j(Y){j.impl(u.ptr.coerce(Y))},u.dealloc.impl=u.exports[m]}u.compileOptionUsed=function f(m){if(arguments.length){if(Array.isArray(m)){const q=Object.create(null);return m.forEach(j=>{q[j]=r.sqlite3_compileoption_used(j)}),q}else if(typeof m=="object")return Object.keys(m).forEach(q=>{m[q]=r.sqlite3_compileoption_used(q)}),m}else{if(f._result)return f._result;f._opt||(f._rx=/^([^=]+)=(.+)/,f._rxInt=/^-?\d+$/,f._opt=function(be,qe){const fe=f._rx.exec(be);qe[0]=fe?fe[1]:be,qe[1]=fe?f._rxInt.test(fe[2])?+fe[2]:fe[2]:!0});const q=Object.create(null),j=[0,0];let Y=0,oe;for(;oe=r.sqlite3_compileoption_get(Y++);)f._opt(oe,j),q[j[0]]=j[1];return f._result=q}return typeof m=="string"?!!r.sqlite3_compileoption_used(m):!1},u.pstack=Object.assign(Object.create(null),{restore:u.exports.sqlite3__wasm_pstack_restore,alloc:function(f){return typeof f=="string"&&!(f=u.sizeofIR(f))&&U.toss("Invalid value for pstack.alloc(",arguments[0],")"),u.exports.sqlite3__wasm_pstack_alloc(f)||U.toss("Could not allocate",f,"bytes from the pstack.")},allocChunks:function(f,m){typeof m=="string"&&!(m=u.sizeofIR(m))&&U.toss("Invalid size value for allocChunks(",arguments[1],")");const q=u.pstack.alloc(f*m),j=[q];let Y=1,oe=m;for(;Y<f;++Y,oe+=m)j.push(u.ptr.add(q,oe));return j},allocPtr:(f=1,m=!0)=>f===1?u.pstack.alloc(m?8:u.ptr.size):u.pstack.allocChunks(f,m?8:u.ptr.size),call:function(f){const m=u.pstack.pointer;try{return f(O)}finally{u.pstack.restore(m)}}}),Object.defineProperties(u.pstack,{pointer:{configurable:!1,iterable:!0,writeable:!1,get:u.exports.sqlite3__wasm_pstack_ptr},quota:{configurable:!1,iterable:!0,writeable:!1,get:u.exports.sqlite3__wasm_pstack_quota},remaining:{configurable:!1,iterable:!0,writeable:!1,get:u.exports.sqlite3__wasm_pstack_remaining}}),r.sqlite3_randomness=(...f)=>{if(f.length===1&&w.isTypedArray(f[0])&&f[0].BYTES_PER_ELEMENT===1){const m=f[0];if(m.byteLength===0)return u.exports.sqlite3_randomness(0,u.ptr.null),m;const q=u.pstack.pointer;try{let j=m.byteLength,Y=0;const oe=u.exports.sqlite3_randomness,be=u.heap8u(),qe=j<512?j:512,fe=u.pstack.alloc(qe);do{const V=j>qe?qe:j;oe(V,fe),m.set(u.typedArrayPart(be,fe,u.ptr.add(fe,V)),Y),j-=V,Y+=V}while(j>0)}catch(j){i.error("Highly unexpected (and ignored!) exception in sqlite3_randomness():",j)}finally{u.pstack.restore(q)}return m}u.exports.sqlite3_randomness(...f)},r.sqlite3_wasmfs_opfs_dir=(function(){if(this.dir!==void 0)return this.dir;const f=i.wasmfsOpfsDir;if(!f||!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle||!u.exports.sqlite3__wasm_init_wasmfs)return this.dir="";try{return f&&u.xCallWrapped("sqlite3__wasm_init_wasmfs","i32",["string"],f)===0?this.dir=f:this.dir=""}catch{return this.dir=""}}).bind(Object.create(null)),r.sqlite3_wasmfs_filename_is_persistent=function(f){const m=r.sqlite3_wasmfs_opfs_dir();return m&&f?f.startsWith(m+"/"):!1},r.sqlite3_js_db_uses_vfs=function(f,m,q=0){try{const j=r.sqlite3_vfs_find(m);return j?f?j===r.sqlite3_js_db_vfs(f,q)?j:!1:j===r.sqlite3_vfs_find(0)?j:!1:!1}catch{return!1}},r.sqlite3_js_vfs_list=function(){const f=[];let m=r.sqlite3_vfs_find(u.ptr.null);for(;m;){const q=new r.sqlite3_vfs(m);f.push(u.cstrToJs(q.$zName)),m=q.$pNext,q.dispose()}return f},r.sqlite3_js_db_export=function(f,m=0){f=u.xWrap.testConvertArg("sqlite3*",f),f||C("Invalid sqlite3* argument."),u.bigIntEnabled||C("BigInt support is not enabled.");const q=u.scopedAllocPush();let j;try{const Y=u.scopedAlloc(8+u.ptr.size),oe=u.ptr.add(Y,8),be=m?u.isPtr(m)?m:u.scopedAllocCString(""+m):u.ptr.null;let qe=u.exports.sqlite3__wasm_db_serialize(f,be,oe,Y,0);qe&&C("Database serialization failed with code",O.capi.sqlite3_js_rc_str(qe)),j=u.peekPtr(oe);const fe=u.peek(Y,"i64");return qe=fe?u.heap8u().slice(Number(j),Number(j)+Number(fe)):new Uint8Array,qe}finally{j&&u.exports.sqlite3_free(j),u.scopedAllocPop(q)}},r.sqlite3_js_db_vfs=(f,m=u.ptr.null)=>w.sqlite3__wasm_db_vfs(f,m),r.sqlite3_js_aggregate_context=(f,m)=>r.sqlite3_aggregate_context(f,m)||(m?U.toss("Cannot allocate",m,"bytes for sqlite3_aggregate_context()"):0),r.sqlite3_js_posix_create_file=function(f,m,q){let j;m&&u.isPtr(m)?j=m:m instanceof ArrayBuffer||m instanceof Uint8Array?(j=u.allocFromTypedArray(m),(arguments.length<3||!w.isInt32(q)||q<0)&&(q=m.byteLength)):J.toss("Invalid 2nd argument for sqlite3_js_posix_create_file().");try{(!w.isInt32(q)||q<0)&&J.toss("Invalid 3rd argument for sqlite3_js_posix_create_file().");const Y=w.sqlite3__wasm_posix_create_file(f,j,q);Y&&J.toss("Creation of file failed with sqlite3 result code",r.sqlite3_js_rc_str(Y))}finally{j&&j!==m&&u.dealloc(j)}},r.sqlite3_js_vfs_create_file=function(f,m,q,j){i.warn("sqlite3_js_vfs_create_file() is deprecated and","should be avoided because it can lead to C-level crashes.","See its documentation for alternatives.");let Y;q?u.isPtr(q)?Y=q:(q instanceof ArrayBuffer&&(q=new Uint8Array(q)),q instanceof Uint8Array?(Y=u.allocFromTypedArray(q),(arguments.length<4||!w.isInt32(j)||j<0)&&(j=q.byteLength)):J.toss("Invalid 3rd argument type for sqlite3_js_vfs_create_file().")):Y=0,(!w.isInt32(j)||j<0)&&(Y&&Y!==q&&u.dealloc(Y),J.toss("Invalid 4th argument for sqlite3_js_vfs_create_file()."));try{const oe=w.sqlite3__wasm_vfs_create_file(f,m,Y,j);oe&&J.toss("Creation of file failed with sqlite3 result code",r.sqlite3_js_rc_str(oe))}finally{Y&&Y!==q&&u.dealloc(Y)}},r.sqlite3_js_sql_to_string=f=>{if(typeof f=="string")return f;const m=R(v);return m===v?void 0:m},r.sqlite3_db_config=(function(f,m,...q){switch(m){case r.SQLITE_DBCONFIG_ENABLE_FKEY:case r.SQLITE_DBCONFIG_ENABLE_TRIGGER:case r.SQLITE_DBCONFIG_ENABLE_FTS3_TOKENIZER:case r.SQLITE_DBCONFIG_ENABLE_LOAD_EXTENSION:case r.SQLITE_DBCONFIG_NO_CKPT_ON_CLOSE:case r.SQLITE_DBCONFIG_ENABLE_QPSG:case r.SQLITE_DBCONFIG_TRIGGER_EQP:case r.SQLITE_DBCONFIG_RESET_DATABASE:case r.SQLITE_DBCONFIG_DEFENSIVE:case r.SQLITE_DBCONFIG_WRITABLE_SCHEMA:case r.SQLITE_DBCONFIG_LEGACY_ALTER_TABLE:case r.SQLITE_DBCONFIG_DQS_DML:case r.SQLITE_DBCONFIG_DQS_DDL:case r.SQLITE_DBCONFIG_ENABLE_VIEW:case r.SQLITE_DBCONFIG_LEGACY_FILE_FORMAT:case r.SQLITE_DBCONFIG_TRUSTED_SCHEMA:case r.SQLITE_DBCONFIG_STMT_SCANSTATUS:case r.SQLITE_DBCONFIG_REVERSE_SCANORDER:case r.SQLITE_DBCONFIG_ENABLE_ATTACH_CREATE:case r.SQLITE_DBCONFIG_ENABLE_ATTACH_WRITE:case r.SQLITE_DBCONFIG_ENABLE_COMMENTS:return this.ip||(this.ip=u.xWrap("sqlite3__wasm_db_config_ip","int",["sqlite3*","int","int","*"])),this.ip(f,m,q[0],q[1]||0);case r.SQLITE_DBCONFIG_LOOKASIDE:return this.pii||(this.pii=u.xWrap("sqlite3__wasm_db_config_pii","int",["sqlite3*","int","*","int","int"])),this.pii(f,m,q[0],q[1],q[2]);case r.SQLITE_DBCONFIG_MAINDBNAME:return this.s||(this.s=u.xWrap("sqlite3__wasm_db_config_s","int",["sqlite3*","int","string:static"])),this.s(f,m,q[0]);default:return r.SQLITE_MISUSE}}).bind(Object.create(null)),r.sqlite3_value_to_js=function(f,m=!0){let q;const j=r.sqlite3_value_type(f);switch(j){case r.SQLITE_INTEGER:u.bigIntEnabled?(q=r.sqlite3_value_int64(f),w.bigIntFitsDouble(q)&&(q=Number(q))):q=r.sqlite3_value_double(f);break;case r.SQLITE_FLOAT:q=r.sqlite3_value_double(f);break;case r.SQLITE_TEXT:q=r.sqlite3_value_text(f);break;case r.SQLITE_BLOB:{const Y=r.sqlite3_value_bytes(f),oe=r.sqlite3_value_blob(f);Y&&!oe&&O.WasmAllocError.toss("Cannot allocate memory for blob argument of",Y,"byte(s)"),q=Y?u.heap8u().slice(Number(oe),Number(oe)+Number(Y)):null;break}case r.SQLITE_NULL:q=null;break;default:m&&C(r.SQLITE_MISMATCH,"Unhandled sqlite3_value_type():",j),q=void 0}return q},r.sqlite3_values_to_js=function(f,m,q=!0){let j;const Y=[];for(j=0;j<f;++j)Y.push(r.sqlite3_value_to_js(u.peekPtr(u.ptr.add(m,u.ptr.size*j)),q));return Y},r.sqlite3_result_error_js=function(f,m){m instanceof U?r.sqlite3_result_error_nomem(f):r.sqlite3_result_error(f,""+m,-1)},r.sqlite3_result_js=function(f,m){if(m instanceof Error){r.sqlite3_result_error_js(f,m);return}try{switch(typeof m){case"undefined":break;case"boolean":r.sqlite3_result_int(f,m?1:0);break;case"bigint":w.bigIntFits32(m)?r.sqlite3_result_int(f,Number(m)):w.bigIntFitsDouble(m)?r.sqlite3_result_double(f,Number(m)):u.bigIntEnabled?w.bigIntFits64(m)?r.sqlite3_result_int64(f,m):C("BigInt value",m.toString(),"is too BigInt for int64."):C("BigInt value",m.toString(),"is too BigInt.");break;case"number":{let q;w.isInt32(m)?q=r.sqlite3_result_int:u.bigIntEnabled&&Number.isInteger(m)&&w.bigIntFits64(BigInt(m))?q=r.sqlite3_result_int64:q=r.sqlite3_result_double,q(f,m);break}case"string":{const[q,j]=u.allocCString(m,!0);r.sqlite3_result_text(f,q,j,r.SQLITE_WASM_DEALLOC);break}case"object":if(m===null){r.sqlite3_result_null(f);break}else if(w.isBindableTypedArray(m)){const q=u.allocFromTypedArray(m);r.sqlite3_result_blob(f,q,m.byteLength,r.SQLITE_WASM_DEALLOC);break}default:C("Don't not how to handle this UDF result value:",typeof m,m)}}catch(q){r.sqlite3_result_error_js(f,q)}},r.sqlite3_column_js=function(f,m,q=!0){const j=r.sqlite3_column_value(f,m);return j===0?void 0:r.sqlite3_value_to_js(j,q)};{const f=(function(m,q,j){j=r[j],this.ptr?u.pokePtr(this.ptr,0):this.ptr=u.allocPtr();const Y=j(m,q,this.ptr);if(Y)return J.toss(Y,arguments[2]+"() failed with code "+Y);const oe=u.peekPtr(this.ptr);return oe?r.sqlite3_value_to_js(oe,!0):void 0}).bind(Object.create(null));r.sqlite3_preupdate_new_js=(m,q)=>f(m,q,"sqlite3_preupdate_new"),r.sqlite3_preupdate_old_js=(m,q)=>f(m,q,"sqlite3_preupdate_old"),r.sqlite3changeset_new_js=(m,q)=>f(m,q,"sqlite3changeset_new"),r.sqlite3changeset_old_js=(m,q)=>f(m,q,"sqlite3changeset_old")}const O={WasmAllocError:U,SQLite3Error:J,capi:r,util:w,wasm:u,config:i,version:Object.create(null),client:void 0,asyncPostInit:(async function f(){if(f.isReady instanceof Promise)return f.isReady;let m=this.initializersAsync;delete this.initializersAsync;const q=async()=>(O.__isUnderTest||(delete O.util,delete O.StructBinder),O),j=oe=>{throw i.error("an async sqlite3 initializer failed:",oe),oe};if(!m||!m.length)return f.isReady=q().catch(j);m=m.map(oe=>oe instanceof Function?async be=>oe(O):oe),m.push(q);let Y=Promise.resolve(O);for(;m.length;)Y=Y.then(m.shift());return f.isReady=Y.catch(j)}).bind(s),scriptInfo:void 0};typeof o<"u"&&(O.__isUnderTest=!!o);try{s.initializers.forEach(f=>{f(O)})}catch(f){throw console.error("sqlite3 bootstrap initializer threw:",f),f}if(delete s.initializers,s.sqlite3=O,typeof e<"u"&&(e.debugModule("sqlite3ApiBootstrap() complete",O),O.scriptInfo=e),O.__isUnderTest){typeof t<"u"&&(O.config.emscripten=t);const f=O.scriptInfo?.instantiateWasm;f&&(O.wasm.module=f.module,O.wasm.instance=f.instance,O.wasm.imports=f.imports)}return delete globalThis.sqlite3ApiConfig,delete globalThis.sqlite3ApiBootstrap,delete s.defaultConfig,O.asyncPostInit().then(f=>(typeof e<"u"&&e.debugModule("sqlite3.asyncPostInit() complete",f),delete f.asyncPostInit,delete f.scriptInfo,delete f.emscripten,f))},globalThis.sqlite3ApiBootstrap.initializers=[],globalThis.sqlite3ApiBootstrap.initializersAsync=[],globalThis.sqlite3ApiBootstrap.defaultConfig=Object.create(null),globalThis.sqlite3ApiBootstrap.sqlite3=void 0,globalThis.sqlite3ApiBootstrap.initializers.push(function(s){s.version={libVersion:"3.52.0",libVersionNumber:3052e3,sourceId:"2026-01-30 06:37:34 407724c4e80efdf93d885e95b5209a100a3f470fe0298138be57201f65f9817e",downloadVersion:352e4,scm:{"sha3-256":"407724c4e80efdf93d885e95b5209a100a3f470fe0298138be57201f65f9817e",branch:"trunk",tags:"",datetime:"2026-01-30T06:37:34.096Z"}}}),globalThis.WhWasmUtilInstaller=function(n){n.bigIntEnabled===void 0&&(n.bigIntEnabled=!!globalThis.BigInt64Array);const i=(...a)=>{throw new Error(a.join(" "))};if(!n.pointerSize&&!n.pointerIR&&n.alloc&&n.dealloc){const a=n.alloc(1);n.pointerSize=typeof a=="bigint"?8:4,n.dealloc(a)}n.pointerSize&&!n.pointerIR&&(n.pointerIR=n.pointerSize===4?"i32":"i64");const r=n.pointerIR??="i32",u=n.pointerSize??=r==="i32"?4:r==="i64"?8:0;delete n.pointerSize,delete n.pointerIR,r!=="i32"&&r!=="i64"?i("Invalid pointerIR:",r):u!==8&&u!==4&&i("Invalid pointerSize:",u);const F=n.bigIntEnabled?a=>BigInt(a||0):a=>i("BigInt support is disabled in this build."),J=u===4?a=>Number(a||0):F,C=J(0),G=function(...a){let _=J(0);for(const d of a)_+=J(d);return _};{const a=Object.create(null);Object.defineProperty(n,"ptr",{enumerable:!0,get:()=>a,set:()=>i("The ptr property is read-only.")}),(function _(d,S){return Object.defineProperty(a,d,{enumerable:!0,get:()=>S,set:()=>i("ptr["+d+"] is read-only.")}),_})("null",C)("size",u)("ir",r)("coerce",J)("add",G)("addn",r===4?G:(..._)=>Number(G(..._)))}n.exports||Object.defineProperty(n,"exports",{enumerable:!0,configurable:!0,get:()=>n.instance?.exports});const p=Object.create(null);p.heapSize=0,p.memory=null,p.freeFuncIndexes=[],p.scopedAlloc=[],p.scopedAlloc.pushPtr=a=>(p.scopedAlloc[p.scopedAlloc.length-1].push(a),a),p.utf8Decoder=new TextDecoder,p.utf8Encoder=new TextEncoder("utf-8"),n.sizeofIR=a=>{switch(a){case"i8":return 1;case"i16":return 2;case"i32":case"f32":case"float":return 4;case"i64":case"f64":case"double":return 8;case"*":return u;default:return(""+a).endsWith("*")?u:void 0}};const z=function(){if(!p.memory)p.memory=n.memory instanceof WebAssembly.Memory?n.memory:n.exports.memory;else if(p.heapSize===p.memory.buffer.byteLength)return p;const a=p.memory.buffer;return p.HEAP8=new Int8Array(a),p.HEAP8U=new Uint8Array(a),p.HEAP16=new Int16Array(a),p.HEAP16U=new Uint16Array(a),p.HEAP32=new Int32Array(a),p.HEAP32U=new Uint32Array(a),p.HEAP32F=new Float32Array(a),p.HEAP64F=new Float64Array(a),n.bigIntEnabled&&(typeof BigInt64Array<"u"?(p.HEAP64=new BigInt64Array(a),p.HEAP64U=new BigUint64Array(a)):i("BigInt support is enabled, but the BigInt64Array type is missing.")),p.heapSize=a.byteLength,p};n.heap8=()=>z().HEAP8,n.heap8u=()=>z().HEAP8U,n.heap16=()=>z().HEAP16,n.heap16u=()=>z().HEAP16U,n.heap32=()=>z().HEAP32,n.heap32u=()=>z().HEAP32U,n.heapForSize=function(a,_=!0){const d=p.memory&&p.heapSize===p.memory.buffer.byteLength?p:z();switch(a){case Int8Array:return d.HEAP8;case Uint8Array:return d.HEAP8U;case Int16Array:return d.HEAP16;case Uint16Array:return d.HEAP16U;case Int32Array:return d.HEAP32;case Uint32Array:return d.HEAP32U;case 8:return _?d.HEAP8U:d.HEAP8;case 16:return _?d.HEAP16U:d.HEAP16;case 32:return _?d.HEAP32U:d.HEAP32;case 64:if(d.HEAP64)return _?d.HEAP64U:d.HEAP64;break;default:if(n.bigIntEnabled){if(a===globalThis.BigUint64Array)return d.HEAP64U;if(a===globalThis.BigInt64Array)return d.HEAP64;break}}i("Invalid heapForSize() size: expecting 8, 16, 32,","or (if BigInt is enabled) 64.")};const N=n.functionTable;delete n.functionTable,n.functionTable=N?()=>N:()=>n.exports.__indirect_function_table,n.functionEntry=function(a){const _=n.functionTable();return a<_.length?_.get(J(a)):void 0},n.jsFuncToWasm=function a(_,d){if(a._||(a._={sigTypes:Object.assign(Object.create(null),{i:"i32",p:r,P:r,s:r,j:"i64",f:"f32",d:"f64"}),typeCodes:Object.assign(Object.create(null),{f64:124,f32:125,i64:126,i32:127}),uleb128Encode:(D,h,P)=>{P<128?D[h](P):D[h](P%128|128,P>>7)},rxJSig:/^(\w)\((\w*)\)$/,sigParams:D=>{const h=a._.rxJSig.exec(D);return h?h[2]:D.substr(1)},letterType:D=>a._.sigTypes[D]||i("Invalid signature letter:",D),pushSigType:(D,h)=>D.push(a._.typeCodes[a._.letterType(h)])}),typeof _=="string"){const D=d;d=_,_=D}const S=a._,W=S.sigParams(d),K=[1,96];S.uleb128Encode(K,"push",W.length);for(const D of W)S.pushSigType(K,D);return d[0]==="v"?K.push(0):(K.push(1),S.pushSigType(K,d[0])),S.uleb128Encode(K,"unshift",K.length),K.unshift(0,97,115,109,1,0,0,0,1),K.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array(K)),{e:{f:_}}).exports.f};const te=function(_,d,S){if(S&&!p.scopedAlloc.length&&i("No scopedAllocPush() scope is active."),typeof _=="string"){const h=d;d=_,_=h}(typeof d!="string"||!(_ instanceof Function))&&i("Invalid arguments: expecting (function,signature) or (signature,function).");const W=n.functionTable(),K=J(W.length);let D;for(;(D=p.freeFuncIndexes.pop())&&W.get(D);){D=null;continue}D||(D=J(K),W.grow(J(1)));try{return W.set(D,_),S&&p.scopedAlloc.pushPtr(D),D}catch(h){if(!(h instanceof TypeError))throw D===K&&p.freeFuncIndexes.push(K),h}try{const h=n.jsFuncToWasm(_,d);W.set(D,h),S&&p.scopedAlloc.pushPtr(D)}catch(h){throw D===K&&p.freeFuncIndexes.push(K),h}return D};n.installFunction=(a,_)=>te(a,_,!1),n.scopedInstallFunction=(a,_)=>te(a,_,!0),n.uninstallFunction=function(a){if(!a&&C!==a)return;const _=n.functionTable();p.freeFuncIndexes.push(a);const d=_.get(a);return _.set(a,null),d},n.peek=function(_,d="i8"){d.endsWith("*")&&(d=r);const S=p.memory&&p.heapSize===p.memory.buffer.byteLength?p:z(),W=Array.isArray(_)?[]:void 0;let K;do{switch(W&&(_=arguments[0].shift()),d){case"i1":case"i8":K=S.HEAP8[Number(_)>>0];break;case"i16":K=S.HEAP16[Number(_)>>1];break;case"i32":K=S.HEAP32[Number(_)>>2];break;case"float":case"f32":K=S.HEAP32F[Number(_)>>2];break;case"double":case"f64":K=Number(S.HEAP64F[Number(_)>>3]);break;case"i64":if(S.HEAP64){K=F(S.HEAP64[Number(_)>>3]);break}default:i("Invalid type for peek():",d)}W&&W.push(K)}while(W&&arguments[0].length);return W||K},n.poke=function(a,_,d="i8"){d.endsWith("*")&&(d=r);const S=p.memory&&p.heapSize===p.memory.buffer.byteLength?p:z();for(const W of Array.isArray(a)?a:[a])switch(d){case"i1":case"i8":S.HEAP8[Number(W)>>0]=_;continue;case"i16":S.HEAP16[Number(W)>>1]=_;continue;case"i32":S.HEAP32[Number(W)>>2]=_;continue;case"float":case"f32":S.HEAP32F[Number(W)>>2]=_;continue;case"double":case"f64":S.HEAP64F[Number(W)>>3]=_;continue;case"i64":if(S.HEAP64){S.HEAP64[Number(W)>>3]=F(_);continue}default:i("Invalid type for poke(): "+d)}return this},n.peekPtr=(...a)=>n.peek(a.length===1?a[0]:a,r),n.pokePtr=(a,_=0)=>n.poke(a,_,r),n.peek8=(...a)=>n.peek(a.length===1?a[0]:a,"i8"),n.poke8=(a,_)=>n.poke(a,_,"i8"),n.peek16=(...a)=>n.peek(a.length===1?a[0]:a,"i16"),n.poke16=(a,_)=>n.poke(a,_,"i16"),n.peek32=(...a)=>n.peek(a.length===1?a[0]:a,"i32"),n.poke32=(a,_)=>n.poke(a,_,"i32"),n.peek64=(...a)=>n.peek(a.length===1?a[0]:a,"i64"),n.poke64=(a,_)=>n.poke(a,_,"i64"),n.peek32f=(...a)=>n.peek(a.length===1?a[0]:a,"f32"),n.poke32f=(a,_)=>n.poke(a,_,"f32"),n.peek64f=(...a)=>n.peek(a.length===1?a[0]:a,"f64"),n.poke64f=(a,_)=>n.poke(a,_,"f64"),n.getMemValue=n.peek,n.getPtrValue=n.peekPtr,n.setMemValue=n.poke,n.setPtrValue=n.pokePtr,n.isPtr32=a=>typeof a=="number"&&a>=0&&a===(a|0),n.isPtr64=a=>typeof a=="bigint"?a>=0:n.isPtr32(a),n.isPtr=u===4?n.isPtr32:n.isPtr64,n.cstrlen=function(a){if(!a||!n.isPtr(a))return null;a=Number(a);const _=z().HEAP8U;let d=a;for(;_[d]!==0;++d);return d-a};const y=typeof SharedArrayBuffer>"u"?function(){}:SharedArrayBuffer,b=a=>a.buffer instanceof y;n.isSharedTypedArray=b;const R=(a,_,d)=>(u===8&&(typeof _=="bigint"&&(_=Number(_)),typeof d=="bigint"&&(d=Number(d))),b(a)?a.slice(_,d):a.subarray(_,d));n.typedArrayPart=R;const U=(a,_,d)=>p.utf8Decoder.decode(R(a,_,d));n.typedArrayToString=U,n.cstrToJs=function(a){const _=n.cstrlen(a);return _?U(z().HEAP8U,Number(a),Number(a)+_):_===null?_:""},n.jstrlen=function(a){if(typeof a!="string")return null;const _=a.length;let d=0;for(let S=0;S<_;++S){let W=a.charCodeAt(S);W>=55296&&W<=57343&&(W=65536+((W&1023)<<10)|a.charCodeAt(++S)&1023),W<=127?++d:W<=2047?d+=2:W<=65535?d+=3:d+=4}return d},n.jstrcpy=function(a,_,d=0,S=-1,W=!0){if((!_||!(_ instanceof Int8Array)&&!(_ instanceof Uint8Array))&&i("jstrcpy() target must be an Int8Array or Uint8Array."),S=Number(S),d=Number(d),S<0&&(S=_.length-d),!(S>0)||!(d>=0))return 0;let K=0,D=a.length;const h=d,P=d+S-(W?1:0);for(;K<D&&d<P;++K){let Q=a.charCodeAt(K);if(Q>=55296&&Q<=57343&&(Q=65536+((Q&1023)<<10)|a.charCodeAt(++K)&1023),Q<=127){if(d>=P)break;_[d++]=Q}else if(Q<=2047){if(d+1>=P)break;_[d++]=192|Q>>6,_[d++]=128|Q&63}else if(Q<=65535){if(d+2>=P)break;_[d++]=224|Q>>12,_[d++]=128|Q>>6&63,_[d++]=128|Q&63}else{if(d+3>=P)break;_[d++]=240|Q>>18,_[d++]=128|Q>>12&63,_[d++]=128|Q>>6&63,_[d++]=128|Q&63}}return W&&(_[d++]=0),d-h},n.cstrncpy=function(a,_,d){if((!a||!_)&&i("cstrncpy() does not accept NULL strings."),d<0)d=n.cstrlen(strPtr)+1;else if(!(d>0))return 0;const S=n.heap8u();let W=0,K;const D=Number(a),h=Number(_);for(;W<d&&(K=S[h+W]);++W)S[D+W]=K;return W<d&&(S[D+W++]=0),W},n.jstrToUintArray=(a,_=!1)=>p.utf8Encoder.encode(_?a+"\0":a);const w=(a,_)=>{(!(a.alloc instanceof Function)||!(a.dealloc instanceof Function))&&i("Object is missing alloc() and/or dealloc() function(s)","required by",_+"().")},O=function(a,_,d,S){if(w(n,S),typeof a!="string")return null;const W=p.utf8Encoder.encode(a),K=d(W.length+1);let D=K;try{const h=z().HEAP8U;return h.set(W,Number(K)),h[G(K,W.length)]=0,D=C,_?[K,W.length]:K}finally{D&&n.dealloc(D)}};n.allocCString=(a,_=!1)=>O(a,_,n.alloc,"allocCString()"),n.scopedAllocPush=function(){w(n,"scopedAllocPush");const a=[];return p.scopedAlloc.push(a),a},n.scopedAllocPop=function(a){w(n,"scopedAllocPop");const _=arguments.length?p.scopedAlloc.indexOf(a):p.scopedAlloc.length-1;_<0&&i("Invalid state object for scopedAllocPop()."),arguments.length===0&&(a=p.scopedAlloc[_]),p.scopedAlloc.splice(_,1);for(let d;d=a.pop();)n.functionEntry(d)?n.uninstallFunction(d):n.dealloc(d)},n.scopedAlloc=function(a){p.scopedAlloc.length||i("No scopedAllocPush() scope is active.");const _=J(n.alloc(a));return p.scopedAlloc.pushPtr(_)},Object.defineProperty(n.scopedAlloc,"level",{configurable:!1,enumerable:!1,get:()=>p.scopedAlloc.length,set:()=>i("The 'active' property is read-only.")}),n.scopedAllocCString=(a,_=!1)=>O(a,_,n.scopedAlloc,"scopedAllocCString()");const f=function(a,_){const d=n[a?"scopedAlloc":"alloc"]((_.length+1)*n.ptr.size);let S=0;return _.forEach(W=>{n.pokePtr(G(d,n.ptr.size*S++),n[a?"scopedAllocCString":"allocCString"](""+W))}),n.pokePtr(G(d,n.ptr.size*S),0),d};n.scopedAllocMainArgv=a=>f(!0,a),n.allocMainArgv=a=>f(!1,a),n.cArgvToJs=(a,_)=>{const d=[];for(let S=0;S<a;++S){const W=n.peekPtr(G(_,n.ptr.size*S));d.push(W?n.cstrToJs(W):null)}return d},n.scopedAllocCall=function(a){n.scopedAllocPush();try{return a()}finally{n.scopedAllocPop()}};const m=function(a,_,d){w(n,d);const S=_?"i64":r;let W=n[d](a*(_?8:u));if(n.poke(W,0,S),a===1)return W;const K=[W];for(let D=1;D<a;++D)W=G(W,_?8:u),K[D]=W,n.poke(W,0,S);return K};n.allocPtr=(a=1,_=!0)=>m(a,_,"alloc"),n.scopedAllocPtr=(a=1,_=!0)=>m(a,_,"scopedAlloc"),n.xGet=function(a){return n.exports[a]||i("Cannot find exported symbol:",a)};const q=(a,_)=>i(a+"() requires",_,"argument(s).");n.xCall=function(a,..._){const d=a instanceof Function?a:n.xGet(a);return d instanceof Function||i("Exported symbol",a,"is not a function."),d.length!==_.length&&q(d===a?d.name:a,d.length),arguments.length===2&&Array.isArray(arguments[1])?d.apply(null,arguments[1]):d.apply(null,_)},p.xWrap=Object.create(null),p.xWrap.convert=Object.create(null),p.xWrap.convert.arg=new Map,p.xWrap.convert.result=new Map;const j=p.xWrap.convert.arg,Y=p.xWrap.convert.result,oe=J;j.set("i64",F).set("i32",a=>a|0).set("i16",a=>(a|0)&65535).set("i8",a=>(a|0)&255).set("f32",a=>Number(a).valueOf()).set("float",j.get("f32")).set("f64",j.get("f32")).set("double",j.get("f64")).set("int",j.get("i32")).set("null",a=>a).set(null,j.get("null")).set("**",oe).set("*",oe),Y.set("*",oe).set("pointer",oe).set("number",a=>Number(a)).set("void",a=>{}).set(void 0,Y.get("void")).set("null",a=>a).set(null,Y.get("null"));for(const a of["i8","i16","i32","i64","int","f32","float","f64","double"])j.set(a+"*",oe),Y.set(a+"*",oe),Y.set(a,j.get(a)||i("Maintenance required: missing arg converter for",a));const be=a=>typeof a=="string"?n.scopedAllocCString(a):J(a);j.set("string",be).set("utf8",be),Y.set("string",a=>n.cstrToJs(a)).set("utf8",Y.get("string")).set("string:dealloc",a=>{try{return a?n.cstrToJs(a):null}finally{n.dealloc(a)}}).set("utf8:dealloc",Y.get("string:dealloc")).set("json",a=>JSON.parse(n.cstrToJs(a))).set("json:dealloc",a=>{try{return a?JSON.parse(n.cstrToJs(a)):null}finally{n.dealloc(a)}});const qe=class{constructor(a){this.name=a.name||"unnamed adapter"}convertArg(a,_,d){i("AbstractArgAdapter must be subclassed.")}};j.FuncPtrAdapter=class et extends qe{constructor(_){super(_),j.FuncPtrAdapter.warnOnUse&&console.warn("xArg.FuncPtrAdapter is an internal-only API","and is not intended to be invoked from","client-level code. Invoked with:",_),this.name=_.name||"unnamed",this.signature=_.signature,_.contextKey instanceof Function&&(this.contextKey=_.contextKey,_.bindScope||(_.bindScope="context")),this.bindScope=_.bindScope||i("FuncPtrAdapter options requires a bindScope (explicit or implied)."),et.bindScopes.indexOf(_.bindScope)<0&&i("Invalid options.bindScope ("+_.bindMod+") for FuncPtrAdapter. Expecting one of: ("+et.bindScopes.join(", ")+")"),this.isTransient=this.bindScope==="transient",this.isContext=this.bindScope==="context",this.isPermanent=this.bindScope==="permanent",this.singleton=this.bindScope==="singleton"?[]:void 0,this.callProxy=_.callProxy instanceof Function?_.callProxy:void 0}contextKey(_,d){return this}contextMap(_){const d=this.__cmap||(this.__cmap=new Map);let S=d.get(_);return S===void 0&&d.set(_,S=[]),S}convertArg(_,d,S){let W=this.singleton;if(!W&&this.isContext&&(W=this.contextMap(this.contextKey(d,S))),W&&W.length===2&&W[0]===_)return W[1];if(_ instanceof Function){this.callProxy&&(_=this.callProxy(_));const K=te(_,this.signature,this.isTransient);if(et.debugFuncInstall&&et.debugOut("FuncPtrAdapter installed",this,this.contextKey(d,S),"@"+K,_),W){if(W[1]){et.debugFuncInstall&&et.debugOut("FuncPtrAdapter uninstalling",this,this.contextKey(d,S),"@"+W[1],_);try{p.scopedAlloc.pushPtr(W[1])}catch{}}W[0]=arguments[0]||C,W[1]=K}return K}else if(n.isPtr(_)||_===null||_===void 0){if(W&&W[1]&&W[1]!==_){et.debugFuncInstall&&et.debugOut("FuncPtrAdapter uninstalling",this,this.contextKey(d,S),"@"+W[1],_);try{p.scopedAlloc.pushPtr(W[1])}catch{}W[0]=W[1]=_||C}return _||C}else throw new TypeError("Invalid FuncPtrAdapter argument type. Expecting a function pointer or a "+(this.name?this.name+" ":"")+"function matching signature "+this.signature+".")}},j.FuncPtrAdapter.warnOnUse=!1,j.FuncPtrAdapter.debugFuncInstall=!1,j.FuncPtrAdapter.debugOut=console.debug.bind(console),j.FuncPtrAdapter.bindScopes=["transient","context","singleton","permanent"];const fe=a=>j.get(a)||i("Argument adapter not found:",a),V=a=>Y.get(a)||i("Result adapter not found:",a);p.xWrap.convertArg=(a,..._)=>fe(a)(..._),p.xWrap.convertArgNoCheck=(a,..._)=>j.get(a)(..._),p.xWrap.convertResult=(a,_)=>a===null?_:a?V(a)(_):void 0,p.xWrap.convertResultNoCheck=(a,_)=>a===null?_:a?Y.get(a)(_):void 0,n.xWrap=function a(_,d,...S){arguments.length===3&&Array.isArray(arguments[2])&&(S=arguments[2]),n.isPtr(_)&&(_=n.functionEntry(_)||i("Function pointer not found in WASM function table."));const W=_ instanceof Function,K=W?_:n.xGet(_);if(W&&(_=K.name||"unnamed function"),S.length!==K.length&&q(_,K.length),K.length===0&&(d===null||d==="null"))return K;V(d);for(const h of S)h instanceof qe?j.set(h,(...P)=>h.convertArg(...P)):fe(h);const D=p.xWrap;return K.length===0?(...h)=>h.length?q(_,K.length):D.convertResult(d,K.call(null)):function(...h){h.length!==K.length&&q(_,K.length);const P=n.scopedAllocPush();try{let Q=0;for(a.debug&&console.debug("xWrap() preparing: resultType ",d,"xf",K,"argTypes",S,"args",h);Q<h.length;++Q)h[Q]=D.convertArgNoCheck(S[Q],h[Q],h,Q);return a.debug&&console.debug("xWrap() calling: resultType ",d,"xf",K,"argTypes",S,"args",h),D.convertResultNoCheck(d,K.apply(null,h))}finally{n.scopedAllocPop(P)}}};const I=function(a,_,d,S,W,K){if(typeof d=="string"){if(_===1)return K.get(d);if(_===2){if(S)S instanceof Function||i(W,"requires a function argument.");else return K.delete(d),a;return K.set(d,S),a}}i("Invalid arguments to",W)};return n.xWrap.resultAdapter=function a(_,d){return I(a,arguments.length,_,d,"resultAdapter()",Y)},n.xWrap.argAdapter=function a(_,d){return I(a,arguments.length,_,d,"argAdapter()",j)},n.xWrap.FuncPtrAdapter=j.FuncPtrAdapter,n.xCallWrapped=function(a,_,d,...S){return Array.isArray(arguments[3])&&(S=arguments[3]),n.xWrap(a,_,d||[]).apply(null,S||[])},n.xWrap.testConvertArg=p.xWrap.convertArg,n.xWrap.testConvertResult=p.xWrap.convertResult,n},globalThis.WhWasmUtilInstaller.yawl=(function(n){const i=()=>fetch(n.uri,{credentials:"same-origin"}),r=this,u=function(F){if(n.wasmUtilTarget){const T=(...C)=>{throw new Error(C.join(" "))},J=n.wasmUtilTarget;if(J.module=F.module,J.instance=F.instance,J.instance.exports.memory||(J.memory=n?.imports?.env?.memory||T("Missing 'memory' object!")),!J.alloc&&F.instance.exports.malloc){const C=F.instance.exports;J.alloc=function(G){return C.malloc(G)||T("Allocation of",G,"bytes failed.")},J.dealloc=function(G){G&&C.free(G)}}r(J)}return F.config=n,n.onload&&n.onload(F),F};return WebAssembly.instantiateStreaming?()=>WebAssembly.instantiateStreaming(i(),n.imports||{}).then(u):()=>i().then(F=>F.arrayBuffer()).then(F=>WebAssembly.instantiate(F,n.imports||{})).then(u)}).bind(globalThis.WhWasmUtilInstaller),globalThis.Jaccwabyt=function s(n){const i=(...A)=>{throw new Error(A.join(" "))};{let A=n.heap;A instanceof WebAssembly.Memory?A=(function(){return new Uint8Array(this.buffer)}).bind(A):A instanceof Function||i("config.heap must be WebAssembly.Memory instance or","a function which returns one."),n.heap=A}["alloc","dealloc"].forEach(function(A){n[A]instanceof Function||i("Config option '"+A+"' must be a function.")});const r=s,u=n.heap,F=n.alloc,T=n.dealloc;n.realloc;const J=n.log||console.debug.bind(console),C=n.memberPrefix||"",G=n.memberSuffix||"",p=globalThis.BigInt,z=globalThis.BigInt64Array,N=n.bigIntEnabled??!!z;let te;const y=n.pointerSize||n.ptrSize||(typeof(te=F(1))=="bigint"?8:4),b=n.pointerIR||n.ptrIR||(y===4?"i32":"i64");te&&(T(te),te=void 0),y!==4&&y!==8&&i("Invalid pointer size:",y),b!=="i32"&&b!=="i64"&&i("Invalid pointer representation:",b);const R=N&&p?A=>p(A||0):A=>i("BigInt support is disabled in this build."),U=b=="i32"?Number:R,w=U(0),O=function(...A){let $=w;for(let X=0;X<A.length;++X)$+=U(A[X]);return $},f=function(...A){return O(this.pointer,...A)};r.debugFlags||(r.__makeDebugFlags=function(A=null){A&&A.__flags&&(A=A.__flags);const $=function X(ie){return arguments.length===0?X.__flags:(ie<0?(delete X.__flags.getter,delete X.__flags.setter,delete X.__flags.alloc,delete X.__flags.dealloc):(X.__flags.getter=(1&ie)!==0,X.__flags.setter=(2&ie)!==0,X.__flags.alloc=(4&ie)!==0,X.__flags.dealloc=(8&ie)!==0),X._flags)};return Object.defineProperty($,"__flags",{iterable:!1,writable:!1,value:Object.create(A)}),A||$(0),$},r.debugFlags=r.__makeDebugFlags());const m=!0,q=A=>A[1]==="(",j=A=>A==="p"||A==="P"||A==="s",Y=A=>A==="P",oe=A=>A?q(A)?"p":A[0]:void 0,be=function(A){switch(oe(A)){case"c":case"C":return"i8";case"i":return"i32";case"p":case"P":case"s":return b;case"j":return"i64";case"f":return"float";case"d":return"double"}i("Unhandled signature IR:",A)},qe=function(A){switch(oe(A)){case"c":case"C":return 1;case"i":return 4;case"p":case"P":case"s":return y;case"j":return 8;case"f":return 4;case"d":return 8}i("Unhandled signature sizeof:",A)},fe=z?()=>!0:()=>i("BigInt64Array is not available."),V=function(A){switch(oe(A)){case"p":case"P":case"s":switch(y){case 4:return"getInt32";case 8:return fe()&&"getBigInt64"}break;case"i":return"getInt32";case"c":return"getInt8";case"C":return"getUint8";case"j":return fe()&&"getBigInt64";case"f":return"getFloat32";case"d":return"getFloat64"}i("Unhandled DataView getter for signature:",A)},I=function(A){switch(oe(A)){case"p":case"P":case"s":switch(y){case 4:return"setInt32";case 8:return fe()&&"setBigInt64"}break;case"i":return"setInt32";case"c":return"setInt8";case"C":return"setUint8";case"j":return fe()&&"setBigInt64";case"f":return"setFloat32";case"d":return"setFloat64"}i("Unhandled DataView setter for signature:",A)},a=function(A){switch(oe(A)){case"i":case"f":case"c":case"C":case"d":return Number;case"j":return R;case"p":case"P":case"s":switch(y){case 4:return Number;case 8:return R}break}i("Unhandled DataView set wrapper for signature:",A)},_=(A,$)=>A+"::"+$,d=function(A,$){return()=>i(_(A,$),"is read-only.")},S=function A($,X=!0){let ie=A.map.get($);return!ie&&X&&A.map.set($,ie=A.create($)),ie};S.map=new WeakMap,S.create=A=>Object.assign(Object.create(null),{o:A,p:void 0,ownsPointer:!1,zod:!1,xb:0});const W=A=>S.map.delete(A),K=A=>typeof A=="number"&&A===(A|0)&&A>=0,h=y===4?K:A=>typeof A=="bigint"&&A>=0||K(A),P=A=>h(A)&&A>0,Q=function(A,$,X){const ie=S($,!1);if(ie){if(W($),!X&&!(X=ie.p)){console.warn("Cannot(?) happen: __freeStruct() found no instanceInfo");return}if(Array.isArray($.ondispose)){let de;for(;de=$.ondispose.pop();)try{de instanceof Function?de.call($):de instanceof $e?de.dispose():h(de)&&T(de)}catch(ke){console.warn("ondispose() for",A.structName,"@",X,"threw. NOT propagating it.",ke)}}else if($.ondispose instanceof Function)try{$.ondispose()}catch(de){console.warn("ondispose() for",A.structName,"@",X,"threw. NOT propagating it.",de)}delete $.ondispose,A.debugFlags.__flags.dealloc&&J("debug.dealloc:",ie.ownsPointer?"":"EXTERNAL",A.structName,"instance:",A.structInfo.sizeof,"bytes @"+X),ie.ownsPointer&&((ie.zod||A.structInfo.zeroOnDispose)&&u().fill(0,Number(X),Number(X)+A.structInfo.sizeof+ie.xb),T(X))}},ne=()=>({configurable:!1,writable:!1,iterable:!1}),g=A=>({...ne(),value:A}),L=function($,X,ie){let de;const ke=Te=>{P(Te)||i("Invalid pointer value",arguments[0],"for",$.structName,"constructor.")};arguments.length>=3?ie&&typeof ie=="object"?(de=ie,ie=de?.wrap):(ke(ie),de={wrap:ie}):de={};const De=!ie;let Be=0,Ue=!1;if(ie)ke(ie),Ue=!!de?.takeOwnership;else{const Te=de?.extraBytes??0;(Te<0||Te!==(Te|0))&&i("Invalid extraBytes value:",de?.extraBytes),Be=$.structInfo.sizeof+Te,ie=F(Be)||i("Allocation of",$.structName,"structure failed."),Ue=!0}try{de?.debugFlags&&X.debugFlags(de.debugFlags),$.debugFlags.__flags.alloc&&J("debug.alloc:",De?"":"EXTERNAL",$.structName,"instance:",$.structInfo.sizeof,"bytes @"+ie),De&&u().fill(0,Number(ie),Number(ie)+Be);const Te=S(X);Te.p=ie,Te.ownsPointer=Ue,Te.xb=Be?Be-$.structInfo.sizeof:0,Te.zod=!!de?.zeroOnDispose,de?.ondispose&&de.ondispose!==ie&&X.addOnDispose(de.ondispose)}catch(Te){throw Q($,X,ie),Te}},H=function A($){return A.rxSig1??=/^[ipPsjfdcC]$/,A.rxSig2??=/^[vipPsjfdcC]\([ipPsjfdcC]*\)$/,A.rxSig1.test($)||A.rxSig2.test($)},re=(function(A){let $=this.get(A);return $||($=[Object.create(null),Object.create(null),Object.create(null)],this.set(A,$)),$}).bind(new WeakMap),Z=function(A,$,X,ie){const de=re(A)[$];return arguments.length===3?de[X]:ie?de[X]=ie:delete de[X]},ce=function(A,...$){return Z(this,0,A,...$)},ve=function(A,$){H($)&&i(A,"(",$,") collides with a data type signature.")},ue=function(A,...$){return ve("Setter adaptor",A),Z(this,1,A,...$)},E=function(A,...$){return ve("Struct adaptor",A),Z(this,2,A,...$)},x=function(A,$){const X=typeof $=="string"?Z(A,2,$):$;return typeof X!="object"&&i("Invalid struct mapping object. Arg =",$,JSON.stringify(X)),X},B=g(A=>C+A+G),ee=function(A,$,X=!0){let ie=A.members[$];if(!ie&&(C||G)){for(const de of Object.values(A.members))if(de.key===$){ie=de;break}!ie&&X&&i(_(A.name||A.structName,$),"is not a mapped struct member.")}return ie},ae=function A($,X,ie=!1){A._||(A._=ke=>ke.replace(/[^vipPsjrdcC]/g,"").replace(/[pPscC]/g,"i"));const de=ee($.structInfo,X,!0);return ie?A._(de.signature):de.signature},_e=g(function(){const A=[];for(const $ of Object.keys(this.structInfo.members))A.push(this.memberKey($));return A}),le=new TextDecoder("utf-8"),me=new TextEncoder,Ae=typeof SharedArrayBuffer>"u"?function(){}:SharedArrayBuffer,xe=function(A,$,X){return y===8&&($=Number($),X=Number(X)),le.decode(A.buffer instanceof Ae?A.slice($,X):A.subarray($,X))},Se=function(A,$,X=!1){const ie=ee(A.structInfo,$,X);return ie&&ie.signature.length===1&&ie.signature[0]==="s"?ie:!1},Me=function(A){A.signature!=="s"&&i("Invalid member type signature for C-string value:",JSON.stringify(A))},Ke=function($,X){const ie=ee($.structInfo,X,!0);Me(ie);const de=$[ie.key];if(!de)return null;let ke=de;const De=u();for(;De[ke]!==0;++ke);return de===ke?"":xe(De,de,ke)},ct=function(A,...$){A.ondispose?Array.isArray(A.ondispose)||(A.ondispose=[A.ondispose]):A.ondispose=[],A.ondispose.push(...$)},Ge=function(A){const $=me.encode(A),X=F($.length+1);X||i("Allocation error while duplicating string:",A);const ie=u();return ie.set($,Number(X)),ie[O(X,$.length)]=0,X},qt=function(A,$,X){const ie=ee(A.structInfo,$,!0);Me(ie);const de=Ge(X);return A[ie.key]=de,ct(A,de),A},$e=function($,X){arguments[2]!==g&&i("Do not call the StructType constructor","from client-level code."),Object.defineProperties(this,{structName:g($),structInfo:g(X)})};$e.prototype=Object.create(null,{dispose:g(function(){Q(this.constructor,this)}),lookupMember:g(function(A,$=!0){return ee(this.structInfo,A,$)}),memberToJsString:g(function(A){return Ke(this,A)}),memberIsString:g(function(A,$=!0){return Se(this,A,$)}),memberKey:B,memberKeys:_e,memberSignature:g(function(A,$=!1){return ae(this,A,$)}),memoryDump:g(function(){const A=this.pointer;return A?new Uint8Array(u().slice(Number(A),Number(A)+this.structInfo.sizeof)):null}),extraBytes:{configurable:!1,enumerable:!1,get:function(){return S(this,!1)?.xb??0}},zeroOnDispose:{configurable:!1,enumerable:!1,get:function(){return S(this,!1)?.zod??!!this.structInfo.zeroOnDispose}},pointer:{configurable:!1,enumerable:!1,get:function(){return S(this,!1)?.p},set:()=>i("Cannot assign the 'pointer' property of a struct.")},setMemberCString:g(function(A,$){return qt(this,A,$)})}),Object.assign($e.prototype,{addOnDispose:function(...A){return ct(this,...A),this}}),Object.defineProperties($e,{allocCString:g(Ge),isA:g(A=>A instanceof $e),hasExternalPointer:g(A=>{const $=S(A,!1);return!!($?.p&&!$?.ownsPointer)}),memberKey:B});const tt=function(A){return A.get||(A.adaptGet?Ve.adaptGet(A.adaptGet):void 0)},Tt=function(A){return A.set||(A.adaptSet?Ve.adaptSet(A.adaptSet):void 0)},Pr=function A($,X,ie){const de=A.innerStructs??=new Map,ke=$.memberKey(X);ie.signature!==void 0&&i("'signature' cannot be used on an embedded struct (",$.structName,".",ke,")."),Tt(ie)&&i("'set' and 'adaptSet' are not permitted for nested struct members."),ie.structName??=$.structName+"::"+X,ie.key=ke,ie.name=X,ie.constructor=this.call(this,ie.structName,ie);const De=tt(ie),Be=Object.assign(Object.create(null),{configurable:!1,enumerable:!1,set:d($.structName,ke),get:function(){const Ue=this.debugFlags.__flags,Te=this.pointer,je=Te+"."+ke;let he=de.get(je);return Ue.getter&&J("debug.getter: k =",je),he||(he=new ie.constructor(O(Te,ie.offset)),de.set(je,he),this.addOnDispose(()=>he.dispose()),he.addOnDispose(()=>de.delete(je))),De&&(he=De.apply(this,[he,ke])),Ue.getter&&J("debug.getter: result =",he),he}});Object.defineProperty($.prototype,ke,Be)},xr=function A($,X,ie){if(ie=x(this,ie),ie.members)return Pr.call(this,$,X,ie);if(!A.cache){A.cache={getters:{},setters:{},sw:{}};const je=["i","c","C","p","P","s","f","d","v()"];N&&je.push("j"),je.forEach(function(he){A.cache.getters[he]=V(he),A.cache.setters[he]=I(he),A.cache.sw[he]=a(he)}),A.sigCheck=function(he,Re,kt,sn){Object.prototype.hasOwnProperty.call(he,kt)&&i(he.structName,"already has a property named",kt+"."),H(sn)||i("Malformed signature for",_(he.structName,Re)+":",sn)}}const de=$.memberKey(X);A.sigCheck($.prototype,X,de,ie.signature),ie.key=de,ie.name=X;const ke=oe(ie.signature),De=_($.structName,de),Be=$.debugFlags.__flags,Ue=tt(ie),Te=Object.create(null);if(Te.configurable=!1,Te.enumerable=!1,Te.get=function(){Be.getter&&J("debug.getter:",A.cache.getters[ke],"for",be(ke),De,"@",this.pointer,"+",ie.offset,"sz",ie.sizeof);let je=new DataView(u().buffer,Number(this.pointer)+ie.offset,ie.sizeof)[A.cache.getters[ke]](0,m);return Ue&&(je=Ue.apply(this,[de,je])),Be.getter&&J("debug.getter:",De,"result =",je),je},ie.readOnly)Te.set=d($.prototype.structName,de);else{const je=Tt(ie);Te.set=function(he){Be.setter&&J("debug.setter:",A.cache.setters[ke],"for",be(ke),De,"@",this.pointer,"+",ie.offset,"sz",ie.sizeof,he),this.pointer||i("Cannot set native property on a disposed",this.structName,"instance."),je&&(he=je.apply(this,[de,he])),he==null?he=w:j(ie.signature)&&!h(he)&&(Y(ie.signature)&&he instanceof $e?(he=he.pointer||w,Be.setter&&J("debug.setter:",De,"resolved to",he)):i("Invalid value for pointer-type",De+".")),new DataView(u().buffer,Number(this.pointer)+ie.offset,ie.sizeof)[A.cache.setters[ke]](0,A.cache.sw[ke](he),m)}}Object.defineProperty($.prototype,de,Te)},rn=function A($,X,ie=Object.create(null)){const de=function he(Re){this instanceof he||i("The",$,"constructor may only be called via 'new'."),L(he,this,...arguments)},ke=this,De=he=>typeof he=="string"&&H(he)?{signature:he}:x(ke,he);arguments.length===1?(X=De($),$=X.structName||X.name):arguments.length===2?(X=De(X),X.name??=$):X=De(X),$??=X.structName,$??=ie.structName,$||i("One of 'name' or 'structName' are required."),X.adapt&&(Object.keys(X.adapt.struct||{}).forEach(he=>{E.call(A,he,X.adapt.struct[he])}),Object.keys(X.adapt.set||{}).forEach(he=>{ue.call(A,he,X.adapt.set[he])}),Object.keys(X.adapt.get||{}).forEach(he=>{ce.call(A,he,X.adapt.get[he])})),!X.members&&!X.sizeof&&(X.sizeof=qe(X.signature));const Be=g(r.__makeDebugFlags(Ve.debugFlags));Object.defineProperties(de,{debugFlags:Be,isA:g(he=>he instanceof de),memberKey:B,memberKeys:_e,structInfo:g(X),structName:g($),ptrAdd:g(O)}),de.prototype=new $e($,X,g),Object.defineProperties(de.prototype,{debugFlags:Be,constructor:g(de),ptrAdd:g(f)});let Ue=!1,Te=0;const je=!!X.autoCalcSizeOffset;return je||X.sizeof||i($,"description is missing its sizeof property."),X.offset??=0,Object.keys(X.members||{}).forEach(he=>{let Re=De(X.members[he]);!Re.members&&!Re.sizeof&&(Re.sizeof=qe(Re.signature),Re.sizeof||i(_($,he),"is missing a sizeof property.",Re)),Re.offset===void 0&&(je?Re.offset=Te:i(_($,he),"is missing its offset.",JSON.stringify(Re))),X.members[he]=Re,(!Ue||Ue.offset<Re.offset)&&(Ue=Re);const kt=!!Re.autoCalc;je&&(Re.autoCalcSizeOffset=!0),xr.call(ke,de,he,Re),kt?Re.autoCalcSizeOffset=!0:delete Re.autoCalcSizeOffset,Te+=Re.sizeof}),Ue||i("No member property descriptions found."),X.sizeof||(X.sizeof=Te),X.sizeof===1?X.signature==="c"||X.signature==="C"||i("Unexpected sizeof==1 member",_($,k),"with signature",X.signature):(X.sizeof%4!==0&&(console.warn("Invalid struct member description",X),i($,"sizeof is not aligned. sizeof="+X.sizeof)),X.offset%4!==0&&(console.warn("Invalid struct member description",X),i($,"offset is not aligned. offset="+X.offset))),X.sizeof<Te&&(console.warn("Suspect struct description:",X,"offset =",Te),i("Mismatch in the calculated vs. the provided sizeof/offset info.","Expected sizeof",Te,"but got",X.sizeof,"for",X)),delete X.autoCalcSizeOffset,de},Ve=function A($,X){return arguments.length==1?rn.call(A,$):rn.call(A,$,X)};return Ve.StructType=$e,Ve.config=n,Ve.allocCString=Ge,Ve.adaptGet=ce,Ve.adaptSet=ue,Ve.adaptStruct=E,Ve.ptrAdd=O,Ve.debugFlags||(Ve.debugFlags=r.__makeDebugFlags(r.debugFlags)),Ve},globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const n=(...y)=>{throw new Error(y.join(" "))},i=s.capi,r=s.wasm,u=s.util;globalThis.WhWasmUtilInstaller(r),delete globalThis.WhWasmUtilInstaller;const F={core:[["sqlite3_aggregate_context","void*","sqlite3_context*","int"],["sqlite3_bind_double","int","sqlite3_stmt*","int","f64"],["sqlite3_bind_int","int","sqlite3_stmt*","int","int"],["sqlite3_bind_null",void 0,"sqlite3_stmt*","int"],["sqlite3_bind_parameter_count","int","sqlite3_stmt*"],["sqlite3_bind_parameter_index","int","sqlite3_stmt*","string"],["sqlite3_bind_parameter_name","string","sqlite3_stmt*","int"],["sqlite3_bind_pointer","int","sqlite3_stmt*","int","*","string:static","*"],["sqlite3_busy_handler","int",["sqlite3*",new r.xWrap.FuncPtrAdapter({signature:"i(pi)",contextKey:(y,b)=>y[0]}),"*"]],["sqlite3_busy_timeout","int","sqlite3*","int"],["sqlite3_changes","int","sqlite3*"],["sqlite3_clear_bindings","int","sqlite3_stmt*"],["sqlite3_collation_needed","int","sqlite3*","*","*"],["sqlite3_column_blob","*","sqlite3_stmt*","int"],["sqlite3_column_bytes","int","sqlite3_stmt*","int"],["sqlite3_column_count","int","sqlite3_stmt*"],["sqlite3_column_decltype","string","sqlite3_stmt*","int"],["sqlite3_column_double","f64","sqlite3_stmt*","int"],["sqlite3_column_int","int","sqlite3_stmt*","int"],["sqlite3_column_name","string","sqlite3_stmt*","int"],["sqlite3_column_type","int","sqlite3_stmt*","int"],["sqlite3_column_value","sqlite3_value*","sqlite3_stmt*","int"],["sqlite3_commit_hook","void*",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"sqlite3_commit_hook",signature:"i(p)",contextKey:y=>y[0]}),"*"]],["sqlite3_compileoption_get","string","int"],["sqlite3_compileoption_used","int","string"],["sqlite3_complete","int","string:flexible"],["sqlite3_context_db_handle","sqlite3*","sqlite3_context*"],["sqlite3_data_count","int","sqlite3_stmt*"],["sqlite3_db_filename","string","sqlite3*","string"],["sqlite3_db_handle","sqlite3*","sqlite3_stmt*"],["sqlite3_db_name","string","sqlite3*","int"],["sqlite3_db_readonly","int","sqlite3*","string"],["sqlite3_db_status","int","sqlite3*","int","*","*","int"],["sqlite3_errcode","int","sqlite3*"],["sqlite3_errmsg","string","sqlite3*"],["sqlite3_error_offset","int","sqlite3*"],["sqlite3_errstr","string","int"],["sqlite3_exec","int",["sqlite3*","string:flexible",new r.xWrap.FuncPtrAdapter({signature:"i(pipp)",bindScope:"transient",callProxy:y=>{let b;return(R,U,w,O)=>{try{const f=r.cArgvToJs(U,w);return b||(b=r.cArgvToJs(U,O)),y(f,b)|0}catch(f){return f.resultCode||i.SQLITE_ERROR}}}}),"*","**"]],["sqlite3_expanded_sql","string","sqlite3_stmt*"],["sqlite3_extended_errcode","int","sqlite3*"],["sqlite3_extended_result_codes","int","sqlite3*","int"],["sqlite3_file_control","int","sqlite3*","string","int","*"],["sqlite3_finalize","int","sqlite3_stmt*"],["sqlite3_free",void 0,"*"],["sqlite3_get_autocommit","int","sqlite3*"],["sqlite3_get_auxdata","*","sqlite3_context*","int"],["sqlite3_initialize",void 0],["sqlite3_interrupt",void 0,"sqlite3*"],["sqlite3_is_interrupted","int","sqlite3*"],["sqlite3_keyword_count","int"],["sqlite3_keyword_name","int",["int","**","*"]],["sqlite3_keyword_check","int",["string","int"]],["sqlite3_libversion","string"],["sqlite3_libversion_number","int"],["sqlite3_limit","int",["sqlite3*","int","int"]],["sqlite3_malloc","*","int"],["sqlite3_next_stmt","sqlite3_stmt*",["sqlite3*","sqlite3_stmt*"]],["sqlite3_open","int","string","*"],["sqlite3_open_v2","int","string","*","int","string"],["sqlite3_realloc","*","*","int"],["sqlite3_reset","int","sqlite3_stmt*"],["sqlite3_result_blob",void 0,"sqlite3_context*","*","int","*"],["sqlite3_result_double",void 0,"sqlite3_context*","f64"],["sqlite3_result_error",void 0,"sqlite3_context*","string","int"],["sqlite3_result_error_code",void 0,"sqlite3_context*","int"],["sqlite3_result_error_nomem",void 0,"sqlite3_context*"],["sqlite3_result_error_toobig",void 0,"sqlite3_context*"],["sqlite3_result_int",void 0,"sqlite3_context*","int"],["sqlite3_result_null",void 0,"sqlite3_context*"],["sqlite3_result_pointer",void 0,"sqlite3_context*","*","string:static","*"],["sqlite3_result_subtype",void 0,"sqlite3_value*","int"],["sqlite3_result_text",void 0,"sqlite3_context*","string","int","*"],["sqlite3_result_zeroblob",void 0,"sqlite3_context*","int"],["sqlite3_rollback_hook","void*",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"sqlite3_rollback_hook",signature:"v(p)",contextKey:y=>y[0]}),"*"]],["sqlite3_set_auxdata",void 0,["sqlite3_context*","int","*","*"]],["sqlite3_set_errmsg","int","sqlite3*","int","string"],["sqlite3_shutdown",void 0],["sqlite3_sourceid","string"],["sqlite3_sql","string","sqlite3_stmt*"],["sqlite3_status","int","int","*","*","int"],["sqlite3_step","int","sqlite3_stmt*"],["sqlite3_stmt_busy","int","sqlite3_stmt*"],["sqlite3_stmt_readonly","int","sqlite3_stmt*"],["sqlite3_stmt_status","int","sqlite3_stmt*","int","int"],["sqlite3_strglob","int","string","string"],["sqlite3_stricmp","int","string","string"],["sqlite3_strlike","int","string","string","int"],["sqlite3_strnicmp","int","string","string","int"],["sqlite3_table_column_metadata","int","sqlite3*","string","string","string","**","**","*","*","*"],["sqlite3_total_changes","int","sqlite3*"],["sqlite3_trace_v2","int",["sqlite3*","int",new r.xWrap.FuncPtrAdapter({name:"sqlite3_trace_v2::callback",signature:"i(ippp)",contextKey:(y,b)=>y[0]}),"*"]],["sqlite3_txn_state","int",["sqlite3*","string"]],["sqlite3_uri_boolean","int","sqlite3_filename","string","int"],["sqlite3_uri_key","string","sqlite3_filename","int"],["sqlite3_uri_parameter","string","sqlite3_filename","string"],["sqlite3_user_data","void*","sqlite3_context*"],["sqlite3_value_blob","*","sqlite3_value*"],["sqlite3_value_bytes","int","sqlite3_value*"],["sqlite3_value_double","f64","sqlite3_value*"],["sqlite3_value_dup","sqlite3_value*","sqlite3_value*"],["sqlite3_value_free",void 0,"sqlite3_value*"],["sqlite3_value_frombind","int","sqlite3_value*"],["sqlite3_value_int","int","sqlite3_value*"],["sqlite3_value_nochange","int","sqlite3_value*"],["sqlite3_value_numeric_type","int","sqlite3_value*"],["sqlite3_value_pointer","*","sqlite3_value*","string:static"],["sqlite3_value_subtype","int","sqlite3_value*"],["sqlite3_value_type","int","sqlite3_value*"],["sqlite3_vfs_find","*","string"],["sqlite3_vfs_register","int","sqlite3_vfs*","int"],["sqlite3_vfs_unregister","int","sqlite3_vfs*"]],int64:[["sqlite3_bind_int64","int",["sqlite3_stmt*","int","i64"]],["sqlite3_changes64","i64",["sqlite3*"]],["sqlite3_column_int64","i64",["sqlite3_stmt*","int"]],["sqlite3_deserialize","int","sqlite3*","string","*","i64","i64","int"],["sqlite3_last_insert_rowid","i64",["sqlite3*"]],["sqlite3_malloc64","*","i64"],["sqlite3_msize","i64","*"],["sqlite3_overload_function","int",["sqlite3*","string","int"]],["sqlite3_realloc64","*","*","i64"],["sqlite3_result_int64",void 0,"*","i64"],["sqlite3_result_zeroblob64","int","*","i64"],["sqlite3_serialize","*","sqlite3*","string","*","int"],["sqlite3_set_last_insert_rowid",void 0,["sqlite3*","i64"]],["sqlite3_status64","int","int","*","*","int"],["sqlite3_db_status64","int","sqlite3*","int","*","*","int"],["sqlite3_total_changes64","i64",["sqlite3*"]],["sqlite3_update_hook","*",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"sqlite3_update_hook::callback",signature:"v(pippj)",contextKey:y=>y[0],callProxy:y=>(b,R,U,w,O)=>{y(b,R,r.cstrToJs(U),r.cstrToJs(w),O)}}),"*"]],["sqlite3_uri_int64","i64",["sqlite3_filename","string","i64"]],["sqlite3_value_int64","i64","sqlite3_value*"]],wasmInternal:[["sqlite3__wasm_db_reset","int","sqlite3*"],["sqlite3__wasm_db_vfs","sqlite3_vfs*","sqlite3*","string"],["sqlite3__wasm_vfs_create_file","int","sqlite3_vfs*","string","*","int"],["sqlite3__wasm_posix_create_file","int","string","*","int"],["sqlite3__wasm_vfs_unlink","int","sqlite3_vfs*","string"],["sqlite3__wasm_qfmt_token","string:dealloc","string","int"]]};if(r.exports.sqlite3_progress_handler&&F.core.push(["sqlite3_progress_handler",void 0,["sqlite3*","int",new r.xWrap.FuncPtrAdapter({name:"xProgressHandler",signature:"i(p)",bindScope:"context",contextKey:(y,b)=>y[0]}),"*"]]),r.exports.sqlite3_stmt_explain&&F.core.push(["sqlite3_stmt_explain","int","sqlite3_stmt*","int"],["sqlite3_stmt_isexplain","int","sqlite3_stmt*"]),r.exports.sqlite3_set_authorizer&&F.core.push(["sqlite3_set_authorizer","int",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"sqlite3_set_authorizer::xAuth",signature:"i(pissss)",contextKey:(y,b)=>y[0],callProxy:y=>(b,R,U,w,O,f)=>{try{return U=U&&r.cstrToJs(U),w=w&&r.cstrToJs(w),O=O&&r.cstrToJs(O),f=f&&r.cstrToJs(f),y(b,R,U,w,O,f)|0}catch(m){return m.resultCode||i.SQLITE_ERROR}}}),"*"]]),r.exports.sqlite3_column_origin_name&&F.core.push(["sqlite3_column_database_name","string","sqlite3_stmt*","int"],["sqlite3_column_origin_name","string","sqlite3_stmt*","int"],["sqlite3_column_table_name","string","sqlite3_stmt*","int"]),r.bigIntEnabled&&r.exports.sqlite3_declare_vtab&&F.int64.push(["sqlite3_create_module","int",["sqlite3*","string","sqlite3_module*","*"]],["sqlite3_create_module_v2","int",["sqlite3*","string","sqlite3_module*","*","*"]],["sqlite3_declare_vtab","int",["sqlite3*","string:flexible"]],["sqlite3_drop_modules","int",["sqlite3*","**"]],["sqlite3_vtab_collation","string","sqlite3_index_info*","int"],["sqlite3_vtab_distinct","int","sqlite3_index_info*"],["sqlite3_vtab_in","int","sqlite3_index_info*","int","int"],["sqlite3_vtab_in_first","int","sqlite3_value*","**"],["sqlite3_vtab_in_next","int","sqlite3_value*","**"],["sqlite3_vtab_nochange","int","sqlite3_context*"],["sqlite3_vtab_on_conflict","int","sqlite3*"],["sqlite3_vtab_rhs_value","int","sqlite3_index_info*","int","**"]),r.bigIntEnabled&&r.exports.sqlite3_preupdate_hook&&F.int64.push(["sqlite3_preupdate_blobwrite","int","sqlite3*"],["sqlite3_preupdate_count","int","sqlite3*"],["sqlite3_preupdate_depth","int","sqlite3*"],["sqlite3_preupdate_hook","*",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"sqlite3_preupdate_hook",signature:"v(ppippjj)",contextKey:y=>y[0],callProxy:y=>(b,R,U,w,O,f,m)=>{y(b,R,U,r.cstrToJs(w),r.cstrToJs(O),f,m)}}),"*"]],["sqlite3_preupdate_new","int",["sqlite3*","int","**"]],["sqlite3_preupdate_old","int",["sqlite3*","int","**"]]),r.bigIntEnabled&&r.exports.sqlite3changegroup_add&&r.exports.sqlite3session_create&&r.exports.sqlite3_preupdate_hook){const y={signature:"i(ps)",callProxy:b=>(R,U)=>{try{return b(R,r.cstrToJs(U))|0}catch(w){return w.resultCode||i.SQLITE_ERROR}}};F.int64.push(["sqlite3changegroup_add","int",["sqlite3_changegroup*","int","void*"]],["sqlite3changegroup_add_strm","int",["sqlite3_changegroup*",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3changegroup_delete",void 0,["sqlite3_changegroup*"]],["sqlite3changegroup_new","int",["**"]],["sqlite3changegroup_output","int",["sqlite3_changegroup*","int*","**"]],["sqlite3changegroup_output_strm","int",["sqlite3_changegroup*",new r.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply","int",["sqlite3*","int","void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...y}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply_strm","int",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...y}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply_v2","int",["sqlite3*","int","void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...y}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_apply_v2_strm","int",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...y}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_apply_v3","int",["sqlite3*","int","void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",signature:"i(pp)",bindScope:"transient"}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_apply_v3_strm","int",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",signature:"i(pp)",bindScope:"transient"}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_concat","int",["int","void*","int","void*","int*","**"]],["sqlite3changeset_concat_strm","int",[new r.xWrap.FuncPtrAdapter({name:"xInputA",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xInputB",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_conflict","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_finalize","int",["sqlite3_changeset_iter*"]],["sqlite3changeset_fk_conflicts","int",["sqlite3_changeset_iter*","int*"]],["sqlite3changeset_invert","int",["int","void*","int*","**"]],["sqlite3changeset_invert_strm","int",[new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_new","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_next","int",["sqlite3_changeset_iter*"]],["sqlite3changeset_old","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_op","int",["sqlite3_changeset_iter*","**","int*","int*","int*"]],["sqlite3changeset_pk","int",["sqlite3_changeset_iter*","**","int*"]],["sqlite3changeset_start","int",["**","int","*"]],["sqlite3changeset_start_strm","int",["**",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3changeset_start_v2","int",["**","int","*","int"]],["sqlite3changeset_start_v2_strm","int",["**",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*","int"]],["sqlite3session_attach","int",["sqlite3_session*","string"]],["sqlite3session_changeset","int",["sqlite3_session*","int*","**"]],["sqlite3session_changeset_size","i64",["sqlite3_session*"]],["sqlite3session_changeset_strm","int",["sqlite3_session*",new r.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3session_config","int",["int","void*"]],["sqlite3session_create","int",["sqlite3*","string","**"]],["sqlite3session_diff","int",["sqlite3_session*","string","string","**"]],["sqlite3session_enable","int",["sqlite3_session*","int"]],["sqlite3session_indirect","int",["sqlite3_session*","int"]],["sqlite3session_isempty","int",["sqlite3_session*"]],["sqlite3session_memory_used","i64",["sqlite3_session*"]],["sqlite3session_object_config","int",["sqlite3_session*","int","void*"]],["sqlite3session_patchset","int",["sqlite3_session*","*","**"]],["sqlite3session_patchset_strm","int",["sqlite3_session*",new r.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3session_table_filter",void 0,["sqlite3_session*",new r.xWrap.FuncPtrAdapter({name:"xFilter",...y,contextKey:(b,R)=>b[0]}),"*"]])}s.StructBinder=globalThis.Jaccwabyt({heap:r.heap8u,alloc:r.alloc,dealloc:r.dealloc,bigIntEnabled:r.bigIntEnabled,pointerIR:r.ptr.ir,memberPrefix:"$"}),delete globalThis.Jaccwabyt;{const y=r.xWrap.argAdapter("string");r.xWrap.argAdapter("string:flexible",w=>y(u.flexibleString(w))),r.xWrap.argAdapter("string:static",(function(w){return r.isPtr(w)?w:(w=""+w,this[w]||(this[w]=r.allocCString(w)))}).bind(Object.create(null)));const b=r.xWrap.argAdapter("*"),R=function(){};r.xWrap.argAdapter("sqlite3_filename",b)("sqlite3_context*",b)("sqlite3_value*",b)("void*",b)("sqlite3_changegroup*",b)("sqlite3_changeset_iter*",b)("sqlite3_session*",b)("sqlite3_stmt*",w=>b(w instanceof(s?.oo1?.Stmt||R)?w.pointer:w))("sqlite3*",w=>b(w instanceof(s?.oo1?.DB||R)?w.pointer:w))("sqlite3_vfs*",w=>typeof w=="string"?i.sqlite3_vfs_find(w)||s.SQLite3Error.toss(i.SQLITE_NOTFOUND,"Unknown sqlite3_vfs name:",w):b(w instanceof(i.sqlite3_vfs||R)?w.pointer:w)),r.exports.sqlite3_declare_vtab&&r.xWrap.argAdapter("sqlite3_index_info*",w=>b(w instanceof(i.sqlite3_index_info||R)?w.pointer:w))("sqlite3_module*",w=>b(w instanceof(i.sqlite3_module||R)?w.pointer:w));const U=r.xWrap.resultAdapter("*");r.xWrap.resultAdapter("sqlite3*",U)("sqlite3_context*",U)("sqlite3_stmt*",U)("sqlite3_value*",U)("sqlite3_vfs*",U)("void*",U);for(const w of F.core)i[w[0]]=r.xWrap.apply(null,w);for(const w of F.wasmInternal)u[w[0]]=r.xWrap.apply(null,w);for(const w of F.int64)i[w[0]]=r.bigIntEnabled?r.xWrap.apply(null,w):()=>n(w[0]+"() is unavailable due to lack","of BigInt support in this build.");delete F.core,delete F.int64,delete F.wasmInternal,u.sqlite3__wasm_db_error=function(w,O,f){return w?(O instanceof s.WasmAllocError?(O=i.SQLITE_NOMEM,f=0):O instanceof Error&&(f=f||""+O,O=O.resultCode||i.SQLITE_ERROR),i.sqlite3_set_errmsg(w,O,f)||O):i.SQLITE_MISUSE}}{const y=r.xCall("sqlite3__wasm_enum_json");y||n("Maintenance required: increase sqlite3__wasm_enum_json()'s","static buffer size!"),r.ctype=JSON.parse(r.cstrToJs(y));const b=["access","authorizer","blobFinalizers","changeset","config","dataTypes","dbConfig","dbStatus","encodings","fcntl","flock","ioCap","limits","openFlags","prepareFlags","resultCodes","sqlite3Status","stmtStatus","syncFlags","trace","txnState","udfFlags","version"];r.bigIntEnabled&&b.push("serialize","session","vtab");for(const w of b)for(const O of Object.entries(r.ctype[w]))i[O[0]]=O[1];r.functionEntry(i.SQLITE_WASM_DEALLOC)||n("Internal error: cannot resolve exported function","entry SQLITE_WASM_DEALLOC (=="+i.SQLITE_WASM_DEALLOC+").");const R=Object.create(null);for(const w of Object.entries(r.ctype.resultCodes))R[w[1]]=w[0];i.sqlite3_js_rc_str=w=>R[w];const U=Object.assign(Object.create(null),{WasmTestStruct:!0,sqlite3_index_info:!r.bigIntEnabled,sqlite3_index_constraint:!r.bigIntEnabled,sqlite3_index_orderby:!r.bigIntEnabled,sqlite3_index_constraint_usage:!r.bigIntEnabled});for(const w of r.ctype.structs)U[w.name]||(i[w.name]=s.StructBinder(w));if(i.sqlite3_index_info){for(const w of["sqlite3_index_constraint","sqlite3_index_orderby","sqlite3_index_constraint_usage"])i.sqlite3_index_info[w]=i[w],delete i[w];i.sqlite3_vtab_config=r.xWrap("sqlite3__wasm_vtab_config","int",["sqlite3*","int","int"])}}const T=(y,b,R)=>u.sqlite3__wasm_db_error(y,i.SQLITE_MISUSE,b+"() requires "+R+" argument"+(R===1?"":"s")+"."),J=y=>u.sqlite3__wasm_db_error(y,i.SQLITE_FORMAT,"SQLITE_UTF8 is the only supported encoding."),C=y=>r.xWrap.argAdapter("sqlite3*")(y),G=y=>r.isPtr(y)?r.cstrToJs(y):y,p=(function(y,b){y=C(y);let R=this.dbMap.get(y);if(b)!R&&b>0&&this.dbMap.set(y,R=Object.create(null));else return this.dbMap.delete(y),R;return R}).bind(Object.assign(Object.create(null),{dbMap:new Map}));p.addCollation=function(y,b){const R=p(y,1);R.collation||(R.collation=new Set),R.collation.add(G(b).toLowerCase())},p._addUDF=function(y,b,R,U){b=G(b).toLowerCase();let w=U.get(b);w||U.set(b,w=new Set),w.add(R<0?-1:R)},p.addFunction=function(y,b,R){const U=p(y,1);U.udf||(U.udf=new Map),this._addUDF(y,b,R,U.udf)},r.exports.sqlite3_create_window_function&&(p.addWindowFunc=function(y,b,R){const U=p(y,1);U.wudf||(U.wudf=new Map),this._addUDF(y,b,R,U.wudf)}),p.cleanup=function(y){y=C(y);for(const U of[["sqlite3_busy_handler",3],["sqlite3_commit_hook",3],["sqlite3_preupdate_hook",3],["sqlite3_progress_handler",4],["sqlite3_rollback_hook",3],["sqlite3_set_authorizer",3],["sqlite3_trace_v2",4],["sqlite3_update_hook",3]]){const[w,O]=U;if(!r.exports[w])continue;const f=[y];f.length=O;try{i[w](...f)}catch(m){s.config.warn("close-time call of",w+"(",f,") threw:",m)}}const b=p(y,0);if(!b)return;if(b.collation){for(const U of b.collation)try{i.sqlite3_create_collation_v2(y,U,i.SQLITE_UTF8,0,0,0)}catch{}delete b.collation}let R;for(R=0;R<2;++R){const U=R?b.wudf:b.udf;if(!U)continue;const w=R?i.sqlite3_create_window_function:i.sqlite3_create_function_v2;for(const O of U){const f=O[0],m=O[1],q=[y,f,0,i.SQLITE_UTF8,0,0,0,0,0];R&&q.push(0);for(const j of m)try{q[2]=j,w.apply(null,q)}catch{}m.clear()}U.clear()}delete b.udf,delete b.wudf};{const y=r.xWrap("sqlite3_close_v2","int","sqlite3*");i.sqlite3_close_v2=function(b){if(arguments.length!==1)return T(b,"sqlite3_close_v2",1);if(b)try{p.cleanup(b)}catch{}return y(b)}}if(i.sqlite3session_create){const y=r.xWrap("sqlite3session_delete",void 0,["sqlite3_session*"]);i.sqlite3session_delete=function(b){if(arguments.length!==1)return T(pDb,"sqlite3session_delete",1);b&&i.sqlite3session_table_filter(b,0,0),y(b)}}{const y=(R,U)=>"argv["+U+"]:"+R[0]+":"+r.cstrToJs(R[1]).toLowerCase(),b=r.xWrap("sqlite3_create_collation_v2","int",["sqlite3*","string","int","*",new r.xWrap.FuncPtrAdapter({name:"xCompare",signature:"i(pipip)",contextKey:y}),new r.xWrap.FuncPtrAdapter({name:"xDestroy",signature:"v(p)",contextKey:y})]);i.sqlite3_create_collation_v2=function(R,U,w,O,f,m){if(arguments.length!==6)return T(R,"sqlite3_create_collation_v2",6);if((w&15)===0)w|=i.SQLITE_UTF8;else if(i.SQLITE_UTF8!==(w&15))return J(R);try{const q=b(R,U,w,O,f,m);return q===0&&f instanceof Function&&p.addCollation(R,U),q}catch(q){return u.sqlite3__wasm_db_error(R,q)}},i.sqlite3_create_collation=(R,U,w,O,f)=>arguments.length===5?i.sqlite3_create_collation_v2(R,U,w,O,f,0):T(R,"sqlite3_create_collation",5)}{const y=function(w,O){return w[0]+":"+(w[2]<0?-1:w[2])+":"+O+":"+r.cstrToJs(w[1]).toLowerCase()},b=Object.assign(Object.create(null),{xInverseAndStep:{signature:"v(pip)",contextKey:y,callProxy:w=>(O,f,m)=>{try{w(O,...i.sqlite3_values_to_js(f,m))}catch(q){i.sqlite3_result_error_js(O,q)}}},xFinalAndValue:{signature:"v(p)",contextKey:y,callProxy:w=>O=>{try{i.sqlite3_result_js(O,w(O))}catch(f){i.sqlite3_result_error_js(O,f)}}},xFunc:{signature:"v(pip)",contextKey:y,callProxy:w=>(O,f,m)=>{try{i.sqlite3_result_js(O,w(O,...i.sqlite3_values_to_js(f,m)))}catch(q){i.sqlite3_result_error_js(O,q)}}},xDestroy:{signature:"v(p)",contextKey:y,callProxy:w=>O=>{try{w(O)}catch(f){console.error("UDF xDestroy method threw:",f)}}}}),R=r.xWrap("sqlite3_create_function_v2","int",["sqlite3*","string","int","int","*",new r.xWrap.FuncPtrAdapter({name:"xFunc",...b.xFunc}),new r.xWrap.FuncPtrAdapter({name:"xStep",...b.xInverseAndStep}),new r.xWrap.FuncPtrAdapter({name:"xFinal",...b.xFinalAndValue}),new r.xWrap.FuncPtrAdapter({name:"xDestroy",...b.xDestroy})]),U=r.exports.sqlite3_create_window_function?r.xWrap("sqlite3_create_window_function","int",["sqlite3*","string","int","int","*",new r.xWrap.FuncPtrAdapter({name:"xStep",...b.xInverseAndStep}),new r.xWrap.FuncPtrAdapter({name:"xFinal",...b.xFinalAndValue}),new r.xWrap.FuncPtrAdapter({name:"xValue",...b.xFinalAndValue}),new r.xWrap.FuncPtrAdapter({name:"xInverse",...b.xInverseAndStep}),new r.xWrap.FuncPtrAdapter({name:"xDestroy",...b.xDestroy})]):void 0;i.sqlite3_create_function_v2=function w(O,f,m,q,j,Y,oe,be,qe){if(w.length!==arguments.length)return T(O,"sqlite3_create_function_v2",w.length);if((q&15)===0)q|=i.SQLITE_UTF8;else if(i.SQLITE_UTF8!==(q&15))return J(O);try{const fe=R(O,f,m,q,j,Y,oe,be,qe);return fe===0&&(Y instanceof Function||oe instanceof Function||be instanceof Function||qe instanceof Function)&&p.addFunction(O,f,m),fe}catch(fe){return console.error("sqlite3_create_function_v2() setup threw:",fe),u.sqlite3__wasm_db_error(O,fe,"Creation of UDF threw: "+fe)}},i.sqlite3_create_function=function w(O,f,m,q,j,Y,oe,be){return w.length===arguments.length?i.sqlite3_create_function_v2(O,f,m,q,j,Y,oe,be,0):T(O,"sqlite3_create_function",w.length)},U?i.sqlite3_create_window_function=function w(O,f,m,q,j,Y,oe,be,qe,fe){if(w.length!==arguments.length)return T(O,"sqlite3_create_window_function",w.length);if((q&15)===0)q|=i.SQLITE_UTF8;else if(i.SQLITE_UTF8!==(q&15))return J(O);try{const V=U(O,f,m,q,j,Y,oe,be,qe,fe);return V===0&&(Y instanceof Function||oe instanceof Function||be instanceof Function||qe instanceof Function||fe instanceof Function)&&p.addWindowFunc(O,f,m),V}catch(V){return console.error("sqlite3_create_window_function() setup threw:",V),u.sqlite3__wasm_db_error(O,V,"Creation of UDF threw: "+V)}}:delete i.sqlite3_create_window_function,i.sqlite3_create_function_v2.udfSetResult=i.sqlite3_create_function.udfSetResult=i.sqlite3_result_js,i.sqlite3_create_window_function&&(i.sqlite3_create_window_function.udfSetResult=i.sqlite3_result_js),i.sqlite3_create_function_v2.udfConvertArgs=i.sqlite3_create_function.udfConvertArgs=i.sqlite3_values_to_js,i.sqlite3_create_window_function&&(i.sqlite3_create_window_function.udfConvertArgs=i.sqlite3_values_to_js),i.sqlite3_create_function_v2.udfSetError=i.sqlite3_create_function.udfSetError=i.sqlite3_result_error_js,i.sqlite3_create_window_function&&(i.sqlite3_create_window_function.udfSetError=i.sqlite3_result_error_js)}{const y=(R,U)=>(typeof R=="string"?U=-1:u.isSQLableTypedArray(R)?(U=R.byteLength,R=r.typedArrayToString(R instanceof ArrayBuffer?new Uint8Array(R):R)):Array.isArray(R)&&(R=R.join(""),U=-1),[R,U]),b={basic:r.xWrap("sqlite3_prepare_v3","int",["sqlite3*","string","int","int","**","**"]),full:r.xWrap("sqlite3_prepare_v3","int",["sqlite3*","*","int","int","**","**"])};i.sqlite3_prepare_v3=function R(U,w,O,f,m,q){if(R.length!==arguments.length)return T(U,"sqlite3_prepare_v3",R.length);const[j,Y]=y(w,Number(O));switch(typeof j){case"string":return b.basic(U,j,Y,f,m,null);case typeof r.ptr.null:return b.full(U,r.ptr.coerce(j),Y,f,m,q);default:return u.sqlite3__wasm_db_error(U,i.SQLITE_MISUSE,"Invalid SQL argument type for sqlite3_prepare_v2/v3(). typeof="+typeof j)}},i.sqlite3_prepare_v2=function R(U,w,O,f,m){return R.length===arguments.length?i.sqlite3_prepare_v3(U,w,O,0,f,m):T(U,"sqlite3_prepare_v2",R.length)}}{const y=r.xWrap("sqlite3_bind_text","int",["sqlite3_stmt*","int","string","int","*"]),b=r.xWrap("sqlite3_bind_blob","int",["sqlite3_stmt*","int","*","int","*"]);i.sqlite3_bind_text=function R(U,w,O,f,m){if(R.length!==arguments.length)return T(i.sqlite3_db_handle(U),"sqlite3_bind_text",R.length);if(r.isPtr(O)||O===null)return y(U,w,O,f,m);O instanceof ArrayBuffer?O=new Uint8Array(O):Array.isArray(pMem)&&(O=pMem.join(""));let q,j;try{if(u.isSQLableTypedArray(O))q=r.allocFromTypedArray(O),j=O.byteLength;else if(typeof O=="string")[q,j]=r.allocCString(O);else return u.sqlite3__wasm_db_error(i.sqlite3_db_handle(U),i.SQLITE_MISUSE,"Invalid 3rd argument type for sqlite3_bind_text().");return y(U,w,q,j,i.SQLITE_WASM_DEALLOC)}catch(Y){return r.dealloc(q),u.sqlite3__wasm_db_error(i.sqlite3_db_handle(U),Y)}},i.sqlite3_bind_blob=function R(U,w,O,f,m){if(R.length!==arguments.length)return T(i.sqlite3_db_handle(U),"sqlite3_bind_blob",R.length);if(r.isPtr(O)||O===null)return b(U,w,O,f,m);O instanceof ArrayBuffer?O=new Uint8Array(O):Array.isArray(O)&&(O=O.join(""));let q,j;try{if(u.isBindableTypedArray(O))q=r.allocFromTypedArray(O),j=f>=0?f:O.byteLength;else if(typeof O=="string")[q,j]=r.allocCString(O);else return u.sqlite3__wasm_db_error(i.sqlite3_db_handle(U),i.SQLITE_MISUSE,"Invalid 3rd argument type for sqlite3_bind_blob().");return b(U,w,q,j,i.SQLITE_WASM_DEALLOC)}catch(Y){return r.dealloc(q),u.sqlite3__wasm_db_error(i.sqlite3_db_handle(U),Y)}}}if(!i.sqlite3_column_text){const y=r.xWrap.argAdapter("sqlite3_stmt*"),b=r.xWrap.argAdapter("int"),R=r.xWrap.argAdapter("sqlite3_value*"),U=(w,O)=>r.typedArrayToString(r.heap8u(),Number(w),Number(w)+O);i.sqlite3_column_text=function(w,O){const f=y(w),m=b(O),q=r.exports.sqlite3_column_text(f,m);return q?U(q,r.exports.sqlite3_column_bytes(f,m)):null},i.sqlite3_value_text=function(w){const O=R(w),f=r.exports.sqlite3_value_text(O);return f?U(f,r.exports.sqlite3_value_bytes(O)):null}}i.sqlite3_config=function(y,...b){if(arguments.length<2)return i.SQLITE_MISUSE;switch(y){case i.SQLITE_CONFIG_COVERING_INDEX_SCAN:case i.SQLITE_CONFIG_MEMSTATUS:case i.SQLITE_CONFIG_SMALL_MALLOC:case i.SQLITE_CONFIG_SORTERREF_SIZE:case i.SQLITE_CONFIG_STMTJRNL_SPILL:case i.SQLITE_CONFIG_URI:return r.exports.sqlite3__wasm_config_i(y,b[0]);case i.SQLITE_CONFIG_LOOKASIDE:return r.exports.sqlite3__wasm_config_ii(y,b[0],b[1]);case i.SQLITE_CONFIG_MEMDB_MAXSIZE:return r.exports.sqlite3__wasm_config_j(y,b[0]);case i.SQLITE_CONFIG_GETMALLOC:case i.SQLITE_CONFIG_GETMUTEX:case i.SQLITE_CONFIG_GETPCACHE2:case i.SQLITE_CONFIG_GETPCACHE:case i.SQLITE_CONFIG_HEAP:case i.SQLITE_CONFIG_LOG:case i.SQLITE_CONFIG_MALLOC:case i.SQLITE_CONFIG_MMAP_SIZE:case i.SQLITE_CONFIG_MULTITHREAD:case i.SQLITE_CONFIG_MUTEX:case i.SQLITE_CONFIG_PAGECACHE:case i.SQLITE_CONFIG_PCACHE2:case i.SQLITE_CONFIG_PCACHE:case i.SQLITE_CONFIG_PCACHE_HDRSZ:case i.SQLITE_CONFIG_PMASZ:case i.SQLITE_CONFIG_SERIALIZED:case i.SQLITE_CONFIG_SINGLETHREAD:case i.SQLITE_CONFIG_SQLLOG:case i.SQLITE_CONFIG_WIN32_HEAPSIZE:default:return i.SQLITE_NOTFOUND}};{const y=new Set;i.sqlite3_auto_extension=function(b){if(b instanceof Function)b=r.installFunction("i(ppp)",b);else if(arguments.length!==1||!r.isPtr(b))return i.SQLITE_MISUSE;const R=r.exports.sqlite3_auto_extension(b);return b!==arguments[0]&&(R===0?y.add(b):r.uninstallFunction(b)),R},i.sqlite3_cancel_auto_extension=function(b){return!b||arguments.length!==1||!r.isPtr(b)?0:r.exports.sqlite3_cancel_auto_extension(b)},i.sqlite3_reset_auto_extension=function(){r.exports.sqlite3_reset_auto_extension();for(const b of y)r.uninstallFunction(b);y.clear()}}r.xWrap.FuncPtrAdapter.warnOnUse=!0;const z=s.StructBinder,N=function y(b,R,U,w=y.installMethodArgcCheck){if(b instanceof z.StructType?!(U instanceof Function)&&!r.isPtr(U)&&n("Usage error: expecting a Function or WASM pointer to one."):n("Usage error: target object is-not-a StructType."),arguments.length===1)return(q,j)=>y(b,q,j,w);y.argcProxy||(y.argcProxy=function(q,j,Y,oe){return function(...be){return Y.length!==arguments.length&&n("Argument mismatch for",q.structInfo.name+"::"+j+": Native signature is:",oe),Y.apply(this,be)}},y.removeFuncList=function(){this.ondispose.__removeFuncList&&(this.ondispose.__removeFuncList.forEach((q,j)=>{if(r.isPtr(q))try{r.uninstallFunction(q)}catch{}}),delete this.ondispose.__removeFuncList)});const O=b.memberSignature(R);O.length<2&&n("Member",R,"does not have a function pointer signature:",O);const f=b.memberKey(R),m=w&&!r.isPtr(U)?y.argcProxy(b,f,U,O):U;if(r.isPtr(m))m&&!r.functionEntry(m)&&n("Pointer",m,"is not a WASM function table entry."),b[f]=m;else{const q=r.installFunction(m,O);b[f]=q,(!b.ondispose||!b.ondispose.__removeFuncList)&&(b.addOnDispose("ondispose.__removeFuncList handler",y.removeFuncList),b.ondispose.__removeFuncList=[]),b.ondispose.__removeFuncList.push(f,q)}return(q,j)=>y(b,q,j,w)};N.installMethodArgcCheck=!1;const te=function(y,b,R=N.installMethodArgcCheck){const U=new Map;for(const w of Object.keys(b)){const O=b[w],f=U.get(O);if(f){const m=y.memberKey(w);y[m]=y[y.memberKey(f)]}else N(y,w,O,R),U.set(O,w)}return y};z.StructType.prototype.installMethod=function(b,R,U=N.installMethodArgcCheck){return arguments.length<3&&b&&typeof b=="object"?te(this,...arguments):N(this,...arguments)},z.StructType.prototype.installMethods=function(y,b=N.installMethodArgcCheck){return te(this,y,b)}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const n=(...I)=>{throw new s.SQLite3Error(...I)},i=s.capi,r=s.wasm,u=s.util,F=function(I){return(...a)=>I("sqlite3.oo1:",...a)};s.__isUnderTest?F(console.debug.bind(console)):F(s.config.debug),s.__isUnderTest?F(console.warn.bind(console)):F(s.config.warn),s.__isUnderTest?F(console.error.bind(console)):F(s.config.error);const T=new WeakMap,J=new Set,C=new WeakMap,G=(I,a,_)=>{const d=Object.getOwnPropertyDescriptor(I,a);return d?d.value:_},p=function(I,a){return a&&(I instanceof y&&(I=I.pointer),n(a,"sqlite3 result code",a+":",I?i.sqlite3_errmsg(I):i.sqlite3_errstr(a))),arguments[0]},z=r.installFunction("i(ippp)",(function(I,a,_,d){i.SQLITE_TRACE_STMT===I&&console.log("SQL TRACE #"+ ++this.counter,"via sqlite3@"+a+"["+i.sqlite3_db_filename(a,null)+"]",r.cstrToJs(d))}).bind({counter:0})),N=Object.create(null),te=function I(...a){const _=I.normalizeArgs(...a);let d;if(d=_["sqlite3*"])_["sqlite3*:takeOwnership"]||J.add(this),this.filename=i.sqlite3_db_filename(d,"main");else{let S=_.filename,W=_.vfs,K=_.flags;(typeof S!="string"&&!r.isPtr(S)||typeof K!="string"||W&&typeof W!="string"&&!r.isPtr(W))&&(s.config.error("Invalid DB ctor args",_,arguments),n("Invalid arguments for DB constructor:",arguments,"opts:",_));let D=0;K.indexOf("c")>=0&&(D|=i.SQLITE_OPEN_CREATE|i.SQLITE_OPEN_READWRITE),K.indexOf("w")>=0&&(D|=i.SQLITE_OPEN_READWRITE),D===0&&(D|=i.SQLITE_OPEN_READONLY),D|=i.SQLITE_OPEN_EXRESCODE;const h=r.pstack.pointer;try{const P=r.pstack.allocPtr();let Q=i.sqlite3_open_v2(S,P,D,W||r.ptr.null);d=r.peekPtr(P),p(d,Q),i.sqlite3_extended_result_codes(d,1),K.indexOf("t")>=0&&i.sqlite3_trace_v2(d,i.SQLITE_TRACE_STMT,z,d)}catch(P){throw d&&i.sqlite3_close_v2(d),P}finally{r.pstack.restore(h)}this.filename=r.isPtr(S)?r.cstrToJs(S):S}if(T.set(this,d),C.set(this,Object.create(null)),!_["sqlite3*"])try{const S=N[i.sqlite3_js_db_vfs(d)||n("Internal error: cannot get VFS for new db handle.")];S&&(S instanceof Function?S(this,s):p(d,i.sqlite3_exec(d,S,0,0,0)))}catch(S){throw this.close(),S}};te.setVfsPostOpenCallback=function(I,a){a instanceof Function||n("dbCtorHelper.setVfsPostOpenCallback() should not be used with a non-function argument.",arguments),N[I]=a},te.normalizeArgs=function(I=":memory:",a="c",_=null){const d={};return arguments.length===1&&arguments[0]&&typeof arguments[0]=="object"?(Object.assign(d,arguments[0]),d.flags===void 0&&(d.flags="c"),d.vfs===void 0&&(d.vfs=null),d.filename===void 0&&(d.filename=":memory:")):(d.filename=I,d.flags=a,d.vfs=_),d};const y=function(...I){te.apply(this,I)};y.dbCtorHelper=te;const b={null:1,number:2,string:3,boolean:4,blob:5};r.bigIntEnabled&&(b.bigint=b.number);const R=function(){b!==arguments[2]&&n(i.SQLITE_MISUSE,"Do not call the Stmt constructor directly. Use DB.prepare()."),this.db=arguments[0],T.set(this,arguments[1]),arguments.length>3&&!arguments[3]&&J.add(this)},U=function(I){return I.pointer||n("DB has been closed."),I},w=function(I,a){return(a!==(a|0)||a<0||a>=I.columnCount)&&n("Column index",a,"is out of range."),I},O=function(I,a){const _=Object.create(null);switch(_.opt=Object.create(null),a.length){case 1:typeof a[0]=="string"||u.isSQLableTypedArray(a[0])||Array.isArray(a[0])?_.sql=a[0]:a[0]&&typeof a[0]=="object"&&(_.opt=a[0],_.sql=_.opt.sql);break;case 2:_.sql=a[0],_.opt=a[1];break;default:n("Invalid argument count for exec().")}_.sql=u.flexibleString(_.sql),typeof _.sql!="string"&&n("Missing SQL argument or unsupported SQL value type.");const d=_.opt;switch(d.returnValue){case"resultRows":d.resultRows||(d.resultRows=[]),_.returnVal=()=>d.resultRows;break;case"saveSql":d.saveSql||(d.saveSql=[]),_.returnVal=()=>d.saveSql;break;case void 0:case"this":_.returnVal=()=>I;break;default:n("Invalid returnValue value:",d.returnValue)}if(!d.callback&&!d.returnValue&&d.rowMode!==void 0&&(d.resultRows||(d.resultRows=[]),_.returnVal=()=>d.resultRows),d.callback||d.resultRows)switch(d.rowMode===void 0?"array":d.rowMode){case"object":_.cbArg=(S,W)=>{W.columnNames||(W.columnNames=S.getColumnNames([]));const K=S.get([]),D=Object.create(null);for(const h in W.columnNames)D[W.columnNames[h]]=K[h];return D};break;case"array":_.cbArg=S=>S.get([]);break;case"stmt":Array.isArray(d.resultRows)&&n("exec(): invalid rowMode for a resultRows array: must","be one of 'array', 'object',","a result column number, or column name reference."),_.cbArg=S=>S;break;default:if(u.isInt32(d.rowMode)){_.cbArg=S=>S.get(d.rowMode);break}else if(typeof d.rowMode=="string"&&d.rowMode.length>1&&d.rowMode[0]==="$"){const S=d.rowMode.substr(1);_.cbArg=W=>{const K=W.get(Object.create(null))[S];return K===void 0?n(i.SQLITE_NOTFOUND,"exec(): unknown result column:",S):K};break}n("Invalid rowMode:",d.rowMode)}return _},f=(I,a,_,...d)=>{const S=I.prepare(a);try{const W=S.bind(_).step()?S.get(...d):void 0;return S.reset(),W}finally{S.finalize()}},m=(I,a,_,d)=>I.exec({sql:a,bind:_,rowMode:d,returnValue:"resultRows"});y.checkRc=(I,a)=>p(I,a),y.prototype={isOpen:function(){return!!this.pointer},affirmOpen:function(){return U(this)},close:function(){const I=this.pointer;if(I){if(this.onclose&&this.onclose.before instanceof Function)try{this.onclose.before(this)}catch{}if(Object.keys(C.get(this)).forEach((a,_)=>{if(_&&_.pointer)try{_.finalize()}catch{}}),T.delete(this),C.delete(this),J.delete(this)||i.sqlite3_close_v2(I),this.onclose&&this.onclose.after instanceof Function)try{this.onclose.after(this)}catch{}delete this.filename}},changes:function(I=!1,a=!1){const _=U(this).pointer;return I?a?i.sqlite3_total_changes64(_):i.sqlite3_total_changes(_):a?i.sqlite3_changes64(_):i.sqlite3_changes(_)},dbFilename:function(I="main"){return i.sqlite3_db_filename(U(this).pointer,I)},dbName:function(I=0){return i.sqlite3_db_name(U(this).pointer,I)},dbVfsName:function(I=0){let a;const _=i.sqlite3_js_db_vfs(U(this).pointer,I);if(_){const d=new i.sqlite3_vfs(_);try{a=r.cstrToJs(d.$zName)}finally{d.dispose()}}return a},prepare:function(I){U(this);const a=r.pstack.pointer;let _,d;try{_=r.pstack.alloc(8),y.checkRc(this,i.sqlite3_prepare_v2(this.pointer,I,-1,_,null)),d=r.peekPtr(_)}finally{r.pstack.restore(a)}d||n("Cannot prepare empty SQL.");const S=new R(this,d,b);return C.get(this)[d]=S,S},exec:function(){U(this);const I=O(this,arguments);if(!I.sql)return n("exec() requires an SQL string.");const a=I.opt,_=a.callback,d=Array.isArray(a.resultRows)?a.resultRows:void 0;let S,W=a.bind,K=!!(I.cbArg||a.columnNames||d);const D=r.scopedAllocPush(),h=Array.isArray(a.saveSql)?a.saveSql:void 0;try{const P=u.isSQLableTypedArray(I.sql);let Q=P?I.sql.byteLength:r.jstrlen(I.sql);const ne=r.scopedAlloc(2*r.ptr.size+(Q+1)),g=r.ptr.add(ne,r.ptr.size);let L=r.ptr.add(g,r.ptr.size);const H=r.ptr.add(L,Q);for(P?r.heap8().set(I.sql,L):r.jstrcpy(I.sql,r.heap8(),L,Q,!1),r.poke8(r.ptr.add(L,Q),0);L&&r.peek8(L);){r.pokePtr([ne,g],0),y.checkRc(this,i.sqlite3_prepare_v3(this.pointer,L,Q,0,ne,g));const re=r.peekPtr(ne);if(L=r.peekPtr(g),Q=Number(r.ptr.add(H,-L)),!!re){if(h&&h.push(i.sqlite3_sql(re).trim()),S=new R(this,re,b),W&&S.parameterCount&&(S.bind(W),W=null),K&&S.columnCount){let Z=Array.isArray(a.columnNames)?0:1;if(K=!1,I.cbArg||d){const ce=Object.create(null);for(;S.step();be.delete(S)){Z++===0&&S.getColumnNames(ce.columnNames=a.columnNames||[]),be.add(S);const ve=I.cbArg(S,ce);if(d&&d.push(ve),_&&_.call(a,ve,S)===!1)break}be.delete(S)}Z===0&&S.getColumnNames(a.columnNames)}else S.step();S.reset().finalize(),S=null}}}finally{S&&(be.delete(S),S.finalize()),r.scopedAllocPop(D)}return I.returnVal()},createFunction:function(a,_,d){const S=ce=>ce instanceof Function;switch(arguments.length){case 1:d=a,a=d.name,_=d.xFunc||0;break;case 2:S(_)||(d=_,_=d.xFunc||0);break}d||(d={}),typeof a!="string"&&n("Invalid arguments: missing function name.");let W=d.xStep||0,K=d.xFinal||0;const D=d.xValue||0,h=d.xInverse||0;let P;S(_)?(P=!1,(S(W)||S(K))&&n("Ambiguous arguments: scalar or aggregate?"),W=K=null):S(W)?(S(K)||n("Missing xFinal() callback for aggregate or window UDF."),_=null):S(K)?n("Missing xStep() callback for aggregate or window UDF."):n("Missing function-type properties."),P===!1?(S(D)||S(h))&&n("xValue and xInverse are not permitted for non-window UDFs."):S(D)?(S(h)||n("xInverse must be provided if xValue is."),P=!0):S(h)&&n("xValue must be provided if xInverse is.");const Q=d.pApp;Q!=null&&!r.isPtr(Q)&&n("Invalid value for pApp property. Must be a legal WASM pointer value.");const ne=d.xDestroy||0;ne&&!S(ne)&&n("xDestroy property must be a function.");let g=0;G(d,"deterministic")&&(g|=i.SQLITE_DETERMINISTIC),G(d,"directOnly")&&(g|=i.SQLITE_DIRECTONLY),G(d,"innocuous")&&(g|=i.SQLITE_INNOCUOUS),a=a.toLowerCase();const L=_||W,H=G(d,"arity"),re=typeof H=="number"?H:L.length?L.length-1:0;let Z;return P?Z=i.sqlite3_create_window_function(this.pointer,a,re,i.SQLITE_UTF8|g,Q||0,W,K,D,h,ne):Z=i.sqlite3_create_function_v2(this.pointer,a,re,i.SQLITE_UTF8|g,Q||0,_,W,K,ne),y.checkRc(this,Z),this},selectValue:function(I,a,_){return f(this,I,a,0,_)},selectValues:function(I,a,_){const d=this.prepare(I),S=[];try{for(d.bind(a);d.step();)S.push(d.get(0,_));d.reset()}finally{d.finalize()}return S},selectArray:function(I,a){return f(this,I,a,[])},selectObject:function(I,a){return f(this,I,a,{})},selectArrays:function(I,a){return m(this,I,a,"array")},selectObjects:function(I,a){return m(this,I,a,"object")},openStatementCount:function(){return this.pointer?Object.keys(C.get(this)).length:0},transaction:function(I){let a="BEGIN";arguments.length>1&&(/[^a-zA-Z]/.test(arguments[0])&&n(i.SQLITE_MISUSE,"Invalid argument for BEGIN qualifier."),a+=" "+arguments[0],I=arguments[1]),U(this).exec(a);try{const _=I(this);return this.exec("COMMIT"),_}catch(_){throw this.exec("ROLLBACK"),_}},savepoint:function(I){U(this).exec("SAVEPOINT oo1");try{const a=I(this);return this.exec("RELEASE oo1"),a}catch(a){throw this.exec("ROLLBACK to SAVEPOINT oo1; RELEASE SAVEPOINT oo1"),a}},checkRc:function(I){return p(this,I)}},y.wrapHandle=function(I,a=!1){if(!I||!r.isPtr(I))throw new s.SQLite3Error(i.SQLITE_MISUSE,"Argument must be a WASM sqlite3 pointer");return new y({"sqlite3*":I,"sqlite3*:takeOwnership":!!a})};const q=function(I){return I.pointer||n("Stmt has been closed."),I},j=function(I){let a=b[I==null?"null":typeof I];switch(a){case b.boolean:case b.null:case b.number:case b.string:return a;case b.bigint:return r.bigIntEnabled?a:void 0;default:return u.isBindableTypedArray(I)?b.blob:void 0}},Y=function(I){return j(I)||n("Unsupported bind() argument type:",typeof I)},oe=function(I,a){const _=typeof a=="number"?a:i.sqlite3_bind_parameter_index(I.pointer,a);return _===0||!u.isInt32(_)?n("Invalid bind() parameter name: "+a):(_<1||_>I.parameterCount)&&n("Bind index",a,"is out of range."),_},be=new Set,qe=new Set,fe=function(I,a){return be.has(I)&&n("Operation is illegal when statement is locked:",a),I},V=function I(a,_,d,S){fe(q(a),"bind()"),I._||(I._tooBigInt=K=>n("BigInt value is too big to store without precision loss:",K),I._={string:function(K,D,h,P){const[Q,ne]=r.allocCString(h,!0);return(P?i.sqlite3_bind_blob:i.sqlite3_bind_text)(K.pointer,D,Q,ne,i.SQLITE_WASM_DEALLOC)}}),Y(S),_=oe(a,_);let W=0;switch(S==null?b.null:d){case b.null:W=i.sqlite3_bind_null(a.pointer,_);break;case b.string:W=I._.string(a,_,S,!1);break;case b.number:{let K;u.isInt32(S)?K=i.sqlite3_bind_int:typeof S=="bigint"?u.bigIntFits64(S)?r.bigIntEnabled?K=i.sqlite3_bind_int64:u.bigIntFitsDouble(S)?(S=Number(S),K=i.sqlite3_bind_double):I._tooBigInt(S):I._tooBigInt(S):(S=Number(S),r.bigIntEnabled&&Number.isInteger(S)?K=i.sqlite3_bind_int64:K=i.sqlite3_bind_double),W=K(a.pointer,_,S);break}case b.boolean:W=i.sqlite3_bind_int(a.pointer,_,S?1:0);break;case b.blob:{if(typeof S=="string"){W=I._.string(a,_,S,!0);break}else S instanceof ArrayBuffer?S=new Uint8Array(S):u.isBindableTypedArray(S)||n("Binding a value as a blob requires","that it be a string, Uint8Array, Int8Array, or ArrayBuffer.");const K=r.alloc(S.byteLength||1);r.heap8().set(S.byteLength?S:[0],Number(K)),W=i.sqlite3_bind_blob(a.pointer,_,K,S.byteLength,i.SQLITE_WASM_DEALLOC);break}default:s.config.warn("Unsupported bind() argument type:",S),n("Unsupported bind() argument type: "+typeof S)}return W&&y.checkRc(a.db.pointer,W),a};R.prototype={finalize:function(){const I=this.pointer;if(I){fe(this,"finalize()");const a=J.delete(this)?0:i.sqlite3_finalize(I);return delete C.get(this.db)[I],T.delete(this),be.delete(this),qe.delete(this),delete this.parameterCount,delete this.db,a}},clearBindings:function(){return fe(q(this),"clearBindings()"),i.sqlite3_clear_bindings(this.pointer),qe.delete(this),this},reset:function(I){fe(this,"reset()"),I&&this.clearBindings();const a=i.sqlite3_reset(q(this).pointer);return qe.delete(this),p(this.db,a),this},bind:function(){q(this);let I,a;switch(arguments.length){case 1:I=1,a=arguments[0];break;case 2:I=arguments[0],a=arguments[1];break;default:n("Invalid bind() arguments.")}return a===void 0?this:(this.parameterCount||n("This statement has no bindable parameters."),qe.delete(this),a===null?V(this,I,b.null,a):Array.isArray(a)?(arguments.length!==1&&n("When binding an array, an index argument is not permitted."),a.forEach((_,d)=>V(this,d+1,Y(_),_)),this):(a instanceof ArrayBuffer&&(a=new Uint8Array(a)),typeof a=="object"&&!u.isBindableTypedArray(a)?(arguments.length!==1&&n("When binding an object, an index argument is not permitted."),Object.keys(a).forEach(_=>V(this,_,Y(a[_]),a[_])),this):V(this,I,Y(a),a)))},bindAsBlob:function(I,a){q(this),arguments.length===1&&(a=I,I=1);const _=Y(a);return b.string!==_&&b.blob!==_&&b.null!==_&&n("Invalid value type for bindAsBlob()"),V(this,I,b.blob,a)},step:function(){fe(this,"step()");const I=i.sqlite3_step(q(this).pointer);switch(I){case i.SQLITE_DONE:return qe.delete(this),!1;case i.SQLITE_ROW:return qe.add(this),!0;default:qe.delete(this),s.config.warn("sqlite3_step() rc=",I,i.sqlite3_js_rc_str(I),"SQL =",i.sqlite3_sql(this.pointer)),y.checkRc(this.db.pointer,I)}},stepReset:function(){return this.step(),this.reset()},stepFinalize:function(){try{const I=this.step();return this.reset(),I}finally{try{this.finalize()}catch{}}},get:function(I,a){if(qe.has(q(this))||n("Stmt.step() has not (recently) returned true."),Array.isArray(I)){let _=0;const d=this.columnCount;for(;_<d;)I[_]=this.get(_++);return I}else if(I&&typeof I=="object"){let _=0;const d=this.columnCount;for(;_<d;)I[i.sqlite3_column_name(this.pointer,_)]=this.get(_++);return I}switch(w(this,I),a===void 0?i.sqlite3_column_type(this.pointer,I):a){case i.SQLITE_NULL:return null;case i.SQLITE_INTEGER:if(r.bigIntEnabled){const _=i.sqlite3_column_int64(this.pointer,I);return _>=Number.MIN_SAFE_INTEGER&&_<=Number.MAX_SAFE_INTEGER?Number(_).valueOf():_}else{const _=i.sqlite3_column_double(this.pointer,I);return(_>Number.MAX_SAFE_INTEGER||_<Number.MIN_SAFE_INTEGER)&&n("Integer is out of range for JS integer range: "+_),u.isInt32(_)?_|0:_}case i.SQLITE_FLOAT:return i.sqlite3_column_double(this.pointer,I);case i.SQLITE_TEXT:return i.sqlite3_column_text(this.pointer,I);case i.SQLITE_BLOB:{const _=i.sqlite3_column_bytes(this.pointer,I),d=i.sqlite3_column_blob(this.pointer,I),S=new Uint8Array(_);return _&&(S.set(r.heap8u().slice(Number(d),Number(d)+_),0),this.db._blobXfer instanceof Array&&this.db._blobXfer.push(S.buffer)),S}default:n("Don't know how to translate","type of result column #"+I+".")}n("Not reached.")},getInt:function(I){return this.get(I,i.SQLITE_INTEGER)},getFloat:function(I){return this.get(I,i.SQLITE_FLOAT)},getString:function(I){return this.get(I,i.SQLITE_TEXT)},getBlob:function(I){return this.get(I,i.SQLITE_BLOB)},getJSON:function(I){const a=this.get(I,i.SQLITE_STRING);return a===null?a:JSON.parse(a)},getColumnName:function(I){return i.sqlite3_column_name(w(q(this),I).pointer,I)},getColumnNames:function(I=[]){w(q(this),0);const a=this.columnCount;for(let _=0;_<a;++_)I.push(i.sqlite3_column_name(this.pointer,_));return I},getParamIndex:function(I){return q(this).parameterCount?i.sqlite3_bind_parameter_index(this.pointer,I):void 0},getParamName:function(I){return q(this).parameterCount?i.sqlite3_bind_parameter_name(this.pointer,I):void 0},isBusy:function(){return i.sqlite3_stmt_busy(q(this))!==0},isReadOnly:function(){return i.sqlite3_stmt_readonly(q(this))!==0}};{const I={enumerable:!0,get:function(){return T.get(this)},set:()=>n("The pointer property is read-only.")};Object.defineProperty(R.prototype,"pointer",I),Object.defineProperty(y.prototype,"pointer",I)}Object.defineProperty(R.prototype,"columnCount",{enumerable:!1,get:function(){return i.sqlite3_column_count(this.pointer)},set:()=>n("The columnCount property is read-only.")}),Object.defineProperty(R.prototype,"parameterCount",{enumerable:!1,get:function(){return i.sqlite3_bind_parameter_count(this.pointer)},set:()=>n("The parameterCount property is read-only.")}),R.wrapHandle=function(I,a,_=!1){if(!(I instanceof y)||!I.pointer)throw new s.SQLite3Error(s.SQLITE_MISUSE,"First argument must be an opened sqlite3.oo1.DB instance");if(!a||!r.isPtr(a))throw new s.SQLite3Error(s.SQLITE_MISUSE,"Second argument must be a WASM sqlite3_stmt pointer");return new R(I,a,b,!!_)},s.oo1={DB:y,Stmt:R}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const n=s.util;s.initWorker1API=(function(){const i=(...z)=>{throw new Error(z.join(" "))};globalThis.WorkerGlobalScope instanceof Function||i("initWorker1API() must be run from a Worker thread.");const r=this.sqlite3||i("Missing this.sqlite3 object."),u=r.oo1.DB,F=function(z){let N=T.idMap.get(z);return N||(N="db#"+ ++T.idSeq+":"+Math.floor(Math.random()*1e8)+":"+Math.floor(Math.random()*1e8),T.idMap.set(z,N),N)},T={dbList:[],idSeq:0,idMap:new WeakMap,xfer:[],open:function(z){const N=new u(z);return this.dbs[F(N)]=N,this.dbList.indexOf(N)<0&&this.dbList.push(N),N},close:function(z,N){if(z){delete this.dbs[F(z)];const te=z.filename,y=n.sqlite3__wasm_db_vfs(z.pointer,0);z.close();const b=this.dbList.indexOf(z);b>=0&&this.dbList.splice(b,1),N&&te&&y&&n.sqlite3__wasm_vfs_unlink(y,te)}},post:function(z,N){N&&N.length?(globalThis.postMessage(z,Array.from(N)),N.length=0):globalThis.postMessage(z)},dbs:Object.create(null),getDb:function(z,N=!0){return this.dbs[z]||(N?i("Unknown (or closed) DB ID:",z):void 0)}},J=function(z=T.dbList[0]){return z&&z.pointer?z:i("DB is not opened.")},C=function(z,N=!0){const te=T.getDb(z.dbId,!1)||T.dbList[0];return N?J(te):te},G=function(){return T.dbList[0]&&F(T.dbList[0])},p={open:function(z){const N=Object.create(null),te=z.args||Object.create(null);te.simulateError&&i("Throwing because of simulateError flag.");const y=Object.create(null);N.vfs=te.vfs,N.filename=te.filename||"";const b=T.open(N);return y.filename=b.filename,y.persistent=!!r.capi.sqlite3_js_db_uses_vfs(b.pointer,"opfs"),y.dbId=F(b),y.vfs=b.dbVfsName(),y},close:function(z){const N=C(z,!1),te={filename:N&&N.filename};if(N){const y=z.args&&typeof z.args=="object"?!!z.args.unlink:!1;T.close(N,y)}return te},exec:function(z){const N=typeof z.args=="string"?{sql:z.args}:z.args||Object.create(null);N.rowMode==="stmt"?i("Invalid rowMode for 'exec': stmt mode","does not work in the Worker API."):N.sql||i("'exec' requires input SQL.");const te=C(z);(N.callback||Array.isArray(N.resultRows))&&(te._blobXfer=T.xfer);const y=N.callback;let b=0;const R=!!N.columnNames;typeof y=="string"&&(R||(N.columnNames=[]),N.callback=function(U,w){T.post({type:y,columnNames:N.columnNames,rowNumber:++b,row:U},T.xfer)});try{const U=N.countChanges?te.changes(!0,N.countChanges===64):void 0;te.exec(N),U!==void 0&&(N.changeCount=te.changes(!0,N.countChanges===64)-U);const w=N.lastInsertRowId?r.capi.sqlite3_last_insert_rowid(te):void 0;w!==void 0&&(N.lastInsertRowId=w),N.callback instanceof Function&&(N.callback=y,T.post({type:y,columnNames:N.columnNames,rowNumber:null,row:void 0}))}finally{delete te._blobXfer,N.callback&&(N.callback=y)}return N},"config-get":function(){const z=Object.create(null),N=r.config;return["bigIntEnabled"].forEach(function(te){Object.getOwnPropertyDescriptor(N,te)&&(z[te]=N[te])}),z.version=r.version,z.vfsList=r.capi.sqlite3_js_vfs_list(),z},export:function(z){const N=C(z),te={byteArray:r.capi.sqlite3_js_db_export(N.pointer),filename:N.filename,mimetype:"application/x-sqlite3"};return T.xfer.push(te.byteArray.buffer),te},toss:function(z){i("Testing worker exception")}};globalThis.onmessage=async function(z){z=z.data;let N,te=z.dbId,y=z.type;const b=performance.now();try{p.hasOwnProperty(y)&&p[y]instanceof Function?N=await p[y](z):i("Unknown db worker message type:",z.type)}catch(R){y="error",N={operation:z.type,message:R.message,errorClass:R.name,input:z},R.stack&&(N.stack=typeof R.stack=="string"?R.stack.split(/\n\s*/):R.stack)}te||(te=N.dbId||G()),T.post({type:y,dbId:te,messageId:z.messageId,workerReceivedTime:b,workerRespondTime:performance.now(),departureTime:z.departureTime,result:N},T.xfer)},globalThis.postMessage({type:"sqlite3-api",result:"worker1-ready"})}).bind({sqlite3:s})}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const n=s.wasm,i=s.capi,r=s.util.toss3,u=Object.create(null);s.vfs=u,i.sqlite3_vfs.prototype.registerVfs=function(F=!1){this instanceof s.capi.sqlite3_vfs||r("Expecting a sqlite3_vfs-type argument.");const T=i.sqlite3_vfs_register(this,F?1:0);return T&&r("sqlite3_vfs_register(",this,") failed with rc",T),this.pointer!==i.sqlite3_vfs_find(this.$zName)&&r("BUG: sqlite3_vfs_find(vfs.$zName) failed for just-installed VFS",this),this},u.installVfs=function(F){let T=0;const J=["io","vfs"];for(const C of J){const G=F[C];G&&(++T,G.struct.installMethods(G.methods,!!G.applyArgcCheck),C==="vfs"&&(!G.struct.$zName&&typeof G.name=="string"&&G.struct.addOnDispose(G.struct.$zName=n.allocCString(G.name)),G.struct.registerVfs(!!G.asDefault)))}return T||r("Misuse: installVfs() options object requires at least","one of:",J),this}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){if(!s.wasm.exports.sqlite3_declare_vtab)return;const n=s.wasm,i=s.capi,r=s.util.toss3,u=Object.create(null);s.vtab=u;const F=i.sqlite3_index_info;F.prototype.nthConstraint=function(C,G=!1){if(C<0||C>=this.$nConstraint)return!1;const p=n.ptr.add(this.$aConstraint,F.sqlite3_index_constraint.structInfo.sizeof*C);return G?p:new F.sqlite3_index_constraint(p)},F.prototype.nthConstraintUsage=function(C,G=!1){if(C<0||C>=this.$nConstraint)return!1;const p=n.ptr.add(this.$aConstraintUsage,F.sqlite3_index_constraint_usage.structInfo.sizeof*C);return G?p:new F.sqlite3_index_constraint_usage(p)},F.prototype.nthOrderBy=function(C,G=!1){if(C<0||C>=this.$nOrderBy)return!1;const p=n.ptr.add(this.$aOrderBy,F.sqlite3_index_orderby.structInfo.sizeof*C);return G?p:new F.sqlite3_index_orderby(p)};const T=function(C,G){return(function(p,z=!1){if(arguments.length===0&&(p=new G),p instanceof G)return this.set(p.pointer,p),p;n.isPtr(p)||s.SQLite3Error.toss("Invalid argument to",C+"()");let N=this.get(p);return z&&this.delete(p),N}).bind(new Map)},J=function(C,G){const p=T(C,G);return Object.assign(Object.create(null),{StructType:G,create:z=>{const N=p();return n.pokePtr(z,N.pointer),N},get:z=>p(z),unget:z=>p(z,!0),dispose:z=>p(z,!0)?.dispose?.()})};u.xVtab=J("xVtab",i.sqlite3_vtab),u.xCursor=J("xCursor",i.sqlite3_vtab_cursor),u.xIndexInfo=C=>new i.sqlite3_index_info(C),u.xError=function C(G,p,z){if(C.errorReporter instanceof Function)try{C.errorReporter("sqlite3_module::"+G+"(): "+p.message)}catch{}let N;return p instanceof s.WasmAllocError?N=i.SQLITE_NOMEM:arguments.length>2?N=z:p instanceof s.SQLite3Error&&(N=p.resultCode),N||i.SQLITE_ERROR},u.xError.errorReporter=s.config.error.bind(s.config),u.xRowid=(C,G)=>n.poke(C,G,"i64"),u.setupModule=function(C){let G=!1;const p=this instanceof i.sqlite3_module?this:C.struct||(G=new i.sqlite3_module);try{const z=C.methods||r("Missing 'methods' object.");for(const N of Object.entries({xConnect:"xCreate",xDisconnect:"xDestroy"})){const te=N[0],y=N[1];z[te]===!0?z[te]=z[y]:z[y]===!0&&(z[y]=z[te])}if(C.catchExceptions){const N=function(b,R){return["xConnect","xCreate"].indexOf(b)>=0?function(U,w,O,f,m,q){try{return R(...arguments)||0}catch(j){return j instanceof s.WasmAllocError||(n.dealloc(n.peekPtr(q)),n.pokePtr(q,n.allocCString(j.message))),u.xError(b,j)}}:function(...U){try{return R(...U)||0}catch(w){return u.xError(b,w)}}},te=["xCreate","xConnect","xBestIndex","xDisconnect","xDestroy","xOpen","xClose","xFilter","xNext","xEof","xColumn","xRowid","xUpdate","xBegin","xSync","xCommit","xRollback","xFindFunction","xRename","xSavepoint","xRelease","xRollbackTo","xShadowName"],y=Object.create(null);for(const b of te){const R=z[b];if(R instanceof Function)b==="xConnect"&&z.xCreate===R?y[b]=z.xCreate:b==="xCreate"&&z.xConnect===R?y[b]=z.xConnect:y[b]=N(b,R);else continue}p.installMethods(y,!1)}else p.installMethods(z,!!C.applyArgcCheck);if(p.$iVersion===0){let N;typeof C.iVersion=="number"?N=C.iVersion:p.$xIntegrity?N=4:p.$xShadowName?N=3:p.$xSavePoint||p.$xRelease||p.$xRollbackTo?N=2:N=1,p.$iVersion=N}}catch(z){throw G&&G.dispose(),z}return p},i.sqlite3_module.prototype.setupModule=function(C){return u.setupModule.call(this,C)}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const n=s.capi,i=n.sqlite3_kvvfs_methods,r=n.KVVfsFile,u=s.capi.sqlite3_vfs_find("kvvfs");if(delete n.sqlite3_kvvfs_methods,delete n.KVVfsFile,!u)return;const F=s.util,T=s.wasm,J=F.toss3,C=(E,x)=>Object.prototype.hasOwnProperty.call(E,x),G=new i(T.exports.sqlite3__wasm_kvvfs_methods());F.assert(32<=G.$nKeySize,"unexpected kvvfsMethods.$nKeySize: "+G.$nKeySize);const p=Object.assign(Object.create(null),{rxJournalSuffix:/-journal$/,zKeyJrnl:T.allocCString("jrnl"),zKeySz:T.allocCString("sz"),keySize:G.$nKeySize,buffer:Object.assign(Object.create(null),{n:G.$nBufferSize,pool:Object.create(null)})});p.memBuffer=(E=0)=>p.buffer.pool[E]??=T.alloc(p.buffer.n),p.memBufferFree=E=>{const x=p.buffer.pool[E];x&&(T.dealloc(x),delete p.buffer.pool[E])};const z=()=>{},N=s.__isUnderTest?(...E)=>s.config.debug("kvvfs:",...E):z,te=(...E)=>s.config.warn("kvvfs:",...E),y=(...E)=>s.config.error("kvvfs:",...E);class b{#e;#r;#a(){return this.#r??=Object.keys(this.#e)}constructor(){this.clear()}key(x){const M=this.#a();return x<M.length?M[x]:null}getItem(x){return this.#e[x]??null}setItem(x,M){C(this.#e,x)||(this.#r=null),this.#e[x]=""+M}removeItem(x){delete this.#e[x]&&(this.#r=null)}clear(){this.#e=Object.create(null),this.#r=null}get length(){return this.#a().length}}const R=E=>E==="local"||E==="session",U=E=>R(E)?"kvvfs-"+E+"-":"",w=function(E,x=!1){if(R(E))return;const M=new Blob([E]).size;M||J(n.SQLITE_MISUSE,"Empty name is not permitted.");let B=p.keySize-1;p.rxJournalSuffix.test(E)?x||J(n.SQLITE_MISUSE,"Storage names may not have a '-journal' suffix."):["-wal","-shm"].filter(ae=>E.endsWith(ae)).length?J(n.SQLITE_MISUSE,"Storage names may not have a -wal or -shm suffix."):B-=8,M>B&&J(n.SQLITE_RANGE,"Storage name is too long. Limit =",B);let ee;for(ee=0;ee<M;++ee){const ae=E.codePointAt(ee);ae<32&&J(n.SQLITE_RANGE,"Illegal character ("+ae+"d) in storage name:",E)}},O=(E,x=void 0)=>Object.assign(Object.create(null),{jzClass:E,refc:1,deleteAtRefc0:!1,storage:x||new b,keyPrefix:U(E),files:[],listeners:void 0}),f=s.kvvfs=Object.create(null);s.__isUnderTest&&(f.log=Object.assign(Object.create(null),{xOpen:!1,xClose:!1,xWrite:!1,xRead:!1,xSync:!1,xAccess:!1,xFileControl:!1,xRcrdRead:!1,xRcrdWrite:!1,xRcrdDelete:!1}));const m=function(E){const x=p.rxJournalSuffix.test(E.jzClass)?E.jzClass.replace(p.rxJournalSuffix,""):E.jzClass+"-journal";f?.log?.xClose&&N("cleaning up storage handles [",E.jzClass,x,"]",E),delete p.storagePool[E.jzClass],delete p.storagePool[x],s.__isUnderTest||(delete E.storage,delete E.refc)},q=E=>p.storagePool[E.jzClass]=p.storagePool[E.jzClass+"-journal"]=E,j=".";p.storagePool=Object.assign(Object.create(null),{[j]:O(j)}),globalThis.Storage&&(globalThis.localStorage instanceof globalThis.Storage&&(p.storagePool.local=O("local",globalThis.localStorage)),globalThis.sessionStorage instanceof globalThis.Storage&&(p.storagePool.session=O("session",globalThis.sessionStorage))),p.builtinStorageNames=Object.keys(p.storagePool);const Y=E=>p.builtinStorageNames.indexOf(E)>-1;for(const E of Object.keys(p.storagePool)){const x=p.storagePool[E];p.storagePool[E+"-journal"]=x}p.setError=(E=void 0,x=n.SQLITE_ERROR)=>E?(p.lastError=E,E.resultCode|0||x):(delete p.lastError,0),p.popError=()=>{const E=p.lastError;return delete p.lastError,E};const oe=E=>{te("kvvfs.listener handler threw:",E)},be=T.exports.sqlite3__wasm_kvvfs_decode,qe=T.exports.sqlite3__wasm_kvvfs_encode,fe=async function(E,x,...M){try{x.keyPrefix&&M[0]&&(M[0]=M[0].replace(x.keyPrefix,""));let B,ee,ae,_e;for(const le of x.listeners){const me=Object.create(null);me.storageName=x.jzClass,me.type=E,le.decodePages;const Ae=le.events[E];if(Ae){if(!le.includeJournal&&M[0]==="jrnl")continue;if(E==="write"&&le.decodePages&&+M[0]>0){if(me.data=[M[0]],_e?.[M[0]]){me.data[1]=_e[M[0]];continue}B??=new TextEncoder("utf-8"),ee??=p.memBuffer(10),ae??=p.memBuffer(11);const xe=B.encode(M[1]),Se=T.heap8u();Se.set(xe,Number(ee)),Se[T.ptr.addn(ee,xe.length)]=0;const Me=be(ee,ae,p.buffer.n);if(Me>0)_e??=Object.create(null),_e[M[0]]=me.data[1]=Se.slice(Number(ae),T.ptr.addn(ae,Me));else continue}else me.data=M.length?M.length===1?M[0]:M:void 0;try{Ae(me)?.catch?.(oe)}catch(xe){te("notifyListeners [",x.jzClass,"]",E,xe)}}}}catch(B){oe(B)}},V=E=>typeof E=="string"?p.storagePool[E]:p.storagePool[T.cstrToJs(E)],I=T.exports.sqlite3__wasm_kvvfsMakeKey,a=(E,x,M)=>x&&E.keyPrefix?I(x,M):M,_=(E,x,M)=>T.cstrToJs(a(E,x,M)),d=E=>+E.storage.getItem(E.keyPrefix+"sz"),S=new Map,W={vfs:Object.create(null),ioDb:Object.create(null),ioJrnl:Object.create(null)},K=new n.sqlite3_vfs(G.$pVfs),D=new n.sqlite3_io_methods(G.$pIoDb),h=new n.sqlite3_io_methods(G.$pIoJrnl),P=Object.create(null),Q=Object.assign(Object.create(null),{pFileHandles:S,cache:p,storageForZClass:V,KVVfsStorage:b,disablePageSizeChange:!0});f.log&&(f.internal=Q);const ne={recordHandler:{xRcrdRead:(E,x,M,B)=>{try{const ee=T.cstrToJs(E),ae=V(ee);if(!ae)return-1;const _e=_(ae,E,x);f?.log?.xRcrdRead&&te("xRcrdRead",ee,_e,B,ae);const le=ae.storage.getItem(_e);if(le===null)return-1;const me=le.length;if(B<=0)return me;if(B===1)return T.poke(M,0),me;B+1<me&&J(n.SQLITE_RANGE,"xRcrdRead()",ee,_e,"input buffer is too small: need",me,"but have",B);const Ae=p.memBuffer(0),xe=T.heap8();let Se;for(Se=0;Se<me;++Se)xe[T.ptr.add(Ae,Se)]=le.codePointAt(Se)&255;return xe.copyWithin(Number(M),Number(Ae),T.ptr.addn(Ae,Se)),xe[T.ptr.add(M,me)]=0,B}catch(ee){return y("kvrecordRead()",ee),p.setError(ee),-2}},xRcrdWrite:(E,x,M)=>{try{const B=V(E),ee=_(B,E,x),ae=T.cstrToJs(M);return f?.log?.xRcrdWrite&&te("xRcrdWrite",ee,B),B.storage.setItem(ee,ae),B.listeners&&fe("write",B,ee,ae),0}catch(B){return y("kvrecordWrite()",B),p.setError(B,n.SQLITE_IOERR)}},xRcrdDelete:(E,x)=>{try{const M=V(E),B=_(M,E,x);return f?.log?.xRcrdDelete&&te("xRcrdDelete",B,M),M.storage.removeItem(B),M.listeners&&fe("delete",M,B),0}catch(M){return y("kvrecordDelete()",M),p.setError(M,n.SQLITE_IOERR)}}},vfs:{xOpen:function(E,x,M,B,ee){p.popError();let ae;try{x||(ae=T.allocCString(""+M+"."+(Math.random()*1e5|0)),x=ae);const _e=T.cstrToJs(x);f?.log?.xOpen&&N("xOpen",_e,"flags =",B),w(_e,!0),B&(n.SQLITE_OPEN_MAIN_DB|n.SQLITE_OPEN_TEMP_DB|n.SQLITE_OPEN_TRANSIENT_DB)&&p.rxJournalSuffix.test(_e)&&J(n.SQLITE_ERROR,"DB files may not have a '-journal' suffix.");let le=V(_e);!le&&!(B&n.SQLITE_OPEN_CREATE)&&J(n.SQLITE_ERROR,"Storage not found:",_e);const me=W.vfs.xOpen(E,x,M,B,ee);if(me)return me;let Ae=!!(n.SQLITE_OPEN_DELETEONCLOSE&B);T.isPtr(arguments[1])&&n.sqlite3_uri_boolean(x,"delete-on-close",0)&&(Ae=!0);const xe=new r(M);if(F.assert(xe.$zClass,"Missing f.$zClass"),xe.addOnDispose(ae),ae=void 0,le)++le.refc,le.files.push(xe),T.poke32(ee,B);else{T.poke32(ee,B|n.SQLITE_OPEN_CREATE),F.assert(!xe.$isJournal,"Opening a journal before its db? "+_e);const Se=_e.replace(p.rxJournalSuffix,"");le=O(Se),q(le),le.files.push(xe),le.deleteAtRefc0=Ae,f?.log?.xOpen&&N("xOpen installed storage handle [",Se,Se+"-journal","]",le)}return S.set(M,{store:le,file:xe,jzClass:_e}),le.listeners&&fe("open",le,le.files.length),0}catch(_e){return te("xOpen:",_e),p.setError(_e)}finally{ae&&T.dealloc(ae)}},xDelete:function(E,x,M){p.popError();try{const B=T.cstrToJs(x);return p.rxJournalSuffix.test(B)&&P.xRcrdDelete(x,p.zKeyJrnl),0}catch(B){return te("xDelete",B),p.setError(B)}},xAccess:function(E,x,M,B){p.popError();try{const ee=V(x),ae=ee?.jzClass||T.cstrToJs(x);if(f?.log?.xAccess&&N("xAccess",ae,"flags =",M,"*pResOut =",T.peek32(B),"store =",ee),!ee)try{w(ae)}catch{return T.poke32(B,0),0}if(ee){const _e=ee.keyPrefix+(p.rxJournalSuffix.test(ae)?"jrnl":"1"),le=ee.storage.getItem(_e)?0:1;T.poke32(B,le)}else T.poke32(B,0);return 0}catch(ee){return y("xAccess",ee),p.setError(ee)}},xRandomness:function(E,x,M){const B=T.heap8u();let ee=0;const ae=Number(M);for(;ee<x;++ee)B[ae+ee]=Math.random()*255e3&255;return x},xGetLastError:function(E,x,M){const B=p.popError();if(N("xGetLastError",B),B){const ee=T.scopedAllocPush();try{const[ae,_e]=T.scopedAllocCString(B.message,!0);return T.cstrncpy(M,ae,x),_e>x&&T.poke8(T.ptr.add(M,x,-1),0),N("set xGetLastError",B.message),B.resultCode|0||n.SQLITE_IOERR}catch{return n.SQLITE_NOMEM}finally{T.scopedAllocPop(ee)}}return 0}},ioDb:{xClose:function(E){p.popError();try{const x=S.get(E);if(f?.log?.xClose&&N("xClose",E,x),x){S.delete(E);const M=x.store;M.files=M.files.filter(B=>B!==x.file),--M.refc<=0&&M.deleteAtRefc0&&m(M),W.ioDb.xClose(E),x.file.dispose(),M.listeners&&fe("close",M,M.files.length)}return 0}catch(x){return y("xClose",x),p.setError(x)}},xFileControl:function(E,x,M){p.popError();try{const B=S.get(E);if(F.assert(B,"Missing KVVfsFile handle"),f?.log?.xFileControl&&N("xFileControl",B,"op =",x),x===n.SQLITE_FCNTL_PRAGMA&&Q.disablePageSizeChange){const ae=T.peekPtr(T.ptr.add(M,T.ptr.size));if(T.cstrToJs(ae)==="page_size"){f?.log?.xFileControl&&N("xFileControl pragma",T.cstrToJs(ae));const _e=T.peekPtr(T.ptr.add(M,2*T.ptr.size));if(_e)return f?.log?.xFileControl&&te("xFileControl pragma",B,"NOT setting page size to",T.cstrToJs(_e)),B.file.$szPage=-1,0;if(B.file.$szPage>0)return f?.log?.xFileControl&&te("xFileControl",B,"getting page size",B.file.$szPage),T.pokePtr(M,T.allocCString(""+B.file.$szPage)),0}}const ee=W.ioDb.xFileControl(E,x,M);return ee==0&&n.SQLITE_FCNTL_SYNC===x&&B.store.listeners&&fe("sync",B.store,!1),ee}catch(B){return y("xFileControl",B),p.setError(B)}},xSync:function(E,x){p.popError();try{const M=S.get(E);f?.log?.xSync&&N("xSync",M),F.assert(M,"Missing KVVfsFile handle");const B=W.ioDb.xSync(E,x);return B==0&&M.store.listeners&&fe("sync",M.store,!0),B}catch(M){return y("xSync",M),p.setError(M)}},xRead:function(E,x,M,B){p.popError();try{if(f?.log?.xRead){const ee=S.get(E);F.assert(ee,"Missing KVVfsFile handle"),N("xRead",M,B,ee)}return W.ioDb.xRead(E,x,M,B)}catch(ee){return y("xRead",ee),p.setError(ee)}},xWrite:function(E,x,M,B){p.popError();try{if(f?.log?.xWrite){const ee=S.get(E);F.assert(ee,"Missing KVVfsFile handle"),N("xWrite",M,B,ee)}return W.ioDb.xWrite(E,x,M,B)}catch(ee){return y("xWrite",ee),p.setError(ee)}}},ioJrnl:{xClose:!0}};N("pVfs and friends",K,D,h,G,n.sqlite3_file.structInfo,r.structInfo);try{F.assert(p.buffer.n>1024*129,"Heap buffer is not large enough");for(const E of Object.entries(ne.recordHandler)){const x=E[0],M=E[1];P[x]=M,G[G.memberKey(x)]=T.installFunction(G.memberSignature(x),M)}for(const E of Object.entries(ne.vfs)){const x=E[0],M=E[1],B=K.memberKey(x),ee=K.structInfo.members[x]||F.toss("Missing pVfs.structInfo[",x,"]");W.vfs[x]=T.functionEntry(K[B]),K[B]=T.installFunction(ee.signature,M)}for(const E of Object.entries(ne.ioDb)){const x=E[0],M=E[1],B=D.memberKey(x);W.ioDb[x]=T.functionEntry(D[B])||F.toss("Missing native pIoDb[",B,"]"),D[B]=T.installFunction(D.memberSignature(x),M)}for(const E of Object.entries(ne.ioJrnl)){const x=E[0],M=E[1],B=h.memberKey(x);W.ioJrnl[x]=T.functionEntry(h[B])||F.toss("Missing native pIoJrnl[",B,"]"),M===!0?h[B]=D[B]||F.toss("Missing copied pIoDb[",B,"]"):h[B]=T.installFunction(h.memberSignature(x),M)}}finally{G.dispose(),K.dispose(),D.dispose(),h.dispose()}const g=function E(x){if(x==="")return E("local")+E("session");const M=V(x);if(!M)return 0;M.files.length&&(globalThis.localStorage===M.storage||globalThis.sessionStorage===M.storage||J(n.SQLITE_ACCESS,"Cannot clear in-use database storage."));const B=M.storage,ee=[];let ae,_e=B.length;for(ae=0;ae<_e;++ae){const le=B.key(ae);(!M.keyPrefix||le.startsWith(M.keyPrefix))&&ee.push(le)}return ee.forEach(le=>B.removeItem(le)),ee.length},L=function E(x){if(x==="")return E("local")+E("session");const M=V(x);if(!M)return 0;const B=M.storage;let ee,ae=0;for(ee=0;ee<B.length;++ee){const _e=B.key(ee);(!M.keyPrefix||_e.startsWith(M.keyPrefix))&&(ae+=_e.length,ae+=B.getItem(_e).length)}return ae*2},H=function(...x){let M;x.length===1&&typeof x[0]=="object"?M=x[0]:x.length&&(M=Object.assign(Object.create(null),{name:x[0]}));const B=M?V(M.name):null;B||J(n.SQLITE_NOTFOUND,"There is no kvvfs storage named",M?.name);const ee=B.storage,ae=Object.assign(Object.create(null),{name:B.jzClass,timestamp:Date.now(),pages:[]}),_e=Object.create(null),le=B.keyPrefix,me=le?/^kvvfs-[^-]+-(\w+)/:void 0;let Ae=0,xe=ee.length;for(;Ae<xe;++Ae){const Se=ee.key(Ae);if(!le||Se.startsWith(le)){let Me=(le?me.exec(Se):void 0)?.[1]??Se;switch(Me){case"jrnl":M.includeJournal&&(ae.journal=ee.getItem(Se));break;case"sz":ae.size=+ee.getItem(Se);break;default:if(Me=+Me,(!F.isInt32(Me)||Me<=0)&&J(n.SQLITE_RANGE,"Malformed kvvfs key: "+Se),M.decodePages){const Ke=ee.getItem(Se),ct=Ke.length,Ge=p.memBuffer(0),qt=p.memBuffer(1),$e=T.heap8u();let tt=0;for(;tt<ct;++tt)$e[T.ptr.add(Ge,tt)]=Ke.codePointAt(tt)&255;$e[T.ptr.add(Ge,tt)]=0;const Tt=be(Ge,qt,p.buffer.n);_e[Me]=$e.slice(Number(qt),T.ptr.addn(qt,Tt))}else _e[Me]=ee.getItem(Se);break}}}return M.decodePages&&p.memBufferFree(1),Object.keys(_e).map(Se=>+Se).sort().forEach(Se=>ae.pages.push(_e[Se])),ae},re=function(E,x=!1){!E?.timestamp||!E.name||E.size===void 0||!Array.isArray(E.pages)?J(n.SQLITE_MISUSE,"Malformed export object."):(!E.size||E.size!==(E.size|0)||E.size>=2147483647)&&J(n.SQLITE_RANGE,"Invalid db size: "+E.size),w(E.name);let M=V(E.name);const B=!M;M?(x?!M.files||!M.jzClass?J(n.SQLITE_ERROR,"Internal storage object",E.name,"seems to be malformed."):M.files.length&&J(n.SQLITE_IOERR_ACCESS,"Cannot import db storage while it is in use."):J(n.SQLITE_ACCESS,"Storage '"+E.name+"' already exists and","overwrite was not specified."),g(E.name)):M=O(E.name);const ee=U(E.name);let ae;try{const _e=M.storage;_e.setItem(ee+"sz",E.size),E.journal&&_e.setItem(ee+"jrnl",E.journal),E.pages[0]instanceof Uint8Array?E.pages.forEach((le,me)=>{const Ae=le.length;ae??=p.memBuffer(1);const xe=p.memBuffer(0),Se=T.heap8u();Se.set(le,Number(xe)),Se[T.ptr.addn(xe,Ae)]=0;const Me=qe(xe,Ae,ae);F.assert(Me<p.buffer.n,"Impossibly long output - possibly smashed the heap"),F.assert(T.peek8(T.ptr.add(ae,Me))===0,"Expecting NUL-terminated encoded output");const Ke=T.cstrToJs(ae);_e.setItem(ee+(me+1),Ke)}):E.pages[0]&&E.pages.forEach((le,me)=>_e.setItem(ee+(me+1),le)),B&&q(M)}catch{if(!B)try{g(E.name)}catch{}}finally{ae&&p.memBufferFree(1)}return this},Z=function(E){let x=V(E);if(x){++x.refc;return}w(E),q(O(E))},ce=function(E){const x=V(E);return!x||R(x.jzClass)||Y(x.jzClass)||p.rxJournalSuffix.test(E)?!1:x.refc>x.files.length||x.files.length===0?(--x.refc<=0&&m(x),!0):!1},ve=function(E){(!E||typeof E!="object")&&J(n.SQLITE_MISUSE,"Expecting a listener object.");let x=V(E.storage);x||(E.storage&&E.reserve?(Z(E.storage),x=V(E.storage),F.assert(x,"Unexpectedly cannot fetch reserved storage "+E.storage)):J(n.SQLITE_NOTFOUND,"No such storage:",E.storage)),E.events&&(x.listeners??=[]).push(E)},ue=function(E){const x=V(E?.storage);if(x?.listeners&&E.events){const M=x.listeners.length;x.listeners=x.listeners.filter(ee=>ee!==E);const B=M>x.listeners.length;return x.listeners.length||(x.listeners=void 0),B}return!1};if(s.kvvfs.reserve=Z,s.kvvfs.import=re,s.kvvfs.export=H,s.kvvfs.unlink=ce,s.kvvfs.listen=ve,s.kvvfs.unlisten=ue,s.kvvfs.exists=E=>!!V(E),s.kvvfs.estimateSize=L,s.kvvfs.clear=g,globalThis.Storage&&(n.sqlite3_js_kvvfs_size=(E="")=>L(E),n.sqlite3_js_kvvfs_clear=(E="")=>g(E)),s.oo1?.DB){const E=s.oo1.DB;s.oo1.JsStorageDb=function(M=s.oo1.JsStorageDb.defaultStorageName){const B=E.dbCtorHelper.normalizeArgs(...arguments);switch(B.vfs="kvvfs",B.filename){case":sessionStorage:":B.filename="session";break;case":localStorage:":B.filename="local";break}const ee=/(file:(\/\/)?)([^?]+)/.exec(B.filename);w(ee?ee[3]:B.filename),E.dbCtorHelper.call(this,B)},s.oo1.JsStorageDb.defaultStorageName=p.storagePool.session?"session":j;const x=s.oo1.JsStorageDb;x.prototype=Object.create(E.prototype),x.clearStorage=g,x.prototype.clearStorage=function(){return x.clearStorage(this.affirmOpen().dbFilename(),!0)},x.storageSize=L,x.prototype.storageSize=function(){return x.storageSize(this.affirmOpen().dbFilename(),!0)}}if(s.__isUnderTest&&s.vtab){const E=Object.assign(Object.create(null),{rowid:{type:"INTEGER"},name:{type:"TEXT"},nRef:{type:"INTEGER"},nOpen:{type:"INTEGER"},isTransient:{type:"INTEGER"},dbSize:{type:"INTEGER"}});Object.keys(E).forEach((_e,le)=>E[_e].colId=le);const x=s.vtab,M=Object.assign(Object.create(null),{row:function(){return p.storagePool[this.names[this.rowid]]}});Object.assign(Object.create(M),{rowid:0,names:Object.keys(p.storagePool).filter(_e=>!p.rxJournalSuffix.test(_e))});const B=function(_e,le){const me=_e instanceof n.sqlite3_vtab_cursor?_e:x.xCursor.get(_e);return(le||!me.vTabState)&&(me.vTabState=Object.assign(Object.create(M),{rowid:0,names:Object.keys(p.storagePool).filter(Ae=>!p.rxJournalSuffix.test(Ae))})),me.vTabState},ee=()=>{},ae=function _e(){return _e.mod??=new s.capi.sqlite3_module().setupModule({catchExceptions:!0,methods:{xConnect:function(le,me,Ae,xe,Se,Me){try{const Ke=[];Object.keys(E).forEach(Ge=>{Ke.push(Ge+" "+E[Ge].type)});const ct=n.sqlite3_declare_vtab(le,"CREATE TABLE ignored("+Ke.join(",")+")");if(ct===0){const Ge=x.xVtab.create(Se);F.assert(Ge===x.xVtab.get(T.peekPtr(Se)),"output pointer check failed")}return ct}catch(Ke){return x.xErrror("xConnect",Ke,n.SQLITE_ERROR)}},xCreate:T.ptr.null,xDisconnect:function(le){return x.xVtab.dispose(le),0},xOpen:function(le,me){return x.xCursor.create(me),0},xClose:function(le){const me=x.xCursor.unget(le);return delete me.vTabState,me.dispose(),0},xNext:function(le){const me=x.xCursor.get(le);return++B(me).rowid,0},xColumn:function(le,me,Ae){const xe=B(le),Se=xe.row();switch(F.assert(Se,"Unexpected xColumn call"),Ae){case E.rowid.colId:n.sqlite3_result_int(me,xe.rowid);break;case E.name.colId:n.sqlite3_result_text(me,Se.jzClass,-1,n.SQLITE_TRANSIENT);break;case E.nRef.colId:n.sqlite3_result_int(me,Se.refc);break;case E.nOpen.colId:n.sqlite3_result_int(me,Se.files.length);break;case E.isTransient.colId:n.sqlite3_result_int(me,!!Se.deleteAtRefc0);break;case E.dbSize.colId:n.sqlite3_result_int(me,d(Se));break;default:return n.sqlite3_result_error(me,"Invalid column id: "+Ae),n.SQLITE_RANGE}return 0},xRowid:function(le,me){const Ae=B(le);return x.xRowid(me,Ae.rowid),0},xEof:function(le){const me=B(le);return ee("xEof?="+!me.row(),...arguments),!me.row()},xFilter:function(le,me,Ae,xe,Se){return B(le,!0),0},xBestIndex:function(le,me){const Ae=new n.sqlite3_index_info(me);return Ae.$estimatedRows=p.storagePool.size,Ae.$estimatedCost=1,Ae.dispose(),0}}})};s.kvvfs.create_module=function(_e,le="sqlite_kvvfs"){return n.sqlite3_create_module(_e,le,ae(),T.ptr.null)}}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const n=function i(r){if(!globalThis.SharedArrayBuffer||!globalThis.Atomics)return Promise.reject(new Error("Cannot install OPFS: Missing SharedArrayBuffer and/or Atomics. The server must emit the COOP/COEP response headers to enable those. See https://sqlite.org/wasm/doc/trunk/persistence.md#coop-coep"));if(typeof WorkerGlobalScope>"u")return Promise.reject(new Error("The OPFS sqlite3_vfs cannot run in the main thread because it requires Atomics.wait()."));if(!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle||!globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle||!navigator?.storage?.getDirectory)return Promise.reject(new Error("Missing required OPFS APIs."));(!r||typeof r!="object")&&(r=Object.create(null));const u=new URL(globalThis.location.href).searchParams;return u.has("opfs-disable")?Promise.resolve(s):(r.verbose===void 0&&(r.verbose=u.has("opfs-verbose")?+u.get("opfs-verbose")||2:1),r.sanityChecks===void 0&&(r.sanityChecks=u.has("opfs-sanity-check")),r.proxyUri===void 0&&(r.proxyUri=i.defaultProxyUri),typeof r.proxyUri=="function"&&(r.proxyUri=r.proxyUri()),new Promise(function(F,T){const J=[s.config.error,s.config.warn,s.config.log],C=(g,...L)=>{r.verbose>g&&J[g]("OPFS syncer:",...L)},G=(...g)=>C(2,...g),p=(...g)=>C(1,...g),z=(...g)=>C(0,...g),N=s.util.toss,te=s.capi,y=s.util,b=s.wasm,R=te.sqlite3_vfs,U=te.sqlite3_file,w=te.sqlite3_io_methods,O=Object.create(null),f=()=>globalThis.FileSystemHandle&&globalThis.FileSystemDirectoryHandle&&globalThis.FileSystemFileHandle&&globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle&&navigator?.storage?.getDirectory;O.metrics={dump:function(){let g,L=0,H=0,re=0;for(g in V.opIds){const Z=I[g];L+=Z.count,H+=Z.time,re+=Z.wait,Z.avgTime=Z.count&&Z.time?Z.time/Z.count:0,Z.avgWait=Z.count&&Z.wait?Z.wait/Z.count:0}s.config.log(globalThis.location.href,"metrics for",globalThis.location.href,":",I,`
Total of`,L,"op(s) for",H,"ms (incl. "+re+" ms of waiting on the async side)"),s.config.log("Serialization metrics:",I.s11n),be.postMessage({type:"opfs-async-metrics"})},reset:function(){let g;const L=re=>re.count=re.time=re.wait=0;for(g in V.opIds)L(I[g]=Object.create(null));let H=I.s11n=Object.create(null);H=H.serialize=Object.create(null),H.count=H.time=0,H=I.s11n.deserialize=Object.create(null),H.count=H.time=0}};const m=new w,q=new R().addOnDispose(()=>m.dispose());let j;const Y=g=>(j=!0,q.dispose(),T(g)),oe=()=>(j=!1,F(s)),be=new Worker(new URL("/itdashboard/assets/sqlite3-opfs-async-proxy-BWKAW6aw.js",self.location.href));setTimeout(()=>{j===void 0&&Y(new Error("Timeout while waiting for OPFS async proxy worker."))},4e3),be._originalOnError=be.onerror,be.onerror=function(g){z("Error initializing OPFS asyncer:",g),Y(new Error("Loading OPFS async Worker failed for unknown reasons."))};const qe=te.sqlite3_vfs_find(null),fe=qe?new R(qe):null;m.$iVersion=1,q.$iVersion=2,q.$szOsFile=te.sqlite3_file.structInfo.sizeof,q.$mxPathname=1024,q.$zName=b.allocCString("opfs"),q.$xDlOpen=q.$xDlError=q.$xDlSym=q.$xDlClose=null,q.addOnDispose("$zName",q.$zName,"cleanup default VFS wrapper",()=>fe?fe.dispose():null);const V=Object.create(null);V.verbose=r.verbose,V.littleEndian=(()=>{const g=new ArrayBuffer(2);return new DataView(g).setInt16(0,256,!0),new Int16Array(g)[0]===256})(),V.asyncIdleWaitTime=150,V.asyncS11nExceptions=1,V.fileBufferSize=65536,V.sabS11nOffset=V.fileBufferSize,V.sabS11nSize=q.$mxPathname*2,V.sabIO=new SharedArrayBuffer(V.fileBufferSize+V.sabS11nSize),V.opIds=Object.create(null);const I=Object.create(null);{let g=0;V.opIds.whichOp=g++,V.opIds.rc=g++,V.opIds.xAccess=g++,V.opIds.xClose=g++,V.opIds.xDelete=g++,V.opIds.xDeleteNoWait=g++,V.opIds.xFileSize=g++,V.opIds.xLock=g++,V.opIds.xOpen=g++,V.opIds.xRead=g++,V.opIds.xSleep=g++,V.opIds.xSync=g++,V.opIds.xTruncate=g++,V.opIds.xUnlock=g++,V.opIds.xWrite=g++,V.opIds.mkdir=g++,V.opIds["opfs-async-metrics"]=g++,V.opIds["opfs-async-shutdown"]=g++,V.opIds.retry=g++,V.sabOP=new SharedArrayBuffer(g*4),O.metrics.reset()}V.sq3Codes=Object.create(null),["SQLITE_ACCESS_EXISTS","SQLITE_ACCESS_READWRITE","SQLITE_BUSY","SQLITE_CANTOPEN","SQLITE_ERROR","SQLITE_IOERR","SQLITE_IOERR_ACCESS","SQLITE_IOERR_CLOSE","SQLITE_IOERR_DELETE","SQLITE_IOERR_FSYNC","SQLITE_IOERR_LOCK","SQLITE_IOERR_READ","SQLITE_IOERR_SHORT_READ","SQLITE_IOERR_TRUNCATE","SQLITE_IOERR_UNLOCK","SQLITE_IOERR_WRITE","SQLITE_LOCK_EXCLUSIVE","SQLITE_LOCK_NONE","SQLITE_LOCK_PENDING","SQLITE_LOCK_RESERVED","SQLITE_LOCK_SHARED","SQLITE_LOCKED","SQLITE_MISUSE","SQLITE_NOTFOUND","SQLITE_OPEN_CREATE","SQLITE_OPEN_DELETEONCLOSE","SQLITE_OPEN_MAIN_DB","SQLITE_OPEN_READONLY"].forEach(g=>{(V.sq3Codes[g]=te[g])===void 0&&N("Maintenance required: not found:",g)}),V.opfsFlags=Object.assign(Object.create(null),{OPFS_UNLOCK_ASAP:1,OPFS_UNLINK_BEFORE_OPEN:2,defaultUnlockAsap:!1});const a=(g,...L)=>{const H=V.opIds[g]||N("Invalid op ID:",g);V.s11n.serialize(...L),Atomics.store(V.sabOPView,V.opIds.rc,-1),Atomics.store(V.sabOPView,V.opIds.whichOp,H),Atomics.notify(V.sabOPView,V.opIds.whichOp);const re=performance.now();for(;Atomics.wait(V.sabOPView,V.opIds.rc,-1)!=="not-equal";);const Z=Atomics.load(V.sabOPView,V.opIds.rc);if(I[g].wait+=performance.now()-re,Z&&V.asyncS11nExceptions){const ce=V.s11n.deserialize();ce&&z(g+"() async error:",...ce)}return Z};O.debug={asyncShutdown:()=>{p("Shutting down OPFS async listener. The OPFS VFS will no longer work."),a("opfs-async-shutdown")},asyncRestart:()=>{p("Attempting to restart OPFS VFS async listener. Might work, might not."),be.postMessage({type:"opfs-async-restart"})}};const _=()=>{if(V.s11n)return V.s11n;const g=new TextDecoder,L=new TextEncoder("utf-8"),H=new Uint8Array(V.sabIO,V.sabS11nOffset,V.sabS11nSize),re=new DataView(V.sabIO,V.sabS11nOffset,V.sabS11nSize);V.s11n=Object.create(null);const Z=Object.create(null);Z.number={id:1,size:8,getter:"getFloat64",setter:"setFloat64"},Z.bigint={id:2,size:8,getter:"getBigInt64",setter:"setBigInt64"},Z.boolean={id:3,size:4,getter:"getInt32",setter:"setInt32"},Z.string={id:4};const ce=ue=>Z[typeof ue]||N("Maintenance required: this value type cannot be serialized.",ue),ve=ue=>{switch(ue){case Z.number.id:return Z.number;case Z.bigint.id:return Z.bigint;case Z.boolean.id:return Z.boolean;case Z.string.id:return Z.string;default:N("Invalid type ID:",ue)}};return V.s11n.deserialize=function(ue=!1){++I.s11n.deserialize.count;const E=performance.now(),x=H[0],M=x?[]:null;if(x){const B=[];let ee=1,ae,_e,le;for(ae=0;ae<x;++ae,++ee)B.push(ve(H[ee]));for(ae=0;ae<x;++ae){const me=B[ae];me.getter?(le=re[me.getter](ee,V.littleEndian),ee+=me.size):(_e=re.getInt32(ee,V.littleEndian),ee+=4,le=g.decode(H.slice(ee,ee+_e)),ee+=_e),M.push(le)}}return ue&&(H[0]=0),I.s11n.deserialize.time+=performance.now()-E,M},V.s11n.serialize=function(...ue){const E=performance.now();if(++I.s11n.serialize.count,ue.length){const x=[];let M=0,B=1;for(H[0]=ue.length&255;M<ue.length;++M,++B)x.push(ce(ue[M])),H[B]=x[M].id;for(M=0;M<ue.length;++M){const ee=x[M];if(ee.setter)re[ee.setter](B,ue[M],V.littleEndian),B+=ee.size;else{const ae=L.encode(ue[M]);re.setInt32(B,ae.byteLength,V.littleEndian),B+=4,H.set(ae,B),B+=ae.byteLength}}}else H[0]=0;I.s11n.serialize.time+=performance.now()-E},V.s11n},d=function g(L=16){g._chars||(g._chars="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ012346789",g._n=g._chars.length);const H=[];let re=0;for(;re<L;++re){const Z=Math.random()*(g._n*64)%g._n|0;H[re]=g._chars[Z]}return H.join("")},S=Object.create(null),W=Object.create(null);W.op=void 0,W.start=void 0;const K=g=>{W.start=performance.now(),W.op=g,++I[g].count},D=()=>I[W.op].time+=performance.now()-W.start,h={xCheckReservedLock:function(g,L){return b.poke(L,0,"i32"),0},xClose:function(g){K("xClose");let L=0;const H=S[g];return H&&(delete S[g],L=a("xClose",g),H.sq3File&&H.sq3File.dispose()),D(),L},xDeviceCharacteristics:function(g){return te.SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN},xFileControl:function(g,L,H){return te.SQLITE_NOTFOUND},xFileSize:function(g,L){K("xFileSize");let H=a("xFileSize",g);if(H==0)try{const re=V.s11n.deserialize()[0];b.poke(L,re,"i64")}catch(re){z("Unexpected error reading xFileSize() result:",re),H=V.sq3Codes.SQLITE_IOERR}return D(),H},xLock:function(g,L){K("xLock");const H=S[g];let re=0;return H.lockType?H.lockType=L:(re=a("xLock",g,L),re===0&&(H.lockType=L)),D(),re},xRead:function(g,L,H,re){K("xRead");const Z=S[g];let ce;try{ce=a("xRead",g,H,Number(re)),(ce===0||te.SQLITE_IOERR_SHORT_READ===ce)&&b.heap8u().set(Z.sabView.subarray(0,H),Number(L))}catch(ve){z("xRead(",arguments,") failed:",ve,Z),ce=te.SQLITE_IOERR_READ}return D(),ce},xSync:function(g,L){K("xSync"),++I.xSync.count;const H=a("xSync",g,L);return D(),H},xTruncate:function(g,L){K("xTruncate");const H=a("xTruncate",g,Number(L));return D(),H},xUnlock:function(g,L){K("xUnlock");const H=S[g];let re=0;return te.SQLITE_LOCK_NONE===L&&H.lockType&&(re=a("xUnlock",g,L)),re===0&&(H.lockType=L),D(),re},xWrite:function(g,L,H,re){K("xWrite");const Z=S[g];let ce;try{Z.sabView.set(b.heap8u().subarray(Number(L),Number(L)+H)),ce=a("xWrite",g,H,Number(re))}catch(ve){z("xWrite(",arguments,") failed:",ve,Z),ce=te.SQLITE_IOERR_WRITE}return D(),ce}},P={xAccess:function(g,L,H,re){K("xAccess");const Z=a("xAccess",b.cstrToJs(L));return b.poke(re,Z?0:1,"i32"),D(),0},xCurrentTime:function(g,L){return b.poke(L,24405875e-1+new Date().getTime()/864e5,"double"),0},xCurrentTimeInt64:function(g,L){return b.poke(L,24405875e-1*864e5+new Date().getTime(),"i64"),0},xDelete:function(g,L,H){K("xDelete");const re=a("xDelete",b.cstrToJs(L),H,!1);return D(),re},xFullPathname:function(g,L,H,re){return b.cstrncpy(re,L,H)<H?0:te.SQLITE_CANTOPEN},xGetLastError:function(g,L,H){return p("OPFS xGetLastError() has nothing sensible to return."),0},xOpen:function(L,H,re,Z,ce){K("xOpen");let ve=0;H===0?H=d():b.isPtr(H)&&(te.sqlite3_uri_boolean(H,"opfs-unlock-asap",0)&&(ve|=V.opfsFlags.OPFS_UNLOCK_ASAP),te.sqlite3_uri_boolean(H,"delete-before-open",0)&&(ve|=V.opfsFlags.OPFS_UNLINK_BEFORE_OPEN),H=b.cstrToJs(H));const ue=Object.create(null);ue.fid=re,ue.filename=H,ue.sab=new SharedArrayBuffer(V.fileBufferSize),ue.flags=Z,ue.readOnly=!(te.SQLITE_OPEN_CREATE&Z)&&!!(Z&te.SQLITE_OPEN_READONLY);const E=a("xOpen",re,H,Z,ve);return E||(ue.readOnly&&b.poke(ce,te.SQLITE_OPEN_READONLY,"i32"),S[re]=ue,ue.sabView=V.sabFileBufView,ue.sq3File=new U(re),ue.sq3File.$pMethods=m.pointer,ue.lockType=te.SQLITE_LOCK_NONE),D(),E}};fe&&(q.$xRandomness=fe.$xRandomness,q.$xSleep=fe.$xSleep),q.$xRandomness||(P.xRandomness=function(g,L,H){const re=b.heap8u();let Z=0;const ce=Number(H);for(;Z<L;++Z)re[ce+Z]=Math.random()*255e3&255;return Z}),q.$xSleep||(P.xSleep=function(g,L){return Atomics.wait(V.sabOPView,V.opIds.xSleep,0,L),0}),O.getResolvedPath=function(g,L){const H=new URL(g,"file://irrelevant").pathname;return L?H.split("/").filter(re=>!!re):H},O.getDirForFilename=async function(L,H=!1){const re=O.getResolvedPath(L,!0),Z=re.pop();let ce=O.rootDirectory;for(const ve of re)ve&&(ce=await ce.getDirectoryHandle(ve,{create:!!H}));return[ce,Z]},O.mkdir=async function(g){try{return await O.getDirForFilename(g+"/filepart",!0),!0}catch{return!1}},O.entryExists=async function(g){try{const[L,H]=await O.getDirForFilename(g);return await L.getFileHandle(H),!0}catch{return!1}},O.randomFilename=d,O.treeList=async function(){const g=async function H(re,Z){Z.name=re.name,Z.dirs=[],Z.files=[];for await(const ce of re.values())if(ce.kind==="directory"){const ve=Object.create(null);Z.dirs.push(ve),await H(ce,ve)}else Z.files.push(ce.name)},L=Object.create(null);return await g(O.rootDirectory,L),L},O.rmfr=async function(){const g=O.rootDirectory,L={recurse:!0};for await(const H of g.values())g.removeEntry(H.name,L)},O.unlink=async function(g,L=!1,H=!1){try{const[re,Z]=await O.getDirForFilename(g,!1);return await re.removeEntry(Z,{recursive:L}),!0}catch(re){if(H)throw new Error("unlink(",arguments[0],") failed: "+re.message,{cause:re});return!1}},O.traverse=async function(g){const L={recursive:!0,directory:O.rootDirectory};typeof g=="function"&&(g={callback:g}),g=Object.assign(L,g||{}),(async function H(re,Z){for await(const ce of re.values()){if(g.callback(ce,re,Z)===!1)return!1;if(g.recursive&&ce.kind==="directory"&&await H(ce,Z+1)===!1)break}})(g.directory,0)};const Q=async function(g,L){const[H,re]=await O.getDirForFilename(g,!0);let Z=await(await H.getFileHandle(re,{create:!0})).createSyncAccessHandle(),ce=0,ve,ue=!1;try{for(Z.truncate(0);(ve=await L())!==void 0;)ve instanceof ArrayBuffer&&(ve=new Uint8Array(ve)),!ue&&ce===0&&ve.byteLength>=15&&(y.affirmDbHeader(ve),ue=!0),Z.write(ve,{at:ce}),ce+=ve.byteLength;if((ce<512||ce%512!==0)&&N("Input size",ce,"is not correct for an SQLite database."),!ue){const E=new Uint8Array(20);Z.read(E,{at:0}),y.affirmDbHeader(E)}return Z.write(new Uint8Array([1,1]),{at:18}),ce}catch(E){throw await Z.close(),Z=void 0,await H.removeEntry(re).catch(()=>{}),E}finally{Z&&await Z.close()}};if(O.importDb=async function(g,L){if(L instanceof Function)return Q(g,L);L instanceof ArrayBuffer&&(L=new Uint8Array(L)),y.affirmIsDb(L);const H=L.byteLength,[re,Z]=await O.getDirForFilename(g,!0);let ce,ve=0;try{return ce=await(await re.getFileHandle(Z,{create:!0})).createSyncAccessHandle(),ce.truncate(0),ve=ce.write(L,{at:0}),ve!=H&&N("Expected to write "+H+" bytes but wrote "+ve+"."),ce.write(new Uint8Array([1,1]),{at:18}),ve}catch(ue){throw ce&&(await ce.close(),ce=void 0),await re.removeEntry(Z).catch(()=>{}),ue}finally{ce&&await ce.close()}},s.oo1){const g=function(...L){const H=s.oo1.DB.dbCtorHelper.normalizeArgs(...L);H.vfs=q.$zName,s.oo1.DB.dbCtorHelper.call(this,H)};g.prototype=Object.create(s.oo1.DB.prototype),s.oo1.OpfsDb=g,g.importDb=O.importDb,s.oo1.DB.dbCtorHelper.setVfsPostOpenCallback(q.pointer,function(L,H){H.capi.sqlite3_busy_timeout(L,1e4)})}const ne=function(){const g=b.scopedAllocPush(),L=new U;try{const H=L.pointer,re=te.SQLITE_OPEN_CREATE|te.SQLITE_OPEN_READWRITE|te.SQLITE_OPEN_MAIN_DB,Z=b.scopedAlloc(8),ce="/sanity/check/file"+d(8),ve=b.scopedAllocCString(ce);let ue;if(V.s11n.serialize("This is  string."),ue=V.s11n.deserialize(),G("deserialize() says:",ue),ue[0]!=="This is  string."&&N("String d13n error."),P.xAccess(q.pointer,ve,0,Z),ue=b.peek(Z,"i32"),G("xAccess(",ce,") exists ?=",ue),ue=P.xOpen(q.pointer,ve,H,re,Z),G("open rc =",ue,"state.sabOPView[xOpen] =",V.sabOPView[V.opIds.xOpen]),ue!==0){z("open failed with code",ue);return}P.xAccess(q.pointer,ve,0,Z),ue=b.peek(Z,"i32"),ue||N("xAccess() failed to detect file."),ue=h.xSync(L.pointer,0),ue&&N("sync failed w/ rc",ue),ue=h.xTruncate(L.pointer,1024),ue&&N("truncate failed w/ rc",ue),b.poke(Z,0,"i64"),ue=h.xFileSize(L.pointer,Z),ue&&N("xFileSize failed w/ rc",ue),G("xFileSize says:",b.peek(Z,"i64")),ue=h.xWrite(L.pointer,ve,10,1),ue&&N("xWrite() failed!");const E=b.scopedAlloc(16);ue=h.xRead(L.pointer,E,6,2),b.poke(E+6,0);let x=b.cstrToJs(E);G("xRead() got:",x),x!=="sanity"&&N("Unexpected xRead() value."),P.xSleep&&(G("xSleep()ing before close()ing..."),P.xSleep(q.pointer,2e3),G("waking up from xSleep()")),ue=h.xClose(H),G("xClose rc =",ue,"sabOPView =",V.sabOPView),G("Deleting file:",ce),P.xDelete(q.pointer,ve,4660),P.xAccess(q.pointer,ve,0,Z),ue=b.peek(Z,"i32"),ue&&N("Expecting 0 from xAccess(",ce,") after xDelete()."),p("End of OPFS sanity checks.")}finally{L.dispose(),b.scopedAllocPop(g)}};be.onmessage=function({data:g}){switch(g.type){case"opfs-unavailable":Y(new Error(g.payload.join(" ")));break;case"opfs-async-loaded":be.postMessage({type:"opfs-async-init",args:V});break;case"opfs-async-inited":if(j===!0)break;try{s.vfs.installVfs({io:{struct:m,methods:h},vfs:{struct:q,methods:P}}),V.sabOPView=new Int32Array(V.sabOP),V.sabFileBufView=new Uint8Array(V.sabIO,0,V.fileBufferSize),V.sabS11nView=new Uint8Array(V.sabIO,V.sabS11nOffset,V.sabS11nSize),_(),r.sanityChecks&&(p("Running sanity checks because of opfs-sanity-check URL arg..."),ne()),f()?navigator.storage.getDirectory().then(L=>{be.onerror=be._originalOnError,delete be._originalOnError,s.opfs=O,O.rootDirectory=L,G("End of OPFS sqlite3_vfs setup.",q),oe()}).catch(Y):oe()}catch(L){z(L),Y(L)}break;default:{const L="Unexpected message from the OPFS async worker: "+JSON.stringify(g);z(L),Y(new Error(L));break}}}}))};n.defaultProxyUri="sqlite3-opfs-async-proxy.js",globalThis.sqlite3ApiBootstrap.initializersAsync.push(async i=>{try{let r=n.defaultProxyUri;return i?.scriptInfo?.sqlite3Dir&&(n.defaultProxyUri=i.scriptInfo.sqlite3Dir+r),n().catch(u=>{i.config.warn("Ignoring inability to install OPFS sqlite3_vfs:",u.message)})}catch(r){return i.config.error("installOpfsVfs() exception:",r),Promise.reject(r)}})}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const n=s.util.toss,i=s.util.toss3,r=Object.create(null),u=s.capi,F=s.util,T=s.wasm,J=4096,C=512,G=4,p=8,z=C+G,N=C,te=z,y=J,b=u.SQLITE_OPEN_MAIN_DB|u.SQLITE_OPEN_MAIN_JOURNAL|u.SQLITE_OPEN_SUPER_JOURNAL|u.SQLITE_OPEN_WAL,R=u.SQLITE_OPEN_MEMORY,U=".opaque",w=()=>Math.random().toString(36).slice(2),O=new TextDecoder,f=new TextEncoder,m=Object.assign(Object.create(null),{name:"opfs-sahpool",directory:void 0,initialCapacity:6,clearOnInit:!1,verbosity:2,forceReinitIfPreviouslyFailed:!1}),q=[s.config.error,s.config.warn,s.config.log];s.config.log;const j=s.config.warn;s.config.error;const Y=new Map,oe=D=>Y.get(D),be=(D,h)=>{h?Y.set(D,h):Y.delete(D)},qe=new Map,fe=D=>qe.get(D),V=(D,h)=>{h?qe.set(D,h):qe.delete(D)},I={xCheckReservedLock:function(D,h){const P=fe(D);return P.log("xCheckReservedLock"),P.storeErr(),T.poke32(h,1),0},xClose:function(D){const h=fe(D);h.storeErr();const P=h.getOFileForS3File(D);if(P)try{h.log(`xClose ${P.path}`),h.mapS3FileToOFile(D,!1),P.sah.flush(),P.flags&u.SQLITE_OPEN_DELETEONCLOSE&&h.deletePath(P.path)}catch(Q){return h.storeErr(Q,u.SQLITE_IOERR)}return 0},xDeviceCharacteristics:function(D){return u.SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN},xFileControl:function(D,h,P){return u.SQLITE_NOTFOUND},xFileSize:function(D,h){const P=fe(D);P.log("xFileSize");const Q=P.getOFileForS3File(D).sah.getSize()-y;return T.poke64(h,BigInt(Q)),0},xLock:function(D,h){const P=fe(D);P.log(`xLock ${h}`),P.storeErr();const Q=P.getOFileForS3File(D);return Q.lockType=h,0},xRead:function(D,h,P,Q){const ne=fe(D);ne.storeErr();const g=ne.getOFileForS3File(D);ne.log(`xRead ${g.path} ${P} @ ${Q}`);try{const L=g.sah.read(T.heap8u().subarray(Number(h),Number(h)+P),{at:y+Number(Q)});return L<P?(T.heap8u().fill(0,Number(h)+L,Number(h)+P),u.SQLITE_IOERR_SHORT_READ):0}catch(L){return ne.storeErr(L,u.SQLITE_IOERR)}},xSectorSize:function(D){return J},xSync:function(D,h){const P=fe(D);P.log(`xSync ${h}`),P.storeErr();const Q=P.getOFileForS3File(D);try{return Q.sah.flush(),0}catch(ne){return P.storeErr(ne,u.SQLITE_IOERR)}},xTruncate:function(D,h){const P=fe(D);P.log(`xTruncate ${h}`),P.storeErr();const Q=P.getOFileForS3File(D);try{return Q.sah.truncate(y+Number(h)),0}catch(ne){return P.storeErr(ne,u.SQLITE_IOERR)}},xUnlock:function(D,h){const P=fe(D);P.log("xUnlock");const Q=P.getOFileForS3File(D);return Q.lockType=h,0},xWrite:function(D,h,P,Q){const ne=fe(D);ne.storeErr();const g=ne.getOFileForS3File(D);ne.log(`xWrite ${g.path} ${P} ${Q}`);try{return P===g.sah.write(T.heap8u().subarray(Number(h),Number(h)+P),{at:y+Number(Q)})?0:n("Unknown write() failure.")}catch(L){return ne.storeErr(L,u.SQLITE_IOERR)}}},a=new u.sqlite3_io_methods;a.$iVersion=1,s.vfs.installVfs({io:{struct:a,methods:I}});const _={xAccess:function(D,h,P,Q){const ne=oe(D);ne.storeErr();try{const g=ne.getPath(h);T.poke32(Q,ne.hasFilename(g)?1:0)}catch{T.poke32(Q,0)}return 0},xCurrentTime:function(D,h){return T.poke(h,24405875e-1+new Date().getTime()/864e5,"double"),0},xCurrentTimeInt64:function(D,h){return T.poke(h,24405875e-1*864e5+new Date().getTime(),"i64"),0},xDelete:function(D,h,P){const Q=oe(D);Q.log(`xDelete ${T.cstrToJs(h)}`),Q.storeErr();try{return Q.deletePath(Q.getPath(h)),0}catch(ne){return Q.storeErr(ne),u.SQLITE_IOERR_DELETE}},xFullPathname:function(D,h,P,Q){return T.cstrncpy(Q,h,P)<P?0:u.SQLITE_CANTOPEN},xGetLastError:function(D,h,P){const Q=oe(D),ne=Q.popErr();if(Q.log(`xGetLastError ${h} e =`,ne),ne){const g=T.scopedAllocPush();try{const[L,H]=T.scopedAllocCString(ne.message,!0);T.cstrncpy(P,L,h),H>h&&T.poke8(T.ptr.add(P,h,-1),0)}catch{return u.SQLITE_NOMEM}finally{T.scopedAllocPop(g)}}return ne?ne.sqlite3Rc||u.SQLITE_IOERR:0},xOpen:function(h,P,Q,ne,g){const L=oe(h);try{ne&=~R,L.log(`xOpen ${T.cstrToJs(P)} ${ne}`);const H=P&&T.peek8(P)?L.getPath(P):w();let re=L.getSAHForPath(H);!re&&ne&u.SQLITE_OPEN_CREATE&&(L.getFileCount()<L.getCapacity()?(re=L.nextAvailableSAH(),L.setAssociatedPath(re,H,ne)):n("SAH pool is full. Cannot create file",H)),re||n("file not found:",H);const Z={path:H,flags:ne,sah:re};L.mapS3FileToOFile(Q,Z),Z.lockType=u.SQLITE_LOCK_NONE;const ce=new u.sqlite3_file(Q);return ce.$pMethods=a.pointer,ce.dispose(),T.poke32(g,ne),0}catch(H){return L.storeErr(H),u.SQLITE_CANTOPEN}}},d=function(D){s.capi.sqlite3_vfs_find(D)&&i("VFS name is already registered:",D);const h=new u.sqlite3_vfs,P=u.sqlite3_vfs_find(null),Q=P?new u.sqlite3_vfs(P):null;return h.$iVersion=2,h.$szOsFile=u.sqlite3_file.structInfo.sizeof,h.$mxPathname=C,h.addOnDispose(h.$zName=T.allocCString(D),()=>be(h.pointer,0)),Q&&(h.$xRandomness=Q.$xRandomness,h.$xSleep=Q.$xSleep,Q.dispose()),!h.$xRandomness&&!_.xRandomness&&(_.xRandomness=function(ne,g,L){const H=T.heap8u();let re=0;const Z=Number(L);for(;re<g;++re)H[Z+re]=Math.random()*255e3&255;return re}),!h.$xSleep&&!_.xSleep&&(_.xSleep=(ne,g)=>0),s.vfs.installVfs({vfs:{struct:h,methods:_}}),h};class S{vfsDir;#e;#r;#a;#i=new Map;#t=new Map;#s=new Set;#l=new Map;#n=new Uint8Array(z);#c;#o;#_;constructor(h=Object.create(null)){this.#_=h.verbosity??m.verbosity,this.vfsName=h.name||m.name,this.#o=d(this.vfsName),be(this.#o.pointer,this),this.vfsDir=h.directory||"."+this.vfsName,this.#c=new DataView(this.#n.buffer,this.#n.byteOffset),this.isReady=this.reset(!!(h.clearOnInit??m.clearOnInit)).then(()=>{if(this.$error)throw this.$error;return this.getCapacity()?Promise.resolve(void 0):this.addCapacity(h.initialCapacity||m.initialCapacity)})}#u(h,...P){this.#_>h&&q[h](this.vfsName+":",...P)}log(...h){this.#u(2,...h)}warn(...h){this.#u(1,...h)}error(...h){this.#u(0,...h)}getVfs(){return this.#o}getCapacity(){return this.#i.size}getFileCount(){return this.#t.size}getFileNames(){const h=[];for(const P of this.#t.keys())h.push(P);return h}async addCapacity(h){for(let P=0;P<h;++P){const Q=w(),ne=await(await this.#r.getFileHandle(Q,{create:!0})).createSyncAccessHandle();this.#i.set(ne,Q),this.setAssociatedPath(ne,"",0)}return this.getCapacity()}async reduceCapacity(h){let P=0;for(const Q of Array.from(this.#s)){if(P===h||this.getFileCount()===this.getCapacity())break;const ne=this.#i.get(Q);Q.close(),await this.#r.removeEntry(ne),this.#i.delete(Q),this.#s.delete(Q),++P}return P}releaseAccessHandles(){for(const h of this.#i.keys())h.close();this.#i.clear(),this.#t.clear(),this.#s.clear()}async acquireAccessHandles(h=!1){const P=[];for await(const[Q,ne]of this.#r)ne.kind==="file"&&P.push([Q,ne]);return Promise.all(P.map(async([Q,ne])=>{try{const g=await ne.createSyncAccessHandle();if(this.#i.set(g,Q),h)g.truncate(y),this.setAssociatedPath(g,"",0);else{const L=this.getAssociatedPath(g);L?this.#t.set(L,g):this.#s.add(g)}}catch(g){throw this.storeErr(g),this.releaseAccessHandles(),g}}))}getAssociatedPath(h){h.read(this.#n,{at:0});const P=this.#c.getUint32(N);if(this.#n[0]&&(P&u.SQLITE_OPEN_DELETEONCLOSE||(P&b)===0))return j(`Removing file with unexpected flags ${P.toString(16)}`,this.#n),this.setAssociatedPath(h,"",0),"";const Q=new Uint32Array(p/4);h.read(Q,{at:te});const ne=this.computeDigest(this.#n,P);if(Q.every((g,L)=>g===ne[L])){const g=this.#n.findIndex(L=>L===0);return g===0&&h.truncate(y),g?O.decode(this.#n.subarray(0,g)):""}else return j("Disassociating file with bad digest."),this.setAssociatedPath(h,"",0),""}setAssociatedPath(h,P,Q){const ne=f.encodeInto(P,this.#n);C<=ne.written+1&&n("Path too long:",P),P&&Q&&(Q|=R),this.#n.fill(0,ne.written,C),this.#c.setUint32(N,Q);const g=this.computeDigest(this.#n,Q);h.write(this.#n,{at:0}),h.write(g,{at:te}),h.flush(),P?(this.#t.set(P,h),this.#s.delete(h)):(h.truncate(y),this.#s.add(h))}computeDigest(h,P){if(P&R){let Q=3735928559,ne=1103547991;for(const g of h)Q=Math.imul(Q^g,2654435761),ne=Math.imul(ne^g,104729);return new Uint32Array([Q>>>0,ne>>>0])}else return new Uint32Array([0,0])}async reset(h){await this.isReady;let P=await navigator.storage.getDirectory(),Q;for(const ne of this.vfsDir.split("/"))ne&&(Q=P,P=await P.getDirectoryHandle(ne,{create:!0}));return this.#e=P,this.#a=Q,this.#r=await this.#e.getDirectoryHandle(U,{create:!0}),this.releaseAccessHandles(),this.acquireAccessHandles(h)}getPath(h){return T.isPtr(h)&&(h=T.cstrToJs(h)),(h instanceof URL?h:new URL(h,"file://localhost/")).pathname}deletePath(h){const P=this.#t.get(h);return P&&(this.#t.delete(h),this.setAssociatedPath(P,"",0)),!!P}storeErr(h,P){return h&&(h.sqlite3Rc=P||u.SQLITE_IOERR,this.error(h)),this.$error=h,P}popErr(){const h=this.$error;return this.$error=void 0,h}nextAvailableSAH(){const[h]=this.#s.keys();return h}getOFileForS3File(h){return this.#l.get(h)}mapS3FileToOFile(h,P){P?(this.#l.set(h,P),V(h,this)):(this.#l.delete(h),V(h,!1))}hasFilename(h){return this.#t.has(h)}getSAHForPath(h){return this.#t.get(h)}async removeVfs(){if(!this.#o.pointer||!this.#r)return!1;u.sqlite3_vfs_unregister(this.#o.pointer),this.#o.dispose(),delete r[this.vfsName];try{this.releaseAccessHandles(),await this.#e.removeEntry(U,{recursive:!0}),this.#r=void 0,await this.#a.removeEntry(this.#e.name,{recursive:!0}),this.#e=this.#a=void 0}catch(h){s.config.error(this.vfsName,"removeVfs() failed with no recovery strategy:",h)}return!0}pauseVfs(){return this.#l.size>0&&s.SQLite3Error.toss(u.SQLITE_MISUSE,"Cannot pause VFS",this.vfsName,"because it has opened files."),this.#i.size>0&&(u.sqlite3_vfs_unregister(this.vfsName),this.releaseAccessHandles()),this}isPaused(){return this.#i.size===0}async unpauseVfs(){return this.#i.size===0?this.acquireAccessHandles(!1).then(()=>u.sqlite3_vfs_register(this.#o,0),this):this}exportFile(h){const P=this.#t.get(h)||n("File not found:",h),Q=P.getSize()-y,ne=new Uint8Array(Q>0?Q:0);if(Q>0){const g=P.read(ne,{at:y});g!=Q&&n("Expected to read "+Q+" bytes but read "+g+".")}return ne}async importDbChunked(h,P){const Q=this.#t.get(h)||this.nextAvailableSAH()||n("No available handles to import to.");Q.truncate(0);let ne=0,g,L=!1;try{for(;(g=await P())!==void 0;)g instanceof ArrayBuffer&&(g=new Uint8Array(g)),!L&&ne===0&&g.byteLength>=15&&(F.affirmDbHeader(g),L=!0),Q.write(g,{at:y+ne}),ne+=g.byteLength;if((ne<512||ne%512!==0)&&n("Input size",ne,"is not correct for an SQLite database."),!L){const H=new Uint8Array(20);Q.read(H,{at:0}),F.affirmDbHeader(H)}Q.write(new Uint8Array([1,1]),{at:y+18})}catch(H){throw this.setAssociatedPath(Q,"",0),H}return this.setAssociatedPath(Q,h,u.SQLITE_OPEN_MAIN_DB),ne}importDb(h,P){if(P instanceof ArrayBuffer)P=new Uint8Array(P);else if(P instanceof Function)return this.importDbChunked(h,P);const Q=this.#t.get(h)||this.nextAvailableSAH()||n("No available handles to import to."),ne=P.byteLength;(ne<512||ne%512!=0)&&n("Byte array size is invalid for an SQLite db.");const g="SQLite format 3";for(let H=0;H<15;++H)g.charCodeAt(H)!==P[H]&&n("Input does not contain an SQLite database header.");const L=Q.write(P,{at:y});return L!=ne?(this.setAssociatedPath(Q,"",0),n("Expected to write "+ne+" bytes but wrote "+L+".")):(Q.write(new Uint8Array([1,1]),{at:y+18}),this.setAssociatedPath(Q,h,u.SQLITE_OPEN_MAIN_DB)),L}}class W{#e;constructor(h){this.#e=h,this.vfsName=h.vfsName}async addCapacity(h){return this.#e.addCapacity(h)}async reduceCapacity(h){return this.#e.reduceCapacity(h)}getCapacity(){return this.#e.getCapacity(this.#e)}getFileCount(){return this.#e.getFileCount()}getFileNames(){return this.#e.getFileNames()}async reserveMinimumCapacity(h){const P=this.#e.getCapacity();return P<h?this.#e.addCapacity(h-P):P}exportFile(h){return this.#e.exportFile(h)}importDb(h,P){return this.#e.importDb(h,P)}async wipeFiles(){return this.#e.reset(!0)}unlink(h){return this.#e.deletePath(h)}async removeVfs(){return this.#e.removeVfs()}pauseVfs(){return this.#e.pauseVfs(),this}async unpauseVfs(){return this.#e.unpauseVfs().then(()=>this)}isPaused(){return this.#e.isPaused()}}const K=async()=>{const D=await navigator.storage.getDirectory(),h=".opfs-sahpool-sync-check-"+w(),P=(await(await D.getFileHandle(h,{create:!0})).createSyncAccessHandle()).close();return await P,await D.removeEntry(h),P?.then&&n("The local OPFS API is too old for opfs-sahpool:","it has an async FileSystemSyncAccessHandle.close() method."),!0};s.installOpfsSAHPoolVfs=async function(D=Object.create(null)){D=Object.assign(Object.create(null),m,D||{});const h=D.name;if(D.$testThrowPhase1)throw D.$testThrowPhase1;if(r[h])try{return await r[h]}catch(P){if(D.forceReinitIfPreviouslyFailed)delete r[h];else throw P}return!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle||!globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle||!navigator?.storage?.getDirectory?r[h]=Promise.reject(new Error("Missing required OPFS APIs.")):r[h]=K().then(async function(){if(D.$testThrowPhase2)throw D.$testThrowPhase2;const P=new S(D);return P.isReady.then(async()=>{const Q=new W(P);if(s.oo1){const ne=s.oo1,g=P.getVfs(),L=function(...H){const re=ne.DB.dbCtorHelper.normalizeArgs(...H);re.vfs=g.$zName,ne.DB.dbCtorHelper.call(this,re)};L.prototype=Object.create(ne.DB.prototype),Q.OpfsSAHPoolDb=L}return P.log("VFS initialized."),Q}).catch(async Q=>{throw await P.removeVfs().catch(()=>{}),Q})}).catch(P=>r[h]=Promise.reject(P))}});try{const s=Object.assign(Object.create(null),{memory:typeof Ze<"u"?Ze:t.wasmMemory,exports:typeof dt<"u"?dt:Object.prototype.hasOwnProperty.call(t,"wasmExports")?t.wasmExports:t.asm},globalThis.sqlite3ApiBootstrap.defaultConfig,globalThis.sqlite3ApiConfig||{});e.debugModule("Bootstrapping lib config",s);const n=globalThis.sqlite3ApiBootstrap(s);return delete globalThis.sqlite3ApiBootstrap,n}catch(s){throw console.error("sqlite3ApiBootstrap() error:",s),s}},jt?se=c:se=new Promise((e,t)=>{Et=e,wt=t}),se}Ot=(function(){const Ie=Ot;if(!Ie)throw new Error("Expecting sqlite3InitModule to be defined by the Emscripten build.");const se=globalThis.sqlite3InitModuleState=Object.assign(Object.create(null),{moduleScript:globalThis?.document?.currentScript,isWorker:typeof WorkerGlobalScope<"u",location:globalThis.location,urlParams:globalThis?.location?.href?new URL(globalThis.location.href).searchParams:new URLSearchParams,wasmFilename:"sqlite3.wasm"});if(se.debugModule=se.urlParams.has("sqlite3.debugModule")?(...pe)=>console.warn("sqlite3.debugModule:",...pe):()=>{},se.urlParams.has("sqlite3.dir"))se.sqlite3Dir=se.urlParams.get("sqlite3.dir")+"/";else if(se.moduleScript){const pe=se.moduleScript.src.split("/");pe.pop(),se.sqlite3Dir=pe.join("/")+"/"}const c=globalThis.sqlite3InitModule=function pe(...Le){return se.emscriptenLocateFile=Le[0]?.locateFile,se.emscriptenInstantiateWasm=Le[0]?.instantiateWasm,Ie(...Le).then(Ne=>{se.debugModule("sqlite3InitModule() sIMS =",se),se.debugModule("sqlite3InitModule() EmscriptenModule =",Ne);const We=Ne.runSQLite3PostLoadInit(se,Ne,!!pe.__isUnderTest);return se.debugModule("sqlite3InitModule() sqlite3 =",We),We}).catch(Ne=>{throw console.error("Exception loading sqlite3 module:",Ne),Ne})};if(c.ready=Ie.ready,se.moduleScript){let pe=se.moduleScript.src.split("/");pe.pop(),se.scriptDir=pe.join("/")+"/"}return se.debugModule("extern-post-js.c-pp.js sqlite3InitModuleState =",se),c})();var on=Ot;globalThis.sqlite3Worker1Promiser=function Ie(se=Ie.defaultConfig){if(arguments.length===1&&typeof arguments[0]=="function"){const ge=se;se=Object.assign(Object.create(null),Ie.defaultConfig),se.onready=ge}else se=Object.assign(Object.create(null),Ie.defaultConfig,se);const c=Object.create(null),pe=function(){},Le=se.onerror||pe,Ne=se.debug||pe,We=se.generateMessageId?void 0:Object.create(null),pt=se.generateMessageId||function(ge){return ge.type+"#"+(We[ge.type]=(We[ge.type]||0)+1)},St=(...ge)=>{throw new Error(ge.join(" "))};se.worker||(se.worker=Ie.defaultConfig.worker),typeof se.worker=="function"&&(se.worker=se.worker());let Je,it;return se.worker.onmessage=function(ge){ge=ge.data,Ne("worker1.onmessage",ge);let Ce=c[ge.messageId];if(!Ce){if(ge&&ge.type==="sqlite3-api"&&ge.result==="worker1-ready"){se.onready&&se.onready(it);return}if(Ce=c[ge.type],Ce&&Ce.onrow){Ce.onrow(ge);return}se.onunhandled?se.onunhandled(arguments[0]):Le("sqlite3Worker1Promiser() unhandled worker message:",ge);return}switch(delete c[ge.messageId],ge.type){case"error":Ce.reject(ge);return;case"open":Je||(Je=ge.dbId);break;case"close":ge.dbId===Je&&(Je=void 0);break}try{Ce.resolve(ge)}catch(Qe){Ce.reject(Qe)}},it=function(){let ge;arguments.length===1?ge=arguments[0]:arguments.length===2?(ge=Object.create(null),ge.type=arguments[0],ge.args=arguments[1],ge.dbId=ge.args.dbId):St("Invalid arguments for sqlite3Worker1Promiser()-created factory."),!ge.dbId&&ge.type!=="open"&&(ge.dbId=Je),ge.messageId=pt(ge),ge.departureTime=performance.now();const Ce=Object.create(null);Ce.message=ge;let Qe;ge.type==="exec"&&ge.args&&(typeof ge.args.callback=="function"?(Qe=ge.messageId+":row",Ce.onrow=ge.args.callback,ge.args.callback=Qe,c[Qe]=Ce):typeof ge.args.callback=="string"&&St("exec callback may not be a string when using the Promise interface."));let ut=new Promise(function(Et,wt){Ce.resolve=Et,Ce.reject=wt,c[ge.messageId]=Ce,Ne("Posting",ge.type,"message to Worker dbId="+(Je||"default")+":",ge),se.worker.postMessage(ge)});return Qe&&(ut=ut.finally(()=>delete c[Qe])),ut}},globalThis.sqlite3Worker1Promiser.defaultConfig={worker:function(){return new Worker(new URL("/itdashboard/assets/sqlite3-worker1-CSkTV9U_.js",self.location.href),{type:"module"})},onerror:(...Ie)=>console.error("sqlite3Worker1Promiser():",...Ie)},globalThis.sqlite3Worker1Promiser.v2=(function Ie(se=Ie.defaultConfig){let c;typeof se=="function"?(c=se,se={}):typeof se?.onready=="function"&&(c=se.onready,delete se.onready);const pe=Object.create(null);se=Object.assign(se||Object.create(null),{onready:async function(Ne){try{c&&await c(Ne),pe.resolve(Ne)}catch(We){pe.reject(We)}}});const Le=new Promise(function(Ne,We){pe.resolve=Ne,pe.reject=We});try{this.original(se)}catch(Ne){pe.reject(Ne)}return Le}).bind({original:sqlite3Worker1Promiser}),globalThis.sqlite3Worker1Promiser.v2.defaultConfig=globalThis.sqlite3Worker1Promiser.defaultConfig,sqlite3Worker1Promiser.v2,delete globalThis.sqlite3Worker1Promiser;var an=on,ln=`CREATE TABLE IF NOT EXISTS kpi_data (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  metric TEXT NOT NULL,
  value REAL NOT NULL,
  unit TEXT,
  category TEXT,
  date TEXT NOT NULL
);

CREATE TABLE IF NOT EXISTS operations_events (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  event_name TEXT NOT NULL,
  status TEXT NOT NULL,
  timestamp TEXT NOT NULL
);

CREATE TABLE IF NOT EXISTS invoice_items (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  FiscalYear INTEGER NOT NULL,
  Period TEXT NOT NULL,
  PostingDate TEXT NOT NULL,
  VendorName TEXT,
  VendorId TEXT,
  DocumentId TEXT NOT NULL,
  LineId INTEGER NOT NULL,
  CostCenter TEXT,
  GLAccount TEXT,
  Category TEXT,
  SubCategory TEXT,
  Service TEXT,
  System TEXT,
  RunChangeInnovation TEXT,
  Amount REAL NOT NULL,
  Currency TEXT NOT NULL,
  Quantity REAL,
  Unit TEXT,
  UnitPrice REAL,
  ContractId TEXT,
  POId TEXT,
  IsRecurring TEXT,
  Description TEXT,
  SourceTag TEXT
);
`,cn=`DROP VIEW IF EXISTS latest_kpis;
CREATE VIEW latest_kpis AS
WITH aggregated_invoice_costs AS (
    SELECT 
        'IT Costs' as metric, 
        SUM(Amount) as value, 
        'EUR' as unit, 
        'Actuals' as category, 
        MAX(PostingDate) as date
    FROM invoice_items
    GROUP BY Period
),
combined_kpis AS (
    SELECT metric, value, unit, category, date FROM kpi_data
    UNION ALL
    SELECT metric, value, unit, category, date FROM aggregated_invoice_costs
)
SELECT metric, value, unit, category, date
FROM combined_kpis
GROUP BY metric
ORDER BY date DESC;

-- Detailed summary for the IT Costs tile
DROP VIEW IF EXISTS it_costs_summary;
CREATE VIEW it_costs_summary AS
SELECT 
    SUM(Amount) as total_amount,
    COUNT(DISTINCT VendorId) as active_vendors,
    MAX(PostingDate) as latest_date,
    MAX(FiscalYear) as latest_year,
    'EUR' as unit
FROM invoice_items;
`,Pt={kpis:[{metric:"IT Costs",value:12e4,unit:"EUR",category:"Finance",date:"2023-10-01"},{metric:"IT Costs",value:115e3,unit:"EUR",category:"Finance",date:"2023-11-01"},{metric:"IT Costs",value:125e3,unit:"EUR",category:"Finance",date:"2023-12-01"},{metric:"Availability",value:99.9,unit:"%",category:"Operations",date:"2023-12-01"}],events:[{event_name:"Server Maintenance",status:"Scheduled",timestamp:"2023-12-10T02:00:00Z"},{event_name:"Incident #1234",status:"Resolved",timestamp:"2023-12-05T14:30:00Z"}]};let Ee=null,nt=null;const rt=(...Ie)=>console.log("[DB Worker]",...Ie),vt=(...Ie)=>console.error("[DB Worker]",...Ie);async function Ye(){if(!Ee)try{if(rt("Initializing SQLite..."),nt=await an({print:rt,printErr:vt}),nt.oo1.OpfsDb)try{Ee=new nt.oo1.OpfsDb("/itdashboard.sqlite3"),rt("Opened OPFS database")}catch(pe){vt("OPFS unavailable, falling back to memory",pe),Ee=new nt.oo1.DB(":memory:")}else rt("OPFS not supported, using memory"),Ee=new nt.oo1.DB(":memory:");Ee.exec(ln),Ee.exec(cn),rt("Schema initialized");const se=Ee.selectValue("SELECT count(*) FROM kpi_data"),c=Ee.selectValue("SELECT count(*) FROM invoice_items");se===0&&c===0&&(rt("Database empty, loading demo data..."),await Dt())}catch(Ie){throw vt("Initialization failed",Ie),Ie}}async function Dt(){Ee.exec("DELETE FROM kpi_data; DELETE FROM operations_events; DELETE FROM invoice_items;");const Ie=Ee.prepare("INSERT INTO kpi_data (metric, value, unit, category, date) VALUES (?, ?, ?, ?, ?)");try{Ee.exec("BEGIN TRANSACTION");for(const se of Pt.kpis)Ie.bind([se.metric,se.value,se.unit,se.category,se.date]),Ie.step(),Ie.reset();Ee.exec("COMMIT")}finally{Ie.finalize()}if(Pt.events){const se=Ee.prepare("INSERT INTO operations_events (event_name, status, timestamp) VALUES (?, ?, ?)");try{Ee.exec("BEGIN TRANSACTION");for(const c of Pt.events)se.bind([c.event_name,c.status,c.timestamp]),se.step(),se.reset();Ee.exec("COMMIT")}finally{se.finalize()}}rt("Demo data loaded")}async function un(Ie){const{id:se,type:c,payload:pe}=Ie.data;try{let Le;switch(c){case"INIT":await Ye(),Le=!0;break;case"EXEC":Ee||await Ye();const Ne=[];Ee.exec({sql:pe.sql,bind:pe.bind,rowMode:"object",callback:We=>Ne.push(We)}),Le=Ne;break;case"BULK_INSERT_INVOICE_ITEMS":Ee||await Ye(),_n(pe),Le=!0;break;case"BULK_INSERT_KPIS":Ee||await Ye(),fn(pe),Le=!0;break;case"BULK_INSERT_EVENTS":Ee||await Ye(),dn(pe),Le=!0;break;case"EXPORT":Ee||await Ye(),Le=nt.capi.sqlite3_js_db_export(Ee.pointer);break;case"IMPORT":await pn(pe),Le=!0;break;case"CLEAR":Ee||await Ye(),Ee.exec("DELETE FROM kpi_data; DELETE FROM operations_events; DELETE FROM invoice_items;"),Le=!0;break;case"LOAD_DEMO":Ee||await Ye(),await Dt(),Le=!0;break;case"INIT_SCHEMA":Ee||await Ye(),Le=!0;break}self.postMessage({id:se,result:Le})}catch(Le){self.postMessage({id:se,error:Le.message})}}function _n(Ie){const c=Ee.prepare(`
        INSERT INTO invoice_items (
            FiscalYear, Period, PostingDate, VendorName, VendorId, 
            DocumentId, LineId, CostCenter, GLAccount, Category, 
            SubCategory, Service, System, RunChangeInnovation, Amount, 
            Currency, Quantity, Unit, UnitPrice, ContractId, 
            POId, IsRecurring, Description, SourceTag
        ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
    `);try{Ee.exec("BEGIN TRANSACTION");for(const pe of Ie)c.bind([pe.FiscalYear,pe.Period,pe.PostingDate,pe.VendorName,pe.VendorId,pe.DocumentId,pe.LineId,pe.CostCenter,pe.GLAccount,pe.Category,pe.SubCategory,pe.Service,pe.System,pe.RunChangeInnovation,pe.Amount,pe.Currency,pe.Quantity,pe.Unit,pe.UnitPrice,pe.ContractId,pe.POId,pe.IsRecurring,pe.Description,pe.SourceTag]),c.step(),c.reset();Ee.exec("COMMIT")}catch(pe){throw Ee.exec("ROLLBACK"),pe}finally{c.finalize()}}function fn(Ie){const se=Ee.prepare("INSERT INTO kpi_data (metric, value, unit, category, date) VALUES (?, ?, ?, ?, ?)");try{Ee.exec("BEGIN TRANSACTION");for(const c of Ie)se.bind([c.metric,c.value,c.unit,c.category,c.date]),se.step(),se.reset();Ee.exec("COMMIT")}catch(c){throw Ee.exec("ROLLBACK"),c}finally{se.finalize()}}function dn(Ie){const se=Ee.prepare("INSERT INTO operations_events (event_name, status, timestamp) VALUES (?, ?, ?)");try{Ee.exec("BEGIN TRANSACTION");for(const c of Ie)se.bind([c.event_name,c.status,c.timestamp]),se.step(),se.reset();Ee.exec("COMMIT")}catch(c){throw Ee.exec("ROLLBACK"),c}finally{se.finalize()}}async function pn(Ie){if(Ee&&(Ee.close(),Ee=null),nt.oo1.OpfsDb)try{const se=await navigator.storage.getDirectory();try{await se.removeEntry("itdashboard.sqlite3")}catch{}const pe=await(await se.getFileHandle("itdashboard.sqlite3",{create:!0})).createWritable();await pe.write(Ie),await pe.close()}catch(se){throw vt("Import failed",se),se}}self.onmessage=un})();
